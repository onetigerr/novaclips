::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: {#wrapper}
- [![FFmpeg](img/ffmpeg3d_white_20.png) FFmpeg](.)
- [About](about.html)
- [News](index.html#news)
- [Download](download.html)
- [Documentation](documentation.html)
- [Community](community.html)
  - [Code of Conduct](community.html#Code-of-Conduct)
  - [Mailing Lists](contact.html#MailingLists)
  - [IRC](contact.html#IRCChannels)
  - [Forums](contact.html#Forums)
  - [Bug Reports](bugreports.html)
  - [Wiki](https://trac.ffmpeg.org)
  - [Conferences](https://trac.ffmpeg.org/wiki/Conferences)
- [Developers](developer.html)
  - [Source Code](download.html#get-sources)
  - [Contribute](developer.html#Introduction)
  - [FATE](http://fate.ffmpeg.org)
  - [Code Coverage](http://coverage.ffmpeg.org)
  - [Funding through SPI](spi.html)
- [More](#)
  - [Donate[]{style="color: #e55; font-size: 0.8em; margin-left: -10px"}](donations.html)
  - [Hire Developers](consulting.html)
  - [Contact](contact.html)
  - [Security](security.html)
  - [Legal](legal.html)

:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: {#page-content-wrapper}
::: content-header
# [](#){#menu-toggle .btn .btn-success} ffmpeg Documentation
:::

:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: {.page-content .inset}
::: {align="center"}
:::

[]{#SEC_Top} []{#SEC_Contents}

## Table of Contents {#table-of-contents .contents-heading}

::: contents
- [1 Synopsis](#Synopsis){#toc-Synopsis}
- [2 Description](#Description){#toc-Description}
- [3 Detailed
  description](#Detailed-description){#toc-Detailed-description}
  - [3.1 Streamcopy](#Streamcopy){#toc-Streamcopy}
  - [3.2 Transcoding](#Transcoding){#toc-Transcoding}
  - [3.3 Filtering](#Filtering){#toc-Filtering}
    - [3.3.1 Simple
      filtergraphs](#Simple-filtergraphs){#toc-Simple-filtergraphs}
    - [3.3.2 Complex
      filtergraphs](#Complex-filtergraphs){#toc-Complex-filtergraphs}
  - [3.4 Loopback
    decoders](#Loopback-decoders-1){#toc-Loopback-decoders-1}
- [4 Stream selection](#Stream-selection-1){#toc-Stream-selection-1}
  - [4.1 Description](#Description-1){#toc-Description-1}
    - [4.1.1 Automatic stream
      selection](#Automatic-stream-selection){#toc-Automatic-stream-selection}
    - [4.1.2 Manual stream
      selection](#Manual-stream-selection){#toc-Manual-stream-selection}
    - [4.1.3 Complex
      filtergraphs](#Complex-filtergraphs-1){#toc-Complex-filtergraphs-1}
    - [4.1.4 Stream handling](#Stream-handling){#toc-Stream-handling}
  - [4.2 Examples](#Examples){#toc-Examples}
- [5 Options](#Options){#toc-Options}
  - [5.1 Stream
    specifiers](#Stream-specifiers-1){#toc-Stream-specifiers-1}
  - [5.2 Generic options](#Generic-options){#toc-Generic-options}
  - [5.3 AVOptions](#AVOptions){#toc-AVOptions}
  - [5.4 Main options](#Main-options){#toc-Main-options}
  - [5.5 Video Options](#Video-Options){#toc-Video-Options}
  - [5.6 Advanced Video
    options](#Advanced-Video-options){#toc-Advanced-Video-options}
  - [5.7 Audio Options](#Audio-Options){#toc-Audio-Options}
  - [5.8 Advanced Audio
    options](#Advanced-Audio-options){#toc-Advanced-Audio-options}
  - [5.9 Subtitle options](#Subtitle-options){#toc-Subtitle-options}
  - [5.10 Advanced Subtitle
    options](#Advanced-Subtitle-options){#toc-Advanced-Subtitle-options}
  - [5.11 Advanced options](#Advanced-options){#toc-Advanced-options}
  - [5.12 Preset files](#Preset-files){#toc-Preset-files}
    - [5.12.1 ffpreset files](#ffpreset-files){#toc-ffpreset-files}
    - [5.12.2 avpreset files](#avpreset-files){#toc-avpreset-files}
  - [5.13 vstats file
    format](#vstats-file-format){#toc-vstats-file-format}
- [6 Examples](#Examples-1){#toc-Examples-1}
  - [6.1 Video and Audio
    grabbing](#Video-and-Audio-grabbing){#toc-Video-and-Audio-grabbing}
  - [6.2 X11 grabbing](#X11-grabbing){#toc-X11-grabbing}
  - [6.3 Video and Audio file format
    conversion](#Video-and-Audio-file-format-conversion){#toc-Video-and-Audio-file-format-conversion}
- [7 Syntax](#Syntax){#toc-Syntax}
  - [7.1 Quoting and
    escaping](#Quoting-and-escaping){#toc-Quoting-and-escaping}
    - [7.1.1 Examples](#Examples-2){#toc-Examples-2}
  - [7.2 Date](#Date){#toc-Date}
  - [7.3 Time duration](#Time-duration){#toc-Time-duration}
    - [7.3.1 Examples](#Examples-3){#toc-Examples-3}
  - [7.4 Video size](#Video-size){#toc-Video-size}
  - [7.5 Video rate](#Video-rate){#toc-Video-rate}
  - [7.6 Ratio](#Ratio){#toc-Ratio}
  - [7.7 Color](#Color){#toc-Color}
  - [7.8 Channel Layout](#Channel-Layout){#toc-Channel-Layout}
- [8 Expression
  Evaluation](#Expression-Evaluation){#toc-Expression-Evaluation}
- [9 Codec Options](#Codec-Options){#toc-Codec-Options}
- [10 Decoders](#Decoders){#toc-Decoders}
- [11 Video Decoders](#Video-Decoders){#toc-Video-Decoders}
  - [11.1 av1](#av1){#toc-av1}
    - [11.1.1 Options](#Options-1){#toc-Options-1}
  - [11.2 hevc](#hevc){#toc-hevc}
    - [11.2.1 Options](#Options-2){#toc-Options-2}
  - [11.3 rawvideo](#rawvideo){#toc-rawvideo}
    - [11.3.1 Options](#Options-3){#toc-Options-3}
  - [11.4 libdav1d](#libdav1d){#toc-libdav1d}
    - [11.4.1 Options](#Options-4){#toc-Options-4}
  - [11.5 libdavs2](#libdavs2){#toc-libdavs2}
  - [11.6 libuavs3d](#libuavs3d){#toc-libuavs3d}
    - [11.6.1 Options](#Options-5){#toc-Options-5}
  - [11.7 libxevd](#libxevd){#toc-libxevd}
    - [11.7.1 Options](#Options-6){#toc-Options-6}
  - [11.8 QSV Decoders](#QSV-Decoders){#toc-QSV-Decoders}
    - [11.8.1 Common Options](#Common-Options){#toc-Common-Options}
    - [11.8.2 HEVC Options](#HEVC-Options){#toc-HEVC-Options}
  - [11.9 v210](#v210){#toc-v210}
    - [11.9.1 Options](#Options-7){#toc-Options-7}
- [12 Audio Decoders](#Audio-Decoders){#toc-Audio-Decoders}
  - [12.1 ac3](#ac3){#toc-ac3}
    - [12.1.1 AC-3 Decoder
      Options](#AC_002d3-Decoder-Options){#toc-AC_002d3-Decoder-Options}
  - [12.2 flac](#flac-1){#toc-flac-1}
    - [12.2.1 FLAC Decoder
      options](#FLAC-Decoder-options){#toc-FLAC-Decoder-options}
  - [12.3 ffwavesynth](#ffwavesynth){#toc-ffwavesynth}
  - [12.4 libcelt](#libcelt){#toc-libcelt}
  - [12.5 libgsm](#libgsm){#toc-libgsm}
  - [12.6 libilbc](#libilbc){#toc-libilbc}
    - [12.6.1 Options](#Options-8){#toc-Options-8}
  - [12.7 libmpeghdec](#libmpeghdec){#toc-libmpeghdec}
  - [12.8
    libopencore-amrnb](#libopencore_002damrnb){#toc-libopencore_002damrnb}
  - [12.9
    libopencore-amrwb](#libopencore_002damrwb){#toc-libopencore_002damrwb}
  - [12.10 libopus](#libopus){#toc-libopus}
- [13 Subtitles Decoders](#Subtitles-Decoders){#toc-Subtitles-Decoders}
  - [13.1 libaribb24](#libaribb24){#toc-libaribb24}
    - [13.1.1 libaribb24 Decoder
      Options](#libaribb24-Decoder-Options){#toc-libaribb24-Decoder-Options}
  - [13.2 libaribcaption](#libaribcaption){#toc-libaribcaption}
    - [13.2.1 libaribcaption Decoder
      Options](#libaribcaption-Decoder-Options){#toc-libaribcaption-Decoder-Options}
    - [13.2.2 libaribcaption decoder usage
      examples](#libaribcaption-decoder-usage-examples){#toc-libaribcaption-decoder-usage-examples}
  - [13.3 dvbsub](#dvbsub){#toc-dvbsub}
    - [13.3.1 Options](#Options-9){#toc-Options-9}
  - [13.4 dvdsub](#dvdsub){#toc-dvdsub}
    - [13.4.1 Options](#Options-10){#toc-Options-10}
  - [13.5
    libzvbi-teletext](#libzvbi_002dteletext){#toc-libzvbi_002dteletext}
    - [13.5.1 Options](#Options-11){#toc-Options-11}
- [14 Encoders](#Encoders){#toc-Encoders}
- [15 Audio Encoders](#Audio-Encoders){#toc-Audio-Encoders}
  - [15.1 aac](#aac){#toc-aac}
    - [15.1.1 Options](#Options-12){#toc-Options-12}
  - [15.2 ac3 and
    ac3_fixed](#ac3-and-ac3_005ffixed){#toc-ac3-and-ac3_005ffixed}
    - [15.2.1 AC-3 Metadata](#AC_002d3-Metadata){#toc-AC_002d3-Metadata}
      - [15.2.1.1 Metadata Control
        Options](#Metadata-Control-Options){#toc-Metadata-Control-Options}
      - [15.2.1.2 Downmix Levels](#Downmix-Levels){#toc-Downmix-Levels}
      - [15.2.1.3 Audio Production
        Information](#Audio-Production-Information){#toc-Audio-Production-Information}
      - [15.2.1.4 Other Metadata
        Options](#Other-Metadata-Options){#toc-Other-Metadata-Options}
    - [15.2.2 Extended Bitstream
      Information](#Extended-Bitstream-Information){#toc-Extended-Bitstream-Information}
      - [15.2.2.1 Extended Bitstream Information - Part
        1](#Extended-Bitstream-Information-_002d-Part-1){#toc-Extended-Bitstream-Information-_002d-Part-1}
      - [15.2.2.2 Extended Bitstream Information - Part
        2](#Extended-Bitstream-Information-_002d-Part-2){#toc-Extended-Bitstream-Information-_002d-Part-2}
    - [15.2.3 Other AC-3 Encoding
      Options](#Other-AC_002d3-Encoding-Options){#toc-Other-AC_002d3-Encoding-Options}
    - [15.2.4 Floating-Point-Only AC-3 Encoding
      Options](#Floating_002dPoint_002dOnly-AC_002d3-Encoding-Options){#toc-Floating_002dPoint_002dOnly-AC_002d3-Encoding-Options}
  - [15.3 flac](#flac-2){#toc-flac-2}
    - [15.3.1 Options](#Options-13){#toc-Options-13}
  - [15.4 opus](#opus){#toc-opus}
    - [15.4.1 Options](#Options-14){#toc-Options-14}
  - [15.5 libfdk_aac](#libfdk_005faac){#toc-libfdk_005faac}
    - [15.5.1 Options](#Options-15){#toc-Options-15}
    - [15.5.2 Examples](#Examples-4){#toc-Examples-4}
  - [15.6 liblc3](#liblc3){#toc-liblc3}
    - [15.6.1 Options](#Options-16){#toc-Options-16}
  - [15.7 libmp3lame](#libmp3lame-1){#toc-libmp3lame-1}
    - [15.7.1 Options](#Options-17){#toc-Options-17}
  - [15.8
    libopencore-amrnb](#libopencore_002damrnb-1){#toc-libopencore_002damrnb-1}
    - [15.8.1 Options](#Options-18){#toc-Options-18}
  - [15.9 libopus](#libopus-1){#toc-libopus-1}
    - [15.9.1 Option Mapping](#Option-Mapping){#toc-Option-Mapping}
  - [15.10 libshine](#libshine-1){#toc-libshine-1}
    - [15.10.1 Options](#Options-19){#toc-Options-19}
  - [15.11 libtwolame](#libtwolame){#toc-libtwolame}
    - [15.11.1 Options](#Options-20){#toc-Options-20}
  - [15.12 libvo-amrwbenc](#libvo_002damrwbenc){#toc-libvo_002damrwbenc}
    - [15.12.1 Options](#Options-21){#toc-Options-21}
  - [15.13 libvorbis](#libvorbis){#toc-libvorbis}
    - [15.13.1 Options](#Options-22){#toc-Options-22}
  - [15.14 mjpeg](#mjpeg){#toc-mjpeg}
    - [15.14.1 Options](#Options-23){#toc-Options-23}
  - [15.15 wavpack](#wavpack){#toc-wavpack}
    - [15.15.1 Options](#Options-24){#toc-Options-24}
      - [15.15.1.1 Shared options](#Shared-options){#toc-Shared-options}
      - [15.15.1.2 Private
        options](#Private-options){#toc-Private-options}
- [16 Video Encoders](#Video-Encoders){#toc-Video-Encoders}
  - [16.1 a64_multi,
    a64_multi5](#a64_005fmulti_002c-a64_005fmulti5){#toc-a64_005fmulti_002c-a64_005fmulti5}
  - [16.2 Cinepak](#Cinepak){#toc-Cinepak}
    - [16.2.1 Options](#Options-25){#toc-Options-25}
  - [16.3 ffv1](#ffv1-1){#toc-ffv1-1}
    - [16.3.1 Options](#Options-26){#toc-Options-26}
  - [16.4 GIF](#GIF){#toc-GIF}
    - [16.4.1 Options](#Options-27){#toc-Options-27}
  - [16.5 Hap](#Hap){#toc-Hap}
    - [16.5.1 Options](#Options-28){#toc-Options-28}
  - [16.6 jpeg2000](#jpeg2000){#toc-jpeg2000}
    - [16.6.1 Options](#Options-29){#toc-Options-29}
  - [16.7 librav1e](#librav1e){#toc-librav1e}
    - [16.7.1 Options](#Options-30){#toc-Options-30}
  - [16.8 libaom-av1](#libaom_002dav1){#toc-libaom_002dav1}
    - [16.8.1 Options](#Options-31){#toc-Options-31}
  - [16.9 liboapv](#liboapv){#toc-liboapv}
    - [16.9.1 Options](#Options-32){#toc-Options-32}
  - [16.10 libsvtav1](#libsvtav1){#toc-libsvtav1}
    - [16.10.1 Options](#Options-33){#toc-Options-33}
  - [16.11 libsvtjpegxs](#libsvtjpegxs){#toc-libsvtjpegxs}
    - [16.11.1 Options](#Options-34){#toc-Options-34}
  - [16.12 libjxl](#libjxl){#toc-libjxl}
    - [16.12.1 Options](#Options-35){#toc-Options-35}
  - [16.13 libkvazaar](#libkvazaar){#toc-libkvazaar}
    - [16.13.1 Options](#Options-36){#toc-Options-36}
  - [16.14 libopenh264](#libopenh264){#toc-libopenh264}
    - [16.14.1 Options](#Options-37){#toc-Options-37}
  - [16.15 libtheora](#libtheora){#toc-libtheora}
    - [16.15.1 Options](#Options-38){#toc-Options-38}
    - [16.15.2 Examples](#Examples-5){#toc-Examples-5}
  - [16.16 libvpx](#libvpx){#toc-libvpx}
    - [16.16.1 Options](#Options-39){#toc-Options-39}
  - [16.17 libvvenc](#libvvenc){#toc-libvvenc}
    - [16.17.1 Supported Pixel
      Formats](#Supported-Pixel-Formats){#toc-Supported-Pixel-Formats}
    - [16.17.2 Options](#Options-40){#toc-Options-40}
  - [16.18 libwebp](#libwebp){#toc-libwebp}
    - [16.18.1 Pixel Format](#Pixel-Format){#toc-Pixel-Format}
    - [16.18.2 Options](#Options-41){#toc-Options-41}
  - [16.19 libx264,
    libx264rgb](#libx264_002c-libx264rgb){#toc-libx264_002c-libx264rgb}
    - [16.19.1 Supported Pixel
      Formats](#Supported-Pixel-Formats-1){#toc-Supported-Pixel-Formats-1}
    - [16.19.2 Options](#Options-42){#toc-Options-42}
  - [16.20 libx265](#libx265){#toc-libx265}
    - [16.20.1 Options](#Options-43){#toc-Options-43}
  - [16.21 libxavs2](#libxavs2){#toc-libxavs2}
    - [16.21.1 Options](#Options-44){#toc-Options-44}
  - [16.22 libxeve](#libxeve){#toc-libxeve}
    - [16.22.1 Options](#Options-45){#toc-Options-45}
  - [16.23 libxvid](#libxvid){#toc-libxvid}
    - [16.23.1 Options](#Options-46){#toc-Options-46}
  - [16.24 MediaCodec](#MediaCodec){#toc-MediaCodec}
  - [16.25 MediaFoundation](#MediaFoundation){#toc-MediaFoundation}
    - [16.25.1 Options](#Options-47){#toc-Options-47}
    - [16.25.2 Examples](#Examples-6){#toc-Examples-6}
  - [16.26 Microsoft RLE](#Microsoft-RLE){#toc-Microsoft-RLE}
    - [16.26.1 Options](#Options-48){#toc-Options-48}
  - [16.27 mpeg2](#mpeg2){#toc-mpeg2}
    - [16.27.1 Options](#Options-49){#toc-Options-49}
  - [16.28 png](#png){#toc-png}
    - [16.28.1 Options](#Options-50){#toc-Options-50}
    - [16.28.2 Private
      options](#Private-options-1){#toc-Private-options-1}
  - [16.29 ProRes](#ProRes){#toc-ProRes}
    - [16.29.1 Private Options for
      prores-ks](#Private-Options-for-prores_002dks){#toc-Private-Options-for-prores_002dks}
    - [16.29.2 Speed
      considerations](#Speed-considerations){#toc-Speed-considerations}
  - [16.30 QSV Encoders](#QSV-Encoders){#toc-QSV-Encoders}
    - [16.30.1 Ratecontrol
      Method](#Ratecontrol-Method){#toc-Ratecontrol-Method}
    - [16.30.2 Global Options -\> MSDK
      Options](#Global-Options-_002d_003e-MSDK-Options){#toc-Global-Options-_002d_003e-MSDK-Options}
    - [16.30.3 Common Options](#Common-Options-1){#toc-Common-Options-1}
    - [16.30.4 Runtime Options](#Runtime-Options){#toc-Runtime-Options}
    - [16.30.5 H264 options](#H264-options){#toc-H264-options}
    - [16.30.6 HEVC Options](#HEVC-Options-1){#toc-HEVC-Options-1}
    - [16.30.7 MPEG2 Options](#MPEG2-Options){#toc-MPEG2-Options}
    - [16.30.8 VP9 Options](#VP9-Options){#toc-VP9-Options}
    - [16.30.9 AV1 Options](#AV1-Options){#toc-AV1-Options}
  - [16.31 snow](#snow){#toc-snow}
    - [16.31.1 Options](#Options-51){#toc-Options-51}
  - [16.32 VAAPI encoders](#VAAPI-encoders){#toc-VAAPI-encoders}
  - [16.33 vbn](#vbn){#toc-vbn}
    - [16.33.1 Options](#Options-52){#toc-Options-52}
  - [16.34 vc2](#vc2){#toc-vc2}
    - [16.34.1 Options](#Options-53){#toc-Options-53}
- [17 Subtitles Encoders](#Subtitles-Encoders){#toc-Subtitles-Encoders}
  - [17.1 dvbsub](#dvbsub-1){#toc-dvbsub-1}
    - [17.1.1 Options](#Options-54){#toc-Options-54}
  - [17.2 dvdsub](#dvdsub-1){#toc-dvdsub-1}
    - [17.2.1 Options](#Options-55){#toc-Options-55}
  - [17.3 lrc](#lrc){#toc-lrc}
    - [17.3.1 Options](#Options-56){#toc-Options-56}
- [18 Bitstream Filters](#Bitstream-Filters){#toc-Bitstream-Filters}
  - [18.1 aac_adtstoasc](#aac_005fadtstoasc){#toc-aac_005fadtstoasc}
  - [18.2 av1_metadata](#av1_005fmetadata){#toc-av1_005fmetadata}
  - [18.3 chomp](#chomp){#toc-chomp}
  - [18.4 dca_core](#dca_005fcore){#toc-dca_005fcore}
  - [18.5 dovi_rpu](#dovi_005frpu){#toc-dovi_005frpu}
  - [18.6 dump_extra](#dump_005fextra){#toc-dump_005fextra}
  - [18.7
    dv_error_marker](#dv_005ferror_005fmarker){#toc-dv_005ferror_005fmarker}
  - [18.8 eac3_core](#eac3_005fcore){#toc-eac3_005fcore}
  - [18.9
    eia608_to_smpte436m](#eia608_005fto_005fsmpte436m){#toc-eia608_005fto_005fsmpte436m}
  - [18.10
    extract_extradata](#extract_005fextradata){#toc-extract_005fextradata}
  - [18.11 filter_units](#filter_005funits){#toc-filter_005funits}
  - [18.12 hapqa_extract](#hapqa_005fextract){#toc-hapqa_005fextract}
  - [18.13 h264_metadata](#h264_005fmetadata){#toc-h264_005fmetadata}
  - [18.14
    h264_mp4toannexb](#h264_005fmp4toannexb){#toc-h264_005fmp4toannexb}
  - [18.15
    h264_redundant_pps](#h264_005fredundant_005fpps){#toc-h264_005fredundant_005fpps}
  - [18.16 hevc_metadata](#hevc_005fmetadata){#toc-hevc_005fmetadata}
  - [18.17
    hevc_mp4toannexb](#hevc_005fmp4toannexb){#toc-hevc_005fmp4toannexb}
  - [18.18 imxdump](#imxdump){#toc-imxdump}
  - [18.19 mjpeg2jpeg](#mjpeg2jpeg){#toc-mjpeg2jpeg}
  - [18.20 mjpegadump](#mjpegadump){#toc-mjpegadump}
  - [18.21 mov2textsub](#mov2textsub-1){#toc-mov2textsub-1}
  - [18.22 mpeg2_metadata](#mpeg2_005fmetadata){#toc-mpeg2_005fmetadata}
  - [18.23
    mpeg4_unpack_bframes](#mpeg4_005funpack_005fbframes){#toc-mpeg4_005funpack_005fbframes}
  - [18.24 noise](#noise){#toc-noise}
    - [18.24.1 Examples](#Examples-7){#toc-Examples-7}
  - [18.25 null](#null){#toc-null}
  - [18.26 pcm_rechunk](#pcm_005frechunk){#toc-pcm_005frechunk}
  - [18.27
    pgs_frame_merge](#pgs_005fframe_005fmerge){#toc-pgs_005fframe_005fmerge}
  - [18.28
    prores_metadata](#prores_005fmetadata){#toc-prores_005fmetadata}
  - [18.29 remove_extra](#remove_005fextra){#toc-remove_005fextra}
  - [18.30 setts](#setts){#toc-setts}
  - [18.31 showinfo](#showinfo){#toc-showinfo}
  - [18.32
    smpte436m_to_eia608](#smpte436m_005fto_005feia608){#toc-smpte436m_005fto_005feia608}
  - [18.33 text2movsub](#text2movsub-1){#toc-text2movsub-1}
  - [18.34 trace_headers](#trace_005fheaders){#toc-trace_005fheaders}
  - [18.35 truehd_core](#truehd_005fcore){#toc-truehd_005fcore}
  - [18.36 vp9_metadata](#vp9_005fmetadata){#toc-vp9_005fmetadata}
  - [18.37 vp9_superframe](#vp9_005fsuperframe){#toc-vp9_005fsuperframe}
  - [18.38
    vp9_superframe_split](#vp9_005fsuperframe_005fsplit){#toc-vp9_005fsuperframe_005fsplit}
  - [18.39
    vp9_raw_reorder](#vp9_005fraw_005freorder){#toc-vp9_005fraw_005freorder}
- [19 Format Options](#Format-Options){#toc-Format-Options}
  - [19.1 Format stream
    specifiers](#Format-stream-specifiers-1){#toc-Format-stream-specifiers-1}
- [20 Demuxers](#Demuxers){#toc-Demuxers}
  - [20.1 aa](#aa){#toc-aa}
  - [20.2 aac](#aac-1){#toc-aac-1}
  - [20.3 apng](#apng){#toc-apng}
  - [20.4 asf](#asf-1){#toc-asf-1}
  - [20.5 concat](#concat-1){#toc-concat-1}
    - [20.5.1 Syntax](#Syntax-1){#toc-Syntax-1}
    - [20.5.2 Options](#Options-57){#toc-Options-57}
    - [20.5.3 Examples](#Examples-8){#toc-Examples-8}
  - [20.6 dash](#dash-1){#toc-dash-1}
    - [20.6.1 Options](#Options-58){#toc-Options-58}
  - [20.7 dvdvideo](#dvdvideo){#toc-dvdvideo}
    - [20.7.1 Background](#Background){#toc-Background}
    - [20.7.2 Options](#Options-59){#toc-Options-59}
    - [20.7.3 Examples](#Examples-9){#toc-Examples-9}
  - [20.8 ea](#ea){#toc-ea}
    - [20.8.1 Options](#Options-60){#toc-Options-60}
  - [20.9 imf](#imf){#toc-imf}
  - [20.10 flv, live_flv,
    kux](#flv_002c-live_005fflv_002c-kux){#toc-flv_002c-live_005fflv_002c-kux}
  - [20.11 gif](#gif-1){#toc-gif-1}
  - [20.12 hls](#hls-1){#toc-hls-1}
  - [20.13 image2](#image2-1){#toc-image2-1}
    - [20.13.1 Examples](#Examples-10){#toc-Examples-10}
  - [20.14 libgme](#libgme){#toc-libgme}
  - [20.15 libmodplug](#libmodplug){#toc-libmodplug}
  - [20.16 libopenmpt](#libopenmpt){#toc-libopenmpt}
  - [20.17 mcc](#mcc){#toc-mcc}
    - [20.17.1 Examples](#Examples-11){#toc-Examples-11}
  - [20.18 mov/mp4/3gp](#mov_002fmp4_002f3gp){#toc-mov_002fmp4_002f3gp}
    - [20.18.1 Options](#Options-61){#toc-Options-61}
    - [20.18.2 Audible AAX](#Audible-AAX){#toc-Audible-AAX}
  - [20.19 mpegts](#mpegts){#toc-mpegts}
  - [20.20 mpjpeg](#mpjpeg){#toc-mpjpeg}
  - [20.21 rawvideo](#rawvideo-1){#toc-rawvideo-1}
  - [20.22 rcwt](#rcwt){#toc-rcwt}
    - [20.22.1 Examples](#Examples-12){#toc-Examples-12}
  - [20.23 sbg](#sbg){#toc-sbg}
  - [20.24 tedcaptions](#tedcaptions){#toc-tedcaptions}
  - [20.25 vapoursynth](#vapoursynth){#toc-vapoursynth}
  - [20.26 w64](#w64){#toc-w64}
  - [20.27 wav](#wav-1){#toc-wav-1}
- [21 Muxers](#Muxers){#toc-Muxers}
  - [21.1 Raw muxers](#Raw-muxers){#toc-Raw-muxers}
    - [21.1.1 Examples](#Examples-13){#toc-Examples-13}
  - [21.2 Raw PCM muxers](#Raw-PCM-muxers){#toc-Raw-PCM-muxers}
  - [21.3 MPEG-1/MPEG-2 program stream
    muxers](#MPEG_002d1_002fMPEG_002d2-program-stream-muxers){#toc-MPEG_002d1_002fMPEG_002d2-program-stream-muxers}
    - [21.3.1 Options](#Options-62){#toc-Options-62}
  - [21.4 MOV/MPEG-4/ISOMBFF
    muxers](#MOV_002fMPEG_002d4_002fISOMBFF-muxers){#toc-MOV_002fMPEG_002d4_002fISOMBFF-muxers}
    - [21.4.1 Fragmentation](#Fragmentation){#toc-Fragmentation}
    - [21.4.2 Options](#Options-63){#toc-Options-63}
    - [21.4.3 Examples](#Examples-14){#toc-Examples-14}
  - [21.5 a64](#a64-1){#toc-a64-1}
  - [21.6 ac4](#ac4){#toc-ac4}
    - [21.6.1 Options](#Options-64){#toc-Options-64}
  - [21.7 adts](#adts-1){#toc-adts-1}
    - [21.7.1 Options](#Options-65){#toc-Options-65}
  - [21.8 aea](#aea-1){#toc-aea-1}
  - [21.9 aiff](#aiff-1){#toc-aiff-1}
    - [21.9.1 Options](#Options-66){#toc-Options-66}
  - [21.10 alp](#alp-1){#toc-alp-1}
    - [21.10.1 Options](#Options-67){#toc-Options-67}
  - [21.11 amr](#amr){#toc-amr}
  - [21.12 amv](#amv){#toc-amv}
  - [21.13 apm](#apm){#toc-apm}
  - [21.14 apng](#apng-1){#toc-apng-1}
    - [21.14.1 Options](#Options-68){#toc-Options-68}
    - [21.14.2 Examples](#Examples-15){#toc-Examples-15}
  - [21.15 argo_asf](#argo_005fasf){#toc-argo_005fasf}
    - [21.15.1 Options](#Options-69){#toc-Options-69}
  - [21.16 argo_cvg](#argo_005fcvg){#toc-argo_005fcvg}
    - [21.16.1 Options](#Options-70){#toc-Options-70}
  - [21.17 asf,
    asf_stream](#asf_002c-asf_005fstream){#toc-asf_002c-asf_005fstream}
    - [21.17.1 Options](#Options-71){#toc-Options-71}
  - [21.18 ass](#ass){#toc-ass}
    - [21.18.1 Options](#Options-72){#toc-Options-72}
  - [21.19 ast](#ast){#toc-ast}
    - [21.19.1 Options](#Options-73){#toc-Options-73}
  - [21.20 au](#au){#toc-au}
  - [21.21 avi](#avi-1){#toc-avi-1}
    - [21.21.1 Options](#Options-74){#toc-Options-74}
  - [21.22 avif](#avif){#toc-avif}
    - [21.22.1 Options](#Options-75){#toc-Options-75}
  - [21.23 avm2](#avm2){#toc-avm2}
  - [21.24 bit](#bit){#toc-bit}
  - [21.25 caf](#caf){#toc-caf}
  - [21.26 codec2](#codec2){#toc-codec2}
  - [21.27 chromaprint](#chromaprint-1){#toc-chromaprint-1}
    - [21.27.1 Options](#Options-76){#toc-Options-76}
  - [21.28 crc](#crc-1){#toc-crc-1}
    - [21.28.1 Examples](#Examples-16){#toc-Examples-16}
  - [21.29 dash](#dash-2){#toc-dash-2}
    - [21.29.1 Options](#Options-77){#toc-Options-77}
    - [21.29.2 Example](#Example){#toc-Example}
  - [21.30 daud](#daud){#toc-daud}
    - [21.30.1 Example](#Example-1){#toc-Example-1}
  - [21.31 dv](#dv){#toc-dv}
    - [21.31.1 Example](#Example-2){#toc-Example-2}
  - [21.32 ffmetadata](#ffmetadata){#toc-ffmetadata}
    - [21.32.1 Example](#Example-3){#toc-Example-3}
  - [21.33 fifo](#fifo-1){#toc-fifo-1}
    - [21.33.1 Options](#Options-78){#toc-Options-78}
    - [21.33.2 Example](#Example-4){#toc-Example-4}
  - [21.34 film_cpk](#film_005fcpk){#toc-film_005fcpk}
  - [21.35 filmstrip](#filmstrip){#toc-filmstrip}
  - [21.36 fits](#fits){#toc-fits}
  - [21.37 flac](#flac-3){#toc-flac-3}
    - [21.37.1 Options](#Options-79){#toc-Options-79}
    - [21.37.2 Example](#Example-5){#toc-Example-5}
  - [21.38 flv](#flv){#toc-flv}
    - [21.38.1 Options](#Options-80){#toc-Options-80}
  - [21.39 framecrc](#framecrc-1){#toc-framecrc-1}
    - [21.39.1 Examples](#Examples-17){#toc-Examples-17}
  - [21.40 framehash](#framehash-1){#toc-framehash-1}
    - [21.40.1 Examples](#Examples-18){#toc-Examples-18}
  - [21.41 framemd5](#framemd5-1){#toc-framemd5-1}
    - [21.41.1 Examples](#Examples-19){#toc-Examples-19}
  - [21.42 gif](#gif-2){#toc-gif-2}
    - [21.42.1 Options](#Options-81){#toc-Options-81}
    - [21.42.2 Example](#Example-6){#toc-Example-6}
  - [21.43 gxf](#gxf){#toc-gxf}
  - [21.44 hash](#hash-1){#toc-hash-1}
    - [21.44.1 Examples](#Examples-20){#toc-Examples-20}
  - [21.45 hds](#hds-1){#toc-hds-1}
    - [21.45.1 Options](#Options-82){#toc-Options-82}
    - [21.45.2 Example](#Example-7){#toc-Example-7}
  - [21.46 hls](#hls-2){#toc-hls-2}
    - [21.46.1 Options](#Options-83){#toc-Options-83}
  - [21.47 iamf](#iamf){#toc-iamf}
  - [21.48 ico](#ico-1){#toc-ico-1}
  - [21.49 ilbc](#ilbc){#toc-ilbc}
  - [21.50 image2,
    image2pipe](#image2_002c-image2pipe){#toc-image2_002c-image2pipe}
    - [21.50.1 Options](#Options-84){#toc-Options-84}
    - [21.50.2 Examples](#Examples-21){#toc-Examples-21}
  - [21.51 ircam](#ircam){#toc-ircam}
  - [21.52 ivf](#ivf){#toc-ivf}
  - [21.53 jacosub](#jacosub){#toc-jacosub}
  - [21.54 kvag](#kvag){#toc-kvag}
  - [21.55 lc3](#lc3){#toc-lc3}
  - [21.56 lrc](#lrc-1){#toc-lrc-1}
    - [21.56.1 Metadata](#Metadata){#toc-Metadata}
  - [21.57 matroska](#matroska){#toc-matroska}
    - [21.57.1 Metadata](#Metadata-1){#toc-Metadata-1}
    - [21.57.2 Options](#Options-85){#toc-Options-85}
  - [21.58 md5](#md5-1){#toc-md5-1}
    - [21.58.1 Examples](#Examples-22){#toc-Examples-22}
  - [21.59 mcc](#mcc-1){#toc-mcc-1}
    - [21.59.1 Options](#Options-86){#toc-Options-86}
    - [21.59.2 Examples](#Examples-23){#toc-Examples-23}
  - [21.60 microdvd](#microdvd){#toc-microdvd}
  - [21.61 mmf](#mmf){#toc-mmf}
  - [21.62 mp3](#mp3){#toc-mp3}
  - [21.63 mpegts](#mpegts-1){#toc-mpegts-1}
    - [21.63.1 Options](#Options-87){#toc-Options-87}
    - [21.63.2 Example](#Example-8){#toc-Example-8}
  - [21.64 mxf, mxf_d10,
    mxf_opatom](#mxf_002c-mxf_005fd10_002c-mxf_005fopatom){#toc-mxf_002c-mxf_005fd10_002c-mxf_005fopatom}
    - [21.64.1 Options](#Options-88){#toc-Options-88}
  - [21.65 null](#null-1){#toc-null-1}
  - [21.66 nut](#nut){#toc-nut}
  - [21.67 ogg](#ogg){#toc-ogg}
  - [21.68 rcwt](#rcwt-1){#toc-rcwt-1}
    - [21.68.1 Examples](#Examples-24){#toc-Examples-24}
  - [21.69 segment, stream_segment,
    ssegment](#segment_002c-stream_005fsegment_002c-ssegment){#toc-segment_002c-stream_005fsegment_002c-ssegment}
    - [21.69.1 Options](#Options-89){#toc-Options-89}
    - [21.69.2 Examples](#Examples-25){#toc-Examples-25}
  - [21.70 smoothstreaming](#smoothstreaming){#toc-smoothstreaming}
  - [21.71 streamhash](#streamhash-1){#toc-streamhash-1}
    - [21.71.1 Examples](#Examples-26){#toc-Examples-26}
  - [21.72 tee](#tee-1){#toc-tee-1}
    - [21.72.1 Options](#Options-90){#toc-Options-90}
    - [21.72.2 Examples](#Examples-27){#toc-Examples-27}
  - [21.73 webm_chunk](#webm_005fchunk){#toc-webm_005fchunk}
    - [21.73.1 Options](#Options-91){#toc-Options-91}
    - [21.73.2 Example](#Example-9){#toc-Example-9}
  - [21.74
    webm_dash_manifest](#webm_005fdash_005fmanifest){#toc-webm_005fdash_005fmanifest}
    - [21.74.1 Options](#Options-92){#toc-Options-92}
    - [21.74.2 Example](#Example-10){#toc-Example-10}
  - [21.75 whip](#whip-1){#toc-whip-1}
    - [21.75.1 Options](#Options-93){#toc-Options-93}
- [22 Metadata](#Metadata-2){#toc-Metadata-2}
- [23 Protocol Options](#Protocol-Options){#toc-Protocol-Options}
- [24 Protocols](#Protocols){#toc-Protocols}
  - [24.1 amqp](#amqp){#toc-amqp}
  - [24.2 async](#async){#toc-async}
  - [24.3 bluray](#bluray){#toc-bluray}
  - [24.4 cache](#cache){#toc-cache}
  - [24.5 concat](#concat-2){#toc-concat-2}
  - [24.6 concatf](#concatf){#toc-concatf}
  - [24.7 crypto](#crypto){#toc-crypto}
  - [24.8 data](#data){#toc-data}
  - [24.9 fd](#fd){#toc-fd}
  - [24.10 file](#file){#toc-file}
  - [24.11 ftp](#ftp){#toc-ftp}
  - [24.12 gopher](#gopher){#toc-gopher}
  - [24.13 gophers](#gophers){#toc-gophers}
  - [24.14 hls](#hls-3){#toc-hls-3}
  - [24.15 http](#http){#toc-http}
    - [24.15.1 HTTP Cookies](#HTTP-Cookies){#toc-HTTP-Cookies}
  - [24.16 Icecast](#Icecast){#toc-Icecast}
  - [24.17 ipfs](#ipfs){#toc-ipfs}
  - [24.18 mmst](#mmst){#toc-mmst}
  - [24.19 mmsh](#mmsh){#toc-mmsh}
  - [24.20 md5](#md5-2){#toc-md5-2}
  - [24.21 pipe](#pipe){#toc-pipe}
  - [24.22 prompeg](#prompeg){#toc-prompeg}
  - [24.23 rist](#rist){#toc-rist}
  - [24.24 rtmp](#rtmp){#toc-rtmp}
  - [24.25 rtmpe](#rtmpe){#toc-rtmpe}
  - [24.26 rtmps](#rtmps){#toc-rtmps}
  - [24.27 rtmpt](#rtmpt){#toc-rtmpt}
  - [24.28 rtmpte](#rtmpte){#toc-rtmpte}
  - [24.29 rtmpts](#rtmpts){#toc-rtmpts}
  - [24.30 libsmbclient](#libsmbclient){#toc-libsmbclient}
  - [24.31 libssh](#libssh){#toc-libssh}
  - [24.32 librtmp rtmp, rtmpe, rtmps, rtmpt,
    rtmpte](#librtmp-rtmp_002c-rtmpe_002c-rtmps_002c-rtmpt_002c-rtmpte){#toc-librtmp-rtmp_002c-rtmpe_002c-rtmps_002c-rtmpt_002c-rtmpte}
  - [24.33 rtp](#rtp){#toc-rtp}
  - [24.34 rtsp](#rtsp){#toc-rtsp}
    - [24.34.1 Muxer](#Muxer){#toc-Muxer}
    - [24.34.2 Demuxer](#Demuxer){#toc-Demuxer}
    - [24.34.3 Examples](#Examples-28){#toc-Examples-28}
  - [24.35 sap](#sap){#toc-sap}
    - [24.35.1 Muxer](#Muxer-1){#toc-Muxer-1}
    - [24.35.2 Demuxer](#Demuxer-1){#toc-Demuxer-1}
  - [24.36 sctp](#sctp){#toc-sctp}
  - [24.37 srt](#srt){#toc-srt}
  - [24.38 srtp](#srtp){#toc-srtp}
  - [24.39 subfile](#subfile){#toc-subfile}
  - [24.40 tee](#tee-2){#toc-tee-2}
  - [24.41 tcp](#tcp){#toc-tcp}
  - [24.42 tls](#tls){#toc-tls}
  - [24.43 dtls](#dtls){#toc-dtls}
  - [24.44 udp](#udp){#toc-udp}
    - [24.44.1 Examples](#Examples-29){#toc-Examples-29}
  - [24.45 unix](#unix){#toc-unix}
  - [24.46 zmq](#zmq){#toc-zmq}
- [25 Device Options](#Device-Options){#toc-Device-Options}
- [26 Input Devices](#Input-Devices){#toc-Input-Devices}
  - [26.1 alsa](#alsa){#toc-alsa}
    - [26.1.1 Options](#Options-94){#toc-Options-94}
  - [26.2 android_camera](#android_005fcamera){#toc-android_005fcamera}
    - [26.2.1 Options](#Options-95){#toc-Options-95}
  - [26.3 avfoundation](#avfoundation){#toc-avfoundation}
    - [26.3.1 Options](#Options-96){#toc-Options-96}
    - [26.3.2 Examples](#Examples-30){#toc-Examples-30}
  - [26.4 decklink](#decklink){#toc-decklink}
    - [26.4.1 Options](#Options-97){#toc-Options-97}
    - [26.4.2 Examples](#Examples-31){#toc-Examples-31}
  - [26.5 dshow](#dshow){#toc-dshow}
    - [26.5.1 Options](#Options-98){#toc-Options-98}
    - [26.5.2 Examples](#Examples-32){#toc-Examples-32}
  - [26.6 fbdev](#fbdev){#toc-fbdev}
    - [26.6.1 Options](#Options-99){#toc-Options-99}
  - [26.7 gdigrab](#gdigrab){#toc-gdigrab}
    - [26.7.1 Options](#Options-100){#toc-Options-100}
  - [26.8 iec61883](#iec61883){#toc-iec61883}
    - [26.8.1 Options](#Options-101){#toc-Options-101}
    - [26.8.2 Examples](#Examples-33){#toc-Examples-33}
  - [26.9 jack](#jack){#toc-jack}
    - [26.9.1 Options](#Options-102){#toc-Options-102}
  - [26.10 kmsgrab](#kmsgrab){#toc-kmsgrab}
    - [26.10.1 Options](#Options-103){#toc-Options-103}
    - [26.10.2 Examples](#Examples-34){#toc-Examples-34}
  - [26.11 lavfi](#lavfi){#toc-lavfi}
    - [26.11.1 Options](#Options-104){#toc-Options-104}
    - [26.11.2 Examples](#Examples-35){#toc-Examples-35}
  - [26.12 libcdio](#libcdio){#toc-libcdio}
    - [26.12.1 Options](#Options-105){#toc-Options-105}
  - [26.13 libdc1394](#libdc1394){#toc-libdc1394}
    - [26.13.1 Options](#Options-106){#toc-Options-106}
  - [26.14 openal](#openal){#toc-openal}
    - [26.14.1 Options](#Options-107){#toc-Options-107}
    - [26.14.2 Examples](#Examples-36){#toc-Examples-36}
  - [26.15 oss](#oss){#toc-oss}
    - [26.15.1 Options](#Options-108){#toc-Options-108}
  - [26.16 pulse](#pulse){#toc-pulse}
    - [26.16.1 Options](#Options-109){#toc-Options-109}
    - [26.16.2 Examples](#Examples-37){#toc-Examples-37}
  - [26.17 sndio](#sndio){#toc-sndio}
    - [26.17.1 Options](#Options-110){#toc-Options-110}
  - [26.18 video4linux2,
    v4l2](#video4linux2_002c-v4l2){#toc-video4linux2_002c-v4l2}
    - [26.18.1 Options](#Options-111){#toc-Options-111}
  - [26.19 vfwcap](#vfwcap){#toc-vfwcap}
    - [26.19.1 Options](#Options-112){#toc-Options-112}
  - [26.20 x11grab](#x11grab){#toc-x11grab}
    - [26.20.1 Options](#Options-113){#toc-Options-113}
- [27 Output Devices](#Output-Devices){#toc-Output-Devices}
  - [27.1 alsa](#alsa-1){#toc-alsa-1}
    - [27.1.1 Examples](#Examples-38){#toc-Examples-38}
  - [27.2 AudioToolbox](#AudioToolbox){#toc-AudioToolbox}
    - [27.2.1 Options](#Options-114){#toc-Options-114}
    - [27.2.2 Examples](#Examples-39){#toc-Examples-39}
  - [27.3 caca](#caca){#toc-caca}
    - [27.3.1 Options](#Options-115){#toc-Options-115}
    - [27.3.2 Examples](#Examples-40){#toc-Examples-40}
  - [27.4 decklink](#decklink-1){#toc-decklink-1}
    - [27.4.1 Options](#Options-116){#toc-Options-116}
    - [27.4.2 Examples](#Examples-41){#toc-Examples-41}
  - [27.5 fbdev](#fbdev-1){#toc-fbdev-1}
    - [27.5.1 Options](#Options-117){#toc-Options-117}
    - [27.5.2 Examples](#Examples-42){#toc-Examples-42}
  - [27.6 oss](#oss-1){#toc-oss-1}
  - [27.7 pulse](#pulse-1){#toc-pulse-1}
    - [27.7.1 Options](#Options-118){#toc-Options-118}
    - [27.7.2 Examples](#Examples-43){#toc-Examples-43}
  - [27.8 sndio](#sndio-1){#toc-sndio-1}
  - [27.9 v4l2](#v4l2){#toc-v4l2}
  - [27.10 xv](#xv){#toc-xv}
    - [27.10.1 Options](#Options-119){#toc-Options-119}
    - [27.10.2 Examples](#Examples-44){#toc-Examples-44}
- [28 Resampler Options](#Resampler-Options){#toc-Resampler-Options}
- [29 Scaler Options](#Scaler-Options){#toc-Scaler-Options}
- [30 Filtering
  Introduction](#Filtering-Introduction){#toc-Filtering-Introduction}
- [31 graph2dot](#graph2dot){#toc-graph2dot}
- [32 Filtergraph
  description](#Filtergraph-description){#toc-Filtergraph-description}
  - [32.1 Filtergraph
    syntax](#Filtergraph-syntax-1){#toc-Filtergraph-syntax-1}
  - [32.2 Notes on filtergraph
    escaping](#Notes-on-filtergraph-escaping){#toc-Notes-on-filtergraph-escaping}
- [33 Timeline editing](#Timeline-editing){#toc-Timeline-editing}
- [34 Changing options at runtime with a
  command](#Changing-options-at-runtime-with-a-command){#toc-Changing-options-at-runtime-with-a-command}
- [35 Options for filters with several inputs
  (framesync)](#Options-for-filters-with-several-inputs-_0028framesync_0029){#toc-Options-for-filters-with-several-inputs-_0028framesync_0029}
- [36 Audio Filters](#Audio-Filters){#toc-Audio-Filters}
  - [36.1 aap](#aap){#toc-aap}
  - [36.2 acompressor](#acompressor){#toc-acompressor}
    - [36.2.1 Commands](#Commands){#toc-Commands}
  - [36.3 acontrast](#acontrast){#toc-acontrast}
  - [36.4 acopy](#acopy){#toc-acopy}
  - [36.5 acrossfade](#acrossfade){#toc-acrossfade}
    - [36.5.1 Examples](#Examples-45){#toc-Examples-45}
  - [36.6 acrossover](#acrossover){#toc-acrossover}
    - [36.6.1 Examples](#Examples-46){#toc-Examples-46}
  - [36.7 acrusher](#acrusher){#toc-acrusher}
    - [36.7.1 Commands](#Commands-1){#toc-Commands-1}
  - [36.8 acue](#acue){#toc-acue}
  - [36.9 adeclick](#adeclick){#toc-adeclick}
  - [36.10 adeclip](#adeclip){#toc-adeclip}
  - [36.11 adecorrelate](#adecorrelate){#toc-adecorrelate}
  - [36.12 adelay](#adelay){#toc-adelay}
    - [36.12.1 Examples](#Examples-47){#toc-Examples-47}
  - [36.13 adenorm](#adenorm){#toc-adenorm}
    - [36.13.1 Commands](#Commands-2){#toc-Commands-2}
  - [36.14 aderivative,
    aintegral](#aderivative_002c-aintegral){#toc-aderivative_002c-aintegral}
  - [36.15 adrc](#adrc){#toc-adrc}
    - [36.15.1 Commands](#Commands-3){#toc-Commands-3}
    - [36.15.2 Examples](#Examples-48){#toc-Examples-48}
  - [36.16
    adynamicequalizer](#adynamicequalizer){#toc-adynamicequalizer}
    - [36.16.1 Commands](#Commands-4){#toc-Commands-4}
  - [36.17 adynamicsmooth](#adynamicsmooth){#toc-adynamicsmooth}
    - [36.17.1 Commands](#Commands-5){#toc-Commands-5}
  - [36.18 aecho](#aecho){#toc-aecho}
    - [36.18.1 Examples](#Examples-49){#toc-Examples-49}
  - [36.19 aemphasis](#aemphasis){#toc-aemphasis}
    - [36.19.1 Commands](#Commands-6){#toc-Commands-6}
  - [36.20 aeval](#aeval){#toc-aeval}
    - [36.20.1 Examples](#Examples-50){#toc-Examples-50}
  - [36.21 aexciter](#aexciter){#toc-aexciter}
    - [36.21.1 Commands](#Commands-7){#toc-Commands-7}
  - [36.22 afade](#afade-1){#toc-afade-1}
    - [36.22.1 Commands](#Commands-8){#toc-Commands-8}
    - [36.22.2 Examples](#Examples-51){#toc-Examples-51}
  - [36.23 afftdn](#afftdn){#toc-afftdn}
    - [36.23.1 Commands](#Commands-9){#toc-Commands-9}
    - [36.23.2 Examples](#Examples-52){#toc-Examples-52}
  - [36.24 afftfilt](#afftfilt){#toc-afftfilt}
    - [36.24.1 Examples](#Examples-53){#toc-Examples-53}
  - [36.25 afir](#afir-1){#toc-afir-1}
    - [36.25.1 Examples](#Examples-54){#toc-Examples-54}
  - [36.26 aformat](#aformat-1){#toc-aformat-1}
  - [36.27 afreqshift](#afreqshift){#toc-afreqshift}
    - [36.27.1 Commands](#Commands-10){#toc-Commands-10}
  - [36.28 afwtdn](#afwtdn){#toc-afwtdn}
    - [36.28.1 Commands](#Commands-11){#toc-Commands-11}
  - [36.29 agate](#agate){#toc-agate}
    - [36.29.1 Commands](#Commands-12){#toc-Commands-12}
  - [36.30 aiir](#aiir){#toc-aiir}
    - [36.30.1 Examples](#Examples-55){#toc-Examples-55}
  - [36.31 alimiter](#alimiter){#toc-alimiter}
  - [36.32 allpass](#allpass){#toc-allpass}
    - [36.32.1 Commands](#Commands-13){#toc-Commands-13}
  - [36.33 aloop](#aloop){#toc-aloop}
  - [36.34 amerge](#amerge-1){#toc-amerge-1}
    - [36.34.1 Examples](#Examples-56){#toc-Examples-56}
  - [36.35 amix](#amix){#toc-amix}
    - [36.35.1 Examples](#Examples-57){#toc-Examples-57}
    - [36.35.2 Commands](#Commands-14){#toc-Commands-14}
  - [36.36 amultiply](#amultiply){#toc-amultiply}
  - [36.37 anequalizer](#anequalizer){#toc-anequalizer}
    - [36.37.1 Examples](#Examples-58){#toc-Examples-58}
    - [36.37.2 Commands](#Commands-15){#toc-Commands-15}
  - [36.38 anlmdn](#anlmdn){#toc-anlmdn}
    - [36.38.1 Commands](#Commands-16){#toc-Commands-16}
  - [36.39 anlmf, anlms](#anlmf_002c-anlms){#toc-anlmf_002c-anlms}
    - [36.39.1 Examples](#Examples-59){#toc-Examples-59}
    - [36.39.2 Commands](#Commands-17){#toc-Commands-17}
  - [36.40 anull](#anull){#toc-anull}
  - [36.41 apad](#apad){#toc-apad}
    - [36.41.1 Examples](#Examples-60){#toc-Examples-60}
  - [36.42 aphaser](#aphaser){#toc-aphaser}
  - [36.43 aphaseshift](#aphaseshift){#toc-aphaseshift}
    - [36.43.1 Commands](#Commands-18){#toc-Commands-18}
  - [36.44 apsnr](#apsnr){#toc-apsnr}
  - [36.45 apsyclip](#apsyclip){#toc-apsyclip}
    - [36.45.1 Commands](#Commands-19){#toc-Commands-19}
  - [36.46 apulsator](#apulsator){#toc-apulsator}
  - [36.47 aresample](#aresample-1){#toc-aresample-1}
    - [36.47.1 Examples](#Examples-61){#toc-Examples-61}
  - [36.48 areverse](#areverse){#toc-areverse}
    - [36.48.1 Examples](#Examples-62){#toc-Examples-62}
  - [36.49 arls](#arls){#toc-arls}
  - [36.50 arnndn](#arnndn){#toc-arnndn}
    - [36.50.1 Commands](#Commands-20){#toc-Commands-20}
  - [36.51 asdr](#asdr){#toc-asdr}
  - [36.52 asetnsamples](#asetnsamples){#toc-asetnsamples}
  - [36.53 asetrate](#asetrate){#toc-asetrate}
  - [36.54 ashowinfo](#ashowinfo){#toc-ashowinfo}
  - [36.55 asisdr](#asisdr){#toc-asisdr}
  - [36.56 asoftclip](#asoftclip){#toc-asoftclip}
    - [36.56.1 Commands](#Commands-21){#toc-Commands-21}
  - [36.57 aspectralstats](#aspectralstats){#toc-aspectralstats}
  - [36.58 asr](#asr){#toc-asr}
  - [36.59 astats](#astats-1){#toc-astats-1}
  - [36.60 asubboost](#asubboost){#toc-asubboost}
    - [36.60.1 Commands](#Commands-22){#toc-Commands-22}
  - [36.61 asubcut](#asubcut){#toc-asubcut}
    - [36.61.1 Commands](#Commands-23){#toc-Commands-23}
  - [36.62 asupercut](#asupercut){#toc-asupercut}
    - [36.62.1 Commands](#Commands-24){#toc-Commands-24}
  - [36.63 asuperpass](#asuperpass){#toc-asuperpass}
    - [36.63.1 Commands](#Commands-25){#toc-Commands-25}
  - [36.64 asuperstop](#asuperstop){#toc-asuperstop}
    - [36.64.1 Commands](#Commands-26){#toc-Commands-26}
  - [36.65 atempo](#atempo){#toc-atempo}
    - [36.65.1 Examples](#Examples-63){#toc-Examples-63}
    - [36.65.2 Commands](#Commands-27){#toc-Commands-27}
  - [36.66 atilt](#atilt){#toc-atilt}
    - [36.66.1 Commands](#Commands-28){#toc-Commands-28}
  - [36.67 atrim](#atrim){#toc-atrim}
  - [36.68 axcorrelate](#axcorrelate){#toc-axcorrelate}
    - [36.68.1 Examples](#Examples-64){#toc-Examples-64}
  - [36.69 bandpass](#bandpass){#toc-bandpass}
    - [36.69.1 Commands](#Commands-29){#toc-Commands-29}
  - [36.70 bandreject](#bandreject){#toc-bandreject}
    - [36.70.1 Commands](#Commands-30){#toc-Commands-30}
  - [36.71 bass, lowshelf](#bass_002c-lowshelf){#toc-bass_002c-lowshelf}
    - [36.71.1 Commands](#Commands-31){#toc-Commands-31}
  - [36.72 biquad](#biquad){#toc-biquad}
    - [36.72.1 Commands](#Commands-32){#toc-Commands-32}
  - [36.73 bs2b](#bs2b){#toc-bs2b}
  - [36.74 channelmap](#channelmap){#toc-channelmap}
    - [36.74.1 Examples](#Examples-65){#toc-Examples-65}
  - [36.75 channelsplit](#channelsplit){#toc-channelsplit}
    - [36.75.1 Examples](#Examples-66){#toc-Examples-66}
  - [36.76 chorus](#chorus){#toc-chorus}
    - [36.76.1 Examples](#Examples-67){#toc-Examples-67}
  - [36.77 compand](#compand){#toc-compand}
    - [36.77.1 Examples](#Examples-68){#toc-Examples-68}
  - [36.78
    compensationdelay](#compensationdelay){#toc-compensationdelay}
    - [36.78.1 Commands](#Commands-33){#toc-Commands-33}
  - [36.79 crossfeed](#crossfeed){#toc-crossfeed}
    - [36.79.1 Commands](#Commands-34){#toc-Commands-34}
  - [36.80 crystalizer](#crystalizer){#toc-crystalizer}
    - [36.80.1 Commands](#Commands-35){#toc-Commands-35}
  - [36.81 dcshift](#dcshift){#toc-dcshift}
  - [36.82 deesser](#deesser){#toc-deesser}
  - [36.83 dialoguenhance](#dialoguenhance){#toc-dialoguenhance}
    - [36.83.1 Commands](#Commands-36){#toc-Commands-36}
  - [36.84 drmeter](#drmeter){#toc-drmeter}
  - [36.85 dynaudnorm](#dynaudnorm){#toc-dynaudnorm}
    - [36.85.1 Commands](#Commands-37){#toc-Commands-37}
  - [36.86 earwax](#earwax){#toc-earwax}
  - [36.87 equalizer](#equalizer){#toc-equalizer}
    - [36.87.1 Examples](#Examples-69){#toc-Examples-69}
    - [36.87.2 Commands](#Commands-38){#toc-Commands-38}
  - [36.88 extrastereo](#extrastereo){#toc-extrastereo}
    - [36.88.1 Commands](#Commands-39){#toc-Commands-39}
  - [36.89 firequalizer](#firequalizer){#toc-firequalizer}
    - [36.89.1 Examples](#Examples-70){#toc-Examples-70}
  - [36.90 flanger](#flanger){#toc-flanger}
  - [36.91 haas](#haas){#toc-haas}
  - [36.92 hdcd](#hdcd){#toc-hdcd}
  - [36.93 headphone](#headphone){#toc-headphone}
    - [36.93.1 Examples](#Examples-71){#toc-Examples-71}
  - [36.94 highpass](#highpass){#toc-highpass}
    - [36.94.1 Commands](#Commands-40){#toc-Commands-40}
  - [36.95 join](#join){#toc-join}
  - [36.96 ladspa](#ladspa){#toc-ladspa}
    - [36.96.1 Examples](#Examples-72){#toc-Examples-72}
    - [36.96.2 Commands](#Commands-41){#toc-Commands-41}
  - [36.97 loudnorm](#loudnorm){#toc-loudnorm}
  - [36.98 lowpass](#lowpass){#toc-lowpass}
    - [36.98.1 Examples](#Examples-73){#toc-Examples-73}
    - [36.98.2 Commands](#Commands-42){#toc-Commands-42}
  - [36.99 lv2](#lv2){#toc-lv2}
    - [36.99.1 Examples](#Examples-74){#toc-Examples-74}
    - [36.99.2 Commands](#Commands-43){#toc-Commands-43}
  - [36.100 mcompand](#mcompand){#toc-mcompand}
  - [36.101 pan](#pan-1){#toc-pan-1}
    - [36.101.1 Mixing examples](#Mixing-examples){#toc-Mixing-examples}
    - [36.101.2 Remapping
      examples](#Remapping-examples){#toc-Remapping-examples}
  - [36.102 replaygain](#replaygain){#toc-replaygain}
  - [36.103 resample](#resample){#toc-resample}
  - [36.104 rubberband](#rubberband){#toc-rubberband}
    - [36.104.1 Commands](#Commands-44){#toc-Commands-44}
  - [36.105
    sidechaincompress](#sidechaincompress){#toc-sidechaincompress}
    - [36.105.1 Commands](#Commands-45){#toc-Commands-45}
    - [36.105.2 Examples](#Examples-75){#toc-Examples-75}
  - [36.106 sidechaingate](#sidechaingate){#toc-sidechaingate}
    - [36.106.1 Commands](#Commands-46){#toc-Commands-46}
  - [36.107 silencedetect](#silencedetect){#toc-silencedetect}
    - [36.107.1 Examples](#Examples-76){#toc-Examples-76}
  - [36.108 silenceremove](#silenceremove){#toc-silenceremove}
    - [36.108.1 Examples](#Examples-77){#toc-Examples-77}
    - [36.108.2 Commands](#Commands-47){#toc-Commands-47}
  - [36.109 sofalizer](#sofalizer){#toc-sofalizer}
    - [36.109.1 Examples](#Examples-78){#toc-Examples-78}
  - [36.110 speechnorm](#speechnorm){#toc-speechnorm}
    - [36.110.1 Commands](#Commands-48){#toc-Commands-48}
    - [36.110.2 Examples](#Examples-79){#toc-Examples-79}
  - [36.111 stereotools](#stereotools){#toc-stereotools}
    - [36.111.1 Commands](#Commands-49){#toc-Commands-49}
    - [36.111.2 Examples](#Examples-80){#toc-Examples-80}
  - [36.112 stereowiden](#stereowiden){#toc-stereowiden}
    - [36.112.1 Commands](#Commands-50){#toc-Commands-50}
  - [36.113 superequalizer](#superequalizer){#toc-superequalizer}
  - [36.114 surround](#surround){#toc-surround}
  - [36.115 tiltshelf](#tiltshelf){#toc-tiltshelf}
    - [36.115.1 Commands](#Commands-51){#toc-Commands-51}
  - [36.116 treble,
    highshelf](#treble_002c-highshelf){#toc-treble_002c-highshelf}
    - [36.116.1 Commands](#Commands-52){#toc-Commands-52}
  - [36.117 tremolo](#tremolo){#toc-tremolo}
  - [36.118 vibrato](#vibrato){#toc-vibrato}
  - [36.119 virtualbass](#virtualbass){#toc-virtualbass}
  - [36.120 volume](#volume){#toc-volume}
    - [36.120.1 Commands](#Commands-53){#toc-Commands-53}
    - [36.120.2 Examples](#Examples-81){#toc-Examples-81}
  - [36.121 volumedetect](#volumedetect){#toc-volumedetect}
    - [36.121.1 Examples](#Examples-82){#toc-Examples-82}
  - [36.122 whisper](#whisper-1){#toc-whisper-1}
    - [36.122.1 Examples](#Examples-83){#toc-Examples-83}
- [37 Audio Sources](#Audio-Sources){#toc-Audio-Sources}
  - [37.1 abuffer](#abuffer){#toc-abuffer}
    - [37.1.1 Examples](#Examples-84){#toc-Examples-84}
  - [37.2 aevalsrc](#aevalsrc){#toc-aevalsrc}
    - [37.2.1 Examples](#Examples-85){#toc-Examples-85}
  - [37.3 afdelaysrc](#afdelaysrc){#toc-afdelaysrc}
  - [37.4 afireqsrc](#afireqsrc){#toc-afireqsrc}
  - [37.5 afirsrc](#afirsrc){#toc-afirsrc}
  - [37.6 anullsrc](#anullsrc){#toc-anullsrc}
    - [37.6.1 Examples](#Examples-86){#toc-Examples-86}
  - [37.7 flite](#flite){#toc-flite}
    - [37.7.1 Examples](#Examples-87){#toc-Examples-87}
  - [37.8 anoisesrc](#anoisesrc){#toc-anoisesrc}
    - [37.8.1 Examples](#Examples-88){#toc-Examples-88}
  - [37.9 hilbert](#hilbert){#toc-hilbert}
  - [37.10 sinc](#sinc){#toc-sinc}
  - [37.11 sine](#sine){#toc-sine}
    - [37.11.1 Examples](#Examples-89){#toc-Examples-89}
- [38 Audio Sinks](#Audio-Sinks){#toc-Audio-Sinks}
  - [38.1 abuffersink](#abuffersink){#toc-abuffersink}
  - [38.2 anullsink](#anullsink){#toc-anullsink}
- [39 Video Filters](#Video-Filters){#toc-Video-Filters}
  - [39.1 addroi](#addroi){#toc-addroi}
    - [39.1.1 Examples](#Examples-90){#toc-Examples-90}
  - [39.2 alphaextract](#alphaextract){#toc-alphaextract}
  - [39.3 alphamerge](#alphamerge){#toc-alphamerge}
  - [39.4 amplify](#amplify){#toc-amplify}
    - [39.4.1 Commands](#Commands-54){#toc-Commands-54}
  - [39.5 ass](#ass-1){#toc-ass-1}
  - [39.6 atadenoise](#atadenoise){#toc-atadenoise}
    - [39.6.1 Commands](#Commands-55){#toc-Commands-55}
  - [39.7 avgblur](#avgblur){#toc-avgblur}
    - [39.7.1 Commands](#Commands-56){#toc-Commands-56}
  - [39.8 backgroundkey](#backgroundkey){#toc-backgroundkey}
    - [39.8.1 Commands](#Commands-57){#toc-Commands-57}
  - [39.9 bbox](#bbox){#toc-bbox}
    - [39.9.1 Commands](#Commands-58){#toc-Commands-58}
  - [39.10 bilateral](#bilateral){#toc-bilateral}
    - [39.10.1 Commands](#Commands-59){#toc-Commands-59}
  - [39.11 bitplanenoise](#bitplanenoise){#toc-bitplanenoise}
  - [39.12 blackdetect,
    blackdetect_vulkan](#blackdetect_002c-blackdetect_005fvulkan){#toc-blackdetect_002c-blackdetect_005fvulkan}
  - [39.13 blackframe](#blackframe){#toc-blackframe}
  - [39.14 blend](#blend-1){#toc-blend-1}
    - [39.14.1 Examples](#Examples-91){#toc-Examples-91}
    - [39.14.2 Commands](#Commands-60){#toc-Commands-60}
  - [39.15 blockdetect](#blockdetect-1){#toc-blockdetect-1}
    - [39.15.1 Examples](#Examples-92){#toc-Examples-92}
  - [39.16 blurdetect](#blurdetect-1){#toc-blurdetect-1}
    - [39.16.1 Examples](#Examples-93){#toc-Examples-93}
  - [39.17 bm3d](#bm3d){#toc-bm3d}
    - [39.17.1 Examples](#Examples-94){#toc-Examples-94}
  - [39.18 boxblur](#boxblur){#toc-boxblur}
    - [39.18.1 Examples](#Examples-95){#toc-Examples-95}
  - [39.19 bwdif](#bwdif-1){#toc-bwdif-1}
  - [39.20 ccrepack](#ccrepack){#toc-ccrepack}
  - [39.21 cas](#cas){#toc-cas}
    - [39.21.1 Commands](#Commands-61){#toc-Commands-61}
  - [39.22 chromahold](#chromahold){#toc-chromahold}
    - [39.22.1 Commands](#Commands-62){#toc-Commands-62}
  - [39.23 chromakey](#chromakey-1){#toc-chromakey-1}
    - [39.23.1 Commands](#Commands-63){#toc-Commands-63}
    - [39.23.2 Examples](#Examples-96){#toc-Examples-96}
  - [39.24 chromanr](#chromanr){#toc-chromanr}
    - [39.24.1 Commands](#Commands-64){#toc-Commands-64}
  - [39.25 chromashift](#chromashift){#toc-chromashift}
    - [39.25.1 Commands](#Commands-65){#toc-Commands-65}
  - [39.26 ciescope](#ciescope){#toc-ciescope}
  - [39.27 codecview](#codecview){#toc-codecview}
    - [39.27.1 Examples](#Examples-97){#toc-Examples-97}
  - [39.28 colorbalance](#colorbalance){#toc-colorbalance}
    - [39.28.1 Examples](#Examples-98){#toc-Examples-98}
    - [39.28.2 Commands](#Commands-66){#toc-Commands-66}
  - [39.29 colorcontrast](#colorcontrast){#toc-colorcontrast}
    - [39.29.1 Commands](#Commands-67){#toc-Commands-67}
  - [39.30 colorcorrect](#colorcorrect){#toc-colorcorrect}
    - [39.30.1 Commands](#Commands-68){#toc-Commands-68}
  - [39.31
    colorchannelmixer](#colorchannelmixer){#toc-colorchannelmixer}
    - [39.31.1 Examples](#Examples-99){#toc-Examples-99}
    - [39.31.2 Commands](#Commands-69){#toc-Commands-69}
  - [39.32 colordetect](#colordetect){#toc-colordetect}
  - [39.33 colorize](#colorize){#toc-colorize}
    - [39.33.1 Commands](#Commands-70){#toc-Commands-70}
  - [39.34 colorkey](#colorkey){#toc-colorkey}
    - [39.34.1 Examples](#Examples-100){#toc-Examples-100}
    - [39.34.2 Commands](#Commands-71){#toc-Commands-71}
  - [39.35 colorhold](#colorhold){#toc-colorhold}
    - [39.35.1 Commands](#Commands-72){#toc-Commands-72}
  - [39.36 colorlevels](#colorlevels){#toc-colorlevels}
    - [39.36.1 Examples](#Examples-101){#toc-Examples-101}
    - [39.36.2 Commands](#Commands-73){#toc-Commands-73}
  - [39.37 colormap](#colormap){#toc-colormap}
  - [39.38 colormatrix](#colormatrix){#toc-colormatrix}
  - [39.39 colorspace](#colorspace){#toc-colorspace}
  - [39.40 colortemperature](#colortemperature){#toc-colortemperature}
    - [39.40.1 Commands](#Commands-74){#toc-Commands-74}
  - [39.41 convolution](#convolution){#toc-convolution}
    - [39.41.1 Commands](#Commands-75){#toc-Commands-75}
    - [39.41.2 Examples](#Examples-102){#toc-Examples-102}
  - [39.42 convolve](#convolve){#toc-convolve}
  - [39.43 copy](#copy){#toc-copy}
  - [39.44 coreimage](#coreimage-1){#toc-coreimage-1}
    - [39.44.1 Examples](#Examples-103){#toc-Examples-103}
  - [39.45 corr](#corr){#toc-corr}
  - [39.46 cover_rect](#cover_005frect){#toc-cover_005frect}
    - [39.46.1 Examples](#Examples-104){#toc-Examples-104}
  - [39.47 crop](#crop){#toc-crop}
    - [39.47.1 Examples](#Examples-105){#toc-Examples-105}
    - [39.47.2 Commands](#Commands-76){#toc-Commands-76}
  - [39.48 cropdetect](#cropdetect){#toc-cropdetect}
    - [39.48.1 Examples](#Examples-106){#toc-Examples-106}
    - [39.48.2 Commands](#Commands-77){#toc-Commands-77}
  - [39.49 cue](#cue-1){#toc-cue-1}
  - [39.50 curves](#curves-1){#toc-curves-1}
    - [39.50.1 Commands](#Commands-78){#toc-Commands-78}
    - [39.50.2 Examples](#Examples-107){#toc-Examples-107}
  - [39.51 datascope](#datascope){#toc-datascope}
    - [39.51.1 Commands](#Commands-79){#toc-Commands-79}
  - [39.52 dblur](#dblur){#toc-dblur}
    - [39.52.1 Commands](#Commands-80){#toc-Commands-80}
  - [39.53 dctdnoiz](#dctdnoiz){#toc-dctdnoiz}
    - [39.53.1 Examples](#Examples-108){#toc-Examples-108}
  - [39.54 deband](#deband){#toc-deband}
    - [39.54.1 Commands](#Commands-81){#toc-Commands-81}
  - [39.55 deblock](#deblock){#toc-deblock}
    - [39.55.1 Examples](#Examples-109){#toc-Examples-109}
    - [39.55.2 Commands](#Commands-82){#toc-Commands-82}
  - [39.56 decimate](#decimate-1){#toc-decimate-1}
  - [39.57 deconvolve](#deconvolve){#toc-deconvolve}
  - [39.58 dedot](#dedot){#toc-dedot}
  - [39.59 deflate](#deflate){#toc-deflate}
    - [39.59.1 Commands](#Commands-83){#toc-Commands-83}
  - [39.60 deflicker](#deflicker){#toc-deflicker}
  - [39.61 dejudder](#dejudder){#toc-dejudder}
  - [39.62 delogo](#delogo){#toc-delogo}
    - [39.62.1 Examples](#Examples-110){#toc-Examples-110}
  - [39.63 derain](#derain-1){#toc-derain-1}
  - [39.64 deshake](#deshake){#toc-deshake}
  - [39.65 despill](#despill){#toc-despill}
    - [39.65.1 Commands](#Commands-84){#toc-Commands-84}
  - [39.66 detelecine](#detelecine){#toc-detelecine}
  - [39.67 dilation](#dilation-1){#toc-dilation-1}
    - [39.67.1 Commands](#Commands-85){#toc-Commands-85}
  - [39.68 displace](#displace){#toc-displace}
    - [39.68.1 Examples](#Examples-111){#toc-Examples-111}
  - [39.69 dnn_classify](#dnn_005fclassify){#toc-dnn_005fclassify}
  - [39.70 dnn_detect](#dnn_005fdetect){#toc-dnn_005fdetect}
  - [39.71
    dnn_processing](#dnn_005fprocessing-1){#toc-dnn_005fprocessing-1}
    - [39.71.1 Examples](#Examples-112){#toc-Examples-112}
  - [39.72 drawbox](#drawbox){#toc-drawbox}
    - [39.72.1 Examples](#Examples-113){#toc-Examples-113}
    - [39.72.2 Commands](#Commands-86){#toc-Commands-86}
  - [39.73 drawgraph](#drawgraph-1){#toc-drawgraph-1}
  - [39.74 drawgrid](#drawgrid){#toc-drawgrid}
    - [39.74.1 Examples](#Examples-114){#toc-Examples-114}
    - [39.74.2 Commands](#Commands-87){#toc-Commands-87}
  - [39.75 drawtext](#drawtext-1){#toc-drawtext-1}
    - [39.75.1 Syntax](#Syntax-2){#toc-Syntax-2}
    - [39.75.2 Text expansion](#Text-expansion){#toc-Text-expansion}
    - [39.75.3 Commands](#Commands-88){#toc-Commands-88}
    - [39.75.4 Examples](#Examples-115){#toc-Examples-115}
  - [39.76 drawvg](#drawvg-1){#toc-drawvg-1}
    - [39.76.1 Parameters](#Parameters){#toc-Parameters}
    - [39.76.2 Pixel Formats](#Pixel-Formats){#toc-Pixel-Formats}
    - [39.76.3 Examples](#Examples-116){#toc-Examples-116}
  - [39.77 edgedetect](#edgedetect){#toc-edgedetect}
    - [39.77.1 Examples](#Examples-117){#toc-Examples-117}
  - [39.78 elbg](#elbg){#toc-elbg}
  - [39.79 entropy](#entropy){#toc-entropy}
  - [39.80 epx](#epx){#toc-epx}
  - [39.81 eq](#eq){#toc-eq}
    - [39.81.1 Commands](#Commands-89){#toc-Commands-89}
  - [39.82 erosion](#erosion-1){#toc-erosion-1}
    - [39.82.1 Commands](#Commands-90){#toc-Commands-90}
  - [39.83 estdif](#estdif){#toc-estdif}
    - [39.83.1 Commands](#Commands-91){#toc-Commands-91}
  - [39.84 exposure](#exposure){#toc-exposure}
    - [39.84.1 Commands](#Commands-92){#toc-Commands-92}
  - [39.85 extractplanes](#extractplanes){#toc-extractplanes}
    - [39.85.1 Examples](#Examples-118){#toc-Examples-118}
  - [39.86 fade](#fade){#toc-fade}
    - [39.86.1 Examples](#Examples-119){#toc-Examples-119}
  - [39.87 feedback](#feedback){#toc-feedback}
    - [39.87.1 Examples](#Examples-120){#toc-Examples-120}
  - [39.88 fftdnoiz](#fftdnoiz){#toc-fftdnoiz}
  - [39.89 fftfilt](#fftfilt){#toc-fftfilt}
    - [39.89.1 Examples](#Examples-121){#toc-Examples-121}
  - [39.90 field](#field){#toc-field}
  - [39.91 fieldhint](#fieldhint){#toc-fieldhint}
  - [39.92 fieldmatch](#fieldmatch){#toc-fieldmatch}
    - [39.92.1 p/c/n/u/b
      meaning](#p_002fc_002fn_002fu_002fb-meaning-1){#toc-p_002fc_002fn_002fu_002fb-meaning-1}
      - [39.92.1.1 p/c/n](#p_002fc_002fn){#toc-p_002fc_002fn}
      - [39.92.1.2 u/b](#u_002fb){#toc-u_002fb}
    - [39.92.2 Examples](#Examples-122){#toc-Examples-122}
  - [39.93 fieldorder](#fieldorder){#toc-fieldorder}
  - [39.94 fillborders](#fillborders){#toc-fillborders}
    - [39.94.1 Commands](#Commands-93){#toc-Commands-93}
  - [39.95 find_rect](#find_005frect){#toc-find_005frect}
    - [39.95.1 Examples](#Examples-123){#toc-Examples-123}
  - [39.96 floodfill](#floodfill){#toc-floodfill}
  - [39.97 format](#format-1){#toc-format-1}
    - [39.97.1 Examples](#Examples-124){#toc-Examples-124}
  - [39.98 fps](#fps-1){#toc-fps-1}
    - [39.98.1 Examples](#Examples-125){#toc-Examples-125}
  - [39.99 framepack](#framepack){#toc-framepack}
  - [39.100 framerate](#framerate){#toc-framerate}
  - [39.101 framestep](#framestep){#toc-framestep}
  - [39.102 freezedetect](#freezedetect){#toc-freezedetect}
  - [39.103 freezeframes](#freezeframes){#toc-freezeframes}
  - [39.104 frei0r](#frei0r-1){#toc-frei0r-1}
    - [39.104.1 Examples](#Examples-126){#toc-Examples-126}
    - [39.104.2 Commands](#Commands-94){#toc-Commands-94}
  - [39.105 fspp](#fspp){#toc-fspp}
  - [39.106 fsync](#fsync-1){#toc-fsync-1}
  - [39.107 gblur](#gblur){#toc-gblur}
    - [39.107.1 Commands](#Commands-95){#toc-Commands-95}
  - [39.108 geq](#geq){#toc-geq}
    - [39.108.1 Examples](#Examples-127){#toc-Examples-127}
  - [39.109 gradfun](#gradfun){#toc-gradfun}
    - [39.109.1 Examples](#Examples-128){#toc-Examples-128}
  - [39.110 graphmonitor](#graphmonitor-1){#toc-graphmonitor-1}
  - [39.111 grayworld](#grayworld){#toc-grayworld}
  - [39.112 greyedge](#greyedge){#toc-greyedge}
    - [39.112.1 Examples](#Examples-129){#toc-Examples-129}
  - [39.113 guided](#guided){#toc-guided}
    - [39.113.1 Commands](#Commands-96){#toc-Commands-96}
    - [39.113.2 Examples](#Examples-130){#toc-Examples-130}
  - [39.114 haldclut](#haldclut-1){#toc-haldclut-1}
    - [39.114.1 Commands](#Commands-97){#toc-Commands-97}
    - [39.114.2 Workflow
      examples](#Workflow-examples){#toc-Workflow-examples}
      - [39.114.2.1 Hald CLUT video
        stream](#Hald-CLUT-video-stream){#toc-Hald-CLUT-video-stream}
      - [39.114.2.2 Hald CLUT with
        preview](#Hald-CLUT-with-preview){#toc-Hald-CLUT-with-preview}
  - [39.115 hflip](#hflip){#toc-hflip}
  - [39.116 histeq](#histeq){#toc-histeq}
  - [39.117 histogram](#histogram-1){#toc-histogram-1}
    - [39.117.1 Examples](#Examples-131){#toc-Examples-131}
  - [39.118 hqdn3d](#hqdn3d-1){#toc-hqdn3d-1}
    - [39.118.1 Commands](#Commands-98){#toc-Commands-98}
  - [39.119 hwdownload](#hwdownload-1){#toc-hwdownload-1}
  - [39.120 hwmap](#hwmap){#toc-hwmap}
  - [39.121 hwupload](#hwupload-1){#toc-hwupload-1}
  - [39.122
    hwupload_cuda](#hwupload_005fcuda-1){#toc-hwupload_005fcuda-1}
  - [39.123 hqx](#hqx){#toc-hqx}
  - [39.124 hstack](#hstack-1){#toc-hstack-1}
  - [39.125 hsvhold](#hsvhold){#toc-hsvhold}
  - [39.126 hsvkey](#hsvkey){#toc-hsvkey}
  - [39.127 hue](#hue){#toc-hue}
    - [39.127.1 Examples](#Examples-132){#toc-Examples-132}
    - [39.127.2 Commands](#Commands-99){#toc-Commands-99}
  - [39.128 huesaturation](#huesaturation){#toc-huesaturation}
  - [39.129 hysteresis](#hysteresis){#toc-hysteresis}
  - [39.130 iccdetect](#iccdetect){#toc-iccdetect}
  - [39.131 iccgen](#iccgen){#toc-iccgen}
  - [39.132 identity](#identity){#toc-identity}
  - [39.133 idet](#idet){#toc-idet}
    - [39.133.1 Examples](#Examples-133){#toc-Examples-133}
  - [39.134 il](#il){#toc-il}
    - [39.134.1 Commands](#Commands-100){#toc-Commands-100}
  - [39.135 inflate](#inflate){#toc-inflate}
    - [39.135.1 Commands](#Commands-101){#toc-Commands-101}
  - [39.136 interlace,
    interlace_vulkan](#interlace_002c-interlace_005fvulkan){#toc-interlace_002c-interlace_005fvulkan}
  - [39.137 kerndeint](#kerndeint){#toc-kerndeint}
    - [39.137.1 Examples](#Examples-134){#toc-Examples-134}
  - [39.138 kirsch](#kirsch){#toc-kirsch}
    - [39.138.1 Commands](#Commands-102){#toc-Commands-102}
  - [39.139 lagfun](#lagfun){#toc-lagfun}
    - [39.139.1 Commands](#Commands-103){#toc-Commands-103}
  - [39.140 lenscorrection](#lenscorrection){#toc-lenscorrection}
    - [39.140.1 Options](#Options-120){#toc-Options-120}
    - [39.140.2 Commands](#Commands-104){#toc-Commands-104}
  - [39.141 lensfun](#lensfun){#toc-lensfun}
    - [39.141.1 Examples](#Examples-135){#toc-Examples-135}
  - [39.142 lcevc](#lcevc){#toc-lcevc}
  - [39.143 libplacebo](#libplacebo){#toc-libplacebo}
    - [39.143.1 Options](#Options-121){#toc-Options-121}
      - [39.143.1.1 Output mode](#Output-mode){#toc-Output-mode}
      - [39.143.1.2 Scaling](#Scaling){#toc-Scaling}
      - [39.143.1.3 Deinterlacing](#Deinterlacing){#toc-Deinterlacing}
      - [39.143.1.4 Debanding](#Debanding){#toc-Debanding}
      - [39.143.1.5 Color
        adjustment](#Color-adjustment){#toc-Color-adjustment}
      - [39.143.1.6 Peak
        detection](#Peak-detection){#toc-Peak-detection}
      - [39.143.1.7 Tone mapping](#Tone-mapping){#toc-Tone-mapping}
      - [39.143.1.8 Dithering](#Dithering){#toc-Dithering}
      - [39.143.1.9 Custom
        shaders](#Custom-shaders){#toc-Custom-shaders}
      - [39.143.1.10 Debugging /
        performance](#Debugging-_002f-performance){#toc-Debugging-_002f-performance}
    - [39.143.2 Commands](#Commands-105){#toc-Commands-105}
    - [39.143.3 Examples](#Examples-136){#toc-Examples-136}
  - [39.144 libvmaf](#libvmaf-1){#toc-libvmaf-1}
    - [39.144.1 Examples](#Examples-137){#toc-Examples-137}
  - [39.145 libvmaf_cuda](#libvmaf_005fcuda){#toc-libvmaf_005fcuda}
    - [39.145.1 Examples](#Examples-138){#toc-Examples-138}
  - [39.146 limitdiff](#limitdiff){#toc-limitdiff}
    - [39.146.1 Commands](#Commands-106){#toc-Commands-106}
  - [39.147 limiter](#limiter){#toc-limiter}
    - [39.147.1 Commands](#Commands-107){#toc-Commands-107}
  - [39.148 loop](#loop){#toc-loop}
    - [39.148.1 Examples](#Examples-139){#toc-Examples-139}
  - [39.149 lut1d](#lut1d){#toc-lut1d}
    - [39.149.1 Commands](#Commands-108){#toc-Commands-108}
  - [39.150 lut3d](#lut3d-1){#toc-lut3d-1}
    - [39.150.1 Commands](#Commands-109){#toc-Commands-109}
  - [39.151 lumakey](#lumakey){#toc-lumakey}
    - [39.151.1 Commands](#Commands-110){#toc-Commands-110}
  - [39.152 lut, lutrgb,
    lutyuv](#lut_002c-lutrgb_002c-lutyuv){#toc-lut_002c-lutrgb_002c-lutyuv}
    - [39.152.1 Commands](#Commands-111){#toc-Commands-111}
    - [39.152.2 Examples](#Examples-140){#toc-Examples-140}
  - [39.153 lut2, tlut2](#lut2_002c-tlut2){#toc-lut2_002c-tlut2}
    - [39.153.1 Commands](#Commands-112){#toc-Commands-112}
    - [39.153.2 Examples](#Examples-141){#toc-Examples-141}
  - [39.154 maskedclamp](#maskedclamp){#toc-maskedclamp}
    - [39.154.1 Commands](#Commands-113){#toc-Commands-113}
  - [39.155 maskedmax](#maskedmax){#toc-maskedmax}
    - [39.155.1 Commands](#Commands-114){#toc-Commands-114}
  - [39.156 maskedmerge](#maskedmerge){#toc-maskedmerge}
    - [39.156.1 Commands](#Commands-115){#toc-Commands-115}
  - [39.157 maskedmin](#maskedmin){#toc-maskedmin}
    - [39.157.1 Commands](#Commands-116){#toc-Commands-116}
  - [39.158 maskedthreshold](#maskedthreshold){#toc-maskedthreshold}
    - [39.158.1 Commands](#Commands-117){#toc-Commands-117}
  - [39.159 maskfun](#maskfun){#toc-maskfun}
    - [39.159.1 Commands](#Commands-118){#toc-Commands-118}
  - [39.160 mcdeint](#mcdeint){#toc-mcdeint}
  - [39.161 median](#median){#toc-median}
    - [39.161.1 Commands](#Commands-119){#toc-Commands-119}
  - [39.162 mergeplanes](#mergeplanes){#toc-mergeplanes}
    - [39.162.1 Examples](#Examples-142){#toc-Examples-142}
  - [39.163 mestimate](#mestimate){#toc-mestimate}
  - [39.164 midequalizer](#midequalizer){#toc-midequalizer}
  - [39.165 minterpolate](#minterpolate){#toc-minterpolate}
  - [39.166 mix](#mix){#toc-mix}
    - [39.166.1 Commands](#Commands-120){#toc-Commands-120}
  - [39.167 monochrome](#monochrome){#toc-monochrome}
    - [39.167.1 Commands](#Commands-121){#toc-Commands-121}
  - [39.168 morpho](#morpho){#toc-morpho}
    - [39.168.1 Commands](#Commands-122){#toc-Commands-122}
  - [39.169 mpdecimate](#mpdecimate){#toc-mpdecimate}
  - [39.170 msad](#msad){#toc-msad}
  - [39.171 multiply](#multiply){#toc-multiply}
    - [39.171.1 Commands](#Commands-123){#toc-Commands-123}
  - [39.172 negate](#negate){#toc-negate}
    - [39.172.1 Commands](#Commands-124){#toc-Commands-124}
  - [39.173 nlmeans](#nlmeans-1){#toc-nlmeans-1}
  - [39.174 nnedi](#nnedi){#toc-nnedi}
    - [39.174.1 Commands](#Commands-125){#toc-Commands-125}
  - [39.175 noformat](#noformat){#toc-noformat}
    - [39.175.1 Examples](#Examples-143){#toc-Examples-143}
  - [39.176 noise](#noise-1){#toc-noise-1}
    - [39.176.1 Examples](#Examples-144){#toc-Examples-144}
  - [39.177 normalize](#normalize){#toc-normalize}
    - [39.177.1 Commands](#Commands-126){#toc-Commands-126}
    - [39.177.2 Examples](#Examples-145){#toc-Examples-145}
  - [39.178 null](#null-2){#toc-null-2}
  - [39.179 ocr](#ocr){#toc-ocr}
  - [39.180 ocv](#ocv){#toc-ocv}
    - [39.180.1 dilate](#dilate-1){#toc-dilate-1}
    - [39.180.2 erode](#erode){#toc-erode}
    - [39.180.3 smooth](#smooth){#toc-smooth}
  - [39.181 oscilloscope](#oscilloscope){#toc-oscilloscope}
    - [39.181.1 Commands](#Commands-127){#toc-Commands-127}
    - [39.181.2 Examples](#Examples-146){#toc-Examples-146}
  - [39.182 overlay](#overlay-1){#toc-overlay-1}
    - [39.182.1 Commands](#Commands-128){#toc-Commands-128}
    - [39.182.2 Examples](#Examples-147){#toc-Examples-147}
  - [39.183 owdenoise](#owdenoise){#toc-owdenoise}
  - [39.184 pad](#pad-1){#toc-pad-1}
    - [39.184.1 Examples](#Examples-148){#toc-Examples-148}
  - [39.185 palettegen](#palettegen-1){#toc-palettegen-1}
    - [39.185.1 Examples](#Examples-149){#toc-Examples-149}
  - [39.186 paletteuse](#paletteuse){#toc-paletteuse}
    - [39.186.1 Examples](#Examples-150){#toc-Examples-150}
  - [39.187 perspective](#perspective){#toc-perspective}
  - [39.188 phase](#phase){#toc-phase}
    - [39.188.1 Commands](#Commands-129){#toc-Commands-129}
  - [39.189 photosensitivity](#photosensitivity){#toc-photosensitivity}
  - [39.190 pixdesctest](#pixdesctest){#toc-pixdesctest}
  - [39.191 pixelize](#pixelize){#toc-pixelize}
    - [39.191.1 Commands](#Commands-130){#toc-Commands-130}
  - [39.192 pixscope](#pixscope){#toc-pixscope}
    - [39.192.1 Commands](#Commands-131){#toc-Commands-131}
  - [39.193 pp7](#pp7){#toc-pp7}
  - [39.194 premultiply](#premultiply){#toc-premultiply}
  - [39.195
    premultiply_dynamic](#premultiply_005fdynamic){#toc-premultiply_005fdynamic}
  - [39.196 prewitt](#prewitt){#toc-prewitt}
    - [39.196.1 Commands](#Commands-132){#toc-Commands-132}
  - [39.197 pseudocolor](#pseudocolor){#toc-pseudocolor}
    - [39.197.1 Commands](#Commands-133){#toc-Commands-133}
    - [39.197.2 Examples](#Examples-151){#toc-Examples-151}
  - [39.198 psnr](#psnr-1){#toc-psnr-1}
    - [39.198.1 Examples](#Examples-152){#toc-Examples-152}
  - [39.199 pullup](#pullup-1){#toc-pullup-1}
  - [39.200 qp](#qp){#toc-qp}
    - [39.200.1 Examples](#Examples-153){#toc-Examples-153}
  - [39.201 qrencode](#qrencode){#toc-qrencode}
    - [39.201.1 qrencode
      Expressions](#qrencode-Expressions){#toc-qrencode-Expressions}
    - [39.201.2 qrencode Text
      expansion](#qrencode-Text-expansion){#toc-qrencode-Text-expansion}
    - [39.201.3 Examples](#Examples-154){#toc-Examples-154}
  - [39.202 quirc](#quirc){#toc-quirc}
  - [39.203 random](#random){#toc-random}
  - [39.204 readeia608](#readeia608){#toc-readeia608}
    - [39.204.1 Commands](#Commands-134){#toc-Commands-134}
    - [39.204.2 Examples](#Examples-155){#toc-Examples-155}
  - [39.205 readvitc](#readvitc){#toc-readvitc}
    - [39.205.1 Examples](#Examples-156){#toc-Examples-156}
  - [39.206 remap](#remap){#toc-remap}
  - [39.207 removegrain](#removegrain){#toc-removegrain}
  - [39.208 removelogo](#removelogo){#toc-removelogo}
  - [39.209 repeatfields](#repeatfields){#toc-repeatfields}
  - [39.210 reverse](#reverse){#toc-reverse}
    - [39.210.1 Examples](#Examples-157){#toc-Examples-157}
  - [39.211 rgbashift](#rgbashift){#toc-rgbashift}
    - [39.211.1 Commands](#Commands-135){#toc-Commands-135}
  - [39.212 roberts](#roberts){#toc-roberts}
    - [39.212.1 Commands](#Commands-136){#toc-Commands-136}
  - [39.213 rotate](#rotate){#toc-rotate}
    - [39.213.1 Examples](#Examples-158){#toc-Examples-158}
    - [39.213.2 Commands](#Commands-137){#toc-Commands-137}
  - [39.214 sab](#sab){#toc-sab}
  - [39.215 scale](#scale-1){#toc-scale-1}
    - [39.215.1 Options](#Options-122){#toc-Options-122}
    - [39.215.2 Examples](#Examples-159){#toc-Examples-159}
    - [39.215.3 Commands](#Commands-138){#toc-Commands-138}
  - [39.216 scharr](#scharr){#toc-scharr}
    - [39.216.1 Commands](#Commands-139){#toc-Commands-139}
  - [39.217 scroll](#scroll){#toc-scroll}
    - [39.217.1 Commands](#Commands-140){#toc-Commands-140}
  - [39.218 scdet](#scdet-1){#toc-scdet-1}
  - [39.219 selectivecolor](#selectivecolor-1){#toc-selectivecolor-1}
    - [39.219.1 Examples](#Examples-160){#toc-Examples-160}
  - [39.220 separatefields](#separatefields-1){#toc-separatefields-1}
  - [39.221 setdar,
    setsar](#setdar_002c-setsar){#toc-setdar_002c-setsar}
    - [39.221.1 Examples](#Examples-161){#toc-Examples-161}
  - [39.222 setfield](#setfield-1){#toc-setfield-1}
  - [39.223 setparams](#setparams-1){#toc-setparams-1}
  - [39.224 shear](#shear){#toc-shear}
    - [39.224.1 Commands](#Commands-141){#toc-Commands-141}
  - [39.225 showinfo](#showinfo-1){#toc-showinfo-1}
  - [39.226 showpalette](#showpalette){#toc-showpalette}
  - [39.227 shuffleframes](#shuffleframes){#toc-shuffleframes}
    - [39.227.1 Examples](#Examples-162){#toc-Examples-162}
  - [39.228 shufflepixels](#shufflepixels){#toc-shufflepixels}
  - [39.229 shuffleplanes](#shuffleplanes){#toc-shuffleplanes}
    - [39.229.1 Examples](#Examples-163){#toc-Examples-163}
  - [39.230 signalstats](#signalstats-1){#toc-signalstats-1}
    - [39.230.1 Examples](#Examples-164){#toc-Examples-164}
  - [39.231 signature](#signature-1){#toc-signature-1}
    - [39.231.1 Examples](#Examples-165){#toc-Examples-165}
  - [39.232 siti](#siti-1){#toc-siti-1}
    - [39.232.1 Examples](#Examples-166){#toc-Examples-166}
  - [39.233 smartblur](#smartblur-1){#toc-smartblur-1}
  - [39.234 sobel](#sobel){#toc-sobel}
    - [39.234.1 Commands](#Commands-142){#toc-Commands-142}
  - [39.235 spp](#spp-1){#toc-spp-1}
    - [39.235.1 Commands](#Commands-143){#toc-Commands-143}
  - [39.236 sr](#sr-1){#toc-sr-1}
  - [39.237 sr_amf](#sr_005famf-1){#toc-sr_005famf-1}
    - [39.237.1 Examples](#Examples-167){#toc-Examples-167}
  - [39.238 ssim](#ssim){#toc-ssim}
    - [39.238.1 Examples](#Examples-168){#toc-Examples-168}
  - [39.239 stereo3d](#stereo3d){#toc-stereo3d}
    - [39.239.1 Examples](#Examples-169){#toc-Examples-169}
  - [39.240 streamselect,
    astreamselect](#streamselect_002c-astreamselect){#toc-streamselect_002c-astreamselect}
    - [39.240.1 Commands](#Commands-144){#toc-Commands-144}
    - [39.240.2 Examples](#Examples-170){#toc-Examples-170}
  - [39.241 subtitles](#subtitles-1){#toc-subtitles-1}
  - [39.242 super2xsai](#super2xsai){#toc-super2xsai}
  - [39.243 swaprect](#swaprect){#toc-swaprect}
    - [39.243.1 Commands](#Commands-145){#toc-Commands-145}
  - [39.244 swapuv](#swapuv){#toc-swapuv}
  - [39.245 tblend](#tblend){#toc-tblend}
  - [39.246 telecine](#telecine){#toc-telecine}
  - [39.247 thistogram](#thistogram){#toc-thistogram}
  - [39.248 threshold](#threshold){#toc-threshold}
    - [39.248.1 Commands](#Commands-146){#toc-Commands-146}
    - [39.248.2 Examples](#Examples-171){#toc-Examples-171}
  - [39.249 thumbnail](#thumbnail){#toc-thumbnail}
    - [39.249.1 Examples](#Examples-172){#toc-Examples-172}
  - [39.250 tile](#tile-1){#toc-tile-1}
    - [39.250.1 Examples](#Examples-173){#toc-Examples-173}
  - [39.251 tiltandshift](#tiltandshift){#toc-tiltandshift}
  - [39.252 tinterlace](#tinterlace){#toc-tinterlace}
  - [39.253 tmedian](#tmedian){#toc-tmedian}
    - [39.253.1 Commands](#Commands-147){#toc-Commands-147}
  - [39.254 tmidequalizer](#tmidequalizer){#toc-tmidequalizer}
  - [39.255 tmix](#tmix){#toc-tmix}
    - [39.255.1 Examples](#Examples-174){#toc-Examples-174}
    - [39.255.2 Commands](#Commands-148){#toc-Commands-148}
  - [39.256 tonemap](#tonemap-1){#toc-tonemap-1}
    - [39.256.1 Options](#Options-123){#toc-Options-123}
  - [39.257 tpad](#tpad){#toc-tpad}
  - [39.258 transpose](#transpose-1){#toc-transpose-1}
  - [39.259 trim](#trim){#toc-trim}
  - [39.260 unpremultiply](#unpremultiply){#toc-unpremultiply}
  - [39.261 unsharp](#unsharp-1){#toc-unsharp-1}
    - [39.261.1 Examples](#Examples-175){#toc-Examples-175}
  - [39.262 untile](#untile-1){#toc-untile-1}
    - [39.262.1 Examples](#Examples-176){#toc-Examples-176}
  - [39.263 uspp](#uspp){#toc-uspp}
  - [39.264 v360](#v360){#toc-v360}
    - [39.264.1 Examples](#Examples-177){#toc-Examples-177}
    - [39.264.2 Commands](#Commands-149){#toc-Commands-149}
  - [39.265 vaguedenoiser](#vaguedenoiser){#toc-vaguedenoiser}
  - [39.266 varblur](#varblur){#toc-varblur}
    - [39.266.1 Commands](#Commands-150){#toc-Commands-150}
  - [39.267 vectorscope](#vectorscope){#toc-vectorscope}
  - [39.268 vidstabdetect](#vidstabdetect-1){#toc-vidstabdetect-1}
    - [39.268.1 Examples](#Examples-178){#toc-Examples-178}
  - [39.269
    vidstabtransform](#vidstabtransform-1){#toc-vidstabtransform-1}
    - [39.269.1 Options](#Options-124){#toc-Options-124}
    - [39.269.2 Examples](#Examples-179){#toc-Examples-179}
  - [39.270 vflip](#vflip){#toc-vflip}
  - [39.271 vfrdet](#vfrdet){#toc-vfrdet}
  - [39.272 vibrance](#vibrance){#toc-vibrance}
    - [39.272.1 Commands](#Commands-151){#toc-Commands-151}
  - [39.273 vif](#vif){#toc-vif}
  - [39.274 vignette](#vignette-1){#toc-vignette-1}
    - [39.274.1 Expressions](#Expressions){#toc-Expressions}
    - [39.274.2 Examples](#Examples-180){#toc-Examples-180}
  - [39.275 vmafmotion](#vmafmotion){#toc-vmafmotion}
  - [39.276 vpp_amf](#vpp_005famf-1){#toc-vpp_005famf-1}
    - [39.276.1 Examples](#Examples-181){#toc-Examples-181}
  - [39.277 vstack](#vstack-1){#toc-vstack-1}
  - [39.278 w3fdif](#w3fdif){#toc-w3fdif}
    - [39.278.1 Commands](#Commands-152){#toc-Commands-152}
  - [39.279 waveform](#waveform){#toc-waveform}
  - [39.280 weave,
    doubleweave](#weave_002c-doubleweave){#toc-weave_002c-doubleweave}
    - [39.280.1 Examples](#Examples-182){#toc-Examples-182}
  - [39.281 xbr](#xbr){#toc-xbr}
  - [39.282 xcorrelate](#xcorrelate){#toc-xcorrelate}
  - [39.283 xfade](#xfade){#toc-xfade}
    - [39.283.1 Examples](#Examples-183){#toc-Examples-183}
  - [39.284 xmedian](#xmedian){#toc-xmedian}
    - [39.284.1 Commands](#Commands-153){#toc-Commands-153}
  - [39.285 xpsnr](#xpsnr-1){#toc-xpsnr-1}
    - [39.285.1 Examples](#Examples-184){#toc-Examples-184}
  - [39.286 xstack](#xstack-1){#toc-xstack-1}
    - [39.286.1 Examples](#Examples-185){#toc-Examples-185}
  - [39.287 yadif](#yadif-1){#toc-yadif-1}
  - [39.288 yaepblur](#yaepblur){#toc-yaepblur}
    - [39.288.1 Commands](#Commands-154){#toc-Commands-154}
  - [39.289 zoompan](#zoompan){#toc-zoompan}
    - [39.289.1 Examples](#Examples-186){#toc-Examples-186}
  - [39.290 zscale](#zscale-1){#toc-zscale-1}
    - [39.290.1 Options](#Options-125){#toc-Options-125}
    - [39.290.2 Commands](#Commands-155){#toc-Commands-155}
- [40 CUDA Video Filters](#CUDA-Video-Filters){#toc-CUDA-Video-Filters}
  - [40.1 CUDA](#CUDA-1){#toc-CUDA-1}
    - [40.1.1
      bilateral_cuda](#bilateral_005fcuda){#toc-bilateral_005fcuda}
      - [40.1.1.1 Examples](#Examples-187){#toc-Examples-187}
    - [40.1.2 bwdif_cuda](#bwdif_005fcuda){#toc-bwdif_005fcuda}
    - [40.1.3
      chromakey_cuda](#chromakey_005fcuda){#toc-chromakey_005fcuda}
      - [40.1.3.1 Examples](#Examples-188){#toc-Examples-188}
    - [40.1.4
      colorspace_cuda](#colorspace_005fcuda){#toc-colorspace_005fcuda}
    - [40.1.5
      overlay_cuda](#overlay_005fcuda-1){#toc-overlay_005fcuda-1}
    - [40.1.6 pad_cuda](#pad_005fcuda-1){#toc-pad_005fcuda-1}
      - [40.1.6.1 Examples](#Examples-189){#toc-Examples-189}
    - [40.1.7 scale_cuda](#scale_005fcuda-1){#toc-scale_005fcuda-1}
      - [40.1.7.1 Examples](#Examples-190){#toc-Examples-190}
    - [40.1.8
      thumbnail_cuda](#thumbnail_005fcuda){#toc-thumbnail_005fcuda}
      - [40.1.8.1 Example](#Example-11){#toc-Example-11}
    - [40.1.9 yadif_cuda](#yadif_005fcuda){#toc-yadif_005fcuda}
  - [40.2 CUDA NPP](#CUDA-NPP-1){#toc-CUDA-NPP-1}
    - [40.2.1 scale_npp](#scale_005fnpp-1){#toc-scale_005fnpp-1}
    - [40.2.2 scale2ref_npp](#scale2ref_005fnpp){#toc-scale2ref_005fnpp}
      - [40.2.2.1 Examples](#Examples-191){#toc-Examples-191}
    - [40.2.3 sharpen_npp](#sharpen_005fnpp){#toc-sharpen_005fnpp}
    - [40.2.4 transpose_npp](#transpose_005fnpp){#toc-transpose_005fnpp}
- [41 OpenCL Video
  Filters](#OpenCL-Video-Filters){#toc-OpenCL-Video-Filters}
  - [41.1 avgblur_opencl](#avgblur_005fopencl){#toc-avgblur_005fopencl}
    - [41.1.1 Example](#Example-12){#toc-Example-12}
  - [41.2 boxblur_opencl](#boxblur_005fopencl){#toc-boxblur_005fopencl}
    - [41.2.1 Examples](#Examples-192){#toc-Examples-192}
  - [41.3
    colorkey_opencl](#colorkey_005fopencl){#toc-colorkey_005fopencl}
    - [41.3.1 Examples](#Examples-193){#toc-Examples-193}
  - [41.4
    convolution_opencl](#convolution_005fopencl){#toc-convolution_005fopencl}
    - [41.4.1 Examples](#Examples-194){#toc-Examples-194}
  - [41.5 erosion_opencl](#erosion_005fopencl){#toc-erosion_005fopencl}
    - [41.5.1 Example](#Example-13){#toc-Example-13}
  - [41.6 deshake_opencl](#deshake_005fopencl){#toc-deshake_005fopencl}
    - [41.6.1 Examples](#Examples-195){#toc-Examples-195}
  - [41.7
    dilation_opencl](#dilation_005fopencl){#toc-dilation_005fopencl}
    - [41.7.1 Example](#Example-14){#toc-Example-14}
  - [41.8
    nlmeans_opencl](#nlmeans_005fopencl-1){#toc-nlmeans_005fopencl-1}
  - [41.9 overlay_opencl](#overlay_005fopencl){#toc-overlay_005fopencl}
    - [41.9.1 Examples](#Examples-196){#toc-Examples-196}
  - [41.10 pad_opencl](#pad_005fopencl){#toc-pad_005fopencl}
  - [41.11 prewitt_opencl](#prewitt_005fopencl){#toc-prewitt_005fopencl}
    - [41.11.1 Example](#Example-15){#toc-Example-15}
  - [41.12
    program_opencl](#program_005fopencl-1){#toc-program_005fopencl-1}
  - [41.13 remap_opencl](#remap_005fopencl){#toc-remap_005fopencl}
  - [41.14 roberts_opencl](#roberts_005fopencl){#toc-roberts_005fopencl}
    - [41.14.1 Example](#Example-16){#toc-Example-16}
  - [41.15 sobel_opencl](#sobel_005fopencl){#toc-sobel_005fopencl}
    - [41.15.1 Example](#Example-17){#toc-Example-17}
  - [41.16 tonemap_opencl](#tonemap_005fopencl){#toc-tonemap_005fopencl}
    - [41.16.1 Example](#Example-18){#toc-Example-18}
  - [41.17 unsharp_opencl](#unsharp_005fopencl){#toc-unsharp_005fopencl}
    - [41.17.1 Examples](#Examples-197){#toc-Examples-197}
  - [41.18 xfade_opencl](#xfade_005fopencl){#toc-xfade_005fopencl}
- [42 VAAPI Video
  Filters](#VAAPI-Video-Filters){#toc-VAAPI-Video-Filters}
  - [42.1 overlay_vaapi](#overlay_005fvaapi){#toc-overlay_005fvaapi}
    - [42.1.1 Examples](#Examples-198){#toc-Examples-198}
  - [42.2 tonemap_vaapi](#tonemap_005fvaapi){#toc-tonemap_005fvaapi}
    - [42.2.1 Example](#Example-19){#toc-Example-19}
  - [42.3 hstack_vaapi](#hstack_005fvaapi){#toc-hstack_005fvaapi}
  - [42.4 vstack_vaapi](#vstack_005fvaapi){#toc-vstack_005fvaapi}
  - [42.5 xstack_vaapi](#xstack_005fvaapi){#toc-xstack_005fvaapi}
  - [42.6 pad_vaapi](#pad_005fvaapi){#toc-pad_005fvaapi}
  - [42.7 drawbox_vaapi](#drawbox_005fvaapi){#toc-drawbox_005fvaapi}
    - [42.7.1 Examples](#Examples-199){#toc-Examples-199}
- [43 VideoToolbox Video
  Filters](#VideoToolbox-Video-Filters){#toc-VideoToolbox-Video-Filters}
  - [43.1 scale_vt](#scale_005fvt){#toc-scale_005fvt}
    - [43.1.1 Examples](#Examples-200){#toc-Examples-200}
  - [43.2 transpose_vt](#transpose_005fvt){#toc-transpose_005fvt}
- [44 Vulkan Video
  Filters](#Vulkan-Video-Filters){#toc-Vulkan-Video-Filters}
  - [44.1 avgblur_vulkan](#avgblur_005fvulkan){#toc-avgblur_005fvulkan}
  - [44.2 blend_vulkan](#blend_005fvulkan){#toc-blend_005fvulkan}
  - [44.3 bwdif_vulkan](#bwdif_005fvulkan){#toc-bwdif_005fvulkan}
  - [44.4
    chromaber_vulkan](#chromaber_005fvulkan){#toc-chromaber_005fvulkan}
  - [44.5 color_vulkan](#color_005fvulkan){#toc-color_005fvulkan}
  - [44.6 vflip_vulkan](#vflip_005fvulkan){#toc-vflip_005fvulkan}
  - [44.7 hflip_vulkan](#hflip_005fvulkan){#toc-hflip_005fvulkan}
  - [44.8 flip_vulkan](#flip_005fvulkan){#toc-flip_005fvulkan}
  - [44.9 gblur_vulkan](#gblur_005fvulkan){#toc-gblur_005fvulkan}
  - [44.10 nlmeans_vulkan](#nlmeans_005fvulkan){#toc-nlmeans_005fvulkan}
  - [44.11 overlay_vulkan](#overlay_005fvulkan){#toc-overlay_005fvulkan}
  - [44.12
    transpose_vulkan](#transpose_005fvulkan){#toc-transpose_005fvulkan}
- [45 QSV Video Filters](#QSV-Video-Filters){#toc-QSV-Video-Filters}
  - [45.1 hstack_qsv](#hstack_005fqsv){#toc-hstack_005fqsv}
  - [45.2 vstack_qsv](#vstack_005fqsv){#toc-vstack_005fqsv}
  - [45.3 xstack_qsv](#xstack_005fqsv){#toc-xstack_005fqsv}
- [46 Video Sources](#Video-Sources){#toc-Video-Sources}
  - [46.1 buffer](#buffer){#toc-buffer}
  - [46.2 cellauto](#cellauto){#toc-cellauto}
    - [46.2.1 Examples](#Examples-201){#toc-Examples-201}
  - [46.3 coreimagesrc](#coreimagesrc-1){#toc-coreimagesrc-1}
    - [46.3.1 Examples](#Examples-202){#toc-Examples-202}
  - [46.4 ddagrab](#ddagrab){#toc-ddagrab}
    - [46.4.1 Examples](#Examples-203){#toc-Examples-203}
  - [46.5 gfxcapture](#gfxcapture){#toc-gfxcapture}
    - [46.5.1 Examples](#Examples-204){#toc-Examples-204}
  - [46.6 gradients](#gradients){#toc-gradients}
    - [46.6.1 Commands](#Commands-156){#toc-Commands-156}
  - [46.7 mandelbrot](#mandelbrot){#toc-mandelbrot}
  - [46.8 mptestsrc](#mptestsrc){#toc-mptestsrc}
  - [46.9 frei0r_src](#frei0r_005fsrc){#toc-frei0r_005fsrc}
  - [46.10 life](#life){#toc-life}
    - [46.10.1 Examples](#Examples-205){#toc-Examples-205}
  - [46.11 perlin](#perlin){#toc-perlin}
    - [46.11.1 Options](#Options-126){#toc-Options-126}
    - [46.11.2 Examples](#Examples-206){#toc-Examples-206}
  - [46.12 qrencodesrc](#qrencodesrc){#toc-qrencodesrc}
    - [46.12.1 Examples](#Examples-207){#toc-Examples-207}
  - [46.13 allrgb, allyuv, color, colorchart, colorspectrum,
    haldclutsrc, nullsrc, pal75bars, pal100bars, rgbtestsrc, smptebars,
    smptehdbars, testsrc, testsrc2,
    yuvtestsrc](#allrgb_002c-allyuv_002c-color_002c-colorchart_002c-colorspectrum_002c-haldclutsrc_002c-nullsrc_002c-pal75bars_002c-pal100bars_002c-rgbtestsrc_002c-smptebars_002c-smptehdbars_002c-testsrc_002c-testsrc2_002c-yuvtestsrc){#toc-allrgb_002c-allyuv_002c-color_002c-colorchart_002c-colorspectrum_002c-haldclutsrc_002c-nullsrc_002c-pal75bars_002c-pal100bars_002c-rgbtestsrc_002c-smptebars_002c-smptehdbars_002c-testsrc_002c-testsrc2_002c-yuvtestsrc}
    - [46.13.1 Examples](#Examples-208){#toc-Examples-208}
    - [46.13.2 Commands](#Commands-157){#toc-Commands-157}
  - [46.14 openclsrc](#openclsrc){#toc-openclsrc}
  - [46.15 sierpinski](#sierpinski){#toc-sierpinski}
  - [46.16 zoneplate](#zoneplate){#toc-zoneplate}
    - [46.16.1 Commands](#Commands-158){#toc-Commands-158}
    - [46.16.2 Examples](#Examples-209){#toc-Examples-209}
- [47 Video Sinks](#Video-Sinks){#toc-Video-Sinks}
  - [47.1 buffersink](#buffersink){#toc-buffersink}
  - [47.2 nullsink](#nullsink){#toc-nullsink}
- [48 Multimedia Filters](#Multimedia-Filters){#toc-Multimedia-Filters}
  - [48.1 a3dscope](#a3dscope){#toc-a3dscope}
    - [48.1.1 Commands](#Commands-159){#toc-Commands-159}
  - [48.2 abitscope](#abitscope){#toc-abitscope}
  - [48.3 adrawgraph](#adrawgraph){#toc-adrawgraph}
  - [48.4 agraphmonitor](#agraphmonitor){#toc-agraphmonitor}
  - [48.5 ahistogram](#ahistogram){#toc-ahistogram}
  - [48.6 aphasemeter](#aphasemeter){#toc-aphasemeter}
    - [48.6.1 phasing
      detection](#phasing-detection){#toc-phasing-detection}
    - [48.6.2 Examples](#Examples-210){#toc-Examples-210}
  - [48.7 avectorscope](#avectorscope){#toc-avectorscope}
    - [48.7.1 Examples](#Examples-211){#toc-Examples-211}
    - [48.7.2 Commands](#Commands-160){#toc-Commands-160}
  - [48.8 bench, abench](#bench_002c-abench){#toc-bench_002c-abench}
    - [48.8.1 Examples](#Examples-212){#toc-Examples-212}
  - [48.9 concat](#concat-3){#toc-concat-3}
    - [48.9.1 Examples](#Examples-213){#toc-Examples-213}
    - [48.9.2 Commands](#Commands-161){#toc-Commands-161}
  - [48.10 ebur128](#ebur128-1){#toc-ebur128-1}
    - [48.10.1 Examples](#Examples-214){#toc-Examples-214}
  - [48.11 interleave,
    ainterleave](#interleave_002c-ainterleave){#toc-interleave_002c-ainterleave}
    - [48.11.1 Examples](#Examples-215){#toc-Examples-215}
  - [48.12 latency,
    alatency](#latency_002c-alatency){#toc-latency_002c-alatency}
  - [48.13 metadata,
    ametadata](#metadata_002c-ametadata){#toc-metadata_002c-ametadata}
    - [48.13.1 Examples](#Examples-216){#toc-Examples-216}
  - [48.14 perms, aperms](#perms_002c-aperms){#toc-perms_002c-aperms}
  - [48.15 realtime,
    arealtime](#realtime_002c-arealtime){#toc-realtime_002c-arealtime}
    - [48.15.1 Commands](#Commands-162){#toc-Commands-162}
  - [48.16 segment,
    asegment](#segment_002c-asegment){#toc-segment_002c-asegment}
    - [48.16.1 Examples](#Examples-217){#toc-Examples-217}
  - [48.17 select,
    aselect](#select_002c-aselect){#toc-select_002c-aselect}
    - [48.17.1 Examples](#Examples-218){#toc-Examples-218}
  - [48.18 sendcmd,
    asendcmd](#sendcmd_002c-asendcmd){#toc-sendcmd_002c-asendcmd}
    - [48.18.1 Commands syntax](#Commands-syntax){#toc-Commands-syntax}
    - [48.18.2 Examples](#Examples-219){#toc-Examples-219}
  - [48.19 setpts,
    asetpts](#setpts_002c-asetpts){#toc-setpts_002c-asetpts}
    - [48.19.1 Examples](#Examples-220){#toc-Examples-220}
    - [48.19.2 Commands](#Commands-163){#toc-Commands-163}
  - [48.20 setrange](#setrange){#toc-setrange}
  - [48.21 settb, asettb](#settb_002c-asettb){#toc-settb_002c-asettb}
    - [48.21.1 Examples](#Examples-221){#toc-Examples-221}
  - [48.22 showcqt](#showcqt){#toc-showcqt}
    - [48.22.1 Examples](#Examples-222){#toc-Examples-222}
  - [48.23 showcwt](#showcwt){#toc-showcwt}
  - [48.24 showfreqs](#showfreqs){#toc-showfreqs}
  - [48.25 showspatial](#showspatial){#toc-showspatial}
  - [48.26 showspectrum](#showspectrum-1){#toc-showspectrum-1}
    - [48.26.1 Examples](#Examples-223){#toc-Examples-223}
  - [48.27 showspectrumpic](#showspectrumpic){#toc-showspectrumpic}
    - [48.27.1 Examples](#Examples-224){#toc-Examples-224}
  - [48.28 showvolume](#showvolume){#toc-showvolume}
  - [48.29 showwaves](#showwaves){#toc-showwaves}
    - [48.29.1 Examples](#Examples-225){#toc-Examples-225}
  - [48.30 showwavespic](#showwavespic){#toc-showwavespic}
    - [48.30.1 Examples](#Examples-226){#toc-Examples-226}
  - [48.31 sidedata,
    asidedata](#sidedata_002c-asidedata){#toc-sidedata_002c-asidedata}
  - [48.32 spectrumsynth](#spectrumsynth){#toc-spectrumsynth}
    - [48.32.1 Examples](#Examples-227){#toc-Examples-227}
  - [48.33 split, asplit](#split_002c-asplit){#toc-split_002c-asplit}
    - [48.33.1 Examples](#Examples-228){#toc-Examples-228}
  - [48.34 zmq, azmq](#zmq_002c-azmq){#toc-zmq_002c-azmq}
    - [48.34.1 Examples](#Examples-229){#toc-Examples-229}
- [49 Multimedia Sources](#Multimedia-Sources){#toc-Multimedia-Sources}
  - [49.1 amovie](#amovie){#toc-amovie}
  - [49.2 avsynctest](#avsynctest){#toc-avsynctest}
    - [49.2.1 Commands](#Commands-164){#toc-Commands-164}
  - [49.3 movie](#movie-1){#toc-movie-1}
    - [49.3.1 Examples](#Examples-230){#toc-Examples-230}
    - [49.3.2 Commands](#Commands-165){#toc-Commands-165}
- [50 External libraries](#External-libraries){#toc-External-libraries}
  - [50.1 Alliance for Open Media
    (AOM)](#Alliance-for-Open-Media-_0028AOM_0029){#toc-Alliance-for-Open-Media-_0028AOM_0029}
  - [50.2 AMD AMF/VCE](#AMD-AMF_002fVCE){#toc-AMD-AMF_002fVCE}
  - [50.3 AviSynth](#AviSynth){#toc-AviSynth}
  - [50.4 Chromaprint](#Chromaprint){#toc-Chromaprint}
  - [50.5 codec2](#codec2-1){#toc-codec2-1}
  - [50.6 dav1d](#dav1d){#toc-dav1d}
  - [50.7 davs2](#davs2){#toc-davs2}
  - [50.8 uavs3d](#uavs3d){#toc-uavs3d}
  - [50.9 Game Music Emu](#Game-Music-Emu){#toc-Game-Music-Emu}
  - [50.10 Intel QuickSync
    Video](#Intel-QuickSync-Video){#toc-Intel-QuickSync-Video}
  - [50.11 Kvazaar](#Kvazaar){#toc-Kvazaar}
  - [50.12 LAME](#LAME){#toc-LAME}
  - [50.13 LCEVCdec](#LCEVCdec){#toc-LCEVCdec}
  - [50.14 libilbc](#libilbc-1){#toc-libilbc-1}
  - [50.15 libjxl](#libjxl-1){#toc-libjxl-1}
  - [50.16 libvpx](#libvpx-1){#toc-libvpx-1}
  - [50.17 ModPlug](#ModPlug){#toc-ModPlug}
  - [50.18 OpenCORE, VisualOn, and Fraunhofer
    libraries](#OpenCORE_002c-VisualOn_002c-and-Fraunhofer-libraries){#toc-OpenCORE_002c-VisualOn_002c-and-Fraunhofer-libraries}
    - [50.18.1 OpenCORE AMR](#OpenCORE-AMR){#toc-OpenCORE-AMR}
    - [50.18.2 VisualOn AMR-WB encoder
      library](#VisualOn-AMR_002dWB-encoder-library){#toc-VisualOn-AMR_002dWB-encoder-library}
    - [50.18.3 Fraunhofer AAC
      library](#Fraunhofer-AAC-library){#toc-Fraunhofer-AAC-library}
    - [50.18.4 Fraunhofer MPEG-H 3D Audio decoder
      library](#Fraunhofer-MPEG_002dH-3D-Audio-decoder-library){#toc-Fraunhofer-MPEG_002dH-3D-Audio-decoder-library}
    - [50.18.5 LC3 library](#LC3-library){#toc-LC3-library}
  - [50.19 OpenH264](#OpenH264){#toc-OpenH264}
  - [50.20 OpenJPEG](#OpenJPEG){#toc-OpenJPEG}
  - [50.21 rav1e](#rav1e){#toc-rav1e}
  - [50.22 SVT-AV1](#SVT_002dAV1){#toc-SVT_002dAV1}
  - [50.23 SVT-JPEG-XS](#SVT_002dJPEG_002dXS){#toc-SVT_002dJPEG_002dXS}
  - [50.24 TwoLAME](#TwoLAME){#toc-TwoLAME}
  - [50.25 VapourSynth](#VapourSynth){#toc-VapourSynth}
  - [50.26 x264](#x264){#toc-x264}
  - [50.27 x265](#x265){#toc-x265}
  - [50.28 xavs](#xavs){#toc-xavs}
  - [50.29 xavs2](#xavs2){#toc-xavs2}
  - [50.30 eXtra-fast Essential Video Encoder
    (XEVE)](#eXtra_002dfast-Essential-Video-Encoder-_0028XEVE_0029){#toc-eXtra_002dfast-Essential-Video-Encoder-_0028XEVE_0029}
  - [50.31 eXtra-fast Essential Video Decoder
    (XEVD)](#eXtra_002dfast-Essential-Video-Decoder-_0028XEVD_0029){#toc-eXtra_002dfast-Essential-Video-Decoder-_0028XEVD_0029}
  - [50.32 ZVBI](#ZVBI){#toc-ZVBI}
- [51 Supported File Formats, Codecs or
  Features](#Supported-File-Formats_002c-Codecs-or-Features){#toc-Supported-File-Formats_002c-Codecs-or-Features}
  - [51.1 File Formats](#File-Formats){#toc-File-Formats}
  - [51.2 Image Formats](#Image-Formats){#toc-Image-Formats}
  - [51.3 Video Codecs](#Video-Codecs){#toc-Video-Codecs}
  - [51.4 Audio Codecs](#Audio-Codecs){#toc-Audio-Codecs}
  - [51.5 Subtitle Formats](#Subtitle-Formats){#toc-Subtitle-Formats}
  - [51.6 Network Protocols](#Network-Protocols){#toc-Network-Protocols}
  - [51.7 Input/Output
    Devices](#Input_002fOutput-Devices){#toc-Input_002fOutput-Devices}
  - [51.8 Timecode](#Timecode){#toc-Timecode}
- [52 See Also](#See-Also){#toc-See-Also}
- [53 Authors](#Authors){#toc-Authors}
:::

[]{#Synopsis}

## [1 Synopsis](#toc-Synopsis) {#synopsis .chapter}

ffmpeg \[`global_options`{.variable}\]
{\[`input_file_options`{.variable}\] -i `input_url`{.sample}} \...
{\[`output_file_options`{.variable}\] `output_url`{.sample}} \...

[]{#Description}

## [2 Description](#toc-Description) {#description .chapter}

`ffmpeg` is a universal media converter. It can read a wide variety of
inputs - including live grabbing/recording devices - filter, and
transcode them into a plethora of output formats.

`ffmpeg` reads from an arbitrary number of inputs (which can be regular
files, pipes, network streams, grabbing devices, etc.), specified by the
`-i` option, and writes to an arbitrary number of outputs, which are
specified by a plain output url. Anything found on the command line
which cannot be interpreted as an option is considered to be an output
url.

Each input or output can, in principle, contain any number of elementary
streams of different types (video/audio/subtitle/attachment/data),
though the allowed stream counts and/or types may be limited by the
container format. Selecting which streams from which inputs will go into
which output is either done automatically or with the `-map` option (see
the [Stream selection](#Stream-selection) chapter).

To refer to inputs/outputs in options, you must use their indices
(0-based). E.g. the first input is `0`, the second is `1`, etc.
Similarly, streams within an input/output are referred to by their
indices. E.g. `2:3` refers to the fourth stream in the third input or
output. Also see the [Stream specifiers](#Stream-specifiers) chapter.

As a general rule, options are applied to the next specified file.
Therefore, order is important, and you can have the same option on the
command line multiple times. Each occurrence is then applied to the next
input or output file. Exceptions from this rule are the global options
(e.g. verbosity level), which should be specified first.

Do not mix input and output files -- first specify all input files, then
all output files. Also do not mix options which belong to different
files. All options apply ONLY to the next input or output file and are
reset between files.

Some simple examples follow.

- Convert an input media file to a different format, by re-encoding
  media streams:

  ::: example
  ``` example
  ffmpeg -i input.avi output.mp4
  ```
  :::
- Set the video bitrate of the output file to 64 kbit/s:

  ::: example
  ``` example
  ffmpeg -i input.avi -b:v 64k -bufsize 64k output.mp4
  ```
  :::
- Force the frame rate of the output file to 24 fps:

  ::: example
  ``` example
  ffmpeg -i input.avi -r 24 output.mp4
  ```
  :::
- Force the frame rate of the input file (valid for raw formats only) to
  1 fps and the frame rate of the output file to 24 fps:

  ::: example
  ``` example
  ffmpeg -r 1 -i input.m2v -r 24 output.mp4
  ```
  :::

The format option may be needed for raw input files.

[]{#Detailed-description}

## [3 Detailed description](#toc-Detailed-description) {#detailed-description .chapter}

`ffmpeg` builds a transcoding pipeline out of the components listed
below. The program's operation then consists of input data chunks
flowing from the sources down the pipes towards the sinks, while being
transformed by the components they encounter along the way.

The following kinds of components are available:

- *Demuxers* (short for \"demultiplexers\") read an input source in
  order to extract

  - global properties such as metadata or chapters;
  - list of input elementary streams and their properties

  One demuxer instance is created for each `-i`{.sample} option, and
  sends encoded *packets* to *decoders* or *muxers*.

  In other literature, demuxers are sometimes called *splitters*,
  because their main function is splitting a file into elementary
  streams (though some files only contain one elementary stream).

  A schematic representation of a demuxer looks like this:

  ``` verbatim
  
   demuxer                          packets for stream 0
   elementary stream 0   
                                   
    global  
  properties                        packets for stream 1
     and     elementary stream 1   
   metadata                        
            
                                   
                 ...........       
                                   
            
                                    packets for stream N
             elementary stream N   
                                   
  
       
       
        read from file, network stream,
            grabbing device, etc.
       
  ```

- *Decoders* receive encoded (compressed) *packets* for an audio, video,
  or subtitle elementary stream, and decode them into raw *frames*
  (arrays of pixels for video, PCM for audio). A decoder is typically
  associated with (and receives its input from) an elementary stream in
  a *demuxer*, but sometimes may also exist on its own (see [Loopback
  decoders](#Loopback-decoders)).

  A schematic representation of a decoder looks like this:

  ``` verbatim
            
   packets            raw frames
   decoder 
                     
            
  ```

- *Filtergraphs* process and transform raw audio or video *frames*. A
  filtergraph consists of one or more individual *filters* linked into a
  graph. Filtergraphs come in two flavors - *simple* and *complex*,
  configured with the `-filter`{.sample} and `-filter_complex`{.sample}
  options, respectively.

  A simple filtergraph is associated with an *output elementary stream*;
  it receives the input to be filtered from a *decoder* and sends
  filtered output to that output stream's *encoder*.

  A simple video filtergraph that performs deinterlacing (using the
  `yadif` deinterlacer) followed by resizing (using the `scale` filter)
  can look like this:

  ``` verbatim

               
                 simple filtergraph    
   frames from  frames for
   a decoder          an encoder
   yadif  scale 
                     
               
  ```

  A complex filtergraph is standalone and not associated with any
  specific stream. It may have multiple (or zero) inputs, potentially of
  different types (audio or video), each of which receiving data either
  from a decoder or another complex filtergraph's output. It also has
  one or more outputs that feed either an encoder or another complex
  filtergraph's input.

  The following example diagram represents a complex filtergraph with 3
  inputs and 2 outputs (all video):

  ``` verbatim
            
                           complex filtergraph               
            
   frames              frames
  input 0 overlay  overlay output 0
                                        
   frames                                    
  input 1                 
                                                    
   frames                    frames
  input 2scalesplitoutput 1
                              
            
  ```

  Frames from second input are overlaid over those from the first.
  Frames from the third input are rescaled, then the duplicated into two
  identical streams. One of them is overlaid over the combined first two
  inputs, with the result exposed as the filtergraph's first output. The
  other duplicate ends up being the filtergraph's second output.

- *Encoders* receive raw audio, video, or subtitle *frames* and encode
  them into encoded *packets*. The encoding (compression) process is
  typically *lossy* - it degrades stream quality to make the output
  smaller; some encoders are *lossless*, but at the cost of much higher
  output size. A video or audio encoder receives its input from some
  filtergraph's output, subtitle encoders receive input from a decoder
  (since subtitle filtering is not supported yet). Every encoder is
  associated with some muxer's *output elementary stream* and sends its
  output to that muxer.

  A schematic representation of an encoder looks like this:

  ``` verbatim
               
   raw frames            packets
   encoder 
                        
               
  ```

- *Muxers* (short for \"multiplexers\") receive encoded *packets* for
  their elementary streams from encoders (the *transcoding* path) or
  directly from demuxers (the *streamcopy* path), interleave them (when
  there is more than one elementary stream), and write the resulting
  bytes into the output file (or pipe, network stream, etc.).

  A schematic representation of a muxer looks like this:

  ``` verbatim
                         
   packets for stream 0                           muxer   
    elementary stream 0 
                                                          
                           global   
   packets for stream 1                        properties 
    elementary stream 1    and     
                                                metadata  
                                    
                                                          
                              ...........                 
                                                          
                                    
   packets for stream N                                   
    elementary stream N            
                                                          
                         
                                                      
                       write to file, network stream, 
                           grabbing device, etc.      
                                                      
                                                      
  ```

[]{#Streamcopy}

### [3.1 Streamcopy](#toc-Streamcopy) {#streamcopy .section}

The simplest pipeline in `ffmpeg` is single-stream *streamcopy*, that is
copying one *input elementary stream*'s packets without decoding,
filtering, or encoding them. As an example, consider an input file
called `INPUT.mkv`{.sample} with 3 elementary streams, from which we
take the second and write it to file `OUTPUT.mp4`{.sample}. A schematic
representation of such a pipeline looks like this:

``` verbatim

 demuxer                        unused
 elementary stream 0 
                               
INPUT.mkv           
                                packets                           muxer   
           elementary stream 1   elementary stream 0 
                                                               OUTPUT.mp4 
                    
                                unused
           elementary stream 2 
                               

```

The above pipeline can be constructed with the following commandline:

::: example
``` example
ffmpeg -i INPUT.mkv -map 0:1 -c copy OUTPUT.mp4
```
:::

In this commandline

- there is a single input `INPUT.mkv`{.sample};
- there are no input options for this input;
- there is a single output `OUTPUT.mp4`{.sample};
- there are two output options for this output:
  - `-map 0:1` selects the input stream to be used - from input with
    index 0 (i.e. the first one) the stream with index 1 (i.e. the
    second one);
  - `-c copy` selects the `copy` encoder, i.e. streamcopy with no
    decoding or encoding.

Streamcopy is useful for changing the elementary stream count, container
format, or modifying container-level metadata. Since there is no
decoding or encoding, it is very fast and there is no quality loss.
However, it might not work in some cases because of a variety of factors
(e.g. certain information required by the target container is not
available in the source). Applying filters is obviously also impossible,
since filters work on decoded frames.

More complex streamcopy scenarios can be constructed - e.g. combining
streams from two input files into a single output:

``` verbatim
         
 demuxer 0                     packets                        muxer   
elementary stream 0 elementary stream 0 
INPUT0.mkv                                                 OUTPUT.mp4 
                    
                                        
 demuxer 1                     packets elementary stream 1            
elementary stream 0                                
INPUT1.aac                             

```

that can be built by the commandline

::: example
``` example
ffmpeg -i INPUT0.mkv -i INPUT1.aac -map 0:0 -map 1:0 -c copy OUTPUT.mp4
```
:::

The output `-map`{.sample} option is used twice here, creating two
streams in the output file - one fed by the first input and one by the
second. The single instance of the `-c`{.sample} option selects
streamcopy for both of those streams. You could also use multiple
instances of this option together with [Stream
specifiers](#Stream-specifiers) to apply different values to each
stream, as will be demonstrated in following sections.

A converse scenario is splitting multiple streams from a single input
into multiple outputs:

``` verbatim
          
 demuxer                        packets                      muxer 0   
 elementary stream 0 elementary stream 0
                                                            OUTPUT0.mp4
INPUT.mkv           
                                packets  
           elementary stream 1                     muxer 1   
                                         elementary stream 0
                             OUTPUT1.mp4
                                            
```

built with

::: example
``` example
ffmpeg -i INPUT.mkv -map 0:0 -c copy OUTPUT0.mp4 -map 0:1 -c copy OUTPUT1.mp4
```
:::

Note how a separate instance of the `-c`{.sample} option is needed for
every output file even though their values are the same. This is because
non-global options (which is most of them) only apply in the context of
the file before which they are placed.

These examples can of course be further generalized into arbitrary
remappings of any number of inputs into any number of outputs.

[]{#Transcoding}

### [3.2 Transcoding](#toc-Transcoding) {#transcoding .section}

*Transcoding* is the process of decoding a stream and then encoding it
again. Since encoding tends to be computationally expensive and in most
cases degrades the stream quality (i.e. it is *lossy*), you should only
transcode when you need to and perform streamcopy otherwise. Typical
reasons to transcode are:

- applying filters - e.g. resizing, deinterlacing, or overlaying video;
  resampling or mixing audio;
- you want to feed the stream to something that cannot decode the
  original codec.

Note that `ffmpeg` will transcode all audio, video, and subtitle streams
unless you specify `-c copy`{.sample} for them.

Consider an example pipeline that reads an input file with one audio and
one video stream, transcodes the video and copies the audio into a
single output file. This can be schematically represented as follows

``` verbatim

 demuxer                              audio packets
 stream 0 (audio)    
                                                                    
INPUT.mkv  video         raw        
                                packets    video   video frames   
           stream 1 (video)     decoder  
                                                                 
                         
                                                                      
                                                                      
 video                   
 muxer                          packets    video                 
 stream 0 (video)     encoder  
                                         (libx264)                
OUTPUT.mp4                          
                                                                    
           stream 1 (audio)    
                               

```

and implemented with the following commandline:

::: example
``` example
ffmpeg -i INPUT.mkv -map 0:v -map 0:a -c:v libx264 -c:a copy OUTPUT.mp4
```
:::

Note how it uses stream specifiers `:v` and `:a` to select input streams
and apply different values of the `-c`{.sample} option to them; see the
[Stream specifiers](#Stream-specifiers) section for more details.

[]{#Filtering}

### [3.3 Filtering](#toc-Filtering) {#filtering .section}

When transcoding, audio and video streams can be filtered before
encoding, with either a *simple* or *complex* filtergraph.

[]{#Simple-filtergraphs}

#### [3.3.1 Simple filtergraphs](#toc-Simple-filtergraphs) {#simple-filtergraphs .subsection}

Simple filtergraphs are those that have exactly one input and output,
both of the same type (audio or video). They are configured with the
per-stream `-filter`{.sample} option (with `-vf`{.sample} and
`-af`{.sample} aliases for `-filter:v`{.sample} (video) and
`-filter:a`{.sample} (audio) respectively). Note that simple
filtergraphs are tied to their output stream, so e.g. if you have
multiple audio streams, `-af`{.sample} will create a separate
filtergraph for each one.

Taking the transcoding example from above, adding filtering (and
omitting audio, for clarity) makes it look like this:

``` verbatim

 demuxer                           
 video stream   packets    video   frames
INPUT.mkv                 decoder 
                                            
                              
                                  
                                     
                                       simple filtergraph    
                                     
                                           
                                   yadif  scale 
                                            
                                      
                                                                
                                                                
 video                   
 muxer                    packets    video                 
 video stream   encoder 
OUTPUT.mp4                                  
                                   

```

[]{#Complex-filtergraphs}

#### [3.3.2 Complex filtergraphs](#toc-Complex-filtergraphs) {#complex-filtergraphs .subsection}

Complex filtergraphs are those which cannot be described as simply a
linear processing chain applied to one stream. This is the case, for
example, when the graph has more than one input and/or output, or when
output stream type is different from input. Complex filtergraphs are
configured with the `-filter_complex`{.sample} option. Note that this
option is global, since a complex filtergraph, by its nature, cannot be
unambiguously associated with a single stream or file. Each instance of
`-filter_complex`{.sample} creates a new complex filtergraph, and there
can be any number of them.

A trivial example of a complex filtergraph is the `overlay` filter,
which has two video inputs and one video output, containing one video
overlaid on top of the other. Its audio counterpart is the `amix`
filter.

[]{#Loopback-decoders}[]{#Loopback-decoders-1}

### [3.4 Loopback decoders](#toc-Loopback-decoders-1) {#loopback-decoders .section}

While decoders are normally associated with demuxer streams, it is also
possible to create \"loopback\" decoders that decode the output from
some encoder and allow it to be fed back to complex filtergraphs. This
is done with the `-dec` directive, which takes as a parameter the index
of the output stream that should be decoded. Every such directive
creates a new loopback decoder, indexed with successive integers
starting at zero. These indices should then be used to refer to loopback
decoders in complex filtergraph link labels, as described in the
documentation for `-filter_complex`{.sample}.

Decoding AVOptions can be passed to loopback decoders by placing them
before `-dec`, analogously to input/output options.

E.g. the following example:

::: example
``` example
ffmpeg -i INPUT                                        \
  -map 0:v:0 -c:v libx264 -crf 45 -f null -            \
  -threads 3 -dec 0:0                                  \
  -filter_complex '[0:v][dec:0]hstack[stack]'          \
  -map '[stack]' -c:v ffv1 OUTPUT
```
:::

reads an input video and

- (line 2) encodes it with `libx264` at low quality;
- (line 3) decodes this encoded stream using 3 threads;
- (line 4) places decoded video side by side with the original input
  video;
- (line 5) combined video is then losslessly encoded and written into
  `OUTPUT`{.sample}.

Such a transcoding pipeline can be represented with the following
diagram:

``` verbatim

 demuxer                                    
 video stream       video                video       null muxer         
   INPUT                  decoder  encoder (discards its input)
                                       (libx264)   
                          
                                           
                                               loopback        
                                   decoder 
                                              
                                  
                                  
                                    
                                    complex filtergraph
                                    
                                        
                                    hstack    
                                                  
                                          
                                      
                                                           
                    
 muxer                       video                    
 video stream   encoder 
  OUTPUT                    (ffv1)  
                           

```

[]{#Stream-selection}[]{#Stream-selection-1}

## [4 Stream selection](#toc-Stream-selection-1) {#stream-selection .chapter}

`ffmpeg` provides the `-map` option for manual control of stream
selection in each output file. Users can skip `-map` and let ffmpeg
perform automatic stream selection as described below. The
`-vn / -an / -sn / -dn` options can be used to skip inclusion of video,
audio, subtitle and data streams respectively, whether manually mapped
or automatically selected, except for those streams which are outputs of
complex filtergraphs.

[]{#Description-1}

### [4.1 Description](#toc-Description-1) {#description-1 .section}

The sub-sections that follow describe the various rules that are
involved in stream selection. The examples that follow next show how
these rules are applied in practice.

While every effort is made to accurately reflect the behavior of the
program, FFmpeg is under continuous development and the code may have
changed since the time of this writing.

[]{#Automatic-stream-selection}

#### [4.1.1 Automatic stream selection](#toc-Automatic-stream-selection) {#automatic-stream-selection .subsection}

In the absence of any map options for a particular output file, ffmpeg
inspects the output format to check which type of streams can be
included in it, viz. video, audio and/or subtitles. For each acceptable
stream type, ffmpeg will pick one stream, when available, from among all
the inputs.

It will select that stream based upon the following criteria:

- for video, it is the stream with the highest resolution,
- for audio, it is the stream with the most channels,
- for subtitles, it is the first subtitle stream found but there's a
  caveat. The output format's default subtitle encoder can be either
  text-based or image-based, and only a subtitle stream of the same type
  will be chosen.

In the case where several streams of the same type rate equally, the
stream with the lowest index is chosen.

Data or attachment streams are not automatically selected and can only
be included using `-map`.

[]{#Manual-stream-selection}

#### [4.1.2 Manual stream selection](#toc-Manual-stream-selection) {#manual-stream-selection .subsection}

When `-map` is used, only user-mapped streams are included in that
output file, with one possible exception for filtergraph outputs
described below.

[]{#Complex-filtergraphs-1}

#### [4.1.3 Complex filtergraphs](#toc-Complex-filtergraphs-1) {#complex-filtergraphs-1 .subsection}

If there are any complex filtergraph output streams with unlabeled pads,
they will be added to the first output file. This will lead to a fatal
error if the stream type is not supported by the output format. In the
absence of the map option, the inclusion of these streams leads to the
automatic stream selection of their types being skipped. If map options
are present, these filtergraph streams are included in addition to the
mapped streams.

Complex filtergraph output streams with labeled pads must be mapped once
and exactly once.

[]{#Stream-handling}

#### [4.1.4 Stream handling](#toc-Stream-handling) {#stream-handling .subsection}

Stream handling is independent of stream selection, with an exception
for subtitles described below. Stream handling is set via the `-codec`
option addressed to streams within a specific *output* file. In
particular, codec options are applied by ffmpeg after the stream
selection process and thus do not influence the latter. If no `-codec`
option is specified for a stream type, ffmpeg will select the default
encoder registered by the output file muxer.

An exception exists for subtitles. If a subtitle encoder is specified
for an output file, the first subtitle stream found of any type, text or
image, will be included. ffmpeg does not validate if the specified
encoder can convert the selected stream or if the converted stream is
acceptable within the output format. This applies generally as well:
when the user sets an encoder manually, the stream selection process
cannot check if the encoded stream can be muxed into the output file. If
it cannot, ffmpeg will abort and *all* output files will fail to be
processed.

[]{#Examples}

### [4.2 Examples](#toc-Examples) {#examples .section}

The following examples illustrate the behavior, quirks and limitations
of ffmpeg's stream selection methods.

They assume the following three input files.

``` verbatim

input file 'A.avi'
      stream 0: video 640x360
      stream 1: audio 2 channels

input file 'B.mp4'
      stream 0: video 1920x1080
      stream 1: audio 2 channels
      stream 2: subtitles (text)
      stream 3: audio 5.1 channels
      stream 4: subtitles (text)

input file 'C.mkv'
      stream 0: video 1280x720
      stream 1: audio 2 channels
      stream 2: subtitles (image)
```

[]{#Example_003a-automatic-stream-selection}

#### Example: automatic stream selection {#example-automatic-stream-selection .subsubheading}

::: example
``` example
ffmpeg -i A.avi -i B.mp4 out1.mkv out2.wav -map 1:a -c:a copy out3.mov
```
:::

There are three output files specified, and for the first two, no `-map`
options are set, so ffmpeg will select streams for these two files
automatically.

`out1.mkv`{.sample} is a Matroska container file and accepts video,
audio and subtitle streams, so ffmpeg will try to select one of each
type.\
For video, it will select `stream 0` from `B.mp4`{.sample}, which has
the highest resolution among all the input video streams.\
For audio, it will select `stream 3` from `B.mp4`{.sample}, since it has
the greatest number of channels.\
For subtitles, it will select `stream 2` from `B.mp4`{.sample}, which is
the first subtitle stream from among `A.avi`{.sample} and
`B.mp4`{.sample}.

`out2.wav`{.sample} accepts only audio streams, so only `stream 3` from
`B.mp4`{.sample} is selected.

For `out3.mov`{.sample}, since a `-map` option is set, no automatic
stream selection will occur. The `-map 1:a` option will select all audio
streams from the second input `B.mp4`{.sample}. No other streams will be
included in this output file.

For the first two outputs, all included streams will be transcoded. The
encoders chosen will be the default ones registered by each output
format, which may not match the codec of the selected input streams.

For the third output, codec option for audio streams has been set to
`copy`, so no decoding-filtering-encoding operations will occur, or
*can* occur. Packets of selected streams shall be conveyed from the
input file and muxed within the output file.

[]{#Example_003a-automatic-subtitles-selection}

#### Example: automatic subtitles selection {#example-automatic-subtitles-selection .subsubheading}

::: example
``` example
ffmpeg -i C.mkv out1.mkv -c:s dvdsub -an out2.mkv
```
:::

Although `out1.mkv`{.sample} is a Matroska container file which accepts
subtitle streams, only a video and audio stream shall be selected. The
subtitle stream of `C.mkv`{.sample} is image-based and the default
subtitle encoder of the Matroska muxer is text-based, so a transcode
operation for the subtitles is expected to fail and hence the stream
isn't selected. However, in `out2.mkv`{.sample}, a subtitle encoder is
specified in the command and so, the subtitle stream is selected, in
addition to the video stream. The presence of `-an` disables audio
stream selection for `out2.mkv`{.sample}.

[]{#Example_003a-unlabeled-filtergraph-outputs}

#### Example: unlabeled filtergraph outputs {#example-unlabeled-filtergraph-outputs .subsubheading}

::: example
``` example
ffmpeg -i A.avi -i C.mkv -i B.mp4 -filter_complex "overlay" out1.mp4 out2.srt
```
:::

A filtergraph is setup here using the `-filter_complex` option and
consists of a single video filter. The `overlay` filter requires exactly
two video inputs, but none are specified, so the first two available
video streams are used, those of `A.avi`{.sample} and `C.mkv`{.sample}.
The output pad of the filter has no label and so is sent to the first
output file `out1.mp4`{.sample}. Due to this, automatic selection of the
video stream is skipped, which would have selected the stream in
`B.mp4`{.sample}. The audio stream with most channels viz. `stream 3` in
`B.mp4`{.sample}, is chosen automatically. No subtitle stream is chosen
however, since the MP4 format has no default subtitle encoder
registered, and the user hasn't specified a subtitle encoder.

The 2nd output file, `out2.srt`{.sample}, only accepts text-based
subtitle streams. So, even though the first subtitle stream available
belongs to `C.mkv`{.sample}, it is image-based and hence skipped. The
selected stream, `stream 2` in `B.mp4`{.sample}, is the first text-based
subtitle stream.

[]{#Example_003a-labeled-filtergraph-outputs}

#### Example: labeled filtergraph outputs {#example-labeled-filtergraph-outputs .subsubheading}

::: example
``` example
ffmpeg -i A.avi -i B.mp4 -i C.mkv -filter_complex "[1:v]hue=s=0[outv];overlay;aresample" \
       -map '[outv]' -an        out1.mp4 \
                                out2.mkv \
       -map '[outv]' -map 1:a:0 out3.mkv
```
:::

The above command will fail, as the output pad labelled `[outv]` has
been mapped twice. None of the output files shall be processed.

::: example
``` example
ffmpeg -i A.avi -i B.mp4 -i C.mkv -filter_complex "[1:v]hue=s=0[outv];overlay;aresample" \
       -an        out1.mp4 \
                  out2.mkv \
       -map 1:a:0 out3.mkv
```
:::

This command above will also fail as the hue filter output has a label,
`[outv]`, and hasn't been mapped anywhere.

The command should be modified as follows,

::: example
``` example
ffmpeg -i A.avi -i B.mp4 -i C.mkv -filter_complex "[1:v]hue=s=0,split=2[outv1][outv2];overlay;aresample" \
        -map '[outv1]' -an        out1.mp4 \
                                  out2.mkv \
        -map '[outv2]' -map 1:a:0 out3.mkv
```
:::

The video stream from `B.mp4`{.sample} is sent to the hue filter, whose
output is cloned once using the split filter, and both outputs labelled.
Then a copy each is mapped to the first and third output files.

The overlay filter, requiring two video inputs, uses the first two
unused video streams. Those are the streams from `A.avi`{.sample} and
`C.mkv`{.sample}. The overlay output isn't labelled, so it is sent to
the first output file `out1.mp4`{.sample}, regardless of the presence of
the `-map` option.

The aresample filter is sent the first unused audio stream, that of
`A.avi`{.sample}. Since this filter output is also unlabelled, it too is
mapped to the first output file. The presence of `-an` only suppresses
automatic or manual stream selection of audio streams, not outputs sent
from filtergraphs. Both these mapped streams shall be ordered before the
mapped stream in `out1.mp4`{.sample}.

The video, audio and subtitle streams mapped to `out2.mkv` are entirely
determined by automatic stream selection.

`out3.mkv`{.sample} consists of the cloned video output from the hue
filter and the first audio stream from `B.mp4`{.sample}.\

[]{#Options}

## [5 Options](#toc-Options) {#options .chapter}

All the numerical options, if not specified otherwise, accept a string
representing a number as input, which may be followed by one of the SI
unit prefixes, for example: 'K', 'M', or 'G'.

If 'i' is appended to the SI unit prefix, the complete prefix will be
interpreted as a unit prefix for binary multiples, which are based on
powers of 1024 instead of powers of 1000. Appending 'B' to the SI unit
prefix multiplies the value by 8. This allows using, for example: 'KB',
'MiB', 'G' and 'B' as number suffixes.

Options which do not take arguments are boolean options, and set the
corresponding value to true. They can be set to false by prefixing the
option name with \"no\". For example using \"-nofoo\" will set the
boolean option with name \"foo\" to false.

Options that take arguments support a special syntax where the argument
given on the command line is interpreted as a path to the file from
which the actual argument value is loaded. To use this feature, add a
forward slash '/' immediately before the option name (after the leading
dash). E.g.

::: example
``` example
ffmpeg -i INPUT -/filter:v filter.script OUTPUT
```
:::

will load a filtergraph description from the file named
`filter.script`{.sample}.

[]{#Stream-specifiers}[]{#Stream-specifiers-1}

### [5.1 Stream specifiers](#toc-Stream-specifiers-1) {#stream-specifiers .section}

Some options are applied per-stream, e.g. bitrate or codec. Stream
specifiers are used to precisely specify which stream(s) a given option
belongs to.

A stream specifier is a string generally appended to the option name and
separated from it by a colon. E.g. `-codec:a:1 ac3` contains the `a:1`
stream specifier, which matches the second audio stream. Therefore, it
would select the ac3 codec for the second audio stream.

A stream specifier can match several streams, so that the option is
applied to all of them. E.g. the stream specifier in `-b:a 128k` matches
all audio streams.

An empty stream specifier matches all streams. For example,
`-codec copy` or `-codec: copy` would copy all the streams without
reencoding.

Possible forms of stream specifiers are:

`stream_index`{.variable}

:   Matches the stream with this index. E.g. `-threads:1 4` would set
    the thread count for the second stream to 4. If
    `stream_index`{.variable} is used as an additional stream specifier
    (see below), then it selects stream number `stream_index`{.variable}
    from the matching streams. Stream numbering is based on the order of
    the streams as detected by libavformat except when a stream group
    specifier or program ID is also specified. In this case it is based
    on the ordering of the streams in the group or program.

`stream_type`{.variable}`[:`{.sample}`additional_stream_specifier`{.variable}`]`{.sample}

:   `stream_type`{.variable} is one of following: 'v' or 'V' for video,
    'a' for audio, 's' for subtitle, 'd' for data, and 't' for
    attachments. 'v' matches all video streams, 'V' only matches video
    streams which are not attached pictures, video thumbnails or cover
    arts. If `additional_stream_specifier`{.variable} is used, then it
    matches streams which both have this type and match the
    `additional_stream_specifier`{.variable}. Otherwise, it matches all
    streams of the specified type.

`g:`{.sample}`group_specifier`{.variable}`[:`{.sample}`additional_stream_specifier`{.variable}`]`{.sample}

:   Matches streams which are in the group with the specifier
    `group_specifier`{.variable}. if
    `additional_stream_specifier`{.variable} is used, then it matches
    streams which both are part of the group and match the
    `additional_stream_specifier`{.variable}.
    `group_specifier`{.variable} may be one of the following:

    `group_index`{.variable}

    :   Match the stream with this group index.

    `#`{.sample}`group_id`{.variable}` or i:`{.sample}`group_id`{.variable}

    :   Match the stream with this group id.

`p:`{.sample}`program_id`{.variable}`[:`{.sample}`additional_stream_specifier`{.variable}`]`{.sample}

:   Matches streams which are in the program with the id
    `program_id`{.variable}. If `additional_stream_specifier`{.variable}
    is used, then it matches streams which both are part of the program
    and match the `additional_stream_specifier`{.variable}.

`#`{.sample}`stream_id`{.variable}` or i:`{.sample}`stream_id`{.variable}

:   Match the stream by stream id (e.g. PID in MPEG-TS container).

`m:`{.sample}`key`{.variable}`[:`{.sample}`value`{.variable}`]`{.sample}

:   Matches streams with the metadata tag `key`{.variable} having the
    specified value. If `value`{.variable} is not given, matches streams
    that contain the given tag with any value. The colon character ':'
    in `key`{.variable} or `value`{.variable} needs to be
    backslash-escaped.

`disp:`{.sample}`dispositions`{.variable}`[:`{.sample}`additional_stream_specifier`{.variable}`]`{.sample}

:   Matches streams with the given disposition(s).
    `dispositions`{.variable} is a list of one or more dispositions (as
    printed by the `-dispositions`{.sample} option) joined with '+'.

`u`{.sample}

:   Matches streams with usable configuration, the codec must be defined
    and the essential information such as video dimension or audio
    sample rate must be present.

    Note that in `ffmpeg`, matching by metadata will only work properly
    for input files.

[]{#Generic-options}

### [5.2 Generic options](#toc-Generic-options) {#generic-options .section}

These options are shared amongst the ff\* tools.

`-L, -license`{.sample}

Show license.

`-h, -?, -help, --help [`{.sample}`arg`{.variable}`]`{.sample}

Show help. An optional parameter may be specified to print help about a
specific item. If no argument is specified, only basic (non advanced)
tool options are shown.

Possible values of `arg`{.variable} are:

`long`{.sample}

:   Print advanced tool options in addition to the basic tool options.

`full`{.sample}

:   Print complete list of options, including shared and private options
    for encoders, decoders, demuxers, muxers, filters, etc.

`decoder=`{.sample}`decoder_name`{.variable}

:   Print detailed information about the decoder named
    `decoder_name`{.variable}. Use the `-decoders`{.sample} option to
    get a list of all decoders.

`encoder=`{.sample}`encoder_name`{.variable}

:   Print detailed information about the encoder named
    `encoder_name`{.variable}. Use the `-encoders`{.sample} option to
    get a list of all encoders.

`demuxer=`{.sample}`demuxer_name`{.variable}

:   Print detailed information about the demuxer named
    `demuxer_name`{.variable}. Use the `-formats`{.sample} option to get
    a list of all demuxers and muxers.

`muxer=`{.sample}`muxer_name`{.variable}

:   Print detailed information about the muxer named
    `muxer_name`{.variable}. Use the `-formats`{.sample} option to get a
    list of all muxers and demuxers.

`filter=`{.sample}`filter_name`{.variable}

:   Print detailed information about the filter named
    `filter_name`{.variable}. Use the `-filters`{.sample} option to get
    a list of all filters.

`bsf=`{.sample}`bitstream_filter_name`{.variable}

:   Print detailed information about the bitstream filter named
    `bitstream_filter_name`{.variable}. Use the `-bsfs`{.sample} option
    to get a list of all bitstream filters.

`protocol=`{.sample}`protocol_name`{.variable}

:   Print detailed information about the protocol named
    `protocol_name`{.variable}. Use the `-protocols`{.sample} option to
    get a list of all protocols.

`-version`{.sample}

Show version.

`-buildconf`{.sample}

Show the build configuration, one option per line.

`-formats`{.sample}

Show available formats (including devices).

`-demuxers`{.sample}

Show available demuxers.

`-muxers`{.sample}

Show available muxers.

`-devices`{.sample}

Show available devices.

`-codecs`{.sample}

Show all codecs known to libavcodec.

Note that the term 'codec' is used throughout this documentation as a
shortcut for what is more correctly called a media bitstream format.

`-decoders`{.sample}

Show available decoders.

`-encoders`{.sample}

Show all available encoders.

`-bsfs`{.sample}

Show available bitstream filters.

`-protocols`{.sample}

Show available protocols.

`-filters`{.sample}

Show available libavfilter filters.

`-pix_fmts`{.sample}

Show available pixel formats.

`-sample_fmts`{.sample}

Show available sample formats.

`-layouts`{.sample}

Show channel names and standard channel layouts.

`-dispositions`{.sample}

Show stream dispositions.

`-colors`{.sample}

Show recognized color names.

`-sources `{.sample}`device`{.variable}`[,`{.sample}`opt1`{.variable}`=`{.sample}`val1`{.variable}`[,`{.sample}`opt2`{.variable}`=`{.sample}`val2`{.variable}`]...]`{.sample}

Show autodetected sources of the input device. Some devices may provide
system-dependent source names that cannot be autodetected. The returned
list cannot be assumed to be always complete.

::: example
``` example
ffmpeg -sources pulse,server=192.168.0.4
```
:::

`-sinks `{.sample}`device`{.variable}`[,`{.sample}`opt1`{.variable}`=`{.sample}`val1`{.variable}`[,`{.sample}`opt2`{.variable}`=`{.sample}`val2`{.variable}`]...]`{.sample}

Show autodetected sinks of the output device. Some devices may provide
system-dependent sink names that cannot be autodetected. The returned
list cannot be assumed to be always complete.

::: example
``` example
ffmpeg -sinks pulse,server=192.168.0.4
```
:::

`-loglevel [`{.sample}`flags`{.variable}`+]`{.sample}`loglevel`{.variable}` | -v [`{.sample}`flags`{.variable}`+]`{.sample}`loglevel`{.variable}

Set logging level and flags used by the library.

The optional `flags`{.variable} prefix can consist of the following
values:

'`repeat`{.sample}'

:   Indicates that repeated log output should not be compressed to the
    first line and the \"Last message repeated n times\" line will be
    omitted.

'`level`{.sample}'

:   Indicates that log output should add a `[level]` prefix to each
    message line. This can be used as an alternative to log coloring,
    e.g. when dumping the log to file.

'`time`{.sample}'

:   Indicates that log lines should be prefixed with time information.

'`datetime`{.sample}'

:   Indicates that log lines should be prefixed with date and time
    information.

Flags can also be used alone by adding a '+'/'-' prefix to set/reset a
single flag without affecting other `flags`{.variable} or changing
`loglevel`{.variable}. When setting both `flags`{.variable} and
`loglevel`{.variable}, a '+' separator is expected between the last
`flags`{.variable} value and before `loglevel`{.variable}.

`loglevel`{.variable} is a string or a number containing one of the
following values:

'`quiet, -8`{.sample}'

Show nothing at all; be silent.

'`panic, 0`{.sample}'

Only show fatal errors which could lead the process to crash, such as an
assertion failure. This is not currently used for anything.

'`fatal, 8`{.sample}'

Only show fatal errors. These are errors after which the process
absolutely cannot continue.

'`error, 16`{.sample}'

Show all errors, including ones which can be recovered from.

'`warning, 24`{.sample}'

Show all warnings and errors. Any message related to possibly incorrect
or unexpected events will be shown.

'`info, 32`{.sample}'

Show informative messages during processing. This is in addition to
warnings and errors. This is the default value.

'`verbose, 40`{.sample}'

Same as `info`, except more verbose.

'`debug, 48`{.sample}'

Show everything, including debugging information.

'`trace, 56`{.sample}'

For example to enable repeated log output, add the `level` prefix, and
set `loglevel`{.variable} to `verbose`:

::: example
``` example
ffmpeg -loglevel repeat+level+verbose -i input output
```
:::

Another example that enables repeated log output without affecting
current state of `level` prefix flag or `loglevel`{.variable}:

::: example
``` example
ffmpeg [...] -loglevel +repeat
```
:::

By default the program logs to stderr. If coloring is supported by the
terminal, colors are used to mark errors and warnings. Log coloring can
be disabled setting the environment variable `AV_LOG_FORCE_NOCOLOR`, or
can be forced setting the environment variable `AV_LOG_FORCE_COLOR`.

`-report`{.sample}

Dump full command line and log output to a file named
`program`{.variable}`-``YYYYMMDD`{.variable}`-``HHMMSS`{.variable}`.log`
in the current directory. This file can be useful for bug reports. It
also implies `-loglevel debug`.

Setting the environment variable `FFREPORT` to any value has the same
effect. If the value is a ':'-separated key=value sequence, these
options will affect the report; option values must be escaped if they
contain special characters or the options delimiter ':' (see the
"Quoting and escaping" section in the ffmpeg-utils manual).

The following options are recognized:

`file`{.sample}

:   set the file name to use for the report; `%p` is expanded to the
    name of the program, `%t` is expanded to a timestamp, `%%` is
    expanded to a plain `%`

`level`{.sample}

:   set the log verbosity level using a numerical value (see
    `-loglevel`).

For example, to output a report to a file named `ffreport.log`{.sample}
using a log level of `32` (alias for log level `info`):

::: example
``` example
FFREPORT=file=ffreport.log:level=32 ffmpeg -i input output
```
:::

Errors in parsing the environment variable are not fatal, and will not
appear in the report.

`-hide_banner`{.sample}

Suppress printing banner.

All FFmpeg tools will normally show a copyright notice, build options
and library versions. This option can be used to suppress printing this
information.

`-cpuflags flags (`{.sample}*`global`{.sample}*`)`{.sample}

Allows setting and clearing cpu flags. This option is intended for
testing. Do not use it unless you know what you're doing.

::: example
``` example
ffmpeg -cpuflags -sse+mmx ...
ffmpeg -cpuflags mmx ...
ffmpeg -cpuflags 0 ...
```
:::

Possible flags for this option are:

'`x86`{.sample}'

'`mmx`{.sample}'

'`mmxext`{.sample}'

'`sse`{.sample}'

'`sse2`{.sample}'

'`sse2slow`{.sample}'

'`sse3`{.sample}'

'`sse3slow`{.sample}'

'`ssse3`{.sample}'

'`atom`{.sample}'

'`sse4.1`{.sample}'

'`sse4.2`{.sample}'

'`avx`{.sample}'

'`avx2`{.sample}'

'`xop`{.sample}'

'`fma3`{.sample}'

'`fma4`{.sample}'

'`3dnow`{.sample}'

'`3dnowext`{.sample}'

'`bmi1`{.sample}'

'`bmi2`{.sample}'

'`cmov`{.sample}'

'`ARM`{.sample}'

'`armv5te`{.sample}'

'`armv6`{.sample}'

'`armv6t2`{.sample}'

'`vfp`{.sample}'

'`vfpv3`{.sample}'

'`neon`{.sample}'

'`setend`{.sample}'

'`AArch64`{.sample}'

'`armv8`{.sample}'

'`vfp`{.sample}'

'`neon`{.sample}'

'`PowerPC`{.sample}'

'`altivec`{.sample}'

'`Specific Processors`{.sample}'

'`pentium2`{.sample}'

'`pentium3`{.sample}'

'`pentium4`{.sample}'

'`k6`{.sample}'

'`k62`{.sample}'

'`athlon`{.sample}'

'`athlonxp`{.sample}'

'`k8`{.sample}'

`-cpucount `{.sample}`count`{.variable}` (`{.sample}*`global`{.sample}*`)`{.sample}

Override detection of CPU count. This option is intended for testing. Do
not use it unless you know what you're doing.

::: example
``` example
ffmpeg -cpucount 2
```
:::

`-max_alloc `{.sample}`bytes`{.variable}

Set the maximum size limit for allocating a block on the heap by
ffmpeg's family of malloc functions. Exercise **extreme caution** when
using this option. Don't use if you do not understand the full
consequence of doing so. Default is INT_MAX.

[]{#AVOptions}

### [5.3 AVOptions](#toc-AVOptions) {#avoptions .section}

These options are provided directly by the libavformat, libavdevice and
libavcodec libraries. To see the list of available AVOptions, use the
`-help`{.sample} option. They are separated into two categories:

`generic`{.sample}

:   These options can be set for any container, codec or device. Generic
    options are listed under AVFormatContext options for
    containers/devices and under AVCodecContext options for codecs.

`private`{.sample}

:   These options are specific to the given container, device or codec.
    Private options are listed under their corresponding
    containers/devices/codecs.

For example to write an ID3v2.3 header instead of a default ID3v2.4 to
an MP3 file, use the `id3v2_version`{.sample} private option of the MP3
muxer:

::: example
``` example
ffmpeg -i input.flac -id3v2_version 3 out.mp3
```
:::

All codec AVOptions are per-stream, and thus a stream specifier should
be attached to them:

::: example
``` example
ffmpeg -i multichannel.mxf -map 0:v:0 -map 0:a:0 -map 0:a:0 -c:a:0 ac3 -b:a:0 640k -ac:a:1 2 -c:a:1 aac -b:2 128k out.mp4
```
:::

In the above example, a multichannel audio stream is mapped twice for
output. The first instance is encoded with codec ac3 and bitrate 640k.
The second instance is downmixed to 2 channels and encoded with codec
aac. A bitrate of 128k is specified for it using absolute index of the
output stream.

Note: the `-nooption`{.sample} syntax cannot be used for boolean
AVOptions, use `-option 0`{.sample}/`-option 1`{.sample}.

Note: the old undocumented way of specifying per-stream AVOptions by
prepending v/a/s to the options name is now obsolete and will be removed
soon.

[]{#Main-options}

### [5.4 Main options](#toc-Main-options) {#main-options .section}

`-f `{.sample}`fmt`{.variable}` (`{.sample}*`input/output`{.sample}*`)`{.sample}

Force input or output file format. The format is normally auto detected
for input files and guessed from the file extension for output files, so
this option is not needed in most cases.

`-i `{.sample}`url`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

input file url

`-y (`{.sample}*`global`{.sample}*`)`{.sample}

Overwrite output files without asking.

`-n (`{.sample}*`global`{.sample}*`)`{.sample}

Do not overwrite output files, and exit immediately if a specified
output file already exists.

`-stream_loop `{.sample}`number`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Set number of times input stream shall be looped. Loop 0 means no loop,
loop -1 means infinite loop.

`-recast_media (`{.sample}*`global`{.sample}*`)`{.sample}

Allow forcing a decoder of a different media type than the one detected
or designated by the demuxer. Useful for decoding media data muxed as
data streams.

`-c[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`codec`{.variable}` (`{.sample}*`input/output,per-stream`{.sample}*`)`{.sample}

`-codec[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`codec`{.variable}` (`{.sample}*`input/output,per-stream`{.sample}*`)`{.sample}

Select an encoder (when used before an output file) or a decoder (when
used before an input file) for one or more streams. `codec`{.variable}
is the name of a decoder/encoder or a special value `copy` (output only)
to indicate that the stream is not to be re-encoded.

For example

::: example
``` example
ffmpeg -i INPUT -map 0 -c:v libx264 -c:a copy OUTPUT
```
:::

encodes all video streams with libx264 and copies all audio streams.

For each stream, the last matching `c` option is applied, so

::: example
``` example
ffmpeg -i INPUT -map 0 -c copy -c:v:1 libx264 -c:a:137 libvorbis OUTPUT
```
:::

will copy all the streams except the second video, which will be encoded
with libx264, and the 138th audio, which will be encoded with libvorbis.

`-t `{.sample}`duration`{.variable}` (`{.sample}*`input/output`{.sample}*`)`{.sample}

When used as an input option (before `-i`), limit the
`duration`{.variable} of data read from the input file.

When used as an output option (before an output url), stop writing the
output after its duration reaches `duration`{.variable}.

`duration`{.variable} must be a time duration specification, see
[(ffmpeg-utils)the Time duration section in the ffmpeg-utils(1)
manual](ffmpeg-utils.html#time-duration-syntax).

-to and -t are mutually exclusive and -t has priority.

`-to `{.sample}`position`{.variable}` (`{.sample}*`input/output`{.sample}*`)`{.sample}

Stop writing the output or reading the input at `position`{.variable}.
`position`{.variable} must be a time duration specification, see
[(ffmpeg-utils)the Time duration section in the ffmpeg-utils(1)
manual](ffmpeg-utils.html#time-duration-syntax).

-to and -t are mutually exclusive and -t has priority.

`-fs `{.sample}`limit_size`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

Set the file size limit, expressed in bytes. No further chunk of bytes
is written after the limit is exceeded. The size of the output file is
slightly more than the requested file size.

`-ss `{.sample}`position`{.variable}` (`{.sample}*`input/output`{.sample}*`)`{.sample}

When used as an input option (before `-i`), seeks in this input file to
`position`{.variable}. Note that in most formats it is not possible to
seek exactly, so `ffmpeg` will seek to the closest seek point before
`position`{.variable}. When transcoding and `-accurate_seek`{.sample} is
enabled (the default), this extra segment between the seek point and
`position`{.variable} will be decoded and discarded. When doing stream
copy or when `-noaccurate_seek`{.sample} is used, it will be preserved.

When used as an output option (before an output url), decodes but
discards input until the timestamps reach `position`{.variable}.

`position`{.variable} must be a time duration specification, see
[(ffmpeg-utils)the Time duration section in the ffmpeg-utils(1)
manual](ffmpeg-utils.html#time-duration-syntax).

`-sseof `{.sample}`position`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Like the `-ss` option but relative to the \"end of file\". That is
negative values are earlier in the file, 0 is at EOF.

`-isync `{.sample}`input_index`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Assign an input as a sync source.

This will take the difference between the start times of the target and
reference inputs and offset the timestamps of the target file by that
difference. The source timestamps of the two inputs should derive from
the same clock source for expected results. If `copyts` is set then
`start_at_zero` must also be set. If either of the inputs has no
starting timestamp then no sync adjustment is made.

Acceptable values are those that refer to a valid ffmpeg input index. If
the sync reference is the target index itself or `-1`{.variable}, then
no adjustment is made to target timestamps. A sync reference may not
itself be synced to any other input.

Default value is `-1`{.variable}.

`-itsoffset `{.sample}`offset`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Set the input time offset.

`offset`{.variable} must be a time duration specification, see
[(ffmpeg-utils)the Time duration section in the ffmpeg-utils(1)
manual](ffmpeg-utils.html#time-duration-syntax).

The offset is added to the timestamps of the input files. Specifying a
positive offset means that the corresponding streams are delayed by the
time duration specified in `offset`{.variable}.

`-itsscale `{.sample}`scale`{.variable}` (`{.sample}*`input,per-stream`{.sample}*`)`{.sample}

Rescale input timestamps. `scale`{.variable} should be a floating point
number.

`-timestamp `{.sample}`date`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

Set the recording timestamp in the container.

`date`{.variable} must be a date specification, see [(ffmpeg-utils)the
Date section in the ffmpeg-utils(1)
manual](ffmpeg-utils.html#date-syntax).

`-metadata[:metadata_specifier] `{.sample}`key`{.variable}`=`{.sample}`value`{.variable}` (`{.sample}*`output,per-metadata`{.sample}*`)`{.sample}

Set a metadata key/value pair.

An optional `metadata_specifier`{.variable} may be given to set metadata
on streams, chapters or programs. See `-map_metadata` documentation for
details.

This option overrides metadata set with `-map_metadata`. It is also
possible to delete metadata by using an empty value.

For example, for setting the title in the output file:

::: example
``` example
ffmpeg -i in.avi -metadata title="my title" out.flv
```
:::

To set the language of the first audio stream:

::: example
``` example
ffmpeg -i INPUT -metadata:s:a:0 language=eng OUTPUT
```
:::

`-disposition[:stream_specifier] `{.sample}`value`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

Sets the disposition flags for a stream.

Default value: by default, all disposition flags are copied from the
input stream, unless the output stream this option applies to is fed by
a complex filtergraph - in that case no disposition flags are set by
default.

`value`{.variable} is a sequence of disposition flags separated by '+'
or '-'. A '+' prefix adds the given disposition, '-' removes it. If the
first flag is also prefixed with '+' or '-', the resulting disposition
is the default value updated by `value`{.variable}. If the first flag is
not prefixed, the resulting disposition is `value`{.variable}. It is
also possible to clear the disposition by setting it to 0.

If no `-disposition` options were specified for an output file, ffmpeg
will automatically set the 'default' disposition flag on the first
stream of each type, when there are multiple streams of this type in the
output file and no stream of that type is already marked as default.

The `-dispositions` option lists the known disposition flags.

For example, to make the second audio stream the default stream:

::: example
``` example
ffmpeg -i in.mkv -c copy -disposition:a:1 default out.mkv
```
:::

To make the second subtitle stream the default stream and remove the
default disposition from the first subtitle stream:

::: example
``` example
ffmpeg -i in.mkv -c copy -disposition:s:0 0 -disposition:s:1 default out.mkv
```
:::

To add an embedded cover/thumbnail:

::: example
``` example
ffmpeg -i in.mp4 -i IMAGE -map 0 -map 1 -c copy -c:v:1 png -disposition:v:1 attached_pic out.mp4
```
:::

To add the 'original' and remove the 'comment' disposition flag from the
first audio stream without removing its other disposition flags:

::: example
``` example
ffmpeg -i in.mkv -c copy -disposition:a:0 +original-comment out.mkv
```
:::

To remove the 'original' and add the 'comment' disposition flag to the
first audio stream without removing its other disposition flags:

::: example
``` example
ffmpeg -i in.mkv -c copy -disposition:a:0 -original+comment out.mkv
```
:::

To set only the 'original' and 'comment' disposition flags on the first
audio stream (and remove its other disposition flags):

::: example
``` example
ffmpeg -i in.mkv -c copy -disposition:a:0 original+comment out.mkv
```
:::

To remove all disposition flags from the first audio stream:

::: example
``` example
ffmpeg -i in.mkv -c copy -disposition:a:0 0 out.mkv
```
:::

Not all muxers support embedded thumbnails, and those who do, only
support a few formats, like JPEG or PNG.

`-program [title=`{.sample}`title`{.variable}`:][program_num=`{.sample}`program_num`{.variable}`:]st=`{.sample}`stream`{.variable}`[:st=`{.sample}`stream`{.variable}`...] (`{.sample}*`output`{.sample}*`)`{.sample}

Creates a program with the specified `title`{.variable},
`program_num`{.variable} and adds the specified `stream`{.variable}(s)
to it.

`-stream_group [map=`{.sample}`input_file_id`{.variable}`=`{.sample}`stream_group`{.variable}`][type=`{.sample}`type`{.variable}`:]st=`{.sample}`stream`{.variable}`[:st=`{.sample}`stream`{.variable}`][:stg=`{.sample}`stream_group`{.variable}`][:id=`{.sample}`stream_group_id`{.variable}`...] (`{.sample}*`output`{.sample}*`)`{.sample}

Creates a stream group of the specified `type`{.variable} and
`stream_group_id`{.variable}, or by `map`{.variable}ping an input group,
adding the specified `stream`{.variable}(s) and/or previously defined
`stream_group`{.variable}(s) to it.

`type`{.variable} can be one of the following:

`iamf_audio_element`{.sample}

Groups `stream`{.variable}s that belong to the same IAMF Audio Element

For this group `type`{.variable}, the following options are available

`audio_element_type`{.sample}

The Audio Element type. The following values are supported:

`channel`{.sample}

:   Scalable channel audio representation

`scene`{.sample}

:   Ambisonics representation

`demixing`{.sample}

Demixing information used to reconstruct a scalable channel audio
representation. This option must be separated from the rest with a ',',
and takes the following key=value options

`parameter_id`{.sample}

:   An identifier parameters blocks in frames may refer to

`dmixp_mode`{.sample}

:   A pre-defined combination of demixing parameters

`recon_gain`{.sample}

Recon gain information used to reconstruct a scalable channel audio
representation. This option must be separated from the rest with a ',',
and takes the following key=value options

`parameter_id`{.sample}

:   An identifier parameters blocks in frames may refer to

`layer`{.sample}

A layer defining a Channel Layout in the Audio Element. This option must
be separated from the rest with a ','. Several ',' separated entries can
be defined, and at least one must be set.

It takes the following \":\"-separated key=value options

`ch_layout`{.sample}

The layer's channel layout

`flags`{.sample}

The following flags are available:

`recon_gain`{.sample}

:   Whether to signal if recon_gain is present as metadata in parameter
    blocks within frames

`output_gain`{.sample}

`output_gain_flags`{.sample}

Which channels output_gain applies to. The following flags are
available:

`FL`{.sample}

`FR`{.sample}

`BL`{.sample}

`BR`{.sample}

`TFL`{.sample}

`TFR`{.sample}

`ambisonics_mode`{.sample}

The ambisonics mode. This has no effect if audio_element_type is set to
channel.

The following values are supported:

`mono`{.sample}

:   Each ambisonics channel is coded as an individual mono stream in the
    group

`default_w`{.sample}

Default weight value

`iamf_mix_presentation`{.sample}

Groups `stream`{.variable}s that belong to all IAMF Audio Element the
same IAMF Mix Presentation references

For this group `type`{.variable}, the following options are available

`submix`{.sample}

A sub-mix within the Mix Presentation. This option must be separated
from the rest with a ','. Several ',' separated entries can be defined,
and at least one must be set.

It takes the following \":\"-separated key=value options

`parameter_id`{.sample}

An identifier parameters blocks in frames may refer to, for
post-processing the mixed audio signal to generate the audio signal for
playback

`parameter_rate`{.sample}

The sample rate duration fields in parameters blocks in frames that
refer to this `parameter_id`{.variable} are expressed as

`default_mix_gain`{.sample}

Default mix gain value to apply when there are no parameter blocks
sharing the same `parameter_id`{.variable} for a given frame

`element`{.sample}

References an Audio Element used in this Mix Presentation to generate
the final output audio signal for playback. This option must be
separated from the rest with a '\|'. Several '\|' separated entries can
be defined, and at least one must be set.

It takes the following \":\"-separated key=value options:

`stg`{.sample}

The `stream_group_id`{.variable} for an Audio Element which this sub-mix
refers to

`parameter_id`{.sample}

An identifier parameters blocks in frames may refer to, for applying any
processing to the referenced and rendered Audio Element before being
summed with other processed Audio Elements

`parameter_rate`{.sample}

The sample rate duration fields in parameters blocks in frames that
refer to this `parameter_id`{.variable} are expressed as

`default_mix_gain`{.sample}

Default mix gain value to apply when there are no parameter blocks
sharing the same `parameter_id`{.variable} for a given frame

`annotations`{.sample}

A key=value string describing the sub-mix element where \"key\" is a
string conforming to BCP-47 that specifies the language for the
\"value\" string. \"key\" must be the same as the one in the mix's
`annotations`{.variable}

`headphones_rendering_mode`{.sample}

Indicates whether the input channel-based Audio Element is rendered to
stereo loudspeakers or spatialized with a binaural renderer when played
back on headphones. This has no effect if the referenced Audio Element's
`audio_element_type`{.variable} is set to channel.

The following values are supported:

`stereo`{.sample}

`binaural`{.sample}

`layout`{.sample}

Specifies the layouts for this sub-mix on which the loudness information
was measured. This option must be separated from the rest with a '\|'.
Several '\|' separated entries can be defined, and at least one must be
set.

It takes the following \":\"-separated key=value options:

`layout_type`{.sample}

:   

    `loudspeakers`{.sample}

    :   The layout follows the loudspeaker sound system convention of
        ITU-2051-3.

    `binaural`{.sample}

    :   The layout is binaural.

`sound_system`{.sample}

:   Channel layout matching one of Sound Systems A to J of ITU-2051-3,
    plus 7.1.2 and 3.1.2 This has no effect if `layout_type`{.variable}
    is set to binaural.

`integrated_loudness`{.sample}

:   The program integrated loudness information, as defined in
    ITU-1770-4.

`digital_peak`{.sample}

:   The digital (sampled) peak value of the audio signal, as defined in
    ITU-1770-4.

`true_peak`{.sample}

:   The true peak of the audio signal, as defined in ITU-1770-4.

`dialog_anchored_loudness`{.sample}

:   The Dialogue loudness information, as defined in ITU-1770-4.

`album_anchored_loudness`{.sample}

:   The Album loudness information, as defined in ITU-1770-4.

`annotations`{.sample}

A key=value string string describing the mix where \"key\" is a string
conforming to BCP-47 that specifies the language for the \"value\"
string. \"key\" must be the same as the ones in all sub-mix element's
`annotations`{.variable}s

E.g. to create an scalable 5.1 IAMF file from several WAV input files

::: example
``` example
ffmpeg -i front.wav -i back.wav -i center.wav -i lfe.wav
-map 0:0 -map 1:0 -map 2:0 -map 3:0 -c:a opus
-stream_group type=iamf_audio_element:id=1:st=0:st=1:st=2:st=3,
demixing=parameter_id=998,
recon_gain=parameter_id=101,
layer=ch_layout=stereo,
layer=ch_layout=5.1(side),
-stream_group type=iamf_mix_presentation:id=2:stg=0:annotations=en-us=Mix_Presentation,
submix=parameter_id=100:parameter_rate=48000|element=stg=0:parameter_id=100:annotations=en-us=Scalable_Submix|layout=sound_system=stereo|layout=sound_system=5.1(side)
-streamid 0:0 -streamid 1:1 -streamid 2:2 -streamid 3:3 output.iamf
```
:::

To copy the two stream groups (Audio Element and Mix Presentation) from
an input IAMF file with four streams into an mp4 output

::: example
``` example
ffmpeg -i input.iamf -c:a copy -stream_group map=0=0:st=0:st=1:st=2:st=3 -stream_group map=0=1:stg=0
-streamid 0:0 -streamid 1:1 -streamid 2:2 -streamid 3:3 output.mp4
```
:::

`-target `{.sample}`type`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

Specify target file type (`vcd`, `svcd`, `dvd`, `dv`, `dv50`).
`type`{.variable} may be prefixed with `pal-`, `ntsc-` or `film-` to use
the corresponding standard. All the format options (bitrate, codecs,
buffer sizes) are then set automatically. You can just type:

::: example
``` example
ffmpeg -i myfile.avi -target vcd /tmp/vcd.mpg
```
:::

Nevertheless you can specify additional options as long as you know they
do not conflict with the standard, as in:

::: example
``` example
ffmpeg -i myfile.avi -target vcd -bf 2 /tmp/vcd.mpg
```
:::

The parameters set for each target are as follows.

**VCD**

::: example
``` example
pal:
-f vcd -muxrate 1411200 -muxpreload 0.44 -packetsize 2324
-s 352x288 -r 25
-codec:v mpeg1video -g 15 -b:v 1150k -maxrate:v 1150k -minrate:v 1150k -bufsize:v 327680
-ar 44100 -ac 2
-codec:a mp2 -b:a 224k

ntsc:
-f vcd -muxrate 1411200 -muxpreload 0.44 -packetsize 2324
-s 352x240 -r 30000/1001
-codec:v mpeg1video -g 18 -b:v 1150k -maxrate:v 1150k -minrate:v 1150k -bufsize:v 327680
-ar 44100 -ac 2
-codec:a mp2 -b:a 224k

film:
-f vcd -muxrate 1411200 -muxpreload 0.44 -packetsize 2324
-s 352x240 -r 24000/1001
-codec:v mpeg1video -g 18 -b:v 1150k -maxrate:v 1150k -minrate:v 1150k -bufsize:v 327680
-ar 44100 -ac 2
-codec:a mp2 -b:a 224k
```
:::

**SVCD**

::: example
``` example
pal:
-f svcd -packetsize 2324
-s 480x576 -pix_fmt yuv420p -r 25
-codec:v mpeg2video -g 15 -b:v 2040k -maxrate:v 2516k -minrate:v 0 -bufsize:v 1835008 -scan_offset 1
-ar 44100
-codec:a mp2 -b:a 224k

ntsc:
-f svcd -packetsize 2324
-s 480x480 -pix_fmt yuv420p -r 30000/1001
-codec:v mpeg2video -g 18 -b:v 2040k -maxrate:v 2516k -minrate:v 0 -bufsize:v 1835008 -scan_offset 1
-ar 44100
-codec:a mp2 -b:a 224k

film:
-f svcd -packetsize 2324
-s 480x480 -pix_fmt yuv420p -r 24000/1001
-codec:v mpeg2video -g 18 -b:v 2040k -maxrate:v 2516k -minrate:v 0 -bufsize:v 1835008 -scan_offset 1
-ar 44100
-codec:a mp2 -b:a 224k
```
:::

**DVD**

::: example
``` example
pal:
-f dvd -muxrate 10080k -packetsize 2048
-s 720x576 -pix_fmt yuv420p -r 25
-codec:v mpeg2video -g 15 -b:v 6000k -maxrate:v 9000k -minrate:v 0 -bufsize:v 1835008
-ar 48000
-codec:a ac3 -b:a 448k

ntsc:
-f dvd -muxrate 10080k -packetsize 2048
-s 720x480 -pix_fmt yuv420p -r 30000/1001
-codec:v mpeg2video -g 18 -b:v 6000k -maxrate:v 9000k -minrate:v 0 -bufsize:v 1835008
-ar 48000
-codec:a ac3 -b:a 448k

film:
-f dvd -muxrate 10080k -packetsize 2048
-s 720x480 -pix_fmt yuv420p -r 24000/1001
-codec:v mpeg2video -g 18 -b:v 6000k -maxrate:v 9000k -minrate:v 0 -bufsize:v 1835008
-ar 48000
-codec:a ac3 -b:a 448k
```
:::

**DV**

::: example
``` example
pal:
-f dv
-s 720x576 -pix_fmt yuv420p -r 25
-ar 48000 -ac 2

ntsc:
-f dv
-s 720x480 -pix_fmt yuv411p -r 30000/1001
-ar 48000 -ac 2

film:
-f dv
-s 720x480 -pix_fmt yuv411p -r 24000/1001
-ar 48000 -ac 2
```
:::

The `dv50` target is identical to the `dv` target except that the pixel
format set is `yuv422p` for all three standards.

Any user-set value for a parameter above will override the target preset
value. In that case, the output may not comply with the target standard.

`-dn (`{.sample}*`input/output`{.sample}*`)`{.sample}

As an input option, blocks all data streams of a file from being
filtered or being automatically selected or mapped for any output. See
`-discard` option to disable streams individually.

As an output option, disables data recording i.e. automatic selection or
mapping of any data stream. For full manual control see the `-map`
option.

`-dframes `{.sample}`number`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

Set the number of data frames to output. This is an obsolete alias for
`-frames:d`, which you should use instead.

`-frames[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`framecount`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

Stop writing to the stream after `framecount`{.variable} frames.

`-q[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`q`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

`-qscale[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`q`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

Use fixed quality scale (VBR). The meaning of
`q`{.variable}/`qscale`{.variable} is codec-dependent. If
`qscale`{.variable} is used without a `stream_specifier`{.variable} then
it applies only to the video stream, this is to maintain compatibility
with previous behavior and as specifying the same codec specific value
to 2 different codecs that is audio and video generally is not what is
intended when no stream_specifier is used.

[]{#filter_005foption}

`-filter[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`filtergraph`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

Create the filtergraph specified by `filtergraph`{.variable} and use it
to filter the stream.

`filtergraph`{.variable} is a description of the filtergraph to apply to
the stream, and must have a single input and a single output of the same
type of the stream. In the filtergraph, the input is associated to the
label `in`, and the output to the label `out`. See the ffmpeg-filters
manual for more information about the filtergraph syntax.

See the [-filter_complex option](#filter_005fcomplex_005foption) if you
want to create filtergraphs with multiple inputs and/or outputs.

`-reinit_filter[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`integer`{.variable}` (`{.sample}*`input,per-stream`{.sample}*`)`{.sample}

This boolean option determines if the filtergraph(s) to which this
stream is fed gets reinitialized when input frame parameters change
mid-stream. This option is enabled by default as most video and all
audio filters cannot handle deviation in input frame properties. Upon
reinitialization, existing filter state is lost, like e.g. the frame
count `n` reference available in some filters. Any frames buffered at
time of reinitialization are lost. The properties where a change
triggers reinitialization are, for video, frame resolution or pixel
format; for audio, sample format, sample rate, channel count or channel
layout.

`-drop_changed[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`integer`{.variable}` (`{.sample}*`input,per-stream`{.sample}*`)`{.sample}

This boolean option determines whether a frame with differing frame
parameters mid-stream gets dropped instead of leading to filtergraph
reinitialization, as that would lead to loss of filter state. Generally
useful to avoid corrupted yet decodable packets in live streaming
inputs. Default is false.

`-filter_threads `{.sample}`nb_threads`{.variable}` (`{.sample}*`global`{.sample}*`)`{.sample}

Defines how many threads are used to process a filter pipeline. Each
pipeline will produce a thread pool with this many threads available for
parallel processing. The default is the number of available CPUs.

`-filter_buffered_frames `{.sample}`nb_frames`{.variable}` (`{.sample}*`global`{.sample}*`)`{.sample}

Defines the maximum number of buffered frames allowed in a filtergraph.
Under normal circumstances, a filtergraph should not buffer more than a
few frames, especially if frames are being fed to it and read from it in
a balanced way (which is the intended behavior in ffmpeg). That said,
this option allows you to limit the total number of frames buffered
across all links in a filtergraph. If more frames are generated,
filtering is aborted and an error is returned. The default value is 0,
which means no limit.

`-pre[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`preset_name`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

Specify the preset for matching stream(s).

`-stats (`{.sample}*`global`{.sample}*`)`{.sample}

Log encoding progress/statistics as \"info\"-level log (see
`-loglevel`). It is on by default, to explicitly disable it you need to
specify `-nostats`.

`-stats_period `{.sample}`time`{.variable}` (`{.sample}*`global`{.sample}*`)`{.sample}

Set period at which encoding progress/statistics are updated. Default is
0.5 seconds.

`-print_graphs (`{.sample}*`global`{.sample}*`)`{.sample}

Prints execution graph details to stderr in the format set via
-print_graphs_format.

`-print_graphs_file `{.sample}`filename`{.variable}` (`{.sample}*`global`{.sample}*`)`{.sample}

Writes execution graph details to the specified file in the format set
via -print_graphs_format.

`-print_graphs_format `{.sample}`format`{.variable}` (`{.sample}*`global`{.sample}*`)`{.sample}

Sets the output format (available formats are: default, compact, csv,
flat, ini, json, xml, mermaid, mermaidhtml) The default format is json.

`-progress `{.sample}`url`{.variable}` (`{.sample}*`global`{.sample}*`)`{.sample}

Send program-friendly progress information to `url`{.variable}.

Progress information is written periodically and at the end of the
encoding process. It is made of \"`key`{.variable}=`value`{.variable}\"
lines. `key`{.variable} consists of only alphanumeric characters. The
last key of a sequence of progress information is always \"progress\"
with the value \"continue\" or \"end\".

The update period is set using `-stats_period`.

For example, log progress information to stdout:

::: example
``` example
ffmpeg -progress pipe:1 -i in.mkv out.mkv
```
:::

[]{#stdin-option}

`-stdin`{.sample}

Enable interaction on standard input. On by default unless standard
input is used as an input. To explicitly disable interaction you need to
specify `-nostdin`.

Disabling interaction on standard input is useful, for example, if
ffmpeg is in the background process group. Roughly the same result can
be achieved with `ffmpeg ... < /dev/null` but it requires a shell.

`-debug_ts (`{.sample}*`global`{.sample}*`)`{.sample}

Print timestamp/latency information. It is off by default. This option
is mostly useful for testing and debugging purposes, and the output
format may change from one version to another, so it should not be
employed by portable scripts.

See also the option `-fdebug ts`.

`-attach `{.sample}`filename`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

Add an attachment to the output file. This is supported by a few formats
like Matroska for e.g. fonts used in rendering subtitles. Attachments
are implemented as a specific type of stream, so this option will add a
new stream to the file. It is then possible to use per-stream options on
this stream in the usual way. Attachment streams created with this
option will be created after all the other streams (i.e. those created
with `-map` or automatic mappings).

Note that for Matroska you also have to set the mimetype metadata tag:

::: example
``` example
ffmpeg -i INPUT -attach DejaVuSans.ttf -metadata:s:2 mimetype=application/x-truetype-font out.mkv
```
:::

(assuming that the attachment stream will be third in the output file).

`-dump_attachment[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`filename`{.variable}` (`{.sample}*`input,per-stream`{.sample}*`)`{.sample}

Extract the matching attachment stream into a file named
`filename`{.variable}. If `filename`{.variable} is empty, then the value
of the `filename` metadata tag will be used.

E.g. to extract the first attachment to a file named 'out.ttf':

::: example
``` example
ffmpeg -dump_attachment:t:0 out.ttf -i INPUT
```
:::

To extract all attachments to files determined by the `filename` tag:

::: example
``` example
ffmpeg -dump_attachment:t "" -i INPUT
```
:::

Technical note -- attachments are implemented as codec extradata, so
this option can actually be used to extract extradata from any stream,
not just attachments.

[]{#Video-Options}

### [5.5 Video Options](#toc-Video-Options) {#video-options .section}

`-vframes `{.sample}`number`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

:   Set the number of video frames to output. This is an obsolete alias
    for `-frames:v`, which you should use instead.

`-r[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`fps`{.variable}` (`{.sample}*`input/output,per-stream`{.sample}*`)`{.sample}

:   Set frame rate (Hz value, fraction or abbreviation).

    As an input option, ignore any timestamps stored in the file and
    instead generate timestamps assuming constant frame rate
    `fps`{.variable}. This is not the same as the `-framerate`{.sample}
    option used for some input formats like image2 or v4l2 (it used to
    be the same in older versions of FFmpeg). If in doubt use
    `-framerate`{.sample} instead of the input option `-r`{.sample}.

    As an output option:

    `video encoding`{.sample}

    :   Duplicate or drop frames right before encoding them to achieve
        constant output frame rate `fps`{.variable}.

    `video streamcopy`{.sample}

    :   Indicate to the muxer that `fps`{.variable} is the stream frame
        rate. No data is dropped or duplicated in this case. This may
        produce invalid files if `fps`{.variable} does not match the
        actual stream frame rate as determined by packet timestamps. See
        also the `setts` bitstream filter.

`-fpsmax[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`fps`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

:   Set maximum frame rate (Hz value, fraction or abbreviation).

    Clamps output frame rate when output framerate is auto-set and is
    higher than this value. Useful in batch processing or when input
    framerate is wrongly detected as very high. It cannot be set
    together with `-r`. It is ignored during streamcopy.

`-s[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`size`{.variable}` (`{.sample}*`input/output,per-stream`{.sample}*`)`{.sample}

:   Set frame size.

    As an input option, this is a shortcut for the `video_size`{.sample}
    private option, recognized by some demuxers for which the frame size
    is either not stored in the file or is configurable -- e.g. raw
    video or video grabbers.

    As an output option, this inserts the `scale` video filter to the
    *end* of the corresponding filtergraph. Please use the `scale`
    filter directly to insert it at the beginning or some other place.

    The format is '`wxh`{.sample}' (default - same as source).

`-aspect[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`aspect`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

:   Set the video display aspect ratio specified by `aspect`{.variable}.

    `aspect`{.variable} can be a floating point number string, or a
    string of the form `num`{.variable}:`den`{.variable}, where
    `num`{.variable} and `den`{.variable} are the numerator and
    denominator of the aspect ratio. For example \"4:3\", \"16:9\",
    \"1.3333\", and \"1.7777\" are valid argument values.

    If used together with `-vcodec copy`{.sample}, it will affect the
    aspect ratio stored at container level, but not the aspect ratio
    stored in encoded frames, if it exists.

`-display_rotation[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`rotation`{.variable}` (`{.sample}*`input,per-stream`{.sample}*`)`{.sample}

:   Set video rotation metadata.

    `rotation`{.variable} is a decimal number specifying the amount in
    degree by which the video should be rotated counter-clockwise before
    being displayed.

    This option overrides the rotation/display transform metadata stored
    in the file, if any. When the video is being transcoded (rather than
    copied) and `-autorotate` is enabled, the video will be rotated at
    the filtering stage. Otherwise, the metadata will be written into
    the output file if the muxer supports it.

    If the `-display_hflip` and/or `-display_vflip` options are given,
    they are applied after the rotation specified by this option.

`-display_hflip[:`{.sample}`stream_specifier`{.variable}`] (`{.sample}*`input,per-stream`{.sample}*`)`{.sample}

:   Set whether on display the image should be horizontally flipped.

    See the `-display_rotation` option for more details.

`-display_vflip[:`{.sample}`stream_specifier`{.variable}`] (`{.sample}*`input,per-stream`{.sample}*`)`{.sample}

:   Set whether on display the image should be vertically flipped.

    See the `-display_rotation` option for more details.

`-vn (`{.sample}*`input/output`{.sample}*`)`{.sample}

:   As an input option, blocks all video streams of a file from being
    filtered or being automatically selected or mapped for any output.
    See `-discard` option to disable streams individually.

    As an output option, disables video recording i.e. automatic
    selection or mapping of any video stream. For full manual control
    see the `-map` option.

`-vcodec `{.sample}`codec`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

:   Set the video codec. This is an alias for `-codec:v`.

`-pass[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`n`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

:   Select the pass number (1 or 2). It is used to do two-pass video
    encoding. The statistics of the video are recorded in the first pass
    into a log file (see also the option -passlogfile), and in the
    second pass that log file is used to generate the video at the exact
    requested bitrate. On pass 1, you may just deactivate audio and set
    output to null, examples for Windows and Unix:

    ::: example
    ``` example
    ffmpeg -i foo.mov -c:v libxvid -pass 1 -an -f rawvideo -y NUL
    ffmpeg -i foo.mov -c:v libxvid -pass 1 -an -f rawvideo -y /dev/null
    ```
    :::

`-passlogfile[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`prefix`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

:   Set two-pass log file name prefix to `prefix`{.variable}, the
    default file name prefix is "ffmpeg2pass". The complete file name
    will be `PREFIX-N.log`{.sample}, where N is a number specific to the
    output stream

`-vf `{.sample}`filtergraph`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

:   Create the filtergraph specified by `filtergraph`{.variable} and use
    it to filter the stream.

    This is an alias for `-filter:v`, see the [-filter
    option](#filter_005foption).

`-autorotate`{.sample}

:   Automatically rotate the video according to file metadata. Enabled
    by default, use `-noautorotate`{.sample} to disable it.

`-autoscale`{.sample}

:   Automatically scale the video according to the resolution of first
    frame. Enabled by default, use `-noautoscale`{.sample} to disable
    it. When autoscale is disabled, all output frames of filter graph
    might not be in the same resolution and may be inadequate for some
    encoder/muxer. Therefore, it is not recommended to disable it unless
    you really know what you are doing. Disable autoscale at your own
    risk.

[]{#Advanced-Video-options}

### [5.6 Advanced Video options](#toc-Advanced-Video-options) {#advanced-video-options .section}

`-pix_fmt[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`format`{.variable}` (`{.sample}*`input/output,per-stream`{.sample}*`)`{.sample}

Set pixel format. Use `-pix_fmts` to show all the supported pixel
formats. If the selected pixel format can not be selected, ffmpeg will
print a warning and select the best pixel format supported by the
encoder. If `pix_fmt`{.variable} is prefixed by a `+`, ffmpeg will exit
with an error if the requested pixel format can not be selected, and
automatic conversions inside filtergraphs are disabled. If
`pix_fmt`{.variable} is a single `+`, ffmpeg selects the same pixel
format as the input (or graph output) and automatic conversions are
disabled.

`-sws_flags `{.sample}`flags`{.variable}` (`{.sample}*`input/output`{.sample}*`)`{.sample}

Set default flags for the libswscale library. These flags are used by
automatically inserted `scale` filters and those within simple
filtergraphs, if not overridden within the filtergraph definition.

See the [(ffmpeg-scaler)ffmpeg-scaler
manual](ffmpeg-scaler.html#scaler_005foptions) for a list of scaler
options.

`-rc_override[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`override`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

Rate control override for specific intervals, formatted as
\"int,int,int\" list separated with slashes. Two first values are the
beginning and end frame numbers, last one is quantizer to use if
positive, or quality factor if negative.

`-vstats`{.sample}

Dump video coding statistics to `vstats_HHMMSS.log`{.sample}. See the
[vstats file format](#vstats_005ffile_005fformat) section for the format
description.

`-vstats_file `{.sample}`file`{.variable}

Dump video coding statistics to `file`{.variable}. See the [vstats file
format](#vstats_005ffile_005fformat) section for the format description.

`-vstats_version `{.sample}`file`{.variable}

Specify which version of the vstats format to use. Default is `2`. See
the [vstats file format](#vstats_005ffile_005fformat) section for the
format description.

`-vtag `{.sample}`fourcc/tag`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

Force video tag/fourcc. This is an alias for `-tag:v`.

`-force_key_frames[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`time`{.variable}`[,`{.sample}`time`{.variable}`...] (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

`-force_key_frames[:`{.sample}`stream_specifier`{.variable}`] expr:`{.sample}`expr`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

`-force_key_frames[:`{.sample}`stream_specifier`{.variable}`] source (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

`-force_key_frames[:`{.sample}`stream_specifier`{.variable}`] scd_metadata (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

`force_key_frames`{.variable} can take arguments of the following form:

`time`{.variable}`[,`{.sample}`time`{.variable}`...]`{.sample}

:   If the argument consists of timestamps, ffmpeg will round the
    specified times to the nearest output timestamp as per the encoder
    time base and force a keyframe at the first frame having timestamp
    equal or greater than the computed timestamp. Note that if the
    encoder time base is too coarse, then the keyframes may be forced on
    frames with timestamps lower than the specified time. The default
    encoder time base is the inverse of the output framerate but may be
    set otherwise via `-enc_time_base`.

    If one of the times is \"`chapters`\[`delta`{.variable}\]\", it is
    expanded into the time of the beginning of all chapters in the file,
    shifted by `delta`{.variable}, expressed as a time in seconds. This
    option can be useful to ensure that a seek point is present at a
    chapter mark or any other designated place in the output file.

    For example, to insert a key frame at 5 minutes, plus key frames 0.1
    second before the beginning of every chapter:

    ::: example
    ``` example
    -force_key_frames 0:05:00,chapters-0.1
    ```
    :::

`expr:`{.sample}`expr`{.variable}

:   If the argument is prefixed with `expr:`, the string
    `expr`{.variable} is interpreted like an expression and is evaluated
    for each frame. A key frame is forced in case the evaluation is
    non-zero.

    The expression in `expr`{.variable} can contain the following
    constants:

    `n`{.sample}

    :   the number of current processed frame, starting from 0

    `n_forced`{.sample}

    :   the number of forced frames

    `prev_forced_n`{.sample}

    :   the number of the previous forced frame, it is `NAN` when no
        keyframe was forced yet

    `prev_forced_t`{.sample}

    :   the time of the previous forced frame, it is `NAN` when no
        keyframe was forced yet

    `t`{.sample}

    :   the time of the current processed frame

    For example to force a key frame every 5 seconds, you can specify:

    ::: example
    ``` example
    -force_key_frames expr:gte(t,n_forced*5)
    ```
    :::

    To force a key frame 5 seconds after the time of the last forced
    one, starting from second 13:

    ::: example
    ``` example
    -force_key_frames expr:if(isnan(prev_forced_t),gte(t,13),gte(t,prev_forced_t+5))
    ```
    :::

`source`{.sample}

:   If the argument is `source`, ffmpeg will force a key frame if the
    current frame being encoded is marked as a key frame in its source.
    In cases where this particular source frame has to be dropped,
    enforce the next available frame to become a key frame instead.

`scd_metadata`{.sample}

:   If the argument is `scd_metadata`, ffmpeg will force a key frame if
    the current frame contains a metadata entry with the key
    `lavfi.scd.time`. The metadata can be added by filters like `scdet`
    and `scdet_vulkan`. Avoid inserting filters that duplicate frames
    after `scdet`, as this can cause duplicate metadata for multiple
    frames and repeated insertion of key frames.

Note that forcing too many keyframes is very harmful for the lookahead
algorithms of certain encoders: using fixed-GOP options or similar would
be more efficient.

`-apply_cropping[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`source`{.variable}` (`{.sample}*`input,per-stream`{.sample}*`)`{.sample}

Automatically crop the video after decoding according to file metadata.
Default is *all*.

`none (0)`{.sample}

:   Don't apply any cropping metadata.

`all (1)`{.sample}

:   Apply both codec and container level croppping. This is the default
    mode.

`codec (2)`{.sample}

:   Apply codec level croppping.

`container (3)`{.sample}

:   Apply container level croppping.

`-copyinkf[:`{.sample}`stream_specifier`{.variable}`] (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

When doing stream copy, copy also non-key frames found at the beginning.

`-init_hw_device `{.sample}`type`{.variable}`[=`{.sample}`name`{.variable}`][:`{.sample}`device`{.variable}`[,`{.sample}`key=value`{.variable}`...]]`{.sample}

Initialise a new hardware device of type `type`{.variable} called
`name`{.variable}, using the given device parameters. If no name is
specified it will receive a default name of the form
\"`type`{.variable}%d\".

The meaning of `device`{.variable} and the following arguments depends
on the device type:

`cuda`{.sample}

`device`{.variable} is the number of the CUDA device.

The following options are recognized:

`primary_ctx`{.sample}

:   If set to 1, uses the primary device context instead of creating a
    new one.

Examples:

*-init_hw_device cuda:1*

:   Choose the second device on the system.

*-init_hw_device cuda:0,primary_ctx=1*

:   Choose the first device and use the primary device context.

`dxva2`{.sample}

`device`{.variable} is the number of the Direct3D 9 display adapter.

`d3d11va`{.sample}

`device`{.variable} is the number of the Direct3D 11 display adapter. If
not specified, it will attempt to use the default Direct3D 11 display
adapter or the first Direct3D 11 display adapter whose hardware VendorId
is specified by '`vendor_id`{.sample}'.

Examples:

*-init_hw_device d3d11va*

:   Create a d3d11va device on the default Direct3D 11 display adapter.

*-init_hw_device d3d11va:1*

:   Create a d3d11va device on the Direct3D 11 display adapter specified
    by index 1.

*-init_hw_device d3d11va:,vendor_id=0x8086*

:   Create a d3d11va device on the first Direct3D 11 display adapter
    whose hardware VendorId is 0x8086.

`vaapi`{.sample}

`device`{.variable} is either an X11 display name, a DRM render node or
a DirectX adapter index. If not specified, it will attempt to open the
default X11 display (*\$DISPLAY*) and then the first DRM render node
(*/dev/dri/renderD128*), or the default DirectX adapter on Windows.

The following options are recognized:

`kernel_driver`{.sample}

:   When `device`{.variable} is not specified, use this option to
    specify the name of the kernel driver associated with the desired
    device. This option is available only when the hardware acceleration
    method *drm* and *vaapi* are enabled.

`vendor_id`{.sample}

:   When `device`{.variable} and `kernel_driver`{.variable} are not
    specified, use this option to specify the vendor id associated with
    the desired device. This option is available only when the hardware
    acceleration method *drm* and *vaapi* are enabled and
    *kernel_driver* is not specified.

Examples:

*-init_hw_device vaapi*

:   Create a vaapi device on the default device.

*-init_hw_device vaapi:/dev/dri/renderD129*

:   Create a vaapi device on DRM render node
    `/dev/dri/renderD129`{.sample}.

*-init_hw_device vaapi:1*

:   Create a vaapi device on DirectX adapter 1.

*-init_hw_device vaapi:,kernel_driver=i915*

:   Create a vaapi device on a device associated with kernel driver
    '`i915`{.sample}'.

*-init_hw_device vaapi:,vendor_id=0x8086*

:   Create a vaapi device on a device associated with vendor id
    '`0x8086`{.sample}'.

`vdpau`{.sample}

`device`{.variable} is an X11 display name. If not specified, it will
attempt to open the default X11 display (*\$DISPLAY*).

`qsv`{.sample}

`device`{.variable} selects a value in '`MFX_IMPL_*`{.sample}'. Allowed
values are:

`auto`{.sample}

`sw`{.sample}

`hw`{.sample}

`auto_any`{.sample}

`hw_any`{.sample}

`hw2`{.sample}

`hw3`{.sample}

`hw4`{.sample}

If not specified, '`auto_any`{.sample}' is used. (Note that it may be
easier to achieve the desired result for QSV by creating the
platform-appropriate subdevice ('`dxva2`{.sample}' or
'`d3d11va`{.sample}' or '`vaapi`{.sample}') and then deriving a QSV
device from that.)

The following options are recognized:

`child_device`{.sample}

:   Specify a DRM render node on Linux or DirectX adapter on Windows.

`child_device_type`{.sample}

:   Choose platform-appropriate subdevice type. On Windows
    '`d3d11va`{.sample}' is used as default subdevice type when
    `--enable-libvpl` is specified at configuration time,
    '`dxva2`{.sample}' is used as default subdevice type when
    `--enable-libmfx` is specified at configuration time. On Linux user
    can use '`vaapi`{.sample}' only as subdevice type.

Examples:

*-init_hw_device qsv:hw,child_device=/dev/dri/renderD129*

:   Create a QSV device with '`MFX_IMPL_HARDWARE`{.sample}' on DRM
    render node `/dev/dri/renderD129`{.sample}.

*-init_hw_device qsv:hw,child_device=1*

:   Create a QSV device with '`MFX_IMPL_HARDWARE`{.sample}' on DirectX
    adapter 1.

*-init_hw_device qsv:hw,child_device_type=d3d11va*

:   Choose the GPU subdevice with type '`d3d11va`{.sample}' and create
    QSV device with '`MFX_IMPL_HARDWARE`{.sample}'.

*-init_hw_device qsv:hw,child_device_type=dxva2*

:   Choose the GPU subdevice with type '`dxva2`{.sample}' and create QSV
    device with '`MFX_IMPL_HARDWARE`{.sample}'.

*-init_hw_device qsv:hw,child_device=1,child_device_type=d3d11va*

:   Create a QSV device with '`MFX_IMPL_HARDWARE`{.sample}' on DirectX
    adapter 1 with subdevice type '`d3d11va`{.sample}'.

*-init_hw_device vaapi=va:/dev/dri/renderD129 -init_hw_device qsv=hw1@`va`{.variable}*

:   Create a VAAPI device called '`va`{.sample}' on
    `/dev/dri/renderD129`{.sample}, then derive a QSV device called
    '`hw1`{.sample}' from device '`va`{.sample}'.

`opencl`{.sample}

`device`{.variable} selects the platform and device as
*platform_index.device_index*.

The set of devices can also be filtered using the key-value pairs to
find only devices matching particular platform or device strings.

The strings usable as filters are:

`platform_profile`{.sample}

`platform_version`{.sample}

`platform_name`{.sample}

`platform_vendor`{.sample}

`platform_extensions`{.sample}

`device_name`{.sample}

`device_vendor`{.sample}

`driver_version`{.sample}

`device_version`{.sample}

`device_profile`{.sample}

`device_extensions`{.sample}

`device_type`{.sample}

The indices and filters must together uniquely select a device.

Examples:

*-init_hw_device opencl:0.1*

:   Choose the second device on the first platform.

*-init_hw_device opencl:,device_name=Foo9000*

:   Choose the device with a name containing the string *Foo9000*.

*-init_hw_device opencl:1,device_type=gpu,device_extensions=cl_khr_fp16*

:   Choose the GPU device on the second platform supporting the
    *cl_khr_fp16* extension.

`vulkan`{.sample}

If `device`{.variable} is an integer, it selects the device by its index
in a system-dependent list of devices. If `device`{.variable} is any
other string, it selects the first device with a name containing that
string as a substring.

The following options are recognized:

`debug`{.sample}

:   If set to 1, enables the validation layer, if installed.

`linear_images`{.sample}

:   If set to 1, images allocated by the hwcontext will be linear and
    locally mappable.

`instance_extensions`{.sample}

:   A plus separated list of additional instance extensions to enable.

`device_extensions`{.sample}

:   A plus separated list of additional device extensions to enable.

Examples:

*-init_hw_device vulkan:1*

:   Choose the second device on the system.

*-init_hw_device vulkan:RADV*

:   Choose the first device with a name containing the string *RADV*.

*-init_hw_device vulkan:0,instance_extensions=VK_KHR_wayland_surface+VK_KHR_xcb_surface*

:   Choose the first device and enable the Wayland and XCB instance
    extensions.

`-init_hw_device `{.sample}`type`{.variable}`[=`{.sample}`name`{.variable}`]@`{.sample}`source`{.variable}

Initialise a new hardware device of type `type`{.variable} called
`name`{.variable}, deriving it from the existing device with the name
`source`{.variable}.

`-init_hw_device list`{.sample}

List all hardware device types supported in this build of ffmpeg.

`-filter_hw_device `{.sample}`name`{.variable}

Pass the hardware device called `name`{.variable} to all filters in any
filter graph. This can be used to set the device to upload to with the
`hwupload` filter, or the device to map to with the `hwmap` filter.
Other filters may also make use of this parameter when they require a
hardware device. Note that this is typically only required when the
input is not already in hardware frames - when it is, filters will
derive the device they require from the context of the frames they
receive as input.

This is a global setting, so all filters will receive the same device.

`-hwaccel[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`hwaccel`{.variable}` (`{.sample}*`input,per-stream`{.sample}*`)`{.sample}

Use hardware acceleration to decode the matching stream(s). The allowed
values of `hwaccel`{.variable} are:

`none`{.sample}

:   Do not use any hardware acceleration (the default).

`auto`{.sample}

:   Automatically select the hardware acceleration method.

`vdpau`{.sample}

:   Use VDPAU (Video Decode and Presentation API for Unix) hardware
    acceleration.

`dxva2`{.sample}

:   Use DXVA2 (DirectX Video Acceleration) hardware acceleration.

`d3d11va`{.sample}

:   Use D3D11VA (DirectX Video Acceleration) hardware acceleration.

`vaapi`{.sample}

:   Use VAAPI (Video Acceleration API) hardware acceleration.

`qsv`{.sample}

:   Use the Intel QuickSync Video acceleration for video transcoding.

    Unlike most other values, this option does not enable accelerated
    decoding (that is used automatically whenever a qsv decoder is
    selected), but accelerated transcoding, without copying the frames
    into the system memory.

    For it to work, both the decoder and the encoder must support QSV
    acceleration and no filters must be used.

`videotoolbox`{.sample}

:   Use Video Toolbox hardware acceleration.

This option has no effect if the selected hwaccel is not available or
not supported by the chosen decoder.

Note that most acceleration methods are intended for playback and will
not be faster than software decoding on modern CPUs. Additionally,
`ffmpeg` will usually need to copy the decoded frames from the GPU
memory into the system memory, resulting in further performance loss.
This option is thus mainly useful for testing.

`-hwaccel_device[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`hwaccel_device`{.variable}` (`{.sample}*`input,per-stream`{.sample}*`)`{.sample}

Select a device to use for hardware acceleration.

This option only makes sense when the `-hwaccel`{.sample} option is also
specified. It can either refer to an existing device created with
`-init_hw_device`{.sample} by name, or it can create a new device as if
'`-init_hw_device`{.sample}'
`type`{.variable}:`hwaccel_device`{.variable} were called immediately
before.

`-hwaccels`{.sample}

List all hardware acceleration components enabled in this build of
ffmpeg. Actual runtime availability depends on the hardware and its
suitable driver being installed.

`-fix_sub_duration_heartbeat[:`{.sample}`stream_specifier`{.variable}`]`{.sample}

Set a specific output video stream as the heartbeat stream according to
which to split and push through currently in-progress subtitle upon
receipt of a random access packet.

This lowers the latency of subtitles for which the end packet or the
following subtitle has not yet been received. As a drawback, this will
most likely lead to duplication of subtitle events in order to cover the
full duration, so when dealing with use cases where latency of when the
subtitle event is passed on to output is not relevant this option should
not be utilized.

Requires `-fix_sub_duration`{.sample} to be set for the relevant input
subtitle stream for this to have any effect, as well as for the input
subtitle stream having to be directly mapped to the same output in which
the heartbeat stream resides.

[]{#Audio-Options}

### [5.7 Audio Options](#toc-Audio-Options) {#audio-options .section}

`-aframes `{.sample}`number`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

:   Set the number of audio frames to output. This is an obsolete alias
    for `-frames:a`, which you should use instead.

`-ar[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`freq`{.variable}` (`{.sample}*`input/output,per-stream`{.sample}*`)`{.sample}

:   Set the audio sampling frequency. For output streams it is set by
    default to the frequency of the corresponding input stream. For
    input streams this option only makes sense for audio grabbing
    devices and raw demuxers and is mapped to the corresponding demuxer
    options.

`-aq `{.sample}`q`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

:   Set the audio quality (codec-specific, VBR). This is an alias for
    -q:a.

`-ac[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`channels`{.variable}` (`{.sample}*`input/output,per-stream`{.sample}*`)`{.sample}

:   Set the number of audio channels. For output streams it is set by
    default to the number of input audio channels. For input streams
    this option only makes sense for audio grabbing devices and raw
    demuxers and is mapped to the corresponding demuxer options.

`-an (`{.sample}*`input/output`{.sample}*`)`{.sample}

:   As an input option, blocks all audio streams of a file from being
    filtered or being automatically selected or mapped for any output.
    See `-discard` option to disable streams individually.

    As an output option, disables audio recording i.e. automatic
    selection or mapping of any audio stream. For full manual control
    see the `-map` option.

`-acodec `{.sample}`codec`{.variable}` (`{.sample}*`input/output`{.sample}*`)`{.sample}

:   Set the audio codec. This is an alias for `-codec:a`.

`-sample_fmt[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`sample_fmt`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

:   Set the audio sample format. Use `-sample_fmts` to get a list of
    supported sample formats.

`-af `{.sample}`filtergraph`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

:   Create the filtergraph specified by `filtergraph`{.variable} and use
    it to filter the stream.

    This is an alias for `-filter:a`, see the [-filter
    option](#filter_005foption).

[]{#Advanced-Audio-options}

### [5.8 Advanced Audio options](#toc-Advanced-Audio-options) {#advanced-audio-options .section}

`-atag `{.sample}`fourcc/tag`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

:   Force audio tag/fourcc. This is an alias for `-tag:a`.

`-ch_layout[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`layout`{.variable}` (`{.sample}*`input/output,per-stream`{.sample}*`)`{.sample}

:   Alias for `-channel_layout`.

`-channel_layout[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`layout`{.variable}` (`{.sample}*`input/output,per-stream`{.sample}*`)`{.sample}

:   Set the audio channel layout. For output streams it is set by
    default to the input channel layout. For input streams it overrides
    the channel layout of the input. Not all decoders respect the
    overridden channel layout. This option also sets the channel layout
    for audio grabbing devices and raw demuxers and is mapped to the
    corresponding demuxer option.

`-guess_layout_max `{.sample}`channels`{.variable}` (`{.sample}*`input,per-stream`{.sample}*`)`{.sample}

:   If some input channel layout is not known, try to guess only if it
    corresponds to at most the specified number of channels. For
    example, 2 tells to `ffmpeg` to recognize 1 channel as mono and 2
    channels as stereo but not 6 channels as 5.1. The default is to
    always try to guess. Use 0 to disable all guessing. Using the
    `-channel_layout` option to explicitly specify an input layout also
    disables guessing.

[]{#Subtitle-options}

### [5.9 Subtitle options](#toc-Subtitle-options) {#subtitle-options .section}

`-scodec `{.sample}`codec`{.variable}` (`{.sample}*`input/output`{.sample}*`)`{.sample}

:   Set the subtitle codec. This is an alias for `-codec:s`.

`-sn (`{.sample}*`input/output`{.sample}*`)`{.sample}

:   As an input option, blocks all subtitle streams of a file from being
    filtered or being automatically selected or mapped for any output.
    See `-discard` option to disable streams individually.

    As an output option, disables subtitle recording i.e. automatic
    selection or mapping of any subtitle stream. For full manual control
    see the `-map` option.

[]{#Advanced-Subtitle-options}

### [5.10 Advanced Subtitle options](#toc-Advanced-Subtitle-options) {#advanced-subtitle-options .section}

`-fix_sub_duration`{.sample}

:   Fix subtitles durations. For each subtitle, wait for the next packet
    in the same stream and adjust the duration of the first to avoid
    overlap. This is necessary with some subtitles codecs, especially
    DVB subtitles, because the duration in the original packet is only a
    rough estimate and the end is actually marked by an empty subtitle
    frame. Failing to use this option when necessary can result in
    exaggerated durations or muxing failures due to non-monotonic
    timestamps.

    Note that this option will delay the output of all data until the
    next subtitle packet is decoded: it may increase memory consumption
    and latency a lot.

`-canvas_size `{.sample}`size`{.variable}

:   Set the size of the canvas used to render subtitles.

[]{#Advanced-options}

### [5.11 Advanced options](#toc-Advanced-options) {#advanced-options .section}

`-map [-]`{.sample}`input_file_id`{.variable}`[:`{.sample}`stream_specifier`{.variable}`][:`{.sample}`view_specifier`{.variable}`][:?] | `{.sample}`[linklabel]`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

:   Create one or more streams in the output file. This option has two
    forms for specifying the data source(s): the first selects one or
    more streams from some input file (specified with `-i`), the second
    takes an output from some complex filtergraph (specified with
    `-filter_complex`).

    In the first form, an output stream is created for every stream from
    the input file with the index `input_file_id`{.variable}. If
    `stream_specifier`{.variable} is given, only those streams that
    match the specifier are used (see the [Stream
    specifiers](#Stream-specifiers) section for the
    `stream_specifier`{.variable} syntax).

    A `-` character before the stream identifier creates a \"negative\"
    mapping. It disables matching streams from already created mappings.

    An optional `view_specifier`{.variable} may be given after the
    stream specifier, which for multiview video specifies the view to be
    used. The view specifier may have one of the following formats:

    `view:`{.sample}`view_id`{.variable}

    :   select a view by its ID; `view_id`{.variable} may be set to
        'all' to use all the views interleaved into one stream;

    `vidx:`{.sample}`view_idx`{.variable}

    :   select a view by its index; i.e. 0 is the base view, 1 is the
        first non-base view, etc.

    `vpos:`{.sample}`position`{.variable}

    :   select a view by its display position; `position`{.variable} may
        be `left` or `right`

    The default for transcoding is to only use the base view, i.e. the
    equivalent of `vidx:0`. For streamcopy, view specifiers are not
    supported and all views are always copied.

    A trailing `?` after the stream index will allow the map to be
    optional: if the map matches no streams the map will be ignored
    instead of failing. Note the map will still fail if an invalid input
    file index is used; such as if the map refers to a non-existent
    input.

    An alternative `[linklabel]`{.variable} form will map outputs from
    complex filter graphs (see the `-filter_complex`{.sample} option) to
    the output file. `linklabel`{.variable} must correspond to a defined
    output link label in the graph.

    This option may be specified multiple times, each adding more
    streams to the output file. Any given input stream may also be
    mapped any number of times as a source for different output streams,
    e.g. in order to use different encoding options and/or filters. The
    streams are created in the output in the same order in which the
    `-map` options are given on the commandline.

    Using this option disables the default mappings for this output
    file.

    Examples:

    *map everything*

    :   To map ALL streams from the first input file to output

        ::: example
        ``` example
        ffmpeg -i INPUT -map 0 output
        ```
        :::

    *select specific stream*

    :   If you have two audio streams in the first input file, these
        streams are identified by `0:0`{.variable} and `0:1`{.variable}.
        You can use `-map` to select which streams to place in an output
        file. For example:

        ::: example
        ``` example
        ffmpeg -i INPUT -map 0:1 out.wav
        ```
        :::

        will map the second input stream in `INPUT`{.sample} to the
        (single) output stream in `out.wav`{.sample}.

    *create multiple streams*

    :   To select the stream with index 2 from input file
        `a.mov`{.sample} (specified by the identifier `0:2`{.variable}),
        and stream with index 6 from input `b.mov`{.sample} (specified
        by the identifier `1:6`{.variable}), and copy them to the output
        file `out.mov`{.sample}:

        ::: example
        ``` example
        ffmpeg -i a.mov -i b.mov -c copy -map 0:2 -map 1:6 out.mov
        ```
        :::

    *create multiple streams 2*

    :   To select all video and the third audio stream from an input
        file:

        ::: example
        ``` example
        ffmpeg -i INPUT -map 0:v -map 0:a:2 OUTPUT
        ```
        :::

    *negative map*

    :   To map all the streams except the second audio, use negative
        mappings

        ::: example
        ``` example
        ffmpeg -i INPUT -map 0 -map -0:a:1 OUTPUT
        ```
        :::

    *optional map*

    :   To map the video and audio streams from the first input, and
        using the trailing `?`, ignore the audio mapping if no audio
        streams exist in the first input:

        ::: example
        ``` example
        ffmpeg -i INPUT -map 0:v -map 0:a? OUTPUT
        ```
        :::

    *map by language*

    :   To pick the English audio stream:

        ::: example
        ``` example
        ffmpeg -i INPUT -map 0:m:language:eng OUTPUT
        ```
        :::

`-ignore_unknown`{.sample}

:   Ignore input streams with unknown type instead of failing if copying
    such streams is attempted.

`-copy_unknown`{.sample}

:   Allow input streams with unknown type to be copied instead of
    failing if copying such streams is attempted.

`-map_metadata[:`{.sample}`metadata_spec_out`{.variable}`] `{.sample}`infile`{.variable}`[:`{.sample}`metadata_spec_in`{.variable}`] (`{.sample}*`output,per-metadata`{.sample}*`)`{.sample}

:   Set metadata information of the next output file from
    `infile`{.variable}. Note that those are file indices (zero-based),
    not filenames. Optional `metadata_spec_in/out`{.variable} parameters
    specify, which metadata to copy. A metadata specifier can have the
    following forms:

    `g`{.variable}

    :   global metadata, i.e. metadata that applies to the whole file

    `s`{.variable}`[:`{.sample}`stream_spec`{.variable}`]`{.sample}

    :   per-stream metadata. `stream_spec`{.variable} is a stream
        specifier as described in the [Stream
        specifiers](#Stream-specifiers) chapter. In an input metadata
        specifier, the first matching stream is copied from. In an
        output metadata specifier, all matching streams are copied to.

    `c`{.variable}`:`{.sample}`chapter_index`{.variable}

    :   per-chapter metadata. `chapter_index`{.variable} is the
        zero-based chapter index.

    `p`{.variable}`:`{.sample}`program_index`{.variable}

    :   per-program metadata. `program_index`{.variable} is the
        zero-based program index.

    If metadata specifier is omitted, it defaults to global.

    By default, global metadata is copied from the first input file,
    per-stream and per-chapter metadata is copied along with
    streams/chapters. These default mappings are disabled by creating
    any mapping of the relevant type. A negative file index can be used
    to create a dummy mapping that just disables automatic copying.

    For example to copy metadata from the first stream of the input file
    to global metadata of the output file:

    ::: example
    ``` example
    ffmpeg -i in.ogg -map_metadata 0:s:0 out.mp3
    ```
    :::

    To do the reverse, i.e. copy global metadata to all audio streams:

    ::: example
    ``` example
    ffmpeg -i in.mkv -map_metadata:s:a 0:g out.mkv
    ```
    :::

    Note that simple `0` would work as well in this example, since
    global metadata is assumed by default.

`-map_chapters `{.sample}`input_file_index`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

:   Copy chapters from input file with index
    `input_file_index`{.variable} to the next output file. If no chapter
    mapping is specified, then chapters are copied from the first input
    file with at least one chapter. Use a negative file index to disable
    any chapter copying.

`-benchmark (`{.sample}*`global`{.sample}*`)`{.sample}

:   Show benchmarking information at the end of an encode. Shows real,
    system and user time used and maximum memory consumption. Maximum
    memory consumption is not supported on all systems, it will usually
    display as 0 if not supported.

`-benchmark_all (`{.sample}*`global`{.sample}*`)`{.sample}

:   Show benchmarking information during the encode. Shows real, system
    and user time used in various steps (audio/video encode/decode).

`-timelimit `{.sample}`duration`{.variable}` (`{.sample}*`global`{.sample}*`)`{.sample}

:   Exit after ffmpeg has been running for `duration`{.variable} seconds
    in CPU user time.

`-dump (`{.sample}*`global`{.sample}*`)`{.sample}

:   Dump each input packet to stderr.

`-hex (`{.sample}*`global`{.sample}*`)`{.sample}

:   When dumping packets, also dump the payload.

`-readrate `{.sample}`speed`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

:   Limit input read speed.

    Its value is a floating-point positive number which represents the
    maximum duration of media, in seconds, that should be ingested in
    one second of wallclock time. Default value is zero and represents
    no imposed limitation on speed of ingestion. Value `1` represents
    real-time speed and is equivalent to `-re`.

    Mainly used to simulate a capture device or live input stream (e.g.
    when reading from a file). Should not be used with a low value when
    input is an actual capture device or live stream as it may cause
    packet loss.

    It is useful for when flow speed of output packets is important,
    such as live streaming.

`-re (`{.sample}*`input`{.sample}*`)`{.sample}

:   Read input at native frame rate. This is equivalent to setting
    `-readrate 1`.

`-readrate_initial_burst `{.sample}`seconds`{.variable}

:   Set an initial read burst time, in seconds, after which
    `-re/-readrate`{.sample} will be enforced.

`-readrate_catchup `{.sample}`speed`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

:   If either the input or output is blocked leading to actual read
    speed falling behind the specified readrate, then this rate takes
    effect till the input catches up with the specified readrate. Must
    not be lower than the primary readrate.

`-vsync `{.sample}`parameter`{.variable}` (`{.sample}*`global`{.sample}*`)`{.sample}\
`-fps_mode[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`parameter`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

:   Set video sync method / framerate mode. vsync is applied to all
    output video streams but can be overridden for a stream by setting
    fps_mode. vsync is deprecated and will be removed in the future.

    For compatibility reasons some of the values for vsync can be
    specified as numbers (shown in parentheses in the following table).

    `passthrough (0)`{.sample}

    :   Each frame is passed with its timestamp from the demuxer to the
        muxer.

    `cfr (1)`{.sample}

    :   Frames will be duplicated and dropped to achieve exactly the
        requested constant frame rate.

    `vfr (2)`{.sample}

    :   Frames are passed through with their timestamp or dropped so as
        to prevent 2 frames from having the same timestamp.

    `auto (-1)`{.sample}

    :   Chooses between cfr and vfr depending on muxer capabilities.
        This is the default method.

    Note that the timestamps may be further modified by the muxer, after
    this. For example, in the case that the format option
    `avoid_negative_ts`{.sample} is enabled.

    With -map you can select from which stream the timestamps should be
    taken. You can leave either video or audio unchanged and sync the
    remaining stream(s) to the unchanged one.

`-frame_drop_threshold `{.sample}`parameter`{.variable}

:   Frame drop threshold, which specifies how much behind video frames
    can be before they are dropped. In frame rate units, so 1.0 is one
    frame. The default is -1.1. One possible usecase is to avoid
    framedrops in case of noisy timestamps or to increase frame drop
    precision in case of exact timestamps.

`-apad `{.sample}`parameters`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

:   Pad the output audio stream(s). This is the same as applying
    `-af apad`. Argument is a string of filter parameters composed the
    same as with the `apad` filter. `-shortest` must be set for this
    output for the option to take effect.

`-copyts`{.sample}

:   Do not process input timestamps, but keep their values without
    trying to sanitize them. In particular, do not remove the initial
    start time offset value.

    Note that, depending on the `vsync`{.sample} option or on specific
    muxer processing (e.g. in case the format option
    `avoid_negative_ts`{.sample} is enabled) the output timestamps may
    mismatch with the input timestamps even when this option is
    selected.

`-start_at_zero`{.sample}

:   When used with `copyts`{.sample}, shift input timestamps so they
    start at zero.

    This means that using e.g. `-ss 50` will make output timestamps
    start at 50 seconds, regardless of what timestamp the input file
    started at.

`-copytb `{.sample}`mode`{.variable}

:   Specify how to set the encoder timebase when stream copying.
    `mode`{.variable} is an integer numeric value, and can assume one of
    the following values:

    `1`{.sample}

    :   Use the demuxer timebase.

        The time base is copied to the output encoder from the
        corresponding input demuxer. This is sometimes required to avoid
        non monotonically increasing timestamps when copying video
        streams with variable frame rate.

    `0`{.sample}

    :   Use the decoder timebase.

        The time base is copied to the output encoder from the
        corresponding input decoder.

    `-1`{.sample}

    :   Try to make the choice automatically, in order to generate a
        sane output.

    Default value is -1.

`-enc_time_base[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`timebase`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

:   Set the encoder timebase. `timebase`{.variable} can assume one of
    the following values:

    `0`{.sample}

    :   Assign a default value according to the media type.

        For video - use 1/framerate, for audio - use 1/samplerate.

    `demux`{.sample}

    :   Use the timebase from the demuxer.

    `filter`{.sample}

    :   Use the timebase from the filtergraph.

    `a positive number`{.sample}

    :   Use the provided number as the timebase.

        This field can be provided as a ratio of two integers (e.g.
        1:24, 1:48000) or as a decimal number (e.g. 0.04166, 2.0833e-5)

    Default value is 0.

`-bitexact (`{.sample}*`input/output`{.sample}*`)`{.sample}

:   Enable bitexact mode for (de)muxer and (de/en)coder

`-shortest (`{.sample}*`output`{.sample}*`)`{.sample}

:   Finish encoding when the shortest output stream ends.

    Note that this option may require buffering frames, which introduces
    extra latency. The maximum amount of this latency may be controlled
    with the `-shortest_buf_duration` option.

`-shortest_buf_duration `{.sample}`duration`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

:   The `-shortest` option may require buffering potentially large
    amounts of data when at least one of the streams is \"sparse\" (i.e.
    has large gaps between frames -- this is typically the case for
    subtitles).

    This option controls the maximum duration of buffered frames in
    seconds. Larger values may allow the `-shortest` option to produce
    more accurate results, but increase memory use and latency.

    The default value is 10 seconds.

`-dts_delta_threshold `{.sample}`threshold`{.variable}

:   Timestamp discontinuity delta threshold, expressed as a decimal
    number of seconds.

    The timestamp discontinuity correction enabled by this option is
    only applied to input formats accepting timestamp discontinuity (for
    which the `AVFMT_TS_DISCONT` flag is enabled), e.g. MPEG-TS and HLS,
    and is automatically disabled when employing the `-copyts` option
    (unless wrapping is detected).

    If a timestamp discontinuity is detected whose absolute value is
    greater than `threshold`{.variable}, ffmpeg will remove the
    discontinuity by decreasing/increasing the current DTS and PTS by
    the corresponding delta value.

    The default value is 10.

`-dts_error_threshold `{.sample}`threshold`{.variable}

:   Timestamp error delta threshold, expressed as a decimal number of
    seconds.

    The timestamp correction enabled by this option is only applied to
    input formats not accepting timestamp discontinuity (for which the
    `AVFMT_TS_DISCONT` flag is not enabled).

    If a timestamp discontinuity is detected whose absolute value is
    greater than `threshold`{.variable}, ffmpeg will drop the PTS/DTS
    timestamp value.

    The default value is `3600*30` (30 hours), which is arbitrarily
    picked and quite conservative.

`-muxdelay `{.sample}`seconds`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

:   Set the maximum demux-decode delay.

`-muxpreload `{.sample}`seconds`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

:   Set the initial demux-decode delay.

`-streamid `{.sample}`output-stream-index`{.variable}`:`{.sample}`new-value`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

:   Assign a new stream-id value to an output stream. This option should
    be specified prior to the output filename to which it applies. For
    the situation where multiple output files exist, a streamid may be
    reassigned to a different value.

    For example, to set the stream 0 PID to 33 and the stream 1 PID to
    36 for an output mpegts file:

    ::: example
    ``` example
    ffmpeg -i inurl -streamid 0:33 -streamid 1:36 out.ts
    ```
    :::

`-bsf[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`bitstream_filters`{.variable}` (`{.sample}*`input/output,per-stream`{.sample}*`)`{.sample}

:   Apply bitstream filters to matching streams. The filters are applied
    to each packet as it is received from the demuxer (when used as an
    input option) or before it is sent to the muxer (when used as an
    output option).

    `bitstream_filters`{.variable} is a comma-separated list of
    bitstream filter specifications, each of the form

    ::: example
    ``` example
    filter[=optname0=optval0:optname1=optval1:...]
    ```
    :::

    Any of the ',=:' characters that are to be a part of an option value
    need to be escaped with a backslash.

    Use the `-bsfs` option to get the list of bitstream filters.

    E.g.

    ::: example
    ``` example
    ffmpeg -bsf:v h264_mp4toannexb -i h264.mp4 -c:v copy -an out.h264
    ```
    :::

    applies the `h264_mp4toannexb` bitstream filter (which converts
    MP4-encapsulated H.264 stream to Annex B) to the *input* video
    stream.

    On the other hand,

    ::: example
    ``` example
    ffmpeg -i file.mov -an -vn -bsf:s mov2textsub -c:s copy -f rawvideo sub.txt
    ```
    :::

    applies the `mov2textsub` bitstream filter (which extracts text from
    MOV subtitles) to the *output* subtitle stream. Note, however, that
    since both examples use `-c copy`, it matters little whether the
    filters are applied on input or output - that would change if
    transcoding was happening.

`-tag[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`codec_tag`{.variable}` (`{.sample}*`input/output,per-stream`{.sample}*`)`{.sample}

:   Force a tag/fourcc for matching streams.

`-timecode `{.sample}`hh`{.variable}`:`{.sample}`mm`{.variable}`:`{.sample}`ss`{.variable}`SEP`{.sample}`ff`{.variable}

:   Specify Timecode for writing. `SEP`{.variable} is ':' for non drop
    timecode and ';' (or '.') for drop.

    ::: example
    ``` example
    ffmpeg -i input.mpg -timecode 01:02:03.04 -r 30000/1001 -s ntsc output.mpg
    ```
    :::

    []{#filter_005fcomplex_005foption}

`-filter_complex `{.sample}`filtergraph`{.variable}` (`{.sample}*`global`{.sample}*`)`{.sample}

:   Define a complex filtergraph, i.e. one with arbitrary number of
    inputs and/or outputs. For simple graphs -- those with one input and
    one output of the same type -- see the `-filter`{.sample} options.
    `filtergraph`{.variable} is a description of the filtergraph, as
    described in the "Filtergraph syntax" section of the ffmpeg-filters
    manual. This option may be specified multiple times - each use
    creates a new complex filtergraph.

    Inputs to a complex filtergraph may come from different source
    types, distinguished by the format of the corresponding link label:

    - To connect an input stream, use `[file_index:stream_specifier]`
      (i.e. the same syntax as `-map`{.sample}). If
      `stream_specifier`{.variable} matches multiple streams, the first
      one will be used. For multiview video, the stream specifier may be
      followed by the view specifier, see documentation for the
      `-map`{.sample} option for its syntax.

    - To connect a loopback decoder use \[dec:`dec_idx`{.variable}\],
      where `dec_idx`{.variable} is the index of the loopback decoder to
      be connected to given input. For multiview video, the decoder
      index may be followed by the view specifier, see documentation for
      the `-map`{.sample} option for its syntax.

    - To connect an output from another complex filtergraph, use its
      link label. E.g the following example:

      ::: example
      ``` example
      ffmpeg -i input.mkv \
        -filter_complex '[0:v]scale=size=hd1080,split=outputs=2[for_enc][orig_scaled]' \
        -c:v libx264 -map '[for_enc]' output.mkv \
        -dec 0:0 \
        -filter_complex '[dec:0][orig_scaled]hstack[stacked]' \
        -map '[stacked]' -c:v ffv1 comparison.mkv
      ```
      :::

      reads an input video and

      - (line 2) uses a complex filtergraph with one input and two
        outputs to scale the video to 1920x1080 and duplicate the result
        to both outputs;
      - (line 3) encodes one scaled output with `libx264` and writes the
        result to `output.mkv`{.sample};
      - (line 4) decodes this encoded stream with a loopback decoder;
      - (line 5) places the output of the loopback decoder (i.e. the
        `libx264`-encoded video) side by side with the scaled original
        input;
      - (line 6) combined video is then losslessly encoded and written
        into `comparison.mkv`{.sample}.

      Note that the two filtergraphs cannot be combined into one,
      because then there would be a cycle in the transcoding pipeline
      (filtergraph output goes to encoding, from there to decoding, then
      back to the same graph), and such cycles are not allowed.

    An unlabeled input will be connected to the first unused input
    stream of the matching type.

    Output link labels are referred to with `-map`{.sample}. Unlabeled
    outputs are added to the first output file.

    Note that with this option it is possible to use only lavfi sources
    without normal input files.

    For example, to overlay an image over video

    ::: example
    ``` example
    ffmpeg -i video.mkv -i image.png -filter_complex '[0:v][1:v]overlay[out]' -map
    '[out]' out.mkv
    ```
    :::

    Here `[0:v]` refers to the first video stream in the first input
    file, which is linked to the first (main) input of the overlay
    filter. Similarly the first video stream in the second input is
    linked to the second (overlay) input of overlay.

    Assuming there is only one video stream in each input file, we can
    omit input labels, so the above is equivalent to

    ::: example
    ``` example
    ffmpeg -i video.mkv -i image.png -filter_complex 'overlay[out]' -map
    '[out]' out.mkv
    ```
    :::

    Furthermore we can omit the output label and the single output from
    the filter graph will be added to the output file automatically, so
    we can simply write

    ::: example
    ``` example
    ffmpeg -i video.mkv -i image.png -filter_complex 'overlay' out.mkv
    ```
    :::

    As a special exception, you can use a bitmap subtitle stream as
    input: it will be converted into a video with the same size as the
    largest video in the file, or 720x576 if no video is present. Note
    that this is an experimental and temporary solution. It will be
    removed once libavfilter has proper support for subtitles.

    For example, to hardcode subtitles on top of a DVB-T recording
    stored in MPEG-TS format, delaying the subtitles by 1 second:

    ::: example
    ``` example
    ffmpeg -i input.ts -filter_complex \
      '[#0x2ef] setpts=PTS+1/TB [sub] ; [#0x2d0] [sub] overlay' \
      -sn -map '#0x2dc' output.mkv
    ```
    :::

    (0x2d0, 0x2dc and 0x2ef are the MPEG-TS PIDs of respectively the
    video, audio and subtitles streams; 0:0, 0:3 and 0:7 would have
    worked too)

    To generate 5 seconds of pure red video using lavfi `color` source:

    ::: example
    ``` example
    ffmpeg -filter_complex 'color=c=red' -t 5 out.mkv
    ```
    :::

`-filter_complex_threads `{.sample}`nb_threads`{.variable}` (`{.sample}*`global`{.sample}*`)`{.sample}

:   Defines how many threads are used to process a filter_complex graph.
    Similar to filter_threads but used for `-filter_complex` graphs
    only. The default is the number of available CPUs.

`-lavfi `{.sample}`filtergraph`{.variable}` (`{.sample}*`global`{.sample}*`)`{.sample}

:   Define a complex filtergraph, i.e. one with arbitrary number of
    inputs and/or outputs. Equivalent to `-filter_complex`{.sample}.

`-accurate_seek (`{.sample}*`input`{.sample}*`)`{.sample}

:   This option enables or disables accurate seeking in input files with
    the `-ss`{.sample} option. It is enabled by default, so seeking is
    accurate when transcoding. Use `-noaccurate_seek`{.sample} to
    disable it, which may be useful e.g. when copying some streams and
    transcoding the others.

`-seek_timestamp (`{.sample}*`input`{.sample}*`)`{.sample}

:   This option enables or disables seeking by timestamp in input files
    with the `-ss`{.sample} option. It is disabled by default. If
    enabled, the argument to the `-ss`{.sample} option is considered an
    actual timestamp, and is not offset by the start time of the file.
    This matters only for files which do not start from timestamp 0,
    such as transport streams.

`-thread_queue_size `{.sample}`size`{.variable}` (`{.sample}*`input/output`{.sample}*`)`{.sample}

:   For input, this option sets the maximum number of queued packets
    when reading from the file or device. With low latency / high rate
    live streams, packets may be discarded if they are not read in a
    timely manner; setting this value can force ffmpeg to use a separate
    input thread and read packets as soon as they arrive. By default
    ffmpeg only does this if multiple inputs are specified.

    For output, this option specified the maximum number of packets that
    may be queued to each muxing thread.

`-sdp_file `{.sample}`file`{.variable}` (`{.sample}*`global`{.sample}*`)`{.sample}

:   Print sdp information for an output stream to `file`{.variable}.
    This allows dumping sdp information when at least one output isn't
    an rtp stream. (Requires at least one of the output formats to be
    rtp).

`-discard (`{.sample}*`input`{.sample}*`)`{.sample}

:   Allows discarding specific streams or frames from streams. Any input
    stream can be fully discarded, using value `all` whereas selective
    discarding of frames from a stream occurs at the demuxer and is not
    supported by all demuxers.

    `none`{.sample}

    :   Discard no frame.

    `default`{.sample}

    :   Default, which discards no frames.

    `noref`{.sample}

    :   Discard all non-reference frames.

    `bidir`{.sample}

    :   Discard all bidirectional frames.

    `nokey`{.sample}

    :   Discard all frames excepts keyframes.

    `all`{.sample}

    :   Discard all frames.

`-abort_on `{.sample}`flags`{.variable}` (`{.sample}*`global`{.sample}*`)`{.sample}

:   Stop and abort on various conditions. The following flags are
    available:

    `empty_output`{.sample}

    :   No packets were passed to the muxer, the output is empty.

    `empty_output_stream`{.sample}

    :   No packets were passed to the muxer in some of the output
        streams.

`-max_error_rate (`{.sample}*`global`{.sample}*`)`{.sample}

:   Set fraction of decoding frame failures across all inputs which when
    crossed ffmpeg will return exit code 69. Crossing this threshold
    does not terminate processing. Range is a floating-point number
    between 0 to 1. Default is 2/3.

`-xerror (`{.sample}*`global`{.sample}*`)`{.sample}

:   Stop and exit on error

`-max_muxing_queue_size `{.sample}`packets`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

:   When transcoding audio and/or video streams, ffmpeg will not begin
    writing into the output until it has one packet for each such
    stream. While waiting for that to happen, packets for other streams
    are buffered. This option sets the size of this buffer, in packets,
    for the matching output stream.

    The default value of this option should be high enough for most
    uses, so only touch this option if you are sure that you need it.

`-muxing_queue_data_threshold `{.sample}`bytes`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

:   This is a minimum threshold until which the muxing queue size is not
    taken into account. Defaults to 50 megabytes per stream, and is
    based on the overall size of packets passed to the muxer.

`-auto_conversion_filters (`{.sample}*`global`{.sample}*`)`{.sample}

:   Enable automatically inserting format conversion filters in all
    filter graphs, including those defined by `-vf`{.sample},
    `-af`{.sample}, `-filter_complex`{.sample} and `-lavfi`{.sample}. If
    filter format negotiation requires a conversion, the initialization
    of the filters will fail. Conversions can still be performed by
    inserting the relevant conversion filter (scale, aresample) in the
    graph. On by default, to explicitly disable it you need to specify
    `-noauto_conversion_filters`.

`-bits_per_raw_sample[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`value`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

:   Declare the number of bits per raw sample in the given output stream
    to be `value`{.variable}. Note that this option sets the information
    provided to the encoder/muxer, it does not change the stream to
    conform to this value. Setting values that do not match the stream
    properties may result in encoding failures or invalid output files.

    []{#stats_005fenc_005foptions}

`-stats_enc_pre[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`path`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}\
`-stats_enc_post[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`path`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}\
`-stats_mux_pre[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`path`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

:   Write per-frame encoding information about the matching streams into
    the file given by `path`{.variable}.

    `-stats_enc_pre`{.sample} writes information about raw video or
    audio frames right before they are sent for encoding, while
    `-stats_enc_post`{.sample} writes information about encoded packets
    as they are received from the encoder. `-stats_mux_pre`{.sample}
    writes information about packets just as they are about to be sent
    to the muxer. Every frame or packet produces one line in the
    specified file. The format of this line is controlled by
    `-stats_enc_pre_fmt`{.sample} / `-stats_enc_post_fmt`{.sample} /
    `-stats_mux_pre_fmt`{.sample}.

    When stats for multiple streams are written into a single file, the
    lines corresponding to different streams will be interleaved. The
    precise order of this interleaving is not specified and not
    guaranteed to remain stable between different invocations of the
    program, even with the same options.

`-stats_enc_pre_fmt[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`format_spec`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}\
`-stats_enc_post_fmt[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`format_spec`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}\
`-stats_mux_pre_fmt[:`{.sample}`stream_specifier`{.variable}`] `{.sample}`format_spec`{.variable}` (`{.sample}*`output,per-stream`{.sample}*`)`{.sample}

:   Specify the format for the lines written with
    `-stats_enc_pre`{.sample} / `-stats_enc_post`{.sample} /
    `-stats_mux_pre`{.sample}.

    `format_spec`{.variable} is a string that may contain directives of
    the form `{fmt}`{.variable}. `format_spec`{.variable} is
    backslash-escaped --- use \\{, \\}, and \\\\ to write a literal {,
    }, or \\, respectively, into the output.

    The directives given with `fmt`{.variable} may be one of the
    following:

    `fidx`{.sample}

    :   Index of the output file.

    `sidx`{.sample}

    :   Index of the output stream in the file.

    `n`{.sample}

    :   Frame number. Pre-encoding: number of frames sent to the encoder
        so far. Post-encoding: number of packets received from the
        encoder so far. Muxing: number of packets submitted to the muxer
        for this stream so far.

    `ni`{.sample}

    :   Input frame number. Index of the input frame (i.e. output by a
        decoder) that corresponds to this output frame or packet. -1 if
        unavailable.

    `tb`{.sample}

    :   Timebase in which this frame/packet's timestamps are expressed,
        as a rational number `num/den`{.variable}. Note that encoder and
        muxer may use different timebases.

    `tbi`{.sample}

    :   Timebase for `ptsi`{.variable}, as a rational number
        `num/den`{.variable}. Available when `ptsi`{.variable} is
        available, `0/1`{.variable} otherwise.

    `pts`{.sample}

    :   Presentation timestamp of the frame or packet, as an integer.
        Should be multiplied by the timebase to compute presentation
        time.

    `ptsi`{.sample}

    :   Presentation timestamp of the input frame (see `ni`{.variable}),
        as an integer. Should be multiplied by `tbi`{.variable} to
        compute presentation time. Printed as (2\^63 - 1
        = 9223372036854775807) when not available.

    `t`{.sample}

    :   Presentation time of the frame or packet, as a decimal number.
        Equal to `pts`{.variable} multiplied by `tb`{.variable}.

    `ti`{.sample}

    :   Presentation time of the input frame (see `ni`{.variable}), as a
        decimal number. Equal to `ptsi`{.variable} multiplied by
        `tbi`{.variable}. Printed as inf when not available.

    `dts (`{.sample}*`packet`{.sample}*`)`{.sample}

    :   Decoding timestamp of the packet, as an integer. Should be
        multiplied by the timebase to compute presentation time.

    `dt (`{.sample}*`packet`{.sample}*`)`{.sample}

    :   Decoding time of the frame or packet, as a decimal number. Equal
        to `dts`{.variable} multiplied by `tb`{.variable}.

    `sn (`{.sample}*`frame,audio`{.sample}*`)`{.sample}

    :   Number of audio samples sent to the encoder so far.

    `samp (`{.sample}*`frame,audio`{.sample}*`)`{.sample}

    :   Number of audio samples in the frame.

    `size (`{.sample}*`packet`{.sample}*`)`{.sample}

    :   Size of the encoded packet in bytes.

    `br (`{.sample}*`packet`{.sample}*`)`{.sample}

    :   Current bitrate in bits per second.

    `abr (`{.sample}*`packet`{.sample}*`)`{.sample}

    :   Average bitrate for the whole stream so far, in bits per second,
        -1 if it cannot be determined at this point.

    `key (`{.sample}*`packet`{.sample}*`)`{.sample}

    :   Character 'K' if the packet contains a keyframe, character 'N'
        otherwise.

    Directives tagged with *packet* may only be used with
    `-stats_enc_post_fmt`{.sample} and `-stats_mux_pre_fmt`{.sample}.

    Directives tagged with *frame* may only be used with
    `-stats_enc_pre_fmt`{.sample}.

    Directives tagged with *audio* may only be used with audio streams.

    The default format strings are:

    `pre-encoding`{.sample}

    :   {fidx} {sidx} {n} {t}

    `post-encoding`{.sample}

    :   {fidx} {sidx} {n} {t}

    In the future, new items may be added to the end of the default
    formatting strings. Users who depend on the format staying exactly
    the same, should prescribe it manually.

    Note that stats for different streams written into the same file may
    have different formats.

[]{#Preset-files}

### [5.12 Preset files](#toc-Preset-files) {#preset-files .section}

A preset file contains a sequence of
`option`{.variable}=`value`{.variable} pairs, one for each line,
specifying a sequence of options which would be awkward to specify on
the command line. Lines starting with the hash ('#') character are
ignored and are used to provide comments. Check the `presets`{.sample}
directory in the FFmpeg source tree for examples.

There are two types of preset files: ffpreset and avpreset files.

[]{#ffpreset-files}

#### [5.12.1 ffpreset files](#toc-ffpreset-files) {#ffpreset-files .subsection}

ffpreset files are specified with the `vpre`, `apre`, `spre`, and `fpre`
options. The `fpre` option takes the filename of the preset instead of a
preset name as input and can be used for any kind of codec. For the
`vpre`, `apre`, and `spre` options, the options specified in a preset
file are applied to the currently selected codec of the same type as the
preset option.

The argument passed to the `vpre`, `apre`, and `spre` preset options
identifies the preset file to use according to the following rules:

First ffmpeg searches for a file named `arg`{.variable}.ffpreset in the
directories `$FFMPEG_DATADIR`{.sample} (if set), and
`$HOME/.ffmpeg`{.sample}, and in the datadir defined at configuration
time (usually `PREFIX/share/ffmpeg`{.sample}) or in a
`ffpresets`{.sample} folder along the executable on win32, in that
order. For example, if the argument is `libvpx-1080p`, it will search
for the file `libvpx-1080p.ffpreset`{.sample}.

If no such file is found, then ffmpeg will search for a file named
`codec_name`{.variable}-`arg`{.variable}.ffpreset in the above-mentioned
directories, where `codec_name`{.variable} is the name of the codec to
which the preset file options will be applied. For example, if you
select the video codec with `-vcodec libvpx` and use `-vpre 1080p`, then
it will search for the file `libvpx-1080p.ffpreset`{.sample}.

[]{#avpreset-files}

#### [5.12.2 avpreset files](#toc-avpreset-files) {#avpreset-files .subsection}

avpreset files are specified with the `pre` option. They work similar to
ffpreset files, but they only allow encoder- specific options.
Therefore, an `option`{.variable}=`value`{.variable} pair specifying an
encoder cannot be used.

When the `pre` option is specified, ffmpeg will look for files with the
suffix .avpreset in the directories `$AVCONV_DATADIR`{.sample} (if set),
and `$HOME/.avconv`{.sample}, and in the datadir defined at
configuration time (usually `PREFIX/share/ffmpeg`{.sample}), in that
order.

First ffmpeg searches for a file named
`codec_name`{.variable}-`arg`{.variable}.avpreset in the above-mentioned
directories, where `codec_name`{.variable} is the name of the codec to
which the preset file options will be applied. For example, if you
select the video codec with `-vcodec libvpx` and use `-pre 1080p`, then
it will search for the file `libvpx-1080p.avpreset`{.sample}.

If no such file is found, then ffmpeg will search for a file named
`arg`{.variable}.avpreset in the same directories.

[]{#vstats_005ffile_005fformat}[]{#vstats-file-format}

### [5.13 vstats file format](#toc-vstats-file-format) {#vstats-file-format .section}

The `-vstats` and `-vstats_file` options enable generation of a file
containing statistics about the generated video outputs.

The `-vstats_version` option controls the format version of the
generated file.

With version `1` the format is:

::: example
``` example
frame= FRAME q= FRAME_QUALITY PSNR= PSNR f_size= FRAME_SIZE s_size= STREAM_SIZEkB time= TIMESTAMP br= BITRATEkbits/s avg_br= AVERAGE_BITRATEkbits/s
```
:::

With version `2` the format is:

::: example
``` example
out= OUT_FILE_INDEX st= OUT_FILE_STREAM_INDEX frame= FRAME_NUMBER q= FRAME_QUALITYf PSNR= PSNR f_size= FRAME_SIZE s_size= STREAM_SIZEkB time= TIMESTAMP br= BITRATEkbits/s avg_br= AVERAGE_BITRATEkbits/s
```
:::

The value corresponding to each key is described below:

`avg_br`{.sample}

:   average bitrate expressed in Kbits/s

`br`{.sample}

:   bitrate expressed in Kbits/s

`frame`{.sample}

:   number of encoded frame

`out`{.sample}

:   out file index

`PSNR`{.sample}

:   Peak Signal to Noise Ratio

`q`{.sample}

:   quality of the frame

`f_size`{.sample}

:   encoded packet size expressed as number of bytes

`s_size`{.sample}

:   stream size expressed in KiB

`st`{.sample}

:   out file stream index

`time`{.sample}

:   time of the packet

`type`{.sample}

:   picture type

See also the [-stats_enc options](#stats_005fenc_005foptions) for an
alternative way to show encoding statistics.

[]{#Examples-1}

## [6 Examples](#toc-Examples-1) {#examples-1 .chapter}

[]{#Video-and-Audio-grabbing}

### [6.1 Video and Audio grabbing](#toc-Video-and-Audio-grabbing) {#video-and-audio-grabbing .section}

If you specify the input format and device then ffmpeg can grab video
and audio directly.

::: example
``` example
ffmpeg -f oss -i /dev/dsp -f video4linux2 -i /dev/video0 /tmp/out.mpg
```
:::

Or with an ALSA audio source (mono input, card id 1) instead of OSS:

::: example
``` example
ffmpeg -f alsa -ac 1 -i hw:1 -f video4linux2 -i /dev/video0 /tmp/out.mpg
```
:::

Note that you must activate the right video source and channel before
launching ffmpeg with any TV viewer such as
[xawtv](http://linux.bytesex.org/xawtv/) by Gerd Knorr. You also have to
set the audio recording levels correctly with a standard mixer.

[]{#X11-grabbing}

### [6.2 X11 grabbing](#toc-X11-grabbing) {#x11-grabbing .section}

Grab the X11 display with ffmpeg via

::: example
``` example
ffmpeg -f x11grab -video_size cif -framerate 25 -i :0.0 /tmp/out.mpg
```
:::

0.0 is display.screen number of your X11 server, same as the DISPLAY
environment variable.

::: example
``` example
ffmpeg -f x11grab -video_size cif -framerate 25 -i :0.0+10,20 /tmp/out.mpg
```
:::

0.0 is display.screen number of your X11 server, same as the DISPLAY
environment variable. 10 is the x-offset and 20 the y-offset for the
grabbing.

[]{#Video-and-Audio-file-format-conversion}

### [6.3 Video and Audio file format conversion](#toc-Video-and-Audio-file-format-conversion) {#video-and-audio-file-format-conversion .section}

Any supported file format and protocol can serve as input to ffmpeg:

Examples:

- You can use YUV files as input:

  ::: example
  ``` example
  ffmpeg -i /tmp/test%d.Y /tmp/out.mpg
  ```
  :::

  It will use the files:

  ::: example
  ``` example
  /tmp/test0.Y, /tmp/test0.U, /tmp/test0.V,
  /tmp/test1.Y, /tmp/test1.U, /tmp/test1.V, etc...
  ```
  :::

  The Y files use twice the resolution of the U and V files. They are
  raw files, without header. They can be generated by all decent video
  decoders. You must specify the size of the image with the
  `-s`{.sample} option if ffmpeg cannot guess it.

- You can input from a raw YUV420P file:

  ::: example
  ``` example
  ffmpeg -i /tmp/test.yuv /tmp/out.avi
  ```
  :::

  test.yuv is a file containing raw YUV planar data. Each frame is
  composed of the Y plane followed by the U and V planes at half
  vertical and horizontal resolution.

- You can output to a raw YUV420P file:

  ::: example
  ``` example
  ffmpeg -i mydivx.avi hugefile.yuv
  ```
  :::

- You can set several input files and output files:

  ::: example
  ``` example
  ffmpeg -i /tmp/a.wav -s 640x480 -i /tmp/a.yuv /tmp/a.mpg
  ```
  :::

  Converts the audio file a.wav and the raw YUV video file a.yuv to MPEG
  file a.mpg.

- You can also do audio and video conversions at the same time:

  ::: example
  ``` example
  ffmpeg -i /tmp/a.wav -ar 22050 /tmp/a.mp2
  ```
  :::

  Converts a.wav to MPEG audio at 22050 Hz sample rate.

- You can encode to several formats at the same time and define a
  mapping from input stream to output streams:

  ::: example
  ``` example
  ffmpeg -i /tmp/a.wav -map 0:a -b:a 64k /tmp/a.mp2 -map 0:a -b:a 128k /tmp/b.mp2
  ```
  :::

  Converts a.wav to a.mp2 at 64 kbits and to b.mp2 at 128 kbits. '-map
  file:index' specifies which input stream is used for each output
  stream, in the order of the definition of output streams.

- You can transcode decrypted VOBs:

  ::: example
  ``` example
  ffmpeg -i snatch_1.vob -f avi -c:v mpeg4 -b:v 800k -g 300 -bf 2 -c:a libmp3lame -b:a 128k snatch.avi
  ```
  :::

  This is a typical DVD ripping example; the input is a VOB file, the
  output an AVI file with MPEG-4 video and MP3 audio. Note that in this
  command we use B-frames so the MPEG-4 stream is DivX5 compatible, and
  GOP size is 300 which means one intra frame every 10 seconds for
  29.97fps input video. Furthermore, the audio stream is MP3-encoded so
  you need to enable LAME support by passing `--enable-libmp3lame` to
  configure. The mapping is particularly useful for DVD transcoding to
  get the desired audio language.

  NOTE: To see the supported input formats, use `ffmpeg -demuxers`.

- You can extract images from a video, or create a video from many
  images:

  For extracting images from a video:

  ::: example
  ``` example
  ffmpeg -i foo.avi -r 1 -s WxH -f image2 foo-%03d.jpeg
  ```
  :::

  This will extract one video frame per second from the video and will
  output them in files named `foo-001.jpeg`{.sample},
  `foo-002.jpeg`{.sample}, etc. Images will be rescaled to fit the new
  WxH values.

  If you want to extract just a limited number of frames, you can use
  the above command in combination with the `-frames:v` or `-t` option,
  or in combination with -ss to start extracting from a certain point in
  time.

  For creating a video from many images:

  ::: example
  ``` example
  ffmpeg -f image2 -framerate 12 -i foo-%03d.jpeg -s WxH foo.avi
  ```
  :::

  The syntax `foo-%03d.jpeg` specifies to use a decimal number composed
  of three digits padded with zeroes to express the sequence number. It
  is the same syntax supported by the C printf function, but only
  formats accepting a normal integer are suitable.

  When importing an image sequence, -i also supports expanding
  shell-like wildcard patterns (globbing) internally, by selecting the
  image2-specific `-pattern_type glob` option.

  For example, for creating a video from filenames matching the glob
  pattern `foo-*.jpeg`:

  ::: example
  ``` example
  ffmpeg -f image2 -pattern_type glob -framerate 12 -i 'foo-*.jpeg' -s WxH foo.avi
  ```
  :::

- You can put many streams of the same type in the output:

  ::: example
  ``` example
  ffmpeg -i test1.avi -i test2.avi -map 1:1 -map 1:0 -map 0:1 -map 0:0 -c copy -y test12.nut
  ```
  :::

  The resulting output file `test12.nut`{.sample} will contain the first
  four streams from the input files in reverse order.

- To force CBR video output:

  ::: example
  ``` example
  ffmpeg -i myfile.avi -b 4000k -minrate 4000k -maxrate 4000k -bufsize 1835k out.m2v
  ```
  :::

- The four options lmin, lmax, mblmin and mblmax use 'lambda' units, but
  you may use the QP2LAMBDA constant to easily convert from 'q' units:

  ::: example
  ``` example
  ffmpeg -i src.ext -lmax 21*QP2LAMBDA dst.ext
  ```
  :::

[]{#Syntax}

## [7 Syntax](#toc-Syntax) {#syntax .chapter}

This section documents the syntax and formats employed by the FFmpeg
libraries and tools.

[]{#quoting_005fand_005fescaping}[]{#Quoting-and-escaping}

### [7.1 Quoting and escaping](#toc-Quoting-and-escaping) {#quoting-and-escaping .section}

FFmpeg adopts the following quoting and escaping mechanism, unless
explicitly specified. The following rules are applied:

- '`'`{.sample}' and '`\`{.sample}' are special characters (respectively
  used for quoting and escaping). In addition to them, there might be
  other special characters depending on the specific syntax where the
  escaping and quoting are employed.
- A special character is escaped by prefixing it with a '`\`{.sample}'.
- All characters enclosed between '`''`{.sample}' are included literally
  in the parsed string. The quote character '`'`{.sample}' itself cannot
  be quoted, so you may need to close the quote and escape it.
- Leading and trailing whitespaces, unless escaped or quoted, are
  removed from the parsed string.

Note that you may need to add a second level of escaping when using the
command line or a script, which depends on the syntax of the adopted
shell language.

The function `av_get_token` defined in `libavutil/avstring.h`{.sample}
can be used to parse a token quoted or escaped according to the rules
defined above.

The tool `tools/ffescape`{.sample} in the FFmpeg source tree can be used
to automatically quote or escape a string in a script.

[]{#Examples-2}

#### [7.1.1 Examples](#toc-Examples-2) {#examples-2 .subsection}

- Escape the string `Crime d'Amour` containing the `'` special
  character:

  ::: example
  ``` example
  Crime d\'Amour
  ```
  :::
- The string above contains a quote, so the `'` needs to be escaped when
  quoting it:

  ::: example
  ``` example
  'Crime d'\''Amour'
  ```
  :::
- Include leading or trailing whitespaces using quoting:

  ::: example
  ``` example
  '  this string starts and ends with whitespaces  '
  ```
  :::
- Escaping and quoting can be mixed together:

  ::: example
  ``` example
  ' The string '\'string\'' is a string '
  ```
  :::
- To include a literal '`\`{.sample}' you can use either escaping or
  quoting:

  ::: example
  ``` example
  'c:\foo' can be written as c:\\foo
  ```
  :::

[]{#date-syntax}[]{#Date}

### [7.2 Date](#toc-Date) {#date .section}

The accepted syntax is:

::: example
``` example
[(YYYY-MM-DD|YYYYMMDD)[T|t| ]]((HH:MM:SS[.m...]]])|(HHMMSS[.m...]]]))[Z]
now
```
:::

If the value is \"now\" it takes the current time.

Time is local time unless Z is appended, in which case it is interpreted
as UTC. If the year-month-day part is not specified it takes the current
year-month-day.

[]{#time-duration-syntax}[]{#Time-duration}

### [7.3 Time duration](#toc-Time-duration) {#time-duration .section}

There are two accepted syntaxes for expressing time duration.

::: example
``` example
[-][HH:]MM:SS[.m...]
```
:::

`HH`{.variable} expresses the number of hours, `MM`{.variable} the
number of minutes for a maximum of 2 digits, and `SS`{.variable} the
number of seconds for a maximum of 2 digits. The `m`{.variable} at the
end expresses decimal value for `SS`{.variable}.

*or*

::: example
``` example
[-]S+[.m...][s|ms|us]
```
:::

`S`{.variable} expresses the number of seconds, with the optional
decimal part `m`{.variable}. The optional literal suffixes
'`s`{.sample}', '`ms`{.sample}' or '`us`{.sample}' indicate to interpret
the value as seconds, milliseconds or microseconds, respectively.

In both expressions, the optional '`-`{.sample}' indicates negative
duration.

[]{#Examples-3}

#### [7.3.1 Examples](#toc-Examples-3) {#examples-3 .subsection}

The following examples are all valid time duration:

'`55`{.sample}'

:   55 seconds

'`0.2`{.sample}'

:   0.2 seconds

'`200ms`{.sample}'

:   200 milliseconds, that's 0.2s

'`200000us`{.sample}'

:   200000 microseconds, that's 0.2s

'`12:03:45`{.sample}'

:   12 hours, 03 minutes and 45 seconds

'`23.189`{.sample}'

:   23.189 seconds

[]{#video-size-syntax}[]{#Video-size}

### [7.4 Video size](#toc-Video-size) {#video-size .section}

Specify the size of the sourced video, it may be a string of the form
`width`{.variable}x`height`{.variable}, or the name of a size
abbreviation.

The following abbreviations are recognized:

'`ntsc`{.sample}'

:   720x480

'`pal`{.sample}'

:   720x576

'`qntsc`{.sample}'

:   352x240

'`qpal`{.sample}'

:   352x288

'`sntsc`{.sample}'

:   640x480

'`spal`{.sample}'

:   768x576

'`film`{.sample}'

:   352x240

'`ntsc-film`{.sample}'

:   352x240

'`sqcif`{.sample}'

:   128x96

'`qcif`{.sample}'

:   176x144

'`cif`{.sample}'

:   352x288

'`4cif`{.sample}'

:   704x576

'`16cif`{.sample}'

:   1408x1152

'`qqvga`{.sample}'

:   160x120

'`qvga`{.sample}'

:   320x240

'`vga`{.sample}'

:   640x480

'`svga`{.sample}'

:   800x600

'`xga`{.sample}'

:   1024x768

'`uxga`{.sample}'

:   1600x1200

'`qxga`{.sample}'

:   2048x1536

'`sxga`{.sample}'

:   1280x1024

'`qsxga`{.sample}'

:   2560x2048

'`hsxga`{.sample}'

:   5120x4096

'`wvga`{.sample}'

:   852x480

'`wxga`{.sample}'

:   1366x768

'`wsxga`{.sample}'

:   1600x1024

'`wuxga`{.sample}'

:   1920x1200

'`woxga`{.sample}'

:   2560x1600

'`wqsxga`{.sample}'

:   3200x2048

'`wquxga`{.sample}'

:   3840x2400

'`whsxga`{.sample}'

:   6400x4096

'`whuxga`{.sample}'

:   7680x4800

'`cga`{.sample}'

:   320x200

'`ega`{.sample}'

:   640x350

'`hd480`{.sample}'

:   852x480

'`hd720`{.sample}'

:   1280x720

'`hd1080`{.sample}'

:   1920x1080

'`2k`{.sample}'

:   2048x1080

'`2kflat`{.sample}'

:   1998x1080

'`2kscope`{.sample}'

:   2048x858

'`4k`{.sample}'

:   4096x2160

'`4kflat`{.sample}'

:   3996x2160

'`4kscope`{.sample}'

:   4096x1716

'`nhd`{.sample}'

:   640x360

'`hqvga`{.sample}'

:   240x160

'`wqvga`{.sample}'

:   400x240

'`fwqvga`{.sample}'

:   432x240

'`hvga`{.sample}'

:   480x320

'`qhd`{.sample}'

:   960x540

'`2kdci`{.sample}'

:   2048x1080

'`4kdci`{.sample}'

:   4096x2160

'`uhd2160`{.sample}'

:   3840x2160

'`uhd4320`{.sample}'

:   7680x4320

[]{#video-rate-syntax}[]{#Video-rate}

### [7.5 Video rate](#toc-Video-rate) {#video-rate .section}

Specify the frame rate of a video, expressed as the number of frames
generated per second. It has to be a string in the format
`frame_rate_num`{.variable}/`frame_rate_den`{.variable}, an integer
number, a float number or a valid video frame rate abbreviation.

The following abbreviations are recognized:

'`ntsc`{.sample}'

:   30000/1001

'`pal`{.sample}'

:   25/1

'`qntsc`{.sample}'

:   30000/1001

'`qpal`{.sample}'

:   25/1

'`sntsc`{.sample}'

:   30000/1001

'`spal`{.sample}'

:   25/1

'`film`{.sample}'

:   24/1

'`ntsc-film`{.sample}'

:   24000/1001

[]{#ratio-syntax}[]{#Ratio}

### [7.6 Ratio](#toc-Ratio) {#ratio .section}

A ratio can be expressed as an expression, or in the form
`numerator`{.variable}:`denominator`{.variable}.

Note that a ratio with infinite (1/0) or negative value is considered
valid, so you should check on the returned value if you want to exclude
those values.

The undefined value can be expressed using the \"0:0\" string.

[]{#color-syntax}[]{#Color}

### [7.7 Color](#toc-Color) {#color .section}

It can be the name of a color as defined below (case insensitive match)
or a `[0x|#]RRGGBB[AA]` sequence, possibly followed by @ and a string
representing the alpha component.

The alpha component may be a string composed by \"0x\" followed by an
hexadecimal number or a decimal number between 0.0 and 1.0, which
represents the opacity value ('`0x00`{.sample}' or '`0.0`{.sample}'
means completely transparent, '`0xff`{.sample}' or '`1.0`{.sample}'
completely opaque). If the alpha component is not specified then
'`0xff`{.sample}' is assumed.

The string '`random`{.sample}' will result in a random color.

The following names of colors are recognized:

'`AliceBlue`{.sample}'

:   0xF0F8FF

'`AntiqueWhite`{.sample}'

:   0xFAEBD7

'`Aqua`{.sample}'

:   0x00FFFF

'`Aquamarine`{.sample}'

:   0x7FFFD4

'`Azure`{.sample}'

:   0xF0FFFF

'`Beige`{.sample}'

:   0xF5F5DC

'`Bisque`{.sample}'

:   0xFFE4C4

'`Black`{.sample}'

:   0x000000

'`BlanchedAlmond`{.sample}'

:   0xFFEBCD

'`Blue`{.sample}'

:   0x0000FF

'`BlueViolet`{.sample}'

:   0x8A2BE2

'`Brown`{.sample}'

:   0xA52A2A

'`BurlyWood`{.sample}'

:   0xDEB887

'`CadetBlue`{.sample}'

:   0x5F9EA0

'`Chartreuse`{.sample}'

:   0x7FFF00

'`Chocolate`{.sample}'

:   0xD2691E

'`Coral`{.sample}'

:   0xFF7F50

'`CornflowerBlue`{.sample}'

:   0x6495ED

'`Cornsilk`{.sample}'

:   0xFFF8DC

'`Crimson`{.sample}'

:   0xDC143C

'`Cyan`{.sample}'

:   0x00FFFF

'`DarkBlue`{.sample}'

:   0x00008B

'`DarkCyan`{.sample}'

:   0x008B8B

'`DarkGoldenRod`{.sample}'

:   0xB8860B

'`DarkGray`{.sample}'

:   0xA9A9A9

'`DarkGreen`{.sample}'

:   0x006400

'`DarkKhaki`{.sample}'

:   0xBDB76B

'`DarkMagenta`{.sample}'

:   0x8B008B

'`DarkOliveGreen`{.sample}'

:   0x556B2F

'`Darkorange`{.sample}'

:   0xFF8C00

'`DarkOrchid`{.sample}'

:   0x9932CC

'`DarkRed`{.sample}'

:   0x8B0000

'`DarkSalmon`{.sample}'

:   0xE9967A

'`DarkSeaGreen`{.sample}'

:   0x8FBC8F

'`DarkSlateBlue`{.sample}'

:   0x483D8B

'`DarkSlateGray`{.sample}'

:   0x2F4F4F

'`DarkTurquoise`{.sample}'

:   0x00CED1

'`DarkViolet`{.sample}'

:   0x9400D3

'`DeepPink`{.sample}'

:   0xFF1493

'`DeepSkyBlue`{.sample}'

:   0x00BFFF

'`DimGray`{.sample}'

:   0x696969

'`DodgerBlue`{.sample}'

:   0x1E90FF

'`FireBrick`{.sample}'

:   0xB22222

'`FloralWhite`{.sample}'

:   0xFFFAF0

'`ForestGreen`{.sample}'

:   0x228B22

'`Fuchsia`{.sample}'

:   0xFF00FF

'`Gainsboro`{.sample}'

:   0xDCDCDC

'`GhostWhite`{.sample}'

:   0xF8F8FF

'`Gold`{.sample}'

:   0xFFD700

'`GoldenRod`{.sample}'

:   0xDAA520

'`Gray`{.sample}'

:   0x808080

'`Green`{.sample}'

:   0x008000

'`GreenYellow`{.sample}'

:   0xADFF2F

'`HoneyDew`{.sample}'

:   0xF0FFF0

'`HotPink`{.sample}'

:   0xFF69B4

'`IndianRed`{.sample}'

:   0xCD5C5C

'`Indigo`{.sample}'

:   0x4B0082

'`Ivory`{.sample}'

:   0xFFFFF0

'`Khaki`{.sample}'

:   0xF0E68C

'`Lavender`{.sample}'

:   0xE6E6FA

'`LavenderBlush`{.sample}'

:   0xFFF0F5

'`LawnGreen`{.sample}'

:   0x7CFC00

'`LemonChiffon`{.sample}'

:   0xFFFACD

'`LightBlue`{.sample}'

:   0xADD8E6

'`LightCoral`{.sample}'

:   0xF08080

'`LightCyan`{.sample}'

:   0xE0FFFF

'`LightGoldenRodYellow`{.sample}'

:   0xFAFAD2

'`LightGreen`{.sample}'

:   0x90EE90

'`LightGrey`{.sample}'

:   0xD3D3D3

'`LightPink`{.sample}'

:   0xFFB6C1

'`LightSalmon`{.sample}'

:   0xFFA07A

'`LightSeaGreen`{.sample}'

:   0x20B2AA

'`LightSkyBlue`{.sample}'

:   0x87CEFA

'`LightSlateGray`{.sample}'

:   0x778899

'`LightSteelBlue`{.sample}'

:   0xB0C4DE

'`LightYellow`{.sample}'

:   0xFFFFE0

'`Lime`{.sample}'

:   0x00FF00

'`LimeGreen`{.sample}'

:   0x32CD32

'`Linen`{.sample}'

:   0xFAF0E6

'`Magenta`{.sample}'

:   0xFF00FF

'`Maroon`{.sample}'

:   0x800000

'`MediumAquaMarine`{.sample}'

:   0x66CDAA

'`MediumBlue`{.sample}'

:   0x0000CD

'`MediumOrchid`{.sample}'

:   0xBA55D3

'`MediumPurple`{.sample}'

:   0x9370D8

'`MediumSeaGreen`{.sample}'

:   0x3CB371

'`MediumSlateBlue`{.sample}'

:   0x7B68EE

'`MediumSpringGreen`{.sample}'

:   0x00FA9A

'`MediumTurquoise`{.sample}'

:   0x48D1CC

'`MediumVioletRed`{.sample}'

:   0xC71585

'`MidnightBlue`{.sample}'

:   0x191970

'`MintCream`{.sample}'

:   0xF5FFFA

'`MistyRose`{.sample}'

:   0xFFE4E1

'`Moccasin`{.sample}'

:   0xFFE4B5

'`NavajoWhite`{.sample}'

:   0xFFDEAD

'`Navy`{.sample}'

:   0x000080

'`OldLace`{.sample}'

:   0xFDF5E6

'`Olive`{.sample}'

:   0x808000

'`OliveDrab`{.sample}'

:   0x6B8E23

'`Orange`{.sample}'

:   0xFFA500

'`OrangeRed`{.sample}'

:   0xFF4500

'`Orchid`{.sample}'

:   0xDA70D6

'`PaleGoldenRod`{.sample}'

:   0xEEE8AA

'`PaleGreen`{.sample}'

:   0x98FB98

'`PaleTurquoise`{.sample}'

:   0xAFEEEE

'`PaleVioletRed`{.sample}'

:   0xD87093

'`PapayaWhip`{.sample}'

:   0xFFEFD5

'`PeachPuff`{.sample}'

:   0xFFDAB9

'`Peru`{.sample}'

:   0xCD853F

'`Pink`{.sample}'

:   0xFFC0CB

'`Plum`{.sample}'

:   0xDDA0DD

'`PowderBlue`{.sample}'

:   0xB0E0E6

'`Purple`{.sample}'

:   0x800080

'`Red`{.sample}'

:   0xFF0000

'`RosyBrown`{.sample}'

:   0xBC8F8F

'`RoyalBlue`{.sample}'

:   0x4169E1

'`SaddleBrown`{.sample}'

:   0x8B4513

'`Salmon`{.sample}'

:   0xFA8072

'`SandyBrown`{.sample}'

:   0xF4A460

'`SeaGreen`{.sample}'

:   0x2E8B57

'`SeaShell`{.sample}'

:   0xFFF5EE

'`Sienna`{.sample}'

:   0xA0522D

'`Silver`{.sample}'

:   0xC0C0C0

'`SkyBlue`{.sample}'

:   0x87CEEB

'`SlateBlue`{.sample}'

:   0x6A5ACD

'`SlateGray`{.sample}'

:   0x708090

'`Snow`{.sample}'

:   0xFFFAFA

'`SpringGreen`{.sample}'

:   0x00FF7F

'`SteelBlue`{.sample}'

:   0x4682B4

'`Tan`{.sample}'

:   0xD2B48C

'`Teal`{.sample}'

:   0x008080

'`Thistle`{.sample}'

:   0xD8BFD8

'`Tomato`{.sample}'

:   0xFF6347

'`Turquoise`{.sample}'

:   0x40E0D0

'`Violet`{.sample}'

:   0xEE82EE

'`Wheat`{.sample}'

:   0xF5DEB3

'`White`{.sample}'

:   0xFFFFFF

'`WhiteSmoke`{.sample}'

:   0xF5F5F5

'`Yellow`{.sample}'

:   0xFFFF00

'`YellowGreen`{.sample}'

:   0x9ACD32

[]{#channel-layout-syntax}[]{#Channel-Layout}

### [7.8 Channel Layout](#toc-Channel-Layout) {#channel-layout .section}

A channel layout specifies the spatial disposition of the channels in a
multi-channel audio stream. To specify a channel layout, FFmpeg makes
use of a special syntax.

Individual channels are identified by an id, as given by the table
below:

'`FL`{.sample}'

:   front left

'`FR`{.sample}'

:   front right

'`FC`{.sample}'

:   front center

'`LFE`{.sample}'

:   low frequency

'`BL`{.sample}'

:   back left

'`BR`{.sample}'

:   back right

'`FLC`{.sample}'

:   front left-of-center

'`FRC`{.sample}'

:   front right-of-center

'`BC`{.sample}'

:   back center

'`SL`{.sample}'

:   side left

'`SR`{.sample}'

:   side right

'`TC`{.sample}'

:   top center

'`TFL`{.sample}'

:   top front left

'`TFC`{.sample}'

:   top front center

'`TFR`{.sample}'

:   top front right

'`TBL`{.sample}'

:   top back left

'`TBC`{.sample}'

:   top back center

'`TBR`{.sample}'

:   top back right

'`DL`{.sample}'

:   downmix left

'`DR`{.sample}'

:   downmix right

'`WL`{.sample}'

:   wide left

'`WR`{.sample}'

:   wide right

'`SDL`{.sample}'

:   surround direct left

'`SDR`{.sample}'

:   surround direct right

'`LFE2`{.sample}'

:   low frequency 2

Standard channel layout compositions can be specified by using the
following identifiers:

'`mono`{.sample}'

:   FC

'`stereo`{.sample}'

:   FL+FR

'`2.1`{.sample}'

:   FL+FR+LFE

'`3.0`{.sample}'

:   FL+FR+FC

'`3.0(back)`{.sample}'

:   FL+FR+BC

'`4.0`{.sample}'

:   FL+FR+FC+BC

'`quad`{.sample}'

:   FL+FR+BL+BR

'`quad(side)`{.sample}'

:   FL+FR+SL+SR

'`3.1`{.sample}'

:   FL+FR+FC+LFE

'`5.0`{.sample}'

:   FL+FR+FC+BL+BR

'`5.0(side)`{.sample}'

:   FL+FR+FC+SL+SR

'`4.1`{.sample}'

:   FL+FR+FC+LFE+BC

'`5.1`{.sample}'

:   FL+FR+FC+LFE+BL+BR

'`5.1(side)`{.sample}'

:   FL+FR+FC+LFE+SL+SR

'`6.0`{.sample}'

:   FL+FR+FC+BC+SL+SR

'`6.0(front)`{.sample}'

:   FL+FR+FLC+FRC+SL+SR

'`3.1.2`{.sample}'

:   FL+FR+FC+LFE+TFL+TFR

'`hexagonal`{.sample}'

:   FL+FR+FC+BL+BR+BC

'`6.1`{.sample}'

:   FL+FR+FC+LFE+BC+SL+SR

'`6.1`{.sample}'

:   FL+FR+FC+LFE+BL+BR+BC

'`6.1(front)`{.sample}'

:   FL+FR+LFE+FLC+FRC+SL+SR

'`7.0`{.sample}'

:   FL+FR+FC+BL+BR+SL+SR

'`7.0(front)`{.sample}'

:   FL+FR+FC+FLC+FRC+SL+SR

'`7.1`{.sample}'

:   FL+FR+FC+LFE+BL+BR+SL+SR

'`7.1(wide)`{.sample}'

:   FL+FR+FC+LFE+BL+BR+FLC+FRC

'`7.1(wide-side)`{.sample}'

:   FL+FR+FC+LFE+FLC+FRC+SL+SR

'`5.1.2`{.sample}'

:   FL+FR+FC+LFE+BL+BR+TFL+TFR

'`octagonal`{.sample}'

:   FL+FR+FC+BL+BR+BC+SL+SR

'`cube`{.sample}'

:   FL+FR+BL+BR+TFL+TFR+TBL+TBR

'`5.1.4`{.sample}'

:   FL+FR+FC+LFE+BL+BR+TFL+TFR+TBL+TBR

'`7.1.2`{.sample}'

:   FL+FR+FC+LFE+BL+BR+SL+SR+TFL+TFR

'`7.1.4`{.sample}'

:   FL+FR+FC+LFE+BL+BR+SL+SR+TFL+TFR+TBL+TBR

'`7.2.3`{.sample}'

:   FL+FR+FC+LFE+BL+BR+SL+SR+TFL+TFR+TBC+LFE2

'`9.1.4`{.sample}'

:   FL+FR+FC+LFE+BL+BR+FLC+FRC+SL+SR+TFL+TFR+TBL+TBR

'`9.1.6`{.sample}'

:   FL+FR+FC+LFE+BL+BR+FLC+FRC+SL+SR+TFL+TFR+TBL+TBR+TSL+TSR

'`hexadecagonal`{.sample}'

:   FL+FR+FC+BL+BR+BC+SL+SR+WL+WR+TBL+TBR+TBC+TFC+TFL+TFR

'`binaural`{.sample}'

:   BIL+BIR

'`downmix`{.sample}'

:   DL+DR

'`22.2`{.sample}'

:   FL+FR+FC+LFE+BL+BR+FLC+FRC+BC+SL+SR+TC+TFL+TFC+TFR+TBL+TBC+TBR+LFE2+TSL+TSR+BFC+BFL+BFR

A custom channel layout can be specified as a sequence of terms,
separated by '+'. Each term can be:

- the name of a single channel (e.g. '`FL`{.sample}', '`FR`{.sample}',
  '`FC`{.sample}', '`LFE`{.sample}', etc.), each optionally containing a
  custom name after a '@', (e.g. '`FL@Left`{.sample}',
  '`FR@Right`{.sample}', '`FC@Center`{.sample}',
  '`LFE@Low_Frequency`{.sample}', etc.)

A standard channel layout can be specified by the following:

- the name of a single channel (e.g. '`FL`{.sample}', '`FR`{.sample}',
  '`FC`{.sample}', '`LFE`{.sample}', etc.)
- the name of a standard channel layout (e.g. '`mono`{.sample}',
  '`stereo`{.sample}', '`4.0`{.sample}', '`quad`{.sample}',
  '`5.0`{.sample}', etc.)
- a number of channels, in decimal, followed by 'c', yielding the
  default channel layout for that number of channels (see the function
  `av_channel_layout_default`). Note that not all channel counts have a
  default layout.
- a number of channels, in decimal, followed by 'C', yielding an unknown
  channel layout with the specified number of channels. Note that not
  all channel layout specification strings support unknown channel
  layouts.
- a channel layout mask, in hexadecimal starting with \"0x\" (see the
  `AV_CH_*` macros in `libavutil/channel_layout.h`{.sample}.

Before libavutil version 53 the trailing character \"c\" to specify a
number of channels was optional, but now it is required, while a channel
layout mask can also be specified as a decimal number (if and only if
not followed by \"c\" or \"C\").

See also the function `av_channel_layout_from_string` defined in
`libavutil/channel_layout.h`{.sample}.

[]{#Expression-Evaluation}

## [8 Expression Evaluation](#toc-Expression-Evaluation) {#expression-evaluation .chapter}

When evaluating an arithmetic expression, FFmpeg uses an internal
formula evaluator, implemented through the `libavutil/eval.h`{.sample}
interface.

An expression may contain unary, binary operators, constants, and
functions.

Two expressions `expr1`{.variable} and `expr2`{.variable} can be
combined to form another expression
\"`expr1`{.variable};`expr2`{.variable}\". `expr1`{.variable} and
`expr2`{.variable} are evaluated in turn, and the new expression
evaluates to the value of `expr2`{.variable}.

The following binary operators are available: `+`, `-`, `*`, `/`, `^`.

The following unary operators are available: `+`, `-`.

Some internal variables can be used to store and load intermediary
results. They can be accessed using the `ld` and `st` functions with an
index argument varying from 0 to 9 to specify which internal variable to
access.

The following functions are available:

`abs(x)`{.sample}

:   Compute absolute value of `x`{.variable}.

`acos(x)`{.sample}

:   Compute arccosine of `x`{.variable}.

`asin(x)`{.sample}

:   Compute arcsine of `x`{.variable}.

`atan(x)`{.sample}

:   Compute arctangent of `x`{.variable}.

`atan2(y, x)`{.sample}

:   Compute principal value of the arc tangent of
    `y`{.variable}/`x`{.variable}.

`between(x, min, max)`{.sample}

:   Return 1 if `x`{.variable} is greater than or equal to
    `min`{.variable} and lesser than or equal to `max`{.variable}, 0
    otherwise.

`bitand(x, y)`{.sample}\
`bitor(x, y)`{.sample}

:   Compute bitwise and/or operation on `x`{.variable} and
    `y`{.variable}.

    The results of the evaluation of `x`{.variable} and `y`{.variable}
    are converted to integers before executing the bitwise operation.

    Note that both the conversion to integer and the conversion back to
    floating point can lose precision. Beware of unexpected results for
    large numbers (usually 2\^53 and larger).

`ceil(expr)`{.sample}

:   Round the value of expression `expr`{.variable} upwards to the
    nearest integer. For example, \"ceil(1.5)\" is \"2.0\".

`clip(x, min, max)`{.sample}

:   Return the value of `x`{.variable} clipped between `min`{.variable}
    and `max`{.variable}.

`cos(x)`{.sample}

:   Compute cosine of `x`{.variable}.

`cosh(x)`{.sample}

:   Compute hyperbolic cosine of `x`{.variable}.

`eq(x, y)`{.sample}

:   Return 1 if `x`{.variable} and `y`{.variable} are equivalent, 0
    otherwise.

`exp(x)`{.sample}

:   Compute exponential of `x`{.variable} (with base `e`, the Euler's
    number).

`floor(expr)`{.sample}

:   Round the value of expression `expr`{.variable} downwards to the
    nearest integer. For example, \"floor(-1.5)\" is \"-2.0\".

`gauss(x)`{.sample}

:   Compute Gauss function of `x`{.variable}, corresponding to
    `exp(-x*x/2) / sqrt(2*PI)`.

`gcd(x, y)`{.sample}

:   Return the greatest common divisor of `x`{.variable} and
    `y`{.variable}. If both `x`{.variable} and `y`{.variable} are 0 or
    either or both are less than zero then behavior is undefined.

`gt(x, y)`{.sample}

:   Return 1 if `x`{.variable} is greater than `y`{.variable}, 0
    otherwise.

`gte(x, y)`{.sample}

:   Return 1 if `x`{.variable} is greater than or equal to
    `y`{.variable}, 0 otherwise.

`hypot(x, y)`{.sample}

:   This function is similar to the C function with the same name; it
    returns \"sqrt(`x`{.variable}\*`x`{.variable} +
    `y`{.variable}\*`y`{.variable})\", the length of the hypotenuse of a
    right triangle with sides of length `x`{.variable} and
    `y`{.variable}, or the distance of the point (`x`{.variable},
    `y`{.variable}) from the origin.

`if(x, y)`{.sample}

:   Evaluate `x`{.variable}, and if the result is non-zero return the
    result of the evaluation of `y`{.variable}, return 0 otherwise.

`if(x, y, z)`{.sample}

:   Evaluate `x`{.variable}, and if the result is non-zero return the
    evaluation result of `y`{.variable}, otherwise the evaluation result
    of `z`{.variable}.

`ifnot(x, y)`{.sample}

:   Evaluate `x`{.variable}, and if the result is zero return the result
    of the evaluation of `y`{.variable}, return 0 otherwise.

`ifnot(x, y, z)`{.sample}

:   Evaluate `x`{.variable}, and if the result is zero return the
    evaluation result of `y`{.variable}, otherwise the evaluation result
    of `z`{.variable}.

`isinf(x)`{.sample}

:   Return 1.0 if `x`{.variable} is +/-INFINITY, 0.0 otherwise.

`isnan(x)`{.sample}

:   Return 1.0 if `x`{.variable} is NAN, 0.0 otherwise.

`ld(idx)`{.sample}

:   Load the value of the internal variable with index `idx`{.variable},
    which was previously stored with st(`idx`{.variable},
    `expr`{.variable}). The function returns the loaded value.

`lerp(x, y, z)`{.sample}

:   Return linear interpolation between `x`{.variable} and
    `y`{.variable} by amount of `z`{.variable}.

`log(x)`{.sample}

:   Compute natural logarithm of `x`{.variable}.

`lt(x, y)`{.sample}

:   Return 1 if `x`{.variable} is lesser than `y`{.variable}, 0
    otherwise.

`lte(x, y)`{.sample}

:   Return 1 if `x`{.variable} is lesser than or equal to
    `y`{.variable}, 0 otherwise.

`max(x, y)`{.sample}

:   Return the maximum between `x`{.variable} and `y`{.variable}.

`min(x, y)`{.sample}

:   Return the minimum between `x`{.variable} and `y`{.variable}.

`mod(x, y)`{.sample}

:   Compute the remainder of division of `x`{.variable} by
    `y`{.variable}.

`not(expr)`{.sample}

:   Return 1.0 if `expr`{.variable} is zero, 0.0 otherwise.

`pow(x, y)`{.sample}

:   Compute the power of `x`{.variable} elevated `y`{.variable}, it is
    equivalent to \"(`x`{.variable})\^(`y`{.variable})\".

`print(t)`{.sample}\
`print(t, l)`{.sample}

:   Print the value of expression `t`{.variable} with loglevel
    `l`{.variable}. If `l`{.variable} is not specified then a default
    log level is used. Return the value of the expression printed.

`random(idx)`{.sample}

:   Return a pseudo random value between 0.0 and 1.0. `idx`{.variable}
    is the index of the internal variable used to save the seed/state,
    which can be previously stored with `st(idx)`.

    To initialize the seed, you need to store the seed value as a 64-bit
    unsigned integer in the internal variable with index
    `idx`{.variable}.

    For example, to store the seed with value `42` in the internal
    variable with index `0` and print a few random values:

    ::: example
    ``` example
    st(0,42); print(random(0)); print(random(0)); print(random(0))
    ```
    :::

`randomi(idx, min, max)`{.sample}

:   Return a pseudo random value in the interval between
    `min`{.variable} and `max`{.variable}. `idx`{.variable} is the index
    of the internal variable which will be used to save the seed/state,
    which can be previously stored with `st(idx)`.

    To initialize the seed, you need to store the seed value as a 64-bit
    unsigned integer in the internal variable with index
    `idx`{.variable}.

`root(expr, max)`{.sample}

:   Find an input value for which the function represented by
    `expr`{.variable} with argument `ld(0)`{.variable} is 0 in the
    interval 0..`max`{.variable}.

    The expression in `expr`{.variable} must denote a continuous
    function or the result is undefined.

    `ld(0)`{.variable} is used to represent the function input value,
    which means that the given expression will be evaluated multiple
    times with various input values that the expression can access
    through `ld(0)`. When the expression evaluates to 0 then the
    corresponding input value will be returned.

`round(expr)`{.sample}

:   Round the value of expression `expr`{.variable} to the nearest
    integer. For example, \"round(1.5)\" is \"2.0\".

`sgn(x)`{.sample}

:   Compute sign of `x`{.variable}.

`sin(x)`{.sample}

:   Compute sine of `x`{.variable}.

`sinh(x)`{.sample}

:   Compute hyperbolic sine of `x`{.variable}.

`sqrt(expr)`{.sample}

:   Compute the square root of `expr`{.variable}. This is equivalent to
    \"(`expr`{.variable})\^.5\".

`squish(x)`{.sample}

:   Compute expression `1/(1 + exp(4*x))`.

`st(idx, expr)`{.sample}

:   Store the value of the expression `expr`{.variable} in an internal
    variable. `idx`{.variable} specifies the index of the variable where
    to store the value, and it is a value ranging from 0 to 9. The
    function returns the value stored in the internal variable.

    The stored value can be retrieved with `ld(var)`.

    Note: variables are currently not shared between expressions.

`tan(x)`{.sample}

:   Compute tangent of `x`{.variable}.

`tanh(x)`{.sample}

:   Compute hyperbolic tangent of `x`{.variable}.

`taylor(expr, x)`{.sample}\
`taylor(expr, x, idx)`{.sample}

:   Evaluate a Taylor series at `x`{.variable}, given an expression
    representing the `ld(idx)`-th derivative of a function at 0.

    When the series does not converge the result is undefined.

    `ld(idx)`{.variable} is used to represent the derivative order in
    `expr`{.variable}, which means that the given expression will be
    evaluated multiple times with various input values that the
    expression can access through `ld(idx)`. If `idx`{.variable} is not
    specified then 0 is assumed.

    Note, when you have the derivatives at y instead of 0,
    `taylor(expr, x-y)` can be used.

`time(0)`{.sample}

:   Return the current (wallclock) time in seconds.

`trunc(expr)`{.sample}

:   Round the value of expression `expr`{.variable} towards zero to the
    nearest integer. For example, \"trunc(-1.5)\" is \"-1.0\".

`while(cond, expr)`{.sample}

:   Evaluate expression `expr`{.variable} while the expression
    `cond`{.variable} is non-zero, and returns the value of the last
    `expr`{.variable} evaluation, or NAN if `cond`{.variable} was always
    false.

The following constants are available:

`PI`{.sample}

:   area of the unit disc, approximately 3.14

`E`{.sample}

:   exp(1) (Euler's number), approximately 2.718

`PHI`{.sample}

:   golden ratio (1+sqrt(5))/2, approximately 1.618

Assuming that an expression is considered \"true\" if it has a non-zero
value, note that:

`*` works like AND

`+` works like OR

For example the construct:

::: example
``` example
if (A AND B) then C
```
:::

is equivalent to:

::: example
``` example
if(A*B, C)
```
:::

In your C code, you can extend the list of unary and binary functions,
and define recognized constants, so that they are available for your
expressions.

The evaluator also recognizes the International System unit prefixes. If
'i' is appended after the prefix, binary prefixes are used, which are
based on powers of 1024 instead of powers of 1000. The 'B' postfix
multiplies the value by 8, and can be appended after a unit prefix or
used alone. This allows using for example 'KB', 'MiB', 'G' and 'B' as
number postfix.

The list of available International System prefixes follows, with
indication of the corresponding powers of 10 and of 2.

`y`{.sample}

:   10\^-24 / 2\^-80

`z`{.sample}

:   10\^-21 / 2\^-70

`a`{.sample}

:   10\^-18 / 2\^-60

`f`{.sample}

:   10\^-15 / 2\^-50

`p`{.sample}

:   10\^-12 / 2\^-40

`n`{.sample}

:   10\^-9 / 2\^-30

`u`{.sample}

:   10\^-6 / 2\^-20

`m`{.sample}

:   10\^-3 / 2\^-10

`c`{.sample}

:   10\^-2

`d`{.sample}

:   10\^-1

`h`{.sample}

:   10\^2

`k`{.sample}

:   10\^3 / 2\^10

`K`{.sample}

:   10\^3 / 2\^10

`M`{.sample}

:   10\^6 / 2\^20

`G`{.sample}

:   10\^9 / 2\^30

`T`{.sample}

:   10\^12 / 2\^40

`P`{.sample}

:   10\^15 / 2\^50

`E`{.sample}

:   10\^18 / 2\^60

`Z`{.sample}

:   10\^21 / 2\^70

`Y`{.sample}

:   10\^24 / 2\^80

[]{#codec_002doptions}[]{#Codec-Options}

## [9 Codec Options](#toc-Codec-Options) {#codec-options .chapter}

libavcodec provides some generic global options, which can be set on all
the encoders and decoders. In addition, each codec may support so-called
private options, which are specific for a given codec.

Sometimes, a global option may only affect a specific kind of codec, and
may be nonsensical or ignored by another, so you need to be aware of the
meaning of the specified options. Also some options are meant only for
decoding or encoding.

Options may be set by specifying -`option`{.variable} `value`{.variable}
in the FFmpeg tools, or by setting the value explicitly in the
`AVCodecContext` options or using the `libavutil/opt.h`{.sample} API for
programmatic use.

The list of supported options follow:

`b `{.sample}`integer`{.variable}` (`{.sample}*`encoding,audio,video`{.sample}*`)`{.sample}

Set bitrate in bits/s. Default value is 200K.

`ab `{.sample}`integer`{.variable}` (`{.sample}*`encoding,audio`{.sample}*`)`{.sample}

Set audio bitrate (in bits/s). Default value is 128K.

`bt `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set video bitrate tolerance (in bits/s). In 1-pass mode, bitrate
tolerance specifies how far ratecontrol is willing to deviate from the
target average bitrate value. This is not related to min/max bitrate.
Lowering tolerance too much has an adverse effect on quality.

`flags `{.sample}`flags`{.variable}` (`{.sample}*`decoding/encoding,audio,video,subtitles`{.sample}*`)`{.sample}

Set generic flags.

Possible values:

'`mv4`{.sample}'

:   Use four motion vector by macroblock (mpeg4).

'`qpel`{.sample}'

:   Use 1/4 pel motion compensation.

'`loop`{.sample}'

:   Use loop filter.

'`qscale`{.sample}'

:   Use fixed qscale.

'`pass1`{.sample}'

:   Use internal 2pass ratecontrol in first pass mode.

'`pass2`{.sample}'

:   Use internal 2pass ratecontrol in second pass mode.

'`gray`{.sample}'

:   Only decode/encode grayscale.

'`psnr`{.sample}'

:   Set error\[?\] variables during encoding.

'`truncated`{.sample}'

:   Input bitstream might be randomly truncated.

'`drop_changed`{.sample}'

:   Don't output frames whose parameters differ from first decoded frame
    in stream. Error AVERROR_INPUT_CHANGED is returned when a frame is
    dropped.

'`ildct`{.sample}'

:   Use interlaced DCT.

'`low_delay`{.sample}'

:   Force low delay.

'`global_header`{.sample}'

:   Place global headers in extradata instead of every keyframe.

'`bitexact`{.sample}'

:   Only write platform-, build- and time-independent data. (except
    (I)DCT). This ensures that file and data checksums are reproducible
    and match between platforms. Its primary use is for regression
    testing.

'`aic`{.sample}'

:   Apply H263 advanced intra coding / mpeg4 ac prediction.

'`ilme`{.sample}'

:   Apply interlaced motion estimation.

'`cgop`{.sample}'

:   Use closed gop.

'`output_corrupt`{.sample}'

:   Output even potentially corrupted frames.

`time_base `{.sample}`rational number`{.variable}

Set codec time base.

It is the fundamental unit of time (in seconds) in terms of which frame
timestamps are represented. For fixed-fps content, timebase should be
`1 / frame_rate` and timestamp increments should be identically 1.

`g `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set the group of picture (GOP) size. Default value is 12.

`ar `{.sample}`integer`{.variable}` (`{.sample}*`decoding/encoding,audio`{.sample}*`)`{.sample}

Set audio sampling rate (in Hz).

`ac `{.sample}`integer`{.variable}` (`{.sample}*`decoding/encoding,audio`{.sample}*`)`{.sample}

Set number of audio channels.

`cutoff `{.sample}`integer`{.variable}` (`{.sample}*`encoding,audio`{.sample}*`)`{.sample}

Set cutoff bandwidth. (Supported only by selected encoders, see their
respective documentation sections.)

`frame_size `{.sample}`integer`{.variable}` (`{.sample}*`encoding,audio`{.sample}*`)`{.sample}

Set audio frame size.

Each submitted frame except the last must contain exactly frame_size
samples per channel. May be 0 when the codec has
CODEC_CAP_VARIABLE_FRAME_SIZE set, in that case the frame size is not
restricted. It is set by some decoders to indicate constant frame size.

`frame_number `{.sample}`integer`{.variable}

Set the frame number.

`delay `{.sample}`integer`{.variable}

`qcomp `{.sample}`float`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set video quantizer scale compression (VBR). It is used as a constant in
the ratecontrol equation. Recommended range for default rc_eq: 0.0-1.0.

`qblur `{.sample}`float`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set video quantizer scale blur (VBR).

`qmin `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set min video quantizer scale (VBR). Must be included between -1 and 69,
default value is 2.

`qmax `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set max video quantizer scale (VBR). Must be included between -1 and
1024, default value is 31.

`qdiff `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set max difference between the quantizer scale (VBR).

`bf `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set max number of B frames between non-B-frames.

Must be an integer between -1 and 16. 0 means that B-frames are
disabled. If a value of -1 is used, it will choose an automatic value
depending on the encoder.

Default value is 0.

`b_qfactor `{.sample}`float`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set qp factor between P and B frames.

`codec_tag `{.sample}`integer`{.variable}

`bug `{.sample}`flags`{.variable}` (`{.sample}*`decoding,video`{.sample}*`)`{.sample}

Workaround not auto detected encoder bugs.

Possible values:

'`autodetect`{.sample}'\
'`xvid_ilace`{.sample}'

:   Xvid interlacing bug (autodetected if fourcc==XVIX)

'`ump4`{.sample}'

:   (autodetected if fourcc==UMP4)

'`no_padding`{.sample}'

:   padding bug (autodetected)

'`amv`{.sample}'\
'`qpel_chroma`{.sample}'\
'`std_qpel`{.sample}'

:   old standard qpel (autodetected per fourcc/version)

'`qpel_chroma2`{.sample}'\
'`direct_blocksize`{.sample}'

:   direct-qpel-blocksize bug (autodetected per fourcc/version)

'`edge`{.sample}'

:   edge padding bug (autodetected per fourcc/version)

'`hpel_chroma`{.sample}'\
'`dc_clip`{.sample}'\
'`ms`{.sample}'

:   Workaround various bugs in microsoft broken decoders.

'`trunc`{.sample}'

:   trancated frames

`strict `{.sample}`integer`{.variable}` (`{.sample}*`decoding/encoding,audio,video`{.sample}*`)`{.sample}

Specify how strictly to follow the standards.

Possible values:

'`very`{.sample}'

:   strictly conform to an older more strict version of the spec or
    reference software

'`strict`{.sample}'

:   strictly conform to all the things in the spec no matter what
    consequences

'`normal`{.sample}'\
'`unofficial`{.sample}'

:   allow unofficial extensions

'`experimental`{.sample}'

:   allow non standardized experimental things, experimental
    (unfinished/work in progress/not well tested) decoders and encoders.
    Note: experimental decoders can pose a security risk, do not use
    this for decoding untrusted input.

`b_qoffset `{.sample}`float`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set QP offset between P and B frames.

`err_detect `{.sample}`flags`{.variable}` (`{.sample}*`decoding,audio,video`{.sample}*`)`{.sample}

Set error detection flags.

Possible values:

'`crccheck`{.sample}'

:   verify embedded CRCs

'`bitstream`{.sample}'

:   detect bitstream specification deviations

'`buffer`{.sample}'

:   detect improper bitstream length

'`explode`{.sample}'

:   abort decoding on minor error detection

'`ignore_err`{.sample}'

:   ignore decoding errors, and continue decoding. This is useful if you
    want to analyze the content of a video and thus want everything to
    be decoded no matter what. This option will not result in a video
    that is pleasing to watch in case of errors.

'`careful`{.sample}'

:   consider things that violate the spec and have not been seen in the
    wild as errors

'`compliant`{.sample}'

:   consider all spec non compliancies as errors

'`aggressive`{.sample}'

:   consider things that a sane encoder should not do as an error

`has_b_frames `{.sample}`integer`{.variable}

`block_align `{.sample}`integer`{.variable}

`rc_override_count `{.sample}`integer`{.variable}

`maxrate `{.sample}`integer`{.variable}` (`{.sample}*`encoding,audio,video`{.sample}*`)`{.sample}

Set max bitrate tolerance (in bits/s). Requires bufsize to be set.

`minrate `{.sample}`integer`{.variable}` (`{.sample}*`encoding,audio,video`{.sample}*`)`{.sample}

Set min bitrate tolerance (in bits/s). Most useful in setting up a CBR
encode. It is of little use elsewise.

`bufsize `{.sample}`integer`{.variable}` (`{.sample}*`encoding,audio,video`{.sample}*`)`{.sample}

Set ratecontrol buffer size (in bits).

`i_qfactor `{.sample}`float`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set QP factor between P and I frames.

`i_qoffset `{.sample}`float`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set QP offset between P and I frames.

`dct `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set DCT algorithm.

Possible values:

'`auto`{.sample}'

:   autoselect a good one (default)

'`fastint`{.sample}'

:   fast integer

'`int`{.sample}'

:   accurate integer

'`mmx`{.sample}'\
'`altivec`{.sample}'\
'`faan`{.sample}'

:   floating point AAN DCT

`lumi_mask `{.sample}`float`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Compress bright areas stronger than medium ones.

`tcplx_mask `{.sample}`float`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set temporal complexity masking.

`scplx_mask `{.sample}`float`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set spatial complexity masking.

`p_mask `{.sample}`float`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set inter masking.

`dark_mask `{.sample}`float`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Compress dark areas stronger than medium ones.

`idct `{.sample}`integer`{.variable}` (`{.sample}*`decoding/encoding,video`{.sample}*`)`{.sample}

Select IDCT implementation.

Possible values:

'`auto`{.sample}'\
'`int`{.sample}'\
'`simple`{.sample}'\
'`simplemmx`{.sample}'\
'`simpleauto`{.sample}'

:   Automatically pick a IDCT compatible with the simple one

'`arm`{.sample}'\
'`altivec`{.sample}'\
'`sh4`{.sample}'\
'`simplearm`{.sample}'\
'`simplearmv5te`{.sample}'\
'`simplearmv6`{.sample}'\
'`simpleneon`{.sample}'\
'`xvid`{.sample}'\
'`faani`{.sample}'

:   floating point AAN IDCT

`slice_count `{.sample}`integer`{.variable}

`ec `{.sample}`flags`{.variable}` (`{.sample}*`decoding,video`{.sample}*`)`{.sample}

Set error concealment strategy.

Possible values:

'`guess_mvs`{.sample}'

:   iterative motion vector (MV) search (slow)

'`deblock`{.sample}'

:   use strong deblock filter for damaged MBs

'`favor_inter`{.sample}'

:   favor predicting from the previous frame instead of the current

`bits_per_coded_sample `{.sample}`integer`{.variable}

`aspect `{.sample}`rational number`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set sample aspect ratio.

`sar `{.sample}`rational number`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set sample aspect ratio. Alias to `aspect`{.variable}.

`debug `{.sample}`flags`{.variable}` (`{.sample}*`decoding/encoding,audio,video,subtitles`{.sample}*`)`{.sample}

Print specific debug info.

Possible values:

'`pict`{.sample}'

:   picture info

'`rc`{.sample}'

:   rate control

'`bitstream`{.sample}'\
'`mb_type`{.sample}'

:   macroblock (MB) type

'`qp`{.sample}'

:   per-block quantization parameter (QP)

'`dct_coeff`{.sample}'\
'`green_metadata`{.sample}'

:   display complexity metadata for the upcoming frame, GoP or for a
    given duration.

'`skip`{.sample}'\
'`startcode`{.sample}'\
'`er`{.sample}'

:   error recognition

'`mmco`{.sample}'

:   memory management control operations (H.264)

'`bugs`{.sample}'\
'`buffers`{.sample}'

:   picture buffer allocations

'`thread_ops`{.sample}'

:   threading operations

'`nomc`{.sample}'

:   skip motion compensation

`cmp `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set full pel me compare function.

Possible values:

'`sad`{.sample}'

sum of absolute differences, fast (default)

'`sse`{.sample}'

sum of squared errors

'`satd`{.sample}'

sum of absolute Hadamard transformed differences

'`dct`{.sample}'

sum of absolute DCT transformed differences

'`psnr`{.sample}'

sum of squared quantization errors (avoid, low quality)

'`bit`{.sample}'

number of bits needed for the block

'`rd`{.sample}'

rate distortion optimal, slow

'`zero`{.sample}'

0

'`vsad`{.sample}'

sum of absolute vertical differences

'`vsse`{.sample}'

sum of squared vertical differences

'`nsse`{.sample}'

noise preserving sum of squared differences

'`w53`{.sample}'

5/3 wavelet, only used in snow

'`w97`{.sample}'

9/7 wavelet, only used in snow

'`dctmax`{.sample}'

'`chroma`{.sample}'

`subcmp `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set sub pel me compare function.

Possible values:

'`sad`{.sample}'

sum of absolute differences, fast (default)

'`sse`{.sample}'

sum of squared errors

'`satd`{.sample}'

sum of absolute Hadamard transformed differences

'`dct`{.sample}'

sum of absolute DCT transformed differences

'`psnr`{.sample}'

sum of squared quantization errors (avoid, low quality)

'`bit`{.sample}'

number of bits needed for the block

'`rd`{.sample}'

rate distortion optimal, slow

'`zero`{.sample}'

0

'`vsad`{.sample}'

sum of absolute vertical differences

'`vsse`{.sample}'

sum of squared vertical differences

'`nsse`{.sample}'

noise preserving sum of squared differences

'`w53`{.sample}'

5/3 wavelet, only used in snow

'`w97`{.sample}'

9/7 wavelet, only used in snow

'`dctmax`{.sample}'

'`chroma`{.sample}'

`mbcmp `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set macroblock compare function.

Possible values:

'`sad`{.sample}'

sum of absolute differences, fast (default)

'`sse`{.sample}'

sum of squared errors

'`satd`{.sample}'

sum of absolute Hadamard transformed differences

'`dct`{.sample}'

sum of absolute DCT transformed differences

'`psnr`{.sample}'

sum of squared quantization errors (avoid, low quality)

'`bit`{.sample}'

number of bits needed for the block

'`rd`{.sample}'

rate distortion optimal, slow

'`zero`{.sample}'

0

'`vsad`{.sample}'

sum of absolute vertical differences

'`vsse`{.sample}'

sum of squared vertical differences

'`nsse`{.sample}'

noise preserving sum of squared differences

'`w53`{.sample}'

5/3 wavelet, only used in snow

'`w97`{.sample}'

9/7 wavelet, only used in snow

'`dctmax`{.sample}'

'`chroma`{.sample}'

`ildctcmp `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set interlaced dct compare function.

Possible values:

'`sad`{.sample}'

sum of absolute differences, fast (default)

'`sse`{.sample}'

sum of squared errors

'`satd`{.sample}'

sum of absolute Hadamard transformed differences

'`dct`{.sample}'

sum of absolute DCT transformed differences

'`psnr`{.sample}'

sum of squared quantization errors (avoid, low quality)

'`bit`{.sample}'

number of bits needed for the block

'`rd`{.sample}'

rate distortion optimal, slow

'`zero`{.sample}'

0

'`vsad`{.sample}'

sum of absolute vertical differences

'`vsse`{.sample}'

sum of squared vertical differences

'`nsse`{.sample}'

noise preserving sum of squared differences

'`w53`{.sample}'

5/3 wavelet, only used in snow

'`w97`{.sample}'

9/7 wavelet, only used in snow

'`dctmax`{.sample}'

'`chroma`{.sample}'

`dia_size `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set diamond type & size for motion estimation.

'`(1024, INT_MAX)`{.sample}'

:   full motion estimation(slowest)

'`(768, 1024]`{.sample}'

:   umh motion estimation

'`(512, 768]`{.sample}'

:   hex motion estimation

'`(256, 512]`{.sample}'

:   l2s diamond motion estimation

'`[2,256]`{.sample}'

:   var diamond motion estimation

'`(-1, 2)`{.sample}'

:   small diamond motion estimation

'`-1`{.sample}'

:   funny diamond motion estimation

'`(INT_MIN, -1)`{.sample}'

:   sab diamond motion estimation

`last_pred `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set amount of motion predictors from the previous frame.

`precmp `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set pre motion estimation compare function.

Possible values:

'`sad`{.sample}'

sum of absolute differences, fast (default)

'`sse`{.sample}'

sum of squared errors

'`satd`{.sample}'

sum of absolute Hadamard transformed differences

'`dct`{.sample}'

sum of absolute DCT transformed differences

'`psnr`{.sample}'

sum of squared quantization errors (avoid, low quality)

'`bit`{.sample}'

number of bits needed for the block

'`rd`{.sample}'

rate distortion optimal, slow

'`zero`{.sample}'

0

'`vsad`{.sample}'

sum of absolute vertical differences

'`vsse`{.sample}'

sum of squared vertical differences

'`nsse`{.sample}'

noise preserving sum of squared differences

'`w53`{.sample}'

5/3 wavelet, only used in snow

'`w97`{.sample}'

9/7 wavelet, only used in snow

'`dctmax`{.sample}'

'`chroma`{.sample}'

`pre_dia_size `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set diamond type & size for motion estimation pre-pass.

`subq `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set sub pel motion estimation quality.

`me_range `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set limit motion vectors range (1023 for DivX player).

`global_quality `{.sample}`integer`{.variable}` (`{.sample}*`encoding,audio,video`{.sample}*`)`{.sample}

`slice_flags `{.sample}`integer`{.variable}

`mbd `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set macroblock decision algorithm (high quality mode).

Possible values:

'`simple`{.sample}'

:   use mbcmp (default)

'`bits`{.sample}'

:   use fewest bits

'`rd`{.sample}'

:   use best rate distortion

`rc_init_occupancy `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set number of bits which should be loaded into the rc buffer before
decoding starts.

`flags2 `{.sample}`flags`{.variable}` (`{.sample}*`decoding/encoding,audio,video,subtitles`{.sample}*`)`{.sample}

Possible values:

'`fast`{.sample}'

:   Allow non spec compliant speedup tricks.

'`noout`{.sample}'

:   Skip bitstream encoding.

'`ignorecrop`{.sample}'

:   Ignore cropping information from sps.

'`local_header`{.sample}'

:   Place global headers at every keyframe instead of in extradata.

'`chunks`{.sample}'

:   Frame data might be split into multiple chunks.

'`showall`{.sample}'

:   Show all frames before the first keyframe.

'`export_mvs`{.sample}'

:   Export motion vectors into frame side-data (see
    `AV_FRAME_DATA_MOTION_VECTORS`) for codecs that support it. See also
    `doc/examples/export_mvs.c`{.sample}.

'`skip_manual`{.sample}'

:   Do not skip samples and export skip information as frame side data.

'`ass_ro_flush_noop`{.sample}'

:   Do not reset ASS ReadOrder field on flush.

'`icc_profiles`{.sample}'

:   Generate/parse embedded ICC profiles from/to colorimetry tags.

`export_side_data `{.sample}`flags`{.variable}` (`{.sample}*`decoding/encoding,audio,video,subtitles`{.sample}*`)`{.sample}

Possible values:

'`mvs`{.sample}'

:   Export motion vectors into frame side-data (see
    `AV_FRAME_DATA_MOTION_VECTORS`) for codecs that support it. See also
    `doc/examples/export_mvs.c`{.sample}.

'`prft`{.sample}'

:   Export encoder Producer Reference Time into packet side-data (see
    `AV_PKT_DATA_PRFT`) for codecs that support it.

'`venc_params`{.sample}'

:   Export video encoding parameters through frame side data (see
    `AV_FRAME_DATA_VIDEO_ENC_PARAMS`) for codecs that support it. At
    present, those are H.264 and VP9.

'`film_grain`{.sample}'

:   Export film grain parameters through frame side data (see
    `AV_FRAME_DATA_FILM_GRAIN_PARAMS`). Supported at present by AV1
    decoders.

'`enhancements`{.sample}'

:   Export picture enhancement metadata through frame side data, e.g.
    LCEVC (see `AV_FRAME_DATA_LCEVC`).

`threads `{.sample}`integer`{.variable}` (`{.sample}*`decoding/encoding,video`{.sample}*`)`{.sample}

Set the number of threads to be used, in case the selected codec
implementation supports multi-threading.

Possible values:

'`auto, 0`{.sample}'

:   automatically select the number of threads to set

Default value is '`auto`{.sample}'.

`dc `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set intra_dc_precision.

`nssew `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set nsse weight.

`skip_top `{.sample}`integer`{.variable}` (`{.sample}*`decoding,video`{.sample}*`)`{.sample}

Set number of macroblock rows at the top which are skipped.

`skip_bottom `{.sample}`integer`{.variable}` (`{.sample}*`decoding,video`{.sample}*`)`{.sample}

Set number of macroblock rows at the bottom which are skipped.

`profile `{.sample}`integer`{.variable}` (`{.sample}*`encoding,audio,video`{.sample}*`)`{.sample}

Set encoder codec profile. Default value is '`unknown`{.sample}'.
Encoder specific profiles are documented in the relevant encoder
documentation.

`level `{.sample}`integer`{.variable}` (`{.sample}*`encoding,audio,video`{.sample}*`)`{.sample}

Set the encoder level. This level depends on the specific codec, and
might correspond to the profile level. It is set by default to
'`unknown`{.sample}'.

Possible values:

'`unknown`{.sample}'

`lowres `{.sample}`integer`{.variable}` (`{.sample}*`decoding,audio,video`{.sample}*`)`{.sample}

Decode at 1= 1/2, 2=1/4, 3=1/8 resolutions.

`mblmin `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set min macroblock lagrange factor (VBR).

`mblmax `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set max macroblock lagrange factor (VBR).

`skip_loop_filter `{.sample}`integer`{.variable}` (`{.sample}*`decoding,video`{.sample}*`)`{.sample}

`skip_idct `{.sample}`integer`{.variable}` (`{.sample}*`decoding,video`{.sample}*`)`{.sample}

`skip_frame `{.sample}`integer`{.variable}` (`{.sample}*`decoding,video`{.sample}*`)`{.sample}

Make decoder discard processing depending on the frame type selected by
the option value.

`skip_loop_filter`{.sample} skips frame loop filtering,
`skip_idct`{.sample} skips frame IDCT/dequantization,
`skip_frame`{.sample} skips decoding.

Possible values:

'`none`{.sample}'

:   Discard no frame.

'`default`{.sample}'

:   Discard useless frames like 0-sized frames.

'`noref`{.sample}'

:   Discard all non-reference frames.

'`bidir`{.sample}'

:   Discard all bidirectional frames.

'`nokey`{.sample}'

:   Discard all frames excepts keyframes.

'`nointra`{.sample}'

:   Discard all frames except I frames.

'`all`{.sample}'

:   Discard all frames.

Default value is '`default`{.sample}'.

`bidir_refine `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Refine the two motion vectors used in bidirectional macroblocks.

`keyint_min `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set minimum interval between IDR-frames.

`refs `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Set reference frames to consider for motion compensation.

`trellis `{.sample}`integer`{.variable}` (`{.sample}*`encoding,audio,video`{.sample}*`)`{.sample}

Set rate-distortion optimal quantization.

`mv0_threshold `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

`compression_level `{.sample}`integer`{.variable}` (`{.sample}*`encoding,audio,video`{.sample}*`)`{.sample}

`bits_per_raw_sample `{.sample}`integer`{.variable}

`channel_layout `{.sample}`integer`{.variable}` (`{.sample}*`decoding/encoding,audio`{.sample}*`)`{.sample}

See [(ffmpeg-utils)the Channel Layout section in the ffmpeg-utils(1)
manual](ffmpeg-utils.html#channel-layout-syntax) for the required
syntax.

`rc_max_vbv_use `{.sample}`float`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

`rc_min_vbv_use `{.sample}`float`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

`color_primaries `{.sample}`integer`{.variable}` (`{.sample}*`decoding/encoding,video`{.sample}*`)`{.sample}

Possible values:

'`bt709`{.sample}'

:   BT.709

'`bt470m`{.sample}'

:   BT.470 M

'`bt470bg`{.sample}'

:   BT.470 BG

'`smpte170m`{.sample}'

:   SMPTE 170 M

'`smpte240m`{.sample}'

:   SMPTE 240 M

'`film`{.sample}'

:   Film

'`bt2020`{.sample}'

:   BT.2020

'`smpte428`{.sample}'\
'`smpte428_1`{.sample}'

:   SMPTE ST 428-1

'`smpte431`{.sample}'

:   SMPTE 431-2

'`smpte432`{.sample}'

:   SMPTE 432-1

'`jedec-p22`{.sample}'

:   JEDEC P22

`color_trc `{.sample}`integer`{.variable}` (`{.sample}*`decoding/encoding,video`{.sample}*`)`{.sample}

Possible values:

'`bt709`{.sample}'

:   BT.709

'`gamma22`{.sample}'

:   BT.470 M

'`gamma28`{.sample}'

:   BT.470 BG

'`smpte170m`{.sample}'

:   SMPTE 170 M

'`smpte240m`{.sample}'

:   SMPTE 240 M

'`linear`{.sample}'

:   Linear

'`log`{.sample}'\
'`log100`{.sample}'

:   Log

'`log_sqrt`{.sample}'\
'`log316`{.sample}'

:   Log square root

'`iec61966_2_4`{.sample}'\
'`iec61966-2-4`{.sample}'

:   IEC 61966-2-4

'`bt1361`{.sample}'\
'`bt1361e`{.sample}'

:   BT.1361

'`iec61966_2_1`{.sample}'\
'`iec61966-2-1`{.sample}'

:   IEC 61966-2-1

'`bt2020_10`{.sample}'\
'`bt2020_10bit`{.sample}'

:   BT.2020 - 10 bit

'`bt2020_12`{.sample}'\
'`bt2020_12bit`{.sample}'

:   BT.2020 - 12 bit

'`smpte2084`{.sample}'

:   SMPTE ST 2084

'`smpte428`{.sample}'\
'`smpte428_1`{.sample}'

:   SMPTE ST 428-1

'`arib-std-b67`{.sample}'

:   ARIB STD-B67

`colorspace `{.sample}`integer`{.variable}` (`{.sample}*`decoding/encoding,video`{.sample}*`)`{.sample}

Possible values:

'`rgb`{.sample}'

:   RGB

'`bt709`{.sample}'

:   BT.709

'`fcc`{.sample}'

:   FCC

'`bt470bg`{.sample}'

:   BT.470 BG

'`smpte170m`{.sample}'

:   SMPTE 170 M

'`smpte240m`{.sample}'

:   SMPTE 240 M

'`ycocg`{.sample}'

:   YCOCG

'`bt2020nc`{.sample}'\
'`bt2020_ncl`{.sample}'

:   BT.2020 NCL

'`bt2020c`{.sample}'\
'`bt2020_cl`{.sample}'

:   BT.2020 CL

'`smpte2085`{.sample}'

:   SMPTE 2085

'`chroma-derived-nc`{.sample}'

:   Chroma-derived NCL

'`chroma-derived-c`{.sample}'

:   Chroma-derived CL

'`ictcp`{.sample}'

:   ICtCp

`color_range `{.sample}`integer`{.variable}` (`{.sample}*`decoding/encoding,video`{.sample}*`)`{.sample}

If used as input parameter, it serves as a hint to the decoder, which
color_range the input has. Possible values:

'`tv`{.sample}'\
'`mpeg`{.sample}'\
'`limited`{.sample}'

:   MPEG (219\*2\^(n-8))

'`pc`{.sample}'\
'`jpeg`{.sample}'\
'`full`{.sample}'

:   JPEG (2\^n-1)

`chroma_sample_location `{.sample}`integer`{.variable}` (`{.sample}*`decoding/encoding,video`{.sample}*`)`{.sample}

Possible values:

'`left`{.sample}'

'`center`{.sample}'

'`topleft`{.sample}'

'`top`{.sample}'

'`bottomleft`{.sample}'

'`bottom`{.sample}'

`alpha_mode `{.sample}`integer`{.variable}` (`{.sample}*`decoding/encoding,video`{.sample}*`)`{.sample}

Possible values:

'`premultiplied`{.sample}'

'`straight`{.sample}'

`log_level_offset `{.sample}`integer`{.variable}

Set the log level offset.

`slices `{.sample}`integer`{.variable}` (`{.sample}*`encoding,video`{.sample}*`)`{.sample}

Number of slices, used in parallelized encoding.

`thread_type `{.sample}`flags`{.variable}` (`{.sample}*`decoding/encoding,video`{.sample}*`)`{.sample}

Select which multithreading methods to use.

Use of '`frame`{.sample}' will increase decoding delay by one frame per
thread, so clients which cannot provide future frames should not use it.

Possible values:

'`slice`{.sample}'

:   Decode more than one part of a single frame at once.

    Multithreading using slices works only when the video was encoded
    with slices.

'`frame`{.sample}'

:   Decode more than one frame at once.

Default value is '`slice+frame`{.sample}'.

`audio_service_type `{.sample}`integer`{.variable}` (`{.sample}*`encoding,audio`{.sample}*`)`{.sample}

Set audio service type.

Possible values:

'`ma`{.sample}'

:   Main Audio Service

'`ef`{.sample}'

:   Effects

'`vi`{.sample}'

:   Visually Impaired

'`hi`{.sample}'

:   Hearing Impaired

'`di`{.sample}'

:   Dialogue

'`co`{.sample}'

:   Commentary

'`em`{.sample}'

:   Emergency

'`vo`{.sample}'

:   Voice Over

'`ka`{.sample}'

:   Karaoke

`request_sample_fmt `{.sample}`sample_fmt`{.variable}` (`{.sample}*`decoding,audio`{.sample}*`)`{.sample}

Set sample format audio decoders should prefer. Default value is `none`.

`pkt_timebase `{.sample}`rational number`{.variable}

`sub_charenc `{.sample}`encoding`{.variable}` (`{.sample}*`decoding,subtitles`{.sample}*`)`{.sample}

Set the input subtitles character encoding.

`field_order `{.sample}`field_order`{.variable}` (`{.sample}*`video`{.sample}*`)`{.sample}

Set/override the field order of the video. Possible values:

'`progressive`{.sample}'

:   Progressive video

'`tt`{.sample}'

:   Interlaced video, top field coded and displayed first

'`bb`{.sample}'

:   Interlaced video, bottom field coded and displayed first

'`tb`{.sample}'

:   Interlaced video, top coded first, bottom displayed first

'`bt`{.sample}'

:   Interlaced video, bottom coded first, top displayed first

`skip_alpha `{.sample}`bool`{.variable}` (`{.sample}*`decoding,video`{.sample}*`)`{.sample}

Set to 1 to disable processing alpha (transparency). This works like the
'`gray`{.sample}' flag in the `flags`{.sample} option which skips chroma
information instead of alpha. Default is 0.

`codec_whitelist `{.sample}`list`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

\",\" separated list of allowed decoders. By default all are allowed.

`dump_separator `{.sample}`string`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Separator used to separate the fields printed on the command line about
the Stream parameters. For example, to separate the fields with newlines
and indentation:

::: example
``` example
ffprobe -dump_separator "
                          "  -i ~/videos/matrixbench_mpeg2.mpg
```
:::

`max_pixels `{.sample}`integer`{.variable}` (`{.sample}*`decoding/encoding,video`{.sample}*`)`{.sample}

Maximum number of pixels per image. This value can be used to avoid out
of memory failures due to large images.

`apply_cropping `{.sample}`bool`{.variable}` (`{.sample}*`decoding,video`{.sample}*`)`{.sample}

Enable cropping if cropping parameters are multiples of the required
alignment for the left and top parameters. If the alignment is not met
the cropping will be partially applied to maintain alignment. Default is
1 (enabled). Note: The required alignment depends on if
`AV_CODEC_FLAG_UNALIGNED` is set and the CPU. `AV_CODEC_FLAG_UNALIGNED`
cannot be changed from the command line. Also hardware decoders will not
apply left/top Cropping.

[]{#Decoders}

## [10 Decoders](#toc-Decoders) {#decoders .chapter}

Decoders are configured elements in FFmpeg which allow the decoding of
multimedia streams.

When you configure your FFmpeg build, all the supported native decoders
are enabled by default. Decoders requiring an external library must be
enabled manually via the corresponding `--enable-lib` option. You can
list all available decoders using the configure option
`--list-decoders`.

You can disable all the decoders with the configure option
`--disable-decoders` and selectively enable / disable single decoders
with the options `--enable-decoder=``DECODER`{.variable} /
`--disable-decoder=``DECODER`{.variable}.

The option `-decoders` of the ff\* tools will display the list of
enabled decoders.

[]{#Video-Decoders}

## [11 Video Decoders](#toc-Video-Decoders) {#video-decoders .chapter}

A description of some of the currently available video decoders follows.

[]{#av1}

### [11.1 av1](#toc-av1) {#av1 .section}

AOMedia Video 1 (AV1) decoder.

[]{#Options-1}

#### [11.1.1 Options](#toc-Options-1) {#options-1 .subsection}

`operating_point`{.sample}

:   Select an operating point of a scalable AV1 bitstream (0 - 31).
    Default is 0.

[]{#hevc}

### [11.2 hevc](#toc-hevc) {#hevc .section}

HEVC (AKA ITU-T H.265 or ISO/IEC 23008-2) decoder.

The decoder supports MV-HEVC multiview streams with at most two views.
Views to be output are selected by supplying a list of view IDs to the
decoder (the `view_ids`{.sample} option). This option may be set either
statically before decoder init, or from the `get_format()` callback -
useful for the case when the view count or IDs change dynamically during
decoding.

Only the base layer is decoded by default.

Note that if you are using the `ffmpeg` CLI tool, you should be using
view specifiers as documented in its manual, rather than the options
documented here.

[]{#Options-2}

#### [11.2.1 Options](#toc-Options-2) {#options-2 .subsection}

`view_ids (MV-HEVC)`{.sample}

:   Specify a list of view IDs that should be output. This option can
    also be set to a single '-1', which will cause all views defined in
    the VPS to be decoded and output.

`view_ids_available (MV-HEVC)`{.sample}

:   This option may be read by the caller to retrieve an array of view
    IDs available in the active VPS. The array is empty for single-layer
    video.

    The value of this option is guaranteed to be accurate when read from
    the `get_format()` callback. It may also be set at other times (e.g.
    after opening the decoder), but the value is informational only and
    may be incorrect (e.g. when the stream contains multiple distinct
    VPS NALUs).

`view_pos_available (MV-HEVC)`{.sample}

:   This option may be read by the caller to retrieve an array of view
    positions (left, right, or unspecified) available in the active VPS,
    as `AVStereo3DView` values. When the array is available, its
    elements apply to the corresponding elements of
    `view_ids_available`{.sample}, i.e. `view_pos_available[i]` contains
    the position of view with ID `view_ids_available[i]`.

    Same validity restrictions as for `view_ids_available`{.sample}
    apply to this option.

[]{#rawvideo}

### [11.3 rawvideo](#toc-rawvideo) {#rawvideo .section}

Raw video decoder.

This decoder decodes rawvideo streams.

[]{#Options-3}

#### [11.3.1 Options](#toc-Options-3) {#options-3 .subsection}

`top `{.sample}`top_field_first`{.variable}

:   Specify the assumed field type of the input video.

    `-1`{.sample}

    :   the video is assumed to be progressive (default)

    `0`{.sample}

    :   bottom-field-first is assumed

    `1`{.sample}

    :   top-field-first is assumed

[]{#libdav1d}

### [11.4 libdav1d](#toc-libdav1d) {#libdav1d .section}

dav1d AV1 decoder.

libdav1d allows libavcodec to decode the AOMedia Video 1 (AV1) codec.
Requires the presence of the libdav1d headers and library during
configuration. You need to explicitly configure the build with
`--enable-libdav1d`.

[]{#Options-4}

#### [11.4.1 Options](#toc-Options-4) {#options-4 .subsection}

The following options are supported by the libdav1d wrapper.

`max_frame_delay`{.sample}

:   Set max amount of frames the decoder may buffer internally. The
    default value is 0 (autodetect).

`filmgrain`{.sample}

:   Apply film grain to the decoded video if present in the bitstream.
    Defaults to the internal default of the library. This option is
    deprecated and will be removed in the future. See the global option
    `export_side_data` to export Film Grain parameters instead of
    applying it.

`oppoint`{.sample}

:   Select an operating point of a scalable AV1 bitstream (0 - 31).
    Defaults to the internal default of the library.

`alllayers`{.sample}

:   Output all spatial layers of a scalable AV1 bitstream. The default
    value is false.

[]{#libdavs2}

### [11.5 libdavs2](#toc-libdavs2) {#libdavs2 .section}

AVS2-P2/IEEE1857.4 video decoder wrapper.

This decoder allows libavcodec to decode AVS2 streams with davs2
library.

[]{#libuavs3d}

### [11.6 libuavs3d](#toc-libuavs3d) {#libuavs3d .section}

AVS3-P2/IEEE1857.10 video decoder.

libuavs3d allows libavcodec to decode AVS3 streams. Requires the
presence of the libuavs3d headers and library during configuration. You
need to explicitly configure the build with `--enable-libuavs3d`.

[]{#Options-5}

#### [11.6.1 Options](#toc-Options-5) {#options-5 .subsection}

The following option is supported by the libuavs3d wrapper.

`frame_threads`{.sample}

:   Set amount of frame threads to use during decoding. The default
    value is 0 (autodetect).

[]{#libxevd}

### [11.7 libxevd](#toc-libxevd) {#libxevd .section}

eXtra-fast Essential Video Decoder (XEVD) MPEG-5 EVC decoder wrapper.

This decoder requires the presence of the libxevd headers and library
during configuration. You need to explicitly configure the build with
`--enable-libxevd`{.sample}.

The xevd project website is at <https://github.com/mpeg5/xevd>.

[]{#Options-6}

#### [11.7.1 Options](#toc-Options-6) {#options-6 .subsection}

The following options are supported by the libxevd wrapper. The
xevd-equivalent options or values are listed in parentheses for easy
migration.

To get a more accurate and extensive documentation of the libxevd
options, invoke the command `xevd_app --help` or consult the libxevd
documentation.

`threads (`{.sample}*`threads`{.sample}*`)`{.sample}

:   Force to use a specific number of threads

[]{#QSV-Decoders}

### [11.8 QSV Decoders](#toc-QSV-Decoders) {#qsv-decoders .section}

The family of Intel QuickSync Video decoders (VC1, MPEG-2, H.264, HEVC,
JPEG/MJPEG, VP8, VP9, AV1, VVC).

[]{#Common-Options}

#### [11.8.1 Common Options](#toc-Common-Options) {#common-options .subsection}

The following options are supported by all qsv decoders.

`async_depth`{.variable}

Internal parallelization depth, the higher the value the higher the
latency.

`gpu_copy`{.variable}

A GPU-accelerated copy between video and system memory

'`default`{.sample}'

'`on`{.sample}'

'`off`{.sample}'

[]{#HEVC-Options}

#### [11.8.2 HEVC Options](#toc-HEVC-Options) {#hevc-options .subsection}

Extra options for hevc_qsv.

`load_plugin`{.variable}

A user plugin to load in an internal session

'`none`{.sample}'

'`hevc_sw`{.sample}'

'`hevc_hw`{.sample}'

`load_plugins`{.variable}

A :-separate list of hexadecimal plugin UIDs to load in an internal
session

[]{#v210}

### [11.9 v210](#toc-v210) {#v210 .section}

Uncompressed 4:2:2 10-bit decoder.

[]{#Options-7}

#### [11.9.1 Options](#toc-Options-7) {#options-7 .subsection}

`custom_stride`{.sample}

:   Set the line size of the v210 data in bytes. The default value is 0
    (autodetect). You can use the special -1 value for a strideless v210
    as seen in BOXX files.

[]{#Audio-Decoders}

## [12 Audio Decoders](#toc-Audio-Decoders) {#audio-decoders .chapter}

A description of some of the currently available audio decoders follows.

[]{#ac3}

### [12.1 ac3](#toc-ac3) {#ac3 .section}

AC-3 audio decoder.

This decoder implements part of ATSC A/52:2010 and ETSI TS 102 366, as
well as the undocumented RealAudio 3 (a.k.a. dnet).

[]{#AC_002d3-Decoder-Options}

#### [12.1.1 AC-3 Decoder Options](#toc-AC_002d3-Decoder-Options) {#ac-3-decoder-options .subsection}

`-drc_scale `{.sample}`value`{.variable}

:   Dynamic Range Scale Factor. The factor to apply to dynamic range
    values from the AC-3 stream. This factor is applied exponentially.
    The default value is 1. There are 3 notable scale factor ranges:

    `drc_scale == 0`{.sample}

    :   DRC disabled. Produces full range audio.

    `0 < drc_scale <= 1`{.sample}

    :   DRC enabled. Applies a fraction of the stream DRC value. Audio
        reproduction is between full range and full compression.

    `drc_scale > 1`{.sample}

    :   DRC enabled. Applies drc_scale asymmetrically. Loud sounds are
        fully compressed. Soft sounds are enhanced.

[]{#flac-1}

### [12.2 flac](#toc-flac-1) {#flac .section}

FLAC audio decoder.

This decoder aims to implement the complete FLAC specification from
Xiph.

[]{#FLAC-Decoder-options}

#### [12.2.1 FLAC Decoder options](#toc-FLAC-Decoder-options) {#flac-decoder-options .subsection}

`-use_buggy_lpc`{.sample}

:   The lavc FLAC encoder used to produce buggy streams with high lpc
    values (like the default value). This option makes it possible to
    decode such streams correctly by using lavc's old buggy lpc logic
    for decoding.

[]{#ffwavesynth}

### [12.3 ffwavesynth](#toc-ffwavesynth) {#ffwavesynth .section}

Internal wave synthesizer.

This decoder generates wave patterns according to predefined sequences.
Its use is purely internal and the format of the data it accepts is not
publicly documented.

[]{#libcelt}

### [12.4 libcelt](#toc-libcelt) {#libcelt .section}

libcelt decoder wrapper.

libcelt allows libavcodec to decode the Xiph CELT ultra-low delay audio
codec. Requires the presence of the libcelt headers and library during
configuration. You need to explicitly configure the build with
`--enable-libcelt`.

[]{#libgsm}

### [12.5 libgsm](#toc-libgsm) {#libgsm .section}

libgsm decoder wrapper.

libgsm allows libavcodec to decode the GSM full rate audio codec.
Requires the presence of the libgsm headers and library during
configuration. You need to explicitly configure the build with
`--enable-libgsm`.

This decoder supports both the ordinary GSM and the Microsoft variant.

[]{#libilbc}

### [12.6 libilbc](#toc-libilbc) {#libilbc .section}

libilbc decoder wrapper.

libilbc allows libavcodec to decode the Internet Low Bitrate Codec
(iLBC) audio codec. Requires the presence of the libilbc headers and
library during configuration. You need to explicitly configure the build
with `--enable-libilbc`.

[]{#Options-8}

#### [12.6.1 Options](#toc-Options-8) {#options-8 .subsection}

The following option is supported by the libilbc wrapper.

`enhance`{.sample}

:   Enable the enhancement of the decoded audio when set to 1. The
    default value is 0 (disabled).

[]{#libmpeghdec}

### [12.7 libmpeghdec](#toc-libmpeghdec) {#libmpeghdec .section}

libmpeghdec decoder wrapper.

libmpeghdec allows libmpeghdec to decode the MPEG-H 3D audio codec.
Requires the presence of the libmpeghdec headers and library during
configuration. You need to explicitly configure the build with
`--enable-libmpeghdec --enable-nonfree`.

[]{#libopencore_002damrnb}

### [12.8 libopencore-amrnb](#toc-libopencore_002damrnb) {#libopencore-amrnb .section}

libopencore-amrnb decoder wrapper.

libopencore-amrnb allows libavcodec to decode the Adaptive Multi-Rate
Narrowband audio codec. Using it requires the presence of the
libopencore-amrnb headers and library during configuration. You need to
explicitly configure the build with `--enable-libopencore-amrnb`.

An FFmpeg native decoder for AMR-NB exists, so users can decode AMR-NB
without this library.

[]{#libopencore_002damrwb}

### [12.9 libopencore-amrwb](#toc-libopencore_002damrwb) {#libopencore-amrwb .section}

libopencore-amrwb decoder wrapper.

libopencore-amrwb allows libavcodec to decode the Adaptive Multi-Rate
Wideband audio codec. Using it requires the presence of the
libopencore-amrwb headers and library during configuration. You need to
explicitly configure the build with `--enable-libopencore-amrwb`.

An FFmpeg native decoder for AMR-WB exists, so users can decode AMR-WB
without this library.

[]{#libopus}

### [12.10 libopus](#toc-libopus) {#libopus .section}

libopus decoder wrapper.

libopus allows libavcodec to decode the Opus Interactive Audio Codec.
Requires the presence of the libopus headers and library during
configuration. You need to explicitly configure the build with
`--enable-libopus`.

An FFmpeg native decoder for Opus exists, so users can decode Opus
without this library.

[]{#Subtitles-Decoders}

## [13 Subtitles Decoders](#toc-Subtitles-Decoders) {#subtitles-decoders .chapter}

[]{#libaribb24}

### [13.1 libaribb24](#toc-libaribb24) {#libaribb24 .section}

ARIB STD-B24 caption decoder.

Implements profiles A and C of the ARIB STD-B24 standard.

[]{#libaribb24-Decoder-Options}

#### [13.1.1 libaribb24 Decoder Options](#toc-libaribb24-Decoder-Options) {#libaribb24-decoder-options .subsection}

`-aribb24-base-path `{.sample}`path`{.variable}

:   Sets the base path for the libaribb24 library. This is utilized for
    reading of configuration files (for custom unicode conversions), and
    for dumping of non-text symbols as images under that location.

    Unset by default.

`-aribb24-skip-ruby-text `{.sample}`boolean`{.variable}

:   Tells the decoder wrapper to skip text blocks that contain
    half-height ruby text.

    Enabled by default.

[]{#libaribcaption}

### [13.2 libaribcaption](#toc-libaribcaption) {#libaribcaption .section}

Yet another ARIB STD-B24 caption decoder using external *libaribcaption*
library.

Implements profiles A and C of the Japanese ARIB STD-B24 standard,
Brazilian ABNT NBR 15606-1, and Philippines version of ISDB-T.

Requires the presence of the libaribcaption headers and library
(<https://github.com/xqq/libaribcaption>) during configuration. You need
to explicitly configure the build with `--enable-libaribcaption`. If
both *libaribb24* and *libaribcaption* are enabled, *libaribcaption*
decoder precedes.

[]{#libaribcaption-Decoder-Options}

#### [13.2.1 libaribcaption Decoder Options](#toc-libaribcaption-Decoder-Options) {#libaribcaption-decoder-options .subsection}

`-sub_type `{.sample}`subtitle_type`{.variable}

:   Specifies the format of the decoded subtitles.

    '`bitmap`{.sample}'

    :   Graphical image.

    '`ass`{.sample}'

    :   ASS formatted text.

    '`text`{.sample}'

    :   Simple text based output without formatting.

    The default is *ass* as same as *libaribb24* decoder. Some present
    players (e.g., *mpv*) expect ASS format for ARIB caption.

`-caption_encoding `{.sample}`encoding_scheme`{.variable}

:   Specifies the encoding scheme of input subtitle text.

    '`auto`{.sample}'

    :   Automatically detect text encoding (default).

    '`jis`{.sample}'

    :   8bit-char JIS encoding defined in ARIB STD B24. This encoding
        used in Japan for ISDB captions.

    '`utf8`{.sample}'

    :   UTF-8 encoding defined in ARIB STD B24. This encoding is used in
        Philippines for ISDB-T captions.

    '`latin`{.sample}'

    :   Latin character encoding defined in ABNT NBR 15606-1. This
        encoding is used in South America for SBTVD / ISDB-Tb captions.

`-font `{.sample}`font_name[,font_name2,...]`{.variable}

:   Specify comma-separated list of font family names to be used for
    *bitmap* or *ass* type subtitle rendering. Only first font name is
    used for *ass* type subtitle.

    If not specified, use internally defined default font family.

`-ass_single_rect `{.sample}`boolean`{.variable}

:   ARIB STD-B24 specifies that some captions may be displayed at
    different positions at a time (multi-rectangle subtitle). Since some
    players (e.g., old *mpv*) can't handle multiple ASS rectangles in a
    single AVSubtitle, or multiple ASS rectangles of indeterminate
    duration with the same start timestamp, this option can change the
    behavior so that all the texts are displayed in a single ASS
    rectangle.

    The default is `false`{.variable}.

    If your player cannot handle AVSubtitles with multiple ASS
    rectangles properly, set this option to `true`{.variable} or define
    `ASS_SINGLE_RECT=1` to change default behavior at compilation.

`-force_outline_text `{.sample}`boolean`{.variable}

:   Specify whether always render outline text for all characters
    regardless of the indication by character style.

    The default is `false`{.variable}.

`-outline_width `{.sample}`number`{.variable}` (0.0 - 3.0)`{.sample}

:   Specify width for outline text, in dots (relative).

    The default is `1.5`{.variable}.

`-ignore_background `{.sample}`boolean`{.variable}

:   Specify whether to ignore background color rendering.

    The default is `false`{.variable}.

`-ignore_ruby `{.sample}`boolean`{.variable}

:   Specify whether to ignore rendering for ruby-like (furigana)
    characters.

    The default is `false`{.variable}.

`-replace_drcs `{.sample}`boolean`{.variable}

:   Specify whether to render replaced DRCS characters as Unicode
    characters.

    The default is `true`{.variable}.

`-replace_msz_ascii `{.sample}`boolean`{.variable}

:   Specify whether to replace MSZ (Middle Size; half width) fullwidth
    alphanumerics with halfwidth alphanumerics.

    The default is `true`{.variable}.

`-replace_msz_japanese `{.sample}`boolean`{.variable}

:   Specify whether to replace some MSZ (Middle Size; half width)
    fullwidth japanese special characters with halfwidth ones.

    The default is `true`{.variable}.

`-replace_msz_glyph `{.sample}`boolean`{.variable}

:   Specify whether to replace MSZ (Middle Size; half width) characters
    with halfwidth glyphs if the fonts supports it. This option works
    under FreeType or DirectWrite renderer with Adobe-Japan1 compliant
    fonts. e.g., IBM Plex Sans JP, Morisawa BIZ UDGothic, Morisawa BIZ
    UDMincho, Yu Gothic, Yu Mincho, and Meiryo.

    The default is `true`{.variable}.

`-canvas_size `{.sample}`image_size`{.variable}

:   Specify the resolution of the canvas to render subtitles to;
    usually, this should be frame size of input video. This only applies
    when `-subtitle_type` is set to `bitmap`{.variable}.

    The libaribcaption decoder assumes input frame size for bitmap
    rendering as below:

    1.  PROFILE_A : 1440 x 1080 with SAR (PAR) 4:3
    2.  PROFILE_C : 320 x 180 with SAR (PAR) 1:1

    If actual frame size of input video does not match above assumption,
    the rendered captions may be distorted. To make the captions
    undistorted, add `-canvas_size` option to specify actual input video
    size.

    Note that the `-canvas_size` option is not required for video with
    different size but same aspect ratio. In such cases, the caption
    will be stretched or shrunk to actual video size if `-canvas_size`
    option is not specified. If `-canvas_size` option is specified with
    different size, the caption will be stretched or shrunk as specified
    size with calculated SAR.

[]{#libaribcaption-decoder-usage-examples}

#### [13.2.2 libaribcaption decoder usage examples](#toc-libaribcaption-decoder-usage-examples) {#libaribcaption-decoder-usage-examples .subsection}

Display MPEG-TS file with ARIB subtitle by `ffplay` tool:

::: example
``` example
ffplay -sub_type bitmap MPEG.TS
```
:::

Display MPEG-TS file with input frame size 1920x1080 by `ffplay` tool:

::: example
``` example
ffplay -sub_type bitmap -canvas_size 1920x1080 MPEG.TS
```
:::

Embed ARIB subtitle in transcoded video:

::: example
``` example
ffmpeg -sub_type bitmap -i src.m2t -filter_complex "[0:v][0:s]overlay" -vcodec h264 dest.mp4
```
:::

[]{#dvbsub}

### [13.3 dvbsub](#toc-dvbsub) {#dvbsub .section}

[]{#Options-9}

#### [13.3.1 Options](#toc-Options-9) {#options-9 .subsection}

`compute_clut`{.sample}

:   

    `-2`{.sample}

    :   Compute clut once if no matching CLUT is in the stream.

    `-1`{.sample}

    :   Compute clut if no matching CLUT is in the stream.

    `0`{.sample}

    :   Never compute CLUT

    `1`{.sample}

    :   Always compute CLUT and override the one provided in the stream.

`dvb_substream`{.sample}

:   Selects the dvb substream, or all substreams if -1 which is default.

[]{#dvdsub}

### [13.4 dvdsub](#toc-dvdsub) {#dvdsub .section}

This codec decodes the bitmap subtitles used in DVDs; the same subtitles
can also be found in VobSub file pairs and in some Matroska files.

[]{#Options-10}

#### [13.4.1 Options](#toc-Options-10) {#options-10 .subsection}

`palette`{.sample}

:   Specify the global palette used by the bitmaps. When stored in
    VobSub, the palette is normally specified in the index file; in
    Matroska, the palette is stored in the codec extra-data in the same
    format as in VobSub. In DVDs, the palette is stored in the IFO file,
    and therefore not available when reading from dumped VOB files.

    The format for this option is a string containing 16 24-bits
    hexadecimal numbers (without 0x prefix) separated by commas, for
    example
    `0d00ee, ee450d, 101010, eaeaea, 0ce60b, ec14ed, ebff0b, 0d617a, 7b7b7b, d1d1d1, 7b2a0e, 0d950c, 0f007b, cf0dec, cfa80c, 7c127b`.

`ifo_palette`{.sample}

:   Specify the IFO file from which the global palette is obtained.
    (experimental)

`forced_subs_only`{.sample}

:   Only decode subtitle entries marked as forced. Some titles have
    forced and non-forced subtitles in the same track. Setting this flag
    to `1` will only keep the forced subtitles. Default value is `0`.

[]{#libzvbi_002dteletext}

### [13.5 libzvbi-teletext](#toc-libzvbi_002dteletext) {#libzvbi-teletext .section}

Libzvbi allows libavcodec to decode DVB teletext pages and DVB teletext
subtitles. Requires the presence of the libzvbi headers and library
during configuration. You need to explicitly configure the build with
`--enable-libzvbi`.

[]{#Options-11}

#### [13.5.1 Options](#toc-Options-11) {#options-11 .subsection}

`txt_page`{.sample}

:   List of teletext page numbers to decode. Pages that do not match the
    specified list are dropped. You may use the special `*` string to
    match all pages, or `subtitle` to match all subtitle pages. Default
    value is \*.

`txt_default_region`{.sample}

:   Set default character set used for decoding, a value between 0 and
    87 (see ETS 300 706, Section 15, Table 32). Default value is -1,
    which does not override the libzvbi default. This option is needed
    for some legacy level 1.0 transmissions which cannot signal the
    proper charset.

`txt_chop_top`{.sample}

:   Discards the top teletext line. Default value is 1.

`txt_format`{.sample}

:   Specifies the format of the decoded subtitles.

    `bitmap`{.sample}

    :   The default format, you should use this for teletext pages,
        because certain graphics and colors cannot be expressed in
        simple text or even ASS.

    `text`{.sample}

    :   Simple text based output without formatting.

    `ass`{.sample}

    :   Formatted ASS output, subtitle pages and teletext pages are
        returned in different styles, subtitle pages are stripped down
        to text, but an effort is made to keep the text alignment and
        the formatting.

`txt_left`{.sample}

:   X offset of generated bitmaps, default is 0.

`txt_top`{.sample}

:   Y offset of generated bitmaps, default is 0.

`txt_chop_spaces`{.sample}

:   Chops leading and trailing spaces and removes empty lines from the
    generated text. This option is useful for teletext based subtitles
    where empty spaces may be present at the start or at the end of the
    lines or empty lines may be present between the subtitle lines
    because of double-sized teletext characters. Default value is 1.

`txt_duration`{.sample}

:   Sets the display duration of the decoded teletext pages or subtitles
    in milliseconds. Default value is -1 which means infinity or until
    the next subtitle event comes.

`txt_transparent`{.sample}

:   Force transparent background of the generated teletext bitmaps.
    Default value is 0 which means an opaque background.

`txt_opacity`{.sample}

:   Sets the opacity (0-255) of the teletext background. If
    `txt_transparent`{.sample} is not set, it only affects characters
    between a start box and an end box, typically subtitles. Default
    value is 0 if `txt_transparent`{.sample} is set, 255 otherwise.

[]{#Encoders}

## [14 Encoders](#toc-Encoders) {#encoders .chapter}

Encoders are configured elements in FFmpeg which allow the encoding of
multimedia streams.

When you configure your FFmpeg build, all the supported native encoders
are enabled by default. Encoders requiring an external library must be
enabled manually via the corresponding `--enable-lib` option. You can
list all available encoders using the configure option
`--list-encoders`.

You can disable all the encoders with the configure option
`--disable-encoders` and selectively enable / disable single encoders
with the options `--enable-encoder=``ENCODER`{.variable} /
`--disable-encoder=``ENCODER`{.variable}.

The option `-encoders` of the ff\* tools will display the list of
enabled encoders.

[]{#Audio-Encoders}

## [15 Audio Encoders](#toc-Audio-Encoders) {#audio-encoders .chapter}

A description of some of the currently available audio encoders follows.

[]{#aacenc}[]{#aac}

### [15.1 aac](#toc-aac) {#aac .section}

Advanced Audio Coding (AAC) encoder.

This encoder is the default AAC encoder, natively implemented into
FFmpeg.

[]{#Options-12}

#### [15.1.1 Options](#toc-Options-12) {#options-12 .subsection}

`b`{.sample}

:   Set bit rate in bits/s. Setting this automatically activates
    constant bit rate (CBR) mode. If this option is unspecified it is
    set to 128kbps.

`q`{.sample}

:   Set quality for variable bit rate (VBR) mode. This option is valid
    only using the `ffmpeg` command-line tool. For library interface
    users, use `global_quality`{.sample}.

`cutoff`{.sample}

:   Set cutoff frequency. If unspecified will allow the encoder to
    dynamically adjust the cutoff to improve clarity on low bitrates.

`aac_coder`{.sample}

:   Set AAC encoder coding method. Possible values:

    '`twoloop`{.sample}'

    :   Two loop searching (TLS) method. This is the default method.

        This method first sets quantizers depending on band thresholds
        and then tries to find an optimal combination by adding or
        subtracting a specific value from all quantizers and adjusting
        some individual quantizer a little. Will tune itself based on
        whether `aac_is`{.sample}, `aac_ms`{.sample} and
        `aac_pns`{.sample} are enabled.

    '`anmr`{.sample}'

    :   Average noise to mask ratio (ANMR) trellis-based solution.

        This is an experimental coder which currently produces a lower
        quality, is more unstable and is slower than the default twoloop
        coder but has potential. Currently has no support for the
        `aac_is`{.sample} or `aac_pns`{.sample} options. Not currently
        recommended.

    '`fast`{.sample}'

    :   Constant quantizer method.

        Uses a cheaper version of twoloop algorithm that doesn't try to
        do as many clever adjustments. Worse with low bitrates (less
        than 64kbps), but is better and much faster at higher bitrates.

`aac_ms`{.sample}

:   Sets mid/side coding mode. The default value of \"auto\" will
    automatically use M/S with bands which will benefit from such
    coding. Can be forced for all bands using the value \"enable\",
    which is mainly useful for debugging or disabled using \"disable\".

`aac_is`{.sample}

:   Sets intensity stereo coding tool usage. By default, it's enabled
    and will automatically toggle IS for similar pairs of stereo bands
    if it's beneficial. Can be disabled for debugging by setting the
    value to \"disable\".

`aac_pns`{.sample}

:   Uses perceptual noise substitution to replace low entropy high
    frequency bands with imperceptible white noise during the decoding
    process. By default, it's enabled, but can be disabled for debugging
    purposes by using \"disable\".

`aac_tns`{.sample}

:   Enables the use of a multitap FIR filter which spans through the
    high frequency bands to hide quantization noise during the encoding
    process and is reverted by the decoder. As well as decreasing
    unpleasant artifacts in the high range this also reduces the entropy
    in the high bands and allows for more bits to be used by the mid-low
    bands. By default it's enabled but can be disabled for debugging by
    setting the option to \"disable\".

`aac_ltp`{.sample}

:   Enables the use of the long term prediction extension which
    increases coding efficiency in very low bandwidth situations such as
    encoding of voice or solo piano music by extending constant harmonic
    peaks in bands throughout frames. This option is implied by
    profile:a aac_low. Use in conjunction with `-ar`{.sample} to
    decrease the samplerate.

`profile`{.sample}

:   Sets the encoding profile, possible values:

    '`aac_low`{.sample}'

    :   The default, AAC \"Low-complexity\" profile. Is the most
        compatible and produces decent quality.

    '`mpeg2_aac_low`{.sample}'

    :   Equivalent to `-profile:a aac_low -aac_pns 0`. PNS was
        introduced with the MPEG4 specifications.

    '`aac_ltp`{.sample}'

    :   Long term prediction profile, is enabled by and will enable the
        `aac_ltp`{.sample} option. Introduced in MPEG4.

    If this option is unspecified it is set to '`aac_low`{.sample}'.

[]{#ac3-and-ac3_005ffixed}

### [15.2 ac3 and ac3_fixed](#toc-ac3-and-ac3_005ffixed) {#ac3-and-ac3_fixed .section}

AC-3 audio encoders.

These encoders implement part of ATSC A/52:2010 and ETSI TS 102 366.

The `ac3`{.variable} encoder uses floating-point math, while the
`ac3_fixed`{.variable} encoder only uses fixed-point integer math. This
does not mean that one is always faster, just that one or the other may
be better suited to a particular system. The `ac3_fixed`{.variable}
encoder is not the default codec for any of the output formats, so it
must be specified explicitly using the option `-acodec ac3_fixed` in
order to use it.

[]{#AC_002d3-Metadata}

#### [15.2.1 AC-3 Metadata](#toc-AC_002d3-Metadata) {#ac-3-metadata .subsection}

The AC-3 metadata options are used to set parameters that describe the
audio, but in most cases do not affect the audio encoding itself. Some
of the options do directly affect or influence the decoding and playback
of the resulting bitstream, while others are just for informational
purposes. A few of the options will add bits to the output stream that
could otherwise be used for audio data, and will thus affect the quality
of the output. Those will be indicated accordingly with a note in the
option list below.

These parameters are described in detail in several publicly-available
documents.

- [A/52:2010 - Digital Audio Compression (AC-3) (E-AC-3)
  Standard](http://www.atsc.org/cms/standards/a_52-2010.pdf)
- [A/54 - Guide to the Use of the ATSC Digital Television
  Standard](http://www.atsc.org/cms/standards/a_54a_with_corr_1.pdf)
- [Dolby Metadata
  Guide](http://www.dolby.com/uploadedFiles/zz-_Shared_Assets/English_PDFs/Professional/18_Metadata.Guide.pdf)
- [Dolby Digital Professional Encoding
  Guidelines](http://www.dolby.com/uploadedFiles/zz-_Shared_Assets/English_PDFs/Professional/46_DDEncodingGuidelines.pdf)

[]{#Metadata-Control-Options}

#### [15.2.1.1 Metadata Control Options](#toc-Metadata-Control-Options) {#metadata-control-options .subsubsection}

`-per_frame_metadata `{.sample}`boolean`{.variable}

:   Allow Per-Frame Metadata. Specifies if the encoder should check for
    changing metadata for each frame.

    `0`{.sample}

    :   The metadata values set at initialization will be used for every
        frame in the stream. (default)

    `1`{.sample}

    :   Metadata values can be changed before encoding each frame.

[]{#Downmix-Levels}

#### [15.2.1.2 Downmix Levels](#toc-Downmix-Levels) {#downmix-levels .subsubsection}

`-center_mixlev `{.sample}`level`{.variable}

:   Center Mix Level. The amount of gain the decoder should apply to the
    center channel when downmixing to stereo. This field will only be
    written to the bitstream if a center channel is present. The value
    is specified as a scale factor. There are 3 valid values:

    `0.707`{.sample}

    :   Apply -3dB gain

    `0.595`{.sample}

    :   Apply -4.5dB gain (default)

    `0.500`{.sample}

    :   Apply -6dB gain

`-surround_mixlev `{.sample}`level`{.variable}

:   Surround Mix Level. The amount of gain the decoder should apply to
    the surround channel(s) when downmixing to stereo. This field will
    only be written to the bitstream if one or more surround channels
    are present. The value is specified as a scale factor. There are 3
    valid values:

    `0.707`{.sample}

    :   Apply -3dB gain

    `0.500`{.sample}

    :   Apply -6dB gain (default)

    `0.000`{.sample}

    :   Silence Surround Channel(s)

[]{#Audio-Production-Information}

#### [15.2.1.3 Audio Production Information](#toc-Audio-Production-Information) {#audio-production-information .subsubsection}

Audio Production Information is optional information describing the
mixing environment. Either none or both of the fields are written to the
bitstream.

`-mixing_level `{.sample}`number`{.variable}

:   Mixing Level. Specifies peak sound pressure level (SPL) in the
    production environment when the mix was mastered. Valid values are
    80 to 111, or -1 for unknown or not indicated. The default value is
    -1, but that value cannot be used if the Audio Production
    Information is written to the bitstream. Therefore, if the
    `room_type` option is not the default value, the `mixing_level`
    option must not be -1.

`-room_type `{.sample}`type`{.variable}

:   Room Type. Describes the equalization used during the final mixing
    session at the studio or on the dubbing stage. A large room is a
    dubbing stage with the industry standard X-curve equalization; a
    small room has flat equalization. This field will not be written to
    the bitstream if both the `mixing_level` option and the `room_type`
    option have the default values.

    `0`{.sample}\
    `notindicated`{.sample}

    :   Not Indicated (default)

    `1`{.sample}\
    `large`{.sample}

    :   Large Room

    `2`{.sample}\
    `small`{.sample}

    :   Small Room

[]{#Other-Metadata-Options}

#### [15.2.1.4 Other Metadata Options](#toc-Other-Metadata-Options) {#other-metadata-options .subsubsection}

`-copyright `{.sample}`boolean`{.variable}

:   Copyright Indicator. Specifies whether a copyright exists for this
    audio.

    `0`{.sample}\
    `off`{.sample}

    :   No Copyright Exists (default)

    `1`{.sample}\
    `on`{.sample}

    :   Copyright Exists

`-dialnorm `{.sample}`value`{.variable}

:   Dialogue Normalization. Indicates how far the average dialogue level
    of the program is below digital 100% full scale (0 dBFS). This
    parameter determines a level shift during audio reproduction that
    sets the average volume of the dialogue to a preset level. The goal
    is to match volume level between program sources. A value of -31dB
    will result in no volume level change, relative to the source
    volume, during audio reproduction. Valid values are whole numbers in
    the range -31 to -1, with -31 being the default.

`-dsur_mode `{.sample}`mode`{.variable}

:   Dolby Surround Mode. Specifies whether the stereo signal uses Dolby
    Surround (Pro Logic). This field will only be written to the
    bitstream if the audio stream is stereo. Using this option does
    **NOT** mean the encoder will actually apply Dolby Surround
    processing.

    `0`{.sample}\
    `notindicated`{.sample}

    :   Not Indicated (default)

    `1`{.sample}\
    `off`{.sample}

    :   Not Dolby Surround Encoded

    `2`{.sample}\
    `on`{.sample}

    :   Dolby Surround Encoded

`-original `{.sample}`boolean`{.variable}

:   Original Bit Stream Indicator. Specifies whether this audio is from
    the original source and not a copy.

    `0`{.sample}\
    `off`{.sample}

    :   Not Original Source

    `1`{.sample}\
    `on`{.sample}

    :   Original Source (default)

[]{#Extended-Bitstream-Information}

#### [15.2.2 Extended Bitstream Information](#toc-Extended-Bitstream-Information) {#extended-bitstream-information .subsection}

The extended bitstream options are part of the Alternate Bit Stream
Syntax as specified in Annex D of the A/52:2010 standard. It is grouped
into 2 parts. If any one parameter in a group is specified, all values
in that group will be written to the bitstream. Default values are used
for those that are written but have not been specified. If the mixing
levels are written, the decoder will use these values instead of the
ones specified in the `center_mixlev` and `surround_mixlev` options if
it supports the Alternate Bit Stream Syntax.

[]{#Extended-Bitstream-Information-_002d-Part-1}

#### [15.2.2.1 Extended Bitstream Information - Part 1](#toc-Extended-Bitstream-Information-_002d-Part-1) {#extended-bitstream-information---part-1 .subsubsection}

`-dmix_mode `{.sample}`mode`{.variable}

:   Preferred Stereo Downmix Mode. Allows the user to select either
    Lt/Rt (Dolby Surround) or Lo/Ro (normal stereo) as the preferred
    stereo downmix mode.

    `0`{.sample}\
    `notindicated`{.sample}

    :   Not Indicated (default)

    `1`{.sample}\
    `ltrt`{.sample}

    :   Lt/Rt Downmix Preferred

    `2`{.sample}\
    `loro`{.sample}

    :   Lo/Ro Downmix Preferred

`-ltrt_cmixlev `{.sample}`level`{.variable}

:   Lt/Rt Center Mix Level. The amount of gain the decoder should apply
    to the center channel when downmixing to stereo in Lt/Rt mode.

    `1.414`{.sample}

    :   Apply +3dB gain

    `1.189`{.sample}

    :   Apply +1.5dB gain

    `1.000`{.sample}

    :   Apply 0dB gain

    `0.841`{.sample}

    :   Apply -1.5dB gain

    `0.707`{.sample}

    :   Apply -3.0dB gain

    `0.595`{.sample}

    :   Apply -4.5dB gain (default)

    `0.500`{.sample}

    :   Apply -6.0dB gain

    `0.000`{.sample}

    :   Silence Center Channel

`-ltrt_surmixlev `{.sample}`level`{.variable}

:   Lt/Rt Surround Mix Level. The amount of gain the decoder should
    apply to the surround channel(s) when downmixing to stereo in Lt/Rt
    mode.

    `0.841`{.sample}

    :   Apply -1.5dB gain

    `0.707`{.sample}

    :   Apply -3.0dB gain

    `0.595`{.sample}

    :   Apply -4.5dB gain

    `0.500`{.sample}

    :   Apply -6.0dB gain (default)

    `0.000`{.sample}

    :   Silence Surround Channel(s)

`-loro_cmixlev `{.sample}`level`{.variable}

:   Lo/Ro Center Mix Level. The amount of gain the decoder should apply
    to the center channel when downmixing to stereo in Lo/Ro mode.

    `1.414`{.sample}

    :   Apply +3dB gain

    `1.189`{.sample}

    :   Apply +1.5dB gain

    `1.000`{.sample}

    :   Apply 0dB gain

    `0.841`{.sample}

    :   Apply -1.5dB gain

    `0.707`{.sample}

    :   Apply -3.0dB gain

    `0.595`{.sample}

    :   Apply -4.5dB gain (default)

    `0.500`{.sample}

    :   Apply -6.0dB gain

    `0.000`{.sample}

    :   Silence Center Channel

`-loro_surmixlev `{.sample}`level`{.variable}

:   Lo/Ro Surround Mix Level. The amount of gain the decoder should
    apply to the surround channel(s) when downmixing to stereo in Lo/Ro
    mode.

    `0.841`{.sample}

    :   Apply -1.5dB gain

    `0.707`{.sample}

    :   Apply -3.0dB gain

    `0.595`{.sample}

    :   Apply -4.5dB gain

    `0.500`{.sample}

    :   Apply -6.0dB gain (default)

    `0.000`{.sample}

    :   Silence Surround Channel(s)

[]{#Extended-Bitstream-Information-_002d-Part-2}

#### [15.2.2.2 Extended Bitstream Information - Part 2](#toc-Extended-Bitstream-Information-_002d-Part-2) {#extended-bitstream-information---part-2 .subsubsection}

`-dsurex_mode `{.sample}`mode`{.variable}

:   Dolby Surround EX Mode. Indicates whether the stream uses Dolby
    Surround EX (7.1 matrixed to 5.1). Using this option does **NOT**
    mean the encoder will actually apply Dolby Surround EX processing.

    `0`{.sample}\
    `notindicated`{.sample}

    :   Not Indicated (default)

    `1`{.sample}\
    `on`{.sample}

    :   Dolby Surround EX Off

    `2`{.sample}\
    `off`{.sample}

    :   Dolby Surround EX On

`-dheadphone_mode `{.sample}`mode`{.variable}

:   Dolby Headphone Mode. Indicates whether the stream uses Dolby
    Headphone encoding (multi-channel matrixed to 2.0 for use with
    headphones). Using this option does **NOT** mean the encoder will
    actually apply Dolby Headphone processing.

    `0`{.sample}\
    `notindicated`{.sample}

    :   Not Indicated (default)

    `1`{.sample}\
    `on`{.sample}

    :   Dolby Headphone Off

    `2`{.sample}\
    `off`{.sample}

    :   Dolby Headphone On

`-ad_conv_type `{.sample}`type`{.variable}

:   A/D Converter Type. Indicates whether the audio has passed through
    HDCD A/D conversion.

    `0`{.sample}\
    `standard`{.sample}

    :   Standard A/D Converter (default)

    `1`{.sample}\
    `hdcd`{.sample}

    :   HDCD A/D Converter

[]{#Other-AC_002d3-Encoding-Options}

#### [15.2.3 Other AC-3 Encoding Options](#toc-Other-AC_002d3-Encoding-Options) {#other-ac-3-encoding-options .subsection}

`-stereo_rematrixing `{.sample}`boolean`{.variable}

:   Stereo Rematrixing. Enables/Disables use of rematrixing for stereo
    input. This is an optional AC-3 feature that increases quality by
    selectively encoding the left/right channels as mid/side. This
    option is enabled by default, and it is highly recommended that it
    be left as enabled except for testing purposes.

`cutoff `{.sample}`frequency`{.variable}

:   Set lowpass cutoff frequency. If unspecified, the encoder selects a
    default determined by various other encoding parameters.

[]{#Floating_002dPoint_002dOnly-AC_002d3-Encoding-Options}

#### [15.2.4 Floating-Point-Only AC-3 Encoding Options](#toc-Floating_002dPoint_002dOnly-AC_002d3-Encoding-Options) {#floating-point-only-ac-3-encoding-options .subsection}

These options are only valid for the floating-point encoder and do not
exist for the fixed-point encoder due to the corresponding features not
being implemented in fixed-point.

`-channel_coupling `{.sample}`boolean`{.variable}

:   Enables/Disables use of channel coupling, which is an optional AC-3
    feature that increases quality by combining high frequency
    information from multiple channels into a single channel. The
    per-channel high frequency information is sent with less accuracy in
    both the frequency and time domains. This allows more bits to be
    used for lower frequencies while preserving enough information to
    reconstruct the high frequencies. This option is enabled by default
    for the floating-point encoder and should generally be left as
    enabled except for testing purposes or to increase encoding speed.

    `-1`{.sample}\
    `auto`{.sample}

    :   Selected by Encoder (default)

    `0`{.sample}\
    `off`{.sample}

    :   Disable Channel Coupling

    `1`{.sample}\
    `on`{.sample}

    :   Enable Channel Coupling

`-cpl_start_band `{.sample}`number`{.variable}

:   Coupling Start Band. Sets the channel coupling start band, from 1
    to 15. If a value higher than the bandwidth is used, it will be
    reduced to 1 less than the coupling end band. If `auto`{.variable}
    is used, the start band will be determined by the encoder based on
    the bit rate, sample rate, and channel layout. This option has no
    effect if channel coupling is disabled.

    `-1`{.sample}\
    `auto`{.sample}

    :   Selected by Encoder (default)

[]{#flac}[]{#flac-2}

### [15.3 flac](#toc-flac-2) {#flac-1 .section}

FLAC (Free Lossless Audio Codec) Encoder

[]{#Options-13}

#### [15.3.1 Options](#toc-Options-13) {#options-13 .subsection}

The following options are supported by FFmpeg's flac encoder.

`compression_level`{.sample}

Sets the compression level, which chooses defaults for many other
options if they are not set explicitly. Valid values are from 0 to 12, 5
is the default.

`frame_size`{.sample}

Sets the size of the frames in samples per channel.

`lpc_coeff_precision`{.sample}

Sets the LPC coefficient precision, valid values are from 1 to 15, 15 is
the default.

`lpc_type`{.sample}

Sets the first stage LPC algorithm

'`none`{.sample}'

LPC is not used

'`fixed`{.sample}'

fixed LPC coefficients

'`levinson`{.sample}'

'`cholesky`{.sample}'

`lpc_passes`{.sample}

Number of passes to use for Cholesky factorization during LPC analysis

`min_partition_order`{.sample}

The minimum partition order

`max_partition_order`{.sample}

The maximum partition order

`prediction_order_method`{.sample}

'`estimation`{.sample}'

'`2level`{.sample}'

'`4level`{.sample}'

'`8level`{.sample}'

'`search`{.sample}'

Bruteforce search

'`log`{.sample}'

`ch_mode`{.sample}

Channel mode

'`auto`{.sample}'

The mode is chosen automatically for each frame

'`indep`{.sample}'

Channels are independently coded

'`left_side`{.sample}'

'`right_side`{.sample}'

'`mid_side`{.sample}'

`exact_rice_parameters`{.sample}

Chooses if rice parameters are calculated exactly or approximately. if
set to 1 then they are chosen exactly, which slows the code down
slightly and improves compression slightly.

`multi_dim_quant`{.sample}

Multi Dimensional Quantization. If set to 1 then a 2nd stage LPC
algorithm is applied after the first stage to finetune the coefficients.
This is quite slow and slightly improves compression.

[]{#opusenc}[]{#opus}

### [15.4 opus](#toc-opus) {#opus .section}

Opus encoder.

This is a native FFmpeg encoder for the Opus format. Currently, it's in
development and only implements the CELT part of the codec. Its quality
is usually worse and at best is equal to the libopus encoder.

[]{#Options-14}

#### [15.4.1 Options](#toc-Options-14) {#options-14 .subsection}

`b`{.sample}

:   Set bit rate in bits/s. If unspecified it uses the number of
    channels and the layout to make a good guess.

`opus_delay`{.sample}

:   Sets the maximum delay in milliseconds. Lower delays than 20ms will
    very quickly decrease quality.

[]{#libfdk_002daac_002denc}[]{#libfdk_005faac}

### [15.5 libfdk_aac](#toc-libfdk_005faac) {#libfdk_aac .section}

libfdk-aac AAC (Advanced Audio Coding) encoder wrapper.

The libfdk-aac library is based on the Fraunhofer FDK AAC code from the
Android project.

Requires the presence of the libfdk-aac headers and library during
configuration. You need to explicitly configure the build with
`--enable-libfdk-aac`. The library is also incompatible with GPL, so if
you allow the use of GPL, you should configure with
`--enable-gpl --enable-nonfree --enable-libfdk-aac`.

This encoder has support for the AAC-HE profiles.

VBR encoding, enabled through the `vbr`{.sample} or
`flags +qscale`{.sample} options, is experimental and only works with
some combinations of parameters.

Support for encoding 7.1 audio is only available with libfdk-aac 0.1.3
or higher.

For more information see the fdk-aac project at
<http://sourceforge.net/p/opencore-amr/fdk-aac/>.

[]{#Options-15}

#### [15.5.1 Options](#toc-Options-15) {#options-15 .subsection}

The following options are mapped on the shared FFmpeg codec options.

`b`{.sample}

:   Set bit rate in bits/s. If the bitrate is not explicitly specified,
    it is automatically set to a suitable value depending on the
    selected profile.

    In case VBR mode is enabled the option is ignored.

`ar`{.sample}

:   Set audio sampling rate (in Hz).

`channels`{.sample}

:   Set the number of audio channels.

`flags +qscale`{.sample}

:   Enable fixed quality, VBR (Variable Bit Rate) mode. Note that VBR is
    implicitly enabled when the `vbr`{.sample} value is positive.

`cutoff`{.sample}

:   Set cutoff frequency. If not specified (or explicitly set to 0) it
    will use a value automatically computed by the library. Default
    value is 0.

`profile`{.sample}

:   Set audio profile.

    The following profiles are recognized:

    '`aac_low`{.sample}'

    :   Low Complexity AAC (LC)

    '`aac_he`{.sample}'

    :   High Efficiency AAC (HE-AAC)

    '`aac_he_v2`{.sample}'

    :   High Efficiency AAC version 2 (HE-AACv2)

    '`aac_ld`{.sample}'

    :   Low Delay AAC (LD)

    '`aac_eld`{.sample}'

    :   Enhanced Low Delay AAC (ELD)

    If not specified it is set to '`aac_low`{.sample}'.

The following are private options of the libfdk_aac encoder.

`afterburner`{.sample}

:   Enable afterburner feature if set to 1, disabled if set to 0. This
    improves the quality but also the required processing power.

    Default value is 1.

`eld_sbr`{.sample}

:   Enable SBR (Spectral Band Replication) for ELD if set to 1, disabled
    if set to 0.

    Default value is 0.

`eld_v2`{.sample}

:   Enable ELDv2 (LD-MPS extension for ELD stereo signals) for ELDv2 if
    set to 1, disabled if set to 0.

    Note that option is available when fdk-aac version
    (AACENCODER_LIB_VL0.AACENCODER_LIB_VL1.AACENCODER_LIB_VL2) \>
    (4.0.0).

    Default value is 0.

`signaling`{.sample}

:   Set SBR/PS signaling style.

    It can assume one of the following values:

    '`default`{.sample}'

    :   choose signaling implicitly (explicit hierarchical by default,
        implicit if global header is disabled)

    '`implicit`{.sample}'

    :   implicit backwards compatible signaling

    '`explicit_sbr`{.sample}'

    :   explicit SBR, implicit PS signaling

    '`explicit_hierarchical`{.sample}'

    :   explicit hierarchical signaling

    Default value is '`default`{.sample}'.

`latm`{.sample}

:   Output LATM/LOAS encapsulated data if set to 1, disabled if set to
    0.

    Default value is 0.

`header_period`{.sample}

:   Set StreamMuxConfig and PCE repetition period (in frames) for
    sending in-band configuration buffers within LATM/LOAS transport
    layer.

    Must be a 16-bits non-negative integer.

    Default value is 0.

`vbr`{.sample}

:   Set VBR mode, from 1 to 5. 1 is lowest quality (though still pretty
    good) and 5 is highest quality. A value of 0 will disable VBR, and
    CBR (Constant Bit Rate) is enabled.

    Currently only the '`aac_low`{.sample}' profile supports VBR
    encoding.

    VBR modes 1-5 correspond to roughly the following average bit rates:

    '`1`{.sample}'

    :   32 kbps/channel

    '`2`{.sample}'

    :   40 kbps/channel

    '`3`{.sample}'

    :   48-56 kbps/channel

    '`4`{.sample}'

    :   64 kbps/channel

    '`5`{.sample}'

    :   about 80-96 kbps/channel

    Default value is 0.

`frame_length`{.sample}

:   Set the audio frame length in samples. Default value is the internal
    default of the library. Refer to the library's documentation for
    information about supported values.

[]{#Examples-4}

#### [15.5.2 Examples](#toc-Examples-4) {#examples-4 .subsection}

- Use `ffmpeg` to convert an audio file to VBR AAC in an M4A (MP4)
  container:

  ::: example
  ``` example
  ffmpeg -i input.wav -codec:a libfdk_aac -vbr 3 output.m4a
  ```
  :::
- Use `ffmpeg` to convert an audio file to CBR 64k kbps AAC, using the
  High-Efficiency AAC profile:

  ::: example
  ``` example
  ffmpeg -i input.wav -c:a libfdk_aac -profile:a aac_he -b:a 64k output.m4a
  ```
  :::

[]{#liblc3_002denc}[]{#liblc3}

### [15.6 liblc3](#toc-liblc3) {#liblc3 .section}

liblc3 LC3 (Low Complexity Communication Codec) encoder wrapper.

Requires the presence of the liblc3 headers and library during
configuration. You need to explicitly configure the build with
`--enable-liblc3`.

This encoder has support for the Bluetooth SIG LC3 codec for the LE
Audio protocol, and the following features of LC3plus:

- Frame duration of 2.5 and 5ms.
- High-Resolution mode, 48 KHz, and 96 kHz sampling rates.

For more information see the liblc3 project at
<https://github.com/google/liblc3>.

[]{#Options-16}

#### [15.6.1 Options](#toc-Options-16) {#options-16 .subsection}

The following options are mapped on the shared FFmpeg codec options.

`b `{.sample}`bitrate`{.variable}

:   Set the bit rate in bits/s. This will determine the fixed size of
    the encoded frames, for a selected frame duration.

`ar `{.sample}`frequency`{.variable}

:   Set the audio sampling rate (in Hz).

`channels`{.sample}

:   Set the number of audio channels.

`frame_duration`{.sample}

:   Set the audio frame duration in milliseconds. Default value is 10ms.
    Allowed frame durations are 2.5ms, 5ms, 7.5ms and 10ms. LC3
    (Bluetooth LE Audio), allows 7.5ms and 10ms; and LC3plus 2.5ms, 5ms
    and 10ms.

    The 10ms frame duration is available in LC3 and LC3 plus standard.
    In this mode, the produced bitstream can be referenced either as LC3
    or LC3plus.

`high_resolution `{.sample}`boolean`{.variable}

:   Enable the high-resolution mode if set to 1. The high-resolution
    mode is available with all LC3plus frame durations and for a
    sampling rate of 48 KHz, and 96 KHz.

    The encoder automatically turns off this mode at lower sampling
    rates and activates it at 96 KHz.

    This mode should be preferred at high bitrates. In this mode, the
    audio bandwidth is always up to the Nyquist frequency, compared to
    LC3 at 48 KHz, which limits the bandwidth to 20 KHz.

[]{#libmp3lame}[]{#libmp3lame-1}

### [15.7 libmp3lame](#toc-libmp3lame-1) {#libmp3lame .section}

LAME (Lame Ain't an MP3 Encoder) MP3 encoder wrapper.

Requires the presence of the libmp3lame headers and library during
configuration. You need to explicitly configure the build with
`--enable-libmp3lame`.

See [libshine](#libshine) for a fixed-point MP3 encoder, although with a
lower quality.

[]{#Options-17}

#### [15.7.1 Options](#toc-Options-17) {#options-17 .subsection}

The following options are supported by the libmp3lame wrapper. The
`lame`-equivalent of the options are listed in parentheses.

`b (`{.sample}*`-b`{.sample}*`)`{.sample}

:   Set bitrate expressed in bits/s for CBR or ABR. LAME `bitrate` is
    expressed in kilobits/s.

`q (`{.sample}*`-V`{.sample}*`)`{.sample}

:   Set constant quality setting for VBR. This option is valid only
    using the `ffmpeg` command-line tool. For library interface users,
    use `global_quality`{.sample}.

`compression_level (`{.sample}*`-q`{.sample}*`)`{.sample}

:   Set algorithm quality. Valid arguments are integers in the 0-9
    range, with 0 meaning highest quality but slowest, and 9 meaning
    fastest while producing the worst quality.

`cutoff (`{.sample}*`--lowpass`{.sample}*`)`{.sample}

:   Set lowpass cutoff frequency. If unspecified, the encoder
    dynamically adjusts the cutoff.

`reservoir`{.sample}

:   Enable use of bit reservoir when set to 1. Default value is 1. LAME
    has this enabled by default, but can be overridden by use
    `--nores`{.sample} option.

`joint_stereo (`{.sample}*`-m j`{.sample}*`)`{.sample}

:   Enable the encoder to use (on a frame by frame basis) either L/R
    stereo or mid/side stereo. Default value is 1.

`abr (`{.sample}*`--abr`{.sample}*`)`{.sample}

:   Enable the encoder to use ABR when set to 1. The `lame`
    `--abr`{.sample} sets the target bitrate, while this options only
    tells FFmpeg to use ABR still relies on `b`{.sample} to set bitrate.

`copyright (`{.sample}*`-c`{.sample}*`)`{.sample}

:   Set MPEG audio copyright flag when set to 1. The default value is 0
    (disabled).

`original (`{.sample}*`-o`{.sample}*`)`{.sample}

:   Set MPEG audio original flag when set to 1. The default value is 1
    (enabled).

[]{#libopencore_002damrnb-1}

### [15.8 libopencore-amrnb](#toc-libopencore_002damrnb-1) {#libopencore-amrnb-1 .section}

OpenCORE Adaptive Multi-Rate Narrowband encoder.

Requires the presence of the libopencore-amrnb headers and library
during configuration. You need to explicitly configure the build with
`--enable-libopencore-amrnb --enable-version3`.

This is a mono-only encoder. Officially it only supports 8000Hz sample
rate, but you can override it by setting `strict`{.sample} to
'`unofficial`{.sample}' or lower.

[]{#Options-18}

#### [15.8.1 Options](#toc-Options-18) {#options-18 .subsection}

`b`{.sample}

Set bitrate in bits per second. Only the following bitrates are
supported, otherwise libavcodec will round to the nearest valid bitrate.

`4750`{.sample}

`5150`{.sample}

`5900`{.sample}

`6700`{.sample}

`7400`{.sample}

`7950`{.sample}

`10200`{.sample}

`12200`{.sample}

`dtx`{.sample}

Allow discontinuous transmission (generate comfort noise) when set to 1.
The default value is 0 (disabled).

[]{#libopus-1}

### [15.9 libopus](#toc-libopus-1) {#libopus-1 .section}

libopus Opus Interactive Audio Codec encoder wrapper.

Requires the presence of the libopus headers and library during
configuration. You need to explicitly configure the build with
`--enable-libopus`.

[]{#Option-Mapping}

#### [15.9.1 Option Mapping](#toc-Option-Mapping) {#option-mapping .subsection}

Most libopus options are modelled after the `opusenc` utility from
opus-tools. The following is an option mapping chart describing options
supported by the libopus wrapper, and their `opusenc`-equivalent in
parentheses.

`b (`{.sample}*`bitrate`{.sample}*`)`{.sample}

:   Set the bit rate in bits/s. FFmpeg's `b`{.sample} option is
    expressed in bits/s, while `opusenc`'s `bitrate`{.sample} in
    kilobits/s.

`vbr (`{.sample}*`vbr`{.sample}*`, `{.sample}*`hard-cbr`{.sample}*`, and `{.sample}*`cvbr`{.sample}*`)`{.sample}

:   Set VBR mode. The FFmpeg `vbr`{.sample} option has the following
    valid arguments, with the `opusenc` equivalent options in
    parentheses:

    '`off (`{.sample}*`hard-cbr`{.sample}*`)`{.sample}'

    :   Use constant bit rate encoding.

    '`on (`{.sample}*`vbr`{.sample}*`)`{.sample}'

    :   Use variable bit rate encoding (the default).

    '`constrained (`{.sample}*`cvbr`{.sample}*`)`{.sample}'

    :   Use constrained variable bit rate encoding.

`compression_level (`{.sample}*`comp`{.sample}*`)`{.sample}

:   Set encoding algorithm complexity. Valid options are integers in the
    0-10 range. 0 gives the fastest encodes but lower quality, while 10
    gives the highest quality but slowest encoding. The default is 10.

`frame_duration (`{.sample}*`framesize`{.sample}*`)`{.sample}

:   Set maximum frame size, or duration of a frame in milliseconds. The
    argument must be exactly the following: 2.5, 5, 10, 20, 40, 60.
    Smaller frame sizes achieve lower latency but less quality at a
    given bitrate. Sizes greater than 20ms are only interesting at
    fairly low bitrates. The default is 20ms.

`packet_loss (`{.sample}*`expect-loss`{.sample}*`)`{.sample}

:   Set expected packet loss percentage. The default is 0.

`fec (`{.sample}*`n/a`{.sample}*`)`{.sample}

:   Enable inband forward error correction. `packet_loss`{.sample} must
    be non-zero to take advantage - frequency of FEC 'side-data' is
    proportional to expected packet loss. Default is disabled.

`application (N.A.)`{.sample}

:   Set intended application type. Valid options are listed below:

    '`voip`{.sample}'

    :   Favor improved speech intelligibility.

    '`audio`{.sample}'

    :   Favor faithfulness to the input (the default).

    '`lowdelay`{.sample}'

    :   Restrict to only the lowest delay modes by disabling
        voice-optimized modes.

`cutoff (N.A.)`{.sample}

:   Set cutoff bandwidth in Hz. The argument must be exactly one of the
    following: 4000, 6000, 8000, 12000, or 20000, corresponding to
    narrowband, mediumband, wideband, super wideband, and fullband
    respectively. The default is 0 (cutoff disabled). Note that libopus
    forces a wideband cutoff for bitrates \< 15 kbps, unless CELT-only
    (`application`{.sample} set to '`lowdelay`{.sample}') mode is used.

`mapping_family (`{.sample}*`mapping_family`{.sample}*`)`{.sample}

:   Set channel mapping family to be used by the encoder. The default
    value of -1 uses mapping family 0 for mono and stereo inputs, and
    mapping family 1 otherwise. The default also disables the surround
    masking and LFE bandwidth optimizations in libopus, and requires
    that the input contains 8 channels or fewer.

    Other values include 0 for mono and stereo, 1 for surround sound
    with masking and LFE bandwidth optimizations, and 255 for
    independent streams with an unspecified channel layout.

`apply_phase_inv (N.A.) (requires libopus >= 1.2)`{.sample}

:   If set to 0, disables the use of phase inversion for intensity
    stereo, improving the quality of mono downmixes, but slightly
    reducing normal stereo quality. The default is 1 (phase inversion
    enabled).

[]{#libshine}[]{#libshine-1}

### [15.10 libshine](#toc-libshine-1) {#libshine .section}

Shine Fixed-Point MP3 encoder wrapper.

Shine is a fixed-point MP3 encoder. It has a far better performance on
platforms without an FPU, e.g. armel CPUs, and some phones and tablets.
However, as it is more targeted on performance than quality, it is not
on par with LAME and other production-grade encoders quality-wise. Also,
according to the project's homepage, this encoder may not be free of
bugs as the code was written a long time ago and the project was dead
for at least 5 years.

This encoder only supports stereo and mono input. This is also CBR-only.

The original project (last updated in early 2007) is at
<http://sourceforge.net/projects/libshine-fxp/>. We only support the
updated fork by the Savonet/Liquidsoap project at
<https://github.com/savonet/shine>.

Requires the presence of the libshine headers and library during
configuration. You need to explicitly configure the build with
`--enable-libshine`.

See also [libmp3lame](#libmp3lame).

[]{#Options-19}

#### [15.10.1 Options](#toc-Options-19) {#options-19 .subsection}

The following options are supported by the libshine wrapper. The
`shineenc`-equivalent of the options are listed in parentheses.

`b (`{.sample}*`-b`{.sample}*`)`{.sample}

:   Set bitrate expressed in bits/s for CBR. `shineenc` `-b`{.sample}
    option is expressed in kilobits/s.

[]{#libtwolame}

### [15.11 libtwolame](#toc-libtwolame) {#libtwolame .section}

TwoLAME MP2 encoder wrapper.

Requires the presence of the libtwolame headers and library during
configuration. You need to explicitly configure the build with
`--enable-libtwolame`.

[]{#Options-20}

#### [15.11.1 Options](#toc-Options-20) {#options-20 .subsection}

The following options are supported by the libtwolame wrapper. The
`twolame`-equivalent options follow the FFmpeg ones and are in
parentheses.

`b (`{.sample}*`-b`{.sample}*`)`{.sample}

:   Set bitrate expressed in bits/s for CBR. `twolame` `b`{.sample}
    option is expressed in kilobits/s. Default value is 128k.

`q (`{.sample}*`-V`{.sample}*`)`{.sample}

:   Set quality for experimental VBR support. Maximum value range is
    from -50 to 50, useful range is from -10 to 10. The higher the
    value, the better the quality. This option is valid only using the
    `ffmpeg` command-line tool. For library interface users, use
    `global_quality`{.sample}.

`mode (`{.sample}*`--mode`{.sample}*`)`{.sample}

:   Set the mode of the resulting audio. Possible values:

    '`auto`{.sample}'

    :   Choose mode automatically based on the input. This is the
        default.

    '`stereo`{.sample}'

    :   Stereo

    '`joint_stereo`{.sample}'

    :   Joint stereo

    '`dual_channel`{.sample}'

    :   Dual channel

    '`mono`{.sample}'

    :   Mono

`psymodel (`{.sample}*`--psyc-mode`{.sample}*`)`{.sample}

:   Set psychoacoustic model to use in encoding. The argument must be an
    integer between -1 and 4, inclusive. The higher the value, the
    better the quality. The default value is 3.

`energy_levels (`{.sample}*`--energy`{.sample}*`)`{.sample}

:   Enable energy levels extensions when set to 1. The default value is
    0 (disabled).

`error_protection (`{.sample}*`--protect`{.sample}*`)`{.sample}

:   Enable CRC error protection when set to 1. The default value is 0
    (disabled).

`copyright (`{.sample}*`--copyright`{.sample}*`)`{.sample}

:   Set MPEG audio copyright flag when set to 1. The default value is 0
    (disabled).

`original (`{.sample}*`--original`{.sample}*`)`{.sample}

:   Set MPEG audio original flag when set to 1. The default value is 0
    (disabled).

[]{#libvo_002damrwbenc}

### [15.12 libvo-amrwbenc](#toc-libvo_002damrwbenc) {#libvo-amrwbenc .section}

VisualOn Adaptive Multi-Rate Wideband encoder.

Requires the presence of the libvo-amrwbenc headers and library during
configuration. You need to explicitly configure the build with
`--enable-libvo-amrwbenc --enable-version3`.

This is a mono-only encoder. Officially it only supports 16000Hz sample
rate, but you can override it by setting `strict`{.sample} to
'`unofficial`{.sample}' or lower.

[]{#Options-21}

#### [15.12.1 Options](#toc-Options-21) {#options-21 .subsection}

`b`{.sample}

Set bitrate in bits/s. Only the following bitrates are supported,
otherwise libavcodec will round to the nearest valid bitrate.

'`6600`{.sample}'

'`8850`{.sample}'

'`12650`{.sample}'

'`14250`{.sample}'

'`15850`{.sample}'

'`18250`{.sample}'

'`19850`{.sample}'

'`23050`{.sample}'

'`23850`{.sample}'

`dtx`{.sample}

Allow discontinuous transmission (generate comfort noise) when set to 1.
The default value is 0 (disabled).

[]{#libvorbis}

### [15.13 libvorbis](#toc-libvorbis) {#libvorbis .section}

libvorbis encoder wrapper.

Requires the presence of the libvorbisenc headers and library during
configuration. You need to explicitly configure the build with
`--enable-libvorbis`.

[]{#Options-22}

#### [15.13.1 Options](#toc-Options-22) {#options-22 .subsection}

The following options are supported by the libvorbis wrapper. The
`oggenc`-equivalent of the options are listed in parentheses.

To get a more accurate and extensive documentation of the libvorbis
options, consult the libvorbisenc's and `oggenc`'s documentations. See
<http://xiph.org/vorbis/>, <http://wiki.xiph.org/Vorbis-tools>, and
oggenc(1).

`b (`{.sample}*`-b`{.sample}*`)`{.sample}

:   Set bitrate expressed in bits/s for ABR. `oggenc` `-b`{.sample} is
    expressed in kilobits/s.

`q (`{.sample}*`-q`{.sample}*`)`{.sample}

:   Set constant quality setting for VBR. The value should be a float
    number in the range of -1.0 to 10.0. The higher the value, the
    better the quality. The default value is '`3.0`{.sample}'.

    This option is valid only using the `ffmpeg` command-line tool. For
    library interface users, use `global_quality`{.sample}.

`cutoff (`{.sample}*`--advanced-encode-option lowpass_frequency=N`{.sample}*`)`{.sample}

:   Set cutoff bandwidth in Hz, a value of 0 disables cutoff. `oggenc`'s
    related option is expressed in kHz. The default value is
    '`0`{.sample}' (cutoff disabled).

`minrate (`{.sample}*`-m`{.sample}*`)`{.sample}

:   Set minimum bitrate expressed in bits/s. `oggenc` `-m`{.sample} is
    expressed in kilobits/s.

`maxrate (`{.sample}*`-M`{.sample}*`)`{.sample}

:   Set maximum bitrate expressed in bits/s. `oggenc` `-M`{.sample} is
    expressed in kilobits/s. This only has effect on ABR mode.

`iblock (`{.sample}*`--advanced-encode-option impulse_noisetune=N`{.sample}*`)`{.sample}

:   Set noise floor bias for impulse blocks. The value is a float number
    from -15.0 to 0.0. A negative bias instructs the encoder to pay
    special attention to the crispness of transients in the encoded
    audio. The tradeoff for better transient response is a higher
    bitrate.

[]{#mjpegenc}[]{#mjpeg}

### [15.14 mjpeg](#toc-mjpeg) {#mjpeg .section}

Motion JPEG encoder.

[]{#Options-23}

#### [15.14.1 Options](#toc-Options-23) {#options-23 .subsection}

`huffman`{.sample}

:   Set the huffman encoding strategy. Possible values:

    '`default`{.sample}'

    :   Use the default huffman tables. This is the default strategy.

    '`optimal`{.sample}'

    :   Compute and use optimal huffman tables.

[]{#wavpackenc}[]{#wavpack}

### [15.15 wavpack](#toc-wavpack) {#wavpack .section}

WavPack lossless audio encoder.

[]{#Options-24}

#### [15.15.1 Options](#toc-Options-24) {#options-24 .subsection}

The equivalent options for `wavpack` command line utility are listed in
parentheses.

[]{#Shared-options}

#### [15.15.1.1 Shared options](#toc-Shared-options) {#shared-options .subsubsection}

The following shared options are effective for this encoder. Only
special notes about this particular encoder will be documented here. For
the general meaning of the options, see [the Codec Options
chapter](#codec_002doptions).

`frame_size (`{.sample}*`--blocksize`{.sample}*`)`{.sample}

For this encoder, the range for this option is between 128 and 131072.
Default is automatically decided based on sample rate and number of
channel.

For the complete formula of calculating default, see
`libavcodec/wavpackenc.c`{.sample}.

`compression_level (`{.sample}*`-f`{.sample}*`, `{.sample}*`-h`{.sample}*`, `{.sample}*`-hh`{.sample}*`, and `{.sample}*`-x`{.sample}*`)`{.sample}

[]{#Private-options}

#### [15.15.1.2 Private options](#toc-Private-options) {#private-options .subsubsection}

`joint_stereo (`{.sample}*`-j`{.sample}*`)`{.sample}

:   Set whether to enable joint stereo. Valid values are:

    '`on (`{.sample}*`1`{.sample}*`)`{.sample}'

    :   Force mid/side audio encoding.

    '`off (`{.sample}*`0`{.sample}*`)`{.sample}'

    :   Force left/right audio encoding.

    '`auto`{.sample}'

    :   Let the encoder decide automatically.

`optimize_mono`{.sample}

:   Set whether to enable optimization for mono. This option is only
    effective for non-mono streams. Available values:

    '`on`{.sample}'

    :   enabled

    '`off`{.sample}'

    :   disabled

[]{#Video-Encoders}

## [16 Video Encoders](#toc-Video-Encoders) {#video-encoders .chapter}

A description of some of the currently available video encoders follows.

[]{#a64_005fmulti_002c-a64_005fmulti5}

### [16.1 a64_multi, a64_multi5](#toc-a64_005fmulti_002c-a64_005fmulti5) {#a64_multi-a64_multi5 .section}

A64 / Commodore 64 multicolor charset encoder. `a64_multi5` is extended
with 5th color (colram).

[]{#Cinepak}

### [16.2 Cinepak](#toc-Cinepak) {#cinepak .section}

Cinepak aka CVID encoder. Compatible with Windows 3.1 and vintage MacOS.

[]{#Options-25}

#### [16.2.1 Options](#toc-Options-25) {#options-25 .subsection}

`g `{.sample}`integer`{.variable}

Keyframe interval. A keyframe is inserted at least every `-g` frames,
sometimes sooner.

`q:v `{.sample}`integer`{.variable}

Quality factor. Lower is better. Higher gives lower bitrate. The
following table lists bitrates when encoding akiyo_cif.y4m for various
values of `-q:v` with `-g 100`:

`-q:v 1`` 1918 kb/s`{.sample}

`-q:v 2`` 1735 kb/s`{.sample}

`-q:v 4`` 1500 kb/s`{.sample}

`-q:v 10`` 1041 kb/s`{.sample}

`-q:v 20`` 826 kb/s`{.sample}

`-q:v 40`` 553 kb/s`{.sample}

`-q:v 100`` 394 kb/s`{.sample}

`-q:v 200`` 312 kb/s`{.sample}

`-q:v 400`` 266 kb/s`{.sample}

`-q:v 1000`` 237 kb/s`{.sample}

`max_extra_cb_iterations `{.sample}`integer`{.variable}

Max extra codebook recalculation passes, more is better and slower.

`skip_empty_cb `{.sample}`boolean`{.variable}

Avoid wasting bytes, ignore vintage MacOS decoder.

`max_strips `{.sample}`integer`{.variable}

`min_strips `{.sample}`integer`{.variable}

The minimum and maximum number of strips to use. Wider range sometimes
improves quality. More strips is generally better quality but costs more
bits. Fewer strips tend to yield more keyframes. Vintage compatible is
1..3.

`strip_number_adaptivity `{.sample}`integer`{.variable}

How much number of strips is allowed to change between frames. Higher is
better but slower.

[]{#ffv1}[]{#ffv1-1}

### [16.3 ffv1](#toc-ffv1-1) {#ffv1 .section}

FFv1 Encoder

[]{#Options-26}

#### [16.3.1 Options](#toc-Options-26) {#options-26 .subsection}

The following options are supported by FFmpeg's FFv1 encoder.

`context`{.sample}

:   Sets the context size, 0 (default) is small, 1 is big.

`coder`{.sample}

:   Set the coder,

    '`rice`{.sample}'

    :   Golomb rice coder

    '`range_def`{.sample}'

    :   Range coder with default table

    '`range_tab`{.sample}'

    :   Range coder with custom table

`slicecrc`{.sample}

:   -1 (default, automatic), 1 use crc with zero initial and final
    state, 2 use crc with non zero initial and final state

`qtable`{.sample}

:   

    '`default`{.sample}'

    :   default, automatic

    '`8bit`{.sample}'

    :   use 8bit default

    '`greater8bit`{.sample}'

    :   use \>8bit default

`remap_optimizer`{.sample}

:   0 - 5, default 3, how much effort the encoder puts into optimizing
    the remap table.

[]{#GIF}

### [16.4 GIF](#toc-GIF) {#gif .section}

GIF image/animation encoder.

[]{#Options-27}

#### [16.4.1 Options](#toc-Options-27) {#options-27 .subsection}

`gifflags `{.sample}`integer`{.variable}

:   Sets the flags used for GIF encoding.

    `offsetting`{.sample}

    :   Enables picture offsetting.

        Default is enabled.

    `transdiff`{.sample}

    :   Enables transparency detection between frames.

        Default is enabled.

`gifimage `{.sample}`integer`{.variable}

:   Enables encoding one full GIF image per frame, rather than an
    animated GIF.

    Default value is `0`{.sample}.

`global_palette `{.sample}`integer`{.variable}

:   Writes a palette to the global GIF header where feasible.

    If disabled, every frame will always have a palette written, even if
    there is a global palette supplied.

    Default value is `1`{.sample}.

[]{#Hap}

### [16.5 Hap](#toc-Hap) {#hap .section}

Vidvox Hap video encoder.

[]{#Options-28}

#### [16.5.1 Options](#toc-Options-28) {#options-28 .subsection}

`format `{.sample}`integer`{.variable}

Specifies the Hap format to encode.

`hap`{.sample}

`hap_alpha`{.sample}

`hap_q`{.sample}

Default value is `hap`{.sample}.

`chunks `{.sample}`integer`{.variable}

Specifies the number of chunks to split frames into, between 1 and 64.
This permits multithreaded decoding of large frames, potentially at the
cost of data-rate. The encoder may modify this value to divide frames
evenly.

Default value is `1`{.variable}.

`compressor `{.sample}`integer`{.variable}

Specifies the second-stage compressor to use. If set to `none`{.sample},
`chunks`{.sample} will be limited to 1, as chunked uncompressed frames
offer no benefit.

`none`{.sample}

`snappy`{.sample}

Default value is `snappy`{.sample}.

[]{#jpeg2000}

### [16.6 jpeg2000](#toc-jpeg2000) {#jpeg2000 .section}

The native jpeg 2000 encoder is lossy by default, the `-q:v` option can
be used to set the encoding quality. Lossless encoding can be selected
with `-pred 1`.

[]{#Options-29}

#### [16.6.1 Options](#toc-Options-29) {#options-29 .subsection}

`format `{.sample}`integer`{.variable}

Can be set to either `j2k` or `jp2` (the default) that makes it possible
to store non-rgb pix_fmts.

`tile_width `{.sample}`integer`{.variable}

Sets tile width. Range is 1 to 1073741824. Default is 256.

`tile_height `{.sample}`integer`{.variable}

Sets tile height. Range is 1 to 1073741824. Default is 256.

`pred `{.sample}`integer`{.variable}

Allows setting the discrete wavelet transform (DWT) type

`dwt97int (Lossy)`{.sample}

`dwt53 (Lossless)`{.sample}

Default is `dwt97int`

`sop `{.sample}`boolean`{.variable}

Enable this to add SOP marker at the start of each packet. Disabled by
default.

`eph `{.sample}`boolean`{.variable}

Enable this to add EPH marker at the end of each packet header. Disabled
by default.

`prog `{.sample}`integer`{.variable}

Sets the progression order to be used by the encoder. Possible values
are:

`lrcp`{.sample}

`rlcp`{.sample}

`rpcl`{.sample}

`pcrl`{.sample}

`cprl`{.sample}

Set to `lrcp` by default.

`layer_rates `{.sample}`string`{.variable}

By default, when this option is not used, compression is done using the
quality metric. This option allows for compression using compression
ratio. The compression ratio for each level could be specified. The
compression ratio of a layer `l` species the what ratio of total file
size is contained in the first `l` layers.

Example usage:

::: example
``` example
ffmpeg -i input.bmp -c:v jpeg2000 -layer_rates "100,10,1" output.j2k
```
:::

This would compress the image to contain 3 layers, where the data
contained in the first layer would be compressed by 1000 times,
compressed by 100 in the first two layers, and shall contain all data
while using all 3 layers.

[]{#librav1e}

### [16.7 librav1e](#toc-librav1e) {#librav1e .section}

rav1e AV1 encoder wrapper.

Requires the presence of the rav1e headers and library during
configuration. You need to explicitly configure the build with
`--enable-librav1e`.

[]{#Options-30}

#### [16.7.1 Options](#toc-Options-30) {#options-30 .subsection}

`qmax`{.sample}

:   Sets the maximum quantizer to use when using bitrate mode.

`qmin`{.sample}

:   Sets the minimum quantizer to use when using bitrate mode.

`qp`{.sample}

:   Uses quantizer mode to encode at the given quantizer (0-255).

`speed`{.sample}

:   Selects the speed preset (0-10) to encode with.

`tiles`{.sample}

:   Selects how many tiles to encode with.

`tile-rows`{.sample}

:   Selects how many rows of tiles to encode with.

`tile-columns`{.sample}

:   Selects how many columns of tiles to encode with.

`rav1e-params`{.sample}

:   Set rav1e options using a list of
    `key`{.variable}=`value`{.variable} pairs separated by \":\". See
    `rav1e --help` for a list of options.

    For example to specify librav1e encoding options with
    `-rav1e-params`{.sample}:

    ::: example
    ``` example
    ffmpeg -i input -c:v librav1e -b:v 500K -rav1e-params speed=5:low_latency=true output.mp4
    ```
    :::

[]{#libaom_002dav1}

### [16.8 libaom-av1](#toc-libaom_002dav1) {#libaom-av1 .section}

libaom AV1 encoder wrapper.

Requires the presence of the libaom headers and library during
configuration. You need to explicitly configure the build with
`--enable-libaom`.

[]{#Options-31}

#### [16.8.1 Options](#toc-Options-31) {#options-31 .subsection}

The wrapper supports the following standard libavcodec options:

`b`{.sample}

:   Set bitrate target in bits/second. By default this will use
    variable-bitrate mode. If `maxrate`{.sample} and `minrate`{.sample}
    are also set to the same value then it will use constant-bitrate
    mode, otherwise if `crf`{.sample} is set as well then it will use
    constrained-quality mode.

`g keyint_min`{.sample}

:   Set key frame placement. The GOP size sets the maximum distance
    between key frames; if zero the output stream will be intra-only.
    The minimum distance is ignored unless it is the same as the GOP
    size, in which case key frames will always appear at a fixed
    interval. Not set by default, so without this option the library has
    completely free choice about where to place key frames.

`qmin qmax`{.sample}

:   Set minimum/maximum quantisation values. Valid range is from 0 to 63
    (warning: this does not match the quantiser values actually used by
    AV1 - divide by four to map real quantiser values to this range).
    Defaults to min/max (no constraint).

`minrate maxrate bufsize rc_init_occupancy`{.sample}

:   Set rate control buffering parameters. Not used if not set -
    defaults to unconstrained variable bitrate.

`threads`{.sample}

:   Set the number of threads to use while encoding. This may require
    the `tiles`{.sample} or `row-mt`{.sample} options to also be set to
    actually use the specified number of threads fully. Defaults to the
    number of hardware threads supported by the host machine.

`profile`{.sample}

:   Set the encoding profile. Defaults to using the profile which
    matches the bit depth and chroma subsampling of the input.

The wrapper also has some specific options:

`cpu-used`{.sample}

Set the quality/encoding speed tradeoff. Valid range is from 0 to 8,
higher numbers indicating greater speed and lower quality. The default
value is 1, which will be slow and high quality.

`auto-alt-ref`{.sample}

Enable use of alternate reference frames. Defaults to the internal
default of the library.

`arnr-max-frames (`{.sample}*`frames`{.sample}*`)`{.sample}

Set altref noise reduction max frame count. Default is -1.

`arnr-strength (`{.sample}*`strength`{.sample}*`)`{.sample}

Set altref noise reduction filter strength. Range is -1 to 6. Default is
-1.

`aq-mode (`{.sample}*`aq-mode`{.sample}*`)`{.sample}

Set adaptive quantization mode. Possible values:

'`none (`{.sample}*`0`{.sample}*`)`{.sample}'

:   Disabled.

'`variance (`{.sample}*`1`{.sample}*`)`{.sample}'

:   Variance-based.

'`complexity (`{.sample}*`2`{.sample}*`)`{.sample}'

:   Complexity-based.

'`cyclic (`{.sample}*`3`{.sample}*`)`{.sample}'

:   Cyclic refresh.

`tune (`{.sample}*`tune`{.sample}*`)`{.sample}

Set the distortion metric the encoder is tuned with. Default is `psnr`.

'`psnr (`{.sample}*`0`{.sample}*`)`{.sample}'

'`ssim (`{.sample}*`1`{.sample}*`)`{.sample}'

`lag-in-frames`{.sample}

Set the maximum number of frames which the encoder may keep in flight at
any one time for lookahead purposes. Defaults to the internal default of
the library.

`error-resilience`{.sample}

Enable error resilience features:

`default`{.sample}

:   Improve resilience against losses of whole frames.

Not enabled by default.

`crf`{.sample}

Set the quality/size tradeoff for constant-quality (no bitrate target)
and constrained-quality (with maximum bitrate target) modes. Valid range
is 0 to 63, higher numbers indicating lower quality and smaller output
size. Only used if set; by default only the bitrate target is used.

`static-thresh`{.sample}

Set a change threshold on blocks below which they will be skipped by the
encoder. Defined in arbitrary units as a nonnegative integer, defaulting
to zero (no blocks are skipped).

`drop-threshold`{.sample}

Set a threshold for dropping frames when close to rate control bounds.
Defined as a percentage of the target buffer - when the rate control
buffer falls below this percentage, frames will be dropped until it has
refilled above the threshold. Defaults to zero (no frames are dropped).

`denoise-noise-level (`{.sample}*`level`{.sample}*`)`{.sample}

Amount of noise to be removed for grain synthesis. Grain synthesis is
disabled if this option is not set or set to 0.

`denoise-block-size (`{.sample}*`pixels`{.sample}*`)`{.sample}

Block size used for denoising for grain synthesis. If not set, AV1 codec
uses the default value of 32.

`undershoot-pct (`{.sample}*`pct`{.sample}*`)`{.sample}

Set datarate undershoot (min) percentage of the target bitrate. Range is
-1 to 100. Default is -1.

`overshoot-pct (`{.sample}*`pct`{.sample}*`)`{.sample}

Set datarate overshoot (max) percentage of the target bitrate. Range is
-1 to 1000. Default is -1.

`minsection-pct (`{.sample}*`pct`{.sample}*`)`{.sample}

Minimum percentage variation of the GOP bitrate from the target bitrate.
If minsection-pct is not set, the libaomenc wrapper computes it as
follows: `(minrate * 100 / bitrate)`. Range is -1 to 100. Default is -1
(unset).

`maxsection-pct (`{.sample}*`pct`{.sample}*`)`{.sample}

Maximum percentage variation of the GOP bitrate from the target bitrate.
If maxsection-pct is not set, the libaomenc wrapper computes it as
follows: `(maxrate * 100 / bitrate)`. Range is -1 to 5000. Default is -1
(unset).

`frame-parallel (`{.sample}*`boolean`{.sample}*`)`{.sample}

Enable frame parallel decodability features. Default is true.

`tiles`{.sample}

Set the number of tiles to encode the input video with, as columns x
rows. Larger numbers allow greater parallelism in both encoding and
decoding, but may decrease coding efficiency. Defaults to the minimum
number of tiles required by the size of the input video (this is 1x1
(that is, a single tile) for sizes up to and including 4K).

`tile-columns tile-rows`{.sample}

Set the number of tiles as log2 of the number of tile rows and columns.
Provided for compatibility with libvpx/VP9.

`row-mt (Requires libaom >= 1.0.0-759-g90a15f4f2)`{.sample}

Enable row based multi-threading. Disabled by default.

`enable-cdef (`{.sample}*`boolean`{.sample}*`)`{.sample}

Enable Constrained Directional Enhancement Filter. The libaom-av1
encoder enables CDEF by default.

`enable-restoration (`{.sample}*`boolean`{.sample}*`)`{.sample}

Enable Loop Restoration Filter. Default is true for libaom-av1.

`enable-global-motion (`{.sample}*`boolean`{.sample}*`)`{.sample}

Enable the use of global motion for block prediction. Default is true.

`enable-intrabc (`{.sample}*`boolean`{.sample}*`)`{.sample}

Enable block copy mode for intra block prediction. This mode is useful
for screen content. Default is true.

`enable-rect-partitions (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable rectangular partitions. Default is true.

`enable-1to4-partitions (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable 1:4/4:1 partitions. Default is true.

`enable-ab-partitions (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable AB shape partitions. Default is true.

`enable-angle-delta (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable angle delta intra prediction. Default is true.

`enable-cfl-intra (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable chroma predicted from luma intra prediction. Default is true.

`enable-filter-intra (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable filter intra predictor. Default is true.

`enable-intra-edge-filter (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable intra edge filter. Default is true.

`enable-smooth-intra (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable smooth intra prediction mode. Default is true.

`enable-paeth-intra (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable paeth predictor in intra prediction. Default is true.

`enable-palette (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable palette prediction mode. Default is true.

`enable-flip-idtx (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable extended transform type, including FLIPADST_DCT, DCT_FLIPADST,
FLIPADST_FLIPADST, ADST_FLIPADST, FLIPADST_ADST, IDTX, V_DCT, H_DCT,
V_ADST, H_ADST, V_FLIPADST, H_FLIPADST. Default is true.

`enable-tx64 (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable 64-pt transform. Default is true.

`reduced-tx-type-set (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Use reduced set of transform types. Default is false.

`use-intra-dct-only (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Use DCT only for INTRA modes. Default is false.

`use-inter-dct-only (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Use DCT only for INTER modes. Default is false.

`use-intra-default-tx-only (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Use Default-transform only for INTRA modes. Default is false.

`enable-ref-frame-mvs (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable temporal mv prediction. Default is true.

`enable-reduced-reference-set (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Use reduced set of single and compound references. Default is false.

`enable-obmc (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable obmc. Default is true.

`enable-dual-filter (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable dual filter. Default is true.

`enable-diff-wtd-comp (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable difference-weighted compound. Default is true.

`enable-dist-wtd-comp (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable distance-weighted compound. Default is true.

`enable-onesided-comp (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable one sided compound. Default is true.

`enable-interinter-wedge (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable interinter wedge compound. Default is true.

`enable-interintra-wedge (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable interintra wedge compound. Default is true.

`enable-masked-comp (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable masked compound. Default is true.

`enable-interintra-comp (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable interintra compound. Default is true.

`enable-smooth-interintra (`{.sample}*`boolean`{.sample}*`) (Requires libaom >= v2.0.0)`{.sample}

Enable smooth interintra mode. Default is true.

`aom-params`{.sample}

Set libaom options using a list of `key`{.variable}=`value`{.variable}
pairs separated by \":\". For a list of supported options, see
`aomenc --help` under the section \"AV1 Specific Options\".

For example to specify libaom encoding options with
`-aom-params`{.sample}:

::: example
``` example
ffmpeg -i input -c:v libaom-av1 -b:v 500K -aom-params tune=psnr:enable-tpl-model=1 output.mp4
```
:::

[]{#liboapv}

### [16.9 liboapv](#toc-liboapv) {#liboapv .section}

Advanced Professional Video codec encoder wrapper.

This encoder requires the presence of the liboapv headers and library
during configuration. You need to explicitly configure the build with
`--enable-liboapv`{.sample}.

::: info
Many liboapv encoder options are mapped to FFmpeg global codec options,
while unique encoder options are provided through private options.
:::

The apv project website is at
<https://github.com/AcademySoftwareFoundation/openapv>.

[]{#Options-32}

#### [16.9.1 Options](#toc-Options-32) {#options-32 .subsection}

The following options are supported by the liboapv wrapper.

::: info
To get a more extensive documentation of the liboapv options, consult
the liboapv documentation.
:::

`preset`{.sample}

:   Set the quality-speed tradeoff \[fastest, fast, medium, slow,
    placebo, default\]

`qp`{.sample}

:   Set the quantization parameter value for CQP rate control mode.

`oapv-params (`{.sample}*`parse_apv_params`{.sample}*`)`{.sample}

:   Set liboapvenc options using a list of
    `key`{.variable}=`value`{.variable} pairs separated by \":\". See
    the liboapv encoder user guide for a list of accepted parameters.

[]{#libsvtav1}

### [16.10 libsvtav1](#toc-libsvtav1) {#libsvtav1 .section}

SVT-AV1 encoder wrapper.

Requires the presence of the SVT-AV1 headers and library during
configuration. You need to explicitly configure the build with
`--enable-libsvtav1`.

[]{#Options-33}

#### [16.10.1 Options](#toc-Options-33) {#options-33 .subsection}

`profile`{.sample}

Set the encoding profile.

'`main`{.sample}'

'`high`{.sample}'

'`professional`{.sample}'

`level`{.sample}

Set the operating point level. For example: '4.0'

`hielevel`{.sample}

Set the Hierarchical prediction levels.

'`3level`{.sample}'\
'`4level`{.sample}'

:   This is the default.

`tier`{.sample}

Set the operating point tier.

'`main`{.sample}'

This is the default.

'`high`{.sample}'

`qmax`{.sample}

Set the maximum quantizer to use when using a bitrate mode.

`qmin`{.sample}

Set the minimum quantizer to use when using a bitrate mode.

`crf`{.sample}

Constant rate factor value used in crf rate control mode (0-63).

`qp`{.sample}

Set the quantizer used in cqp rate control mode (0-63).

`sc_detection`{.sample}

Enable scene change detection.

`la_depth`{.sample}

Set number of frames to look ahead (0-120).

`preset`{.sample}

Set the quality-speed tradeoff, in the range 0 to 13. Higher values are
faster but lower quality.

`tile_rows`{.sample}

Set log2 of the number of rows of tiles to use (0-6).

`tile_columns`{.sample}

Set log2 of the number of columns of tiles to use (0-4).

`svtav1-params`{.sample}

Set SVT-AV1 options using a list of `key`{.variable}=`value`{.variable}
pairs separated by \":\". See the SVT-AV1 encoder user guide for a list
of accepted parameters.

[]{#libsvtjpegxs}

### [16.11 libsvtjpegxs](#toc-libsvtjpegxs) {#libsvtjpegxs .section}

SVT-JPEG-XS encoder wrapper.

Requires the presence of the SVT-JPEG-XS headers and library during
configuration. You need to explicitly configure the build with
`--enable-libsvtjpegxs`.

[]{#Options-34}

#### [16.11.1 Options](#toc-Options-34) {#options-34 .subsection}

`decomp_v`{.sample}

Set vertical decomposition level

`decomp_h`{.sample}

Set horizontal decomposition level

`quantization`{.sample}

Set the quantization algorithm.

'`deadzone`{.sample}'

'`uniform`{.sample}'

`coding-signs`{.sample}

Enable Signs handling strategy

'`disable`{.sample}'

'`fast`{.sample}'

'`full`{.sample}'

`coding-sigf`{.sample}

Enable Significance coding

`coding-vpred`{.sample}

Enable Vertical Prediction coding

'`disable`{.sample}'

'`no_residuals`{.sample}'

'`no_coeffs`{.sample}'

[]{#libjxl}

### [16.12 libjxl](#toc-libjxl) {#libjxl .section}

libjxl JPEG XL encoder wrapper.

Requires the presence of the libjxl headers and library during
configuration. You need to explicitly configure the build with
`--enable-libjxl`.

[]{#Options-35}

#### [16.12.1 Options](#toc-Options-35) {#options-35 .subsection}

The libjxl wrapper supports the following options:

`distance`{.sample}

:   Set the target Butteraugli distance. This is a quality setting:
    lower distance yields higher quality, with distance=1.0 roughly
    comparable to libjpeg Quality 90 for photographic content. Setting
    distance=0.0 yields true lossless encoding. Valid values range
    between 0.0 and 15.0, and sane values rarely exceed 5.0. Setting
    distance=0.1 usually attains transparency for most input. The
    default is 1.0.

`effort`{.sample}

:   Set the encoding effort used. Higher effort values produce more
    consistent quality and usually produces a better quality/bpp curve,
    at the cost of more CPU time required. Valid values range from 1 to
    9, and the default is 7.

`modular`{.sample}

:   Force the encoder to use Modular mode instead of choosing
    automatically. The default is to use VarDCT for lossy encoding and
    Modular for lossless. VarDCT is generally superior to Modular for
    lossy encoding but does not support lossless encoding.

[]{#libkvazaar}

### [16.13 libkvazaar](#toc-libkvazaar) {#libkvazaar .section}

Kvazaar H.265/HEVC encoder.

Requires the presence of the libkvazaar headers and library during
configuration. You need to explicitly configure the build with
`--enable-libkvazaar`{.sample}.

[]{#Options-36}

#### [16.13.1 Options](#toc-Options-36) {#options-36 .subsection}

`b`{.sample}

:   Set target video bitrate in bit/s and enable rate control.

`kvazaar-params`{.sample}

:   Set kvazaar parameters as a list of
    `name`{.variable}=`value`{.variable} pairs separated by commas (,).
    See kvazaar documentation for a list of options.

[]{#libopenh264}

### [16.14 libopenh264](#toc-libopenh264) {#libopenh264 .section}

Cisco libopenh264 H.264/MPEG-4 AVC encoder wrapper.

This encoder requires the presence of the libopenh264 headers and
library during configuration. You need to explicitly configure the build
with `--enable-libopenh264`. The library is detected using `pkg-config`.

For more information about the library see <http://www.openh264.org>.

[]{#Options-37}

#### [16.14.1 Options](#toc-Options-37) {#options-37 .subsection}

The following FFmpeg global options affect the configurations of the
libopenh264 encoder.

`b`{.sample}

:   Set the bitrate (as a number of bits per second).

`g`{.sample}

:   Set the GOP size.

`maxrate`{.sample}

:   Set the max bitrate (as a number of bits per second).

`flags +global_header`{.sample}

:   Set global header in the bitstream.

`slices`{.sample}

:   Set the number of slices, used in parallelized encoding. Default
    value is 0. This is only used when `slice_mode`{.sample} is set to
    '`fixed`{.sample}'.

`loopfilter`{.sample}

:   Enable loop filter, if set to 1 (automatically enabled). To disable
    set a value of 0.

`profile`{.sample}

:   Set profile restrictions. If set to the value of '`main`{.sample}'
    enable CABAC (set the `SEncParamExt.iEntropyCodingModeFlag` flag to
    1).

`max_nal_size`{.sample}

:   Set maximum NAL size in bytes.

`allow_skip_frames`{.sample}

:   Allow skipping frames to hit the target bitrate if set to 1.

[]{#libtheora}

### [16.15 libtheora](#toc-libtheora) {#libtheora .section}

libtheora Theora encoder wrapper.

Requires the presence of the libtheora headers and library during
configuration. You need to explicitly configure the build with
`--enable-libtheora`.

For more information about the libtheora project see
<http://www.theora.org/>.

[]{#Options-38}

#### [16.15.1 Options](#toc-Options-38) {#options-38 .subsection}

The following global options are mapped to internal libtheora options
which affect the quality and the bitrate of the encoded stream.

`b`{.sample}

:   Set the video bitrate in bit/s for CBR (Constant Bit Rate) mode. In
    case VBR (Variable Bit Rate) mode is enabled this option is ignored.

`flags`{.sample}

:   Used to enable constant quality mode (VBR) encoding through the
    `qscale`{.sample} flag, and to enable the `pass1` and `pass2` modes.

`g`{.sample}

:   Set the GOP size.

`global_quality`{.sample}

:   Set the global quality as an integer in lambda units.

    Only relevant when VBR mode is enabled with `flags +qscale`. The
    value is converted to QP units by dividing it by `FF_QP2LAMBDA`,
    clipped in the \[0 - 10\] range, and then multiplied by 6.3 to get a
    value in the native libtheora range \[0-63\]. A higher value
    corresponds to a higher quality.

`q`{.sample}

:   Enable VBR mode when set to a non-negative value, and set constant
    quality value as a double floating point value in QP units.

    The value is clipped in the \[0-10\] range, and then multiplied by
    6.3 to get a value in the native libtheora range \[0-63\].

    This option is valid only using the `ffmpeg` command-line tool. For
    library interface users, use `global_quality`{.sample}.

[]{#Examples-5}

#### [16.15.2 Examples](#toc-Examples-5) {#examples-5 .subsection}

- Set maximum constant quality (VBR) encoding with `ffmpeg`:

  ::: example
  ``` example
  ffmpeg -i INPUT -codec:v libtheora -q:v 10 OUTPUT.ogg
  ```
  :::
- Use `ffmpeg` to convert a CBR 1000 kbps Theora video stream:

  ::: example
  ``` example
  ffmpeg -i INPUT -codec:v libtheora -b:v 1000k OUTPUT.ogg
  ```
  :::

[]{#libvpx}

### [16.16 libvpx](#toc-libvpx) {#libvpx .section}

VP8/VP9 format supported through libvpx.

Requires the presence of the libvpx headers and library during
configuration. You need to explicitly configure the build with
`--enable-libvpx`.

[]{#Options-39}

#### [16.16.1 Options](#toc-Options-39) {#options-39 .subsection}

The following options are supported by the libvpx wrapper. The
`vpxenc`-equivalent options or values are listed in parentheses for easy
migration.

To reduce the duplication of documentation, only the private options and
some others requiring special attention are documented here. For the
documentation of the undocumented generic options, see [the Codec
Options chapter](#codec_002doptions).

To get more documentation of the libvpx options, invoke the command
`ffmpeg -h encoder=libvpx`, `ffmpeg -h encoder=libvpx-vp9` or
`vpxenc --help`. Further information is available in the libvpx API
documentation.

`b (`{.sample}*`target-bitrate`{.sample}*`)`{.sample}

Set bitrate in bits/s. Note that FFmpeg's `b`{.sample} option is
expressed in bits/s, while `vpxenc`'s `target-bitrate`{.sample} is in
kilobits/s.

`g (`{.sample}*`kf-max-dist`{.sample}*`)`{.sample}

`keyint_min (`{.sample}*`kf-min-dist`{.sample}*`)`{.sample}

`qmin (`{.sample}*`min-q`{.sample}*`)`{.sample}

Minimum (Best Quality) Quantizer.

`qmax (`{.sample}*`max-q`{.sample}*`)`{.sample}

Maximum (Worst Quality) Quantizer. Can be changed per-frame.

`bufsize (`{.sample}*`buf-sz`{.sample}*`, `{.sample}*`buf-optimal-sz`{.sample}*`)`{.sample}

Set ratecontrol buffer size (in bits). Note `vpxenc`'s options are
specified in milliseconds, the libvpx wrapper converts this value as
follows: `buf-sz = bufsize * 1000 / bitrate`,
`buf-optimal-sz = bufsize * 1000 / bitrate * 5 / 6`.

`rc_init_occupancy (`{.sample}*`buf-initial-sz`{.sample}*`)`{.sample}

Set number of bits which should be loaded into the rc buffer before
decoding starts. Note `vpxenc`'s option is specified in milliseconds,
the libvpx wrapper converts this value as follows:
`rc_init_occupancy * 1000 / bitrate`.

`undershoot-pct`{.sample}

Set datarate undershoot (min) percentage of the target bitrate.

`overshoot-pct`{.sample}

Set datarate overshoot (max) percentage of the target bitrate.

`skip_threshold (`{.sample}*`drop-frame`{.sample}*`)`{.sample}

`qcomp (`{.sample}*`bias-pct`{.sample}*`)`{.sample}

`maxrate (`{.sample}*`maxsection-pct`{.sample}*`)`{.sample}

Set GOP max bitrate in bits/s. Note `vpxenc`'s option is specified as a
percentage of the target bitrate, the libvpx wrapper converts this value
as follows: `(maxrate * 100 / bitrate)`.

`minrate (`{.sample}*`minsection-pct`{.sample}*`)`{.sample}

Set GOP min bitrate in bits/s. Note `vpxenc`'s option is specified as a
percentage of the target bitrate, the libvpx wrapper converts this value
as follows: `(minrate * 100 / bitrate)`.

`minrate, maxrate, b `{.sample}*`end-usage=cbr`{.sample}*

`(minrate == maxrate == bitrate)`.

`crf (`{.sample}*`end-usage=cq`{.sample}*`, `{.sample}*`cq-level`{.sample}*`)`{.sample}

`tune (`{.sample}*`tune`{.sample}*`)`{.sample}

'`psnr (`{.sample}*`psnr`{.sample}*`)`{.sample}'

'`ssim (`{.sample}*`ssim`{.sample}*`)`{.sample}'

`quality, deadline (`{.sample}*`deadline`{.sample}*`)`{.sample}

'`best`{.sample}'

:   Use best quality deadline. Poorly named and quite slow, this option
    should be avoided as it may give worse quality output than good.

'`good`{.sample}'

:   Use good quality deadline. This is a good trade-off between speed
    and quality when used with the `cpu-used`{.sample} option.

'`realtime`{.sample}'

:   Use realtime quality deadline.

`speed, cpu-used (`{.sample}*`cpu-used`{.sample}*`)`{.sample}

Set quality/speed ratio modifier. Higher values speed up the encode at
the cost of quality.

`nr (`{.sample}*`noise-sensitivity`{.sample}*`)`{.sample}

`static-thresh`{.sample}

Set a change threshold on blocks below which they will be skipped by the
encoder.

`slices (`{.sample}*`token-parts`{.sample}*`)`{.sample}

Note that FFmpeg's `slices`{.sample} option gives the total number of
partitions, while `vpxenc`'s `token-parts`{.sample} is given as
`log2(partitions)`.

`max-intra-rate`{.sample}

Set maximum I-frame bitrate as a percentage of the target bitrate. A
value of 0 means unlimited.

`force_key_frames`{.sample}

`VPX_EFLAG_FORCE_KF`

`Alternate reference frame related`{.sample}

`auto-alt-ref`{.sample}

:   Enable use of alternate reference frames (2-pass only). Values
    greater than 1 enable multi-layer alternate reference frames (VP9
    only).

`arnr-maxframes`{.sample}

:   Set altref noise reduction max frame count.

`arnr-type`{.sample}

:   Set altref noise reduction filter type: backward, forward, centered.

`arnr-strength`{.sample}

:   Set altref noise reduction filter strength.

`rc-lookahead, lag-in-frames (`{.sample}*`lag-in-frames`{.sample}*`)`{.sample}

:   Set number of frames to look ahead for frametype and ratecontrol.

`min-gf-interval`{.sample}

:   Set minimum golden/alternate reference frame interval (VP9 only).

`error-resilient`{.sample}

Enable error resiliency features.

`sharpness `{.sample}`integer`{.variable}

Increase sharpness at the expense of lower PSNR. The valid range is \[0,
7\].

`ts-parameters`{.sample}

Sets the temporal scalability configuration using a :-separated list of
key=value pairs. For example, to specify temporal scalability parameters
with `ffmpeg`:

::: example
``` example
ffmpeg -i INPUT -c:v libvpx -ts-parameters ts_number_layers=3:\
ts_target_bitrate=250,500,1000:ts_rate_decimator=4,2,1:\
ts_periodicity=4:ts_layer_id=0,2,1,2:ts_layering_mode=3 OUTPUT
```
:::

Below is a brief explanation of each of the parameters, please refer to
`struct vpx_codec_enc_cfg` in `vpx/vpx_encoder.h` for more details.

`ts_number_layers`{.sample}

:   Number of temporal coding layers.

`ts_target_bitrate`{.sample}

:   Target bitrate for each temporal layer (in kbps). (bitrate should be
    inclusive of the lower temporal layer).

`ts_rate_decimator`{.sample}

:   Frame rate decimation factor for each temporal layer.

`ts_periodicity`{.sample}

:   Length of the sequence defining frame temporal layer membership.

`ts_layer_id`{.sample}

:   Template defining the membership of frames to temporal layers.

`ts_layering_mode`{.sample}

:   (optional) Selecting the temporal structure from a set of
    pre-defined temporal layering modes. Currently supports the
    following options.

    `0`{.sample}

    :   No temporal layering flags are provided internally, relies on
        flags being passed in using `metadata` field in `AVFrame` with
        following keys.

        `vp8-flags`{.sample}

        :   Sets the flags passed into the encoder to indicate the
            referencing scheme for the current frame. Refer to function
            `vpx_codec_encode` in `vpx/vpx_encoder.h` for more details.

        `temporal_id`{.sample}

        :   Explicitly sets the temporal id of the current frame to
            encode.

    `2`{.sample}

    :   Two temporal layers. 0-1\...

    `3`{.sample}

    :   Three temporal layers. 0-2-1-2\...; with single reference frame.

    `4`{.sample}

    :   Same as option \"3\", except there is a dependency between the
        two temporal layer 2 frames within the temporal period.

`VP8-specific options`{.sample}

`screen-content-mode`{.sample}

:   Screen content mode, one of: 0 (off), 1 (screen), 2 (screen with
    more aggressive rate control).

`VP9-specific options`{.sample}

`lossless`{.sample}

Enable lossless mode.

`tile-columns`{.sample}

Set number of tile columns to use. Note this is given as
`log2(tile_columns)`. For example, 8 tile columns would be requested by
setting the `tile-columns`{.sample} option to 3.

`tile-rows`{.sample}

Set number of tile rows to use. Note this is given as `log2(tile_rows)`.
For example, 4 tile rows would be requested by setting the
`tile-rows`{.sample} option to 2.

`frame-parallel`{.sample}

Enable frame parallel decodability features.

`aq-mode`{.sample}

Set adaptive quantization mode (0: off (default), 1: variance 2:
complexity, 3: cyclic refresh, 4: equator360).

`colorspace `{.sample}*`color-space`{.sample}*

Set input color space. The VP9 bitstream supports signaling the
following colorspaces:

``{.sample}`rgb`{.sample}` `{.sample}*`sRGB`{.sample}*

``{.sample}`bt709`{.sample}` `{.sample}*`bt709`{.sample}*

``{.sample}`unspecified`{.sample}` `{.sample}*`unknown`{.sample}*

``{.sample}`bt470bg`{.sample}` `{.sample}*`bt601`{.sample}*

``{.sample}`smpte170m`{.sample}` `{.sample}*`smpte170`{.sample}*

``{.sample}`smpte240m`{.sample}` `{.sample}*`smpte240`{.sample}*

``{.sample}`bt2020_ncl`{.sample}` `{.sample}*`bt2020`{.sample}*

`row-mt `{.sample}`boolean`{.variable}

Enable row based multi-threading.

`tune-content`{.sample}

Set content type: default (0), screen (1), film (2).

`corpus-complexity`{.sample}

Corpus VBR mode is a variant of standard VBR where the complexity
distribution midpoint is passed in rather than calculated for a specific
clip or chunk.

The valid range is \[0, 10000\]. 0 (default) uses standard VBR.

`enable-tpl `{.sample}`boolean`{.variable}

Enable temporal dependency model.

`ref-frame-config`{.sample}

Using per-frame metadata, set members of the structure
`vpx_svc_ref_frame_config_t` in `vpx/vp8cx.h` to fine-control
referencing schemes and frame buffer management.\
Use a :-separated list of key=value pairs. For example,

::: example
``` example
av_dict_set(&av_frame->metadata, "ref-frame-config", \
"rfc_update_buffer_slot=7:rfc_lst_fb_idx=0:rfc_gld_fb_idx=1:rfc_alt_fb_idx=2:rfc_reference_last=0:rfc_reference_golden=0:rfc_reference_alt_ref=0");
```
:::

`rfc_update_buffer_slot`{.sample}

:   Indicates the buffer slot number to update

`rfc_update_last`{.sample}

:   Indicates whether to update the LAST frame

`rfc_update_golden`{.sample}

:   Indicates whether to update GOLDEN frame

`rfc_update_alt_ref`{.sample}

:   Indicates whether to update ALT_REF frame

`rfc_lst_fb_idx`{.sample}

:   LAST frame buffer index

`rfc_gld_fb_idx`{.sample}

:   GOLDEN frame buffer index

`rfc_alt_fb_idx`{.sample}

:   ALT_REF frame buffer index

`rfc_reference_last`{.sample}

:   Indicates whether to reference LAST frame

`rfc_reference_golden`{.sample}

:   Indicates whether to reference GOLDEN frame

`rfc_reference_alt_ref`{.sample}

:   Indicates whether to reference ALT_REF frame

`rfc_reference_duration`{.sample}

:   Indicates frame duration

For more information about libvpx see: <http://www.webmproject.org/>

[]{#libvvenc}

### [16.17 libvvenc](#toc-libvvenc) {#libvvenc .section}

VVenC H.266/VVC encoder wrapper.

This encoder requires the presence of the libvvenc headers and library
during configuration. You need to explicitly configure the build with
`--enable-libvvenc`{.sample}.

The VVenC project website is at
<https://github.com/fraunhoferhhi/vvenc>.

[]{#Supported-Pixel-Formats}

#### [16.17.1 Supported Pixel Formats](#toc-Supported-Pixel-Formats) {#supported-pixel-formats .subsection}

VVenC supports only 10-bit color spaces as input. But the internal
(encoded) bit depth can be set to 8-bit or 10-bit at runtime.

[]{#Options-40}

#### [16.17.2 Options](#toc-Options-40) {#options-40 .subsection}

`b`{.sample}

:   Sets target video bitrate.

`g`{.sample}

:   Set the GOP size. Currently support for g=1 (Intra only) or default.

`preset`{.sample}

:   Set the VVenC preset.

`levelidc`{.sample}

:   Set level idc.

`tier`{.sample}

:   Set vvc tier.

`qp`{.sample}

:   Set constant quantization parameter.

`subopt `{.sample}`boolean`{.variable}

:   Set subjective (perceptually motivated) optimization. Default is 1
    (on).

`bitdepth8 `{.sample}`boolean`{.variable}

:   Set 8bit coding mode instead of using 10bit. Default is 0 (off).

`period`{.sample}

:   set (intra) refresh period in seconds.

`vvenc-params`{.sample}

:   Set vvenc options using a list of
    `key`{.variable}=`value`{.variable} couples separated by \":\". See
    `vvencapp --fullhelp` or `vvencFFapp --fullhelp` for a list of
    options.

    For example, the options might be provided as:

    ::: example
    ``` example
    intraperiod=64:decodingrefreshtype=idr:poc0idr=1:internalbitdepth=8
    ```
    :::

    For example the encoding options might be provided with
    `-vvenc-params`{.sample}:

    ::: example
    ``` example
    ffmpeg -i input -c:v libvvenc -b 1M -vvenc-params intraperiod=64:decodingrefreshtype=idr:poc0idr=1:internalbitdepth=8 output.mp4
    ```
    :::

[]{#libwebp}

### [16.18 libwebp](#toc-libwebp) {#libwebp .section}

libwebp WebP Image encoder wrapper

libwebp is Google's official encoder for WebP images. It can encode in
either lossy or lossless mode. Lossy images are essentially a wrapper
around a VP8 frame. Lossless images are a separate codec developed by
Google.

[]{#Pixel-Format}

#### [16.18.1 Pixel Format](#toc-Pixel-Format) {#pixel-format .subsection}

Currently, libwebp only supports YUV420 for lossy and RGB for lossless
due to limitations of the format and libwebp. Alpha is supported for
either mode. Because of API limitations, if RGB is passed in when
encoding lossy or YUV is passed in for encoding lossless, the pixel
format will automatically be converted using functions from libwebp.
This is not ideal and is done only for convenience.

[]{#Options-41}

#### [16.18.2 Options](#toc-Options-41) {#options-41 .subsection}

`-lossless `{.sample}`boolean`{.variable}

:   Enables/Disables use of lossless mode. Default is 0.

`-compression_level `{.sample}`integer`{.variable}

:   For lossy, this is a quality/speed tradeoff. Higher values give
    better quality for a given size at the cost of increased encoding
    time. For lossless, this is a size/speed tradeoff. Higher values
    give smaller size at the cost of increased encoding time. More
    specifically, it controls the number of extra algorithms and
    compression tools used, and varies the combination of these tools.
    This maps to the `method`{.variable} option in libwebp. The valid
    range is 0 to 6. Default is 4.

`-quality `{.sample}`float`{.variable}

:   For lossy encoding, this controls image quality. For lossless
    encoding, this controls the effort and time spent in compression.
    Range is 0 to 100. Default is 75.

`-preset `{.sample}`type`{.variable}

:   Configuration preset. This does some automatic settings based on the
    general type of the image.

    `none`{.sample}

    :   Do not use a preset.

    `default`{.sample}

    :   Use the encoder default.

    `picture`{.sample}

    :   Digital picture, like portrait, inner shot

    `photo`{.sample}

    :   Outdoor photograph, with natural lighting

    `drawing`{.sample}

    :   Hand or line drawing, with high-contrast details

    `icon`{.sample}

    :   Small-sized colorful images

    `text`{.sample}

    :   Text-like

[]{#libx264_002c-libx264rgb}

### [16.19 libx264, libx264rgb](#toc-libx264_002c-libx264rgb) {#libx264-libx264rgb .section}

x264 H.264/MPEG-4 AVC encoder wrapper.

This encoder requires the presence of the libx264 headers and library
during configuration. You need to explicitly configure the build with
`--enable-libx264`.

libx264 supports an impressive number of features, including 8x8 and 4x4
adaptive spatial transform, adaptive B-frame placement, CAVLC/CABAC
entropy coding, interlacing (MBAFF), lossless mode, psy optimizations
for detail retention (adaptive quantization, psy-RD, psy-trellis).

Many libx264 encoder options are mapped to FFmpeg global codec options,
while unique encoder options are provided through private options.
Additionally the `x264opts`{.sample} and `x264-params`{.sample} private
options allows one to pass a list of key=value tuples as accepted by the
libx264 `x264_param_parse` function.

The x264 project website is at
<http://www.videolan.org/developers/x264.html>.

The libx264rgb encoder is the same as libx264, except it accepts packed
RGB pixel formats as input instead of YUV.

[]{#Supported-Pixel-Formats-1}

#### [16.19.1 Supported Pixel Formats](#toc-Supported-Pixel-Formats-1) {#supported-pixel-formats-1 .subsection}

x264 supports 8- to 10-bit color spaces. The exact bit depth is
controlled at x264's configure time.

[]{#Options-42}

#### [16.19.2 Options](#toc-Options-42) {#options-42 .subsection}

The following options are supported by the libx264 wrapper. The
`x264`-equivalent options or values are listed in parentheses for easy
migration.

To reduce the duplication of documentation, only the private options and
some others requiring special attention are documented here. For the
documentation of the undocumented generic options, see [the Codec
Options chapter](#codec_002doptions).

To get a more accurate and extensive documentation of the libx264
options, invoke the command `x264 --fullhelp` or consult the libx264
documentation.

In the list below, note that the `x264` option name is shown in
parentheses after the libavcodec corresponding name, in case there is a
direct mapping.

`b (`{.sample}*`bitrate`{.sample}*`)`{.sample}

:   Set bitrate in bits/s. Note that FFmpeg's `b`{.sample} option is
    expressed in bits/s, while `x264`'s `bitrate`{.sample} is in
    kilobits/s.

`bf (`{.sample}*`bframes`{.sample}*`)`{.sample}

:   Number of B-frames between I and P-frames

`g (`{.sample}*`keyint`{.sample}*`)`{.sample}

:   Maximum GOP size

`qmin (`{.sample}*`qpmin`{.sample}*`)`{.sample}

:   Minimum quantizer scale

`qmax (`{.sample}*`qpmax`{.sample}*`)`{.sample}

:   Maximum quantizer scale

`qdiff (`{.sample}*`qpstep`{.sample}*`)`{.sample}

:   Maximum difference between quantizer scales

`qblur (`{.sample}*`qblur`{.sample}*`)`{.sample}

:   Quantizer curve blur

`qcomp (`{.sample}*`qcomp`{.sample}*`)`{.sample}

:   Quantizer curve compression factor

`refs (`{.sample}*`ref`{.sample}*`)`{.sample}

:   Number of reference frames each P-frame can use. The range is
    `0-16`{.variable}.

`level (`{.sample}*`level`{.sample}*`)`{.sample}

:   Set the `x264_param_t.i_level_idc` value in case the value is
    positive, it is ignored otherwise.

    This value can be set using the `AVCodecContext` API (e.g. by
    setting the `AVCodecContext` value directly), and is specified as an
    integer mapped on a corresponding level (e.g. the value 31 maps to
    H.264 level IDC \"3.1\", as defined in the `x264_levels` table). It
    is ignored when set to a non positive value.

    Alternatively it can be set as a private option, overriding the
    value set in `AVCodecContext`, and in this case must be specified as
    the level IDC identifier (e.g. \"3.1\"), as defined by H.264 Annex
    A.

`sc_threshold (`{.sample}*`scenecut`{.sample}*`)`{.sample}

:   Sets the threshold for the scene change detection.

`trellis (`{.sample}*`trellis`{.sample}*`)`{.sample}

:   Performs Trellis quantization to increase efficiency. Enabled by
    default.

`nr (`{.sample}*`nr`{.sample}*`)`{.sample}

:   Noise reduction

`me_range (`{.sample}*`merange`{.sample}*`)`{.sample}

:   Maximum range of the motion search in pixels.

`me_method (`{.sample}*`me`{.sample}*`)`{.sample}

:   Set motion estimation method. Possible values in the decreasing
    order of speed:

    '`dia (`{.sample}*`dia`{.sample}*`)`{.sample}'\
    '`epzs (`{.sample}*`dia`{.sample}*`)`{.sample}'

    :   Diamond search with radius 1 (fastest). '`epzs`{.sample}' is an
        alias for '`dia`{.sample}'.

    '`hex (`{.sample}*`hex`{.sample}*`)`{.sample}'

    :   Hexagonal search with radius 2.

    '`umh (`{.sample}*`umh`{.sample}*`)`{.sample}'

    :   Uneven multi-hexagon search.

    '`esa (`{.sample}*`esa`{.sample}*`)`{.sample}'

    :   Exhaustive search.

    '`tesa (`{.sample}*`tesa`{.sample}*`)`{.sample}'

    :   Hadamard exhaustive search (slowest).

`forced-idr`{.sample}

:   Normally, when forcing a I-frame type, the encoder can select any
    type of I-frame. This option forces it to choose an IDR-frame.

`subq (`{.sample}*`subme`{.sample}*`)`{.sample}

:   Sub-pixel motion estimation method.

`b_strategy (`{.sample}*`b-adapt`{.sample}*`)`{.sample}

:   Adaptive B-frame placement decision algorithm. Use only on
    first-pass.

`keyint_min (`{.sample}*`min-keyint`{.sample}*`)`{.sample}

:   Minimum GOP size.

`coder`{.sample}

:   Set entropy encoder. Possible values:

    '`ac`{.sample}'

    :   Enable CABAC.

    '`vlc`{.sample}'

    :   Enable CAVLC and disable CABAC. It generates the same effect as
        `x264`'s `--no-cabac`{.sample} option.

`cmp`{.sample}

:   Set full pixel motion estimation comparison algorithm. Possible
    values:

    '`chroma`{.sample}'

    :   Enable chroma in motion estimation.

    '`sad`{.sample}'

    :   Ignore chroma in motion estimation. It generates the same effect
        as `x264`'s `--no-chroma-me`{.sample} option.

`threads (`{.sample}*`threads`{.sample}*`)`{.sample}

:   Number of encoding threads.

`thread_type`{.sample}

:   Set multithreading technique. Possible values:

    '`slice`{.sample}'

    :   Slice-based multithreading. It generates the same effect as
        `x264`'s `--sliced-threads`{.sample} option.

    '`frame`{.sample}'

    :   Frame-based multithreading.

`flags`{.sample}

:   Set encoding flags. It can be used to disable closed GOP and enable
    open GOP by setting it to `-cgop`. The result is similar to the
    behavior of `x264`'s `--open-gop`{.sample} option.

`rc_init_occupancy (`{.sample}*`vbv-init`{.sample}*`)`{.sample}

:   Initial VBV buffer occupancy

`preset (`{.sample}*`preset`{.sample}*`)`{.sample}

:   Set the encoding preset.

`tune (`{.sample}*`tune`{.sample}*`)`{.sample}

:   Set tuning of the encoding params.

`profile (`{.sample}*`profile`{.sample}*`)`{.sample}

:   Set profile restrictions.

`fastfirstpass`{.sample}

:   Enable fast settings when encoding first pass, when set to 1. When
    set to 0, it has the same effect of `x264`'s
    `--slow-firstpass`{.sample} option.

`crf (`{.sample}*`crf`{.sample}*`)`{.sample}

:   Set the quality for constant quality mode.

`crf_max (`{.sample}*`crf-max`{.sample}*`)`{.sample}

:   In CRF mode, prevents VBV from lowering quality beyond this point.

`qp (`{.sample}*`qp`{.sample}*`)`{.sample}

:   Set constant quantization rate control method parameter.

`aq-mode (`{.sample}*`aq-mode`{.sample}*`)`{.sample}

:   Set AQ method. Possible values:

    '`none (`{.sample}*`0`{.sample}*`)`{.sample}'

    :   Disabled.

    '`variance (`{.sample}*`1`{.sample}*`)`{.sample}'

    :   Variance AQ (complexity mask).

    '`autovariance (`{.sample}*`2`{.sample}*`)`{.sample}'

    :   Auto-variance AQ (experimental).

`aq-strength (`{.sample}*`aq-strength`{.sample}*`)`{.sample}

:   Set AQ strength, reduce blocking and blurring in flat and textured
    areas.

`psy`{.sample}

:   Use psychovisual optimizations when set to 1. When set to 0, it has
    the same effect as `x264`'s `--no-psy`{.sample} option.

`psy-rd (`{.sample}*`psy-rd`{.sample}*`)`{.sample}

:   Set strength of psychovisual optimization, in
    `psy-rd`{.variable}:`psy-trellis`{.variable} format.

`rc-lookahead (`{.sample}*`rc-lookahead`{.sample}*`)`{.sample}

:   Set number of frames to look ahead for frametype and ratecontrol.

`weightb`{.sample}

:   Enable weighted prediction for B-frames when set to 1. When set to
    0, it has the same effect as `x264`'s `--no-weightb`{.sample}
    option.

`weightp (`{.sample}*`weightp`{.sample}*`)`{.sample}

:   Set weighted prediction method for P-frames. Possible values:

    '`none (`{.sample}*`0`{.sample}*`)`{.sample}'

    :   Disabled

    '`simple (`{.sample}*`1`{.sample}*`)`{.sample}'

    :   Enable only weighted refs

    '`smart (`{.sample}*`2`{.sample}*`)`{.sample}'

    :   Enable both weighted refs and duplicates

`ssim (`{.sample}*`ssim`{.sample}*`)`{.sample}

:   Enable calculation and printing SSIM stats after the encoding.

`intra-refresh (`{.sample}*`intra-refresh`{.sample}*`)`{.sample}

:   Enable the use of Periodic Intra Refresh instead of IDR frames when
    set to 1.

`avcintra-class (`{.sample}*`class`{.sample}*`)`{.sample}

:   Configure the encoder to generate AVC-Intra. Valid values are 50,
    100 and 200

`bluray-compat (`{.sample}*`bluray-compat`{.sample}*`)`{.sample}

:   Configure the encoder to be compatible with the bluray standard. It
    is a shorthand for setting \"bluray-compat=1 force-cfr=1\".

`b-bias (`{.sample}*`b-bias`{.sample}*`)`{.sample}

:   Set the influence on how often B-frames are used.

`b-pyramid (`{.sample}*`b-pyramid`{.sample}*`)`{.sample}

:   Set method for keeping of some B-frames as references. Possible
    values:

    '`none (`{.sample}*`none`{.sample}*`)`{.sample}'

    :   Disabled.

    '`strict (`{.sample}*`strict`{.sample}*`)`{.sample}'

    :   Strictly hierarchical pyramid.

    '`normal (`{.sample}*`normal`{.sample}*`)`{.sample}'

    :   Non-strict (not Blu-ray compatible).

`mixed-refs`{.sample}

:   Enable the use of one reference per partition, as opposed to one
    reference per macroblock when set to 1. When set to 0, it has the
    same effect as `x264`'s `--no-mixed-refs`{.sample} option.

`8x8dct`{.sample}

:   Enable adaptive spatial transform (high profile 8x8 transform) when
    set to 1. When set to 0, it has the same effect as `x264`'s
    `--no-8x8dct`{.sample} option.

`fast-pskip`{.sample}

:   Enable early SKIP detection on P-frames when set to 1. When set to
    0, it has the same effect as `x264`'s `--no-fast-pskip`{.sample}
    option.

`aud (`{.sample}*`aud`{.sample}*`)`{.sample}

:   Enable use of access unit delimiters when set to 1.

`mbtree`{.sample}

:   Enable use macroblock tree ratecontrol when set to 1. When set to 0,
    it has the same effect as `x264`'s `--no-mbtree`{.sample} option.

`deblock (`{.sample}*`deblock`{.sample}*`)`{.sample}

:   Set loop filter parameters, in `alpha`{.variable}:`beta`{.variable}
    form.

`cplxblur (`{.sample}*`cplxblur`{.sample}*`)`{.sample}

:   Set fluctuations reduction in QP (before curve compression).

`partitions (`{.sample}*`partitions`{.sample}*`)`{.sample}

:   Set partitions to consider as a comma-separated list of values.
    Possible values in the list:

    '`p8x8`{.sample}'

    :   8x8 P-frame partition.

    '`p4x4`{.sample}'

    :   4x4 P-frame partition.

    '`b8x8`{.sample}'

    :   4x4 B-frame partition.

    '`i8x8`{.sample}'

    :   8x8 I-frame partition.

    '`i4x4`{.sample}'

    :   4x4 I-frame partition. (Enabling '`p4x4`{.sample}' requires
        '`p8x8`{.sample}' to be enabled. Enabling '`i8x8`{.sample}'
        requires adaptive spatial transform (`8x8dct`{.sample} option)
        to be enabled.)

    '`none (`{.sample}*`none`{.sample}*`)`{.sample}'

    :   Do not consider any partitions.

    '`all (`{.sample}*`all`{.sample}*`)`{.sample}'

    :   Consider every partition.

`direct-pred (`{.sample}*`direct`{.sample}*`)`{.sample}

:   Set direct MV prediction mode. Possible values:

    '`none (`{.sample}*`none`{.sample}*`)`{.sample}'

    :   Disable MV prediction.

    '`spatial (`{.sample}*`spatial`{.sample}*`)`{.sample}'

    :   Enable spatial predicting.

    '`temporal (`{.sample}*`temporal`{.sample}*`)`{.sample}'

    :   Enable temporal predicting.

    '`auto (`{.sample}*`auto`{.sample}*`)`{.sample}'

    :   Automatically decided.

`slice-max-size (`{.sample}*`slice-max-size`{.sample}*`)`{.sample}

:   Set the limit of the size of each slice in bytes. If not specified
    but RTP payload size (`ps`{.sample}) is specified, that is used.

`stats (`{.sample}*`stats`{.sample}*`)`{.sample}

:   Set the file name for multi-pass stats.

`nal-hrd (`{.sample}*`nal-hrd`{.sample}*`)`{.sample}

:   Set signal HRD information (requires `vbv-bufsize`{.sample} to be
    set). Possible values:

    '`none (`{.sample}*`none`{.sample}*`)`{.sample}'

    :   Disable HRD information signaling.

    '`vbr (`{.sample}*`vbr`{.sample}*`)`{.sample}'

    :   Variable bit rate.

    '`cbr (`{.sample}*`cbr`{.sample}*`)`{.sample}'

    :   Constant bit rate (not allowed in MP4 container).

`x264opts `{.sample}`opts`{.variable}\
`x264-params `{.sample}`opts`{.variable}

:   Override the x264 configuration using a :-separated list of
    key=value options.

    The argument for both options is a list of
    `key`{.variable}=`value`{.variable} couples separated by \":\". With
    `x264opts`{.sample} the value can be omitted, and the value `1` is
    assumed in that case.

    For `filter`{.variable} and `psy-rd`{.variable} options values that
    use \":\" as a separator themselves, use \",\" instead. They accept
    it as well since long ago but this is kept undocumented for some
    reason.

    For example, the options might be provided as:

    ::: example
    ``` example
    level=30:bframes=0:weightp=0:cabac=0:ref=1:vbv-maxrate=768:vbv-bufsize=2000:analyse=all:me=umh:no-fast-pskip=1:subq=6:8x8dct=0:trellis=0
    ```
    :::

    For example to specify libx264 encoding options with `ffmpeg`:

    ::: example
    ``` example
    ffmpeg -i foo.mpg -c:v libx264 -x264opts keyint=123:min-keyint=20 -an out.mkv
    ```
    :::

    To get the complete list of the libx264 options, invoke the command
    `x264 --fullhelp` or consult the libx264 documentation.

`a53cc `{.sample}`boolean`{.variable}

:   Import closed captions (which must be ATSC compatible format) into
    output. Only the mpeg2 and h264 decoders provide these. Default is 1
    (on).

`udu_sei `{.sample}`boolean`{.variable}

:   Import user data unregistered SEI if available into output. Default
    is 0 (off).

`mb_info `{.sample}`boolean`{.variable}

:   Set mb_info data through AVFrameSideData, only useful when used from
    the API. Default is 0 (off).

Encoding ffpresets for common usages are provided so they can be used
with the general presets system (e.g. passing the `pre`{.sample}
option).

[]{#libx265}

### [16.20 libx265](#toc-libx265) {#libx265 .section}

x265 H.265/HEVC encoder wrapper.

This encoder requires the presence of the libx265 headers and library
during configuration. You need to explicitly configure the build with
`--enable-libx265`{.sample}.

[]{#Options-43}

#### [16.20.1 Options](#toc-Options-43) {#options-43 .subsection}

`b`{.sample}

:   Sets target video bitrate.

`bf`{.sample}\
`g`{.sample}

:   Set the GOP size.

`keyint_min`{.sample}

:   Minimum GOP size.

`refs`{.sample}

:   Number of reference frames each P-frame can use. The range is from
    `1-16`{.variable}.

`preset`{.sample}

:   Set the x265 preset.

`tune`{.sample}

:   Set the x265 tune parameter.

`profile`{.sample}

:   Set profile restrictions.

`crf`{.sample}

:   Set the quality for constant quality mode.

`qp`{.sample}

:   Set constant quantization rate control method parameter.

`qmin`{.sample}

:   Minimum quantizer scale.

`qmax`{.sample}

:   Maximum quantizer scale.

`qdiff`{.sample}

:   Maximum difference between quantizer scales.

`qblur`{.sample}

:   Quantizer curve blur

`qcomp`{.sample}

:   Quantizer curve compression factor

`i_qfactor`{.sample}\
`b_qfactor`{.sample}\
`forced-idr`{.sample}

:   Normally, when forcing a I-frame type, the encoder can select any
    type of I-frame. This option forces it to choose an IDR-frame.

`x265-stats`{.sample}

:   Specify the file name for 2-pass stats. This is set automatically
    when using the `-passlogfile`{.sample} option.

`udu_sei `{.sample}`boolean`{.variable}

:   Import user data unregistered SEI if available into output. Default
    is 0 (off).

`x265-params`{.sample}

:   Set x265 options using a list of `key`{.variable}=`value`{.variable}
    couples separated by \":\". See `x265 --help` for a list of options.

    For example to specify libx265 encoding options with
    `-x265-params`{.sample}:

    ::: example
    ``` example
    ffmpeg -i input -c:v libx265 -x265-params crf=26:psy-rd=1 output.mp4
    ```
    :::

[]{#libxavs2}

### [16.21 libxavs2](#toc-libxavs2) {#libxavs2 .section}

xavs2 AVS2-P2/IEEE1857.4 encoder wrapper.

This encoder requires the presence of the libxavs2 headers and library
during configuration. You need to explicitly configure the build with
`--enable-libxavs2`{.sample}.

The following standard libavcodec options are used:

- `b`{.sample} / `bit_rate`{.sample}
- `g`{.sample} / `gop_size`{.sample}
- `bf`{.sample} / `max_b_frames`{.sample}

The encoder also has its own specific options:

[]{#Options-44}

#### [16.21.1 Options](#toc-Options-44) {#options-44 .subsection}

`lcu_row_threads`{.sample}

:   Set the number of parallel threads for rows from 1 to 8 (default 5).

`initial_qp`{.sample}

:   Set the xavs2 quantization parameter from 1 to 63 (default 34). This
    is used to set the initial qp for the first frame.

`qp`{.sample}

:   Set the xavs2 quantization parameter from 1 to 63 (default 34). This
    is used to set the qp value under constant-QP mode.

`max_qp`{.sample}

:   Set the max qp for rate control from 1 to 63 (default 55).

`min_qp`{.sample}

:   Set the min qp for rate control from 1 to 63 (default 20).

`speed_level`{.sample}

:   Set the Speed level from 0 to 9 (default 0). Higher is better but
    slower.

`log_level`{.sample}

:   Set the log level from -1 to 3 (default 0). -1: none, 0: error, 1:
    warning, 2: info, 3: debug.

`xavs2-params`{.sample}

:   Set xavs2 options using a list of
    `key`{.variable}=`value`{.variable} couples separated by \":\".

    For example to specify libxavs2 encoding options with
    `-xavs2-params`{.sample}:

    ::: example
    ``` example
    ffmpeg -i input -c:v libxavs2 -xavs2-params RdoqLevel=0 output.avs2
    ```
    :::

[]{#libxeve}

### [16.22 libxeve](#toc-libxeve) {#libxeve .section}

eXtra-fast Essential Video Encoder (XEVE) MPEG-5 EVC encoder wrapper.
The xeve-equivalent options or values are listed in parentheses for easy
migration.

This encoder requires the presence of the libxeve headers and library
during configuration. You need to explicitly configure the build with
`--enable-libxeve`{.sample}.

::: info
Many libxeve encoder options are mapped to FFmpeg global codec options,
while unique encoder options are provided through private options.
Additionally the xeve-params private options allows one to pass a list
of key=value tuples as accepted by the libxeve `parse_xeve_params`
function.
:::

The xeve project website is at <https://github.com/mpeg5/xeve>.

[]{#Options-45}

#### [16.22.1 Options](#toc-Options-45) {#options-45 .subsection}

The following options are supported by the libxeve wrapper. The
xeve-equivalent options or values are listed in parentheses for easy
migration.

::: info
To reduce the duplication of documentation, only the private options and
some others requiring special attention are documented here. For the
documentation of the undocumented generic options, see [the Codec
Options chapter](#codec_002doptions).
:::

::: info
To get a more accurate and extensive documentation of the libxeve
options, invoke the command `xeve_app --help` or consult the libxeve
documentation.
:::

`b (`{.sample}*`bitrate`{.sample}*`)`{.sample}

:   Set target video bitrate in bits/s. Note that FFmpeg's b option is
    expressed in bits/s, while xeve's bitrate is in kilobits/s.

`bf (`{.sample}*`bframes`{.sample}*`)`{.sample}

:   Set the maximum number of B frames (1,3,7,15).

`g (`{.sample}*`keyint`{.sample}*`)`{.sample}

:   Set the GOP size (I-picture period).

`preset (`{.sample}*`preset`{.sample}*`)`{.sample}

:   Set the xeve preset. Set the encoder preset value to determine
    encoding speed \[fast, medium, slow, placebo\]

`tune (`{.sample}*`tune`{.sample}*`)`{.sample}

:   Set the encoder tune parameter \[psnr, zerolatency\]

`profile (`{.sample}*`profile`{.sample}*`)`{.sample}

:   Set the encoder profile \[0: baseline; 1: main\]

`crf (`{.sample}*`crf`{.sample}*`)`{.sample}

:   Set the quality for constant quality mode. Constant rate factor
    \<10..49\> \[default: 32\]

`qp (`{.sample}*`qp`{.sample}*`)`{.sample}

:   Set constant quantization rate control method parameter.
    Quantization parameter qp \<0..51\> \[default: 32\]

`threads (`{.sample}*`threads`{.sample}*`)`{.sample}

:   Force to use a specific number of threads

[]{#libxvid}

### [16.23 libxvid](#toc-libxvid) {#libxvid .section}

Xvid MPEG-4 Part 2 encoder wrapper.

This encoder requires the presence of the libxvidcore headers and
library during configuration. You need to explicitly configure the build
with `--enable-libxvid --enable-gpl`.

The native `mpeg4` encoder supports the MPEG-4 Part 2 format, so users
can encode to this format without this library.

[]{#Options-46}

#### [16.23.1 Options](#toc-Options-46) {#options-46 .subsection}

The following options are supported by the libxvid wrapper. Some of the
following options are listed but are not documented, and correspond to
shared codec options. See [the Codec Options
chapter](#codec_002doptions) for their documentation. The other shared
options which are not listed have no effect for the libxvid encoder.

`b`{.sample}\
`g`{.sample}\
`qmin`{.sample}\
`qmax`{.sample}\
`mpeg_quant`{.sample}\
`threads`{.sample}\
`bf`{.sample}\
`b_qfactor`{.sample}\
`b_qoffset`{.sample}\
`flags`{.sample}

:   Set specific encoding flags. Possible values:

    '`mv4`{.sample}'

    :   Use four motion vector by macroblock.

    '`aic`{.sample}'

    :   Enable high quality AC prediction.

    '`gray`{.sample}'

    :   Only encode grayscale.

    '`qpel`{.sample}'

    :   Enable quarter-pixel motion compensation.

    '`cgop`{.sample}'

    :   Enable closed GOP.

    '`global_header`{.sample}'

    :   Place global headers in extradata instead of every keyframe.

`gmc`{.sample}

:   Enable the use of global motion compensation (GMC). Default is 0
    (disabled).

`me_quality`{.sample}

:   Set motion estimation quality level. Possible values in decreasing
    order of speed and increasing order of quality:

    '`0`{.sample}'

    :   Use no motion estimation (default).

    '`1, 2`{.sample}'

    :   Enable advanced diamond zonal search for 16x16 blocks and
        half-pixel refinement for 16x16 blocks.

    '`3, 4`{.sample}'

    :   Enable all of the things described above, plus advanced diamond
        zonal search for 8x8 blocks and half-pixel refinement for 8x8
        blocks, also enable motion estimation on chroma planes for P and
        B-frames.

    '`5, 6`{.sample}'

    :   Enable all of the things described above, plus extended 16x16
        and 8x8 blocks search.

`mbd`{.sample}

:   Set macroblock decision algorithm. Possible values in the increasing
    order of quality:

    '`simple`{.sample}'

    :   Use macroblock comparing function algorithm (default).

    '`bits`{.sample}'

    :   Enable rate distortion-based half pixel and quarter pixel
        refinement for 16x16 blocks.

    '`rd`{.sample}'

    :   Enable all of the things described above, plus rate
        distortion-based half pixel and quarter pixel refinement for 8x8
        blocks, and rate distortion-based search using square pattern.

`lumi_aq`{.sample}

:   Enable lumi masking adaptive quantization when set to 1. Default is
    0 (disabled).

`variance_aq`{.sample}

:   Enable variance adaptive quantization when set to 1. Default is 0
    (disabled).

    When combined with `lumi_aq`{.sample}, the resulting quality will
    not be better than any of the two specified individually. In other
    words, the resulting quality will be the worse one of the two
    effects.

`trellis`{.sample}

:   Set rate-distortion optimal quantization.

`ssim`{.sample}

:   Set structural similarity (SSIM) displaying method. Possible values:

    '`off`{.sample}'

    :   Disable displaying of SSIM information.

    '`avg`{.sample}'

    :   Output average SSIM at the end of encoding to stdout. The format
        of showing the average SSIM is:

        ::: example
        ``` example
        Average SSIM: %f
        ```
        :::

        For users who are not familiar with C, %f means a float number,
        or a decimal (e.g. 0.939232).

    '`frame`{.sample}'

    :   Output both per-frame SSIM data during encoding and average SSIM
        at the end of encoding to stdout. The format of per-frame
        information is:

        ::: example
        ``` example
               SSIM: avg: %1.3f min: %1.3f max: %1.3f
        ```
        :::

        For users who are not familiar with C, %1.3f means a float
        number rounded to 3 digits after the dot (e.g. 0.932).

`ssim_acc`{.sample}

:   Set SSIM accuracy. Valid options are integers within the range of
    0-4, while 0 gives the most accurate result and 4 computes the
    fastest.

[]{#MediaCodec}

### [16.24 MediaCodec](#toc-MediaCodec) {#mediacodec .section}

MediaCodec encoder wrapper enables hardware-accelerated video encoding
on Android device. It supports H.264, H.265 (HEVC), VP8, VP9, MPEG-4,
and AV1 encoding (whether works or not is device dependent).

Android provides two sets of APIs: Java MediaCodec and NDK MediaCodec.
The MediaCodec encoder wrapper supports both. Note that the NDK
MediaCodec API operates without requiring JVM, but may fail to function
outside the JVM environment due to dependencies on system framework
services, particularly after Android 15.

`ndk_codec `{.sample}`boolean`{.variable}

:   Use the NDK-based MediaCodec API instead of the Java API. Enabled by
    default if `av_jni_get_java_vm()` return NULL.

`ndk_async `{.sample}`boolean`{.variable}

:   Use NDK MediaCodec in async mode. Async mode has less overhead than
    poll in a loop in sync mode. The drawback of async mode is
    AV_CODEC_FLAG_GLOBAL_HEADER doesn't work (use extract_extradata bsf
    when necessary). It doesn't work and will be disabled automatically
    on devices below Android 8.0.

`codec_name `{.sample}`string`{.variable}

:   A codec type can have multiple implementations on a single device,
    this option specify which backend to use (via MediaCodec
    createCodecByName API). It's NULL by default, and encoder is created
    by createEncoderByType.

`bitrate_mode `{.sample}`integer`{.variable}

:   Possible values:

    '`cq`{.sample}'

    :   Constant quality mode

    '`vbr`{.sample}'

    :   Variable bitrate mode

    '`cbr`{.sample}'

    :   Constant bitrate mode

    '`cbr_fd`{.sample}'

    :   Constant bitrate mode with frame drops

`pts_as_dts `{.sample}`boolean`{.variable}

:   Use PTS as DTS. This is a workaround since MediaCodec API doesn't
    provide decoding timestamp. It is enabled automatically if B frame
    is 0.

`operating_rate `{.sample}`integer`{.variable}

:   The desired operating rate that the codec will need to operate at,
    zero for unspecified. This is used for cases like
    high-speed/slow-motion video capture, where the video encoder format
    contains the target playback rate (e.g. 30fps), but the component
    must be able to handle the high operating capture rate (e.g.
    240fps). This rate will be used by codec for resource planning and
    setting the operating points.

`qp_i_min `{.sample}`integer`{.variable}

:   Minimum quantization parameter for I frame.

`qp_p_min `{.sample}`integer`{.variable}

:   Minimum quantization parameter for P frame.

`qp_b_min `{.sample}`integer`{.variable}

:   Minimum quantization parameter for B frame.

`qp_i_max `{.sample}`integer`{.variable}

:   Maximum quantization parameter for I frame.

`qp_p_max `{.sample}`integer`{.variable}

:   Maximum quantization parameter for P frame.

`qp_b_max `{.sample}`integer`{.variable}

:   Maximum quantization parameter for B frame.

[]{#MediaFoundation}

### [16.25 MediaFoundation](#toc-MediaFoundation) {#mediafoundation .section}

The following wrappers for encoders in the MediaFoundation framework are
available:

- h264_mf
- hevc_mf
- av1_mf

These support both software and hardware encoding.

Video encoders can take input in either of nv12 or yuv420p form (some
encoders support both, some support only either - in practice, nv12 is
the safer choice, especially among HW encoders).

Hardware-accelerated encoding requires D3D11, including hardware scaling
capabilities through the scale_d3d11 filter.

To list all available options for the MediaFoundation encoders, use:
`ffmpeg -h encoder=<encoder>` e.g. `ffmpeg -h encoder=h264_mf`

[]{#Options-47}

#### [16.25.1 Options](#toc-Options-47) {#options-47 .subsection}

`rate_control`{.sample}

:   Select rate control mode. Available modes:

    '`default`{.sample}'

    :   Default mode

    '`cbr`{.sample}'

    :   CBR mode

    '`pc_vbr`{.sample}'

    :   Peak constrained VBR mode

    '`u_vbr`{.sample}'

    :   Unconstrained VBR mode

    '`quality`{.sample}'

    :   Quality mode

    '`ld_vbr`{.sample}'

    :   Low delay VBR mode (requires Windows 8+)

    '`g_vbr`{.sample}'

    :   Global VBR mode (requires Windows 8+)

    '`gld_vbr`{.sample}'

    :   Global low delay VBR mode (requires Windows 8+)

`scenario`{.sample}

:   Select usage scenario. Available scenarios:

    '`default`{.sample}'

    :   Default scenario

    '`display_remoting`{.sample}'

    :   Display remoting scenario

    '`video_conference`{.sample}'

    :   Video conference scenario

    '`archive`{.sample}'

    :   Archive scenario

    '`live_streaming`{.sample}'

    :   Live streaming scenario

    '`camera_record`{.sample}'

    :   Camera record scenario

    '`display_remoting_with_feature_map`{.sample}'

    :   Display remoting with feature map scenario

`quality`{.sample}

:   Set encoding quality (0-100). -1 means default quality.

`hw_encoding`{.sample}

:   Force hardware encoding (0-1). Default is 0 (disabled).

[]{#Examples-6}

#### [16.25.2 Examples](#toc-Examples-6) {#examples-6 .subsection}

Hardware encoding:

::: example
``` example
ffmpeg -i input.mp4 -c:v h264_mf -hw_encoding 1 output.mp4
```
:::

Hardware-accelerated decoding with hardware encoding:

::: example
``` example
ffmpeg -hwaccel d3d11va -i input.mp4 -c:v h264_mf -hw_encoding 1 output.mp4
```
:::

Hardware-accelerated decoding, HW scaling and encoding with quality
setting:

::: example
``` example
ffmpeg -hwaccel d3d11va -hwaccel_output_format d3d11 -i input.mp4 -vf scale_d3d11=1920:1080 -c:v hevc_mf -hw_encoding 1 -quality 80 output.mp4
```
:::

[]{#Microsoft-RLE}

### [16.26 Microsoft RLE](#toc-Microsoft-RLE) {#microsoft-rle .section}

Microsoft RLE aka MSRLE encoder. Only 8-bit palette mode supported.
Compatible with Windows 3.1 and Windows 95.

[]{#Options-48}

#### [16.26.1 Options](#toc-Options-48) {#options-48 .subsection}

`g `{.sample}`integer`{.variable}

:   Keyframe interval. A keyframe is inserted at least every `-g`
    frames, sometimes sooner.

[]{#mpeg2}

### [16.27 mpeg2](#toc-mpeg2) {#mpeg2 .section}

MPEG-2 video encoder.

[]{#Options-49}

#### [16.27.1 Options](#toc-Options-49) {#options-49 .subsection}

`profile`{.sample}

Select the mpeg2 profile to encode:

'`422`{.sample}'

'`high`{.sample}'

'`ss`{.sample}'

Spatially Scalable

'`snr`{.sample}'

SNR Scalable

'`main`{.sample}'

'`simple`{.sample}'

`level`{.sample}

Select the mpeg2 level to encode:

'`high`{.sample}'

'`high1440`{.sample}'

'`main`{.sample}'

'`low`{.sample}'

`seq_disp_ext `{.sample}`integer`{.variable}

Specifies if the encoder should write a sequence_display_extension to
the output.

`-1`{.sample}\
`auto`{.sample}

:   Decide automatically to write it or not (this is the default) by
    checking if the data to be written is different from the default or
    unspecified values.

`0`{.sample}\
`never`{.sample}

:   Never write it.

`1`{.sample}\
`always`{.sample}

:   Always write it.

`video_format `{.sample}`integer`{.variable}

Specifies the video_format written into the sequence display extension
indicating the source of the video pictures. The default is
'`unspecified`{.sample}', can be '`component`{.sample}',
'`pal`{.sample}', '`ntsc`{.sample}', '`secam`{.sample}' or
'`mac`{.sample}'. For maximum compatibility, use '`component`{.sample}'.

`a53cc `{.sample}`boolean`{.variable}

Import closed captions (which must be ATSC compatible format) into
output. Default is 1 (on).

[]{#png}

### [16.28 png](#toc-png) {#png .section}

PNG image encoder.

[]{#Options-50}

#### [16.28.1 Options](#toc-Options-50) {#options-50 .subsection}

`compression_level`{.sample}

:   Sets the compression level, from 0 to 9(default)

[]{#Private-options-1}

#### [16.28.2 Private options](#toc-Private-options-1) {#private-options-1 .subsection}

`dpi `{.sample}`integer`{.variable}

:   Set physical density of pixels, in dots per inch, unset by default

`dpm `{.sample}`integer`{.variable}

:   Set physical density of pixels, in dots per meter, unset by default

`pred `{.sample}`method`{.variable}

:   Set prediction method (none, sub, up, avg, paeth, mixed), default is
    paeth

[]{#ProRes}

### [16.29 ProRes](#toc-ProRes) {#prores .section}

Apple ProRes encoder.

FFmpeg contains 2 ProRes encoders, the prores-aw and prores-ks encoder.
The used encoder can be chosen with the `-vcodec` option.

[]{#Private-Options-for-prores_002dks}

#### [16.29.1 Private Options for prores-ks](#toc-Private-Options-for-prores_002dks) {#private-options-for-prores-ks .subsection}

`profile `{.sample}`integer`{.variable}

Select the ProRes profile to encode

'`proxy`{.sample}'

'`lt`{.sample}'

'`standard`{.sample}'

'`hq`{.sample}'

'`4444`{.sample}'

'`4444xq`{.sample}'

`quant_mat `{.sample}`integer`{.variable}

Select quantization matrix.

'`auto`{.sample}'

'`default`{.sample}'

'`proxy`{.sample}'

'`lt`{.sample}'

'`standard`{.sample}'

'`hq`{.sample}'

If set to `auto`{.variable}, the matrix matching the profile will be
picked. If not set, the matrix providing the highest quality,
`default`{.variable}, will be picked.

`bits_per_mb `{.sample}`integer`{.variable}

How many bits to allot for coding one macroblock. Different profiles use
between 200 and 2400 bits per macroblock, the maximum is 8000.

`mbs_per_slice `{.sample}`integer`{.variable}

Number of macroblocks in each slice (1-8); the default value (8) should
be good in almost all situations.

`vendor `{.sample}`string`{.variable}

Override the 4-byte vendor ID. A custom vendor ID like `apl0`{.variable}
would claim the stream was produced by the Apple encoder.

`alpha_bits `{.sample}`integer`{.variable}

Specify number of bits for alpha component. Possible values are
`0`{.variable}, `8`{.variable} and `16`{.variable}. Use `0`{.variable}
to disable alpha plane coding.

[]{#Speed-considerations}

#### [16.29.2 Speed considerations](#toc-Speed-considerations) {#speed-considerations .subsection}

In the default mode of operation the encoder has to honor frame
constraints (i.e. not produce frames with size bigger than requested)
while still making output picture as good as possible. A frame
containing a lot of small details is harder to compress and the encoder
would spend more time searching for appropriate quantizers for each
slice.

Setting a higher `bits_per_mb`{.sample} limit will improve the speed.

For the fastest encoding speed set the `qscale`{.sample} parameter (4 is
the recommended value) and do not set a size constraint.

[]{#QSV-Encoders}

### [16.30 QSV Encoders](#toc-QSV-Encoders) {#qsv-encoders .section}

The family of Intel QuickSync Video encoders (MPEG-2, H.264, HEVC,
JPEG/MJPEG, VP9, AV1)

[]{#Ratecontrol-Method}

#### [16.30.1 Ratecontrol Method](#toc-Ratecontrol-Method) {#ratecontrol-method .subsection}

The ratecontrol method is selected as follows:

- When `global_quality`{.sample} is specified, a quality-based mode is
  used. Specifically this means either
  - \- `CQP`{.variable} - constant quantizer scale, when the
    `qscale`{.sample} codec flag is also set (the `-qscale`{.sample}
    ffmpeg option).
  - \- `LA_ICQ`{.variable} - intelligent constant quality with
    lookahead, when the `look_ahead`{.sample} option is also set.
  - \- `ICQ`{.variable} -- intelligent constant quality otherwise. For
    the ICQ modes, global quality range is 1 to 51, with 1 being the
    best quality.
- Otherwise when the desired average bitrate is specified with the
  `b`{.sample} option, a bitrate-based mode is used.
  - \- `LA`{.variable} - VBR with lookahead, when the
    `look_ahead`{.sample} option is specified.
  - \- `VCM`{.variable} - video conferencing mode, when the
    `vcm`{.sample} option is set.
  - \- `CBR`{.variable} - constant bitrate, when `maxrate`{.sample} is
    specified and equal to the average bitrate.
  - \- `VBR`{.variable} - variable bitrate, when `maxrate`{.sample} is
    specified, but is higher than the average bitrate.
  - \- `AVBR`{.variable} - average VBR mode, when `maxrate`{.sample} is
    not specified, both `avbr_accuracy`{.sample} and
    `avbr_convergence`{.sample} are set to non-zero. This mode is
    available for H264 and HEVC on Windows.
- Otherwise the default ratecontrol method `CQP`{.variable} is used.

Note that depending on your system, a different mode than the one you
specified may be selected by the encoder. Set the verbosity level to
`verbose`{.variable} or higher to see the actual settings used by the
QSV runtime.

[]{#Global-Options-_002d_003e-MSDK-Options}

#### [16.30.2 Global Options -\> MSDK Options](#toc-Global-Options-_002d_003e-MSDK-Options) {#global-options---msdk-options .subsection}

Additional libavcodec global options are mapped to MSDK options as
follows:

- `g/gop_size`{.sample} -\> `GopPicSize`{.sample}
- `bf/max_b_frames`{.sample}+1 -\> `GopRefDist`{.sample}
- `rc_init_occupancy/rc_initial_buffer_occupancy`{.sample} -\>
  `InitialDelayInKB`{.sample}
- `slices`{.sample} -\> `NumSlice`{.sample}
- `refs`{.sample} -\> `NumRefFrame`{.sample}
- `b_strategy/b_frame_strategy`{.sample} -\> `BRefType`{.sample}
- `cgop/CLOSED_GOP`{.sample} codec flag -\> `GopOptFlag`{.sample}
- For the `CQP`{.variable} mode, the `i_qfactor/i_qoffset`{.sample} and
  `b_qfactor/b_qoffset`{.sample} set the difference between
  `QPP`{.variable} and `QPI`{.variable}, and `QPP`{.variable} and
  `QPB`{.variable} respectively.
- Setting the `coder`{.sample} option to the value `vlc`{.variable} will
  make the H.264 encoder use CAVLC instead of CABAC.

[]{#Common-Options-1}

#### [16.30.3 Common Options](#toc-Common-Options-1) {#common-options-1 .subsection}

Following options are used by all qsv encoders.

`async_depth`{.variable}

Specifies how many asynchronous operations an application performs
before the application explicitly synchronizes the result. If zero, the
value is not specified.

`preset`{.variable}

This option itemizes a range of choices from veryfast (best speed) to
veryslow (best quality).

'`veryfast`{.sample}'

'`faster`{.sample}'

'`fast`{.sample}'

'`medium`{.sample}'

'`slow`{.sample}'

'`slower`{.sample}'

'`veryslow`{.sample}'

`forced_idr`{.variable}

Forcing I frames as IDR frames.

`low_power`{.variable}

For encoders set this flag to ON to reduce power consumption and GPU
usage.

[]{#Runtime-Options}

#### [16.30.4 Runtime Options](#toc-Runtime-Options) {#runtime-options .subsection}

Following options can be used during qsv encoding.

`global_quality`{.variable}\
`i_quant_factor`{.variable}\
`i_quant_offset`{.variable}\
`b_quant_factor`{.variable}\
`b_quant_offset`{.variable}

:   Supported in h264_qsv and hevc_qsv. Change these value to reset qsv
    codec's qp configuration.

`max_frame_size`{.variable}

:   Supported in h264_qsv and hevc_qsv. Change this value to reset qsv
    codec's MaxFrameSize configuration.

`gop_size`{.variable}

:   Change this value to reset qsv codec's gop configuration.

`int_ref_type`{.variable}\
`int_ref_cycle_size`{.variable}\
`int_ref_qp_delta`{.variable}\
`int_ref_cycle_dist`{.variable}

:   Supported in h264_qsv and hevc_qsv. Change these value to reset qsv
    codec's Intra Refresh configuration.

`qmax`{.variable}\
`qmin`{.variable}\
`max_qp_i`{.variable}\
`min_qp_i`{.variable}\
`max_qp_p`{.variable}\
`min_qp_p`{.variable}\
`max_qp_b`{.variable}\
`min_qp_b`{.variable}

:   Supported in h264_qsv. Change these value to reset qsv codec's
    max/min qp configuration.

`low_delay_brc`{.variable}

:   Supported in h264_qsv, hevc_qsv and av1_qsv. Change this value to
    reset qsv codec's low_delay_brc configuration.

`framerate`{.variable}

:   Change this value to reset qsv codec's framerate configuration.

`bit_rate`{.variable}\
`rc_buffer_size`{.variable}\
`rc_initial_buffer_occupancy`{.variable}\
`rc_max_rate`{.variable}

:   Change these value to reset qsv codec's bitrate control
    configuration.

`pic_timing_sei`{.variable}

:   Supported in h264_qsv and hevc_qsv. Change this value to reset qsv
    codec's pic_timing_sei configuration.

`qsv_params`{.variable}

:   Set QSV encoder parameters as a colon-separated list of key-value
    pairs.

    The `qsv_params`{.sample} should be formatted as
    `key1=value1:key2=value2:...`.

    These parameters are passed directly to the underlying Intel Quick
    Sync Video (QSV) encoder using the MFXSetParameter function.

    Example:

    ::: example
    ``` example
    ffmpeg -i input.mp4 -c:v h264_qsv -qsv_params "CodingOption1=1:CodingOption2=2" output.mp4
    ```
    :::

    This option allows fine-grained control over various
    encoder-specific settings provided by the QSV encoder.

[]{#H264-options}

#### [16.30.5 H264 options](#toc-H264-options) {#h264-options .subsection}

These options are used by h264_qsv

`extbrc`{.variable}

Extended bitrate control.

`recovery_point_sei`{.variable}

Set this flag to insert the recovery point SEI message at the beginning
of every intra refresh cycle.

`rdo`{.variable}

Enable rate distortion optimization.

`max_frame_size`{.variable}

Maximum encoded frame size in bytes.

`max_frame_size_i`{.variable}

Maximum encoded frame size for I frames in bytes. If this value is set
as larger than zero, then for I frames the value set by max_frame_size
is ignored.

`max_frame_size_p`{.variable}

Maximum encoded frame size for P frames in bytes. If this value is set
as larger than zero, then for P frames the value set by max_frame_size
is ignored.

`max_slice_size`{.variable}

Maximum encoded slice size in bytes.

`bitrate_limit`{.variable}

Toggle bitrate limitations. Modifies bitrate to be in the range imposed
by the QSV encoder. Setting this flag off may lead to violation of HRD
conformance. Mind that specifying bitrate below the QSV encoder range
might significantly affect quality. If on this option takes effect in
non CQP modes: if bitrate is not in the range imposed by the QSV
encoder, it will be changed to be in the range.

`mbbrc`{.variable}

Setting this flag enables macroblock level bitrate control that
generally improves subjective visual quality. Enabling this flag may
have negative impact on performance and objective visual quality metric.

`low_delay_brc`{.variable}

Setting this flag turns on or off LowDelayBRC feature in qsv plugin,
which provides more accurate bitrate control to minimize the variance of
bitstream size frame by frame. Value: -1-default 0-off 1-on

`adaptive_i`{.variable}

This flag controls insertion of I frames by the QSV encoder. Turn ON
this flag to allow changing of frame type from P and B to I.

`adaptive_b`{.variable}

This flag controls changing of frame type from B to P.

`p_strategy`{.variable}

Enable P-pyramid: 0-default 1-simple 2-pyramid(bf need to be set to 0).

`b_strategy`{.variable}

This option controls usage of B frames as reference.

`dblk_idc`{.variable}

This option disable deblocking. It has value in range 0\~2.

`cavlc`{.variable}

If set, CAVLC is used; if unset, CABAC is used for encoding.

`vcm`{.variable}

Video conferencing mode, please see ratecontrol method.

`idr_interval`{.variable}

Distance (in I-frames) between IDR frames.

`pic_timing_sei`{.variable}

Insert picture timing SEI with pic_struct_syntax element.

`single_sei_nal_unit`{.variable}

Put all the SEI messages into one NALU.

`max_dec_frame_buffering`{.variable}

Maximum number of frames buffered in the DPB.

`look_ahead`{.variable}

Use VBR algorithm with look ahead.

`look_ahead_depth`{.variable}

Depth of look ahead in number frames.

`look_ahead_downsampling`{.variable}

Downscaling factor for the frames saved for the lookahead analysis.

'`unknown`{.sample}'

'`auto`{.sample}'

'`off`{.sample}'

'`2x`{.sample}'

'`4x`{.sample}'

`int_ref_type`{.variable}

Specifies intra refresh type. The major goal of intra refresh is
improvement of error resilience without significant impact on encoded
bitstream size caused by I frames. The SDK encoder achieves this by
encoding part of each frame in refresh cycle using intra MBs.
`none`{.variable} means no refresh. `vertical`{.variable} means vertical
refresh, by column of MBs. `horizontal`{.variable} means horizontal
refresh, by rows of MBs. `slice`{.variable} means horizontal refresh by
slices without overlapping. In case of `slice`{.variable},
in_ref_cycle_size is ignored. To enable intra refresh, B frame should be
set to 0.

`int_ref_cycle_size`{.variable}

Specifies number of pictures within refresh cycle starting from 2. 0 and
1 are invalid values.

`int_ref_qp_delta`{.variable}

Specifies QP difference for inserted intra MBs. This is signed value in
\[-51, 51\] range if target encoding bit-depth for luma samples is 8 and
this range is \[-63, 63\] for 10 bit-depth or \[-75, 75\] for 12
bit-depth respectively.

`int_ref_cycle_dist`{.variable}

Distance between the beginnings of the intra-refresh cycles in frames.

`profile`{.variable}

'`unknown`{.sample}'

'`baseline`{.sample}'

'`main`{.sample}'

'`high`{.sample}'

`a53cc`{.variable}

Use A53 Closed Captions (if available).

`aud`{.variable}

Insert the Access Unit Delimiter NAL.

`mfmode`{.variable}

Multi-Frame Mode.

'`off`{.sample}'

'`auto`{.sample}'

`repeat_pps`{.variable}

Repeat pps for every frame.

`max_qp_i`{.variable}

Maximum video quantizer scale for I frame.

`min_qp_i`{.variable}

Minimum video quantizer scale for I frame.

`max_qp_p`{.variable}

Maximum video quantizer scale for P frame.

`min_qp_p`{.variable}

Minimum video quantizer scale for P frame.

`max_qp_b`{.variable}

Maximum video quantizer scale for B frame.

`min_qp_b`{.variable}

Minimum video quantizer scale for B frame.

`scenario`{.variable}

Provides a hint to encoder about the scenario for the encoding session.

'`unknown`{.sample}'

'`displayremoting`{.sample}'

'`videoconference`{.sample}'

'`archive`{.sample}'

'`livestreaming`{.sample}'

'`cameracapture`{.sample}'

'`videosurveillance`{.sample}'

'`gamestreaming`{.sample}'

'`remotegaming`{.sample}'

`avbr_accuracy`{.variable}

Accuracy of the AVBR ratecontrol (unit of tenth of percent).

`avbr_convergence`{.variable}

Convergence of the AVBR ratecontrol (unit of 100 frames)

The parameters `avbr_accuracy`{.variable} and
`avbr_convergence`{.variable} are for the average variable bitrate
control (AVBR) algorithm. The algorithm focuses on overall encoding
quality while meeting the specified bitrate,
`target_bitrate`{.variable}, within the accuracy range
`avbr_accuracy`{.variable}, after a `avbr_Convergence`{.variable}
period. This method does not follow HRD and the instant bitrate is not
capped or padded.

`skip_frame`{.variable}

Use per-frame metadata \"qsv_skip_frame\" to skip frame when encoding.
This option defines the usage of this metadata.

'`no_skip`{.sample}'

:   Frame skipping is disabled.

'`insert_dummy`{.sample}'

:   Encoder inserts into bitstream frame where all macroblocks are
    encoded as skipped.

'`insert_nothing`{.sample}'

:   Similar to insert_dummy, but encoder inserts nothing into bitstream.
    The skipped frames are still used in brc. For example, gop still
    include skipped frames, and the frames after skipped frames will be
    larger in size.

'`brc_only`{.sample}'

:   skip_frame metadata indicates the number of missed frames before the
    current frame.

[]{#HEVC-Options-1}

#### [16.30.6 HEVC Options](#toc-HEVC-Options-1) {#hevc-options-1 .subsection}

These options are used by hevc_qsv

`extbrc`{.variable}

Extended bitrate control.

`recovery_point_sei`{.variable}

Set this flag to insert the recovery point SEI message at the beginning
of every intra refresh cycle.

`rdo`{.variable}

Enable rate distortion optimization.

`max_frame_size`{.variable}

Maximum encoded frame size in bytes.

`max_frame_size_i`{.variable}

Maximum encoded frame size for I frames in bytes. If this value is set
as larger than zero, then for I frames the value set by max_frame_size
is ignored.

`max_frame_size_p`{.variable}

Maximum encoded frame size for P frames in bytes. If this value is set
as larger than zero, then for P frames the value set by max_frame_size
is ignored.

`max_slice_size`{.variable}

Maximum encoded slice size in bytes.

`mbbrc`{.variable}

Setting this flag enables macroblock level bitrate control that
generally improves subjective visual quality. Enabling this flag may
have negative impact on performance and objective visual quality metric.

`low_delay_brc`{.variable}

Setting this flag turns on or off LowDelayBRC feature in qsv plugin,
which provides more accurate bitrate control to minimize the variance of
bitstream size frame by frame. Value: -1-default 0-off 1-on

`adaptive_i`{.variable}

This flag controls insertion of I frames by the QSV encoder. Turn ON
this flag to allow changing of frame type from P and B to I.

`adaptive_b`{.variable}

This flag controls changing of frame type from B to P.

`p_strategy`{.variable}

Enable P-pyramid: 0-default 1-simple 2-pyramid(bf need to be set to 0).

`b_strategy`{.variable}

This option controls usage of B frames as reference.

`dblk_idc`{.variable}

This option disable deblocking. It has value in range 0\~2.

`idr_interval`{.variable}

Distance (in I-frames) between IDR frames.

'`begin_only`{.sample}'

:   Output an IDR-frame only at the beginning of the stream.

`load_plugin`{.variable}

A user plugin to load in an internal session.

'`none`{.sample}'

'`hevc_sw`{.sample}'

'`hevc_hw`{.sample}'

`load_plugins`{.variable}

A :-separate list of hexadecimal plugin UIDs to load in an internal
session.

`look_ahead_depth`{.variable}

Depth of look ahead in number frames, available when extbrc option is
enabled.

`profile`{.variable}

Set the encoding profile (scc requires libmfx \>= 1.32).

'`unknown`{.sample}'

'`main`{.sample}'

'`main10`{.sample}'

'`mainsp`{.sample}'

'`rext`{.sample}'

'`scc`{.sample}'

`tier`{.variable}

Set the encoding tier (only level \>= 4 can support high tier). This
option only takes effect when the level option is specified.

'`main`{.sample}'

'`high`{.sample}'

`gpb`{.variable}

1: GPB (generalized P/B frame)

0: regular P frame.

`tile_cols`{.variable}

Number of columns for tiled encoding.

`tile_rows`{.variable}

Number of rows for tiled encoding.

`aud`{.variable}

Insert the Access Unit Delimiter NAL.

`pic_timing_sei`{.variable}

Insert picture timing SEI with pic_struct_syntax element.

`transform_skip`{.variable}

Turn this option ON to enable transformskip. It is supported on platform
equal or newer than ICL.

`int_ref_type`{.variable}

Specifies intra refresh type. The major goal of intra refresh is
improvement of error resilience without significant impact on encoded
bitstream size caused by I frames. The SDK encoder achieves this by
encoding part of each frame in refresh cycle using intra MBs.
`none`{.variable} means no refresh. `vertical`{.variable} means vertical
refresh, by column of MBs. `horizontal`{.variable} means horizontal
refresh, by rows of MBs. `slice`{.variable} means horizontal refresh by
slices without overlapping. In case of `slice`{.variable},
in_ref_cycle_size is ignored. To enable intra refresh, B frame should be
set to 0.

`int_ref_cycle_size`{.variable}

Specifies number of pictures within refresh cycle starting from 2. 0 and
1 are invalid values.

`int_ref_qp_delta`{.variable}

Specifies QP difference for inserted intra MBs. This is signed value in
\[-51, 51\] range if target encoding bit-depth for luma samples is 8 and
this range is \[-63, 63\] for 10 bit-depth or \[-75, 75\] for 12
bit-depth respectively.

`int_ref_cycle_dist`{.variable}

Distance between the beginnings of the intra-refresh cycles in frames.

`max_qp_i`{.variable}

Maximum video quantizer scale for I frame.

`min_qp_i`{.variable}

Minimum video quantizer scale for I frame.

`max_qp_p`{.variable}

Maximum video quantizer scale for P frame.

`min_qp_p`{.variable}

Minimum video quantizer scale for P frame.

`max_qp_b`{.variable}

Maximum video quantizer scale for B frame.

`min_qp_b`{.variable}

Minimum video quantizer scale for B frame.

`scenario`{.variable}

Provides a hint to encoder about the scenario for the encoding session.

'`unknown`{.sample}'

'`displayremoting`{.sample}'

'`videoconference`{.sample}'

'`archive`{.sample}'

'`livestreaming`{.sample}'

'`cameracapture`{.sample}'

'`videosurveillance`{.sample}'

'`gamestreaming`{.sample}'

'`remotegaming`{.sample}'

`avbr_accuracy`{.variable}

Accuracy of the AVBR ratecontrol (unit of tenth of percent).

`avbr_convergence`{.variable}

Convergence of the AVBR ratecontrol (unit of 100 frames)

The parameters `avbr_accuracy`{.variable} and
`avbr_convergence`{.variable} are for the average variable bitrate
control (AVBR) algorithm. The algorithm focuses on overall encoding
quality while meeting the specified bitrate,
`target_bitrate`{.variable}, within the accuracy range
`avbr_accuracy`{.variable}, after a `avbr_Convergence`{.variable}
period. This method does not follow HRD and the instant bitrate is not
capped or padded.

`skip_frame`{.variable}

Use per-frame metadata \"qsv_skip_frame\" to skip frame when encoding.
This option defines the usage of this metadata.

'`no_skip`{.sample}'

:   Frame skipping is disabled.

'`insert_dummy`{.sample}'

:   Encoder inserts into bitstream frame where all macroblocks are
    encoded as skipped.

'`insert_nothing`{.sample}'

:   Similar to insert_dummy, but encoder inserts nothing into bitstream.
    The skipped frames are still used in brc. For example, gop still
    include skipped frames, and the frames after skipped frames will be
    larger in size.

'`brc_only`{.sample}'

:   skip_frame metadata indicates the number of missed frames before the
    current frame.

[]{#MPEG2-Options}

#### [16.30.7 MPEG2 Options](#toc-MPEG2-Options) {#mpeg2-options .subsection}

These options are used by mpeg2_qsv

`profile`{.variable}

'`unknown`{.sample}'

'`simple`{.sample}'

'`main`{.sample}'

'`high`{.sample}'

[]{#VP9-Options}

#### [16.30.8 VP9 Options](#toc-VP9-Options) {#vp9-options .subsection}

These options are used by vp9_qsv

`profile`{.variable}

'`unknown`{.sample}'

'`profile0`{.sample}'

'`profile1`{.sample}'

'`profile2`{.sample}'

'`profile3`{.sample}'

`tile_cols`{.variable}

Number of columns for tiled encoding (requires libmfx \>= 1.29).

`tile_rows`{.variable}

Number of rows for tiled encoding (requires libmfx \>= 1.29).

[]{#AV1-Options}

#### [16.30.9 AV1 Options](#toc-AV1-Options) {#av1-options .subsection}

These options are used by av1_qsv (requires libvpl).

`profile`{.variable}

'`unknown`{.sample}'

'`main`{.sample}'

`tile_cols`{.variable}

Number of columns for tiled encoding.

`tile_rows`{.variable}

Number of rows for tiled encoding.

`adaptive_i`{.variable}

This flag controls insertion of I frames by the QSV encoder. Turn ON
this flag to allow changing of frame type from P and B to I.

`adaptive_b`{.variable}

This flag controls changing of frame type from B to P.

`b_strategy`{.variable}

This option controls usage of B frames as reference.

`extbrc`{.variable}

Extended bitrate control.

`look_ahead_depth`{.variable}

Depth of look ahead in number frames, available when extbrc option is
enabled.

`low_delay_brc`{.variable}

Setting this flag turns on or off LowDelayBRC feature in qsv plugin,
which provides more accurate bitrate control to minimize the variance of
bitstream size frame by frame. Value: -1-default 0-off 1-on

`max_frame_size`{.variable}

Set the allowed max size in bytes for each frame. If the frame size
exceeds the limitation, encoder will adjust the QP value to control the
frame size. Invalid in CQP rate control mode.

`max_frame_size_i`{.variable}

Maximum encoded frame size for I frames in bytes. If this value is set
as larger than zero, then for I frames the value set by max_frame_size
is ignored.

`max_frame_size_p`{.variable}

Maximum encoded frame size for P frames in bytes. If this value is set
as larger than zero, then for P frames the value set by max_frame_size
is ignored.

[]{#snow}

### [16.31 snow](#toc-snow) {#snow .section}

[]{#Options-51}

#### [16.31.1 Options](#toc-Options-51) {#options-51 .subsection}

`iterative_dia_size`{.sample}

:   dia size for the iterative motion estimation

[]{#VAAPI-encoders}

### [16.32 VAAPI encoders](#toc-VAAPI-encoders) {#vaapi-encoders .section}

Wrappers for hardware encoders accessible via VAAPI.

These encoders only accept input in VAAPI hardware surfaces. If you have
input in software frames, use the `hwupload`{.sample} filter to upload
them to the GPU.

The following standard libavcodec options are used:

- `g`{.sample} / `gop_size`{.sample}

- `bf`{.sample} / `max_b_frames`{.sample}

- `profile`{.sample}

  If not set, this will be determined automatically from the format of
  the input frames and the profiles supported by the driver.

- `level`{.sample}

- `b`{.sample} / `bit_rate`{.sample}

- `maxrate`{.sample} / `rc_max_rate`{.sample}

- `bufsize`{.sample} / `rc_buffer_size`{.sample}

- `rc_init_occupancy`{.sample} / `rc_initial_buffer_occupancy`{.sample}

- `compression_level`{.sample}

  Speed / quality tradeoff: higher values are faster / worse quality.

- `q`{.sample} / `global_quality`{.sample}

  Size / quality tradeoff: higher values are smaller / worse quality.

- `qmin`{.sample}

- `qmax`{.sample}

- `i_qfactor`{.sample} / `i_quant_factor`{.sample}

- `i_qoffset`{.sample} / `i_quant_offset`{.sample}

- `b_qfactor`{.sample} / `b_quant_factor`{.sample}

- `b_qoffset`{.sample} / `b_quant_offset`{.sample}

- `slices`{.sample}

All encoders support the following options:

`low_power`{.sample}

:   Some drivers/platforms offer a second encoder for some codecs
    intended to use less power than the default encoder; setting this
    option will attempt to use that encoder. Note that it may support a
    reduced feature set, so some other options may not be available in
    this mode.

`idr_interval`{.sample}

:   Set the number of normal intra frames between full-refresh (IDR)
    frames in open-GOP mode. The intra frames are still IRAPs, but will
    not include global headers and may have non-decodable leading
    pictures.

`b_depth`{.sample}

:   Set the B-frame reference depth. When set to one (the default), all
    B-frames will refer only to P- or I-frames. When set to greater
    values multiple layers of B-frames will be present, frames in each
    layer only referring to frames in higher layers.

`async_depth`{.sample}

:   Maximum processing parallelism. Increase this to improve single
    channel performance. This option doesn't work if driver doesn't
    implement vaSyncBuffer function. Please make sure there are enough
    hw_frames allocated if a large number of async_depth is used.

`max_frame_size`{.sample}

:   Set the allowed max size in bytes for each frame. If the frame size
    exceeds the limitation, encoder will adjust the QP value to control
    the frame size. Invalid in CQP rate control mode.

`rc_mode`{.sample}

:   Set the rate control mode to use. A given driver may only support a
    subset of modes.

    Possible modes:

    `auto`{.sample}

    :   Choose the mode automatically based on driver support and the
        other options. This is the default.

    `CQP`{.sample}

    :   Constant-quality.

    `CBR`{.sample}

    :   Constant-bitrate.

    `VBR`{.sample}

    :   Variable-bitrate.

    `ICQ`{.sample}

    :   Intelligent constant-quality.

    `QVBR`{.sample}

    :   Quality-defined variable-bitrate.

    `AVBR`{.sample}

    :   Average variable bitrate.

`blbrc`{.sample}

:   Enable block level rate control, which assigns different bitrate
    block by block. Invalid for CQP mode.

Each encoder also has its own specific options:

`av1_vaapi`{.sample}

:   `profile`{.sample} sets the value of *seq_profile*. `tier`{.sample}
    sets the value of *seq_tier*. `level`{.sample} sets the value of
    *seq_level_idx*.

    `tiles`{.sample}

    :   Set the number of tiles to encode the input video with, as
        columns x rows. (default is auto, which means use minimal tile
        column/row number).

    `tile_groups`{.sample}

    :   Set tile groups number. All the tiles will be distributed as
        evenly as possible to each tile group. (default is 1).

`h264_vaapi`{.sample}

:   `profile`{.sample} sets the value of *profile_idc* and the
    *constraint_set\*\_flag*s. `level`{.sample} sets the value of
    *level_idc*.

    `coder`{.sample}

    :   Set entropy encoder (default is *cabac*). Possible values:

        '`ac`{.sample}'\
        '`cabac`{.sample}'

        :   Use CABAC.

        '`vlc`{.sample}'\
        '`cavlc`{.sample}'

        :   Use CAVLC.

    `aud`{.sample}

    :   Include access unit delimiters in the stream (not included by
        default).

    `sei`{.sample}

    :   Set SEI message types to include. Some combination of the
        following values:

        '`identifier`{.sample}'

        :   Include a *user_data_unregistered* message containing
            information about the encoder.

        '`timing`{.sample}'

        :   Include picture timing parameters (*buffering_period* and
            *pic_timing* messages).

        '`recovery_point`{.sample}'

        :   Include recovery points where appropriate (*recovery_point*
            messages).

`hevc_vaapi`{.sample}

:   `profile`{.sample} and `level`{.sample} set the values of
    *general_profile_idc* and *general_level_idc* respectively.

    `aud`{.sample}

    :   Include access unit delimiters in the stream (not included by
        default).

    `tier`{.sample}

    :   Set *general_tier_flag*. This may affect the level chosen for
        the stream if it is not explicitly specified.

    `sei`{.sample}

    :   Set SEI message types to include. Some combination of the
        following values:

        '`hdr`{.sample}'

        :   Include HDR metadata if the input frames have it
            (*mastering_display_colour_volume* and *content_light_level*
            messages).

    `tiles`{.sample}

    :   Set the number of tiles to encode the input video with, as
        columns x rows. Larger numbers allow greater parallelism in both
        encoding and decoding, but may decrease coding efficiency.

`mjpeg_vaapi`{.sample}

:   Only baseline DCT encoding is supported. The encoder always uses the
    standard quantisation and huffman tables - `global_quality`{.sample}
    scales the standard quantisation table (range 1-100).

    For YUV, 4:2:0, 4:2:2 and 4:4:4 subsampling modes are supported. RGB
    is also supported, and will create an RGB JPEG.

    `jfif`{.sample}

    :   Include JFIF header in each frame (not included by default).

    `huffman`{.sample}

    :   Include standard huffman tables (on by default). Turning this
        off will save a few hundred bytes in each output frame, but may
        lose compatibility with some JPEG decoders which don't fully
        handle MJPEG.

`mpeg2_vaapi`{.sample}

:   `profile`{.sample} and `level`{.sample} set the value of
    *profile_and_level_indication*.

`vp8_vaapi`{.sample}

:   B-frames are not supported.

    `global_quality`{.sample} sets the *q_idx* used for non-key frames
    (range 0-127).

    `loop_filter_level`{.sample}\
    `loop_filter_sharpness`{.sample}

    :   Manually set the loop filter parameters.

`vp9_vaapi`{.sample}

:   `global_quality`{.sample} sets the *q_idx* used for P-frames (range
    0-255).

    `loop_filter_level`{.sample}\
    `loop_filter_sharpness`{.sample}

    :   Manually set the loop filter parameters.

    B-frames are supported, but the output stream is always in encode
    order rather than display order. If B-frames are enabled, it may be
    necessary to use the `vp9_raw_reorder`{.sample} bitstream filter to
    modify the output stream to display frames in the correct order.

    Only normal frames are produced - the `vp9_superframe`{.sample}
    bitstream filter may be required to produce a stream usable with all
    decoders.

[]{#vbn}

### [16.33 vbn](#toc-vbn) {#vbn .section}

Vizrt Binary Image encoder.

This format is used by the broadcast vendor Vizrt for quick texture
streaming. Advanced features of the format such as LZW compression of
texture data or generation of mipmaps are not supported.

[]{#Options-52}

#### [16.33.1 Options](#toc-Options-52) {#options-52 .subsection}

`format `{.sample}`string`{.variable}

:   Sets the texture compression used by the VBN file. Can be
    `dxt1`{.variable}, `dxt5`{.variable} or `raw`{.variable}. Default is
    `dxt5`{.variable}.

[]{#vc2}

### [16.34 vc2](#toc-vc2) {#vc2 .section}

SMPTE VC-2 (previously BBC Dirac Pro). This codec was primarily aimed at
professional broadcasting but since it supports yuv420, yuv422 and
yuv444 at 8 (limited range or full range), 10 or 12 bits, this makes it
suitable for other tasks which require low overhead and low compression
(like screen recording).

[]{#Options-53}

#### [16.34.1 Options](#toc-Options-53) {#options-53 .subsection}

`b`{.sample}

:   Sets target video bitrate. Usually that's around 1:6 of the
    uncompressed video bitrate (e.g. for 1920x1080 50fps yuv422p10
    that's around 400Mbps). Higher values (close to the uncompressed
    bitrate) turn on lossless compression mode.

`field_order`{.sample}

:   Enables field coding when set (e.g. to tt - top field first) for
    interlaced inputs. Should increase compression with interlaced
    content as it splits the fields and encodes each separately.

`wavelet_depth`{.sample}

:   Sets the total amount of wavelet transforms to apply, between 1 and
    5 (default). Lower values reduce compression and quality. Less
    capable decoders may not be able to handle values of
    `wavelet_depth`{.sample} over 3.

`wavelet_type`{.sample}

:   Sets the transform type. Currently only `5_3`{.variable} (LeGall)
    and `9_7`{.variable} (Deslauriers-Dubuc) are implemented, with 9_7
    being the one with better compression and thus is the default.

`slice_width`{.sample}\
`slice_height`{.sample}

:   Sets the slice size for each slice. Larger values result in better
    compression. For compatibility with other more limited decoders use
    `slice_width`{.sample} of 32 and `slice_height`{.sample} of 8.

`tolerance`{.sample}

:   Sets the undershoot tolerance of the rate control system in percent.
    This is to prevent an expensive search from being run.

`qm`{.sample}

:   Sets the quantization matrix preset to use by default or when
    `wavelet_depth`{.sample} is set to 5

    - \- `default`{.variable} Uses the default quantization matrix from
      the specifications, extended with values for the fifth level. This
      provides a good balance between keeping detail and omitting
      artifacts.
    - \- `flat`{.variable} Use a completely zeroed out quantization
      matrix. This increases PSNR but might reduce perception. Use in
      bogus benchmarks.
    - \- `color`{.variable} Reduces detail but attempts to preserve
      color at extremely low bitrates.

[]{#Subtitles-Encoders}

## [17 Subtitles Encoders](#toc-Subtitles-Encoders) {#subtitles-encoders .chapter}

[]{#dvbsub-1}

### [17.1 dvbsub](#toc-dvbsub-1) {#dvbsub-1 .section}

This codec encodes the bitmap subtitle format that is used in DVB
broadcasts and recordings. The bitmaps are typically embedded in a
container such as MPEG-TS as a separate stream.

[]{#Options-54}

#### [17.1.1 Options](#toc-Options-54) {#options-54 .subsection}

`min_bpp `{.sample}`integer (2, 4, or 8)`{.variable}

:   Set a minimum bits-per-pixel value for the subtitle color lookup
    tables.

    DVB supports 2, 4, and 8 bits-per-pixel color lookup tables. This
    option enables forcing a particular bits-per-pixel value regardless
    of the number of colors. Since not all players support or properly
    support 2 bits-per-pixel, this value defaults to 4.

[]{#dvdsub-1}

### [17.2 dvdsub](#toc-dvdsub-1) {#dvdsub-1 .section}

This codec encodes the bitmap subtitle format that is used in DVDs.
Typically they are stored in VOBSUB file pairs (\*.idx + \*.sub), and
they can also be used in Matroska files.

[]{#Options-55}

#### [17.2.1 Options](#toc-Options-55) {#options-55 .subsection}

`palette`{.sample}

:   Specify the global palette used by the bitmaps.

    The format for this option is a string containing 16 24-bits
    hexadecimal numbers (without 0x prefix) separated by commas, for
    example
    `0d00ee, ee450d, 101010, eaeaea, 0ce60b, ec14ed, ebff0b, 0d617a, 7b7b7b, d1d1d1, 7b2a0e, 0d950c, 0f007b, cf0dec, cfa80c, 7c127b`.

`even_rows_fix`{.sample}

:   When set to 1, enable a work-around that makes the number of pixel
    rows even in all subtitles. This fixes a problem with some players
    that cut off the bottom row if the number is odd. The work-around
    just adds a fully transparent row if needed. The overhead is low,
    typically one byte per subtitle on average.

    By default, this work-around is disabled.

[]{#lrc}

### [17.3 lrc](#toc-lrc) {#lrc .section}

This codec encodes the LRC lyrics format.

[]{#Options-56}

#### [17.3.1 Options](#toc-Options-56) {#options-56 .subsection}

`precision`{.sample}

:   Specify the precision of the fractional part of the timestamp. Time
    base is determined based on this value.

    Defaults to 2 for centiseconds.

[]{#Bitstream-Filters}

## [18 Bitstream Filters](#toc-Bitstream-Filters) {#bitstream-filters .chapter}

When you configure your FFmpeg build, all the supported bitstream
filters are enabled by default. You can list all available ones using
the configure option `--list-bsfs`.

You can disable all the bitstream filters using the configure option
`--disable-bsfs`, and selectively enable any bitstream filter using the
option `--enable-bsf=BSF`, or you can disable a particular bitstream
filter using the option `--disable-bsf=BSF`.

The option `-bsfs` of the ff\* tools will display the list of all the
supported bitstream filters included in your build.

The ff\* tools have a -bsf option applied per stream, taking a
comma-separated list of filters, whose parameters follow the filter name
after a '='.

::: example
``` example
ffmpeg -i INPUT -c:v copy -bsf:v filter1[=opt1=str1:opt2=str2][,filter2] OUTPUT
```
:::

Below is a description of the currently available bitstream filters,
with their parameters, if any.

[]{#aac_005fadtstoasc}

### [18.1 aac_adtstoasc](#toc-aac_005fadtstoasc) {#aac_adtstoasc .section}

Convert MPEG-2/4 AAC ADTS to an MPEG-4 Audio Specific Configuration
bitstream.

This filter creates an MPEG-4 AudioSpecificConfig from an MPEG-2/4 ADTS
header and removes the ADTS header.

This filter is required for example when copying an AAC stream from a
raw ADTS AAC or an MPEG-TS container to MP4A-LATM, to an FLV file, or to
MOV/MP4 files and related formats such as 3GP or M4A. Please note that
it is auto-inserted for MP4A-LATM and MOV/MP4 and related formats.

[]{#av1_005fmetadata}

### [18.2 av1_metadata](#toc-av1_005fmetadata) {#av1_metadata .section}

Modify metadata embedded in an AV1 stream.

`td`{.sample}

:   Insert or remove temporal delimiter OBUs in all temporal units of
    the stream.

    '`insert`{.sample}'

    :   Insert a TD at the beginning of every TU which does not already
        have one.

    '`remove`{.sample}'

    :   Remove the TD from the beginning of every TU which has one.

`color_primaries`{.sample}\
`transfer_characteristics`{.sample}\
`matrix_coefficients`{.sample}

:   Set the color description fields in the stream (see AV1 section
    6.4.2).

`color_range`{.sample}

:   Set the color range in the stream (see AV1 section 6.4.2; note that
    this cannot be set for streams using BT.709 primaries, sRGB transfer
    characteristic and identity (RGB) matrix coefficients).

    '`tv`{.sample}'

    :   Limited range.

    '`pc`{.sample}'

    :   Full range.

`chroma_sample_position`{.sample}

:   Set the chroma sample location in the stream (see AV1 section
    6.4.2). This can only be set for 4:2:0 streams.

    '`vertical`{.sample}'

    :   Left position (matching the default in MPEG-2 and H.264).

    '`colocated`{.sample}'

    :   Top-left position.

`tick_rate`{.sample}

:   Set the tick rate (*time_scale / num_units_in_display_tick*) in the
    timing info in the sequence header.

`num_ticks_per_picture`{.sample}

:   Set the number of ticks in each picture, to indicate that the stream
    has a fixed framerate. Ignored if `tick_rate`{.sample} is not also
    set.

`delete_padding`{.sample}

:   Deletes Padding OBUs.

[]{#chomp}

### [18.3 chomp](#toc-chomp) {#chomp .section}

Remove zero padding at the end of a packet.

[]{#dca_005fcore}

### [18.4 dca_core](#toc-dca_005fcore) {#dca_core .section}

Extract the core from a DCA/DTS stream, dropping extensions such as
DTS-HD.

[]{#dovi_005frpu}

### [18.5 dovi_rpu](#toc-dovi_005frpu) {#dovi_rpu .section}

Manipulate Dolby Vision metadata in a HEVC/AV1 bitstream, optionally
enabling metadata compression.

`strip`{.sample}

:   If enabled, strip all Dolby Vision metadata (configuration record +
    RPU data blocks) from the stream.

`compression`{.sample}

:   Which compression level to enable.

    '`none`{.sample}'

    :   No metadata compression.

    '`limited`{.sample}'

    :   Limited metadata compression scheme. Should be compatible with
        most devices. This is the default.

    '`extended`{.sample}'

    :   Extended metadata compression. Devices are not required to
        support this. Note that this level currently behaves the same as
        '`limited`{.sample}' in libavcodec.

[]{#dump_005fextra}

### [18.6 dump_extra](#toc-dump_005fextra) {#dump_extra .section}

Add extradata to the beginning of the filtered packets except when said
packets already exactly begin with the extradata that is intended to be
added.

`freq`{.sample}

:   The additional argument specifies which packets should be filtered.
    It accepts the values:

    '`k`{.sample}'\
    '`keyframe`{.sample}'

    :   add extradata to all key packets

    '`e`{.sample}'\
    '`all`{.sample}'

    :   add extradata to all packets

If not specified it is assumed '`k`{.sample}'.

For example the following `ffmpeg` command forces a global header (thus
disabling individual packet headers) in the H.264 packets generated by
the `libx264` encoder, but corrects them by adding the header stored in
extradata to the key packets:

::: example
``` example
ffmpeg -i INPUT -map 0 -flags:v +global_header -c:v libx264 -bsf:v dump_extra out.ts
```
:::

[]{#dv_005ferror_005fmarker}

### [18.7 dv_error_marker](#toc-dv_005ferror_005fmarker) {#dv_error_marker .section}

Blocks in DV which are marked as damaged are replaced by blocks of the
specified color.

`color`{.sample}

:   The color to replace damaged blocks by

`sta`{.sample}

:   A 16 bit mask which specifies which of the 16 possible error status
    values are to be replaced by colored blocks. 0xFFFE is the default
    which replaces all non 0 error status values.

    '`ok`{.sample}'

    :   No error, no concealment

    '`err`{.sample}'

    :   Error, No concealment

    '`res`{.sample}'

    :   Reserved

    '`notok`{.sample}'

    :   Error or concealment

    '`notres`{.sample}'

    :   Not reserved

    '`Aa, Ba, Ca, Ab, Bb, Cb, A, B, C, a, b, erri, erru`{.sample}'

    :   The specific error status code

    see page 44-46 or section 5.5 of
    <http://web.archive.org/web/20060927044735/http://www.smpte.org/smpte_store/standards/pdf/s314m.pdf>

[]{#eac3_005fcore}

### [18.8 eac3_core](#toc-eac3_005fcore) {#eac3_core .section}

Extract the core from a E-AC-3 stream, dropping extra channels.

[]{#eia608_005fto_005fsmpte436m}

### [18.9 eia608_to_smpte436m](#toc-eia608_005fto_005fsmpte436m) {#eia608_to_smpte436m .section}

Convert from a `EIA_608` stream to a `SMPTE_436M_ANC` data stream,
wrapping the closed captions in CTA-708 CDP VANC packets.

`line_number`{.sample}

Choose which line number the generated VANC packets should go on. You
generally want either line 9 (the default) or 11.

`wrapping_type`{.sample}

Choose the SMPTE 436M wrapping type, defaults to
'`vanc_frame`{.sample}'. It accepts the values:

'`vanc_frame`{.sample}'

VANC frame (interlaced or segmented progressive frame)

'`vanc_field_1`{.sample}'

'`vanc_field_2`{.sample}'

'`vanc_progressive_frame`{.sample}'

`sample_coding`{.sample}

Choose the SMPTE 436M sample coding, defaults to '`8bit_luma`{.sample}'.
It accepts the values:

'`8bit_luma`{.sample}'

:   8-bit component luma samples

'`8bit_color_diff`{.sample}'

:   8-bit component color difference samples

'`8bit_luma_and_color_diff`{.sample}'

:   8-bit component luma and color difference samples

'`10bit_luma`{.sample}'

:   10-bit component luma samples

'`10bit_color_diff`{.sample}'

:   10-bit component color difference samples

'`10bit_luma_and_color_diff`{.sample}'

:   10-bit component luma and color difference samples

'`8bit_luma_parity_error`{.sample}'

:   8-bit component luma samples with parity error

'`8bit_color_diff_parity_error`{.sample}'

:   8-bit component color difference samples with parity error

'`8bit_luma_and_color_diff_parity_error`{.sample}'

:   8-bit component luma and color difference samples with parity error

`initial_cdp_sequence_cntr`{.sample}

The initial value of the CDP's 16-bit unsigned integer
`cdp_hdr_sequence_cntr` and `cdp_ftr_sequence_cntr` fields. Defaults to
0.

`cdp_frame_rate`{.sample}

Set the CDP's `cdp_frame_rate` field. This doesn't actually change the
timing of the data stream, it just changes the values inserted in that
field in the generated CDP packets. Defaults to '`30000/1001`{.sample}'.

[]{#extract_005fextradata}

### [18.10 extract_extradata](#toc-extract_005fextradata) {#extract_extradata .section}

Extract the in-band extradata.

Certain codecs allow the long-term headers (e.g. MPEG-2 sequence
headers, or H.264/HEVC (VPS/)SPS/PPS) to be transmitted either
\"in-band\" (i.e. as a part of the bitstream containing the coded
frames) or \"out of band\" (e.g. on the container level). This latter
form is called \"extradata\" in FFmpeg terminology.

This bitstream filter detects the in-band headers and makes them
available as extradata.

`remove`{.sample}

:   When this option is enabled, the long-term headers are removed from
    the bitstream after extraction.

[]{#filter_005funits}

### [18.11 filter_units](#toc-filter_005funits) {#filter_units .section}

Remove units with types in or not in a given set from the stream.

`pass_types`{.sample}

:   List of unit types or ranges of unit types to pass through while
    removing all others. This is specified as a '\|'-separated list of
    unit type values or ranges of values with '-'.

`remove_types`{.sample}

:   Identical to `pass_types`{.sample}, except the units in the given
    set removed and all others passed through.

The types used by pass_types and remove_types correspond to NAL unit
types (nal_unit_type) in H.264, HEVC and H.266 (see Table 7-1 in the
H.264 and HEVC specifications or Table 5 in the H.266 specification), to
marker values for JPEG (without 0xFF prefix) and to start codes without
start code prefix (i.e. the byte following the 0x000001) for MPEG-2. For
VP8 and VP9, every unit has type zero.

Extradata is unchanged by this transformation, but note that if the
stream contains inline parameter sets then the output may be unusable if
they are removed.

For example, to remove all non-VCL NAL units from an H.264 stream:

::: example
``` example
ffmpeg -i INPUT -c:v copy -bsf:v 'filter_units=pass_types=1-5' OUTPUT
```
:::

To remove all AUDs, SEI and filler from an H.265 stream:

::: example
``` example
ffmpeg -i INPUT -c:v copy -bsf:v 'filter_units=remove_types=35|38-40' OUTPUT
```
:::

To remove all user data from a MPEG-2 stream, including Closed Captions:

::: example
``` example
ffmpeg -i INPUT -c:v copy -bsf:v 'filter_units=remove_types=178' OUTPUT
```
:::

To remove all SEI from a H264 stream, including Closed Captions:

::: example
``` example
ffmpeg -i INPUT -c:v copy -bsf:v 'filter_units=remove_types=6' OUTPUT
```
:::

To remove all prefix and suffix SEI from a HEVC stream, including Closed
Captions and dynamic HDR:

::: example
``` example
ffmpeg -i INPUT -c:v copy -bsf:v 'filter_units=remove_types=39|40' OUTPUT
```
:::

[]{#hapqa_005fextract}

### [18.12 hapqa_extract](#toc-hapqa_005fextract) {#hapqa_extract .section}

Extract Rgb or Alpha part of an HAPQA file, without recompression, in
order to create an HAPQ or an HAPAlphaOnly file.

`texture`{.sample}

Specifies the texture to keep.

`color`{.sample}

`alpha`{.sample}

Convert HAPQA to HAPQ

::: example
``` example
ffmpeg -i hapqa_inputfile.mov -c copy -bsf:v hapqa_extract=texture=color -tag:v HapY -metadata:s:v:0 encoder="HAPQ" hapq_file.mov
```
:::

Convert HAPQA to HAPAlphaOnly

::: example
``` example
ffmpeg -i hapqa_inputfile.mov -c copy -bsf:v hapqa_extract=texture=alpha -tag:v HapA -metadata:s:v:0 encoder="HAPAlpha Only" hapalphaonly_file.mov
```
:::

[]{#h264_005fmetadata}

### [18.13 h264_metadata](#toc-h264_005fmetadata) {#h264_metadata .section}

Modify metadata embedded in an H.264 stream.

`aud`{.sample}

Insert or remove AUD NAL units in all access units of the stream.

'`pass`{.sample}'

'`insert`{.sample}'

'`remove`{.sample}'

Default is pass.

`sample_aspect_ratio`{.sample}

Set the sample aspect ratio of the stream in the VUI parameters. See
H.264 table E-1.

`overscan_appropriate_flag`{.sample}

Set whether the stream is suitable for display using overscan or not
(see H.264 section E.2.1).

`video_format`{.sample}

`video_full_range_flag`{.sample}

Set the video format in the stream (see H.264 section E.2.1 and table
E-2).

`colour_primaries`{.sample}

`transfer_characteristics`{.sample}

`matrix_coefficients`{.sample}

Set the colour description in the stream (see H.264 section E.2.1 and
tables E-3, E-4 and E-5).

`chroma_sample_loc_type`{.sample}

Set the chroma sample location in the stream (see H.264 section E.2.1
and figure E-1).

`tick_rate`{.sample}

Set the tick rate (time_scale / num_units_in_tick) in the VUI
parameters. This is the smallest time unit representable in the stream,
and in many cases represents the field rate of the stream (double the
frame rate).

`fixed_frame_rate_flag`{.sample}

Set whether the stream has fixed framerate - typically this indicates
that the framerate is exactly half the tick rate, but the exact meaning
is dependent on interlacing and the picture structure (see H.264 section
E.2.1 and table E-6).

`zero_new_constraint_set_flags`{.sample}

Zero constraint_set4_flag and constraint_set5_flag in the SPS. These
bits were reserved in a previous version of the H.264 spec, and thus
some hardware decoders require these to be zero. The result of zeroing
this is still a valid bitstream.

`crop_left`{.sample}

`crop_right`{.sample}

`crop_top`{.sample}

`crop_bottom`{.sample}

Set the frame cropping offsets in the SPS. These values will replace the
current ones if the stream is already cropped.

These fields are set in pixels. Note that some sizes may not be
representable if the chroma is subsampled or the stream is interlaced
(see H.264 section 7.4.2.1.1).

`sei_user_data`{.sample}

Insert a string as SEI unregistered user data. The argument must be of
the form *UUID+string*, where the UUID is as hex digits possibly
separated by hyphens, and the string can be anything.

For example, '`086f3693-b7b3-4f2c-9653-21492feee5b8+hello`{.sample}'
will insert the string "hello" associated with the given UUID.

`delete_filler`{.sample}

Deletes both filler NAL units and filler SEI messages.

`display_orientation`{.sample}

Insert, extract or remove Display orientation SEI messages. See H.264
section D.1.27 and D.2.27 for syntax and semantics.

'`pass`{.sample}'

'`insert`{.sample}'

'`remove`{.sample}'

'`extract`{.sample}'

Default is pass.

Insert mode works in conjunction with `rotate` and `flip` options. Any
pre-existing Display orientation messages will be removed in insert or
remove mode. Extract mode attaches the display matrix to the packet as
side data.

`rotate`{.sample}

Set rotation in display orientation SEI (anticlockwise angle in
degrees). Range is -360 to +360. Default is NaN.

`flip`{.sample}

Set flip in display orientation SEI.

'`horizontal`{.sample}'

'`vertical`{.sample}'

Default is unset.

`level`{.sample}

Set the level in the SPS. Refer to H.264 section A.3 and tables A-1 to
A-5.

The argument must be the name of a level (for example,
'`4.2`{.sample}'), a level_idc value (for example, '`42`{.sample}'), or
the special name '`auto`{.sample}' indicating that the filter should
attempt to guess the level from the input stream properties.

[]{#h264_005fmp4toannexb}

### [18.14 h264_mp4toannexb](#toc-h264_005fmp4toannexb) {#h264_mp4toannexb .section}

Convert an H.264 bitstream from length prefixed mode to start code
prefixed mode (as defined in the Annex B of the ITU-T H.264
specification).

This is required by some streaming formats, typically the MPEG-2
transport stream format (muxer `mpegts`).

For example to remux an MP4 file containing an H.264 stream to mpegts
format with `ffmpeg`, you can use the command:

::: example
``` example
ffmpeg -i INPUT.mp4 -codec copy -bsf:v h264_mp4toannexb OUTPUT.ts
```
:::

Please note that this filter is auto-inserted for MPEG-TS (muxer
`mpegts`) and raw H.264 (muxer `h264`) output formats.

[]{#h264_005fredundant_005fpps}

### [18.15 h264_redundant_pps](#toc-h264_005fredundant_005fpps) {#h264_redundant_pps .section}

This applies a specific fixup to some Blu-ray BDMV H264 streams which
contain redundant PPSs. The PPSs modify irrelevant parameters of the
stream, confusing other transformations which require the correct
extradata.

The encoder used on these impacted streams adds extra PPSs throughout
the stream, varying the initial QP and whether weighted prediction was
enabled. This causes issues after copying the stream into a global
header container, as the starting PPS is not suitable for the rest of
the stream. One side effect, for example, is seeking will return garbled
output until a new PPS appears.

This BSF removes the extra PPSs and rewrites the slice headers such that
the stream uses a single leading PPS in the global header, which
resolves the issue.

[]{#hevc_005fmetadata}

### [18.16 hevc_metadata](#toc-hevc_005fmetadata) {#hevc_metadata .section}

Modify metadata embedded in an HEVC stream.

`aud`{.sample}

Insert or remove AUD NAL units in all access units of the stream.

'`insert`{.sample}'

'`remove`{.sample}'

`sample_aspect_ratio`{.sample}

Set the sample aspect ratio in the stream in the VUI parameters.

`video_format`{.sample}

`video_full_range_flag`{.sample}

Set the video format in the stream (see H.265 section E.3.1 and table
E.2).

`colour_primaries`{.sample}

`transfer_characteristics`{.sample}

`matrix_coefficients`{.sample}

Set the colour description in the stream (see H.265 section E.3.1 and
tables E.3, E.4 and E.5).

`chroma_sample_loc_type`{.sample}

Set the chroma sample location in the stream (see H.265 section E.3.1
and figure E.1).

`tick_rate`{.sample}

Set the tick rate in the VPS and VUI parameters (time_scale /
num_units_in_tick). Combined with `num_ticks_poc_diff_one`{.sample},
this can set a constant framerate in the stream. Note that it is likely
to be overridden by container parameters when the stream is in a
container.

`num_ticks_poc_diff_one`{.sample}

Set poc_proportional_to_timing_flag in VPS and VUI and use this value to
set num_ticks_poc_diff_one_minus1 (see H.265 sections 7.4.3.1 and
E.3.1). Ignored if `tick_rate`{.sample} is not also set.

`crop_left`{.sample}

`crop_right`{.sample}

`crop_top`{.sample}

`crop_bottom`{.sample}

Set the conformance window cropping offsets in the SPS. These values
will replace the current ones if the stream is already cropped.

These fields are set in pixels. Note that some sizes may not be
representable if the chroma is subsampled (H.265 section 7.4.3.2.1).

`width`{.sample}

`height`{.sample}

Set width and height after crop.

`level`{.sample}

Set the level in the VPS and SPS. See H.265 section A.4 and tables A.6
and A.7.

The argument must be the name of a level (for example,
'`5.1`{.sample}'), a *general_level_idc* value (for example,
'`153`{.sample}' for level 5.1), or the special name '`auto`{.sample}'
indicating that the filter should attempt to guess the level from the
input stream properties.

[]{#hevc_005fmp4toannexb}

### [18.17 hevc_mp4toannexb](#toc-hevc_005fmp4toannexb) {#hevc_mp4toannexb .section}

Convert an HEVC/H.265 bitstream from length prefixed mode to start code
prefixed mode (as defined in the Annex B of the ITU-T H.265
specification).

This is required by some streaming formats, typically the MPEG-2
transport stream format (muxer `mpegts`).

For example to remux an MP4 file containing an HEVC stream to mpegts
format with `ffmpeg`, you can use the command:

::: example
``` example
ffmpeg -i INPUT.mp4 -codec copy -bsf:v hevc_mp4toannexb OUTPUT.ts
```
:::

Please note that this filter is auto-inserted for MPEG-TS (muxer
`mpegts`) and raw HEVC/H.265 (muxer `h265` or `hevc`) output formats.

[]{#imxdump}

### [18.18 imxdump](#toc-imxdump) {#imxdump .section}

Modifies the bitstream to fit in MOV and to be usable by the Final Cut
Pro decoder. This filter only applies to the mpeg2video codec, and is
likely not needed for Final Cut Pro 7 and newer with the appropriate
`-tag:v`{.sample}.

For example, to remux 30 MB/sec NTSC IMX to MOV:

::: example
``` example
ffmpeg -i input.mxf -c copy -bsf:v imxdump -tag:v mx3n output.mov
```
:::

[]{#mjpeg2jpeg}

### [18.19 mjpeg2jpeg](#toc-mjpeg2jpeg) {#mjpeg2jpeg .section}

Convert MJPEG/AVI1 packets to full JPEG/JFIF packets.

MJPEG is a video codec wherein each video frame is essentially a JPEG
image. The individual frames can be extracted without loss, e.g. by

::: example
``` example
ffmpeg -i ../some_mjpeg.avi -c:v copy frames_%d.jpg
```
:::

Unfortunately, these chunks are incomplete JPEG images, because they
lack the DHT segment required for decoding. Quoting from
<http://www.digitalpreservation.gov/formats/fdd/fdd000063.shtml>:

Avery Lee, writing in the rec.video.desktop newsgroup in 2001, commented
that \"MJPEG, or at least the MJPEG in AVIs having the MJPG fourcc, is
restricted JPEG with a fixed -- and \*omitted\* -- Huffman table. The
JPEG must be YCbCr colorspace, it must be 4:2:2, and it must use basic
Huffman encoding, not arithmetic or progressive. . . . You can indeed
extract the MJPEG frames and decode them with a regular JPEG decoder,
but you have to prepend the DHT segment to them, or else the decoder
won't have any idea how to decompress the data. The exact table
necessary is given in the OpenDML spec.\"

This bitstream filter patches the header of frames extracted from an
MJPEG stream (carrying the AVI1 header ID and lacking a DHT segment) to
produce fully qualified JPEG images.

::: example
``` example
ffmpeg -i mjpeg-movie.avi -c:v copy -bsf:v mjpeg2jpeg frame_%d.jpg
exiftran -i -9 frame*.jpg
ffmpeg -i frame_%d.jpg -c:v copy rotated.avi
```
:::

[]{#mjpegadump}

### [18.20 mjpegadump](#toc-mjpegadump) {#mjpegadump .section}

Add an MJPEG A header to the bitstream, to enable decoding by Quicktime.

[]{#mov2textsub}[]{#mov2textsub-1}

### [18.21 mov2textsub](#toc-mov2textsub-1) {#mov2textsub .section}

Extract a representable text file from MOV subtitles, stripping the
metadata header from each subtitle packet.

See also the [text2movsub](#text2movsub) filter.

[]{#mpeg2_005fmetadata}

### [18.22 mpeg2_metadata](#toc-mpeg2_005fmetadata) {#mpeg2_metadata .section}

Modify metadata embedded in an MPEG-2 stream.

`display_aspect_ratio`{.sample}

Set the display aspect ratio in the stream.

The following fixed values are supported:

`4/3`{.sample}

`16/9`{.sample}

`221/100`{.sample}

Any other value will result in square pixels being signalled instead
(see H.262 section 6.3.3 and table 6-3).

`frame_rate`{.sample}

Set the frame rate in the stream. This is constructed from a table of
known values combined with a small multiplier and divisor - if the
supplied value is not exactly representable, the nearest representable
value will be used instead (see H.262 section 6.3.3 and table 6-4).

`video_format`{.sample}

Set the video format in the stream (see H.262 section 6.3.6 and table
6-6).

`colour_primaries`{.sample}

`transfer_characteristics`{.sample}

`matrix_coefficients`{.sample}

Set the colour description in the stream (see H.262 section 6.3.6 and
tables 6-7, 6-8 and 6-9).

[]{#mpeg4_005funpack_005fbframes}

### [18.23 mpeg4_unpack_bframes](#toc-mpeg4_005funpack_005fbframes) {#mpeg4_unpack_bframes .section}

Unpack DivX-style packed B-frames.

DivX-style packed B-frames are not valid MPEG-4 and were only a
workaround for the broken Video for Windows subsystem. They use more
space, can cause minor AV sync issues, require more CPU power to decode
(unless the player has some decoded picture queue to compensate the
2,0,2,0 frame per packet style) and cause trouble if copied into a
standard container like mp4 or mpeg-ps/ts, because MPEG-4 decoders may
not be able to decode them, since they are not valid MPEG-4.

For example to fix an AVI file containing an MPEG-4 stream with
DivX-style packed B-frames using `ffmpeg`, you can use the command:

::: example
``` example
ffmpeg -i INPUT.avi -codec copy -bsf:v mpeg4_unpack_bframes OUTPUT.avi
```
:::

[]{#noise}

### [18.24 noise](#toc-noise) {#noise .section}

Damages the contents of packets or simply drops them without damaging
the container. Can be used for fuzzing or testing error
resilience/concealment.

Parameters:

`amount`{.sample}

:   Accepts an expression whose evaluation per-packet determines how
    often bytes in that packet will be modified. A value below 0 will
    result in a variable frequency. Default is 0 which results in no
    modification. However, if neither amount nor drop is specified,
    amount will be set to `-1`{.variable}. See below for accepted
    variables.

`drop`{.sample}

:   Accepts an expression evaluated per-packet whose value determines
    whether that packet is dropped. Evaluation to a positive value
    results in the packet being dropped. Evaluation to a negative value
    results in a variable chance of it being dropped, roughly inverse in
    proportion to the magnitude of the value. Default is 0 which results
    in no drops. See below for accepted variables.

`dropamount`{.sample}

:   Accepts a non-negative integer, which assigns a variable chance of
    it being dropped, roughly inverse in proportion to the value.
    Default is 0 which results in no drops. This option is kept for
    backwards compatibility and is equivalent to setting drop to a
    negative value with the same magnitude i.e. `dropamount=4` is the
    same as `drop=-4`. Ignored if drop is also specified.

Both `amount` and `drop` accept expressions containing the following
variables:

'`n`{.sample}'

:   The index of the packet, starting from zero.

'`tb`{.sample}'

:   The timebase for packet timestamps.

'`pts`{.sample}'

:   Packet presentation timestamp.

'`dts`{.sample}'

:   Packet decoding timestamp.

'`nopts`{.sample}'

:   Constant representing AV_NOPTS_VALUE.

'`startpts`{.sample}'

:   First non-AV_NOPTS_VALUE PTS seen in the stream.

'`startdts`{.sample}'

:   First non-AV_NOPTS_VALUE DTS seen in the stream.

'`duration`{.sample}'\
'`d`{.sample}'

:   Packet duration, in timebase units.

'`pos`{.sample}'

:   Packet position in input; may be -1 when unknown or not set.

'`size`{.sample}'

:   Packet size, in bytes.

'`key`{.sample}'

:   Whether packet is marked as a keyframe.

'`state`{.sample}'

:   A pseudo random integer, primarily derived from the content of
    packet payload.

[]{#Examples-7}

#### [18.24.1 Examples](#toc-Examples-7) {#examples-7 .subsection}

Apply modification to every byte but don't drop any packets.

::: example
``` example
ffmpeg -i INPUT -c copy -bsf noise=1 output.mkv
```
:::

Drop every video packet not marked as a keyframe after timestamp 30s but
do not modify any of the remaining packets.

::: example
``` example
ffmpeg -i INPUT -c copy -bsf:v noise=drop='gt(pts*tb\,30)*not(key)' output.mkv
```
:::

Drop one second of audio every 10 seconds and add some random noise to
the rest.

::: example
``` example
ffmpeg -i INPUT -c copy -bsf:a noise=amount=-1:drop='between(mod(pts*tb\,10)\,9\,10)' output.mkv
```
:::

[]{#null}

### [18.25 null](#toc-null) {#null .section}

This bitstream filter passes the packets through unchanged.

[]{#pcm_005frechunk}

### [18.26 pcm_rechunk](#toc-pcm_005frechunk) {#pcm_rechunk .section}

Repacketize PCM audio to a fixed number of samples per packet or a fixed
packet rate per second. This is similar to the
[(ffmpeg-filters)asetnsamples audio
filter](ffmpeg-filters.html#asetnsamples) but works on audio packets
instead of audio frames.

`nb_out_samples, n`{.sample}

:   Set the number of samples per each output audio packet. The number
    is intended as the number of samples *per each channel*. Default
    value is 1024.

`pad, p`{.sample}

:   If set to 1, the filter will pad the last audio packet with silence,
    so that it will contain the same number of samples (or roughly the
    same number of samples, see `frame_rate`{.sample}) as the previous
    ones. Default value is 1.

`frame_rate, r`{.sample}

:   This option makes the filter output a fixed number of packets per
    second instead of a fixed number of samples per packet. If the audio
    sample rate is not divisible by the frame rate then the number of
    samples will not be constant but will vary slightly so that each
    packet will start as close to the frame boundary as possible. Using
    this option has precedence over `nb_out_samples`{.sample}.

You can generate the well known 1602-1601-1602-1601-1602 pattern of
48kHz audio for NTSC frame rate using the `frame_rate`{.sample} option.

::: example
``` example
ffmpeg -f lavfi -i sine=r=48000:d=1 -c pcm_s16le -bsf pcm_rechunk=r=30000/1001 -f framecrc -
```
:::

[]{#pgs_005fframe_005fmerge}

### [18.27 pgs_frame_merge](#toc-pgs_005fframe_005fmerge) {#pgs_frame_merge .section}

Merge a sequence of PGS Subtitle segments ending with an \"end of
display set\" segment into a single packet.

This is required by some containers that support PGS subtitles (muxer
`matroska`).

[]{#prores_005fmetadata}

### [18.28 prores_metadata](#toc-prores_005fmetadata) {#prores_metadata .section}

Modify color property metadata embedded in prores stream.

`color_primaries`{.sample}

Set the color primaries. Available values are:

'`auto`{.sample}'

:   Keep the same color primaries property (default).

'`unknown`{.sample}'\
'`bt709`{.sample}'\
'`bt470bg`{.sample}'

:   BT601 625

'`smpte170m`{.sample}'

:   BT601 525

'`bt2020`{.sample}'\
'`smpte431`{.sample}'

:   DCI P3

'`smpte432`{.sample}'

:   P3 D65

`transfer_characteristics`{.sample}

Set the color transfer. Available values are:

'`auto`{.sample}'

:   Keep the same transfer characteristics property (default).

'`unknown`{.sample}'\
'`bt709`{.sample}'

:   BT 601, BT 709, BT 2020

'`smpte2084`{.sample}'

:   SMPTE ST 2084

'`arib-std-b67`{.sample}'

:   ARIB STD-B67

`matrix_coefficients`{.sample}

Set the matrix coefficient. Available values are:

'`auto`{.sample}'

Keep the same colorspace property (default).

'`unknown`{.sample}'

'`bt709`{.sample}'

'`smpte170m`{.sample}'

BT 601

'`bt2020nc`{.sample}'

Set Rec709 colorspace for each frame of the file

::: example
``` example
ffmpeg -i INPUT -c copy -bsf:v prores_metadata=color_primaries=bt709:color_trc=bt709:colorspace=bt709 output.mov
```
:::

Set Hybrid Log-Gamma parameters for each frame of the file

::: example
``` example
ffmpeg -i INPUT -c copy -bsf:v prores_metadata=color_primaries=bt2020:color_trc=arib-std-b67:colorspace=bt2020nc output.mov
```
:::

[]{#remove_005fextra}

### [18.29 remove_extra](#toc-remove_005fextra) {#remove_extra .section}

Remove extradata from packets.

It accepts the following parameter:

`freq`{.sample}

:   Set which frame types to remove extradata from.

    '`k`{.sample}'

    :   Remove extradata from non-keyframes only.

    '`keyframe`{.sample}'

    :   Remove extradata from keyframes only.

    '`e, all`{.sample}'

    :   Remove extradata from all frames.

[]{#setts}

### [18.30 setts](#toc-setts) {#setts .section}

Set PTS and DTS in packets.

It accepts the following parameters:

`ts`{.sample}\
`pts`{.sample}\
`dts`{.sample}

:   Set expressions for PTS, DTS or both.

`duration`{.sample}

:   Set expression for duration.

`time_base`{.sample}

:   Set output time base.

`prescale`{.sample}

:   Set whether to convert time fields to user-set output time base
    before evaluation of expressions. Defaults to 0.

The expressions are evaluated through the eval API and can contain the
following constants:

`N`{.sample}

:   The count of the input packet. Starting from 0.

`TS`{.sample}

:   The demux timestamp in input in case of `ts` or `dts` option or
    presentation timestamp in case of `pts` option.

`POS`{.sample}

:   The original position in the file of the packet, or undefined if
    undefined for the current packet

`DTS`{.sample}

:   The demux timestamp in input.

`PTS`{.sample}

:   The presentation timestamp in input.

`DURATION`{.sample}

:   The duration in input.

`STARTDTS`{.sample}

:   The DTS of the first packet.

`STARTPTS`{.sample}

:   The PTS of the first packet.

`PREV_INDTS`{.sample}

:   The previous input DTS.

`PREV_INPTS`{.sample}

:   The previous input PTS.

`PREV_INDURATION`{.sample}

:   The previous input duration.

`PREV_OUTDTS`{.sample}

:   The previous output DTS.

`PREV_OUTPTS`{.sample}

:   The previous output PTS.

`PREV_OUTDURATION`{.sample}

:   The previous output duration.

`NEXT_DTS`{.sample}

:   The next input DTS.

`NEXT_PTS`{.sample}

:   The next input PTS.

`NEXT_DURATION`{.sample}

:   The next input duration.

`TB`{.sample}

:   The timebase in which time fields are denominated. The user-set
    output timebase if prescale is enabled, else the input timebase.

`TB_OUT`{.sample}

:   The output timebase.

`SR`{.sample}

:   The sample rate of stream packet belongs.

`NOPTS`{.sample}

:   The AV_NOPTS_VALUE constant.

For example, to set PTS equal to DTS (not recommended if B-frames are
involved):

::: example
``` example
ffmpeg -i INPUT -c:a copy -bsf:a setts=pts=DTS out.mkv
```
:::

[]{#showinfo}

### [18.31 showinfo](#toc-showinfo) {#showinfo .section}

Log basic packet information. Mainly useful for testing, debugging, and
development.

[]{#smpte436m_005fto_005feia608}

### [18.32 smpte436m_to_eia608](#toc-smpte436m_005fto_005feia608) {#smpte436m_to_eia608 .section}

Convert from a `SMPTE_436M_ANC` data stream to a `EIA_608` stream,
extracting the closed captions from CTA-708 CDP VANC packets, and
ignoring all other data.

[]{#text2movsub}[]{#text2movsub-1}

### [18.33 text2movsub](#toc-text2movsub-1) {#text2movsub .section}

Convert text subtitles to MOV subtitles (as used by the `mov_text`
codec) with metadata headers.

See also the [mov2textsub](#mov2textsub) filter.

[]{#trace_005fheaders}

### [18.34 trace_headers](#toc-trace_005fheaders) {#trace_headers .section}

Log trace output containing all syntax elements in the coded stream
headers (everything above the level of individual coded blocks). This
can be useful for debugging low-level stream issues.

Supports AV1, H.264, H.265, (M)JPEG, MPEG-2 and VP9, but depending on
the build only a subset of these may be available.

[]{#truehd_005fcore}

### [18.35 truehd_core](#toc-truehd_005fcore) {#truehd_core .section}

Extract the core from a TrueHD stream, dropping ATMOS data.

[]{#vp9_005fmetadata}

### [18.36 vp9_metadata](#toc-vp9_005fmetadata) {#vp9_metadata .section}

Modify metadata embedded in a VP9 stream.

`color_space`{.sample}

Set the color space value in the frame header. Note that any frame set
to RGB will be implicitly set to PC range and that RGB is incompatible
with profiles 0 and 2.

'`unknown`{.sample}'

'`bt601`{.sample}'

'`bt709`{.sample}'

'`smpte170`{.sample}'

'`smpte240`{.sample}'

'`bt2020`{.sample}'

'`rgb`{.sample}'

`color_range`{.sample}

Set the color range value in the frame header. Note that any value
imposed by the color space will take precedence over this value.

'`tv`{.sample}'

'`pc`{.sample}'

[]{#vp9_005fsuperframe}

### [18.37 vp9_superframe](#toc-vp9_005fsuperframe) {#vp9_superframe .section}

Merge VP9 invisible (alt-ref) frames back into VP9 superframes. This
fixes merging of split/segmented VP9 streams where the alt-ref frame was
split from its visible counterpart.

[]{#vp9_005fsuperframe_005fsplit}

### [18.38 vp9_superframe_split](#toc-vp9_005fsuperframe_005fsplit) {#vp9_superframe_split .section}

Split VP9 superframes into single frames.

[]{#vp9_005fraw_005freorder}

### [18.39 vp9_raw_reorder](#toc-vp9_005fraw_005freorder) {#vp9_raw_reorder .section}

Given a VP9 stream with correct timestamps but possibly out of order,
insert additional show-existing-frame packets to correct the ordering.

[]{#Format-Options}

## [19 Format Options](#toc-Format-Options) {#format-options .chapter}

The libavformat library provides some generic global options, which can
be set on all the muxers and demuxers. In addition each muxer or demuxer
may support so-called private options, which are specific for that
component.

Options may be set by specifying -`option`{.variable} `value`{.variable}
in the FFmpeg tools, or by setting the value explicitly in the
`AVFormatContext` options or using the `libavutil/opt.h`{.sample} API
for programmatic use.

The list of supported options follows:

`avioflags `{.sample}`flags`{.variable}` (`{.sample}*`input/output`{.sample}*`)`{.sample}

Possible values:

'`direct`{.sample}'

:   Reduce buffering.

`probesize `{.sample}`integer`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Set probing size in bytes, i.e. the size of the data to analyze to get
stream information. A higher value will enable detecting more
information in case it is dispersed into the stream, but will increase
latency. Must be an integer not lesser than 32. It is 5000000 by
default.

`max_probe_packets `{.sample}`integer`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Set the maximum number of buffered packets when probing a codec. Default
is 2500 packets.

`packetsize `{.sample}`integer`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

Set packet size.

`fflags `{.sample}`flags`{.variable}

Set format flags. Some are implemented for a limited number of formats.

Possible values for input files:

'`discardcorrupt`{.sample}'

:   Discard corrupted packets.

'`fastseek`{.sample}'

:   Enable fast, but inaccurate seeks for some formats.

'`genpts`{.sample}'

:   Generate missing PTS if DTS is present.

'`igndts`{.sample}'

:   Ignore DTS if PTS is also set. In case the PTS is set, the DTS value
    is set to NOPTS. This is ignored when the `nofillin` flag is set.

'`ignidx`{.sample}'

:   Ignore index.

'`nobuffer`{.sample}'

:   Reduce the latency introduced by buffering during initial input
    streams analysis.

'`nofillin`{.sample}'

:   Do not fill in missing values in packet fields that can be exactly
    calculated.

'`noparse`{.sample}'

:   Disable AVParsers, this needs `+nofillin` too.

'`sortdts`{.sample}'

:   Try to interleave output packets by DTS. At present, available only
    for AVIs with an index.

Possible values for output files:

'`autobsf`{.sample}'

:   Automatically apply bitstream filters as required by the output
    format. Enabled by default.

'`bitexact`{.sample}'

:   Only write platform-, build- and time-independent data. This ensures
    that file and data checksums are reproducible and match between
    platforms. Its primary use is for regression testing.

'`flush_packets`{.sample}'

:   Write out packets immediately.

'`shortest`{.sample}'

:   Stop muxing at the end of the shortest stream. It may be needed to
    increase max_interleave_delta to avoid flushing the longer streams
    before EOF.

`seek2any `{.sample}`integer`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Allow seeking to non-keyframes on demuxer level when supported if set
to 1. Default is 0.

`analyzeduration `{.sample}`integer`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Specify how many microseconds are analyzed to probe the input. A higher
value will enable detecting more accurate information, but will increase
latency. It defaults to 5,000,000 microseconds = 5 seconds.

`cryptokey `{.sample}`hexadecimal string`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Set decryption key.

`indexmem `{.sample}`integer`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Set max memory used for timestamp index (per stream).

`rtbufsize `{.sample}`integer`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Set max memory used for buffering real-time frames.

`fdebug `{.sample}`flags`{.variable}` (`{.sample}*`input/output`{.sample}*`)`{.sample}

Print specific debug info.

Possible values:

'`ts`{.sample}'

`max_delay `{.sample}`integer`{.variable}` (`{.sample}*`input/output`{.sample}*`)`{.sample}

Set maximum muxing or demuxing delay in microseconds.

`fpsprobesize `{.sample}`integer`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Set number of frames used to probe fps.

`audio_preload `{.sample}`integer`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

Set microseconds by which audio packets should be interleaved earlier.

`chunk_duration `{.sample}`integer`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

Set microseconds for each chunk.

`chunk_size `{.sample}`integer`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

Set size in bytes for each chunk.

`err_detect, f_err_detect `{.sample}`flags`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Set error detection flags. `f_err_detect` is deprecated and should be
used only via the `ffmpeg` tool.

Possible values:

'`crccheck`{.sample}'

:   Verify embedded CRCs.

'`bitstream`{.sample}'

:   Detect bitstream specification deviations.

'`buffer`{.sample}'

:   Detect improper bitstream length.

'`explode`{.sample}'

:   Abort decoding on minor error detection.

'`careful`{.sample}'

:   Consider things that violate the spec and have not been seen in the
    wild as errors.

'`compliant`{.sample}'

:   Consider all spec non compliancies as errors.

'`aggressive`{.sample}'

:   Consider things that a sane encoder should not do as an error.

`max_interleave_delta `{.sample}`integer`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

Set maximum buffering duration for interleaving. The duration is
expressed in microseconds, and defaults to 10000000 (10 seconds).

To ensure all the streams are interleaved correctly, libavformat will
wait until it has at least one packet for each stream before actually
writing any packets to the output file. When some streams are \"sparse\"
(i.e. there are large gaps between successive packets), this can result
in excessive buffering.

This field specifies the maximum difference between the timestamps of
the first and the last packet in the muxing queue, above which
libavformat will output a packet regardless of whether it has queued a
packet for all the streams.

If set to 0, libavformat will continue buffering packets until it has a
packet for each stream, regardless of the maximum timestamp difference
between the buffered packets.

`use_wallclock_as_timestamps `{.sample}`integer`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Use wallclock as timestamps if set to 1. Default is 0.

`avoid_negative_ts `{.sample}`integer`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

Possible values:

'`make_non_negative`{.sample}'

:   Shift timestamps to make them non-negative. Also note that this
    affects only leading negative timestamps, and not non-monotonic
    negative timestamps.

'`make_zero`{.sample}'

:   Shift timestamps so that the first timestamp is 0.

'`auto (default)`{.sample}'

:   Enables shifting when required by the target format.

'`disabled`{.sample}'

:   Disables shifting of timestamp.

When shifting is enabled, all output timestamps are shifted by the same
amount. Audio, video, and subtitles desynching and relative timestamp
differences are preserved compared to how they would have been without
shifting.

`skip_initial_bytes `{.sample}`integer`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Set number of bytes to skip before reading header and frames if set
to 1. Default is 0.

`correct_ts_overflow `{.sample}`integer`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Correct single timestamp overflows if set to 1. Default is 1.

`flush_packets `{.sample}`integer`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

Flush the underlying I/O stream after each packet. Default is -1 (auto),
which means that the underlying protocol will decide, 1 enables it, and
has the effect of reducing the latency, 0 disables it and may increase
IO throughput in some cases.

`output_ts_offset `{.sample}`offset`{.variable}` (`{.sample}*`output`{.sample}*`)`{.sample}

Set the output time offset.

`offset`{.variable} must be a time duration specification, see
[(ffmpeg-utils)the Time duration section in the ffmpeg-utils(1)
manual](ffmpeg-utils.html#time-duration-syntax).

The offset is added by the muxer to the output timestamps.

Specifying a positive offset means that the corresponding streams are
delayed bt the time duration specified in `offset`{.variable}. Default
value is `0` (meaning that no offset is applied).

`format_whitelist `{.sample}`list`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

\",\" separated list of allowed demuxers. By default all are allowed.

`dump_separator `{.sample}`string`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Separator used to separate the fields printed on the command line about
the Stream parameters. For example, to separate the fields with newlines
and indentation:

::: example
``` example
ffprobe -dump_separator "
                          "  -i ~/videos/matrixbench_mpeg2.mpg
```
:::

`max_streams `{.sample}`integer`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Specifies the maximum number of streams. This can be used to reject
files that would require too many resources due to a large number of
streams.

`skip_estimate_duration_from_pts `{.sample}`bool`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Skip estimation of input duration if it requires an additional probing
for PTS at end of file. At present, applicable for MPEG-PS and MPEG-TS.

`duration_probesize `{.sample}`integer`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

Set probing size, in bytes, for input duration estimation when it
actually requires an additional probing for PTS at end of file (at
present: MPEG-PS and MPEG-TS). It is aimed at users interested in better
durations probing for itself, or indirectly because using the concat
demuxer, for example. The typical use case is an MPEG-TS CBR with a high
bitrate, high video buffering and ending cleaning with similar PTS for
video and audio: in such a scenario, the large physical gap between the
last video packet and the last audio packet makes it necessary to read
many bytes in order to get the video stream duration. Another use case
is where the default probing behaviour only reaches a single video frame
which is not the last one of the stream due to frame reordering, so the
duration is not accurate. Setting this option has a performance impact
even for small files because the probing size is fixed. Default
behaviour is a general purpose trade-off, largely adaptive, but the
probing size will not be extended to get streams durations at all costs.
Must be an integer not lesser than 1, or 0 for default behaviour.

`strict, f_strict `{.sample}`integer`{.variable}` (`{.sample}*`input/output`{.sample}*`)`{.sample}

Specify how strictly to follow the standards. `f_strict` is deprecated
and should be used only via the `ffmpeg` tool.

Possible values:

'`very`{.sample}'

:   strictly conform to an older more strict version of the spec or
    reference software

'`strict`{.sample}'

:   strictly conform to all the things in the spec no matter what
    consequences

'`normal`{.sample}'\
'`unofficial`{.sample}'

:   allow unofficial extensions

'`experimental`{.sample}'

:   allow non standardized experimental things, experimental
    (unfinished/work in progress/not well tested) decoders and encoders.
    Note: experimental decoders can pose a security risk, do not use
    this for decoding untrusted input.

[]{#Format-stream-specifiers}[]{#Format-stream-specifiers-1}

### [19.1 Format stream specifiers](#toc-Format-stream-specifiers-1) {#format-stream-specifiers .section}

Format stream specifiers allow selection of one or more streams that
match specific properties.

The exact semantics of stream specifiers is defined by the
`avformat_match_stream_specifier()` function declared in the
`libavformat/avformat.h`{.sample} header and documented in the
[(ffmpeg)Stream specifiers section in the ffmpeg(1)
manual](ffmpeg.html#Stream-specifiers).

[]{#Demuxers}

## [20 Demuxers](#toc-Demuxers) {#demuxers .chapter}

Demuxers are configured elements in FFmpeg that can read the multimedia
streams from a particular type of file.

When you configure your FFmpeg build, all the supported demuxers are
enabled by default. You can list all available ones using the configure
option `--list-demuxers`.

You can disable all the demuxers using the configure option
`--disable-demuxers`, and selectively enable a single demuxer with the
option `--enable-demuxer=``DEMUXER`{.variable}, or disable it with the
option `--disable-demuxer=``DEMUXER`{.variable}.

The option `-demuxers` of the ff\* tools will display the list of
enabled demuxers. Use `-formats` to view a combined list of enabled
demuxers and muxers.

The description of some of the currently available demuxers follows.

[]{#aa}

### [20.1 aa](#toc-aa) {#aa .section}

Audible Format 2, 3, and 4 demuxer.

This demuxer is used to demux Audible Format 2, 3, and 4 (.aa) files.

[]{#aac-1}

### [20.2 aac](#toc-aac-1) {#aac-1 .section}

Raw Audio Data Transport Stream AAC demuxer.

This demuxer is used to demux an ADTS input containing a single AAC
stream alongwith any ID3v1/2 or APE tags in it.

[]{#apng}

### [20.3 apng](#toc-apng) {#apng .section}

Animated Portable Network Graphics demuxer.

This demuxer is used to demux APNG files. All headers, but the PNG
signature, up to (but not including) the first fcTL chunk are
transmitted as extradata. Frames are then split as being all the chunks
between two fcTL ones, or between the last fcTL and IEND chunks.

`-ignore_loop `{.sample}`bool`{.variable}

:   Ignore the loop variable in the file if set. Default is enabled.

`-max_fps `{.sample}`int`{.variable}

:   Maximum framerate in frames per second. Default of 0 imposes no
    limit.

`-default_fps `{.sample}`int`{.variable}

:   Default framerate in frames per second when none is specified in the
    file (0 meaning as fast as possible). Default is 15.

[]{#asf-1}

### [20.4 asf](#toc-asf-1) {#asf .section}

Advanced Systems Format demuxer.

This demuxer is used to demux ASF files and MMS network streams.

`-no_resync_search `{.sample}`bool`{.variable}

:   Do not try to resynchronize by looking for a certain optional start
    code.

[]{#concat}[]{#concat-1}

### [20.5 concat](#toc-concat-1) {#concat .section}

Virtual concatenation script demuxer.

This demuxer reads a list of files and other directives from a text file
and demuxes them one after the other, as if all their packets had been
muxed together.

The timestamps in the files are adjusted so that the first file starts
at 0 and each next file starts where the previous one finishes. Note
that it is done globally and may cause gaps if all streams do not have
exactly the same length.

All files must have the same streams (same codecs, same time base,
etc.).

The duration of each file is used to adjust the timestamps of the next
file: if the duration is incorrect (because it was computed using the
bit-rate or because the file is truncated, for example), it can cause
artifacts. The `duration` directive can be used to override the duration
stored in each file.

[]{#Syntax-1}

#### [20.5.1 Syntax](#toc-Syntax-1) {#syntax-1 .subsection}

The script is a text file in extended-ASCII, with one directive per
line. Empty lines, leading spaces and lines starting with '#' are
ignored. The following directive is recognized:

`file ``path`{.variable}

:   Path to a file to read; special characters and spaces must be
    escaped with backslash or single quotes.

    All subsequent file-related directives apply to that file.

`ffconcat version 1.0`

:   Identify the script type and version.

    To make FFmpeg recognize the format automatically, this directive
    must appear exactly as is (no extra space or byte-order-mark) on the
    very first line of the script.

`duration ``dur`{.variable}

:   Duration of the file. This information can be specified from the
    file; specifying it here may be more efficient or help if the
    information from the file is not available or accurate.

    If the duration is set for all files, then it is possible to seek in
    the whole concatenated video.

`inpoint ``timestamp`{.variable}

:   In point of the file. When the demuxer opens the file it instantly
    seeks to the specified timestamp. Seeking is done so that all
    streams can be presented successfully at In point.

    This directive works best with intra frame codecs, because for
    non-intra frame ones you will usually get extra packets before the
    actual In point and the decoded content will most likely contain
    frames before In point too.

    For each file, packets before the file In point will have timestamps
    less than the calculated start timestamp of the file (negative in
    case of the first file), and the duration of the files (if not
    specified by the `duration` directive) will be reduced based on
    their specified In point.

    Because of potential packets before the specified In point, packet
    timestamps may overlap between two concatenated files.

`outpoint ``timestamp`{.variable}

:   Out point of the file. When the demuxer reaches the specified
    decoding timestamp in any of the streams, it handles it as an end of
    file condition and skips the current and all the remaining packets
    from all streams.

    Out point is exclusive, which means that the demuxer will not output
    packets with a decoding timestamp greater or equal to Out point.

    This directive works best with intra frame codecs and formats where
    all streams are tightly interleaved. For non-intra frame codecs you
    will usually get additional packets with presentation timestamp
    after Out point therefore the decoded content will most likely
    contain frames after Out point too. If your streams are not tightly
    interleaved you may not get all the packets from all streams before
    Out point and you may only will be able to decode the earliest
    stream until Out point.

    The duration of the files (if not specified by the `duration`
    directive) will be reduced based on their specified Out point.

`file_packet_metadata ``key=value`{.variable}

:   Metadata of the packets of the file. The specified metadata will be
    set for each file packet. You can specify this directive multiple
    times to add multiple metadata entries. This directive is
    deprecated, use `file_packet_meta` instead.

`file_packet_meta ``key`{.variable}` ``value`{.variable}

:   Metadata of the packets of the file. The specified metadata will be
    set for each file packet. You can specify this directive multiple
    times to add multiple metadata entries.

`option ``key`{.variable}` ``value`{.variable}

:   Option to access, open and probe the file. Can be present multiple
    times.

`stream`

:   Introduce a stream in the virtual file. All subsequent
    stream-related directives apply to the last introduced stream. Some
    streams properties must be set in order to allow identifying the
    matching streams in the subfiles. If no streams are defined in the
    script, the streams from the first file are copied.

`exact_stream_id ``id`{.variable}

:   Set the id of the stream. If this directive is given, the string
    with the corresponding id in the subfiles will be used. This is
    especially useful for MPEG-PS (VOB) files, where the order of the
    streams is not reliable.

`stream_meta ``key`{.variable}` ``value`{.variable}

:   Metadata for the stream. Can be present multiple times.

`stream_codec ``value`{.variable}

:   Codec for the stream.

`stream_extradata ``hex_string`{.variable}

:   Extradata for the string, encoded in hexadecimal.

`chapter ``id`{.variable}` ``start`{.variable}` ``end`{.variable}

:   Add a chapter. `id`{.variable} is an unique identifier, possibly
    small and consecutive.

[]{#Options-57}

#### [20.5.2 Options](#toc-Options-57) {#options-57 .subsection}

This demuxer accepts the following option:

`safe`{.sample}

:   If set to 1, reject unsafe file paths and directives. A file path is
    considered safe if it does not contain a protocol specification and
    is relative and all components only contain characters from the
    portable character set (letters, digits, period, underscore and
    hyphen) and have no period at the beginning of a component.

    If set to 0, any file name is accepted.

    The default is 1.

`auto_convert`{.sample}

:   If set to 1, try to perform automatic conversions on packet data to
    make the streams concatenable. The default is 1.

    Currently, the only conversion is adding the h264_mp4toannexb
    bitstream filter to H.264 streams in MP4 format. This is necessary
    in particular if there are resolution changes.

`segment_time_metadata`{.sample}

:   If set to 1, every packet will contain the
    `lavf.concat.start_time`{.variable} and the
    `lavf.concat.duration`{.variable} packet metadata values which are
    the start_time and the duration of the respective file segments in
    the concatenated output expressed in microseconds. The duration
    metadata is only set if it is known based on the concat file. The
    default is 0.

[]{#Examples-8}

#### [20.5.3 Examples](#toc-Examples-8) {#examples-8 .subsection}

- Use absolute filenames and include some comments:

  ::: example
  ``` example
  # my first filename
  file /mnt/share/file-1.wav
  # my second filename including whitespace
  file '/mnt/share/file 2.wav'
  # my third filename including whitespace plus single quote
  file '/mnt/share/file 3'\''.wav'
  ```
  :::
- Allow for input format auto-probing, use safe filenames and set the
  duration of the first file:

  ::: example
  ``` example
  ffconcat version 1.0

  file file-1.wav
  duration 20.0

  file subdir/file-2.wav
  ```
  :::

[]{#dash-1}

### [20.6 dash](#toc-dash-1) {#dash .section}

Dynamic Adaptive Streaming over HTTP demuxer.

This demuxer presents all AVStreams found in the manifest. By setting
the discard flags on AVStreams the caller can decide which streams to
actually receive. Each stream mirrors the `id` and `bandwidth`
properties from the `<Representation>` as metadata keys named \"id\" and
\"variant_bitrate\" respectively.

[]{#Options-58}

#### [20.6.1 Options](#toc-Options-58) {#options-58 .subsection}

This demuxer accepts the following option:

`cenc_decryption_key`{.sample}

:   16-byte key, in hex, to decrypt files encrypted using ISO Common
    Encryption (CENC/AES-128 CTR; ISO/IEC 23001-7).

[]{#dvdvideo}

### [20.7 dvdvideo](#toc-dvdvideo) {#dvdvideo .section}

DVD-Video demuxer, powered by libdvdnav and libdvdread.

Can directly ingest DVD titles, specifically sequential PGCs, into a
conversion pipeline. Menu assets, such as background video or audio, can
also be demuxed given the menu's coordinates (at best effort).

Block devices (DVD drives), ISO files, and directory structures are
accepted. Activate with `-f dvdvideo` in front of one of these inputs.

This demuxer does NOT have decryption code of any kind. You are on your
own working with encrypted DVDs, and should not expect support on the
matter.

Underlying playback is handled by libdvdnav, and structure parsing by
libdvdread. FFmpeg must be built with GPL library support available as
well as the configure switches `--enable-libdvdnav` and
`--enable-libdvdread`.

You will need to provide either the desired \"title number\" or exact
PGC/PG coordinates. Many open-source DVD players and tools can aid in
providing this information. If not specified, the demuxer will default
to title 1 which works for many discs. However, due to the flexibility
of the format, it is recommended to check manually. There are many discs
that are authored strangely or with invalid headers.

If the input is a real DVD drive, please note that there are some drives
which may silently fail on reading bad sectors from the disc, returning
random bits instead which is effectively corrupt data. This is
especially prominent on aging or rotting discs. A second pass and
integrity checks would be needed to detect the corruption. This is not
an FFmpeg issue.

[]{#Background}

#### [20.7.1 Background](#toc-Background) {#background .subsection}

DVD-Video is not a directly accessible, linear container format in the
traditional sense. Instead, it allows for complex and programmatic
playback of carefully muxed MPEG-PS streams that are stored in
headerless VOB files. To the end-user, these streams are known simply as
\"titles\", but the actual logical playback sequence is defined by one
or more \"PGCs\", or Program Group Chains, within the title. The PGC is
in turn comprised of multiple \"PGs\", or Programs\", which are the
actual video segments (and for a typical video feature, sequentially
ordered). The PGC structure, along with stream layout and metadata, are
stored in IFO files that need to be parsed. PGCs can be thought of as
playlists in easier terms.

An actual DVD player relies on user GUI interaction via menus and an
internal VM to drive the direction of demuxing. Generally, the user
would either navigate (via menus) or automatically be redirected to the
PGC of their choice. During this process and the subsequent playback,
the DVD player's internal VM also maintains a state and executes
instructions that can create jumps to different sectors during playback.
This is why libdvdnav is involved, as a linear read of the MPEG-PS blobs
on the disc (VOBs) is not enough to produce the right sequence in many
cases.

There are many other DVD structures (a long subject) that will not be
discussed here. NAV packets, in particular, are handled by this demuxer
to build accurate timing but not emitted as a stream. For a good
high-level understanding, refer to:
<https://code.videolan.org/videolan/libdvdnav/-/blob/master/doc/dvd_structures>

[]{#Options-59}

#### [20.7.2 Options](#toc-Options-59) {#options-59 .subsection}

This demuxer accepts the following options:

`title `{.sample}`int`{.variable}

:   The title number to play. Must be set if `pgc`{.sample} and
    `pg`{.sample} are not set. Not applicable to menus. Default is 0
    (auto), which currently only selects the first available title
    (title 1) and notifies the user about the implications.

`chapter_start `{.sample}`int`{.variable}

:   The chapter, or PTT (part-of-title), number to start at. Not
    applicable to menus. Default is 1.

`chapter_end `{.sample}`int`{.variable}

:   The chapter, or PTT (part-of-title), number to end at. Not
    applicable to menus. Default is 0, which is a special value to
    signal end at the last possible chapter.

`angle `{.sample}`int`{.variable}

:   The video angle number, referring to what is essentially an
    additional video stream that is composed from alternate frames
    interleaved in the VOBs. Not applicable to menus. Default is 1.

`region `{.sample}`int`{.variable}

:   The region code to use for playback. Some discs may use this to
    default playback at a particular angle in different regions. This
    option will not affect the region code of a real DVD drive, if used
    as an input. Not applicable to menus. Default is 0, \"world\".

`menu `{.sample}`bool`{.variable}

:   Demux menu assets instead of navigating a title. Requires exact
    coordinates of the menu (`menu_lu`{.sample}, `menu_vts`{.sample},
    `pgc`{.sample}, `pg`{.sample}). Default is false.

`menu_lu `{.sample}`int`{.variable}

:   The menu language to demux. In DVD, menus are grouped by language.
    Default is 1, the first language unit.

`menu_vts `{.sample}`int`{.variable}

:   The VTS where the menu lives, or 0 if it is a VMG menu (root-level).
    Default is 1, menu of the first VTS.

`pgc `{.sample}`int`{.variable}

:   The entry PGC to start playback, in conjunction with `pg`{.sample}.
    Alternative to setting `title`{.sample}. Chapter markers are not
    supported at this time. Must be explicitly set for menus. Default is
    0, automatically resolve from value of `title`{.sample}.

`pg `{.sample}`int`{.variable}

:   The entry PG to start playback, in conjunction with `pgc`{.sample}.
    Alternative to setting `title`{.sample}. Chapter markers are not
    supported at this time. Default is 1, the first PG of the PGC.

`preindex `{.sample}`bool`{.variable}

:   Enable this to have accurate chapter (PTT) markers and duration
    measurement, which requires a slow second pass read in order to
    index the chapter marker timestamps from NAV packets. This is
    non-ideal extra work for real optical drives. It is recommended and
    faster to use this option with a backup of the DVD structure stored
    on a hard drive. Not compatible with `pgc`{.sample} and
    `pg`{.sample}. Default is 0, false.

`trim `{.sample}`bool`{.variable}

:   Skip padding cells (i.e. cells shorter than 1 second) from the
    beginning. There exist many discs with filler segments at the
    beginning of the PGC, often with junk data intended for controlling
    a real DVD player's buffering speed and with no other material data
    value. Not applicable to menus. Default is 1, true.

[]{#Examples-9}

#### [20.7.3 Examples](#toc-Examples-9) {#examples-9 .subsection}

- Open title 3 from a given DVD structure:

  ::: example
  ``` example
  ffmpeg -f dvdvideo -title 3 -i <path to DVD> ...
  ```
  :::
- Open chapters 3-6 from title 1 from a given DVD structure:

  ::: example
  ``` example
  ffmpeg -f dvdvideo -chapter_start 3 -chapter_end 6 -title 1 -i <path to DVD> ...
  ```
  :::
- Open only chapter 5 from title 1 from a given DVD structure:

  ::: example
  ``` example
  ffmpeg -f dvdvideo -chapter_start 5 -chapter_end 5 -title 1 -i <path to DVD> ...
  ```
  :::
- Demux menu with language 1 from VTS 1, PGC 1, starting at PG 1:

  ::: example
  ``` example
  ffmpeg -f dvdvideo -menu 1 -menu_lu 1 -menu_vts 1 -pgc 1 -pg 1 -i <path to DVD> ...
  ```
  :::

[]{#ea}

### [20.8 ea](#toc-ea) {#ea .section}

Electronic Arts Multimedia format demuxer.

This format is used by various Electronic Arts games.

[]{#Options-60}

#### [20.8.1 Options](#toc-Options-60) {#options-60 .subsection}

`merge_alpha `{.sample}`bool`{.variable}

:   Normally the VP6 alpha channel (if exists) is returned as a
    secondary video stream, by setting this option you can make the
    demuxer return a single video stream which contains the alpha
    channel in addition to the ordinary video.

[]{#imf}

### [20.9 imf](#toc-imf) {#imf .section}

Interoperable Master Format demuxer.

This demuxer presents audio and video streams found in an IMF
Composition, as specified in [SMPTE ST
2067-2](https://doi.org/10.5594/SMPTE.ST2067-2.2020).

::: example
``` example
ffmpeg [-assetmaps <path of ASSETMAP1>,<path of ASSETMAP2>,...] -i <path of CPL> ...
```
:::

If `-assetmaps` is not specified, the demuxer looks for a file called
`ASSETMAP.xml`{.sample} in the same directory as the CPL.

[]{#flv_002c-live_005fflv_002c-kux}

### [20.10 flv, live_flv, kux](#toc-flv_002c-live_005fflv_002c-kux) {#flv-live_flv-kux .section}

Adobe Flash Video Format demuxer.

This demuxer is used to demux FLV files and RTMP network streams. In
case of live network streams, if you force format, you may use live_flv
option instead of flv to survive timestamp discontinuities. KUX is a flv
variant used on the Youku platform.

::: example
``` example
ffmpeg -f flv -i myfile.flv ...
ffmpeg -f live_flv -i rtmp://<any.server>/anything/key ....
```
:::

`-flv_metadata `{.sample}`bool`{.variable}

:   Allocate the streams according to the onMetaData array content.

`-flv_ignore_prevtag `{.sample}`bool`{.variable}

:   Ignore the size of previous tag value.

`-flv_full_metadata `{.sample}`bool`{.variable}

:   Output all context of the onMetadata.

[]{#gif-1}

### [20.11 gif](#toc-gif-1) {#gif-1 .section}

Animated GIF demuxer.

It accepts the following options:

`min_delay`{.sample}

:   Set the minimum valid delay between frames in hundredths of seconds.
    Range is 0 to 6000. Default value is 2.

`max_gif_delay`{.sample}

:   Set the maximum valid delay between frames in hundredth of seconds.
    Range is 0 to 65535. Default value is 65535 (nearly eleven minutes),
    the maximum value allowed by the specification.

`default_delay`{.sample}

:   Set the default delay between frames in hundredths of seconds. Range
    is 0 to 6000. Default value is 10.

`ignore_loop`{.sample}

:   GIF files can contain information to loop a certain number of times
    (or infinitely). If `ignore_loop`{.sample} is set to 1, then the
    loop setting from the input will be ignored and looping will not
    occur. If set to 0, then looping will occur and will cycle the
    number of times according to the GIF. Default value is 1.

For example, with the overlay filter, place an infinitely looping GIF
over another video:

::: example
``` example
ffmpeg -i input.mp4 -ignore_loop 0 -i input.gif -filter_complex overlay=shortest=1 out.mkv
```
:::

Note that in the above example the shortest option for overlay filter is
used to end the output video at the length of the shortest input file,
which in this case is `input.mp4`{.sample} as the GIF in this example
loops infinitely.

[]{#hls-1}

### [20.12 hls](#toc-hls-1) {#hls .section}

HLS demuxer

Apple HTTP Live Streaming demuxer.

This demuxer presents all AVStreams from all variant streams. The id
field is set to the bitrate variant index number. By setting the discard
flags on AVStreams (by pressing 'a' or 'v' in ffplay), the caller can
decide which variant streams to actually receive. The total bitrate of
the variant that the stream belongs to is available in a metadata key
named \"variant_bitrate\".

It accepts the following options:

`live_start_index`{.sample}

:   segment index to start live streams at (negative values are from the
    end).

`prefer_x_start`{.sample}

:   prefer to use #EXT-X-START if it's in playlist instead of
    live_start_index.

`allowed_extensions`{.sample}

:   ',' separated list of file extensions that hls is allowed to access.

`extension_picky`{.sample}

:   This blocks disallowed extensions from probing It also requires all
    available segments to have matching extensions to the format except
    mpegts, which is always allowed. It is recommended to set the
    whitelists correctly instead of depending on extensions Enabled by
    default.

`max_reload`{.sample}

:   Maximum number of times a insufficient list is attempted to be
    reloaded. Default value is 1000.

`m3u8_hold_counters`{.sample}

:   The maximum number of times to load m3u8 when it refreshes without
    new segments. Default value is 1000.

`http_persistent`{.sample}

:   Use persistent HTTP connections. Applicable only for HTTP streams.
    Enabled by default.

`http_multiple`{.sample}

:   Use multiple HTTP connections for downloading HTTP segments. Enabled
    by default for HTTP/1.1 servers.

`http_seekable`{.sample}

:   Use HTTP partial requests for downloading HTTP segments. 0 =
    disable, 1 = enable, -1 = auto, Default is auto.

`seg_format_options`{.sample}

:   Set options for the demuxer of media segments using a list of
    key=value pairs separated by `:`.

`seg_max_retry`{.sample}

:   Maximum number of times to reload a segment on error, useful when
    segment skip on network error is not desired. Default value is 0.

[]{#image2-1}

### [20.13 image2](#toc-image2-1) {#image2 .section}

Image file demuxer.

This demuxer reads from a list of image files specified by a pattern.
The syntax and meaning of the pattern is specified by the option
`pattern_type`{.variable}.

The pattern may contain a suffix which is used to automatically
determine the format of the images contained in the files.

The size, the pixel format, and the format of each image must be the
same for all the files in the sequence.

This demuxer accepts the following options:

`framerate`{.sample}

:   Set the frame rate for the video stream. It defaults to 25.

`loop`{.sample}

:   If set to 1, loop over the input. Default value is 0.

`pattern_type`{.sample}

:   Select the pattern type used to interpret the provided filename.

    `pattern_type`{.variable} accepts one of the following values.

    `none`{.sample}

    :   Disable pattern matching, therefore the video will only contain
        the specified image. You should use this option if you do not
        want to create sequences from multiple images and your filenames
        may contain special pattern characters.

    `sequence`{.sample}

    :   Select a sequence pattern type, used to specify a sequence of
        files indexed by sequential numbers.

        A sequence pattern may contain the string \"%d\" or
        \"%0`N`{.variable}d\", which specifies the position of the
        characters representing a sequential number in each filename
        matched by the pattern. If the form \"%d0`N`{.variable}d\" is
        used, the string representing the number in each filename is
        0-padded and `N`{.variable} is the total number of 0-padded
        digits representing the number. The literal character '%' can be
        specified in the pattern with the string \"%%\".

        If the sequence pattern contains \"%d\" or
        \"%0`N`{.variable}d\", the first filename of the file list
        specified by the pattern must contain a number inclusively
        contained between `start_number`{.variable} and
        `start_number`{.variable}+`start_number_range`{.variable}-1, and
        all the following numbers must be sequential.

        For example the pattern \"img-%03d.bmp\" will match a sequence
        of filenames of the form `img-001.bmp`{.sample},
        `img-002.bmp`{.sample}, \..., `img-010.bmp`{.sample}, etc.; the
        pattern \"i%%m%%g-%d.jpg\" will match a sequence of filenames of
        the form `i%m%g-1.jpg`{.sample}, `i%m%g-2.jpg`{.sample}, \...,
        `i%m%g-10.jpg`{.sample}, etc.

        Note that the pattern must not necessarily contain \"%d\" or
        \"%0`N`{.variable}d\", for example to convert a single image
        file `img.jpeg`{.sample} you can employ the command:

        ::: example
        ``` example
        ffmpeg -i img.jpeg img.png
        ```
        :::

    `glob`{.sample}

    :   Select a glob wildcard pattern type.

        The pattern is interpreted like a `glob()` pattern. This is only
        selectable if libavformat was compiled with globbing support.

    Default value is `sequence`{.variable}.

`pixel_format`{.sample}

:   Set the pixel format of the images to read. If not specified the
    pixel format is guessed from the first image file in the sequence.

`start_number`{.sample}

:   Set the index of the file matched by the image file pattern to start
    to read from. Default value is 0.

`start_number_range`{.sample}

:   Set the index interval range to check when looking for the first
    image file in the sequence, starting from `start_number`{.variable}.
    Default value is 5.

`ts_from_file`{.sample}

:   If set to 1, will set frame timestamp to modification time of image
    file. Note that monotonity of timestamps is not provided: images go
    in the same order as without this option. Default value is 0. If set
    to 2, will set frame timestamp to the modification time of the image
    file in nanosecond precision.

`video_size`{.sample}

:   Set the video size of the images to read. If not specified the video
    size is guessed from the first image file in the sequence.

`export_path_metadata`{.sample}

:   If set to 1, will add two extra fields to the metadata found in
    input, making them also available for other filters (see
    `drawtext`{.variable} filter for examples). Default value is 0. The
    extra fields are described below:

    `lavf.image2dec.source_path`{.sample}

    :   Corresponds to the full path to the input file being read.

    `lavf.image2dec.source_basename`{.sample}

    :   Corresponds to the name of the file being read.

[]{#Examples-10}

#### [20.13.1 Examples](#toc-Examples-10) {#examples-10 .subsection}

- Use `ffmpeg` for creating a video from the images in the file sequence
  `img-001.jpeg`{.sample}, `img-002.jpeg`{.sample}, \..., assuming an
  input frame rate of 10 frames per second:

  ::: example
  ``` example
  ffmpeg -framerate 10 -i 'img-%03d.jpeg' out.mkv
  ```
  :::
- As above, but start by reading from a file with index 100 in the
  sequence:

  ::: example
  ``` example
  ffmpeg -framerate 10 -start_number 100 -i 'img-%03d.jpeg' out.mkv
  ```
  :::
- Read images matching the \"\*.png\" glob pattern , that is all the
  files terminating with the \".png\" suffix:

  ::: example
  ``` example
  ffmpeg -framerate 10 -pattern_type glob -i "*.png" out.mkv
  ```
  :::

[]{#libgme}

### [20.14 libgme](#toc-libgme) {#libgme .section}

The Game Music Emu library is a collection of video game music file
emulators.

See <https://bitbucket.org/mpyne/game-music-emu/overview> for more
information.

It accepts the following options:

`track_index`{.sample}

:   Set the index of which track to demux. The demuxer can only export
    one track. Track indexes start at 0. Default is to pick the first
    track. Number of tracks is exported as `tracks`{.variable} metadata
    entry.

`sample_rate`{.sample}

:   Set the sampling rate of the exported track. Range is 1000
    to 999999. Default is 44100.

`max_size `{.sample}*`(bytes)`{.sample}*

:   The demuxer buffers the entire file into memory. Adjust this value
    to set the maximum buffer size, which in turn, acts as a ceiling for
    the size of files that can be read. Default is 50 MiB.

[]{#libmodplug}

### [20.15 libmodplug](#toc-libmodplug) {#libmodplug .section}

ModPlug based module demuxer

See <https://github.com/Konstanty/libmodplug>

It will export one 2-channel 16-bit 44.1 kHz audio stream. Optionally, a
`pal8` 16-color video stream can be exported with or without printed
metadata.

It accepts the following options:

`noise_reduction`{.sample}

:   Apply a simple low-pass filter. Can be 1 (on) or 0 (off). Default is
    0.

`reverb_depth`{.sample}

:   Set amount of reverb. Range 0-100. Default is 0.

`reverb_delay`{.sample}

:   Set delay in ms, clamped to 40-250 ms. Default is 0.

`bass_amount`{.sample}

:   Apply bass expansion a.k.a. XBass or megabass. Range is 0 (quiet) to
    100 (loud). Default is 0.

`bass_range`{.sample}

:   Set cutoff i.e. upper-bound for bass frequencies. Range is 10-100
    Hz. Default is 0.

`surround_depth`{.sample}

:   Apply a Dolby Pro-Logic surround effect. Range is 0 (quiet) to 100
    (heavy). Default is 0.

`surround_delay`{.sample}

:   Set surround delay in ms, clamped to 5-40 ms. Default is 0.

`max_size`{.sample}

:   The demuxer buffers the entire file into memory. Adjust this value
    to set the maximum buffer size, which in turn, acts as a ceiling for
    the size of files that can be read. Range is 0 to 100 MiB. 0 removes
    buffer size limit (not recommended). Default is 5 MiB.

`video_stream_expr`{.sample}

:   String which is evaluated using the eval API to assign colors to the
    generated video stream. Variables which can be used are `x`, `y`,
    `w`, `h`, `t`, `speed`, `tempo`, `order`, `pattern` and `row`.

`video_stream`{.sample}

:   Generate video stream. Can be 1 (on) or 0 (off). Default is 0.

`video_stream_w`{.sample}

:   Set video frame width in 'chars' where one char indicates 8 pixels.
    Range is 20-512. Default is 30.

`video_stream_h`{.sample}

:   Set video frame height in 'chars' where one char indicates 8 pixels.
    Range is 20-512. Default is 30.

`video_stream_ptxt`{.sample}

:   Print metadata on video stream. Includes `speed`, `tempo`, `order`,
    `pattern`, `row` and `ts` (time in ms). Can be 1 (on) or 0 (off).
    Default is 1.

[]{#libopenmpt}

### [20.16 libopenmpt](#toc-libopenmpt) {#libopenmpt .section}

libopenmpt based module demuxer

See <https://lib.openmpt.org/libopenmpt/> for more information.

Some files have multiple subsongs (tracks) this can be set with the
`subsong`{.sample} option.

It accepts the following options:

`subsong`{.sample}

:   Set the subsong index. This can be either 'all', 'auto', or the
    index of the subsong. Subsong indexes start at 0. The default is
    'auto'.

    The default value is to let libopenmpt choose.

`layout`{.sample}

:   Set the channel layout. Valid values are 1, 2, and 4 channel
    layouts. The default value is STEREO.

`sample_rate`{.sample}

:   Set the sample rate for libopenmpt to output. Range is from 1000 to
    INT_MAX. The value default is 48000.

[]{#mccdec}[]{#mcc}

### [20.17 mcc](#toc-mcc) {#mcc .section}

Demuxer for MacCaption MCC files, it supports MCC versions 1.0 and 2.0.
MCC files store VANC data, which can include closed captions (EIA-608
and CEA-708), ancillary time code, pan-scan data, etc. By default, for
backward compatibility, the MCC demuxer extracts just the EIA-608 and
CEA-708 closed captions and returns a `EIA_608` stream, ignoring all
other VANC data. You can change it to return all VANC data in a
`SMPTE_436M_ANC` data stream by setting `-eia608_extract 0`{.sample}

[]{#Examples-11}

#### [20.17.1 Examples](#toc-Examples-11) {#examples-11 .subsection}

- Convert a MCC file to Scenarist (SCC) format:

  ::: example
  ``` example
  ffmpeg -i CC.mcc -c:s copy CC.scc
  ```
  :::

  Note that the SCC format only supports EIA-608, so this will discard
  all other data such as CEA-708 extensions.

- Merge a MCC file into a MXF file:

  ::: example
  ``` example
  ffmpeg -i video_and_audio.mxf -eia608_extract 0 -i CC.mcc -c copy -map 0 -map 1 out.mxf
  ```
  :::

  This retains all VANC data and inserts it into the output MXF file as
  a `SMPTE_436M_ANC` data stream.

[]{#mov_002fmp4_002f3gp}

### [20.18 mov/mp4/3gp](#toc-mov_002fmp4_002f3gp) {#movmp43gp .section}

Demuxer for Quicktime File Format & ISO/IEC Base Media File Format
(ISO/IEC 14496-12 or MPEG-4 Part 12, ISO/IEC 15444-12 or JPEG 2000 Part
12).

Registered extensions: mov, mp4, m4a, 3gp, 3g2, mj2, psp, m4b, ism,
ismv, isma, f4v

[]{#Options-61}

#### [20.18.1 Options](#toc-Options-61) {#options-61 .subsection}

This demuxer accepts the following options:

`enable_drefs`{.sample}

:   Enable loading of external tracks, disabled by default. Enabling
    this can theoretically leak information in some use cases.

`use_absolute_path`{.sample}

:   Allows loading of external tracks via absolute paths, disabled by
    default. Enabling this poses a security risk. It should only be
    enabled if the source is known to be non-malicious.

`seek_streams_individually`{.sample}

:   When seeking, identify the closest point in each stream individually
    and demux packets in that stream from identified point. This can
    lead to a different sequence of packets compared to demuxing
    linearly from the beginning. Default is true.

`ignore_editlist`{.sample}

:   Ignore any edit list atoms. The demuxer, by default, modifies the
    stream index to reflect the timeline described by the edit list.
    Default is false.

`advanced_editlist`{.sample}

:   Modify the stream index to reflect the timeline described by the
    edit list. `ignore_editlist` must be set to false for this option to
    be effective. If both `ignore_editlist` and this option are set to
    false, then only the start of the stream index is modified to
    reflect initial dwell time or starting timestamp described by the
    edit list. Default is true.

`ignore_chapters`{.sample}

:   Don't parse chapters. This includes GoPro 'HiLight' tags/moments.
    Note that chapters are only parsed when input is seekable. Default
    is false.

`use_mfra_for`{.sample}

:   For seekable fragmented input, set fragment's starting timestamp
    from media fragment random access box, if present.

    Following options are available:

    '`auto`{.sample}'

    :   Auto-detect whether to set mfra timestamps as PTS or DTS
        *(default)*

    '`dts`{.sample}'

    :   Set mfra timestamps as DTS

    '`pts`{.sample}'

    :   Set mfra timestamps as PTS

    '`0`{.sample}'

    :   Don't use mfra box to set timestamps

`use_tfdt`{.sample}

:   For fragmented input, set fragment's starting timestamp to
    `baseMediaDecodeTime` from the `tfdt` box. Default is enabled, which
    will prefer to use the `tfdt` box to set DTS. Disable to use the
    `earliest_presentation_time` from the `sidx` box. In either case,
    the timestamp from the `mfra` box will be used if it's available and
    `use_mfra_for` is set to pts or dts.

`export_all`{.sample}

:   Export unrecognized boxes within the `udta`{.variable} box as
    metadata entries. The first four characters of the box type are set
    as the key. Default is false.

`export_xmp`{.sample}

:   Export entire contents of `XMP_`{.variable} box and
    `uuid`{.variable} box as a string with key `xmp`. Note that if
    `export_all` is set and this option isn't, the contents of
    `XMP_`{.variable} box are still exported but with key `XMP_`.
    Default is false.

`activation_bytes`{.sample}

:   4-byte key required to decrypt Audible AAX and AAX+ files. See
    Audible AAX subsection below.

`audible_fixed_key`{.sample}

:   Fixed key used for handling Audible AAX/AAX+ files. It has been
    pre-set so should not be necessary to specify.

`decryption_key`{.sample}

:   16-byte key, in hex, to decrypt files encrypted using ISO Common
    Encryption (CENC/AES-128 CTR; ISO/IEC 23001-7).

`max_stts_delta`{.sample}

:   Very high sample deltas written in a trak's stts box may
    occasionally be intended but usually they are written in error or
    used to store a negative value for dts correction when treated as
    signed 32-bit integers. This option lets the user set an upper
    limit, beyond which the delta is clamped to 1. Values greater than
    the limit if negative when cast to int32 are used to adjust onward
    dts.

    Unit is the track time scale. Range is 0 to UINT_MAX. Default is
    `UINT_MAX - 48000*10` which allows up to a 10 second dts correction
    for 48 kHz audio streams while accommodating 99.9% of `uint32`
    range.

`interleaved_read`{.sample}

:   Interleave packets from multiple tracks at demuxer level. For badly
    interleaved files, this prevents playback issues caused by large
    gaps between packets in different tracks, as MOV/MP4 do not have
    packet placement requirements. However, this can cause excessive
    seeking on very badly interleaved files, due to seeking between
    tracks, so disabling it may prevent I/O issues, at the expense of
    playback.

[]{#Audible-AAX}

#### [20.18.2 Audible AAX](#toc-Audible-AAX) {#audible-aax .subsection}

Audible AAX files are encrypted M4B files, and they can be decrypted by
specifying a 4 byte activation secret.

::: example
``` example
ffmpeg -activation_bytes 1CEB00DA -i test.aax -vn -c:a copy output.mp4
```
:::

[]{#mpegts}

### [20.19 mpegts](#toc-mpegts) {#mpegts .section}

MPEG-2 transport stream demuxer.

This demuxer accepts the following options:

`resync_size`{.sample}

:   Set size limit for looking up a new synchronization. Default value
    is 65536.

`skip_unknown_pmt`{.sample}

:   Skip PMTs for programs not defined in the PAT. Default value is 0.

`fix_teletext_pts`{.sample}

:   Override teletext packet PTS and DTS values with the timestamps
    calculated from the PCR of the first program which the teletext
    stream is part of and is not discarded. Default value is 1, set this
    option to 0 if you want your teletext packet PTS and DTS values
    untouched.

`ts_packetsize`{.sample}

:   Output option carrying the raw packet size in bytes. Show the
    detected raw packet size, cannot be set by the user.

`scan_all_pmts`{.sample}

:   Scan and combine all PMTs. The value is an integer with value from
    -1 to 1 (-1 means automatic setting, 1 means enabled, 0 means
    disabled). Default value is -1.

`merge_pmt_versions`{.sample}

:   Reuse existing streams when a PMT's version is updated and
    elementary streams move to different PIDs. Default value is 0.

`max_packet_size`{.sample}

:   Set maximum size, in bytes, of packet emitted by the demuxer.
    Payloads above this size are split across multiple packets. Range is
    1 to INT_MAX/2. Default is 204800 bytes.

[]{#mpjpeg}

### [20.20 mpjpeg](#toc-mpjpeg) {#mpjpeg .section}

MJPEG encapsulated in multi-part MIME demuxer.

This demuxer allows reading of MJPEG, where each frame is represented as
a part of multipart/x-mixed-replace stream.

`strict_mime_boundary`{.sample}

:   Default implementation applies a relaxed standard to multi-part MIME
    boundary detection, to prevent regression with numerous existing
    endpoints not generating a proper MIME MJPEG stream. Turning this
    option on by setting it to 1 will result in a stricter check of the
    boundary value.

[]{#rawvideo-1}

### [20.21 rawvideo](#toc-rawvideo-1) {#rawvideo-1 .section}

Raw video demuxer.

This demuxer allows one to read raw video data. Since there is no header
specifying the assumed video parameters, the user must specify them in
order to be able to decode the data correctly.

This demuxer accepts the following options:

`framerate`{.sample}

:   Set input video frame rate. Default value is 25.

`pixel_format`{.sample}

:   Set the input video pixel format. Default value is `yuv420p`.

`stride`{.sample}

:   Set frame line size in bytes, only required if there are extra
    padding. For multiplane formats, `stride`{.sample} is a list of line
    size for each plane.

`video_size`{.sample}

:   Set the input video size. This value must be specified explicitly.

For example to read a rawvideo file `input.raw`{.sample} with `ffplay`,
assuming a pixel format of `rgb24`, a video size of `320x240`, and a
frame rate of 10 images per second, use the command:

::: example
``` example
ffplay -f rawvideo -pixel_format rgb24 -video_size 320x240 -framerate 10 input.raw
```
:::

Read a rawvideo with `ffplay`, assuming a pixel format of `yuv420p`, a
video size of `1080x1920`, has 8 bytes of padding in each line of Y
plane, and 4 bytes of padding with UV plane,

::: example
``` example
ffplay -f rawvideo -pixel_format yuv420p -video_size 1080x1920 -stride 1088,544,544 input.raw
```
:::

[]{#rcwtdec}[]{#rcwt}

### [20.22 rcwt](#toc-rcwt) {#rcwt .section}

RCWT (Raw Captions With Time) is a format native to ccextractor, a
commonly used open source tool for processing 608/708 Closed Captions
(CC) sources. For more information on the format, see
[(ffmpeg-formats)rcwtenc](ffmpeg-formats.html#rcwtenc).

This demuxer implements the specification as of March 2024, which has
been stable and unchanged since April 2014.

[]{#Examples-12}

#### [20.22.1 Examples](#toc-Examples-12) {#examples-12 .subsection}

- Render CC to ASS using the built-in decoder:

  ::: example
  ``` example
  ffmpeg -i CC.rcwt.bin CC.ass
  ```
  :::

  Note that if your output appears to be empty, you may have to manually
  set the decoder's `data_field`{.sample} option to pick the desired CC
  substream.

- Convert an RCWT backup to Scenarist (SCC) format:

  ::: example
  ``` example
  ffmpeg -i CC.rcwt.bin -c:s copy CC.scc
  ```
  :::

  Note that the SCC format does not support all of the possible CC
  extensions that can be stored in RCWT (such as EIA-708).

[]{#sbg}

### [20.23 sbg](#toc-sbg) {#sbg .section}

SBaGen script demuxer.

This demuxer reads the script language used by SBaGen
<http://uazu.net/sbagen/> to generate binaural beats sessions. A SBG
script looks like that:

::: example
``` example
-SE
a: 300-2.5/3 440+4.5/0
b: 300-2.5/0 440+4.5/3
off: -
NOW      == a
+0:07:00 == b
+0:14:00 == a
+0:21:00 == b
+0:30:00    off
```
:::

A SBG script can mix absolute and relative timestamps. If the script
uses either only absolute timestamps (including the script start time)
or only relative ones, then its layout is fixed, and the conversion is
straightforward. On the other hand, if the script mixes both kind of
timestamps, then the `NOW`{.variable} reference for relative timestamps
will be taken from the current time of day at the time the script is
read, and the script layout will be frozen according to that reference.
That means that if the script is directly played, the actual times will
match the absolute timestamps up to the sound controller's clock
accuracy, but if the user somehow pauses the playback or seeks, all
times will be shifted accordingly.

[]{#tedcaptions}

### [20.24 tedcaptions](#toc-tedcaptions) {#tedcaptions .section}

JSON captions used for [TED Talks](http://www.ted.com/).

TED does not provide links to the captions, but they can be guessed from
the page. The file `tools/bookmarklets.html`{.sample} from the FFmpeg
source tree contains a bookmarklet to expose them.

This demuxer accepts the following option:

`start_time`{.sample}

:   Set the start time of the TED talk, in milliseconds. The default is
    15000 (15s). It is used to sync the captions with the downloadable
    videos, because they include a 15s intro.

Example: convert the captions to a format most players understand:

::: example
``` example
ffmpeg -i http://www.ted.com/talks/subtitles/id/1/lang/en talk1-en.srt
```
:::

[]{#vapoursynth}

### [20.25 vapoursynth](#toc-vapoursynth) {#vapoursynth .section}

Vapoursynth wrapper.

Due to security concerns, Vapoursynth scripts will not be autodetected
so the input format has to be forced. For ff\* CLI tools, add
`-f vapoursynth` before the input `-i yourscript.vpy`.

This demuxer accepts the following option:

`max_script_size`{.sample}

:   The demuxer buffers the entire script into memory. Adjust this value
    to set the maximum buffer size, which in turn, acts as a ceiling for
    the size of scripts that can be read. Default is 1 MiB.

[]{#w64}

### [20.26 w64](#toc-w64) {#w64 .section}

Sony Wave64 Audio demuxer.

This demuxer accepts the following options:

`max_size`{.sample}

:   See the same option for the [wav](#wav) demuxer.

[]{#wav}[]{#wav-1}

### [20.27 wav](#toc-wav-1) {#wav .section}

RIFF Wave Audio demuxer.

This demuxer accepts the following options:

`max_size`{.sample}

:   Specify the maximum packet size in bytes for the demuxed packets. By
    default this is set to 0, which means that a sensible value is
    chosen based on the input format.

[]{#Muxers}

## [21 Muxers](#toc-Muxers) {#muxers .chapter}

Muxers are configured elements in FFmpeg which allow writing multimedia
streams to a particular type of file.

When you configure your FFmpeg build, all the supported muxers are
enabled by default. You can list all available muxers using the
configure option `--list-muxers`.

You can disable all the muxers with the configure option
`--disable-muxers` and selectively enable / disable single muxers with
the options `--enable-muxer=``MUXER`{.variable} /
`--disable-muxer=``MUXER`{.variable}.

The option `-muxers` of the ff\* tools will display the list of enabled
muxers. Use `-formats` to view a combined list of enabled demuxers and
muxers.

A description of some of the currently available muxers follows.

[]{#raw-muxers}[]{#Raw-muxers}

### [21.1 Raw muxers](#toc-Raw-muxers) {#raw-muxers .section}

This section covers raw muxers. They accept a single stream matching the
designated codec. They do not store timestamps or metadata. The
recognized extension is the same as the muxer name unless indicated
otherwise.

It comprises the following muxers. The media type and the eventual
extensions used to automatically selects the muxer from the output
extensions are also shown.

'`ac3 `{.sample}*`audio`{.sample}*'

:   Dolby Digital, also known as AC-3.

'`adx `{.sample}*`audio`{.sample}*'

:   CRI Middleware ADX audio.

    This muxer will write out the total sample count near the start of
    the first packet when the output is seekable and the count can be
    stored in 32 bits.

'`aptx `{.sample}*`audio`{.sample}*'

:   aptX (Audio Processing Technology for Bluetooth)

'`aptx_hd `{.sample}*`audio`{.sample}*` (aptxdh)`{.sample}'

:   aptX HD (Audio Processing Technology for Bluetooth) audio

'`avs2 `{.sample}*`video`{.sample}*` (avs, avs2)`{.sample}'

:   AVS2-P2 (Audio Video Standard - Second generation - Part 2) / IEEE
    1857.4 video

'`avs3 `{.sample}*`video`{.sample}*` (avs3)`{.sample}'

:   AVS3-P2 (Audio Video Standard - Third generation - Part 2) / IEEE
    1857.10 video

'`cavsvideo `{.sample}*`video`{.sample}*` (cavs)`{.sample}'

:   Chinese AVS (Audio Video Standard - First generation)

'`codec2raw `{.sample}*`audio`{.sample}*'

:   Codec 2 audio.

    No extension is registered so format name has to be supplied e.g.
    with the ffmpeg CLI tool `-f codec2raw`.

'`data `{.sample}*`any`{.sample}*'

:   Generic data muxer.

    This muxer accepts a single stream with any codec of any type. The
    input stream has to be selected using the `-map` option with the
    `ffmpeg` CLI tool.

    No extension is registered so format name has to be supplied e.g.
    with the `ffmpeg` CLI tool `-f data`.

'`dfpwm `{.sample}*`audio`{.sample}*` (dfpwm)`{.sample}'

:   Raw DFPWM1a (Dynamic Filter Pulse With Modulation) audio muxer.

'`dirac `{.sample}*`video`{.sample}*` (drc, vc2)`{.sample}'

:   BBC Dirac video.

    The Dirac Pro codec is a subset and is standardized as SMPTE VC-2.

'`dnxhd `{.sample}*`video`{.sample}*` (dnxhd, dnxhr)`{.sample}'

:   Avid DNxHD video.

    It is standardized as SMPTE VC-3. Accepts DNxHR streams.

'`dts `{.sample}*`audio`{.sample}*'

:   DTS Coherent Acoustics (DCA) audio

'`eac3 `{.sample}*`audio`{.sample}*'

:   Dolby Digital Plus, also known as Enhanced AC-3

'`evc `{.sample}*`video`{.sample}*` (evc)`{.sample}'

:   MPEG-5 Essential Video Coding (EVC) / EVC / MPEG-5 Part 1 EVC video

'`g722 `{.sample}*`audio`{.sample}*'

:   ITU-T G.722 audio

'`g723_1 `{.sample}*`audio`{.sample}*` (tco, rco)`{.sample}'

:   ITU-T G.723.1 audio

'`g726 `{.sample}*`audio`{.sample}*'

:   ITU-T G.726 big-endian (\"left-justified\") audio.

    No extension is registered so format name has to be supplied e.g.
    with the `ffmpeg` CLI tool `-f g726`.

'`g726le `{.sample}*`audio`{.sample}*'

:   ITU-T G.726 little-endian (\"right-justified\") audio.

    No extension is registered so format name has to be supplied e.g.
    with the `ffmpeg` CLI tool `-f g726le`.

'`gsm `{.sample}*`audio`{.sample}*'

:   Global System for Mobile Communications audio

'`h261 `{.sample}*`video`{.sample}*'

:   ITU-T H.261 video

'`h263 `{.sample}*`video`{.sample}*'

:   ITU-T H.263 / H.263-1996, H.263+ / H.263-1998 / H.263 version 2
    video

'`h264 `{.sample}*`video`{.sample}*` (h264, 264)`{.sample}'

:   ITU-T H.264 / MPEG-4 Part 10 AVC video. Bitstream shall be converted
    to Annex B syntax if it's in length-prefixed mode.

'`hevc `{.sample}*`video`{.sample}*` (hevc, h265, 265)`{.sample}'

:   ITU-T H.265 / MPEG-H Part 2 HEVC video. Bitstream shall be converted
    to Annex B syntax if it's in length-prefixed mode.

'`m4v `{.sample}*`video`{.sample}*'

:   MPEG-4 Part 2 video

'`mjpeg `{.sample}*`video`{.sample}*` (mjpg, mjpeg)`{.sample}'

:   Motion JPEG video

'`mlp `{.sample}*`audio`{.sample}*'

:   Meridian Lossless Packing, also known as Packed PCM

'`mp2 `{.sample}*`audio`{.sample}*` (mp2, m2a, mpa)`{.sample}'

:   MPEG-1 Audio Layer II audio

'`mpeg1video `{.sample}*`video`{.sample}*` (mpg, mpeg, m1v)`{.sample}'

:   MPEG-1 Part 2 video.

'`mpeg2video `{.sample}*`video`{.sample}*` (m2v)`{.sample}'

:   ITU-T H.262 / MPEG-2 Part 2 video

'`obu `{.sample}*`video`{.sample}*'

:   AV1 low overhead Open Bitstream Units muxer.

    Temporal delimiter OBUs will be inserted in all temporal units of
    the stream.

'`rawvideo `{.sample}*`video`{.sample}*` (yuv, rgb)`{.sample}'

:   Raw uncompressed video.

'`sbc `{.sample}*`audio`{.sample}*` (sbc, msbc)`{.sample}'

:   Bluetooth SIG low-complexity subband codec audio

'`truehd `{.sample}*`audio`{.sample}*` (thd)`{.sample}'

:   Dolby TrueHD audio

'`vc1 `{.sample}*`video`{.sample}*'

:   SMPTE 421M / VC-1 video

[]{#Examples-13}

#### [21.1.1 Examples](#toc-Examples-13) {#examples-13 .subsection}

- Store raw video frames with the '`rawvideo`{.sample}' muxer using
  `ffmpeg`:

  ::: example
  ``` example
  ffmpeg -f lavfi -i testsrc -t 10 -s hd1080p testsrc.yuv
  ```
  :::

  Since the rawvideo muxer do not store the information related to size
  and format, this information must be provided when demuxing the file:

  ::: example
  ``` example
  ffplay -video_size 1920x1080 -pixel_format rgb24 -f rawvideo testsrc.rgb
  ```
  :::

[]{#Raw-PCM-muxers}

### [21.2 Raw PCM muxers](#toc-Raw-PCM-muxers) {#raw-pcm-muxers .section}

This section covers raw PCM (Pulse-Code Modulation) audio muxers.

They accept a single stream matching the designated codec. They do not
store timestamps or metadata. The recognized extension is the same as
the muxer name.

It comprises the following muxers. The optional additional extension
used to automatically select the muxer from the output extension is also
shown in parentheses.

'`alaw (al)`{.sample}'

:   PCM A-law

'`f32be`{.sample}'

:   PCM 32-bit floating-point big-endian

'`f32le`{.sample}'

:   PCM 32-bit floating-point little-endian

'`f64be`{.sample}'

:   PCM 64-bit floating-point big-endian

'`f64le`{.sample}'

:   PCM 64-bit floating-point little-endian

'`mulaw (ul)`{.sample}'

:   PCM mu-law

'`s16be`{.sample}'

:   PCM signed 16-bit big-endian

'`s16le`{.sample}'

:   PCM signed 16-bit little-endian

'`s24be`{.sample}'

:   PCM signed 24-bit big-endian

'`s24le`{.sample}'

:   PCM signed 24-bit little-endian

'`s32be`{.sample}'

:   PCM signed 32-bit big-endian

'`s32le`{.sample}'

:   PCM signed 32-bit little-endian

'`s8 (sb)`{.sample}'

:   PCM signed 8-bit

'`u16be`{.sample}'

:   PCM unsigned 16-bit big-endian

'`u16le`{.sample}'

:   PCM unsigned 16-bit little-endian

'`u24be`{.sample}'

:   PCM unsigned 24-bit big-endian

'`u24le`{.sample}'

:   PCM unsigned 24-bit little-endian

'`u32be`{.sample}'

:   PCM unsigned 32-bit big-endian

'`u32le`{.sample}'

:   PCM unsigned 32-bit little-endian

'`u8 (ub)`{.sample}'

:   PCM unsigned 8-bit

'`vidc`{.sample}'

:   PCM Archimedes VIDC

[]{#MPEG_002d1_002fMPEG_002d2-program-stream-muxers}

### [21.3 MPEG-1/MPEG-2 program stream muxers](#toc-MPEG_002d1_002fMPEG_002d2-program-stream-muxers) {#mpeg-1mpeg-2-program-stream-muxers .section}

This section covers formats belonging to the MPEG-1 and MPEG-2 Systems
family.

The MPEG-1 Systems format (also known as ISO/IEEC 11172-1 or MPEG-1
program stream) has been adopted for the format of media track stored in
VCD (Video Compact Disc).

The MPEG-2 Systems standard (also known as ISO/IEEC 13818-1) covers two
containers formats, one known as transport stream and one known as
program stream; only the latter is covered here.

The MPEG-2 program stream format (also known as VOB due to the
corresponding file extension) is an extension of MPEG-1 program stream:
in addition to support different codecs for the audio and video streams,
it also stores subtitles and navigation metadata. MPEG-2 program stream
has been adopted for storing media streams in SVCD and DVD storage
devices.

This section comprises the following muxers.

'`mpeg (mpg,mpeg)`{.sample}'

:   MPEG-1 Systems / MPEG-1 program stream muxer.

'`vcd`{.sample}'

:   MPEG-1 Systems / MPEG-1 program stream (VCD) muxer.

    This muxer can be used to generate tracks in the format accepted by
    the VCD (Video Compact Disc) storage devices.

    It is the same as the '`mpeg`{.sample}' muxer with a few
    differences.

'`vob`{.sample}'

:   MPEG-2 program stream (VOB) muxer.

'`dvd`{.sample}'

:   MPEG-2 program stream (DVD VOB) muxer.

    This muxer can be used to generate tracks in the format accepted by
    the DVD (Digital Versatile Disc) storage devices.

    This is the same as the '`vob`{.sample}' muxer with a few
    differences.

'`svcd (vob)`{.sample}'

:   MPEG-2 program stream (SVCD VOB) muxer.

    This muxer can be used to generate tracks in the format accepted by
    the SVCD (Super Video Compact Disc) storage devices.

    This is the same as the '`vob`{.sample}' muxer with a few
    differences.

[]{#Options-62}

#### [21.3.1 Options](#toc-Options-62) {#options-62 .subsection}

`muxrate `{.sample}`rate`{.variable}

:   Set user-defined mux rate expressed as a number of bits/s. If not
    specified the automatically computed mux rate is employed. Default
    value is `0`.

`preload `{.sample}`delay`{.variable}

:   Set initial demux-decode delay in microseconds. Default value is
    `500000`.

[]{#MOV_002fMPEG_002d4_002fISOMBFF-muxers}

### [21.4 MOV/MPEG-4/ISOMBFF muxers](#toc-MOV_002fMPEG_002d4_002fISOMBFF-muxers) {#movmpeg-4isombff-muxers .section}

This section covers formats belonging to the QuickTime / MOV family,
including the MPEG-4 Part 14 format and ISO base media file format
(ISOBMFF). These formats share a common structure based on the ISO base
media file format (ISOBMFF).

The MOV format was originally developed for use with Apple QuickTime. It
was later used as the basis for the MPEG-4 Part 1 (later Part 14)
format, also known as ISO/IEC 14496-1. That format was then generalized
into ISOBMFF, also named MPEG-4 Part 12 format, ISO/IEC 14496-12, or
ISO/IEC 15444-12.

It comprises the following muxers.

'`3gp`{.sample}'

:   Third Generation Partnership Project (3GPP) format for 3G UMTS
    multimedia services

'`3g2`{.sample}'

:   Third Generation Partnership Project 2 (3GP2 or 3GPP2) format for 3G
    CDMA2000 multimedia services, similar to '`3gp`{.sample}' with
    extensions and limitations

'`f4v`{.sample}'

:   Adobe Flash Video format

'`ipod`{.sample}'

:   MPEG-4 audio file format, as MOV/MP4 but limited to contain only
    audio streams, typically played with the Apple ipod device

'`ismv`{.sample}'

:   Microsoft IIS (Internet Information Services) Smooth Streaming
    Audio/Video (ISMV or ISMA) format. This is based on MPEG-4 Part 14
    format with a few incompatible variants, used to stream media files
    for the Microsoft IIS server.

'`mov`{.sample}'

:   QuickTime player format identified by the `.mov` extension

'`mp4`{.sample}'

:   MP4 or MPEG-4 Part 14 format

'`psp`{.sample}'

:   PlayStation Portable MP4/MPEG-4 Part 14 format variant. This is
    based on MPEG-4 Part 14 format with a few incompatible variants,
    used to play files on PlayStation devices.

[]{#Fragmentation}

#### [21.4.1 Fragmentation](#toc-Fragmentation) {#fragmentation .subsection}

The '`mov`{.sample}', '`mp4`{.sample}', and '`ismv`{.sample}' muxers
support fragmentation. Normally, a MOV/MP4 file has all the metadata
about all packets stored in one location.

This data is usually written at the end of the file, but it can be moved
to the start for better playback by adding `+faststart` to the
`-movflags`, or using the `qt-faststart` tool).

A fragmented file consists of a number of fragments, where packets and
metadata about these packets are stored together. Writing a fragmented
file has the advantage that the file is decodable even if the writing is
interrupted (while a normal MOV/MP4 is undecodable if it is not properly
finished), and it requires less memory when writing very long files
(since writing normal MOV/MP4 files stores info about every single
packet in memory until the file is closed). The downside is that it is
less compatible with other applications.

Fragmentation is enabled by setting one of the options that define how
to cut the file into fragments:

`frag_duration`{.sample}

`frag_size`{.sample}

`min_frag_duration`{.sample}

`movflags +frag_keyframe`{.sample}

`movflags +frag_custom`{.sample}

If more than one condition is specified, fragments are cut when one of
the specified conditions is fulfilled. The exception to this is the
option `min_frag_duration`{.sample}, which has to be fulfilled for any
of the other conditions to apply.

[]{#Options-63}

#### [21.4.2 Options](#toc-Options-63) {#options-63 .subsection}

`brand `{.sample}`brand_string`{.variable}

:   Override major brand.

`empty_hdlr_name `{.sample}`bool`{.variable}

:   Enable to skip writing the name inside a `hdlr` box. Default is
    `false`.

`encryption_key `{.sample}`key`{.variable}

:   set the media encryption key in hexadecimal format

`encryption_kid `{.sample}`kid`{.variable}

:   set the media encryption key identifier in hexadecimal format

`encryption_scheme `{.sample}`scheme`{.variable}

:   configure the encryption scheme, allowed values are
    '`none`{.sample}', and '`cenc-aes-ctr`{.sample}'

`frag_duration `{.sample}`duration`{.variable}

:   Create fragments that are `duration`{.variable} microseconds long.

`frag_interleave `{.sample}`number`{.variable}

:   Interleave samples within fragments (max number of consecutive
    samples, lower is tighter interleaving, but with more overhead. It
    is set to `0` by default.

`frag_size `{.sample}`size`{.variable}

:   create fragments that contain up to `size`{.variable} bytes of
    payload data

`iods_audio_profile `{.sample}`profile`{.variable}

:   specify iods number for the audio profile atom (from -1 to 255),
    default is `-1`

`iods_video_profile `{.sample}`profile`{.variable}

:   specify iods number for the video profile atom (from -1 to 255),
    default is `-1`

`ism_lookahead `{.sample}`num_entries`{.variable}

:   specify number of lookahead entries for ISM files (from 0 to 255),
    default is `0`

`min_frag_duration `{.sample}`duration`{.variable}

:   do not create fragments that are shorter than `duration`{.variable}
    microseconds long

`moov_size `{.sample}`bytes`{.variable}

:   Reserves space for the moov atom at the beginning of the file
    instead of placing the moov atom at the end. If the space reserved
    is insufficient, muxing will fail.

`mov_gamma `{.sample}`gamma`{.variable}

:   specify gamma value for gama atom (as a decimal number from 0 to
    10), default is `0.0`, must be set together with `+ movflags`

`movflags `{.sample}`flags`{.variable}

:   Set various muxing switches. The following flags can be used:

    '`cmaf`{.sample}'

    :   write CMAF (Common Media Application Format) compatible
        fragmented MP4 output

    '`dash`{.sample}'

    :   write DASH (Dynamic Adaptive Streaming over HTTP) compatible
        fragmented MP4 output

    '`default_base_moof`{.sample}'

    :   Similarly to the '`omit_tfhd_offset`{.sample}' flag, this flag
        avoids writing the absolute base_data_offset field in tfhd
        atoms, but does so by using the new default-base-is-moof flag
        instead. This flag is new from 14496-12:2012. This may make the
        fragments easier to parse in certain circumstances (avoiding
        basing track fragment location calculations on the implicit end
        of the previous track fragment).

    '`delay_moov`{.sample}'

    :   delay writing the initial moov until the first fragment is cut,
        or until the first fragment flush

    '`disable_chpl`{.sample}'

    :   Disable Nero chapter markers (chpl atom). Normally, both Nero
        chapters and a QuickTime chapter track are written to the file.
        With this option set, only the QuickTime chapter track will be
        written. Nero chapters can cause failures when the file is
        reprocessed with certain tagging programs, like mp3Tag 2.61a and
        iTunes 11.3, most likely other versions are affected as well.

    '`faststart`{.sample}'

    :   Run a second pass moving the index (moov atom) to the beginning
        of the file. This operation can take a while, and will not work
        in various situations such as fragmented output, thus it is not
        enabled by default.

    '`frag_custom`{.sample}'

    :   Allow the caller to manually choose when to cut fragments, by
        calling `av_write_frame(ctx, NULL)` to write a fragment with the
        packets written so far. (This is only useful with other
        applications integrating libavformat, not from `ffmpeg`.)

    '`frag_discont`{.sample}'

    :   signal that the next fragment is discontinuous from earlier ones

    '`frag_every_frame`{.sample}'

    :   fragment at every frame

    '`frag_keyframe`{.sample}'

    :   start a new fragment at each video keyframe

    '`global_sidx`{.sample}'

    :   write a global sidx index at the start of the file

    '`isml`{.sample}'

    :   create a live smooth streaming feed (for pushing to a publishing
        point)

    '`negative_cts_offsets`{.sample}'

    :   Enables utilization of version 1 of the CTTS box, in which the
        CTS offsets can be negative. This enables the initial sample to
        have DTS/CTS of zero, and reduces the need for edit lists for
        some cases such as video tracks with B-frames. Additionally,
        eases conformance with the DASH-IF interoperability guidelines.

        This option is implicitly set when writing '`ismv`{.sample}'
        (Smooth Streaming) files.

    '`omit_tfhd_offset`{.sample}'

    :   Do not write any absolute base_data_offset in tfhd atoms. This
        avoids tying fragments to absolute byte positions in the
        file/streams.

    '`prefer_icc`{.sample}'

    :   If writing colr atom prioritise usage of ICC profile if it
        exists in stream packet side data.

    '`rtphint`{.sample}'

    :   add RTP hinting tracks to the output file

    '`separate_moof`{.sample}'

    :   Write a separate moof (movie fragment) atom for each track.
        Normally, packets for all tracks are written in a moof atom
        (which is slightly more efficient), but with this option set,
        the muxer writes one moof/mdat pair for each track, making it
        easier to separate tracks.

    '`skip_sidx`{.sample}'

    :   Skip writing of sidx atom. When bitrate overhead due to sidx
        atom is high, this option could be used for cases where sidx
        atom is not mandatory. When the '`global_sidx`{.sample}' flag is
        enabled, this option is ignored.

    '`skip_trailer`{.sample}'

    :   skip writing the mfra/tfra/mfro trailer for fragmented files

    '`use_metadata_tags`{.sample}'

    :   use mdta atom for metadata

    '`write_colr`{.sample}'

    :   write colr atom even if the color info is unspecified. This flag
        is experimental, may be renamed or changed, do not use from
        scripts.

    '`write_gama`{.sample}'

    :   write deprecated gama atom

    '`hybrid_fragmented`{.sample}'

    :   For recoverability - write the output file as a fragmented file.
        This allows the intermediate file to be read while being written
        (in particular, if the writing process is aborted uncleanly).
        When writing is finished, the file is converted to a regular,
        non-fragmented file, which is more compatible and allows easier
        and quicker seeking.

        If writing is aborted, the intermediate file can manually be
        remuxed to get a regular, non-fragmented file of what had been
        written into the unfinished file.

`movie_timescale `{.sample}`scale`{.variable}

:   Set the timescale written in the movie header box (`mvhd`). Range is
    1 to INT_MAX. Default is `1000`.

`rtpflags `{.sample}`flags`{.variable}

:   Add RTP hinting tracks to the output file.

    The following flags can be used:

    '`h264_mode0`{.sample}'

    :   use mode 0 for H.264 in RTP

    '`latm`{.sample}'

    :   use MP4A-LATM packetization instead of MPEG4-GENERIC for AAC

    '`rfc2190`{.sample}'

    :   use RFC 2190 packetization instead of RFC 4629 for H.263

    '`send_bye`{.sample}'

    :   send RTCP BYE packets when finishing

    '`skip_rtcp`{.sample}'

    :   do not send RTCP sender reports

`skip_iods `{.sample}`bool`{.variable}

:   skip writing iods atom (default value is `true`)

`use_editlist `{.sample}`bool`{.variable}

:   use edit list (default value is `auto`)

`use_stream_ids_as_track_ids `{.sample}`bool`{.variable}

:   use stream ids as track ids (default value is `false`)

`video_track_timescale `{.sample}`scale`{.variable}

:   Set the timescale used for video tracks. Range is `0` to INT_MAX. If
    set to `0`, the timescale is automatically set based on the native
    stream time base. Default is `0`.

`write_btrt `{.sample}`bool`{.variable}

:   Force or disable writing bitrate box inside stsd box of a track. The
    box contains decoding buffer size (in bytes), maximum bitrate and
    average bitrate for the track. The box will be skipped if none of
    these values can be computed. Default is `-1` or `auto`, which will
    write the box only in MP4 mode.

`write_prft `{.sample}`option`{.variable}

:   Write producer time reference box (PRFT) with a specified time
    source for the NTP field in the PRFT box. Set value as
    '`wallclock`{.sample}' to specify timesource as wallclock time and
    '`pts`{.sample}' to specify timesource as input packets' PTS values.

`write_tmcd `{.sample}`bool`{.variable}

:   Specify `on` to force writing a timecode track, `off` to disable it
    and `auto` to write a timecode track only for mov and mp4 output
    (default).

    Setting value to '`pts`{.sample}' is applicable only for a live
    encoding use case, where PTS values are set as as wallclock time at
    the source. For example, an encoding use case with decklink capture
    source where `video_pts`{.sample} and `audio_pts`{.sample} are set
    to '`abs_wallclock`{.sample}'.

[]{#Examples-14}

#### [21.4.3 Examples](#toc-Examples-14) {#examples-14 .subsection}

- Push Smooth Streaming content in real time to a publishing point on
  IIS with the '`ismv`{.sample}' muxer using `ffmpeg`:

  ::: example
  ``` example
  ffmpeg -re <normal input/transcoding options> -movflags isml+frag_keyframe -f ismv http://server/publishingpoint.isml/Streams(Encoder1)
  ```
  :::

[]{#a64}[]{#a64-1}

### [21.5 a64](#toc-a64-1) {#a64 .section}

A64 Commodore 64 video muxer.

This muxer accepts a single `a64_multi` or `a64_multi5` codec video
stream.

[]{#ac4}

### [21.6 ac4](#toc-ac4) {#ac4 .section}

Raw AC-4 audio muxer.

This muxer accepts a single `ac4` audio stream.

[]{#Options-64}

#### [21.6.1 Options](#toc-Options-64) {#options-64 .subsection}

`write_crc `{.sample}`bool`{.variable}

:   when enabled, write a CRC checksum for each packet to the output,
    default is `false`

[]{#adts}[]{#adts-1}

### [21.7 adts](#toc-adts-1) {#adts .section}

Audio Data Transport Stream muxer.

It accepts a single AAC stream.

[]{#Options-65}

#### [21.7.1 Options](#toc-Options-65) {#options-65 .subsection}

`write_id3v2 `{.sample}`bool`{.variable}

:   Enable to write ID3v2.4 tags at the start of the stream. Default is
    disabled.

`write_apetag `{.sample}`bool`{.variable}

:   Enable to write APE tags at the end of the stream. Default is
    disabled.

`write_mpeg2 `{.sample}`bool`{.variable}

:   Enable to set MPEG version bit in the ADTS frame header to 1 which
    indicates MPEG-2. Default is 0, which indicates MPEG-4.

[]{#aea}[]{#aea-1}

### [21.8 aea](#toc-aea-1) {#aea .section}

MD STUDIO audio muxer.

This muxer accepts a single ATRAC1 audio stream with either one or two
channels and a sample rate of 44100Hz.

As AEA supports storing the track title, this muxer will also write the
title from stream's metadata to the container.

[]{#aiff}[]{#aiff-1}

### [21.9 aiff](#toc-aiff-1) {#aiff .section}

Audio Interchange File Format muxer.

[]{#Options-66}

#### [21.9.1 Options](#toc-Options-66) {#options-66 .subsection}

`write_id3v2 `{.sample}`bool`{.variable}

:   Enable ID3v2 tags writing when set to 1. Default is 0 (disabled).

`id3v2_version `{.sample}`bool`{.variable}

:   Select ID3v2 version to write. Currently only version 3 and 4 (aka.
    ID3v2.3 and ID3v2.4) are supported. The default is version 4.

[]{#alp}[]{#alp-1}

### [21.10 alp](#toc-alp-1) {#alp .section}

High Voltage Software's Lego Racers game audio muxer.

It accepts a single ADPCM_IMA_ALP stream with no more than 2 channels
and a sample rate not greater than 44100 Hz.

Extensions: `tun`, `pcm`

[]{#Options-67}

#### [21.10.1 Options](#toc-Options-67) {#options-67 .subsection}

`type `{.sample}`type`{.variable}

:   Set file type.

    `type`{.variable} accepts the following values:

    '`tun`{.sample}'

    :   Set file type as music. Must have a sample rate of 22050 Hz.

    '`pcm`{.sample}'

    :   Set file type as sfx.

    '`auto`{.sample}'

    :   Set file type as per output file extension. `.pcm` results in
        type `pcm` else type `tun` is set. `(default)`{.variable}

[]{#amr}

### [21.11 amr](#toc-amr) {#amr .section}

3GPP AMR (Adaptive Multi-Rate) audio muxer.

It accepts a single audio stream containing an AMR NB stream.

[]{#amv}

### [21.12 amv](#toc-amv) {#amv .section}

AMV (Actions Media Video) format muxer.

[]{#apm}

### [21.13 apm](#toc-apm) {#apm .section}

Ubisoft Rayman 2 APM audio muxer.

It accepts a single ADPCM IMA APM audio stream.

[]{#apng-1}

### [21.14 apng](#toc-apng-1) {#apng-1 .section}

Animated Portable Network Graphics muxer.

It accepts a single APNG video stream.

[]{#Options-68}

#### [21.14.1 Options](#toc-Options-68) {#options-68 .subsection}

`final_delay `{.sample}`delay`{.variable}

:   Force a delay expressed in seconds after the last frame of each
    repetition. Default value is `0.0`.

`plays `{.sample}`repetitions`{.variable}

:   specify how many times to play the content, `0` causes an infinite
    loop, with `1` there is no loop

[]{#Examples-15}

#### [21.14.2 Examples](#toc-Examples-15) {#examples-15 .subsection}

- Use `ffmpeg` to generate an APNG output with 2 repetitions, and with a
  delay of half a second after the first repetition:

  ::: example
  ``` example
  ffmpeg -i INPUT -final_delay 0.5 -plays 2 out.apng
  ```
  :::

[]{#argo_005fasf}

### [21.15 argo_asf](#toc-argo_005fasf) {#argo_asf .section}

Argonaut Games ASF audio muxer.

It accepts a single ADPCM audio stream.

[]{#Options-69}

#### [21.15.1 Options](#toc-Options-69) {#options-69 .subsection}

`version_major `{.sample}`version`{.variable}

:   override file major version, specified as an integer, default value
    is `2`

`version_minor `{.sample}`version`{.variable}

:   override file minor version, specified as an integer, default value
    is `1`

`name `{.sample}`name`{.variable}

:   Embed file name into file, if not specified use the output file
    name. The name is truncated to 8 characters.

[]{#argo_005fcvg}

### [21.16 argo_cvg](#toc-argo_005fcvg) {#argo_cvg .section}

Argonaut Games CVG audio muxer.

It accepts a single one-channel ADPCM 22050Hz audio stream.

The `loop`{.sample} and `reverb`{.sample} options set the corresponding
flags in the header which can be later retrieved to process the audio
stream accordingly.

[]{#Options-70}

#### [21.16.1 Options](#toc-Options-70) {#options-70 .subsection}

`skip_rate_check `{.sample}`bool`{.variable}

:   skip sample rate check (default is `false`)

`loop `{.sample}`bool`{.variable}

:   set loop flag (default is `false`)

`reverb `{.sample}`boolean`{.variable}

:   set reverb flag (default is `true`)

[]{#asf}[]{#asf_002c-asf_005fstream}

### [21.17 asf, asf_stream](#toc-asf_002c-asf_005fstream) {#asf-asf_stream .section}

Advanced / Active Systems (or Streaming) Format audio muxer.

The '`asf_stream`{.sample}' variant should be selected for streaming.

Note that Windows Media Audio (wma) and Windows Media Video (wmv) use
this muxer too.

[]{#Options-71}

#### [21.17.1 Options](#toc-Options-71) {#options-71 .subsection}

`packet_size `{.sample}`size`{.variable}

:   Set the muxer packet size as a number of bytes. By tuning this
    setting you may reduce data fragmentation or muxer overhead
    depending on your source. Default value is `3200`, minimum is `100`,
    maximum is `64Ki`.

[]{#ass}

### [21.18 ass](#toc-ass) {#ass .section}

ASS/SSA (SubStation Alpha) subtitles muxer.

It accepts a single ASS subtitles stream.

[]{#Options-72}

#### [21.18.1 Options](#toc-Options-72) {#options-72 .subsection}

`ignore_readorder `{.sample}`bool`{.variable}

:   Write dialogue events immediately, even if they are out-of-order,
    default is `false`, otherwise they are cached until the expected
    time event is found.

[]{#ast}

### [21.19 ast](#toc-ast) {#ast .section}

AST (Audio Stream) muxer.

This format is used to play audio on some Nintendo Wii games.

It accepts a single audio stream.

The `loopstart`{.sample} and `loopend`{.sample} options can be used to
define a section of the file to loop for players honoring such options.

[]{#Options-73}

#### [21.19.1 Options](#toc-Options-73) {#options-73 .subsection}

`loopstart `{.sample}`start`{.variable}

:   Specify loop start position expressesd in milliseconds, from `-1` to
    `INT_MAX`, in case `-1` is set then no loop is specified (default
    -1) and the `loopend`{.sample} value is ignored.

`loopend `{.sample}`end`{.variable}

:   Specify loop end position expressed in milliseconds, from `0` to
    `INT_MAX`, default is `0`, in case `0` is set it assumes the total
    stream duration.

[]{#au}

### [21.20 au](#toc-au) {#au .section}

SUN AU audio muxer.

It accepts a single audio stream.

[]{#avi}[]{#avi-1}

### [21.21 avi](#toc-avi-1) {#avi .section}

Audio Video Interleaved muxer.

AVI is a proprietary format developed by Microsoft, and later formally
specified through the Open DML specification.

Because of differences in players implementations, it might be required
to set some options to make sure that the generated output can be
correctly played by the target player.

[]{#Options-74}

#### [21.21.1 Options](#toc-Options-74) {#options-74 .subsection}

`flipped_raw_rgb `{.sample}`bool`{.variable}

:   If set to `true`, store positive height for raw RGB bitmaps, which
    indicates bitmap is stored bottom-up. Note that this option does not
    flip the bitmap which has to be done manually beforehand, e.g. by
    using the '`vflip`{.sample}' filter. Default is `false` and
    indicates bitmap is stored top down.

`reserve_index_space `{.sample}`size`{.variable}

:   Reserve the specified amount of bytes for the OpenDML master index
    of each stream within the file header. By default additional master
    indexes are embedded within the data packets if there is no space
    left in the first master index and are linked together as a chain of
    indexes. This index structure can cause problems for some use cases,
    e.g. third-party software strictly relying on the OpenDML index
    specification or when file seeking is slow. Reserving enough index
    space in the file header avoids these problems.

    The required index space depends on the output file size and should
    be about 16 bytes per gigabyte. When this option is omitted or set
    to zero the necessary index space is guessed.

    Default value is `0`.

`write_channel_mask `{.sample}`bool`{.variable}

:   Write the channel layout mask into the audio stream header.

    This option is enabled by default. Disabling the channel mask can be
    useful in specific scenarios, e.g. when merging multiple audio
    streams into one for compatibility with software that only supports
    a single audio stream in AVI (see [(ffmpeg-filters)the \"amerge\"
    section in the ffmpeg-filters manual](ffmpeg-filters.html#amerge)).

[]{#avif}

### [21.22 avif](#toc-avif) {#avif .section}

AV1 (Alliance for Open Media Video codec 1) image format muxer.

This muxers stores images encoded using the AV1 codec.

It accepts one or two video streams. In case two video streams are
provided, the second one shall contain a single plane storing the alpha
mask.

In case more than one image is provided, the generated output is
considered an animated AVIF and the number of loops can be specified
with the `loop`{.sample} option.

This is based on the specification by Alliance for Open Media at url
<https://aomediacodec.github.io/av1-avif>.

[]{#Options-75}

#### [21.22.1 Options](#toc-Options-75) {#options-75 .subsection}

`loop `{.sample}`count`{.variable}

:   number of times to loop an animated AVIF, `0` specify an infinite
    loop, default is `0`

`movie_timescale `{.sample}`timescale`{.variable}

:   Set the timescale written in the movie header box (`mvhd`). Range is
    1 to INT_MAX. Default is `1000`.

[]{#avm2}

### [21.23 avm2](#toc-avm2) {#avm2 .section}

ShockWave Flash (SWF) / ActionScript Virtual Machine 2 (AVM2) format
muxer.

It accepts one audio stream, one video stream, or both.

[]{#bit}

### [21.24 bit](#toc-bit) {#bit .section}

G.729 (.bit) file format muxer.

It accepts a single G.729 audio stream.

[]{#caf}

### [21.25 caf](#toc-caf) {#caf .section}

Apple CAF (Core Audio Format) muxer.

It accepts a single audio stream.

[]{#codec2}

### [21.26 codec2](#toc-codec2) {#codec2 .section}

Codec2 audio audio muxer.

It accepts a single codec2 audio stream.

[]{#chromaprint}[]{#chromaprint-1}

### [21.27 chromaprint](#toc-chromaprint-1) {#chromaprint .section}

Chromaprint fingerprinter muxers.

To enable compilation of this filter you need to configure FFmpeg with
`--enable-chromaprint`.

This muxer feeds audio data to the Chromaprint library, which generates
a fingerprint for the provided audio data. See:
<https://acoustid.org/chromaprint>

It takes a single signed native-endian 16-bit raw audio stream of at
most 2 channels.

[]{#Options-76}

#### [21.27.1 Options](#toc-Options-76) {#options-76 .subsection}

`algorithm `{.sample}`version`{.variable}

:   Select version of algorithm to fingerprint with. Range is `0` to
    `4`. Version `3` enables silence detection. Default is `1`.

`fp_format `{.sample}`format`{.variable}

:   Format to output the fingerprint as. Accepts the following options:

    '`base64`{.sample}'

    :   Base64 compressed fingerprint *(default)*

    '`compressed`{.sample}'

    :   Binary compressed fingerprint

    '`raw`{.sample}'

    :   Binary raw fingerprint

`silence_threshold `{.sample}`threshold`{.variable}

:   Threshold for detecting silence. Range is from `-1` to `32767`,
    where `-1` disables silence detection. Silence detection can only be
    used with version `3` of the algorithm.

    Silence detection must be disabled for use with the AcoustID
    service. Default is `-1`.

[]{#crc}[]{#crc-1}

### [21.28 crc](#toc-crc-1) {#crc .section}

CRC (Cyclic Redundancy Check) muxer.

This muxer computes and prints the Adler-32 CRC of all the input audio
and video frames. By default audio frames are converted to signed 16-bit
raw audio and video frames to raw video before computing the CRC.

The output of the muxer consists of a single line of the form:
CRC=0x`CRC`{.variable}, where `CRC`{.variable} is a hexadecimal number
0-padded to 8 digits containing the CRC for all the decoded input
frames.

See also the [framecrc](#framecrc) muxer.

[]{#Examples-16}

#### [21.28.1 Examples](#toc-Examples-16) {#examples-16 .subsection}

- Use `ffmpeg` to compute the CRC of the input, and store it in the file
  `out.crc`{.sample}:

  ::: example
  ``` example
  ffmpeg -i INPUT -f crc out.crc
  ```
  :::
- Use `ffmpeg` to print the CRC to stdout with the command:

  ::: example
  ``` example
  ffmpeg -i INPUT -f crc -
  ```
  :::
- You can select the output format of each frame with `ffmpeg` by
  specifying the audio and video codec and format. For example, to
  compute the CRC of the input audio converted to PCM unsigned 8-bit and
  the input video converted to MPEG-2 video, use the command:

  ::: example
  ``` example
  ffmpeg -i INPUT -c:a pcm_u8 -c:v mpeg2video -f crc -
  ```
  :::

[]{#dash}[]{#dash-2}

### [21.29 dash](#toc-dash-2) {#dash-1 .section}

Dynamic Adaptive Streaming over HTTP (DASH) muxer.

This muxer creates segments and manifest files according to the
MPEG-DASH standard ISO/IEC 23009-1:2014 and following standard updates.

For more information see:

- ISO DASH Specification:
  <http://standards.iso.org/ittf/PubliclyAvailableStandards/c065274_ISO_IEC_23009-1_2014.zip>
- WebM DASH Specification:
  <https://sites.google.com/a/webmproject.org/wiki/adaptive-streaming/webm-dash-specification>

This muxer creates an MPD (Media Presentation Description) manifest file
and segment files for each stream. Segment files are placed in the same
directory of the MPD manifest file.

The segment filename might contain pre-defined identifiers used in the
manifest `SegmentTemplate` section as defined in section 5.3.9.4.4 of
the standard.

Available identifiers are `$RepresentationID$`, `$Number$`,
`$Bandwidth$`, and `$Time$`. In addition to the standard identifiers, an
ffmpeg-specific `$ext$` identifier is also supported. When specified,
`ffmpeg` will replace `$ext$` in the file name with muxing format's
extensions such as `mp4`, `webm` etc.

[]{#Options-77}

#### [21.29.1 Options](#toc-Options-77) {#options-77 .subsection}

`adaptation_sets `{.sample}`adaptation_sets`{.variable}

:   Assign streams to adaptation sets, specified in the MPD manifest
    `AdaptationSets` section.

    An adaptation set contains a set of one or more streams accessed as
    a single subset, e.g. corresponding streams encoded at different
    size selectable by the user depending on the available bandwidth, or
    to different audio streams with a different language.

    Each adaptation set is specified with the syntax:

    ::: example
    ``` example
    id=index,streams=streams
    ```
    :::

    where `index`{.variable} must be a numerical index, and
    `streams`{.variable} is a sequence of `,`-separated stream indices.
    Multiple adaptation sets can be specified, separated by spaces.

    To map all video (or audio) streams to an adaptation set, `v` (or
    `a`) can be used as stream identifier instead of IDs.

    When no assignment is defined, this defaults to an adaptation set
    for each stream.

    The following optional fields can also be specified:

    `descriptor`{.sample}

    :   Define the descriptor as defined by ISO/IEC
        23009-1:2014/Amd.2:2015.

        For example:

        ::: example
        ``` example
        <SupplementalProperty schemeIdUri=\"urn:mpeg:dash:srd:2014\" value=\"0,0,0,1,1,2,2\"/>
        ```
        :::

        The descriptor string should be a self-closing XML tag.

    `frag_duration`{.sample}

    :   Override the global fragment duration specified with the
        `frag_duration`{.sample} option.

    `frag_type`{.sample}

    :   Override the global fragment type specified with the
        `frag_type`{.sample} option.

    `seg_duration`{.sample}

    :   Override the global segment duration specified with the
        `seg_duration`{.sample} option.

    `trick_id`{.sample}

    :   Mark an adaptation set as containing streams meant to be used
        for Trick Mode for the referenced adaptation set.

    A few examples of possible values for the `adaptation_sets`{.sample}
    option follow:

    ::: example
    ``` example
    id=0,seg_duration=2,frag_duration=1,frag_type=duration,streams=v id=1,seg_duration=2,frag_type=none,streams=a
    ```
    :::

    ::: example
    ``` example
    id=0,seg_duration=2,frag_type=none,streams=0 id=1,seg_duration=10,frag_type=none,trick_id=0,streams=1
    ```
    :::

`dash_segment_type `{.sample}`type`{.variable}

:   Set DASH segment files type.

    Possible values:

    '`auto`{.sample}'

    :   The dash segment files format will be selected based on the
        stream codec. This is the default mode.

    '`mp4`{.sample}'

    :   the dash segment files will be in ISOBMFF/MP4 format

    '`webm`{.sample}'

    :   the dash segment files will be in WebM format

`extra_window_size `{.sample}`size`{.variable}

:   Set the maximum number of segments kept outside of the manifest
    before removing from disk.

`format_options `{.sample}`options_list`{.variable}

:   Set container format (mp4/webm) options using a `:`-separated list
    of key=value parameters. Values containing `:` special characters
    must be escaped.

`frag_duration `{.sample}`duration`{.variable}

:   Set the length in seconds of fragments within segments, fractional
    value can also be set.

`frag_type `{.sample}`type`{.variable}

:   Set the type of interval for fragmentation.

    Possible values:

    '`auto`{.sample}'

    :   set one fragment per segment

    '`every_frame`{.sample}'

    :   fragment at every frame

    '`duration`{.sample}'

    :   fragment at specific time intervals

    '`pframes`{.sample}'

    :   fragment at keyframes and following P-Frame reordering (Video
        only, experimental)

`global_sidx `{.sample}`bool`{.variable}

:   Write global `SIDX` atom. Applicable only for single file, mp4
    output, non-streaming mode.

`hls_master_name `{.sample}`file_name`{.variable}

:   HLS master playlist name. Default is `master.m3u8`{.sample}.

`hls_playlist `{.sample}`bool`{.variable}

:   Generate HLS playlist files. The master playlist is generated with
    filename specified by the `hls_master_name`{.sample} option. One
    media playlist file is generated for each stream with filenames
    `media_0.m3u8`{.sample}, `media_1.m3u8`{.sample}, etc.

`http_opts `{.sample}`http_opts`{.variable}

:   Specify a list of `:`-separated key=value options to pass to the
    underlying HTTP protocol. Applicable only for HTTP output.

`http_persistent `{.sample}`bool`{.variable}

:   Use persistent HTTP connections. Applicable only for HTTP output.

`http_user_agent `{.sample}`user_agent`{.variable}

:   Override User-Agent field in HTTP header. Applicable only for HTTP
    output.

`ignore_io_errors `{.sample}`bool`{.variable}

:   Ignore IO errors during open and write. Useful for long-duration
    runs with network output. This is disabled by default.

`index_correction `{.sample}`bool`{.variable}

:   Enable or disable segment index correction logic. Applicable only
    when `use_template`{.sample} is enabled and `use_timeline`{.sample}
    is disabled. This is disabled by default.

    When enabled, the logic monitors the flow of segment indexes. If a
    streams's segment index value is not at the expected real time
    position, then the logic corrects that index value.

    Typically this logic is needed in live streaming use cases. The
    network bandwidth fluctuations are common during long run streaming.
    Each fluctuation can cause the segment indexes fall behind the
    expected real time position.

`init_seg_name `{.sample}`init_name`{.variable}

:   DASH-templated name to use for the initialization segment. Default
    is `init-stream$RepresentationID$.$ext$`. `$ext$` is replaced with
    the file name extension specific for the segment format.

`ldash `{.sample}`bool`{.variable}

:   Enable Low-latency Dash by constraining the presence and values of
    some elements. This is disabled by default.

`lhls `{.sample}`bool`{.variable}

:   Enable Low-latency HLS (LHLS). Add `#EXT-X-PREFETCH` tag with
    current segment's URI. hls.js player folks are trying to standardize
    an open LHLS spec. The draft spec is available at
    <https://github.com/video-dev/hlsjs-rfcs/blob/lhls-spec/proposals/0001-lhls.md>.

    This option tries to comply with the above open spec. It enables
    `streaming`{.sample} and `hls_playlist`{.sample} options
    automatically. This is an experimental feature.

    Note: This is not Apple's version LHLS. See
    <https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis>

`master_m3u8_publish_rate `{.sample}`segment_intervals_count`{.variable}

:   Publish master playlist repeatedly every after specified number of
    segment intervals.

`max_playback_rate `{.sample}`rate`{.variable}

:   Set the maximum playback rate indicated as appropriate for the
    purposes of automatically adjusting playback latency and buffer
    occupancy during normal playback by clients.

`media_seg_name `{.sample}`segment_name`{.variable}

:   DASH-templated name to use for the media segments. Default is
    `chunk-stream$RepresentationID$-$Number%05d$.$ext$`. `$ext$` is
    replaced with the file name extension specific for the segment
    format.

`method `{.sample}`method`{.variable}

:   Use the given HTTP method to create output files. Generally set to
    `PUT` or `POST`.

`min_playback_rate `{.sample}`rate`{.variable}

:   Set the minimum playback rate indicated as appropriate for the
    purposes of automatically adjusting playback latency and buffer
    occupancy during normal playback by clients.

`mpd_profile `{.sample}`flags`{.variable}

:   Set one or more MPD manifest profiles.

    Possible values:

    '`dash`{.sample}'

    :   MPEG-DASH ISO Base media file format live profile

    '`dvb_dash`{.sample}'

    :   DVB-DASH profile

    Default value is `dash`.

`remove_at_exit `{.sample}`bool`{.variable}

:   Enable or disable removal of all segments when finished. This is
    disabled by default.

`seg_duration `{.sample}`duration`{.variable}

:   Set the segment length in seconds (fractional value can be set). The
    value is treated as average segment duration when the
    `use_template`{.sample} option is enabled and the
    `use_timeline`{.sample} option is disabled and as minimum segment
    duration for all the other use cases.

    Default value is `5`.

`single_file `{.sample}`bool`{.variable}

:   Enable or disable storing all segments in one file, accessed using
    byte ranges. This is disabled by default.

    The name of the single file can be specified with the
    `single_file_name`{.sample} option, if not specified assume the
    basename of the manifest file with the output format extension.

`single_file_name `{.sample}`file_name`{.variable}

:   DASH-templated name to use for the manifest `baseURL` element. Imply
    that the `single_file`{.sample} option is set to `true`{.variable}.
    In the template, `$ext$` is replaced with the file name extension
    specific for the segment format.

`streaming `{.sample}`bool`{.variable}

:   Enable or disable chunk streaming mode of output. In chunk streaming
    mode, each frame will be a `moof` fragment which forms a chunk. This
    is disabled by default.

`target_latency `{.sample}`target_latency`{.variable}

:   Set an intended target latency in seconds for serving (fractional
    value can be set). Applicable only when the `streaming`{.sample} and
    `write_prft`{.sample} options are enabled. This is an informative
    fields clients can use to measure the latency of the service.

`timeout `{.sample}`timeout`{.variable}

:   Set timeout for socket I/O operations expressed in seconds
    (fractional value can be set). Applicable only for HTTP output.

`update_period `{.sample}`period`{.variable}

:   Set the MPD update period, for dynamic content. The unit is second.
    If set to `0`, the period is automatically computed.

    Default value is `0`.

`use_template `{.sample}`bool`{.variable}

:   Enable or disable use of `SegmentTemplate` instead of `SegmentList`
    in the manifest. This is enabled by default.

`use_timeline `{.sample}`bool`{.variable}

:   Enable or disable use of `SegmentTimeline` within the
    `SegmentTemplate` manifest section. This is enabled by default.

`utc_timing_url `{.sample}`url`{.variable}

:   URL of the page that will return the UTC timestamp in ISO format,
    for example `https://time.akamai.com/?iso`

`window_size `{.sample}`size`{.variable}

:   Set the maximum number of segments kept in the manifest, discard the
    oldest one. This is useful for live streaming.

    If the value is `0`, all segments are kept in the manifest. Default
    value is `0`.

`write_prft `{.sample}`write_prft`{.variable}

:   Write Producer Reference Time elements on supported streams. This
    also enables writing prft boxes in the underlying muxer. Applicable
    only when the `utc_url`{.variable} option is enabled. It is set to
    `auto`{.variable} by default, in which case the muxer will attempt
    to enable it only in modes that require it.

[]{#Example}

#### [21.29.2 Example](#toc-Example) {#example .subsection}

Generate a DASH output reading from an input source in realtime using
`ffmpeg`.

Two multimedia streams are generated from the input file, both
containing a video stream encoded through '`libx264`{.sample}', and an
audio stream encoded with '`libfdk_aac`{.sample}'. The first multimedia
stream contains video with a bitrate of 800k and audio at the default
rate, the second with video scaled to 320x170 pixels at 300k and audio
resampled at 22005 Hz.

The `window_size`{.sample} option keeps only the latest 5 segments with
the default duration of 5 seconds.

::: example
``` example
ffmpeg -re -i <input> -map 0 -map 0 -c:a libfdk_aac -c:v libx264 \
-b:v:0 800k -profile:v:0 main \
-b:v:1 300k -s:v:1 320x170 -profile:v:1 baseline -ar:a:1 22050 \
-bf 1 -keyint_min 120 -g 120 -sc_threshold 0 -b_strategy 0 \
-use_timeline 1 -use_template 1 -window_size 5 \
-adaptation_sets "id=0,streams=v id=1,streams=a" \
-f dash /path/to/out.mpd
```
:::

[]{#daud}

### [21.30 daud](#toc-daud) {#daud .section}

D-Cinema audio muxer.

It accepts a single 6-channels audio stream resampled at 96000 Hz
encoded with the '`pcm_24daud`{.sample}' codec.

[]{#Example-1}

#### [21.30.1 Example](#toc-Example-1) {#example-1 .subsection}

Use `ffmpeg` to mux input audio to a '`5.1`{.sample}' channel layout
resampled at 96000Hz:

::: example
``` example
ffmpeg -i INPUT -af aresample=96000,pan=5.1 slow.302
```
:::

For ffmpeg versions before 7.0 you might have to use the
'`asetnsamples`{.sample}' filter to limit the muxed packet size, because
this format does not support muxing packets larger than 65535 bytes
(3640 samples). For newer ffmpeg versions audio is automatically
packetized to 36000 byte (2000 sample) packets.

[]{#dv}

### [21.31 dv](#toc-dv) {#dv .section}

DV (Digital Video) muxer.

It accepts exactly one '`dvvideo`{.sample}' video stream and at most two
'`pcm_s16`{.sample}' audio streams. More constraints are defined by the
property of the video, which must correspond to a DV video supported
profile, and on the framerate.

[]{#Example-2}

#### [21.31.1 Example](#toc-Example-2) {#example-2 .subsection}

Use `ffmpeg` to convert the input:

::: example
``` example
ffmpeg -i INPUT -s:v 720x480 -pix_fmt yuv411p -r 29.97 -ac 2 -ar 48000 -y out.dv
```
:::

[]{#ffmetadata}

### [21.32 ffmetadata](#toc-ffmetadata) {#ffmetadata .section}

FFmpeg metadata muxer.

This muxer writes the streams metadata in the '`ffmetadata`{.sample}'
format.

See [(ffmpeg-formats)the Metadata chapter](ffmpeg-formats.html#metadata)
for information about the format.

[]{#Example-3}

#### [21.32.1 Example](#toc-Example-3) {#example-3 .subsection}

Use `ffmpeg` to extract metadata from an input file to a
`metadata.ffmeta`{.sample} file in '`ffmetadata`{.sample}' format:

::: example
``` example
ffmpeg -i INPUT -f ffmetadata metadata.ffmeta
```
:::

[]{#fifo}[]{#fifo-1}

### [21.33 fifo](#toc-fifo-1) {#fifo .section}

FIFO (First-In First-Out) muxer.

The '`fifo`{.sample}' pseudo-muxer allows the separation of encoding and
muxing by using a first-in-first-out queue and running the actual muxer
in a separate thread.

This is especially useful in combination with the [tee](#tee) muxer and
can be used to send data to several destinations with different
reliability/writing speed/latency.

The target muxer is either selected from the output name or specified
through the `fifo_format`{.sample} option.

The behavior of the '`fifo`{.sample}' muxer if the queue fills up or if
the output fails (e.g. if a packet cannot be written to the output) is
selectable:

- Output can be transparently restarted with configurable delay between
  retries based on real time or time of the processed stream.
- Encoding can be blocked during temporary failure, or continue
  transparently dropping packets in case the FIFO queue fills up.

API users should be aware that callback functions (`interrupt_callback`,
`io_open` and `io_close`) used within its `AVFormatContext` must be
thread-safe.

[]{#Options-78}

#### [21.33.1 Options](#toc-Options-78) {#options-78 .subsection}

`attempt_recovery `{.sample}`bool`{.variable}

:   If failure occurs, attempt to recover the output. This is especially
    useful when used with network output, since it makes it possible to
    restart streaming transparently. By default this option is set to
    `false`.

`drop_pkts_on_overflow `{.sample}`bool`{.variable}

:   If set to `true`, in case the fifo queue fills up, packets will be
    dropped rather than blocking the encoder. This makes it possible to
    continue streaming without delaying the input, at the cost of
    omitting part of the stream. By default this option is set to
    `false`, so in such cases the encoder will be blocked until the
    muxer processes some of the packets and none of them is lost.

`fifo_format `{.sample}`format_name`{.variable}

:   Specify the format name. Useful if it cannot be guessed from the
    output name suffix.

`format_opts `{.sample}`options`{.variable}

:   Specify format options for the underlying muxer. Muxer options can
    be specified as a list of `key`{.variable}=`value`{.variable} pairs
    separated by ':'.

`max_recovery_attempts `{.sample}`count`{.variable}

:   Set maximum number of successive unsuccessful recovery attempts
    after which the output fails permanently. By default this option is
    set to `0` (unlimited).

`queue_size `{.sample}`size`{.variable}

:   Specify size of the queue as a number of packets. Default value is
    `60`.

`recover_any_error `{.sample}`bool`{.variable}

:   If set to `true`, recovery will be attempted regardless of type of
    the error causing the failure. By default this option is set to
    `false` and in case of certain (usually permanent) errors the
    recovery is not attempted even when the `attempt_recovery`{.sample}
    option is set to `true`.

`recovery_wait_streamtime `{.sample}`bool`{.variable}

:   If set to `false`, the real time is used when waiting for the
    recovery attempt (i.e. the recovery will be attempted after the time
    specified by the `recovery_wait_time`{.sample} option).

    If set to `true`, the time of the processed stream is taken into
    account instead (i.e. the recovery will be attempted after
    discarding the packets corresponding to the
    `recovery_wait_time`{.sample} option).

    By default this option is set to `false`.

`recovery_wait_time `{.sample}`duration`{.variable}

:   Specify waiting time in seconds before the next recovery attempt
    after previous unsuccessful recovery attempt. Default value is `5`.

`restart_with_keyframe `{.sample}`bool`{.variable}

:   Specify whether to wait for the keyframe after recovering from queue
    overflow or failure. This option is set to `false` by default.

`timeshift `{.sample}`duration`{.variable}

:   Buffer the specified amount of packets and delay writing the output.
    Note that the value of the `queue_size`{.sample} option must be big
    enough to store the packets for timeshift. At the end of the input
    the fifo buffer is flushed at realtime speed.

[]{#Example-4}

#### [21.33.2 Example](#toc-Example-4) {#example-4 .subsection}

Use `ffmpeg` to stream to an RTMP server, continue processing the stream
at real-time rate even in case of temporary failure (network outage) and
attempt to recover streaming every second indefinitely:

::: example
``` example
ffmpeg -re -i ... -c:v libx264 -c:a aac -f fifo -fifo_format flv \
  -drop_pkts_on_overflow 1 -attempt_recovery 1 -recovery_wait_time 1 \
  -map 0:v -map 0:a rtmp://example.com/live/stream_name
```
:::

[]{#film_005fcpk}

### [21.34 film_cpk](#toc-film_005fcpk) {#film_cpk .section}

Sega film (.cpk) muxer.

This format was used as internal format for several Sega games.

For more information regarding the Sega film file format, visit
<http://wiki.multimedia.cx/index.php?title=Sega_FILM>.

It accepts at maximum one '`cinepak`{.sample}' or raw video stream, and
at maximum one audio stream.

[]{#filmstrip}

### [21.35 filmstrip](#toc-filmstrip) {#filmstrip .section}

Adobe Filmstrip muxer.

This format is used by several Adobe tools to store a generated
filmstrip export. It accepts a single raw video stream.

[]{#fits}

### [21.36 fits](#toc-fits) {#fits .section}

Flexible Image Transport System (FITS) muxer.

This image format is used to store astronomical data.

For more information regarding the format, visit
<https://fits.gsfc.nasa.gov>.

[]{#flac-3}

### [21.37 flac](#toc-flac-3) {#flac-2 .section}

Raw FLAC audio muxer.

This muxer accepts exactly one FLAC audio stream. Additionally, it is
possible to add images with disposition '`attached_pic`{.sample}'.

[]{#Options-79}

#### [21.37.1 Options](#toc-Options-79) {#options-79 .subsection}

`write_header `{.sample}`bool`{.variable}

:   write the file header if set to `true`, default is `true`

[]{#Example-5}

#### [21.37.2 Example](#toc-Example-5) {#example-5 .subsection}

Use `ffmpeg` to store the audio stream from an input file, together with
several pictures used with '`attached_pic`{.sample}' disposition:

::: example
``` example
ffmpeg -i INPUT -i pic1.png -i pic2.jpg -map 0:a -map 1 -map 2 -disposition:v attached_pic OUTPUT
```
:::

[]{#flv}

### [21.38 flv](#toc-flv) {#flv .section}

Adobe Flash Video Format muxer.

[]{#Options-80}

#### [21.38.1 Options](#toc-Options-80) {#options-80 .subsection}

`flvflags `{.sample}`flags`{.variable}

:   Possible values:

    '`aac_seq_header_detect`{.sample}'

    :   Place AAC sequence header based on audio stream data.

    '`no_sequence_end`{.sample}'

    :   Disable sequence end tag.

    '`no_metadata`{.sample}'

    :   Disable metadata tag.

    '`no_duration_filesize`{.sample}'

    :   Disable duration and filesize in metadata when they are equal to
        zero at the end of stream. (Be used to non-seekable living
        stream).

    '`add_keyframe_index`{.sample}'

    :   Used to facilitate seeking; particularly for HTTP pseudo
        streaming.

[]{#framecrc}[]{#framecrc-1}

### [21.39 framecrc](#toc-framecrc-1) {#framecrc .section}

Per-packet CRC (Cyclic Redundancy Check) testing format.

This muxer computes and prints the Adler-32 CRC for each audio and video
packet. By default audio frames are converted to signed 16-bit raw audio
and video frames to raw video before computing the CRC.

The output of the muxer consists of a line for each audio and video
packet of the form:

::: example
``` example
stream_index, packet_dts, packet_pts, packet_duration, packet_size, 0xCRC
```
:::

`CRC`{.variable} is a hexadecimal number 0-padded to 8 digits containing
the CRC of the packet.

[]{#Examples-17}

#### [21.39.1 Examples](#toc-Examples-17) {#examples-17 .subsection}

For example to compute the CRC of the audio and video frames in
`INPUT`{.sample}, converted to raw audio and video packets, and store it
in the file `out.crc`{.sample}:

::: example
``` example
ffmpeg -i INPUT -f framecrc out.crc
```
:::

To print the information to stdout, use the command:

::: example
``` example
ffmpeg -i INPUT -f framecrc -
```
:::

With `ffmpeg`, you can select the output format to which the audio and
video frames are encoded before computing the CRC for each packet by
specifying the audio and video codec. For example, to compute the CRC of
each decoded input audio frame converted to PCM unsigned 8-bit and of
each decoded input video frame converted to MPEG-2 video, use the
command:

::: example
``` example
ffmpeg -i INPUT -c:a pcm_u8 -c:v mpeg2video -f framecrc -
```
:::

See also the [crc](#crc) muxer.

[]{#framehash}[]{#framehash-1}

### [21.40 framehash](#toc-framehash-1) {#framehash .section}

Per-packet hash testing format.

This muxer computes and prints a cryptographic hash for each audio and
video packet. This can be used for packet-by-packet equality checks
without having to individually do a binary comparison on each.

By default audio frames are converted to signed 16-bit raw audio and
video frames to raw video before computing the hash, but the output of
explicit conversions to other codecs can also be used. It uses the
SHA-256 cryptographic hash function by default, but supports several
other algorithms.

The output of the muxer consists of a line for each audio and video
packet of the form:

::: example
``` example
stream_index, packet_dts, packet_pts, packet_duration, packet_size, hash
```
:::

`hash`{.variable} is a hexadecimal number representing the computed hash
for the packet.

`hash `{.sample}`algorithm`{.variable}

:   Use the cryptographic hash function specified by the string
    `algorithm`{.variable}. Supported values include `MD5`, `murmur3`,
    `RIPEMD128`, `RIPEMD160`, `RIPEMD256`, `RIPEMD320`, `SHA160`,
    `SHA224`, `SHA256` (default), `SHA512/224`, `SHA512/256`, `SHA384`,
    `SHA512`, `CRC32` and `adler32`.

[]{#Examples-18}

#### [21.40.1 Examples](#toc-Examples-18) {#examples-18 .subsection}

To compute the SHA-256 hash of the audio and video frames in
`INPUT`{.sample}, converted to raw audio and video packets, and store it
in the file `out.sha256`{.sample}:

::: example
``` example
ffmpeg -i INPUT -f framehash out.sha256
```
:::

To print the information to stdout, using the MD5 hash function, use the
command:

::: example
``` example
ffmpeg -i INPUT -f framehash -hash md5 -
```
:::

See also the [hash](#hash) muxer.

[]{#framemd5}[]{#framemd5-1}

### [21.41 framemd5](#toc-framemd5-1) {#framemd5 .section}

Per-packet MD5 testing format.

This is a variant of the [framehash](#framehash) muxer. Unlike that
muxer, it defaults to using the MD5 hash function.

[]{#Examples-19}

#### [21.41.1 Examples](#toc-Examples-19) {#examples-19 .subsection}

To compute the MD5 hash of the audio and video frames in
`INPUT`{.sample}, converted to raw audio and video packets, and store it
in the file `out.md5`{.sample}:

::: example
``` example
ffmpeg -i INPUT -f framemd5 out.md5
```
:::

To print the information to stdout, use the command:

::: example
``` example
ffmpeg -i INPUT -f framemd5 -
```
:::

See also the [framehash](#framehash) and [md5](#md5) muxers.

[]{#gif}[]{#gif-2}

### [21.42 gif](#toc-gif-2) {#gif-2 .section}

Animated GIF muxer.

Note that the GIF format has a very large time base: the delay between
two frames can therefore not be smaller than one centi second.

[]{#Options-81}

#### [21.42.1 Options](#toc-Options-81) {#options-81 .subsection}

`loop `{.sample}`bool`{.variable}

:   Set the number of times to loop the output. Use `-1` for no loop,
    `0` for looping indefinitely (default).

`final_delay `{.sample}`delay`{.variable}

:   Force the delay (expressed in centiseconds) after the last frame.
    Each frame ends with a delay until the next frame. The default is
    `-1`, which is a special value to tell the muxer to reuse the
    previous delay. In case of a loop, you might want to customize this
    value to mark a pause for instance.

[]{#Example-6}

#### [21.42.2 Example](#toc-Example-6) {#example-6 .subsection}

Encode a gif looping 10 times, with a 5 seconds delay between the loops:

::: example
``` example
ffmpeg -i INPUT -loop 10 -final_delay 500 out.gif
```
:::

Note 1: if you wish to extract the frames into separate GIF files, you
need to force the [image2](#image2) muxer:

::: example
``` example
ffmpeg -i INPUT -c:v gif -f image2 "out%d.gif"
```
:::

[]{#gxf}

### [21.43 gxf](#toc-gxf) {#gxf .section}

General eXchange Format (GXF) muxer.

GXF was developed by Grass Valley Group, then standardized by SMPTE as
SMPTE 360M and was extended in SMPTE RDD 14-2007 to include
high-definition video resolutions.

It accepts at most one video stream with codec '`mjpeg`{.sample}', or
'`mpeg1video`{.sample}', or '`mpeg2video`{.sample}', or
'`dvvideo`{.sample}' with resolution '`512x480`{.sample}' or
'`608x576`{.sample}', and several audio streams with rate 48000Hz and
codec '`pcm16_le`{.sample}'.

[]{#hash}[]{#hash-1}

### [21.44 hash](#toc-hash-1) {#hash .section}

Hash testing format.

This muxer computes and prints a cryptographic hash of all the input
audio and video frames. This can be used for equality checks without
having to do a complete binary comparison.

By default audio frames are converted to signed 16-bit raw audio and
video frames to raw video before computing the hash, but the output of
explicit conversions to other codecs can also be used. Timestamps are
ignored. It uses the SHA-256 cryptographic hash function by default, but
supports several other algorithms.

The output of the muxer consists of a single line of the form:
`algo`{.variable}=`hash`{.variable}, where `algo`{.variable} is a short
string representing the hash function used, and `hash`{.variable} is a
hexadecimal number representing the computed hash.

`hash `{.sample}`algorithm`{.variable}

:   Use the cryptographic hash function specified by the string
    `algorithm`{.variable}. Supported values include `MD5`, `murmur3`,
    `RIPEMD128`, `RIPEMD160`, `RIPEMD256`, `RIPEMD320`, `SHA160`,
    `SHA224`, `SHA256` (default), `SHA512/224`, `SHA512/256`, `SHA384`,
    `SHA512`, `CRC32` and `adler32`.

[]{#Examples-20}

#### [21.44.1 Examples](#toc-Examples-20) {#examples-20 .subsection}

To compute the SHA-256 hash of the input converted to raw audio and
video, and store it in the file `out.sha256`{.sample}:

::: example
``` example
ffmpeg -i INPUT -f hash out.sha256
```
:::

To print an MD5 hash to stdout use the command:

::: example
``` example
ffmpeg -i INPUT -f hash -hash md5 -
```
:::

See also the [framehash](#framehash) muxer.

[]{#hds}[]{#hds-1}

### [21.45 hds](#toc-hds-1) {#hds .section}

HTTP Dynamic Streaming (HDS) muxer.

HTTP dynamic streaming, or HDS, is an adaptive bitrate streaming method
developed by Adobe. HDS delivers MP4 video content over HTTP
connections. HDS can be used for on-demand streaming or live streaming.

This muxer creates an .f4m (Adobe Flash Media Manifest File) manifest,
an .abst (Adobe Bootstrap File) for each stream, and segment files in a
directory specified as the output.

These needs to be accessed by an HDS player through HTTPS for it to be
able to perform playback on the generated stream.

[]{#Options-82}

#### [21.45.1 Options](#toc-Options-82) {#options-82 .subsection}

`extra_window_size `{.sample}`int`{.variable}

:   number of fragments kept outside of the manifest before removing
    from disk

`min_frag_duration `{.sample}`microseconds`{.variable}

:   minimum fragment duration (in microseconds), default value is 1
    second (`10000000`)

`remove_at_exit `{.sample}`bool`{.variable}

:   remove all fragments when finished when set to `true`

`window_size `{.sample}`int`{.variable}

:   number of fragments kept in the manifest, if set to a value
    different from `0`. By default all segments are kept in the output
    directory.

[]{#Example-7}

#### [21.45.2 Example](#toc-Example-7) {#example-7 .subsection}

Use `ffmpeg` to generate HDS files to the `output.hds`{.sample}
directory in real-time rate:

::: example
``` example
ffmpeg -re -i INPUT -f hds -b:v 200k output.hds
```
:::

[]{#hls}[]{#hls-2}

### [21.46 hls](#toc-hls-2) {#hls-1 .section}

Apple HTTP Live Streaming muxer that segments MPEG-TS according to the
HTTP Live Streaming (HLS) specification.

It creates a playlist file, and one or more segment files. The output
filename specifies the playlist filename.

By default, the muxer creates a file for each segment produced. These
files have the same name as the playlist, followed by a sequential
number and a .ts extension.

Make sure to require a closed GOP when encoding and to set the GOP size
to fit your segment time constraint.

For example, to convert an input file with `ffmpeg`:

::: example
``` example
ffmpeg -i in.mkv -c:v h264 -flags +cgop -g 30 -hls_time 1 out.m3u8
```
:::

This example will produce the playlist, `out.m3u8`{.sample}, and segment
files: `out0.ts`{.sample}, `out1.ts`{.sample}, `out2.ts`{.sample}, etc.

See also the [segment](#segment) muxer, which provides a more generic
and flexible implementation of a segmenter, and can be used to perform
HLS segmentation.

[]{#Options-83}

#### [21.46.1 Options](#toc-Options-83) {#options-83 .subsection}

`hls_init_time `{.sample}`duration`{.variable}

:   Set the initial target segment length. Default value is
    `0`{.variable}.

    `duration`{.variable} must be a time duration specification, see
    [(ffmpeg-utils)the Time duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax).

    Segment will be cut on the next key frame after this time has passed
    on the first m3u8 list. After the initial playlist is filled,
    `ffmpeg` will cut segments at duration equal to `hls_time`{.sample}.

`hls_time `{.sample}`duration`{.variable}

:   Set the target segment length. Default value is 2.

    `duration`{.variable} must be a time duration specification, see
    [(ffmpeg-utils)the Time duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax). Segment will be cut
    on the next key frame after this time has passed.

`hls_list_size `{.sample}`size`{.variable}

:   Set the maximum number of playlist entries. If set to 0 the list
    file will contain all the segments. Default value is 5.

`hls_delete_threshold `{.sample}`size`{.variable}

:   Set the number of unreferenced segments to keep on disk before
    `hls_flags delete_segments` deletes them. Increase this to allow
    continue clients to download segments which were recently referenced
    in the playlist. Default value is 1, meaning segments older than
    `hls_list_size+1`{.sample} will be deleted.

`hls_start_number_source `{.sample}`source`{.variable}

:   Start the playlist sequence number (`#EXT-X-MEDIA-SEQUENCE`)
    according to the specified source. Unless
    `hls_flags single_file`{.sample} is set, it also specifies source of
    starting sequence numbers of segment and subtitle filenames. In any
    case, if `hls_flags append_list`{.sample} is set and read playlist
    sequence number is greater than the specified start sequence number,
    then that value will be used as start value.

    It accepts the following values:

    `generic (default)`{.sample}

    :   Set the start numbers according to the `start_number`{.sample}
        option value.

    `epoch`{.sample}

    :   Set the start number as the seconds since epoch (1970-01-01
        00:00:00).

    `epoch_us`{.sample}

    :   Set the start number as the microseconds since epoch (1970-01-01
        00:00:00).

    `datetime`{.sample}

    :   Set the start number based on the current date/time as
        YYYYmmddHHMMSS. e.g. 20161231235759.

`start_number `{.sample}`number`{.variable}

:   Start the playlist sequence number (`#EXT-X-MEDIA-SEQUENCE`) from
    the specified `number`{.variable} when
    `hls_start_number_source`{.sample} value is `generic`{.variable}.
    (This is the default case.) Unless `hls_flags single_file`{.sample}
    is set, it also specifies starting sequence numbers of segment and
    subtitle filenames. Default value is 0.

`hls_allow_cache `{.sample}`bool`{.variable}

:   Explicitly set whether the client MAY (1) or MUST NOT (0) cache
    media segments.

`hls_base_url `{.sample}`baseurl`{.variable}

:   Append `baseurl`{.variable} to every entry in the playlist. Useful
    to generate playlists with absolute paths.

    Note that the playlist sequence number must be unique for each
    segment and it is not to be confused with the segment filename
    sequence number which can be cyclic, for example if the
    `wrap`{.sample} option is specified.

`hls_segment_filename `{.sample}`filename`{.variable}

:   Set the segment filename. Unless the `hls_flags`{.sample} option is
    set with '`single_file`{.sample}', `filename`{.variable} is used as
    a string format with the segment number appended.

    For example:

    ::: example
    ``` example
    ffmpeg -i in.nut -hls_segment_filename 'file%03d.ts' out.m3u8
    ```
    :::

    will produce the playlist, `out.m3u8`{.sample}, and segment files:
    `file000.ts`{.sample}, `file001.ts`{.sample}, `file002.ts`{.sample},
    etc.

    `filename`{.variable} may contain a full path or relative path
    specification, but only the file name part without any path will be
    contained in the m3u8 segment list. Should a relative path be
    specified, the path of the created segment files will be relative to
    the current working directory. When `strftime_mkdir`{.sample} is
    set, the whole expanded value of `filename`{.variable} will be
    written into the m3u8 segment list.

    When `var_stream_map`{.sample} is set with two or more variant
    streams, the `filename`{.variable} pattern must contain the string
    \"%v\", and this string will be expanded to the position of variant
    stream index in the generated segment file names.

    For example:

    ::: example
    ``` example
    ffmpeg -i in.ts -b:v:0 1000k -b:v:1 256k -b:a:0 64k -b:a:1 32k \
      -map 0:v -map 0:a -map 0:v -map 0:a -f hls -var_stream_map "v:0,a:0 v:1,a:1" \
      -hls_segment_filename 'file_%v_%03d.ts' out_%v.m3u8
    ```
    :::

    will produce the playlists segment file sets:
    `file_0_000.ts`{.sample}, `file_0_001.ts`{.sample},
    `file_0_002.ts`{.sample}, etc. and `file_1_000.ts`{.sample},
    `file_1_001.ts`{.sample}, `file_1_002.ts`{.sample}, etc.

    The string \"%v\" may be present in the filename or in the last
    directory name containing the file, but only in one of them.
    (Additionally, %v may appear multiple times in the last
    sub-directory or filename.) If the string %v is present in the
    directory name, then sub-directories are created after expanding the
    directory name pattern. This enables creation of segments
    corresponding to different variant streams in subdirectories.

    For example:

    ::: example
    ``` example
    ffmpeg -i in.ts -b:v:0 1000k -b:v:1 256k -b:a:0 64k -b:a:1 32k \
      -map 0:v -map 0:a -map 0:v -map 0:a -f hls -var_stream_map "v:0,a:0 v:1,a:1" \
      -hls_segment_filename 'vs%v/file_%03d.ts' vs%v/out.m3u8
    ```
    :::

    will produce the playlists segment file sets:
    `vs0/file_000.ts`{.sample}, `vs0/file_001.ts`{.sample},
    `vs0/file_002.ts`{.sample}, etc. and `vs1/file_000.ts`{.sample},
    `vs1/file_001.ts`{.sample}, `vs1/file_002.ts`{.sample}, etc.

`strftime `{.sample}`bool`{.variable}

:   Use `strftime()` on `filename`{.variable} to expand the segment
    filename with localtime. The segment number is also available in
    this mode, but to use it, you need to set
    '`second_level_segment_index`{.sample}' in the `hls_flag`{.sample}
    and %%d will be the specifier.

    For example:

    ::: example
    ``` example
    ffmpeg -i in.nut -strftime 1 -hls_segment_filename 'file-%Y%m%d-%s.ts' out.m3u8
    ```
    :::

    will produce the playlist, `out.m3u8`{.sample}, and segment files:
    `file-20160215-1455569023.ts`{.sample},
    `file-20160215-1455569024.ts`{.sample}, etc. Note: On some
    systems/environments, the `%s` specifier is not available. See
    `strftime()` documentation.

    For example:

    ::: example
    ``` example
    ffmpeg -i in.nut -strftime 1 -hls_flags second_level_segment_index -hls_segment_filename 'file-%Y%m%d-%%04d.ts' out.m3u8
    ```
    :::

    will produce the playlist, `out.m3u8`{.sample}, and segment files:
    `file-20160215-0001.ts`{.sample}, `file-20160215-0002.ts`{.sample},
    etc.

`strftime_mkdir `{.sample}`bool`{.variable}

:   Used together with `strftime`{.sample}, it will create all
    subdirectories which are present in the expanded values of option
    `hls_segment_filename`{.sample}.

    For example:

    ::: example
    ``` example
    ffmpeg -i in.nut -strftime 1 -strftime_mkdir 1 -hls_segment_filename '%Y%m%d/file-%Y%m%d-%s.ts' out.m3u8
    ```
    :::

    will create a directory `201560215`{.sample} (if it does not exist),
    and then produce the playlist, `out.m3u8`{.sample}, and segment
    files: `20160215/file-20160215-1455569023.ts`{.sample},
    `20160215/file-20160215-1455569024.ts`{.sample}, etc.

    For example:

    ::: example
    ``` example
    ffmpeg -i in.nut -strftime 1 -strftime_mkdir 1 -hls_segment_filename '%Y/%m/%d/file-%Y%m%d-%s.ts' out.m3u8
    ```
    :::

    will create a directory hierarchy `2016/02/15`{.sample} (if any of
    them do not exist), and then produce the playlist,
    `out.m3u8`{.sample}, and segment files:
    `2016/02/15/file-20160215-1455569023.ts`{.sample},
    `2016/02/15/file-20160215-1455569024.ts`{.sample}, etc.

`hls_segment_options `{.sample}`options_list`{.variable}

:   Set output format options using a :-separated list of key=value
    parameters. Values containing `:` special characters must be
    escaped.

`hls_key_info_file `{.sample}`key_info_file`{.variable}

:   Use the information in `key_info_file`{.variable} for segment
    encryption. The first line of `key_info_file`{.variable} specifies
    the key URI written to the playlist. The key URL is used to access
    the encryption key during playback. The second line specifies the
    path to the key file used to obtain the key during the encryption
    process. The key file is read as a single packed array of 16 octets
    in binary format. The optional third line specifies the
    initialization vector (IV) as a hexadecimal string to be used
    instead of the segment sequence number (default) for encryption.
    Changes to `key_info_file`{.variable} will result in segment
    encryption with the new key/IV and an entry in the playlist for the
    new key URI/IV if `hls_flags periodic_rekey`{.sample} is enabled.

    Key info file format:

    ::: example
    ``` example
    key URI
    key file path
    IV (optional)
    ```
    :::

    Example key URIs:

    ::: example
    ``` example
    http://server/file.key
    /path/to/file.key
    file.key
    ```
    :::

    Example key file paths:

    ::: example
    ``` example
    file.key
    /path/to/file.key
    ```
    :::

    Example IV:

    ::: example
    ``` example
    0123456789ABCDEF0123456789ABCDEF
    ```
    :::

    Key info file example:

    ::: example
    ``` example
    http://server/file.key
    /path/to/file.key
    0123456789ABCDEF0123456789ABCDEF
    ```
    :::

    Example shell script:

    ::: example
    ``` example
    #!/bin/sh
    BASE_URL=${1:-'.'}
    openssl rand 16 > file.key
    echo $BASE_URL/file.key > file.keyinfo
    echo file.key >> file.keyinfo
    echo $(openssl rand -hex 16) >> file.keyinfo
    ffmpeg -f lavfi -re -i testsrc -c:v h264 -hls_flags delete_segments \
      -hls_key_info_file file.keyinfo out.m3u8
    ```
    :::

`hls_enc `{.sample}`bool`{.variable}

:   Enable (1) or disable (0) the AES128 encryption. When enabled every
    segment generated is encrypted and the encryption key is saved as
    `playlist name`{.variable}.key.

`hls_enc_key `{.sample}`key`{.variable}

:   Specify a 16-octet key to encrypt the segments, by default it is
    randomly generated.

`hls_enc_key_url `{.sample}`keyurl`{.variable}

:   If set, `keyurl`{.variable} is prepended instead of
    `baseurl`{.variable} to the key filename in the playlist.

`hls_enc_iv `{.sample}`iv`{.variable}

:   Specify the 16-octet initialization vector for every segment instead
    of the autogenerated ones.

`hls_segment_type `{.sample}`flags`{.variable}

:   Possible values:

    '`mpegts`{.sample}'

    :   Output segment files in MPEG-2 Transport Stream format. This is
        compatible with all HLS versions.

    '`fmp4`{.sample}'

    :   Output segment files in fragmented MP4 format, similar to
        MPEG-DASH. fmp4 files may be used in HLS version 7 and above.

`hls_fmp4_init_filename `{.sample}`filename`{.variable}

:   Set filename for the fragment files header file, default filename is
    `init.mp4`{.sample}.

    When `strftime`{.sample} is enabled, `filename`{.variable} is
    expanded to the segment filename with localtime.

    For example:

    ::: example
    ``` example
    ffmpeg -i in.nut -hls_segment_type fmp4 -strftime 1 -hls_fmp4_init_filename "%s_init.mp4" out.m3u8
    ```
    :::

    will produce init like this `1602678741_init.mp4`{.sample}.

`hls_fmp4_init_resend `{.sample}`bool`{.variable}

:   Resend init file after m3u8 file refresh every time, default is
    `0`{.variable}.

    When `var_stream_map`{.sample} is set with two or more variant
    streams, the `filename`{.variable} pattern must contain the string
    \"%v\", this string specifies the position of variant stream index
    in the generated init file names. The string \"%v\" may be present
    in the filename or in the last directory name containing the file.
    If the string is present in the directory name, then sub-directories
    are created after expanding the directory name pattern. This enables
    creation of init files corresponding to different variant streams in
    subdirectories.

`hls_flags `{.sample}`flags`{.variable}

:   Possible values:

    '`single_file`{.sample}'

    :   If this flag is set, the muxer will store all segments in a
        single MPEG-TS file, and will use byte ranges in the playlist.
        HLS playlists generated with this way will have the version
        number 4.

        For example:

        ::: example
        ``` example
        ffmpeg -i in.nut -hls_flags single_file out.m3u8
        ```
        :::

        will produce the playlist, `out.m3u8`{.sample}, and a single
        segment file, `out.ts`{.sample}.

    '`delete_segments`{.sample}'

    :   Segment files removed from the playlist are deleted after a
        period of time equal to the duration of the segment plus the
        duration of the playlist.

    '`append_list`{.sample}'

    :   Append new segments into the end of old segment list, and remove
        the `#EXT-X-ENDLIST` from the old segment list.

    '`round_durations`{.sample}'

    :   Round the duration info in the playlist file segment info to
        integer values, instead of using floating point. If there are no
        other features requiring higher HLS versions be used, then this
        will allow `ffmpeg` to output a HLS version 2 m3u8.

    '`discont_start`{.sample}'

    :   Add the `#EXT-X-DISCONTINUITY` tag to the playlist, before the
        first segment's information.

    '`omit_endlist`{.sample}'

    :   Do not append the `EXT-X-ENDLIST` tag at the end of the
        playlist.

    '`periodic_rekey`{.sample}'

    :   The file specified by `hls_key_info_file` will be checked
        periodically and detect updates to the encryption info. Be sure
        to replace this file atomically, including the file containing
        the AES encryption key.

    '`independent_segments`{.sample}'

    :   Add the `#EXT-X-INDEPENDENT-SEGMENTS` tag to playlists that has
        video segments and when all the segments of that playlist are
        guaranteed to start with a key frame.

    '`iframes_only`{.sample}'

    :   Add the `#EXT-X-I-FRAMES-ONLY` tag to playlists that has video
        segments and can play only I-frames in the `#EXT-X-BYTERANGE`
        mode.

    '`split_by_time`{.sample}'

    :   Allow segments to start on frames other than key frames. This
        improves behavior on some players when the time between key
        frames is inconsistent, but may make things worse on others, and
        can cause some oddities during seeking. This flag should be used
        with the `hls_time`{.sample} option.

    '`program_date_time`{.sample}'

    :   Generate `EXT-X-PROGRAM-DATE-TIME` tags.

    '`second_level_segment_index`{.sample}'

    :   Make it possible to use segment indexes as %%d in the
        `hls_segment_filename`{.sample} option expression besides
        date/time values when `strftime`{.sample} option is on. To get
        fixed width numbers with trailing zeroes, %%0xd format is
        available where x is the required width.

    '`second_level_segment_size`{.sample}'

    :   Make it possible to use segment sizes (counted in bytes) as %%s
        in `hls_segment_filename`{.sample} option expression besides
        date/time values when strftime is on. To get fixed width numbers
        with trailing zeroes, %%0xs format is available where x is the
        required width.

    '`second_level_segment_duration`{.sample}'

    :   Make it possible to use segment duration (calculated in
        microseconds) as %%t in `hls_segment_filename`{.sample} option
        expression besides date/time values when strftime is on. To get
        fixed width numbers with trailing zeroes, %%0xt format is
        available where x is the required width.

        For example:

        ::: example
        ``` example
        ffmpeg -i sample.mpeg \
           -f hls -hls_time 3 -hls_list_size 5 \
           -hls_flags second_level_segment_index+second_level_segment_size+second_level_segment_duration \
           -strftime 1 -strftime_mkdir 1 -hls_segment_filename "segment_%Y%m%d%H%M%S_%%04d_%%08s_%%013t.ts" stream.m3u8
        ```
        :::

        will produce segments like this:
        `segment_20170102194334_0003_00122200_0000003000000.ts`{.sample},
        `segment_20170102194334_0004_00120072_0000003000000.ts`{.sample}
        etc.

    '`temp_file`{.sample}'

    :   Write segment data to `filename.tmp`{.sample} and rename to
        filename only once the segment is complete.

        A webserver serving up segments can be configured to reject
        requests to \*.tmp to prevent access to in-progress segments
        before they have been added to the m3u8 playlist.

        This flag also affects how m3u8 playlist files are created. If
        this flag is set, all playlist files will be written into a
        temporary file and renamed after they are complete, similarly as
        segments are handled. But playlists with `file` protocol and
        with `hls_playlist_type`{.sample} type other than
        '`vod`{.sample}' are always written into a temporary file
        regardless of this flag.

        Master playlist files specified with `master_pl_name`{.sample},
        if any, with `file` protocol, are always written into temporary
        file regardless of this flag if
        `master_pl_publish_rate`{.sample} value is other than zero.

`hls_playlist_type `{.sample}`type`{.variable}

:   If type is '`event`{.sample}', emit `#EXT-X-PLAYLIST-TYPE:EVENT` in
    the m3u8 header. This forces `hls_list_size`{.sample} to 0; the
    playlist can only be appended to.

    If type is '`vod`{.sample}', emit `#EXT-X-PLAYLIST-TYPE:VOD` in the
    m3u8 header. This forces `hls_list_size`{.sample} to 0; the playlist
    must not change.

`method `{.sample}`method`{.variable}

:   Use the given HTTP method to create the hls files.

    For example:

    ::: example
    ``` example
    ffmpeg -re -i in.ts -f hls -method PUT http://example.com/live/out.m3u8
    ```
    :::

    will upload all the mpegts segment files to the HTTP server using
    the HTTP PUT method, and update the m3u8 files every `refresh` times
    using the same method. Note that the HTTP server must support the
    given method for uploading files.

`http_user_agent `{.sample}`agent`{.variable}

:   Override User-Agent field in HTTP header. Applicable only for HTTP
    output.

`var_stream_map `{.sample}`stream_map`{.variable}

:   Specify a map string defining how to group the audio, video and
    subtitle streams into different variant streams. The variant stream
    groups are separated by space.

    Expected string format is like this \"a:0,v:0 a:1,v:1 \....\". Here
    a:, v:, s: are the keys to specify audio, video and subtitle streams
    respectively. Allowed values are 0 to 9 (limited just based on
    practical usage).

    When there are two or more variant streams, the output filename
    pattern must contain the string \"%v\": this string specifies the
    position of variant stream index in the output media playlist
    filenames. The string \"%v\" may be present in the filename or in
    the last directory name containing the file. If the string is
    present in the directory name, then sub-directories are created
    after expanding the directory name pattern. This enables creation of
    variant streams in subdirectories.

    A few examples follow.

    - Create two hls variant streams. The first variant stream will
      contain video stream of bitrate 1000k and audio stream of bitrate
      64k and the second variant stream will contain video stream of
      bitrate 256k and audio stream of bitrate 32k. Here, two media
      playlist with file names `out_0.m3u8`{.sample} and
      `out_1.m3u8`{.sample} will be created.

      ::: example
      ``` example
      ffmpeg -re -i in.ts -b:v:0 1000k -b:v:1 256k -b:a:0 64k -b:a:1 32k \
        -map 0:v -map 0:a -map 0:v -map 0:a -f hls -var_stream_map "v:0,a:0 v:1,a:1" \
        http://example.com/live/out_%v.m3u8
      ```
      :::
    - If you want something meaningful text instead of indexes in result
      names, you may specify names for each or some of the variants. The
      following example will create two hls variant streams as in the
      previous one. But here, the two media playlist with file names
      `out_my_hd.m3u8`{.sample} and `out_my_sd.m3u8`{.sample} will be
      created.

      ::: example
      ``` example
      ffmpeg -re -i in.ts -b:v:0 1000k -b:v:1 256k -b:a:0 64k -b:a:1 32k \
        -map 0:v -map 0:a -map 0:v -map 0:a -f hls -var_stream_map "v:0,a:0,name:my_hd v:1,a:1,name:my_sd" \
        http://example.com/live/out_%v.m3u8
      ```
      :::
    - Create three hls variant streams. The first variant stream will be
      a video only stream with video bitrate 1000k, the second variant
      stream will be an audio only stream with bitrate 64k and the third
      variant stream will be a video only stream with bitrate 256k.
      Here, three media playlist with file names `out_0.m3u8`{.sample},
      `out_1.m3u8`{.sample} and `out_2.m3u8`{.sample} will be created.

      ::: example
      ``` example
      ffmpeg -re -i in.ts -b:v:0 1000k -b:v:1 256k -b:a:0 64k \
        -map 0:v -map 0:a -map 0:v -f hls -var_stream_map "v:0 a:0 v:1" \
        http://example.com/live/out_%v.m3u8
      ```
      :::
    - Create the variant streams in subdirectories. Here, the first
      media playlist is created at
      `http://example.com/live/vs_0/out.m3u8`{.sample} and the second
      one at `http://example.com/live/vs_1/out.m3u8`{.sample}.

      ::: example
      ``` example
      ffmpeg -re -i in.ts -b:v:0 1000k -b:v:1 256k -b:a:0 64k -b:a:1 32k \
        -map 0:v -map 0:a -map 0:v -map 0:a -f hls -var_stream_map "v:0,a:0 v:1,a:1" \
        http://example.com/live/vs_%v/out.m3u8
      ```
      :::
    - Create two audio only and two video only variant streams. In
      addition to the `#EXT-X-STREAM-INF` tag for each variant stream in
      the master playlist, the `#EXT-X-MEDIA` tag is also added for the
      two audio only variant streams and they are mapped to the two
      video only variant streams with audio group names 'aud_low' and
      'aud_high'. By default, a single hls variant containing all the
      encoded streams is created.

      ::: example
      ``` example
      ffmpeg -re -i in.ts -b:a:0 32k -b:a:1 64k -b:v:0 1000k -b:v:1 3000k  \
        -map 0:a -map 0:a -map 0:v -map 0:v -f hls \
        -var_stream_map "a:0,agroup:aud_low a:1,agroup:aud_high v:0,agroup:aud_low v:1,agroup:aud_high" \
        -master_pl_name master.m3u8 \
        http://example.com/live/out_%v.m3u8
      ```
      :::
    - Create two audio only and one video only variant streams. In
      addition to the `#EXT-X-STREAM-INF` tag for each variant stream in
      the master playlist, the `#EXT-X-MEDIA` tag is also added for the
      two audio only variant streams and they are mapped to the one
      video only variant streams with audio group name 'aud_low', and
      the audio group have default stat is NO or YES. By default, a
      single hls variant containing all the encoded streams is created.

      ::: example
      ``` example
      ffmpeg -re -i in.ts -b:a:0 32k -b:a:1 64k -b:v:0 1000k \
        -map 0:a -map 0:a -map 0:v -f hls \
        -var_stream_map "a:0,agroup:aud_low,default:yes a:1,agroup:aud_low v:0,agroup:aud_low" \
        -master_pl_name master.m3u8 \
        http://example.com/live/out_%v.m3u8
      ```
      :::
    - Create two audio only and one video only variant streams. In
      addition to the `#EXT-X-STREAM-INF` tag for each variant stream in
      the master playlist, the `#EXT-X-MEDIA` tag is also added for the
      two audio only variant streams and they are mapped to the one
      video only variant streams with audio group name 'aud_low', and
      the audio group have default stat is NO or YES, and one audio have
      and language is named ENG, the other audio language is named CHN.
      By default, a single hls variant containing all the encoded
      streams is created.

      ::: example
      ``` example
      ffmpeg -re -i in.ts -b:a:0 32k -b:a:1 64k -b:v:0 1000k \
        -map 0:a -map 0:a -map 0:v -f hls \
        -var_stream_map "a:0,agroup:aud_low,default:yes,language:ENG a:1,agroup:aud_low,language:CHN v:0,agroup:aud_low" \
        -master_pl_name master.m3u8 \
        http://example.com/live/out_%v.m3u8
      ```
      :::
    - Create a single variant stream. Add the `#EXT-X-MEDIA` tag with
      `TYPE=SUBTITLES` in the master playlist with webvtt subtitle group
      name 'subtitle' and optional subtitle name, e.g. 'English'. Make
      sure the input file has one text subtitle stream at least.

      ::: example
      ``` example
      ffmpeg -y -i input_with_subtitle.mkv \
       -b:v:0 5250k -c:v h264 -pix_fmt yuv420p -profile:v main -level 4.1 \
       -b:a:0 256k \
       -c:s webvtt -c:a mp2 -ar 48000 -ac 2 -map 0:v -map 0:a:0 -map 0:s:0 \
       -f hls -var_stream_map "v:0,a:0,s:0,sgroup:subtitle,sname:English" \
       -master_pl_name master.m3u8 -t 300 -hls_time 10 -hls_init_time 4 -hls_list_size \
       10 -master_pl_publish_rate 10 -hls_flags \
       delete_segments+discont_start+split_by_time ./tmp/video.m3u8
      ```
      :::

`cc_stream_map `{.sample}`cc_stream_map`{.variable}

:   Map string which specifies different closed captions groups and
    their attributes. The closed captions stream groups are separated by
    space.

    Expected string format is like this \"ccgroup:\<group
    name\>,instreamid:\<INSTREAM-ID\>,language:\<language code\>
    \....\". 'ccgroup' and 'instreamid' are mandatory attributes.
    'language' is an optional attribute.

    The closed captions groups configured using this option are mapped
    to different variant streams by providing the same 'ccgroup' name in
    the `var_stream_map`{.sample} string.

    For example:

    ::: example
    ``` example
    ffmpeg -re -i in.ts -b:v:0 1000k -b:v:1 256k -b:a:0 64k -b:a:1 32k \
      -a53cc:0 1 -a53cc:1 1 \
      -map 0:v -map 0:a -map 0:v -map 0:a -f hls \
      -cc_stream_map "ccgroup:cc,instreamid:CC1,language:en ccgroup:cc,instreamid:CC2,language:sp" \
      -var_stream_map "v:0,a:0,ccgroup:cc v:1,a:1,ccgroup:cc" \
      -master_pl_name master.m3u8 \
      http://example.com/live/out_%v.m3u8
    ```
    :::

    will add two `#EXT-X-MEDIA` tags with `TYPE=CLOSED-CAPTIONS` in the
    master playlist for the INSTREAM-IDs 'CC1' and 'CC2'. Also, it will
    add `CLOSED-CAPTIONS` attribute with group name 'cc' for the two
    output variant streams.

    If `var_stream_map`{.sample} is not set, then the first available
    ccgroup in `cc_stream_map`{.sample} is mapped to the output variant
    stream.

    For example:

    ::: example
    ``` example
    ffmpeg -re -i in.ts -b:v 1000k -b:a 64k -a53cc 1 -f hls \
      -cc_stream_map "ccgroup:cc,instreamid:CC1,language:en" \
      -master_pl_name master.m3u8 \
      http://example.com/live/out.m3u8
    ```
    :::

    this will add `#EXT-X-MEDIA` tag with `TYPE=CLOSED-CAPTIONS` in the
    master playlist with group name 'cc', language 'en' (english) and
    INSTREAM-ID 'CC1'. Also, it will add `CLOSED-CAPTIONS` attribute
    with group name 'cc' for the output variant stream.

`master_pl_name `{.sample}`name`{.variable}

:   Create HLS master playlist with the given name.

    For example:

    ::: example
    ``` example
    ffmpeg -re -i in.ts -f hls -master_pl_name master.m3u8 http://example.com/live/out.m3u8
    ```
    :::

    creates an HLS master playlist with name `master.m3u8`{.sample}
    which is published at <http://example.com/live/>.

`master_pl_publish_rate `{.sample}`count`{.variable}

:   Publish master play list repeatedly every after specified number of
    segment intervals.

    For example:

    ::: example
    ``` example
    ffmpeg -re -i in.ts -f hls -master_pl_name master.m3u8 \
    -hls_time 2 -master_pl_publish_rate 30 http://example.com/live/out.m3u8
    ```
    :::

    creates an HLS master playlist with name `master.m3u8`{.sample} and
    keeps publishing it repeatedly every after 30 segments i.e. every
    after 60s.

`http_persistent `{.sample}`bool`{.variable}

:   Use persistent HTTP connections. Applicable only for HTTP output.

`timeout `{.sample}`timeout`{.variable}

:   Set timeout for socket I/O operations. Applicable only for HTTP
    output.

`ignore_io_errors `{.sample}`bool`{.variable}

:   Ignore IO errors during open, write and delete. Useful for
    long-duration runs with network output.

`headers `{.sample}`headers`{.variable}

:   Set custom HTTP headers, can override built in default headers.
    Applicable only for HTTP output.

[]{#iamf}

### [21.47 iamf](#toc-iamf) {#iamf .section}

Immersive Audio Model and Formats (IAMF) muxer.

IAMF is used to provide immersive audio content for presentation on a
wide range of devices in both streaming and offline applications. These
applications include internet audio streaming, multicasting/broadcasting
services, file download, gaming, communication, virtual and augmented
reality, and others. In these applications, audio may be played back on
a wide range of devices, e.g., headphones, mobile phones, tablets, TVs,
sound bars, home theater systems, and big screens.

This format was promoted and designed by Alliance for Open Media.

For more information about this format, see <https://aomedia.org/iamf/>.

[]{#ico}[]{#ico-1}

### [21.48 ico](#toc-ico-1) {#ico .section}

ICO file muxer.

Microsoft's icon file format (ICO) has some strict limitations that
should be noted:

- Size cannot exceed 256 pixels in any dimension
- Only BMP and PNG images can be stored
- If a BMP image is used, it must be one of the following pixel formats:

  ::: example
  ``` example
  BMP Bit Depth      FFmpeg Pixel Format
  1bit               pal8
  4bit               pal8
  8bit               pal8
  16bit              rgb555le
  24bit              bgr24
  32bit              bgra
  ```
  :::
- If a BMP image is used, it must use the BITMAPINFOHEADER DIB header
- If a PNG image is used, it must use the rgba pixel format

[]{#ilbc}

### [21.49 ilbc](#toc-ilbc) {#ilbc .section}

Internet Low Bitrate Codec (iLBC) raw muxer.

It accepts a single '`ilbc`{.sample}' audio stream.

[]{#image2}[]{#image2_002c-image2pipe}

### [21.50 image2, image2pipe](#toc-image2_002c-image2pipe) {#image2-image2pipe .section}

Image file muxer.

The '`image2`{.sample}' muxer writes video frames to image files.

The output filenames are specified by a pattern, which can be used to
produce sequentially numbered series of files. The pattern may contain
the string \"%d\" or \"%0`N`{.variable}d\", this string specifies the
position of the characters representing a numbering in the filenames. If
the form \"%0`N`{.variable}d\" is used, the string representing the
number in each filename is 0-padded to `N`{.variable} digits. The
literal character '%' can be specified in the pattern with the string
\"%%\".

If the pattern contains \"%d\" or \"%0`N`{.variable}d\", the first
filename of the file list specified will contain the number 1, all the
following numbers will be sequential.

The pattern may contain a suffix which is used to automatically
determine the format of the image files to write.

For example the pattern \"img-%03d.bmp\" will specify a sequence of
filenames of the form `img-001.bmp`{.sample}, `img-002.bmp`{.sample},
\..., `img-010.bmp`{.sample}, etc. The pattern \"img%%-%d.jpg\" will
specify a sequence of filenames of the form `img%-1.jpg`{.sample},
`img%-2.jpg`{.sample}, \..., `img%-10.jpg`{.sample}, etc.

The image muxer supports the .Y.U.V image file format. This format is
special in that each image frame consists of three files, for each of
the YUV420P components. To read or write this image file format, specify
the name of the '.Y' file. The muxer will automatically open the '.U'
and '.V' files as required.

The '`image2pipe`{.sample}' muxer accepts the same options as the
'`image2`{.sample}' muxer, but ignores the pattern verification and
expansion, as it is supposed to write to the command output rather than
to an actual stored file.

[]{#Options-84}

#### [21.50.1 Options](#toc-Options-84) {#options-84 .subsection}

`frame_pts `{.sample}`bool`{.variable}

:   If set to 1, expand the filename with the packet PTS (presentation
    time stamp). Default value is 0.

`start_number `{.sample}`count`{.variable}

:   Start the sequence from the specified number. Default value is 1.

`update `{.sample}`bool`{.variable}

:   If set to 1, the filename will always be interpreted as just a
    filename, not a pattern, and the corresponding file will be
    continuously overwritten with new images. Default value is 0.

`strftime `{.sample}`bool`{.variable}

:   If set to 1, expand the filename with date and time information from
    `strftime()`. Default value is 0.

`atomic_writing `{.sample}`bool`{.variable}

:   Write output to a temporary file, which is renamed to target
    filename once writing is completed. Default is disabled.

`protocol_opts `{.sample}`options_list`{.variable}

:   Set protocol options as a :-separated list of key=value parameters.
    Values containing the `:` special character must be escaped.

[]{#Examples-21}

#### [21.50.2 Examples](#toc-Examples-21) {#examples-21 .subsection}

- Use `ffmpeg` for creating a sequence of files `img-001.jpeg`{.sample},
  `img-002.jpeg`{.sample}, \..., taking one image every second from the
  input video:

  ::: example
  ``` example
  ffmpeg -i in.avi -vsync cfr -r 1 -f image2 'img-%03d.jpeg'
  ```
  :::

  Note that with `ffmpeg`, if the format is not specified with the `-f`
  option and the output filename specifies an image file format, the
  image2 muxer is automatically selected, so the previous command can be
  written as:

  ::: example
  ``` example
  ffmpeg -i in.avi -vsync cfr -r 1 'img-%03d.jpeg'
  ```
  :::

  Note also that the pattern must not necessarily contain \"%d\" or
  \"%0`N`{.variable}d\", for example to create a single image file
  `img.jpeg`{.sample} from the start of the input video you can employ
  the command:

  ::: example
  ``` example
  ffmpeg -i in.avi -f image2 -frames:v 1 img.jpeg
  ```
  :::

- The `strftime`{.sample} option allows you to expand the filename with
  date and time information. Check the documentation of the `strftime()`
  function for the syntax.

  To generate image files from the `strftime()` \"%Y-%m-%d\_%H-%M-%S\"
  pattern, the following `ffmpeg` command can be used:

  ::: example
  ``` example
  ffmpeg -f v4l2 -r 1 -i /dev/video0 -f image2 -strftime 1 "%Y-%m-%d_%H-%M-%S.jpg"
  ```
  :::

- Set the file name with current frame's PTS:

  ::: example
  ``` example
  ffmpeg -f v4l2 -r 1 -i /dev/video0 -copyts -f image2 -frame_pts true %d.jpg
  ```
  :::

- Publish contents of your desktop directly to a WebDAV server every
  second:

  ::: example
  ``` example
  ffmpeg -f x11grab -framerate 1 -i :0.0 -q:v 6 -update 1 -protocol_opts method=PUT http://example.com/desktop.jpg
  ```
  :::

[]{#ircam}

### [21.51 ircam](#toc-ircam) {#ircam .section}

Berkeley / IRCAM / CARL Sound Filesystem (BICSF) format muxer.

The Berkeley/IRCAM/CARL Sound Format, developed in the 1980s, is a
result of the merging of several different earlier sound file formats
and systems including the csound system developed by Dr Gareth Loy at
the Computer Audio Research Lab (CARL) at UC San Diego, the IRCAM sound
file system developed by Rob Gross and Dan Timis at the Institut de
Recherche et Coordination Acoustique / Musique in Paris and the Berkeley
Fast Filesystem.

It was developed initially as part of the Berkeley/IRCAM/CARL Sound
Filesystem, a suite of programs designed to implement a filesystem for
audio applications running under Berkeley UNIX. It was particularly
popular in academic music research centres, and was used a number of
times in the creation of early computer-generated compositions.

This muxer accepts a single audio stream containing PCM data.

[]{#ivf}

### [21.52 ivf](#toc-ivf) {#ivf .section}

On2 IVF muxer.

IVF was developed by On2 Technologies (formerly known as Duck
Corporation), to store internally developed codecs.

This muxer accepts a single '`vp8`{.sample}', '`vp9`{.sample}', or
'`av1`{.sample}' video stream.

[]{#jacosub}

### [21.53 jacosub](#toc-jacosub) {#jacosub .section}

JACOsub subtitle format muxer.

This muxer accepts a single '`jacosub`{.sample}' subtitles stream.

For more information about the format, see
<http://unicorn.us.com/jacosub/jscripts.html>.

[]{#kvag}

### [21.54 kvag](#toc-kvag) {#kvag .section}

Simon & Schuster Interactive VAG muxer.

This custom VAG container is used by some Simon & Schuster Interactive
games such as \"Real War\", and \"Real War: Rogue States\".

This muxer accepts a single '`adpcm_ima_ssi`{.sample}' audio stream.

[]{#lc3}

### [21.55 lc3](#toc-lc3) {#lc3 .section}

Bluetooth SIG Low Complexity Communication Codec audio (LC3), or ETSI TS
103 634 Low Complexity Communication Codec plus (LC3plus).

This muxer accepts a single '`lc3`{.sample}' audio stream.

[]{#lrc-1}

### [21.56 lrc](#toc-lrc-1) {#lrc-1 .section}

LRC lyrics file format muxer.

LRC (short for LyRiCs) is a computer file format that synchronizes song
lyrics with an audio file, such as MP3, Vorbis, or MIDI.

This muxer accepts a single '`subrip`{.sample}' or '`text`{.sample}'
subtitles stream.

[]{#Metadata}

#### [21.56.1 Metadata](#toc-Metadata) {#metadata .subsection}

The following metadata tags are converted to the format corresponding
metadata:

`title`{.sample}

`album`{.sample}

`artist`{.sample}

`author`{.sample}

`creator`{.sample}

`encoder`{.sample}

`encoder_version`{.sample}

If '`encoder_version`{.sample}' is not explicitly set, it is
automatically set to the libavformat version.

[]{#matroska}

### [21.57 matroska](#toc-matroska) {#matroska .section}

Matroska container muxer.

This muxer implements the matroska and webm container specs.

[]{#Metadata-1}

#### [21.57.1 Metadata](#toc-Metadata-1) {#metadata-1 .subsection}

The recognized metadata settings in this muxer are:

`title`{.sample}

:   Set title name provided to a single track. This gets mapped to the
    FileDescription element for a stream written as attachment.

`language`{.sample}

:   Specify the language of the track in the Matroska languages form.

    The language can be either the 3 letters bibliographic ISO-639-2
    (ISO 639-2/B) form (like \"fre\" for French), or a language code
    mixed with a country code for specialities in languages (like
    \"fre-ca\" for Canadian French).

`stereo_mode`{.sample}

:   Set stereo 3D video layout of two views in a single video track.

    The following values are recognized:

    '`mono`{.sample}'

    :   video is not stereo

    '`left_right`{.sample}'

    :   Both views are arranged side by side, Left-eye view is on the
        left

    '`bottom_top`{.sample}'

    :   Both views are arranged in top-bottom orientation, Left-eye view
        is at bottom

    '`top_bottom`{.sample}'

    :   Both views are arranged in top-bottom orientation, Left-eye view
        is on top

    '`checkerboard_rl`{.sample}'

    :   Each view is arranged in a checkerboard interleaved pattern,
        Left-eye view being first

    '`checkerboard_lr`{.sample}'

    :   Each view is arranged in a checkerboard interleaved pattern,
        Right-eye view being first

    '`row_interleaved_rl`{.sample}'

    :   Each view is constituted by a row based interleaving, Right-eye
        view is first row

    '`row_interleaved_lr`{.sample}'

    :   Each view is constituted by a row based interleaving, Left-eye
        view is first row

    '`col_interleaved_rl`{.sample}'

    :   Both views are arranged in a column based interleaving manner,
        Right-eye view is first column

    '`col_interleaved_lr`{.sample}'

    :   Both views are arranged in a column based interleaving manner,
        Left-eye view is first column

    '`anaglyph_cyan_red`{.sample}'

    :   All frames are in anaglyph format viewable through red-cyan
        filters

    '`right_left`{.sample}'

    :   Both views are arranged side by side, Right-eye view is on the
        left

    '`anaglyph_green_magenta`{.sample}'

    :   All frames are in anaglyph format viewable through green-magenta
        filters

    '`block_lr`{.sample}'

    :   Both eyes laced in one Block, Left-eye view is first

    '`block_rl`{.sample}'

    :   Both eyes laced in one Block, Right-eye view is first

For example a 3D WebM clip can be created using the following command
line:

::: example
``` example
ffmpeg -i sample_left_right_clip.mpg -an -c:v libvpx -metadata stereo_mode=left_right -y stereo_clip.webm
```
:::

[]{#Options-85}

#### [21.57.2 Options](#toc-Options-85) {#options-85 .subsection}

`reserve_index_space `{.sample}`size`{.variable}

:   By default, this muxer writes the index for seeking (called cues in
    Matroska terms) at the end of the file, because it cannot know in
    advance how much space to leave for the index at the beginning of
    the file. However for some use cases -- e.g. streaming where seeking
    is possible but slow -- it is useful to put the index at the
    beginning of the file.

    If this option is set to a non-zero value, the muxer will reserve
    `size`{.variable} bytes of space in the file header and then try to
    write the cues there when the muxing finishes. If the reserved space
    does not suffice, no Cues will be written, the file will be
    finalized and writing the trailer will return an error. A safe size
    for most use cases should be about 50kB per hour of video.

    Note that cues are only written if the output is seekable and this
    option will have no effect if it is not.

`cues_to_front `{.sample}`bool`{.variable}

:   If set, the muxer will write the index at the beginning of the file
    by shifting the main data if necessary. This can be combined with
    reserve_index_space in which case the data is only shifted if the
    initially reserved space turns out to be insufficient.

    This option is ignored if the output is unseekable.

`cluster_size_limit `{.sample}`size`{.variable}

:   Store at most the provided amount of bytes in a cluster.

    If not specified, the limit is set automatically to a sensible
    hardcoded fixed value.

`cluster_time_limit `{.sample}`duration`{.variable}

:   Store at most the provided number of milliseconds in a cluster.

    If not specified, the limit is set automatically to a sensible
    hardcoded fixed value.

`dash `{.sample}`bool`{.variable}

:   Create a WebM file conforming to WebM DASH specification. By default
    it is set to `false`.

`dash_track_number `{.sample}`index`{.variable}

:   Track number for the DASH stream. By default it is set to `1`.

`live `{.sample}`bool`{.variable}

:   Write files assuming it is a live stream. By default it is set to
    `false`.

`allow_raw_vfw `{.sample}`bool`{.variable}

:   Allow raw VFW mode. By default it is set to `false`.

`flipped_raw_rgb `{.sample}`bool`{.variable}

:   If set to `true`, store positive height for raw RGB bitmaps, which
    indicates bitmap is stored bottom-up. Note that this option does not
    flip the bitmap which has to be done manually beforehand, e.g. by
    using the '`vflip`{.sample}' filter. Default is `false` and
    indicates bitmap is stored top down.

`write_crc32 `{.sample}`bool`{.variable}

:   Write a CRC32 element inside every Level 1 element. By default it is
    set to `true`. This option is ignored for WebM.

`default_mode `{.sample}`mode`{.variable}

:   Control how the FlagDefault of the output tracks will be set. It
    influences which tracks players should play by default. The default
    mode is '`passthrough`{.sample}'.

    '`infer`{.sample}'

    :   Every track with disposition default will have the FlagDefault
        set. Additionally, for each type of track (audio, video or
        subtitle), if no track with disposition default of this type
        exists, then the first track of this type will be marked as
        default (if existing). This ensures that the default flag is set
        in a sensible way even if the input originated from containers
        that lack the concept of default tracks.

    '`infer_no_subs`{.sample}'

    :   This mode is the same as infer except that if no subtitle track
        with disposition default exists, no subtitle track will be
        marked as default.

    '`passthrough`{.sample}'

    :   In this mode the FlagDefault is set if and only if the
        AV_DISPOSITION_DEFAULT flag is set in the disposition of the
        corresponding stream.

[]{#md5}[]{#md5-1}

### [21.58 md5](#toc-md5-1) {#md5 .section}

MD5 testing format.

This is a variant of the [hash](#hash) muxer. Unlike that muxer, it
defaults to using the MD5 hash function.

See also the [hash](#hash) and [framemd5](#framemd5) muxers.

[]{#Examples-22}

#### [21.58.1 Examples](#toc-Examples-22) {#examples-22 .subsection}

- To compute the MD5 hash of the input converted to raw audio and video,
  and store it in the file `out.md5`{.sample}:

  ::: example
  ``` example
  ffmpeg -i INPUT -f md5 out.md5
  ```
  :::
- To print the MD5 hash to stdout:

  ::: example
  ``` example
  ffmpeg -i INPUT -f md5 -
  ```
  :::

[]{#mccenc}[]{#mcc-1}

### [21.59 mcc](#toc-mcc-1) {#mcc-1 .section}

Muxer for MacCaption MCC files, it supports MCC versions 1.0 and 2.0.
MCC files store VANC data, which can include closed captions (EIA-608
and CEA-708), ancillary time code, pan-scan data, etc.

[]{#Options-86}

#### [21.59.1 Options](#toc-Options-86) {#options-86 .subsection}

The muxer options are:

`override_time_code_rate`{.sample}

:   Override the `Time Code Rate` value in the output. Defaults to
    trying to deduce from the stream's `time_base`, which often doesn't
    work.

`use_u_alias`{.sample}

:   Use the `U` alias for the byte sequence `E1h 00h 00h 00h`. Disabled
    by default because some `.mcc`{.sample} files disagree on whether it
    has 2 or 3 zero bytes.

`mcc_version`{.sample}

:   The MCC file format version. Must be either 1 or 2, defaults to 2.

`creation_program`{.sample}

:   The creation program. Defaults to this version of FFmpeg.

`creation_time`{.sample}

:   The creation time. Defaults to the current time.

[]{#Examples-23}

#### [21.59.2 Examples](#toc-Examples-23) {#examples-23 .subsection}

- Extract a MXF `SMPTE_436M_ANC` stream from a MXF file and write it to
  a MCC file at 30 fps.

  ::: example
  ``` example
  ffmpeg -i input.mxf -c copy -map 0:d -override_time_code_rate 30 out.mcc
  ```
  :::
- Extract EIA-608/CTA-708 closed captions from a `.mp4`{.sample} file
  and write them to a MCC file at 29.97 fps.

  ::: example
  ``` example
  ffmpeg -f lavfi -i "movie=input.mp4[out+subcc]" -c:s copy -map 0:s -override_time_code_rate 30000/1001 out.mcc
  ```
  :::

[]{#microdvd}

### [21.60 microdvd](#toc-microdvd) {#microdvd .section}

MicroDVD subtitle format muxer.

This muxer accepts a single '`microdvd`{.sample}' subtitles stream.

[]{#mmf}

### [21.61 mmf](#toc-mmf) {#mmf .section}

Synthetic music Mobile Application Format (SMAF) format muxer.

SMAF is a music data format specified by Yamaha for portable electronic
devices, such as mobile phones and personal digital assistants.

This muxer accepts a single '`adpcm_yamaha`{.sample}' audio stream.

[]{#mp3}

### [21.62 mp3](#toc-mp3) {#mp3 .section}

The MP3 muxer writes a raw MP3 stream with the following optional
features:

- An ID3v2 metadata header at the beginning (enabled by default).
  Versions 2.3 and 2.4 are supported, the `id3v2_version` private option
  controls which one is used (3 or 4). Setting `id3v2_version` to 0
  disables the ID3v2 header completely.

  The muxer supports writing attached pictures (APIC frames) to the
  ID3v2 header. The pictures are supplied to the muxer in form of a
  video stream with a single packet. There can be any number of those
  streams, each will correspond to a single APIC frame. The stream
  metadata tags `title`{.variable} and `comment`{.variable} map to APIC
  `description`{.variable} and `picture type`{.variable} respectively.
  See <http://id3.org/id3v2.4.0-frames> for allowed picture types.

  Note that the APIC frames must be written at the beginning, so the
  muxer will buffer the audio frames until it gets all the pictures. It
  is therefore advised to provide the pictures as soon as possible to
  avoid excessive buffering.

- A Xing/LAME frame right after the ID3v2 header (if present). It is
  enabled by default, but will be written only if the output is
  seekable. The `write_xing` private option can be used to disable it.
  The frame contains various information that may be useful to the
  decoder, like the audio duration or encoder delay.

- A legacy ID3v1 tag at the end of the file (disabled by default). It
  may be enabled with the `write_id3v1` private option, but as its
  capabilities are very limited, its usage is not recommended.

Examples:

Write an mp3 with an ID3v2.3 header and an ID3v1 footer:

::: example
``` example
ffmpeg -i INPUT -id3v2_version 3 -write_id3v1 1 out.mp3
```
:::

To attach a picture to an mp3 file select both the audio and the picture
stream with `map`:

::: example
``` example
ffmpeg -i input.mp3 -i cover.png -c copy -map 0 -map 1
-metadata:s:v title="Album cover" -metadata:s:v comment="Cover (Front)" out.mp3
```
:::

Write a \"clean\" MP3 without any extra features:

::: example
``` example
ffmpeg -i input.wav -write_xing 0 -id3v2_version 0 out.mp3
```
:::

[]{#mpegts-1}

### [21.63 mpegts](#toc-mpegts-1) {#mpegts-1 .section}

MPEG transport stream muxer.

This muxer implements ISO 13818-1 and part of ETSI EN 300 468.

The recognized metadata settings in mpegts muxer are `service_provider`
and `service_name`. If they are not set the default for
`service_provider` is '`FFmpeg`{.sample}' and the default for
`service_name` is '`Service01`{.sample}'.

[]{#Options-87}

#### [21.63.1 Options](#toc-Options-87) {#options-87 .subsection}

The muxer options are:

`mpegts_transport_stream_id `{.sample}`integer`{.variable}

:   Set the '`transport_stream_id`{.sample}'. This identifies a
    transponder in DVB. Default is `0x0001`.

`mpegts_original_network_id `{.sample}`integer`{.variable}

:   Set the '`original_network_id`{.sample}'. This is unique identifier
    of a network in DVB. Its main use is in the unique identification of
    a service through the path
    '`Original_Network_ID, Transport_Stream_ID`{.sample}'. Default is
    `0x0001`.

`mpegts_service_id `{.sample}`integer`{.variable}

:   Set the '`service_id`{.sample}', also known as program in DVB.
    Default is `0x0001`.

`mpegts_service_type `{.sample}`integer`{.variable}

:   Set the program '`service_type`{.sample}'. Default is `digital_tv`.
    Accepts the following options:

    '`hex_value`{.sample}'

    :   Any hexadecimal value between `0x01` and `0xff` as defined in
        ETSI 300 468.

    '`digital_tv`{.sample}'

    :   Digital TV service.

    '`digital_radio`{.sample}'

    :   Digital Radio service.

    '`teletext`{.sample}'

    :   Teletext service.

    '`advanced_codec_digital_radio`{.sample}'

    :   Advanced Codec Digital Radio service.

    '`mpeg2_digital_hdtv`{.sample}'

    :   MPEG2 Digital HDTV service.

    '`advanced_codec_digital_sdtv`{.sample}'

    :   Advanced Codec Digital SDTV service.

    '`advanced_codec_digital_hdtv`{.sample}'

    :   Advanced Codec Digital HDTV service.

`mpegts_pmt_start_pid `{.sample}`integer`{.variable}

:   Set the first PID for PMTs. Default is `0x1000`, minimum is
    `0x0020`, maximum is `0x1ffa`. This option has no effect in m2ts
    mode where the PMT PID is fixed `0x0100`.

`mpegts_start_pid `{.sample}`integer`{.variable}

:   Set the first PID for elementary streams. Default is `0x0100`,
    minimum is `0x0020`, maximum is `0x1ffa`. This option has no effect
    in m2ts mode where the elementary stream PIDs are fixed.

`mpegts_m2ts_mode `{.sample}`boolean`{.variable}

:   Enable m2ts mode if set to `1`. Default value is `-1` which disables
    m2ts mode.

`muxrate `{.sample}`integer`{.variable}

:   Set a constant muxrate. Default is VBR.

`pes_payload_size `{.sample}`integer`{.variable}

:   Set minimum PES packet payload in bytes. Default is `2930`.

`mpegts_flags `{.sample}`flags`{.variable}

:   Set mpegts flags. Accepts the following options:

    '`resend_headers`{.sample}'

    :   Reemit PAT/PMT before writing the next packet.

    '`latm`{.sample}'

    :   Use LATM packetization for AAC.

    '`pat_pmt_at_frames`{.sample}'

    :   Reemit PAT and PMT at each video frame.

    '`system_b`{.sample}'

    :   Conform to System B (DVB) instead of System A (ATSC).

    '`initial_discontinuity`{.sample}'

    :   Mark the initial packet of each stream as discontinuity.

    '`nit`{.sample}'

    :   Emit NIT table.

    '`omit_rai`{.sample}'

    :   Disable writing of random access indicator.

`mpegts_copyts `{.sample}`boolean`{.variable}

:   Preserve original timestamps, if value is set to `1`. Default value
    is `-1`, which results in shifting timestamps so that they start
    from 0.

`omit_video_pes_length `{.sample}`boolean`{.variable}

:   Omit the PES packet length for video packets. Default is `1` (true).

`pcr_period `{.sample}`integer`{.variable}

:   Override the default PCR retransmission time in milliseconds.
    Default is `-1` which means that the PCR interval will be determined
    automatically: 20 ms is used for CBR streams, the highest multiple
    of the frame duration which is less than 100 ms is used for VBR
    streams.

`pat_period `{.sample}`duration`{.variable}

:   Maximum time in seconds between PAT/PMT tables. Default is `0.1`.

`sdt_period `{.sample}`duration`{.variable}

:   Maximum time in seconds between SDT tables. Default is `0.5`.

`nit_period `{.sample}`duration`{.variable}

:   Maximum time in seconds between NIT tables. Default is `0.5`.

`tables_version `{.sample}`integer`{.variable}

:   Set PAT, PMT, SDT and NIT version (default `0`, valid values are
    from 0 to 31, inclusively). This option allows updating stream
    structure so that standard consumer may detect the change. To do so,
    reopen output `AVFormatContext` (in case of API usage) or restart
    `ffmpeg` instance, cyclically changing `tables_version`{.sample}
    value:

    ::: example
    ``` example
    ffmpeg -i source1.ts -codec copy -f mpegts -tables_version 0 udp://1.1.1.1:1111
    ffmpeg -i source2.ts -codec copy -f mpegts -tables_version 1 udp://1.1.1.1:1111
    ...
    ffmpeg -i source3.ts -codec copy -f mpegts -tables_version 31 udp://1.1.1.1:1111
    ffmpeg -i source1.ts -codec copy -f mpegts -tables_version 0 udp://1.1.1.1:1111
    ffmpeg -i source2.ts -codec copy -f mpegts -tables_version 1 udp://1.1.1.1:1111
    ...
    ```
    :::

[]{#Example-8}

#### [21.63.2 Example](#toc-Example-8) {#example-8 .subsection}

::: example
``` example
ffmpeg -i file.mpg -c copy \
     -mpegts_original_network_id 0x1122 \
     -mpegts_transport_stream_id 0x3344 \
     -mpegts_service_id 0x5566 \
     -mpegts_pmt_start_pid 0x1500 \
     -mpegts_start_pid 0x150 \
     -metadata service_provider="Some provider" \
     -metadata service_name="Some Channel" \
     out.ts
```
:::

[]{#mxf_002c-mxf_005fd10_002c-mxf_005fopatom}

### [21.64 mxf, mxf_d10, mxf_opatom](#toc-mxf_002c-mxf_005fd10_002c-mxf_005fopatom) {#mxf-mxf_d10-mxf_opatom .section}

MXF muxer.

[]{#Options-88}

#### [21.64.1 Options](#toc-Options-88) {#options-88 .subsection}

The muxer options are:

`store_user_comments `{.sample}`bool`{.variable}

:   Set if user comments should be stored if available or never. IRT
    D-10 does not allow user comments. The default is thus to write them
    for mxf and mxf_opatom but not for mxf_d10

[]{#null-1}

### [21.65 null](#toc-null-1) {#null-1 .section}

Null muxer.

This muxer does not generate any output file, it is mainly useful for
testing or benchmarking purposes.

For example to benchmark decoding with `ffmpeg` you can use the command:

::: example
``` example
ffmpeg -benchmark -i INPUT -f null out.null
```
:::

Note that the above command does not read or write the
`out.null`{.sample} file, but specifying the output file is required by
the `ffmpeg` syntax.

Alternatively you can write the command as:

::: example
``` example
ffmpeg -benchmark -i INPUT -f null -
```
:::

[]{#nut}

### [21.66 nut](#toc-nut) {#nut .section}

`-syncpoints `{.sample}`flags`{.variable}

Change the syncpoint usage in nut:

`default`{.variable}` use the normal low-overhead seeking aids.`{.sample}

`none`{.variable}` do not use the syncpoints at all, reducing the overhead but making the stream non-seekable;`{.sample}

Use of this option is not recommended, as the resulting files are very
damage sensitive and seeking is not possible. Also in general the
overhead from syncpoints is negligible. Note, -`write_index` 0 can be
used to disable all growing data tables, allowing to mux endless streams
with limited memory and without these disadvantages.

`timestamped`{.variable}` extend the syncpoint with a wallclock field.`{.sample}

The `none`{.variable} and `timestamped`{.variable} flags are
experimental.

`-write_index `{.sample}`bool`{.variable}

Write index at the end, the default is to write an index.

::: example
``` example
ffmpeg -i INPUT -f_strict experimental -syncpoints none - | processor
```
:::

[]{#ogg}

### [21.67 ogg](#toc-ogg) {#ogg .section}

Ogg container muxer.

`-page_duration `{.sample}`duration`{.variable}

:   Preferred page duration, in microseconds. The muxer will attempt to
    create pages that are approximately `duration`{.variable}
    microseconds long. This allows the user to compromise between seek
    granularity and container overhead. The default is 1 second. A value
    of 0 will fill all segments, making pages as large as possible. A
    value of 1 will effectively use 1 packet-per-page in most
    situations, giving a small seek granularity at the cost of
    additional container overhead.

`-serial_offset `{.sample}`value`{.variable}

:   Serial value from which to set the streams serial number. Setting it
    to different and sufficiently large values ensures that the produced
    ogg files can be safely chained.

[]{#rcwtenc}[]{#rcwt-1}

### [21.68 rcwt](#toc-rcwt-1) {#rcwt-1 .section}

RCWT (Raw Captions With Time) is a format native to ccextractor, a
commonly used open source tool for processing 608/708 Closed Captions
(CC) sources. It can be used to archive the original extracted CC
bitstream and to produce a source file for later processing or
conversion. The format allows for interoperability between ccextractor
and FFmpeg, is simple to parse, and can be used to create a backup of
the CC presentation.

This muxer implements the specification as of March 2024, which has been
stable and unchanged since April 2014.

This muxer will have some nuances from the way that ccextractor muxes
RCWT. No compatibility issues when processing the output with
ccextractor have been observed as a result of this so far, but mileage
may vary and outputs will not be a bit-exact match.

A free specification of RCWT can be found here:
<https://github.com/CCExtractor/ccextractor/blob/master/docs/BINARY_FILE_FORMAT.TXT>

[]{#Examples-24}

#### [21.68.1 Examples](#toc-Examples-24) {#examples-24 .subsection}

- Extract Closed Captions to RCWT using lavfi:

  ::: example
  ``` example
  ffmpeg -f lavfi -i "movie=INPUT.mkv[out+subcc]" -map 0:s:0 -c:s copy -f rcwt CC.rcwt.bin
  ```
  :::

[]{#segment}[]{#segment_002c-stream_005fsegment_002c-ssegment}

### [21.69 segment, stream_segment, ssegment](#toc-segment_002c-stream_005fsegment_002c-ssegment) {#segment-stream_segment-ssegment .section}

Basic stream segmenter.

This muxer outputs streams to a number of separate files of nearly fixed
duration. Output filename pattern can be set in a fashion similar to
[image2](#image2), or by using a `strftime` template if the
`strftime`{.sample} option is enabled.

`stream_segment` is a variant of the muxer used to write to streaming
output formats, i.e. which do not require global headers, and is
recommended for outputting e.g. to MPEG transport stream segments.
`ssegment` is a shorter alias for `stream_segment`.

Every segment starts with a keyframe of the selected reference stream,
which is set through the `reference_stream`{.sample} option.

Note that if you want accurate splitting for a video file, you need to
make the input key frames correspond to the exact splitting times
expected by the segmenter, or the segment muxer will start the new
segment with the key frame found next after the specified start time.

The segment muxer works best with a single constant frame rate video.

Optionally it can generate a list of the created segments, by setting
the option `segment_list`{.variable}. The list type is specified by the
`segment_list_type`{.variable} option. The entry filenames in the
segment list are set by default to the basename of the corresponding
segment files.

See also the [hls](#hls) muxer, which provides a more specific
implementation for HLS segmentation.

[]{#Options-89}

#### [21.69.1 Options](#toc-Options-89) {#options-89 .subsection}

The segment muxer supports the following options:

`increment_tc `{.sample}`1|0`{.variable}

:   if set to `1`, increment timecode between each segment If this is
    selected, the input need to have a timecode in the first video
    stream. Default value is `0`.

`reference_stream `{.sample}`specifier`{.variable}

:   Set the reference stream, as specified by the string
    `specifier`{.variable}. If `specifier`{.variable} is set to `auto`,
    the reference is chosen automatically. Otherwise it must be a stream
    specifier (see the "Stream specifiers" chapter in the ffmpeg manual)
    which specifies the reference stream. The default value is `auto`.

`segment_format `{.sample}`format`{.variable}

:   Override the inner container format, by default it is guessed by the
    filename extension.

`segment_format_options `{.sample}`options_list`{.variable}

:   Set output format options using a :-separated list of key=value
    parameters. Values containing the `:` special character must be
    escaped.

`segment_list `{.sample}`name`{.variable}

:   Generate also a listfile named `name`{.variable}. If not specified
    no listfile is generated.

`segment_list_flags `{.sample}`flags`{.variable}

:   Set flags affecting the segment list generation.

    It currently supports the following flags:

    '`cache`{.sample}'

    :   Allow caching (only affects M3U8 list files).

    '`live`{.sample}'

    :   Allow live-friendly file generation.

`segment_list_size `{.sample}`size`{.variable}

:   Update the list file so that it contains at most `size`{.variable}
    segments. If 0 the list file will contain all the segments. Default
    value is 0.

`segment_list_entry_prefix `{.sample}`prefix`{.variable}

:   Prepend `prefix`{.variable} to each entry. Useful to generate
    absolute paths. By default no prefix is applied.

`segment_list_type `{.sample}`type`{.variable}

:   Select the listing format.

    The following values are recognized:

    '`flat`{.sample}'

    :   Generate a flat list for the created segments, one segment per
        line.

    '`csv, ext`{.sample}'

    :   Generate a list for the created segments, one segment per line,
        each line matching the format (comma-separated values):

        ::: example
        ``` example
        segment_filename,segment_start_time,segment_end_time
        ```
        :::

        `segment_filename`{.variable} is the name of the output file
        generated by the muxer according to the provided pattern. CSV
        escaping (according to RFC4180) is applied if required.

        `segment_start_time`{.variable} and
        `segment_end_time`{.variable} specify the segment start and end
        time expressed in seconds.

        A list file with the suffix `".csv"` or `".ext"` will
        auto-select this format.

        '`ext`{.sample}' is deprecated in favor or '`csv`{.sample}'.

    '`ffconcat`{.sample}'

    :   Generate an ffconcat file for the created segments. The
        resulting file can be read using the FFmpeg [concat](#concat)
        demuxer.

        A list file with the suffix `".ffcat"` or `".ffconcat"` will
        auto-select this format.

    '`m3u8`{.sample}'

    :   Generate an extended M3U8 file, version 3, compliant with
        <http://tools.ietf.org/id/draft-pantos-http-live-streaming>.

        A list file with the suffix `".m3u8"` will auto-select this
        format.

    If not specified the type is guessed from the list file name suffix.

`segment_time `{.sample}`time`{.variable}

:   Set segment duration to `time`{.variable}, the value must be a
    duration specification. Default value is \"2\". See also the
    `segment_times`{.sample} option.

    Note that splitting may not be accurate, unless you force the
    reference stream key-frames at the given time. See the introductory
    notice and the examples below.

`min_seg_duration `{.sample}`time`{.variable}

:   Set minimum segment duration to `time`{.variable}, the value must be
    a duration specification. This prevents the muxer ending segments at
    a duration below this value. Only effective with `segment_time`.
    Default value is \"0\".

`segment_atclocktime `{.sample}`1|0`{.variable}

:   If set to \"1\" split at regular clock time intervals starting from
    00:00 o'clock. The `time`{.variable} value specified in
    `segment_time`{.sample} is used for setting the length of the
    splitting interval.

    For example with `segment_time`{.sample} set to \"900\" this makes
    it possible to create files at 12:00 o'clock, 12:15, 12:30, etc.

    Default value is \"0\".

`segment_clocktime_offset `{.sample}`duration`{.variable}

:   Delay the segment splitting times with the specified duration when
    using `segment_atclocktime`{.sample}.

    For example with `segment_time`{.sample} set to \"900\" and
    `segment_clocktime_offset`{.sample} set to \"300\" this makes it
    possible to create files at 12:05, 12:20, 12:35, etc.

    Default value is \"0\".

`segment_clocktime_wrap_duration `{.sample}`duration`{.variable}

:   Force the segmenter to only start a new segment if a packet reaches
    the muxer within the specified duration after the segmenting clock
    time. This way you can make the segmenter more resilient to backward
    local time jumps, such as leap seconds or transition to standard
    time from daylight savings time.

    Default is the maximum possible duration which means starting a new
    segment regardless of the elapsed time since the last clock time.

`segment_time_delta `{.sample}`delta`{.variable}

:   Specify the accuracy time when selecting the start time for a
    segment, expressed as a duration specification. Default value is
    \"0\".

    When delta is specified a key-frame will start a new segment if its
    PTS satisfies the relation:

    ::: example
    ``` example
    PTS >= start_time - time_delta
    ```
    :::

    This option is useful when splitting video content, which is always
    split at GOP boundaries, in case a key frame is found just before
    the specified split time.

    In particular may be used in combination with the `ffmpeg`{.sample}
    option `force_key_frames`{.variable}. The key frame times specified
    by `force_key_frames`{.variable} may not be set accurately because
    of rounding issues, with the consequence that a key frame time may
    result set just before the specified time. For constant frame rate
    videos a value of 1/(2\*`frame_rate`{.variable}) should address the
    worst case mismatch between the specified time and the time set by
    `force_key_frames`{.variable}.

`segment_times `{.sample}`times`{.variable}

:   Specify a list of split points. `times`{.variable} contains a list
    of comma separated duration specifications, in increasing order. See
    also the `segment_time`{.sample} option.

`segment_frames `{.sample}`frames`{.variable}

:   Specify a list of split video frame numbers. `frames`{.variable}
    contains a list of comma separated integer numbers, in increasing
    order.

    This option specifies to start a new segment whenever a reference
    stream key frame is found and the sequential number (starting
    from 0) of the frame is greater or equal to the next value in the
    list.

`segment_wrap `{.sample}`limit`{.variable}

:   Wrap around segment index once it reaches `limit`{.variable}.

`segment_start_number `{.sample}`number`{.variable}

:   Set the sequence number of the first segment. Defaults to `0`.

`strftime `{.sample}`1|0`{.variable}

:   Use the `strftime` function to define the name of the new segments
    to write. If this is selected, the output segment name must contain
    a `strftime` function template. Default value is `0`.

`break_non_keyframes `{.sample}`1|0`{.variable}

:   If enabled, allow segments to start on frames other than keyframes.
    This improves behavior on some players when the time between
    keyframes is inconsistent, but may make things worse on others, and
    can cause some oddities during seeking. Defaults to `0`.

`reset_timestamps `{.sample}`1|0`{.variable}

:   Reset timestamps at the beginning of each segment, so that each
    segment will start with near-zero timestamps. It is meant to ease
    the playback of the generated segments. May not work with some
    combinations of muxers/codecs. It is set to `0` by default.

`initial_offset `{.sample}`offset`{.variable}

:   Specify timestamp offset to apply to the output packet timestamps.
    The argument must be a time duration specification, and defaults to
    0.

`write_empty_segments `{.sample}`1|0`{.variable}

:   If enabled, write an empty segment if there are no packets during
    the period a segment would usually span. Otherwise, the segment will
    be filled with the next packet written. Defaults to `0`.

Make sure to require a closed GOP when encoding and to set the GOP size
to fit your segment time constraint.

[]{#Examples-25}

#### [21.69.2 Examples](#toc-Examples-25) {#examples-25 .subsection}

- Remux the content of file `in.mkv`{.sample} to a list of segments
  `out-000.nut`{.sample}, `out-001.nut`{.sample}, etc., and write the
  list of generated segments to `out.list`{.sample}:

  ::: example
  ``` example
  ffmpeg -i in.mkv -codec hevc -flags +cgop -g 60 -map 0 -f segment -segment_list out.list out%03d.nut
  ```
  :::

- Segment input and set output format options for the output segments:

  ::: example
  ``` example
  ffmpeg -i in.mkv -f segment -segment_time 10 -segment_format_options movflags=+faststart out%03d.mp4
  ```
  :::

- Segment the input file according to the split points specified by the
  `segment_times`{.variable} option:

  ::: example
  ``` example
  ffmpeg -i in.mkv -codec copy -map 0 -f segment -segment_list out.csv -segment_times 1,2,3,5,8,13,21 out%03d.nut
  ```
  :::

- Use the `ffmpeg` `force_key_frames`{.sample} option to force key
  frames in the input at the specified location, together with the
  segment option `segment_time_delta`{.sample} to account for possible
  roundings operated when setting key frame times.

  ::: example
  ``` example
  ffmpeg -i in.mkv -force_key_frames 1,2,3,5,8,13,21 -codec:v mpeg4 -codec:a pcm_s16le -map 0 \
  -f segment -segment_list out.csv -segment_times 1,2,3,5,8,13,21 -segment_time_delta 0.05 out%03d.nut
  ```
  :::

  In order to force key frames on the input file, transcoding is
  required.

- Segment the input file by splitting the input file according to the
  frame numbers sequence specified with the `segment_frames`{.sample}
  option:

  ::: example
  ``` example
  ffmpeg -i in.mkv -codec copy -map 0 -f segment -segment_list out.csv -segment_frames 100,200,300,500,800 out%03d.nut
  ```
  :::

- Convert the `in.mkv`{.sample} to TS segments using the `libx264` and
  `aac` encoders:

  ::: example
  ``` example
  ffmpeg -i in.mkv -map 0 -codec:v libx264 -codec:a aac -f ssegment -segment_list out.list out%03d.ts
  ```
  :::

- Segment the input file, and create an M3U8 live playlist (can be used
  as live HLS source):

  ::: example
  ``` example
  ffmpeg -re -i in.mkv -codec copy -map 0 -f segment -segment_list playlist.m3u8 \
  -segment_list_flags +live -segment_time 10 out%03d.mkv
  ```
  :::

[]{#smoothstreaming}

### [21.70 smoothstreaming](#toc-smoothstreaming) {#smoothstreaming .section}

Smooth Streaming muxer generates a set of files (Manifest, chunks)
suitable for serving with conventional web server.

`window_size`{.sample}

:   Specify the number of fragments kept in the manifest. Default 0
    (keep all).

`extra_window_size`{.sample}

:   Specify the number of fragments kept outside of the manifest before
    removing from disk. Default 5.

`lookahead_count`{.sample}

:   Specify the number of lookahead fragments. Default 2.

`min_frag_duration`{.sample}

:   Specify the minimum fragment duration (in microseconds). Default
    5000000.

`remove_at_exit`{.sample}

:   Specify whether to remove all fragments when finished. Default 0 (do
    not remove).

[]{#streamhash}[]{#streamhash-1}

### [21.71 streamhash](#toc-streamhash-1) {#streamhash .section}

Per stream hash testing format.

This muxer computes and prints a cryptographic hash of all the input
frames, on a per-stream basis. This can be used for equality checks
without having to do a complete binary comparison.

By default audio frames are converted to signed 16-bit raw audio and
video frames to raw video before computing the hash, but the output of
explicit conversions to other codecs can also be used. Timestamps are
ignored. It uses the SHA-256 cryptographic hash function by default, but
supports several other algorithms.

The output of the muxer consists of one line per stream of the form:
`streamindex`{.variable},`streamtype`{.variable},`algo`{.variable}=`hash`{.variable},
where `streamindex`{.variable} is the index of the mapped stream,
`streamtype`{.variable} is a single character indicating the type of
stream, `algo`{.variable} is a short string representing the hash
function used, and `hash`{.variable} is a hexadecimal number
representing the computed hash.

`hash `{.sample}`algorithm`{.variable}

:   Use the cryptographic hash function specified by the string
    `algorithm`{.variable}. Supported values include `MD5`, `murmur3`,
    `RIPEMD128`, `RIPEMD160`, `RIPEMD256`, `RIPEMD320`, `SHA160`,
    `SHA224`, `SHA256` (default), `SHA512/224`, `SHA512/256`, `SHA384`,
    `SHA512`, `CRC32` and `adler32`.

[]{#Examples-26}

#### [21.71.1 Examples](#toc-Examples-26) {#examples-26 .subsection}

To compute the SHA-256 hash of the input converted to raw audio and
video, and store it in the file `out.sha256`{.sample}:

::: example
``` example
ffmpeg -i INPUT -f streamhash out.sha256
```
:::

To print an MD5 hash to stdout use the command:

::: example
``` example
ffmpeg -i INPUT -f streamhash -hash md5 -
```
:::

See also the [hash](#hash) and [framehash](#framehash) muxers.

[]{#tee}[]{#tee-1}

### [21.72 tee](#toc-tee-1) {#tee .section}

The tee muxer can be used to write the same data to several outputs,
such as files or streams. It can be used, for example, to stream a video
over a network and save it to disk at the same time.

It is different from specifying several outputs to the `ffmpeg`
command-line tool. With the tee muxer, the audio and video data will be
encoded only once. With conventional multiple outputs, multiple encoding
operations in parallel are initiated, which can be a very expensive
process. The tee muxer is not useful when using the libavformat API
directly because it is then possible to feed the same packets to several
muxers directly.

Since the tee muxer does not represent any particular output format,
ffmpeg cannot auto-select output streams. So all streams intended for
output must be specified using `-map`. See the examples below.

Some encoders may need different options depending on the output format;
the auto-detection of this can not work with the tee muxer, so they need
to be explicitly specified. The main example is the
`global_header`{.sample} flag.

The slave outputs are specified in the file name given to the muxer,
separated by '\|'. If any of the slave name contains the '\|' separator,
leading or trailing spaces or any special character, those must be
escaped (see [(ffmpeg-utils)the \"Quoting and escaping\" section in the
ffmpeg-utils(1)
manual](ffmpeg-utils.html#quoting_005fand_005fescaping)).

[]{#Options-90}

#### [21.72.1 Options](#toc-Options-90) {#options-90 .subsection}

`use_fifo `{.sample}`bool`{.variable}

:   If set to 1, slave outputs will be processed in separate threads
    using the [fifo](#fifo) muxer. This allows to compensate for
    different speed/latency/reliability of outputs and setup transparent
    recovery. By default this feature is turned off.

`fifo_options`{.sample}

:   Options to pass to fifo pseudo-muxer instances. See [fifo](#fifo).

Muxer options can be specified for each slave by prepending them as a
list of `key`{.variable}=`value`{.variable} pairs separated by ':',
between square brackets. If the options values contain a special
character or the ':' separator, they must be escaped; note that this is
a second level escaping.

The following special options are also recognized:

`f`{.sample}

:   Specify the format name. Required if it cannot be guessed from the
    output URL.

`bsfs[/`{.sample}`spec`{.variable}`]`{.sample}

:   Specify a list of bitstream filters to apply to the specified
    output.

    It is possible to specify to which streams a given bitstream filter
    applies, by appending a stream specifier to the option separated by
    `/`. `spec`{.variable} must be a stream specifier (see [Format
    stream specifiers](#Format-stream-specifiers)).

    If the stream specifier is not specified, the bitstream filters will
    be applied to all streams in the output. This will cause that output
    operation to fail if the output contains streams to which the
    bitstream filter cannot be applied e.g. `h264_mp4toannexb` being
    applied to an output containing an audio stream.

    Options for a bitstream filter must be specified in the form of
    `opt=value`.

    Several bitstream filters can be specified, separated by \",\".

`use_fifo `{.sample}`bool`{.variable}

:   This allows to override tee muxer use_fifo option for individual
    slave muxer.

`fifo_options`{.sample}

:   This allows to override tee muxer fifo_options for individual slave
    muxer. See [fifo](#fifo).

`select`{.sample}

:   Select the streams that should be mapped to the slave output,
    specified by a stream specifier. If not specified, this defaults to
    all the mapped streams. This will cause that output operation to
    fail if the output format does not accept all mapped streams.

    You may use multiple stream specifiers separated by commas (`,`)
    e.g.: `a:0,v`

`onfail`{.sample}

:   Specify behaviour on output failure. This can be set to either
    `abort` (which is default) or `ignore`. `abort` will cause whole
    process to fail in case of failure on this slave output. `ignore`
    will ignore failure on this output, so other outputs will continue
    without being affected.

[]{#Examples-27}

#### [21.72.2 Examples](#toc-Examples-27) {#examples-27 .subsection}

- Encode something and both archive it in a WebM file and stream it as
  MPEG-TS over UDP:

  ::: example
  ``` example
  ffmpeg -i ... -c:v libx264 -c:a mp2 -f tee -map 0:v -map 0:a
    "archive-20121107.mkv|[f=mpegts]udp://10.0.1.255:1234/"
  ```
  :::
- As above, but continue streaming even if output to local file fails
  (for example local drive fills up):

  ::: example
  ``` example
  ffmpeg -i ... -c:v libx264 -c:a mp2 -f tee -map 0:v -map 0:a
    "[onfail=ignore]archive-20121107.mkv|[f=mpegts]udp://10.0.1.255:1234/"
  ```
  :::
- Use `ffmpeg` to encode the input, and send the output to three
  different destinations. The `dump_extra` bitstream filter is used to
  add extradata information to all the output video keyframes packets,
  as requested by the MPEG-TS format. The select option is applied to
  `out.aac`{.sample} in order to make it contain only audio packets.

  ::: example
  ``` example
  ffmpeg -i ... -map 0 -flags +global_header -c:v libx264 -c:a aac
         -f tee "[bsfs/v=dump_extra=freq=keyframe]out.ts|[movflags=+faststart]out.mp4|[select=a]out.aac"
  ```
  :::
- As above, but select only stream `a:1` for the audio output. Note that
  a second level escaping must be performed, as \":\" is a special
  character used to separate options.

  ::: example
  ``` example
  ffmpeg -i ... -map 0 -flags +global_header -c:v libx264 -c:a aac
         -f tee "[bsfs/v=dump_extra=freq=keyframe]out.ts|[movflags=+faststart]out.mp4|[select=\'a:1\']out.aac"
  ```
  :::

[]{#webm_005fchunk}

### [21.73 webm_chunk](#toc-webm_005fchunk) {#webm_chunk .section}

WebM Live Chunk Muxer.

This muxer writes out WebM headers and chunks as separate files which
can be consumed by clients that support WebM Live streams via DASH.

[]{#Options-91}

#### [21.73.1 Options](#toc-Options-91) {#options-91 .subsection}

This muxer supports the following options:

`chunk_start_index`{.sample}

:   Index of the first chunk (defaults to 0).

`header`{.sample}

:   Filename of the header where the initialization data will be
    written.

`audio_chunk_duration`{.sample}

:   Duration of each audio chunk in milliseconds (defaults to 5000).

[]{#Example-9}

#### [21.73.2 Example](#toc-Example-9) {#example-9 .subsection}

::: example
``` example
ffmpeg -f v4l2 -i /dev/video0 \
       -f alsa -i hw:0 \
       -map 0:0 \
       -c:v libvpx-vp9 \
       -s 640x360 -keyint_min 30 -g 30 \
       -f webm_chunk \
       -header webm_live_video_360.hdr \
       -chunk_start_index 1 \
       webm_live_video_360_%d.chk \
       -map 1:0 \
       -c:a libvorbis \
       -b:a 128k \
       -f webm_chunk \
       -header webm_live_audio_128.hdr \
       -chunk_start_index 1 \
       -audio_chunk_duration 1000 \
       webm_live_audio_128_%d.chk
```
:::

[]{#webm_005fdash_005fmanifest}

### [21.74 webm_dash_manifest](#toc-webm_005fdash_005fmanifest) {#webm_dash_manifest .section}

WebM DASH Manifest muxer.

This muxer implements the WebM DASH Manifest specification to generate
the DASH manifest XML. It also supports manifest generation for DASH
live streams.

For more information see:

- WebM DASH Specification:
  <https://sites.google.com/a/webmproject.org/wiki/adaptive-streaming/webm-dash-specification>
- ISO DASH Specification:
  <http://standards.iso.org/ittf/PubliclyAvailableStandards/c065274_ISO_IEC_23009-1_2014.zip>

[]{#Options-92}

#### [21.74.1 Options](#toc-Options-92) {#options-92 .subsection}

This muxer supports the following options:

`adaptation_sets`{.sample}

:   This option has the following syntax: \"id=x,streams=a,b,c
    id=y,streams=d,e\" where x and y are the unique identifiers of the
    adaptation sets and a,b,c,d and e are the indices of the
    corresponding audio and video streams. Any number of adaptation sets
    can be added using this option.

`live`{.sample}

:   Set this to 1 to create a live stream DASH Manifest. Default: 0.

`chunk_start_index`{.sample}

:   Start index of the first chunk. This will go in the
    '`startNumber`{.sample}' attribute of the
    '`SegmentTemplate`{.sample}' element in the manifest. Default: 0.

`chunk_duration_ms`{.sample}

:   Duration of each chunk in milliseconds. This will go in the
    '`duration`{.sample}' attribute of the '`SegmentTemplate`{.sample}'
    element in the manifest. Default: 1000.

`utc_timing_url`{.sample}

:   URL of the page that will return the UTC timestamp in ISO format.
    This will go in the '`value`{.sample}' attribute of the
    '`UTCTiming`{.sample}' element in the manifest. Default: None.

`time_shift_buffer_depth`{.sample}

:   Smallest time (in seconds) shifting buffer for which any
    Representation is guaranteed to be available. This will go in the
    '`timeShiftBufferDepth`{.sample}' attribute of the '`MPD`{.sample}'
    element. Default: 60.

`minimum_update_period`{.sample}

:   Minimum update period (in seconds) of the manifest. This will go in
    the '`minimumUpdatePeriod`{.sample}' attribute of the
    '`MPD`{.sample}' element. Default: 0.

[]{#Example-10}

#### [21.74.2 Example](#toc-Example-10) {#example-10 .subsection}

::: example
``` example
ffmpeg -f webm_dash_manifest -i video1.webm \
       -f webm_dash_manifest -i video2.webm \
       -f webm_dash_manifest -i audio1.webm \
       -f webm_dash_manifest -i audio2.webm \
       -map 0 -map 1 -map 2 -map 3 \
       -c copy \
       -f webm_dash_manifest \
       -adaptation_sets "id=0,streams=0,1 id=1,streams=2,3" \
       manifest.xml
```
:::

[]{#whip}[]{#whip-1}

### [21.75 whip](#toc-whip-1) {#whip .section}

WebRTC (Real-Time Communication) muxer that supports sub-second latency
streaming according to the WHIP (WebRTC-HTTP ingestion protocol)
specification.

This is an experimental feature.

It uses HTTP as a signaling protocol to exchange SDP capabilities and
ICE lite candidates. Then, it uses STUN binding requests and responses
to establish a session over UDP. Subsequently, it initiates a DTLS
handshake to exchange the SRTP encryption keys. Lastly, it splits video
and audio frames into RTP packets and encrypts them using SRTP.

Ensure that you use H.264 without B frames and Opus for the audio codec.
For example, to convert an input file with `ffmpeg` to WebRTC:

::: example
``` example
ffmpeg -re -i input.mp4 -acodec libopus -ar 48000 -ac 2 \
  -vcodec libx264 -profile:v baseline -tune zerolatency -threads 1 -bf 0 \
  -f whip "http://localhost:1985/rtc/v1/whip/?app=live&stream=livestream"
```
:::

For this example, we have employed low latency options, resulting in an
end-to-end latency of approximately 150ms.

[]{#Options-93}

#### [21.75.1 Options](#toc-Options-93) {#options-93 .subsection}

This muxer supports the following options:

`handshake_timeout `{.sample}`integer`{.variable}

:   Set the timeout in milliseconds for ICE and DTLS handshake. Default
    value is 5000.

`pkt_size `{.sample}`integer`{.variable}

:   Set the maximum size, in bytes, of RTP packets that send out.
    Default value is 1200.

`ts_buffer_size `{.sample}`integer`{.variable}

:   Set the buffer size, in bytes, of underlying protocol. Default value
    is -1(auto). The UDP auto selects a reasonable value.

`whip_flags `{.sample}`flags`{.variable}

:   Possible values:

    '`dtls_active`{.sample}'

    :   The muxer will try to set dtls active role and send the first
        client hello.

`authorization `{.sample}`string`{.variable}

:   The optional Bearer token for WHIP Authorization.

`cert_file `{.sample}`string`{.variable}

:   The optional certificate file path for DTLS.

`key_file `{.sample}`string`{.variable}

:   The optional private key file path for DTLS.

[]{#metadata}[]{#Metadata-2}

## [22 Metadata](#toc-Metadata-2) {#metadata-2 .chapter}

FFmpeg is able to dump metadata from media files into a simple
UTF-8-encoded INI-like text file and then load it back using the
metadata muxer/demuxer.

The file format is as follows:

1.  A file consists of a header and a number of metadata tags divided
    into sections, each on its own line.

2.  The header is a '`;FFMETADATA`{.sample}' string, followed by a
    version number (now 1).

3.  Metadata tags are of the form '`key=value`{.sample}'

4.  Immediately after header follows global metadata

5.  After global metadata there may be sections with
    per-stream/per-chapter metadata.

6.  A section starts with the section name in uppercase (i.e. STREAM or
    CHAPTER) in brackets ('`[`{.sample}', '`]`{.sample}') and ends with
    next section or end of file.

7.  At the beginning of a chapter section there may be an optional
    timebase to be used for start/end values. It must be in form
    '`TIMEBASE=`{.sample}`num`{.variable}`/`{.sample}`den`{.variable}',
    where `num`{.variable} and `den`{.variable} are integers. If the
    timebase is missing then start/end times are assumed to be in
    nanoseconds.

    Next a chapter section must contain chapter start and end times in
    form '`START=`{.sample}`num`{.variable}',
    '`END=`{.sample}`num`{.variable}', where `num`{.variable} is a
    positive integer.

8.  Empty lines and lines starting with '`;`{.sample}' or '`#`{.sample}'
    are ignored.

9.  Metadata keys or values containing special characters
    ('`=`{.sample}', '`;`{.sample}', '`#`{.sample}', '`\`{.sample}' and
    a newline) must be escaped with a backslash '`\`{.sample}'.

10. Note that whitespace in metadata (e.g. '`foo = bar`{.sample}') is
    considered to be a part of the tag (in the example above key is
    '`foo `{.sample}', value is '` bar`{.sample}').

A ffmetadata file might look like this:

::: example
``` example
;FFMETADATA1
title=bike\\shed
;this is a comment
artist=FFmpeg troll team

[CHAPTER]
TIMEBASE=1/1000
START=0
#chapter ends at 0:01:00
END=60000
title=chapter \#1
[STREAM]
title=multi\
line
```
:::

By using the ffmetadata muxer and demuxer it is possible to extract
metadata from an input file to an ffmetadata file, and then transcode
the file into an output file with the edited ffmetadata file.

Extracting an ffmetadata file with `ffmpeg`{.sample} goes as follows:

::: example
``` example
ffmpeg -i INPUT -f ffmetadata FFMETADATAFILE
```
:::

Reinserting edited metadata information from the FFMETADATAFILE file can
be done as:

::: example
``` example
ffmpeg -i INPUT -i FFMETADATAFILE -map_metadata 1 -codec copy OUTPUT
```
:::

[]{#Protocol-Options}

## [23 Protocol Options](#toc-Protocol-Options) {#protocol-options .chapter}

The libavformat library provides some generic global options, which can
be set on all the protocols. In addition each protocol may support
so-called private options, which are specific for that component.

Options may be set by specifying -`option`{.variable} `value`{.variable}
in the FFmpeg tools, or by setting the value explicitly in the
`AVFormatContext` options or using the `libavutil/opt.h`{.sample} API
for programmatic use.

The list of supported options follows:

`protocol_whitelist `{.sample}`list`{.variable}` (`{.sample}*`input`{.sample}*`)`{.sample}

:   Set a \",\"-separated list of allowed protocols. \"ALL\" matches all
    protocols. Protocols prefixed by \"-\" are disabled. All protocols
    are allowed by default but protocols used by an another protocol
    (nested protocols) are restricted to a per protocol subset.

[]{#Protocols}

## [24 Protocols](#toc-Protocols) {#protocols .chapter}

Protocols are configured elements in FFmpeg that enable access to
resources that require specific protocols.

When you configure your FFmpeg build, all the supported protocols are
enabled by default. You can list all available ones using the configure
option \"--list-protocols\".

You can disable all the protocols using the configure option
\"--disable-protocols\", and selectively enable a protocol using the
option \"--enable-protocol=`PROTOCOL`{.variable}\", or you can disable a
particular protocol using the option
\"--disable-protocol=`PROTOCOL`{.variable}\".

The option \"-protocols\" of the ff\* tools will display the list of
supported protocols.

All protocols accept the following options:

`rw_timeout`{.sample}

:   Maximum time to wait for (network) read/write operations to
    complete, in microseconds.

A description of the currently available protocols follows.

[]{#amqp}

### [24.1 amqp](#toc-amqp) {#amqp .section}

Advanced Message Queueing Protocol (AMQP) version 0-9-1 is a broker
based publish-subscribe communication protocol.

FFmpeg must be compiled with --enable-librabbitmq to support AMQP. A
separate AMQP broker must also be run. An example open-source AMQP
broker is RabbitMQ.

After starting the broker, an FFmpeg client may stream data to the
broker using the command:

::: example
``` example
ffmpeg -re -i input -f mpegts amqp://[[user]:[password]@]hostname[:port][/vhost]
```
:::

Where hostname and port (default is 5672) is the address of the broker.
The client may also set a user/password for authentication. The default
for both fields is \"guest\". Name of virtual host on broker can be set
with vhost. The default value is \"/\".

Multiple subscribers may stream from the broker using the command:

::: example
``` example
ffplay amqp://[[user]:[password]@]hostname[:port][/vhost]
```
:::

In RabbitMQ all data published to the broker flows through a specific
exchange, and each subscribing client has an assigned queue/buffer. When
a packet arrives at an exchange, it may be copied to a client's queue
depending on the exchange and routing_key fields.

The following options are supported:

`exchange`{.sample}

:   Sets the exchange to use on the broker. RabbitMQ has several
    predefined exchanges: \"amq.direct\" is the default exchange, where
    the publisher and subscriber must have a matching routing_key;
    \"amq.fanout\" is the same as a broadcast operation (i.e. the data
    is forwarded to all queues on the fanout exchange independent of the
    routing_key); and \"amq.topic\" is similar to \"amq.direct\", but
    allows for more complex pattern matching (refer to the RabbitMQ
    documentation).

`routing_key`{.sample}

:   Sets the routing key. The default value is \"amqp\". The routing key
    is used on the \"amq.direct\" and \"amq.topic\" exchanges to decide
    whether packets are written to the queue of a subscriber.

`pkt_size`{.sample}

:   Maximum size of each packet sent/received to the broker. Default
    is 131072. Minimum is 4096 and max is any large value (representable
    by an int). When receiving packets, this sets an internal buffer
    size in FFmpeg. It should be equal to or greater than the size of
    the published packets to the broker. Otherwise the received message
    may be truncated causing decoding errors.

`connection_timeout`{.sample}

:   The timeout in seconds during the initial connection to the broker.
    The default value is rw_timeout, or 5 seconds if rw_timeout is not
    set.

`delivery_mode `{.sample}`mode`{.variable}

:   Sets the delivery mode of each message sent to broker. The following
    values are accepted:

    '`persistent`{.sample}'

    :   Delivery mode set to \"persistent\" (2). This is the default
        value. Messages may be written to the broker's disk depending on
        its setup.

    '`non-persistent`{.sample}'

    :   Delivery mode set to \"non-persistent\" (1). Messages will stay
        in broker's memory unless the broker is under memory pressure.

[]{#async}

### [24.2 async](#toc-async) {#async .section}

Asynchronous data filling wrapper for input stream.

Fill data in a background thread, to decouple I/O operation from demux
thread.

::: example
``` example
async:URL
async:http://host/resource
async:cache:http://host/resource
```
:::

[]{#bluray}

### [24.3 bluray](#toc-bluray) {#bluray .section}

Read BluRay playlist.

The accepted options are:

`angle`{.sample}

:   BluRay angle

`chapter`{.sample}

:   Start chapter (1\...N)

`playlist`{.sample}

:   Playlist to read (BDMV/PLAYLIST/?????.mpls)

Examples:

Read longest playlist from BluRay mounted to /mnt/bluray:

::: example
``` example
bluray:/mnt/bluray
```
:::

Read angle 2 of playlist 4 from BluRay mounted to /mnt/bluray, start
from chapter 2:

::: example
``` example
-playlist 4 -angle 2 -chapter 2 bluray:/mnt/bluray
```
:::

[]{#cache}

### [24.4 cache](#toc-cache) {#cache .section}

Caching wrapper for input stream.

Cache the input stream to temporary file. It brings seeking capability
to live streams.

The accepted options are:

`read_ahead_limit`{.sample}

:   Amount in bytes that may be read ahead when seeking isn't supported.
    Range is -1 to INT_MAX. -1 for unlimited. Default is 65536.

URL Syntax is

::: example
``` example
cache:URL
```
:::

[]{#concat-2}

### [24.5 concat](#toc-concat-2) {#concat-1 .section}

Physical concatenation protocol.

Read and seek from many resources in sequence as if they were a unique
resource.

A URL accepted by this protocol has the syntax:

::: example
``` example
concat:URL1|URL2|...|URLN
```
:::

where `URL1`{.variable}, `URL2`{.variable}, \..., `URLN`{.variable} are
the urls of the resource to be concatenated, each one possibly
specifying a distinct protocol.

For example to read a sequence of files `split1.mpeg`{.sample},
`split2.mpeg`{.sample}, `split3.mpeg`{.sample} with `ffplay` use the
command:

::: example
``` example
ffplay concat:split1.mpeg\|split2.mpeg\|split3.mpeg
```
:::

Note that you may need to escape the character \"\|\" which is special
for many shells.

[]{#concatf}

### [24.6 concatf](#toc-concatf) {#concatf .section}

Physical concatenation protocol using a line break delimited list of
resources.

Read and seek from many resources in sequence as if they were a unique
resource.

A URL accepted by this protocol has the syntax:

::: example
``` example
concatf:URL
```
:::

where `URL`{.variable} is the url containing a line break delimited list
of resources to be concatenated, each one possibly specifying a distinct
protocol. Special characters must be escaped with backslash or single
quotes. See [(ffmpeg-utils)the \"Quoting and escaping\" section in the
ffmpeg-utils(1) manual](ffmpeg-utils.html#quoting_005fand_005fescaping).

For example to read a sequence of files `split1.mpeg`{.sample},
`split2.mpeg`{.sample}, `split3.mpeg`{.sample} listed in separate lines
within a file `split.txt`{.sample} with `ffplay` use the command:

::: example
``` example
ffplay concatf:split.txt
```
:::

Where `split.txt`{.sample} contains the lines:

::: example
``` example
split1.mpeg
split2.mpeg
split3.mpeg
```
:::

[]{#crypto}

### [24.7 crypto](#toc-crypto) {#crypto .section}

AES-encrypted stream reading protocol.

The accepted options are:

`key`{.sample}

:   Set the AES decryption key binary block from given hexadecimal
    representation.

`iv`{.sample}

:   Set the AES decryption initialization vector binary block from given
    hexadecimal representation.

Accepted URL formats:

::: example
``` example
crypto:URL
crypto+URL
```
:::

[]{#data}

### [24.8 data](#toc-data) {#data .section}

Data in-line in the URI. See
<http://en.wikipedia.org/wiki/Data_URI_scheme>.

For example, to convert a GIF file given inline with `ffmpeg`:

::: example
``` example
ffmpeg -i "data:image/gif;base64,R0lGODdhCAAIAMIEAAAAAAAA//8AAP//AP///////////////ywAAAAACAAIAAADF0gEDLojDgdGiJdJqUX02iB4E8Q9jUMkADs=" smiley.png
```
:::

[]{#fd}

### [24.9 fd](#toc-fd) {#fd .section}

File descriptor access protocol.

The accepted syntax is:

::: example
``` example
fd: -fd file_descriptor
```
:::

If `fd`{.sample} is not specified, by default the stdout file descriptor
will be used for writing, stdin for reading. Unlike the pipe protocol,
fd protocol has seek support if it corresponding to a regular file. fd
protocol doesn't support pass file descriptor via URL for security.

This protocol accepts the following options:

`blocksize`{.sample}

:   Set I/O operation maximum block size, in bytes. Default value is
    `INT_MAX`, which results in not limiting the requested block size.
    Setting this value reasonably low improves user termination request
    reaction time, which is valuable if data transmission is slow.

`fd`{.sample}

:   Set file descriptor.

[]{#file}

### [24.10 file](#toc-file) {#file .section}

File access protocol.

Read from or write to a file.

A file URL can have the form:

::: example
``` example
file:filename
```
:::

where `filename`{.variable} is the path of the file to read.

An URL that does not have a protocol prefix will be assumed to be a file
URL. Depending on the build, an URL that looks like a Windows path with
the drive letter at the beginning will also be assumed to be a file URL
(usually not the case in builds for unix-like systems).

For example to read from a file `input.mpeg`{.sample} with `ffmpeg` use
the command:

::: example
``` example
ffmpeg -i file:input.mpeg output.mpeg
```
:::

This protocol accepts the following options:

`truncate`{.sample}

:   Truncate existing files on write, if set to 1. A value of 0 prevents
    truncating. Default value is 1.

`blocksize`{.sample}

:   Set I/O operation maximum block size, in bytes. Default value is
    `INT_MAX`, which results in not limiting the requested block size.
    Setting this value reasonably low improves user termination request
    reaction time, which is valuable for files on slow medium.

`follow`{.sample}

:   If set to 1, the protocol will retry reading at the end of the file,
    allowing reading files that still are being written. In order for
    this to terminate, you either need to use the rw_timeout option, or
    use the interrupt callback (for API users).

`seekable`{.sample}

:   Controls if seekability is advertised on the file. 0 means
    non-seekable, -1 means auto (seekable for normal files, non-seekable
    for named pipes).

    Many demuxers handle seekable and non-seekable resources
    differently, overriding this might speed up opening certain files at
    the cost of losing some features (e.g. accurate seeking).

`pkt_size`{.sample}

:   Set the maximum packet size used for file I/O. A smaller value may
    reduce memory usage. A higher value may increase throughput
    especially with networked filesystems.

    For reading, if explicitly set, it overrides the default internal
    buffer size (32 KB) and limits the maximum amount of data read per
    operation.

    For writing, this sets the size of each write operation. The default
    is 256 KB for regular files, 32 KB otherwise.

[]{#ftp}

### [24.11 ftp](#toc-ftp) {#ftp .section}

FTP (File Transfer Protocol).

Read from or write to remote resources using FTP protocol.

Following syntax is required.

::: example
``` example
ftp://[user[:password]@]server[:port]/path/to/remote/resource.mpeg
```
:::

This protocol accepts the following options.

`timeout`{.sample}

:   Set timeout in microseconds of socket I/O operations used by the
    underlying low level operation. By default it is set to -1, which
    means that the timeout is not specified.

`ftp-user`{.sample}

:   Set a user to be used for authenticating to the FTP server. This is
    overridden by the user in the FTP URL.

`ftp-password`{.sample}

:   Set a password to be used for authenticating to the FTP server. This
    is overridden by the password in the FTP URL, or by
    `ftp-anonymous-password`{.sample} if no user is set.

`ftp-anonymous-password`{.sample}

:   Password used when login as anonymous user. Typically an e-mail
    address should be used.

`ftp-write-seekable`{.sample}

:   Control seekability of connection during encoding. If set to 1 the
    resource is supposed to be seekable, if set to 0 it is assumed not
    to be seekable. Default value is 0.

NOTE: Protocol can be used as output, but it is recommended to not do
it, unless special care is taken (tests, customized server configuration
etc.). Different FTP servers behave in different way during seek
operation. ff\* tools may produce incomplete content due to server
limitations.

[]{#gopher}

### [24.12 gopher](#toc-gopher) {#gopher .section}

Gopher protocol.

[]{#gophers}

### [24.13 gophers](#toc-gophers) {#gophers .section}

Gophers protocol.

The Gopher protocol with TLS encapsulation.

[]{#hls-3}

### [24.14 hls](#toc-hls-3) {#hls-2 .section}

Read Apple HTTP Live Streaming compliant segmented stream as a uniform
one. The M3U8 playlists describing the segments can be remote HTTP
resources or local files, accessed using the standard file protocol. The
nested protocol is declared by specifying \"+`proto`{.variable}\" after
the hls URI scheme name, where `proto`{.variable} is either \"file\" or
\"http\".

::: example
``` example
hls+http://host/path/to/remote/resource.m3u8
hls+file://path/to/local/resource.m3u8
```
:::

Using this protocol is discouraged - the hls demuxer should work just as
well (if not, please report the issues) and is more complete. To use the
hls demuxer instead, simply use the direct URLs to the m3u8 files.

[]{#http}

### [24.15 http](#toc-http) {#http .section}

HTTP (Hyper Text Transfer Protocol).

This protocol accepts the following options:

`seekable`{.sample}

:   Control seekability of connection. If set to 1 the resource is
    supposed to be seekable, if set to 0 it is assumed not to be
    seekable, if set to -1 it will try to autodetect if it is seekable.
    Default value is -1.

`chunked_post`{.sample}

:   If set to 1 use chunked Transfer-Encoding for posts, default is 1.

`http_proxy`{.sample}

:   set HTTP proxy to tunnel through e.g. http://example.com:1234

`headers`{.sample}

:   Set custom HTTP headers, can override built in default headers. The
    value must be a string encoding the headers.

`content_type`{.sample}

:   Set a specific content type for the POST messages or for listen
    mode.

`user_agent`{.sample}

:   Override the User-Agent header. If not specified the protocol will
    use a string describing the libavformat build.
    (\"Lavf/\<version\>\")

`referer`{.sample}

:   Set the Referer header. Include 'Referer: URL' header in HTTP
    request.

`multiple_requests`{.sample}

:   Use persistent connections if set to 1, default is 0.

`post_data`{.sample}

:   Set custom HTTP post data.

`mime_type`{.sample}

:   Export the MIME type.

`http_version`{.sample}

:   Exports the HTTP response version number. Usually \"1.0\" or
    \"1.1\".

`cookies`{.sample}

:   Set the cookies to be sent in future requests. The format of each
    cookie is the same as the value of a Set-Cookie HTTP response field.
    Multiple cookies can be delimited by a newline character.

`icy`{.sample}

:   If set to 1 request ICY (SHOUTcast) metadata from the server. If the
    server supports this, the metadata has to be retrieved by the
    application by reading the `icy_metadata_headers`{.sample} and
    `icy_metadata_packet`{.sample} options. The default is 1.

`icy_metadata_headers`{.sample}

:   If the server supports ICY metadata, this contains the ICY-specific
    HTTP reply headers, separated by newline characters.

`icy_metadata_packet`{.sample}

:   If the server supports ICY metadata, and `icy`{.sample} was set to
    1, this contains the last non-empty metadata packet sent by the
    server. It should be polled in regular intervals by applications
    interested in mid-stream metadata updates.

`metadata`{.sample}

:   Set an exported dictionary containing Icecast metadata from the
    bitstream, if present. Only useful with the C API.

`auth_type`{.sample}

:   Set HTTP authentication type. No option for Digest, since this
    method requires getting nonce parameters from the server first and
    can't be used straight away like Basic.

    `none`{.sample}

    :   Choose the HTTP authentication type automatically. This is the
        default.

    `basic`{.sample}

    :   Choose the HTTP basic authentication.

        Basic authentication sends a Base64-encoded string that contains
        a user name and password for the client. Base64 is not a form of
        encryption and should be considered the same as sending the user
        name and password in clear text (Base64 is a reversible
        encoding). If a resource needs to be protected, strongly
        consider using an authentication scheme other than basic
        authentication. HTTPS/TLS should be used with basic
        authentication. Without these additional security enhancements,
        basic authentication should not be used to protect sensitive or
        valuable information.

`send_expect_100`{.sample}

:   Send an Expect: 100-continue header for POST. If set to 1 it will
    send, if set to 0 it won't, if set to -1 it will try to send if it
    is applicable. Default value is -1.

`location`{.sample}

:   An exported dictionary containing the content location. Only useful
    with the C API.

`offset`{.sample}

:   Set initial byte offset.

`end_offset`{.sample}

:   Try to limit the request to bytes preceding this offset.

`method`{.sample}

:   When used as a client option it sets the HTTP method for the
    request.

    When used as a server option it sets the HTTP method that is going
    to be expected from the client(s). If the expected and the received
    HTTP method do not match the client will be given a Bad Request
    response. When unset the HTTP method is not checked for now. This
    will be replaced by autodetection in the future.

`reconnect`{.sample}

:   Reconnect automatically when disconnected before EOF is hit.

`reconnect_at_eof`{.sample}

:   If set then eof is treated like an error and causes reconnection,
    this is useful for live / endless streams.

`reconnect_on_network_error`{.sample}

:   Reconnect automatically in case of TCP/TLS errors during connect.

`reconnect_on_http_error`{.sample}

:   A comma separated list of HTTP status codes to reconnect on. The
    list can include specific status codes (e.g. '503') or the strings
    '4xx' / '5xx'.

`reconnect_streamed`{.sample}

:   If set then even streamed/non seekable streams will be reconnected
    on errors.

`reconnect_delay_max`{.sample}

:   Set the maximum delay in seconds after which to give up
    reconnecting.

`reconnect_max_retries`{.sample}

:   Set the maximum number of times to retry a connection. Default
    unset.

`reconnect_delay_total_max`{.sample}

:   Set the maximum total delay in seconds after which to give up
    reconnecting.

`respect_retry_after`{.sample}

:   If enabled, and a Retry-After header is encountered, its requested
    reconnection delay will be honored, rather than using exponential
    backoff. Useful for 429 and 503 errors. Default enabled.

`listen`{.sample}

:   If set to 1 enables experimental HTTP server. This can be used to
    send data when used as an output option, or read data from a client
    with HTTP POST when used as an input option. If set to 2 enables
    experimental multi-client HTTP server. This is not yet implemented
    in ffmpeg.c and thus must not be used as a command line option.

    ::: example
    ``` example
    # Server side (sending):
    ffmpeg -i somefile.ogg -c copy -listen 1 -f ogg http://server:port

    # Client side (receiving):
    ffmpeg -i http://server:port -c copy somefile.ogg

    # Client can also be done with wget:
    wget http://server:port -O somefile.ogg

    # Server side (receiving):
    ffmpeg -listen 1 -i http://server:port -c copy somefile.ogg

    # Client side (sending):
    ffmpeg -i somefile.ogg -chunked_post 0 -c copy -f ogg http://server:port

    # Client can also be done with wget:
    wget --post-file=somefile.ogg http://server:port
    ```
    :::

`resource`{.sample}

:   The resource requested by a client, when the experimental HTTP
    server is in use.

`reply_code`{.sample}

:   The HTTP code returned to the client, when the experimental HTTP
    server is in use.

`short_seek_size`{.sample}

:   Set the threshold, in bytes, for when a readahead should be
    preferred over a seek and new HTTP request. This is useful, for
    example, to make sure the same connection is used for reading large
    video packets with small audio packets in between.

[]{#HTTP-Cookies}

#### [24.15.1 HTTP Cookies](#toc-HTTP-Cookies) {#http-cookies .subsection}

Some HTTP requests will be denied unless cookie values are passed in
with the request. The `cookies`{.sample} option allows these cookies to
be specified. At the very least, each cookie must specify a value along
with a path and domain. HTTP requests that match both the domain and
path will automatically include the cookie value in the HTTP Cookie
header field. Multiple cookies can be delimited by a newline.

The required syntax to play a stream specifying a cookie is:

::: example
``` example
ffplay -cookies "nlqptid=nltid=tsn; path=/; domain=somedomain.com;" http://somedomain.com/somestream.m3u8
```
:::

[]{#Icecast}

### [24.16 Icecast](#toc-Icecast) {#icecast .section}

Icecast protocol (stream to Icecast servers)

This protocol accepts the following options:

`ice_genre`{.sample}

:   Set the stream genre.

`ice_name`{.sample}

:   Set the stream name.

`ice_description`{.sample}

:   Set the stream description.

`ice_url`{.sample}

:   Set the stream website URL.

`ice_public`{.sample}

:   Set if the stream should be public. The default is 0 (not public).

`user_agent`{.sample}

:   Override the User-Agent header. If not specified a string of the
    form \"Lavf/\<version\>\" will be used.

`password`{.sample}

:   Set the Icecast mountpoint password.

`content_type`{.sample}

:   Set the stream content type. This must be set if it is different
    from audio/mpeg.

`legacy_icecast`{.sample}

:   This enables support for Icecast versions \< 2.4.0, that do not
    support the HTTP PUT method but the SOURCE method.

`tls`{.sample}

:   Establish a TLS (HTTPS) connection to Icecast.

::: example
``` example
icecast://[username[:password]@]server:port/mountpoint
```
:::

[]{#ipfs}

### [24.17 ipfs](#toc-ipfs) {#ipfs .section}

InterPlanetary File System (IPFS) protocol support. One can access files
stored on the IPFS network through so-called gateways. These are http(s)
endpoints. This protocol wraps the IPFS native protocols (ipfs:// and
ipns://) to be sent to such a gateway. Users can (and should) host their
own node which means this protocol will use one's local gateway to
access files on the IPFS network.

This protocol accepts the following options:

`gateway`{.sample}

:   Defines the gateway to use. When not set, the protocol will first
    try locating the local gateway by looking at `$IPFS_GATEWAY`,
    `$IPFS_PATH` and `$HOME/.ipfs/`, in that order.

One can use this protocol in 2 ways. Using IPFS:

::: example
``` example
ffplay ipfs://<hash>
```
:::

Or the IPNS protocol (IPNS is mutable IPFS):

::: example
``` example
ffplay ipns://<hash>
```
:::

[]{#mmst}

### [24.18 mmst](#toc-mmst) {#mmst .section}

MMS (Microsoft Media Server) protocol over TCP.

[]{#mmsh}

### [24.19 mmsh](#toc-mmsh) {#mmsh .section}

MMS (Microsoft Media Server) protocol over HTTP.

The required syntax is:

::: example
``` example
mmsh://server[:port][/app][/playpath]
```
:::

[]{#md5-2}

### [24.20 md5](#toc-md5-2) {#md5-1 .section}

MD5 output protocol.

Computes the MD5 hash of the data to be written, and on close writes
this to the designated output or stdout if none is specified. It can be
used to test muxers without writing an actual file.

Some examples follow.

::: example
``` example
# Write the MD5 hash of the encoded AVI file to the file output.avi.md5.
ffmpeg -i input.flv -f avi -y md5:output.avi.md5

# Write the MD5 hash of the encoded AVI file to stdout.
ffmpeg -i input.flv -f avi -y md5:
```
:::

Note that some formats (typically MOV) require the output protocol to be
seekable, so they will fail with the MD5 output protocol.

[]{#pipe}

### [24.21 pipe](#toc-pipe) {#pipe .section}

UNIX pipe access protocol.

Read and write from UNIX pipes.

The accepted syntax is:

::: example
``` example
pipe:[number]
```
:::

If `fd`{.sample} isn't specified, `number`{.variable} is the number
corresponding to the file descriptor of the pipe (e.g. 0 for stdin, 1
for stdout, 2 for stderr). If `number`{.variable} is not specified, by
default the stdout file descriptor will be used for writing, stdin for
reading.

For example to read from stdin with `ffmpeg`:

::: example
``` example
cat test.wav | ffmpeg -i pipe:0
# ...this is the same as...
cat test.wav | ffmpeg -i pipe:
```
:::

For writing to stdout with `ffmpeg`:

::: example
``` example
ffmpeg -i test.wav -f avi pipe:1 | cat > test.avi
# ...this is the same as...
ffmpeg -i test.wav -f avi pipe: | cat > test.avi
```
:::

This protocol accepts the following options:

`blocksize`{.sample}

:   Set I/O operation maximum block size, in bytes. Default value is
    `INT_MAX`, which results in not limiting the requested block size.
    Setting this value reasonably low improves user termination request
    reaction time, which is valuable if data transmission is slow.

`fd`{.sample}

:   Set file descriptor.

Note that some formats (typically MOV), require the output protocol to
be seekable, so they will fail with the pipe output protocol.

[]{#prompeg}

### [24.22 prompeg](#toc-prompeg) {#prompeg .section}

Pro-MPEG Code of Practice #3 Release 2 FEC protocol.

The Pro-MPEG CoP#3 FEC is a 2D parity-check forward error correction
mechanism for MPEG-2 Transport Streams sent over RTP.

This protocol must be used in conjunction with the `rtp_mpegts` muxer
and the `rtp` protocol.

The required syntax is:

::: example
``` example
-f rtp_mpegts -fec prompeg=option=val... rtp://hostname:port
```
:::

The destination UDP ports are `port + 2` for the column FEC stream and
`port + 4` for the row FEC stream.

This protocol accepts the following options:

`l=`{.sample}`n`{.variable}

:   The number of columns (4-20, LxD \<= 100)

`d=`{.sample}`n`{.variable}

:   The number of rows (4-20, LxD \<= 100)

Example usage:

::: example
``` example
-f rtp_mpegts -fec prompeg=l=8:d=4 rtp://hostname:port
```
:::

[]{#rist}

### [24.23 rist](#toc-rist) {#rist .section}

Reliable Internet Streaming Transport protocol

The accepted options are:

`rist_profile`{.sample}

Supported values:

'`simple`{.sample}'

'`main`{.sample}'

This one is default.

'`advanced`{.sample}'

`buffer_size`{.sample}

Set internal RIST buffer size in milliseconds for retransmission of
data. Default value is 0 which means the librist default (1 sec).
Maximum value is 30 seconds.

`fifo_size`{.sample}

Size of the librist receiver output fifo in number of packets. This must
be a power of 2. Defaults to 8192 (vs the librist default of 1024).

`overrun_nonfatal=`{.sample}`1|0`{.variable}

Survive in case of librist fifo buffer overrun. Default value is 0.

`pkt_size`{.sample}

Set maximum packet size for sending data. 1316 by default.

`log_level`{.sample}

Set loglevel for RIST logging messages. You only need to set this if you
explicitly want to enable debug level messages or packet loss
simulation, otherwise the regular loglevel is respected.

`secret`{.sample}

Set override of encryption secret, by default is unset.

`encryption`{.sample}

Set encryption type, by default is disabled. Acceptable values are 128
and 256.

[]{#rtmp}

### [24.24 rtmp](#toc-rtmp) {#rtmp .section}

Real-Time Messaging Protocol.

The Real-Time Messaging Protocol (RTMP) is used for streaming multimedia
content across a TCP/IP network.

The required syntax is:

::: example
``` example
rtmp://[username:password@]server[:port][/app][/instance][/playpath]
```
:::

The accepted parameters are:

`username`{.sample}

:   An optional username (mostly for publishing).

`password`{.sample}

:   An optional password (mostly for publishing).

`server`{.sample}

:   The address of the RTMP server.

`port`{.sample}

:   The number of the TCP port to use (by default is 1935).

`app`{.sample}

:   It is the name of the application to access. It usually corresponds
    to the path where the application is installed on the RTMP server
    (e.g. `/ondemand/`{.sample}, `/flash/live/`{.sample}, etc.). You can
    override the value parsed from the URI through the `rtmp_app`
    option, too.

`playpath`{.sample}

:   It is the path or name of the resource to play with reference to the
    application specified in `app`{.variable}, may be prefixed by
    \"mp4:\". You can override the value parsed from the URI through the
    `rtmp_playpath` option, too.

`listen`{.sample}

:   Act as a server, listening for an incoming connection.

`timeout`{.sample}

:   Maximum time to wait for the incoming connection. Implies listen.

Additionally, the following parameters can be set via command line
options (or in code via `AVOption`s):

`rtmp_app`{.sample}

:   Name of application to connect on the RTMP server. This option
    overrides the parameter specified in the URI.

`rtmp_buffer`{.sample}

:   Set the client buffer time in milliseconds. The default is 3000.

`rtmp_conn`{.sample}

:   Extra arbitrary AMF connection parameters, parsed from a string,
    e.g. like `B:1 S:authMe O:1 NN:code:1.23 NS:flag:ok O:0`. Each value
    is prefixed by a single character denoting the type, B for Boolean,
    N for number, S for string, O for object, or Z for null, followed by
    a colon. For Booleans the data must be either 0 or 1 for FALSE or
    TRUE, respectively. Likewise for Objects the data must be 0 or 1 to
    end or begin an object, respectively. Data items in subobjects may
    be named, by prefixing the type with 'N' and specifying the name
    before the value (i.e. `NB:myFlag:1`). This option may be used
    multiple times to construct arbitrary AMF sequences.

`rtmp_enhanced_codecs`{.sample}

:   Specify the list of codecs the client advertises to support in an
    enhanced RTMP stream. This option should be set to a comma separated
    list of fourcc values, like `hvc1,av01,vp09` for multiple codecs or
    `hvc1` for only one codec. The specified list will be presented in
    the \"fourCcLive\" property of the Connect Command Message.

`rtmp_flashver`{.sample}

:   Version of the Flash plugin used to run the SWF player. The default
    is LNX 9,0,124,2. (When publishing, the default is FMLE/3.0
    (compatible; \<libavformat version\>).)

`rtmp_flush_interval`{.sample}

:   Number of packets flushed in the same request (RTMPT only). The
    default is 10.

`rtmp_live`{.sample}

:   Specify that the media is a live stream. No resuming or seeking in
    live streams is possible. The default value is `any`, which means
    the subscriber first tries to play the live stream specified in the
    playpath. If a live stream of that name is not found, it plays the
    recorded stream. The other possible values are `live` and
    `recorded`.

`rtmp_pageurl`{.sample}

:   URL of the web page in which the media was embedded. By default no
    value will be sent.

`rtmp_playpath`{.sample}

:   Stream identifier to play or to publish. This option overrides the
    parameter specified in the URI.

`rtmp_subscribe`{.sample}

:   Name of live stream to subscribe to. By default no value will be
    sent. It is only sent if the option is specified or if rtmp_live is
    set to live.

`rtmp_swfhash`{.sample}

:   SHA256 hash of the decompressed SWF file (32 bytes).

`rtmp_swfsize`{.sample}

:   Size of the decompressed SWF file, required for SWFVerification.

`rtmp_swfurl`{.sample}

:   URL of the SWF player for the media. By default no value will be
    sent.

`rtmp_swfverify`{.sample}

:   URL to player swf file, compute hash/size automatically.

`rtmp_tcurl`{.sample}

:   URL of the target stream. Defaults to proto://host\[:port\]/app.

`tcp_nodelay=`{.sample}`1|0`{.variable}

:   Set TCP_NODELAY to disable Nagle's algorithm. Default value is 0.

    *Remark: Writing to the socket is currently not optimized to
    minimize system calls and reduces the efficiency / effect of
    TCP_NODELAY.*

`tcp_keepalive=`{.sample}`1|0`{.variable}

:   Enable the TCP keepalive mechanism to detect dead peers and help
    maintain long-lived idle connections. Default value is 0.

    Only the basic keepalive option (SO_KEEPALIVE) can be enabled or
    disabled. Platform-specific tuning parameters such as TCP_KEEPIDLE,
    TCP_KEEPINTVL, or TCP_KEEPCNT are not configurable and will use the
    operating system's default values.

For example to read with `ffplay` a multimedia resource named \"sample\"
from the application \"vod\" from an RTMP server \"myserver\":

::: example
``` example
ffplay rtmp://myserver/vod/sample
```
:::

To publish to a password protected server, passing the playpath and app
names separately:

::: example
``` example
ffmpeg -re -i <input> -f flv -rtmp_playpath some/long/path -rtmp_app long/app/name rtmp://username:password@myserver/
```
:::

[]{#rtmpe}

### [24.25 rtmpe](#toc-rtmpe) {#rtmpe .section}

Encrypted Real-Time Messaging Protocol.

The Encrypted Real-Time Messaging Protocol (RTMPE) is used for streaming
multimedia content within standard cryptographic primitives, consisting
of Diffie-Hellman key exchange and HMACSHA256, generating a pair of RC4
keys.

[]{#rtmps}

### [24.26 rtmps](#toc-rtmps) {#rtmps .section}

Real-Time Messaging Protocol over a secure SSL connection.

The Real-Time Messaging Protocol (RTMPS) is used for streaming
multimedia content across an encrypted connection.

[]{#rtmpt}

### [24.27 rtmpt](#toc-rtmpt) {#rtmpt .section}

Real-Time Messaging Protocol tunneled through HTTP.

The Real-Time Messaging Protocol tunneled through HTTP (RTMPT) is used
for streaming multimedia content within HTTP requests to traverse
firewalls.

[]{#rtmpte}

### [24.28 rtmpte](#toc-rtmpte) {#rtmpte .section}

Encrypted Real-Time Messaging Protocol tunneled through HTTP.

The Encrypted Real-Time Messaging Protocol tunneled through HTTP
(RTMPTE) is used for streaming multimedia content within HTTP requests
to traverse firewalls.

[]{#rtmpts}

### [24.29 rtmpts](#toc-rtmpts) {#rtmpts .section}

Real-Time Messaging Protocol tunneled through HTTPS.

The Real-Time Messaging Protocol tunneled through HTTPS (RTMPTS) is used
for streaming multimedia content within HTTPS requests to traverse
firewalls.

[]{#libsmbclient}

### [24.30 libsmbclient](#toc-libsmbclient) {#libsmbclient .section}

libsmbclient permits one to manipulate CIFS/SMB network resources.

Following syntax is required.

::: example
``` example
smb://[[domain:]user[:password@]]server[/share[/path[/file]]]
```
:::

This protocol accepts the following options.

`timeout`{.sample}

:   Set timeout in milliseconds of socket I/O operations used by the
    underlying low level operation. By default it is set to -1, which
    means that the timeout is not specified.

`truncate`{.sample}

:   Truncate existing files on write, if set to 1. A value of 0 prevents
    truncating. Default value is 1.

`workgroup`{.sample}

:   Set the workgroup used for making connections. By default workgroup
    is not specified.

For more information see: <http://www.samba.org/>.

[]{#libssh}

### [24.31 libssh](#toc-libssh) {#libssh .section}

Secure File Transfer Protocol via libssh

Read from or write to remote resources using SFTP protocol.

Following syntax is required.

::: example
``` example
sftp://[user[:password]@]server[:port]/path/to/remote/resource.mpeg
```
:::

This protocol accepts the following options.

`timeout`{.sample}

:   Set timeout of socket I/O operations used by the underlying low
    level operation. By default it is set to -1, which means that the
    timeout is not specified.

`truncate`{.sample}

:   Truncate existing files on write, if set to 1. A value of 0 prevents
    truncating. Default value is 1.

`private_key`{.sample}

:   Specify the path of the file containing private key to use during
    authorization. By default libssh searches for keys in the
    `~/.ssh/`{.sample} directory.

Example: Play a file stored on remote server.

::: example
``` example
ffplay sftp://user:password@server_address:22/home/user/resource.mpeg
```
:::

[]{#librtmp-rtmp_002c-rtmpe_002c-rtmps_002c-rtmpt_002c-rtmpte}

### [24.32 librtmp rtmp, rtmpe, rtmps, rtmpt, rtmpte](#toc-librtmp-rtmp_002c-rtmpe_002c-rtmps_002c-rtmpt_002c-rtmpte) {#librtmp-rtmp-rtmpe-rtmps-rtmpt-rtmpte .section}

Real-Time Messaging Protocol and its variants supported through librtmp.

Requires the presence of the librtmp headers and library during
configuration. You need to explicitly configure the build with
\"--enable-librtmp\". If enabled this will replace the native RTMP
protocol.

This protocol provides most client functions and a few server functions
needed to support RTMP, RTMP tunneled in HTTP (RTMPT), encrypted RTMP
(RTMPE), RTMP over SSL/TLS (RTMPS) and tunneled variants of these
encrypted types (RTMPTE, RTMPTS).

The required syntax is:

::: example
``` example
rtmp_proto://server[:port][/app][/playpath] options
```
:::

where `rtmp_proto`{.variable} is one of the strings \"rtmp\", \"rtmpt\",
\"rtmpe\", \"rtmps\", \"rtmpte\", \"rtmpts\" corresponding to each RTMP
variant, and `server`{.variable}, `port`{.variable}, `app`{.variable}
and `playpath`{.variable} have the same meaning as specified for the
RTMP native protocol. `options`{.variable} contains a list of
space-separated options of the form `key`{.variable}=`val`{.variable}.

See the librtmp manual page (man 3 librtmp) for more information.

For example, to stream a file in real-time to an RTMP server using
`ffmpeg`:

::: example
``` example
ffmpeg -re -i myfile -f flv rtmp://myserver/live/mystream
```
:::

To play the same stream using `ffplay`:

::: example
``` example
ffplay "rtmp://myserver/live/mystream live=1"
```
:::

[]{#rtp}

### [24.33 rtp](#toc-rtp) {#rtp .section}

Real-time Transport Protocol.

The required syntax for an RTP URL is:

::: example
``` example
rtp://hostname[:port][?options]
```
:::

`port`{.variable} specifies the RTP port to use.

`options`{.variable} contains a list of &-separated options of the form
`key`{.variable}=`val`{.variable}. Standard percent-encoding (and using
the plus sign for space) can be used to escape keys and values.

Options can also can be specified via command line options (or in code
via `AVOption`s).

The list of supported options follows.

`ttl=`{.sample}`n`{.variable}

:   Set the TTL (Time-To-Live) value (for multicast only).

`rtcpport=`{.sample}`n`{.variable}

:   Set the remote RTCP port to `n`{.variable}.

`localport, local_rtpport, localrtpport=`{.sample}`n`{.variable}

:   Set the local RTP port to `n`{.variable}.

    Using the localport option name is deprecated and should not be
    used.

`local_rtcpport, localrtcpport=`{.sample}`n`{.variable}`'`{.sample}

:   Set the local RTCP port to `n`{.variable}.

`pkt_size=`{.sample}`n`{.variable}

:   Set max packet size (in bytes) to `n`{.variable}.

`buffer_size=`{.sample}`size`{.variable}

:   Set the maximum UDP socket buffer size in bytes.

`connect=0|1`{.sample}

:   Do a `connect()` on the UDP socket (if set to 1) or not (if set to
    0).

`sources=`{.sample}`ip`{.variable}`[,`{.sample}`ip`{.variable}`]`{.sample}

:   List allowed source IP addresses.

`block=`{.sample}`ip`{.variable}`[,`{.sample}`ip`{.variable}`]`{.sample}

:   List disallowed (blocked) source IP addresses.

`write_to_source=0|1`{.sample}

:   Send packets to the source address of the latest received packet (if
    set to 1) or to a default remote address (if set to 0).

`localaddr=`{.sample}`addr`{.variable}

:   Local IP address of a network interface used for sending packets or
    joining multicast groups.

`timeout=`{.sample}`n`{.variable}

:   Set timeout (in microseconds) of socket I/O operations to
    `n`{.variable}.

Important notes:

1.  If `rtcpport`{.sample} is not set the RTCP port will be set to the
    RTP port value plus 1.
2.  If `localrtpport`{.sample} (the local RTP port) is not set any
    available port will be used for the local RTP and RTCP ports.
3.  If `localrtcpport`{.sample} (the local RTCP port) is not set it will
    be set to the local RTP port value plus 1.

[]{#rtsp}

### [24.34 rtsp](#toc-rtsp) {#rtsp .section}

Real-Time Streaming Protocol.

RTSP is not technically a protocol handler in libavformat, it is a
demuxer and muxer. The demuxer supports both normal RTSP (with data
transferred over RTP; this is used by e.g. Apple and Microsoft) and
Real-RTSP (with data transferred over RDT).

The muxer can be used to send a stream using RTSP ANNOUNCE to a server
supporting it (currently Darwin Streaming Server and Mischa
Spiegelmock's [RTSP server](https://github.com/revmischa/rtsp-server)).

The required syntax for a RTSP url is:

::: example
``` example
rtsp://hostname[:port]/path
```
:::

Options can be set on the `ffmpeg`/`ffplay` command line, or set in code
via `AVOption`s or in `avformat_open_input`.

[]{#Muxer}

#### [24.34.1 Muxer](#toc-Muxer) {#muxer .subsection}

The following options are supported.

`rtsp_transport`{.sample}

:   Set RTSP transport protocols.

    It accepts the following values:

    '`udp`{.sample}'

    :   Use UDP as lower transport protocol.

    '`tcp`{.sample}'

    :   Use TCP (interleaving within the RTSP control channel) as lower
        transport protocol.

    Default value is '`0`{.sample}'.

`rtsp_flags`{.sample}

:   Set RTSP flags.

    The following values are accepted:

    '`latm`{.sample}'

    :   Use MP4A-LATM packetization instead of MPEG4-GENERIC for AAC.

    '`rfc2190`{.sample}'

    :   Use RFC 2190 packetization instead of RFC 4629 for H.263.

    '`skip_rtcp`{.sample}'

    :   Don't send RTCP sender reports.

    '`h264_mode0`{.sample}'

    :   Use mode 0 for H.264 in RTP.

    '`send_bye`{.sample}'

    :   Send RTCP BYE packets when finishing.

    Default value is '`0`{.sample}'.

`min_port`{.sample}

:   Set minimum local UDP port. Default value is 5000.

`max_port`{.sample}

:   Set maximum local UDP port. Default value is 65000.

`buffer_size`{.sample}

:   Set the maximum socket buffer size in bytes.

`pkt_size`{.sample}

:   Set max send packet size (in bytes). Default value is 1472.

[]{#Demuxer}

#### [24.34.2 Demuxer](#toc-Demuxer) {#demuxer .subsection}

The following options are supported.

`initial_pause`{.sample}

Do not start playing the stream immediately if set to 1. Default value
is 0.

`rtsp_transport`{.sample}

Set RTSP transport protocols.

It accepts the following values:

'`udp`{.sample}'

:   Use UDP as lower transport protocol.

'`tcp`{.sample}'

:   Use TCP (interleaving within the RTSP control channel) as lower
    transport protocol.

'`udp_multicast`{.sample}'

:   Use UDP multicast as lower transport protocol.

'`http`{.sample}'

:   Use HTTP tunneling as lower transport protocol, which is useful for
    passing proxies.

'`https`{.sample}'

:   Use HTTPs tunneling as lower transport protocol, which is useful for
    passing proxies and widely used for security consideration.

Multiple lower transport protocols may be specified, in that case they
are tried one at a time (if the setup of one fails, the next one is
tried). For the muxer, only the '`tcp`{.sample}' and '`udp`{.sample}'
options are supported.

`rtsp_flags`{.sample}

Set RTSP flags.

The following values are accepted:

'`filter_src`{.sample}'

:   Accept packets only from negotiated peer address and port.

'`listen`{.sample}'

:   Act as a server, listening for an incoming connection.

'`prefer_tcp`{.sample}'

:   Try TCP for RTP transport first, if TCP is available as RTSP RTP
    transport.

'`satip_raw`{.sample}'

:   Export raw MPEG-TS stream instead of demuxing. The flag will simply
    write out the raw stream, with the original PAT/PMT/PIDs intact.

Default value is '`none`{.sample}'.

`allowed_media_types`{.sample}

Set media types to accept from the server.

The following flags are accepted:

'`video`{.sample}'

'`audio`{.sample}'

'`data`{.sample}'

'`subtitle`{.sample}'

By default it accepts all media types.

`min_port`{.sample}

Set minimum local UDP port. Default value is 5000.

`max_port`{.sample}

Set maximum local UDP port. Default value is 65000.

`listen_timeout`{.sample}

Set maximum timeout (in seconds) to establish an initial connection.
Setting `listen_timeout`{.sample} \> 0 sets `rtsp_flags`{.sample} to
'`listen`{.sample}'. Default is -1 which means an infinite timeout when
'`listen`{.sample}' mode is set.

`reorder_queue_size`{.sample}

Set number of packets to buffer for handling of reordered packets.

`timeout`{.sample}

Set socket TCP I/O timeout in microseconds.

`user_agent`{.sample}

Override User-Agent header. If not specified, it defaults to the
libavformat identifier string.

`buffer_size`{.sample}

Set the maximum socket buffer size in bytes.

When receiving data over UDP, the demuxer tries to reorder received
packets (since they may arrive out of order, or packets may get lost
totally). This can be disabled by setting the maximum demuxing delay to
zero (via the `max_delay` field of AVFormatContext).

When watching multi-bitrate Real-RTSP streams with `ffplay`, the streams
to display can be chosen with `-vst` `n`{.variable} and `-ast`
`n`{.variable} for video and audio respectively, and can be switched on
the fly by pressing `v` and `a`.

[]{#Examples-28}

#### [24.34.3 Examples](#toc-Examples-28) {#examples-28 .subsection}

The following examples all make use of the `ffplay` and `ffmpeg` tools.

- Watch a stream over UDP, with a max reordering delay of 0.5 seconds:

  ::: example
  ``` example
  ffplay -max_delay 500000 -rtsp_transport udp rtsp://server/video.mp4
  ```
  :::
- Watch a stream tunneled over HTTP:

  ::: example
  ``` example
  ffplay -rtsp_transport http rtsp://server/video.mp4
  ```
  :::
- Send a stream in realtime to a RTSP server, for others to watch:

  ::: example
  ``` example
  ffmpeg -re -i input -f rtsp -muxdelay 0.1 rtsp://server/live.sdp
  ```
  :::
- Receive a stream in realtime:

  ::: example
  ``` example
  ffmpeg -rtsp_flags listen -i rtsp://ownaddress/live.sdp output
  ```
  :::

[]{#sap}

### [24.35 sap](#toc-sap) {#sap .section}

Session Announcement Protocol (RFC 2974). This is not technically a
protocol handler in libavformat, it is a muxer and demuxer. It is used
for signalling of RTP streams, by announcing the SDP for the streams
regularly on a separate port.

[]{#Muxer-1}

#### [24.35.1 Muxer](#toc-Muxer-1) {#muxer-1 .subsection}

The syntax for a SAP url given to the muxer is:

::: example
``` example
sap://destination[:port][?options]
```
:::

The RTP packets are sent to `destination`{.variable} on port
`port`{.variable}, or to port 5004 if no port is specified.
`options`{.variable} is a `&`-separated list. The following options are
supported:

`announce_addr=`{.sample}`address`{.variable}

:   Specify the destination IP address for sending the announcements to.
    If omitted, the announcements are sent to the commonly used SAP
    announcement multicast address 224.2.127.254 (sap.mcast.net), or
    ff0e::2:7ffe if `destination`{.variable} is an IPv6 address.

`announce_port=`{.sample}`port`{.variable}

:   Specify the port to send the announcements on, defaults to 9875 if
    not specified.

`ttl=`{.sample}`ttl`{.variable}

:   Specify the time to live value for the announcements and RTP
    packets, defaults to 255.

`same_port=`{.sample}`0|1`{.variable}

:   If set to 1, send all RTP streams on the same port pair. If zero
    (the default), all streams are sent on unique ports, with each
    stream on a port 2 numbers higher than the previous. VLC/Live555
    requires this to be set to 1, to be able to receive the stream. The
    RTP stack in libavformat for receiving requires all streams to be
    sent on unique ports.

Example command lines follow.

To broadcast a stream on the local subnet, for watching in VLC:

::: example
``` example
ffmpeg -re -i input -f sap sap://224.0.0.255?same_port=1
```
:::

Similarly, for watching in `ffplay`:

::: example
``` example
ffmpeg -re -i input -f sap sap://224.0.0.255
```
:::

And for watching in `ffplay`, over IPv6:

::: example
``` example
ffmpeg -re -i input -f sap sap://[ff0e::1:2:3:4]
```
:::

[]{#Demuxer-1}

#### [24.35.2 Demuxer](#toc-Demuxer-1) {#demuxer-1 .subsection}

The syntax for a SAP url given to the demuxer is:

::: example
``` example
sap://[address][:port]
```
:::

`address`{.variable} is the multicast address to listen for
announcements on, if omitted, the default 224.2.127.254 (sap.mcast.net)
is used. `port`{.variable} is the port that is listened on, 9875 if
omitted.

The demuxers listens for announcements on the given address and port.
Once an announcement is received, it tries to receive that particular
stream.

Example command lines follow.

To play back the first stream announced on the normal SAP multicast
address:

::: example
``` example
ffplay sap://
```
:::

To play back the first stream announced on one the default IPv6 SAP
multicast address:

::: example
``` example
ffplay sap://[ff0e::2:7ffe]
```
:::

[]{#sctp}

### [24.36 sctp](#toc-sctp) {#sctp .section}

Stream Control Transmission Protocol.

The accepted URL syntax is:

::: example
``` example
sctp://host:port[?options]
```
:::

`options`{.variable} contains a list of &-separated options of the form
`key`{.variable}=`val`{.variable}. Standard percent-encoding (and using
the plus sign for space) can be used to escape keys and values.

Options can also can be specified via command line options (or in code
via `AVOption`s).

The list of supported options follows.

`listen`{.sample}

:   If set to any value, listen for an incoming connection. Outgoing
    connection is done by default.

`max_streams`{.sample}

:   Set the maximum number of streams. By default no limit is set.

[]{#srt}

### [24.37 srt](#toc-srt) {#srt .section}

Haivision Secure Reliable Transport Protocol via libsrt.

The supported syntax for a SRT URL is:

::: example
``` example
srt://hostname:port[?options]
```
:::

`options`{.variable} contains a list of &-separated options of the form
`key`{.variable}=`val`{.variable}. Standard percent-encoding (and using
the plus sign for space) can be used to escape keys and values.

Options can also can be specified via command line options (or in code
via `AVOption`s).

The list of supported options follows.

`connect_timeout=`{.sample}`milliseconds`{.variable}

:   Connection timeout; SRT cannot connect for RTT \> 1500 msec (2
    handshake exchanges) with the default connect timeout of 3 seconds.
    This option applies to the caller and rendezvous connection modes.
    The connect timeout is 10 times the value set for the rendezvous
    mode (which can be used as a workaround for this connection problem
    with earlier versions).

`ffs=`{.sample}`bytes`{.variable}

:   Flight Flag Size (Window Size), in bytes. FFS is actually an
    internal parameter and you should set it to not less than
    `recv_buffer_size`{.sample} and `mss`{.sample}. The default value is
    relatively large, therefore unless you set a very large receiver
    buffer, you do not need to change this option. Default value is
    25600.

`inputbw=`{.sample}`bytes/seconds`{.variable}

:   Sender nominal input rate, in bytes per seconds. Used along with
    `oheadbw`{.sample}, when `maxbw`{.sample} is set to relative (0), to
    calculate maximum sending rate when recovery packets are sent along
    with the main media stream: `inputbw`{.sample} \* (100 +
    `oheadbw`{.sample}) / 100 if `inputbw`{.sample} is not set while
    `maxbw`{.sample} is set to relative (0), the actual input rate is
    evaluated inside the library. Default value is 0.

`iptos=`{.sample}`tos`{.variable}

:   IP Type of Service. Applies to sender only. Default value is 0xB8.

`ipttl=`{.sample}`ttl`{.variable}

:   IP Time To Live. Applies to sender only. Default value is 64.

`latency=`{.sample}`microseconds`{.variable}

:   Timestamp-based Packet Delivery Delay. Used to absorb bursts of
    missed packet retransmissions. This flag sets both
    `rcvlatency`{.sample} and `peerlatency`{.sample} to the same value.
    Note that prior to version 1.3.0 this is the only flag to set the
    latency, however this is effectively equivalent to setting
    `peerlatency`{.sample}, when side is sender and
    `rcvlatency`{.sample} when side is receiver, and the bidirectional
    stream sending is not supported.

`listen_timeout=`{.sample}`microseconds`{.variable}

:   Set socket listen timeout.

`maxbw=`{.sample}`bytes/seconds`{.variable}

:   Maximum sending bandwidth, in bytes per seconds. -1 infinite (CSRTCC
    limit is 30mbps) 0 relative to input rate (see `inputbw`{.sample})
    \>0 absolute limit value Default value is 0 (relative)

`mode=`{.sample}`caller|listener|rendezvous`{.variable}

:   Connection mode. `caller`{.sample} opens client connection.
    `listener`{.sample} starts server to listen for incoming
    connections. `rendezvous`{.sample} use Rendez-Vous connection mode.
    Default value is caller.

`mss=`{.sample}`bytes`{.variable}

:   Maximum Segment Size, in bytes. Used for buffer allocation and rate
    calculation using a packet counter assuming fully filled packets.
    The smallest MSS between the peers is used. This is 1500 by default
    in the overall internet. This is the maximum size of the UDP packet
    and can be only decreased, unless you have some unusual dedicated
    network settings. Default value is 1500.

`nakreport=`{.sample}`1|0`{.variable}

:   If set to 1, Receiver will send 'UMSG_LOSSREPORT' messages
    periodically until a lost packet is retransmitted or intentionally
    dropped. Default value is 1.

`oheadbw=`{.sample}`percents`{.variable}

:   Recovery bandwidth overhead above input rate, in percents. See
    `inputbw`{.sample}. Default value is 25%.

`passphrase=`{.sample}`string`{.variable}

:   HaiCrypt Encryption/Decryption Passphrase string, length from 10 to
    79 characters. The passphrase is the shared secret between the
    sender and the receiver. It is used to generate the Key Encrypting
    Key using PBKDF2 (Password-Based Key Derivation Function). It is
    used only if `pbkeylen`{.sample} is non-zero. It is used on the
    receiver only if the received data is encrypted. The configured
    passphrase cannot be recovered (write-only).

`enforced_encryption=`{.sample}`1|0`{.variable}

:   If true, both connection parties must have the same password set
    (including empty, that is, with no encryption). If the password
    doesn't match or only one side is unencrypted, the connection is
    rejected. Default is true.

`kmrefreshrate=`{.sample}`packets`{.variable}

:   The number of packets to be transmitted after which the encryption
    key is switched to a new key. Default is -1. -1 means auto
    (0x1000000 in srt library). The range for this option is integers in
    the 0 - `INT_MAX`.

`kmpreannounce=`{.sample}`packets`{.variable}

:   The interval between when a new encryption key is sent and when
    switchover occurs. This value also applies to the subsequent
    interval between when switchover occurs and when the old encryption
    key is decommissioned. Default is -1. -1 means auto (0x1000 in srt
    library). The range for this option is integers in the 0 -
    `INT_MAX`.

`snddropdelay=`{.sample}`microseconds`{.variable}

:   The sender's extra delay before dropping packets. This delay is
    added to the default drop delay time interval value.

    Special value -1: Do not drop packets on the sender at all.

`payload_size=`{.sample}`bytes`{.variable}

:   Sets the maximum declared size of a packet transferred during the
    single call to the sending function in Live mode. Use 0 if this
    value isn't used (which is default in file mode). Default is -1
    (automatic), which typically means MPEG-TS; if you are going to use
    SRT to send any different kind of payload, such as, for example,
    wrapping a live stream in very small frames, then you can use a
    bigger maximum frame size, though not greater than 1456 bytes.

`pkt_size=`{.sample}`bytes`{.variable}

:   Alias for '`payload_size`{.sample}'.

`peerlatency=`{.sample}`microseconds`{.variable}

:   The latency value (as described in `rcvlatency`{.sample}) that is
    set by the sender side as a minimum value for the receiver.

`pbkeylen=`{.sample}`bytes`{.variable}

:   Sender encryption key length, in bytes. Only can be set to 0, 16, 24
    and 32. Enable sender encryption if not 0. Not required on receiver
    (set to 0), key size obtained from sender in HaiCrypt handshake.
    Default value is 0.

`rcvlatency=`{.sample}`microseconds`{.variable}

:   The time that should elapse since the moment when the packet was
    sent and the moment when it's delivered to the receiver application
    in the receiving function. This time should be a buffer time large
    enough to cover the time spent for sending, unexpectedly extended
    RTT time, and the time needed to retransmit the lost UDP packet. The
    effective latency value will be the maximum of this options' value
    and the value of `peerlatency`{.sample} set by the peer side. Before
    version 1.3.0 this option is only available as `latency`{.sample}.

`recv_buffer_size=`{.sample}`bytes`{.variable}

:   Set UDP receive buffer size, expressed in bytes.

`send_buffer_size=`{.sample}`bytes`{.variable}

:   Set UDP send buffer size, expressed in bytes.

`timeout=`{.sample}`microseconds`{.variable}

:   Set raise error timeouts for read, write and connect operations.
    Note that the SRT library has internal timeouts which can be
    controlled separately, the value set here is only a cap on those.

`tlpktdrop=`{.sample}`1|0`{.variable}

:   Too-late Packet Drop. When enabled on receiver, it skips missing
    packets that have not been delivered in time and delivers the
    following packets to the application when their time-to-play has
    come. It also sends a fake ACK to the sender. When enabled on sender
    and enabled on the receiving peer, the sender drops the older
    packets that have no chance of being delivered in time. It was
    automatically enabled in the sender if the receiver supports it.

`sndbuf=`{.sample}`bytes`{.variable}

:   Set send buffer size, expressed in bytes.

`rcvbuf=`{.sample}`bytes`{.variable}

:   Set receive buffer size, expressed in bytes.

    Receive buffer must not be greater than `ffs`{.sample}.

`lossmaxttl=`{.sample}`packets`{.variable}

:   The value up to which the Reorder Tolerance may grow. When Reorder
    Tolerance is \> 0, then packet loss report is delayed until that
    number of packets come in. Reorder Tolerance increases every time a
    \"belated\" packet has come, but it wasn't due to retransmission
    (that is, when UDP packets tend to come out of order), with the
    difference between the latest sequence and this packet's sequence,
    and not more than the value of this option. By default it's 0, which
    means that this mechanism is turned off, and the loss report is
    always sent immediately upon experiencing a \"gap\" in sequences.

`minversion`{.sample}

:   The minimum SRT version that is required from the peer. A connection
    to a peer that does not satisfy the minimum version requirement will
    be rejected.

    The version format in hex is 0xXXYYZZ for x.y.z in human readable
    form.

`streamid=`{.sample}`string`{.variable}

:   A string limited to 512 characters that can be set on the socket
    prior to connecting. This stream ID will be able to be retrieved by
    the listener side from the socket that is returned from srt_accept
    and was connected by a socket with that set stream ID. SRT does not
    enforce any special interpretation of the contents of this string.
    This option doesn't make sense in Rendezvous connection; the result
    might be that simply one side will override the value from the other
    side and it's the matter of luck which one would win

`srt_streamid=`{.sample}`string`{.variable}

:   Alias for '`streamid`{.sample}' to avoid conflict with ffmpeg
    command line option.

`smoother=`{.sample}`live|file`{.variable}

:   The type of Smoother used for the transmission for that socket,
    which is responsible for the transmission and congestion control.
    The Smoother type must be exactly the same on both connecting
    parties, otherwise the connection is rejected.

`messageapi=`{.sample}`1|0`{.variable}

:   When set, this socket uses the Message API, otherwise it uses Buffer
    API. Note that in live mode (see `transtype`{.sample}) there's only
    message API available. In File mode you can chose to use one of two
    modes:

    Stream API (default, when this option is false). In this mode you
    may send as many data as you wish with one sending instruction, or
    even use dedicated functions that read directly from a file. The
    internal facility will take care of any speed and congestion
    control. When receiving, you can also receive as many data as
    desired, the data not extracted will be waiting for the next call.
    There is no boundary between data portions in the Stream mode.

    Message API. In this mode your single sending instruction passes
    exactly one piece of data that has boundaries (a message). Contrary
    to Live mode, this message may span across multiple UDP packets and
    the only size limitation is that it shall fit as a whole in the
    sending buffer. The receiver shall use as large buffer as necessary
    to receive the message, otherwise the message will not be given up.
    When the message is not complete (not all packets received or there
    was a packet loss) it will not be given up.

`transtype=`{.sample}`live|file`{.variable}

:   Sets the transmission type for the socket, in particular, setting
    this option sets multiple other parameters to their default values
    as required for a particular transmission type.

    live: Set options as for live transmission. In this mode, you should
    send by one sending instruction only so many data that fit in one
    UDP packet, and limited to the value defined first in
    `payload_size`{.sample} (1316 is default in this mode). There is no
    speed control in this mode, only the bandwidth control, if
    configured, in order to not exceed the bandwidth with the overhead
    transmission (retransmitted and control packets).

    file: Set options as for non-live transmission. See
    `messageapi`{.sample} for further explanations

`linger=`{.sample}`seconds`{.variable}

:   The number of seconds that the socket waits for unsent data when
    closing. Default is -1. -1 means auto (off with 0 seconds in live
    mode, on with 180 seconds in file mode). The range for this option
    is integers in the 0 - `INT_MAX`.

`tsbpd=`{.sample}`1|0`{.variable}

:   When true, use Timestamp-based Packet Delivery mode. The default
    behavior depends on the transmission type: enabled in live mode,
    disabled in file mode.

For more information see: <https://github.com/Haivision/srt>.

[]{#srtp}

### [24.38 srtp](#toc-srtp) {#srtp .section}

Secure Real-time Transport Protocol.

The accepted options are:

`srtp_in_suite`{.sample}

`srtp_out_suite`{.sample}

Select input and output encoding suites.

Supported values:

'`AES_CM_128_HMAC_SHA1_80`{.sample}'

'`SRTP_AES128_CM_HMAC_SHA1_80`{.sample}'

'`AES_CM_128_HMAC_SHA1_32`{.sample}'

'`SRTP_AES128_CM_HMAC_SHA1_32`{.sample}'

`srtp_in_params`{.sample}

`srtp_out_params`{.sample}

Set input and output encoding parameters, which are expressed by a
base64-encoded representation of a binary block. The first 16 bytes of
this binary block are used as master key, the following 14 bytes are
used as master salt.

[]{#subfile}

### [24.39 subfile](#toc-subfile) {#subfile .section}

Virtually extract a segment of a file or another stream. The underlying
stream must be seekable.

Accepted options:

`start`{.sample}

:   Start offset of the extracted segment, in bytes.

`end`{.sample}

:   End offset of the extracted segment, in bytes. If set to 0, extract
    till end of file.

Examples:

Extract a chapter from a DVD VOB file (start and end sectors obtained
externally and multiplied by 2048):

::: example
``` example
subfile,,start,153391104,end,268142592,,:/media/dvd/VIDEO_TS/VTS_08_1.VOB
```
:::

Play an AVI file directly from a TAR archive:

::: example
``` example
subfile,,start,183241728,end,366490624,,:archive.tar
```
:::

Play a MPEG-TS file from start offset till end:

::: example
``` example
subfile,,start,32815239,end,0,,:video.ts
```
:::

[]{#tee-2}

### [24.40 tee](#toc-tee-2) {#tee-1 .section}

Writes the output to multiple protocols. The individual outputs are
separated by \|

::: example
``` example
tee:file://path/to/local/this.avi|file://path/to/local/that.avi
```
:::

[]{#tcp}

### [24.41 tcp](#toc-tcp) {#tcp .section}

Transmission Control Protocol.

The required syntax for a TCP url is:

::: example
``` example
tcp://hostname:port[?options]
```
:::

`options`{.variable} contains a list of &-separated options of the form
`key`{.variable}=`val`{.variable}. Standard percent-encoding (and using
the plus sign for space) can be used to escape keys and values.

Options can also can be specified via command line options (or in code
via `AVOption`s).

The list of supported options follows.

`listen=`{.sample}`2|1|0`{.variable}

:   Listen for an incoming connection. 0 disables listen, 1 enables
    listen in single client mode, 2 enables listen in multi-client mode.
    Default value is 0.

`local_addr=`{.sample}`addr`{.variable}

:   Local IP address of a network interface used for tcp socket connect.

`local_port=`{.sample}`port`{.variable}

:   Local port used for tcp socket connect.

`timeout=`{.sample}`microseconds`{.variable}

:   Set raise error timeout, expressed in microseconds.

    This option is only relevant in read mode: if no data arrived in
    more than this time interval, raise error.

`listen_timeout=`{.sample}`milliseconds`{.variable}

:   Set listen timeout, expressed in milliseconds.

`recv_buffer_size=`{.sample}`bytes`{.variable}

:   Set receive buffer size, expressed bytes.

`send_buffer_size=`{.sample}`bytes`{.variable}

:   Set send buffer size, expressed bytes.

`tcp_nodelay=`{.sample}`1|0`{.variable}

:   Set TCP_NODELAY to disable Nagle's algorithm. Default value is 0.

    *Remark: Writing to the socket is currently not optimized to
    minimize system calls and reduces the efficiency / effect of
    TCP_NODELAY.*

`tcp_mss=`{.sample}`bytes`{.variable}

:   Set maximum segment size for outgoing TCP packets, expressed in
    bytes.

The following example shows how to setup a listening TCP connection with
`ffmpeg`, which is then accessed with `ffplay`:

::: example
``` example
ffmpeg -i input -f format tcp://hostname:port?listen
ffplay tcp://hostname:port
```
:::

[]{#tls}

### [24.42 tls](#toc-tls) {#tls .section}

Transport Layer Security (TLS) / Secure Sockets Layer (SSL)

The required syntax for a TLS/SSL url is:

::: example
``` example
tls://hostname:port[?options]
```
:::

`options`{.variable} contains a list of &-separated options of the form
`key`{.variable}=`val`{.variable}. Standard percent-encoding (and using
the plus sign for space) can be used to escape keys and values.

Options can also can be specified via command line options (or in code
via `AVOption`s).

The list of supported options follows.

`ca_file, cafile=`{.sample}`filename`{.variable}

:   A file containing certificate authority (CA) root certificates to
    treat as trusted. If the linked TLS library contains a default this
    might not need to be specified for verification to work, but not all
    libraries and setups have defaults built in. The file must be in
    OpenSSL PEM format.

`tls_verify, verify=`{.sample}`1|0`{.variable}

:   If enabled, try to verify the peer that we are communicating with.
    Note, if using OpenSSL, this currently only makes sure that the peer
    certificate is signed by one of the root certificates in the CA
    database, but it does not validate that the certificate actually
    matches the host name we are trying to connect to. (With other
    backends, the host name is validated as well.)

    This is disabled by default since it requires a CA database to be
    provided by the caller in many cases.

`cert_file, cert=`{.sample}`filename`{.variable}

:   A file containing a certificate to use in the handshake with the
    peer. (When operating as server, in listen mode, this is more often
    required by the peer, while client certificates only are mandated in
    certain setups.)

`key_file, key=`{.sample}`filename`{.variable}

:   A file containing the private key for the certificate.

`listen=`{.sample}`1|0`{.variable}

:   If enabled, listen for connections on the provided port, and assume
    the server role in the handshake instead of the client role.

`http_proxy`{.sample}

:   The HTTP proxy to tunnel through, e.g. `http://example.com:1234`.
    The proxy must support the CONNECT method.

Example command lines:

To create a TLS/SSL server that serves an input stream.

::: example
``` example
ffmpeg -i input -f format tls://hostname:port?listen&cert=server.crt&key=server.key
```
:::

To play back a stream from the TLS/SSL server using `ffplay`:

::: example
``` example
ffplay tls://hostname:port
```
:::

[]{#dtls}

### [24.43 dtls](#toc-dtls) {#dtls .section}

Datagram Transport Layer Security (DTLS)

The required syntax for a DTLS URL is:

::: example
``` example
dtls://hostname:port[?options]
```
:::

`options`{.variable} contains a list of &-separated options of the form
`key`{.variable}=`val`{.variable}. Standard percent-encoding (and using
the plus sign for space) can be used to escape keys and values.

Options can also can be specified via command line options (or in code
via `AVOption`s).

DTLS shares most options with TLS, but operates over UDP instead of TCP.

The list of supported options follows.

`ca_file, cafile=`{.sample}`filename`{.variable}

:   A file containing certificate authority (CA) root certificates to
    treat as trusted. If the linked TLS library contains a default this
    might not need to be specified for verification to work, but not all
    libraries and setups have defaults built in. The file must be in
    OpenSSL PEM format.

`tls_verify, verify=`{.sample}`1|0`{.variable}

:   If enabled, try to verify the peer that we are communicating with.
    Note, if using OpenSSL, this currently only makes sure that the peer
    certificate is signed by one of the root certificates in the CA
    database, but it does not validate that the certificate actually
    matches the host name we are trying to connect to.

    This is disabled by default since it requires a CA database to be
    provided by the caller in many cases.

`cert_file, cert=`{.sample}`filename`{.variable}

:   A file containing a certificate to use in the handshake with the
    peer. (When operating as server, in listen mode, this is more often
    required by the peer, while client certificates only are mandated in
    certain setups.)

`key_file, key=`{.sample}`filename`{.variable}

:   A file containing the private key for the certificate.

`cert_pem=`{.sample}`string`{.variable}

:   Certificate PEM string

`key_pem=`{.sample}`string`{.variable}

:   Private key PEM string

`listen=`{.sample}`1|0`{.variable}

:   If enabled, listen for connections on the provided port, and assume
    the server role in the handshake instead of the client role.

`mtu=`{.sample}`size`{.variable}

:   Set the Maximum Transmission Unit (MTU) for DTLS packets.

`use_srtp=`{.sample}`1|0`{.variable}

:   Enable the use_srtp DTLS extension. This is used in WebRTC
    applications to establish SRTP encryption keys through the DTLS
    handshake. Default is disabled.

`external_sock=`{.sample}`1|0`{.variable}

:   Use an external socket instead of creating a new one. This option
    only makes sense to pass when interacting with the code via API,
    enabling this from CLI will cause immediate failure. Default is
    disabled.

Example command lines:

To create a DTLS server:

::: example
``` example
ffmpeg -listen 1 -i dtls://hostname:port output
```
:::

To create a DTLS client and send data to server:

::: example
``` example
ffmpeg -i input -f format dtls://hostname:port
```
:::

[]{#udp}

### [24.44 udp](#toc-udp) {#udp .section}

User Datagram Protocol.

The required syntax for an UDP URL is:

::: example
``` example
udp://hostname:port[?options]
```
:::

`options`{.variable} contains a list of &-separated options of the form
`key`{.variable}=`val`{.variable}. Standard percent-encoding (and using
the plus sign for space) can be used to escape keys and values.

Options can also can be specified via command line options (or in code
via `AVOption`s).

In case threading is enabled on the system, a circular buffer is used to
store the incoming data, which allows one to reduce loss of data due to
UDP socket buffer overruns. The `fifo_size`{.variable} and
`overrun_nonfatal`{.variable} options are related to this buffer.

The list of supported options follows.

`buffer_size=`{.sample}`size`{.variable}

:   Set the UDP maximum socket buffer size in bytes. This is used to set
    either the receive or send buffer size, depending on what the socket
    is used for. Default is 32 KB for output, 384 KB for input. See also
    `fifo_size`{.variable}.

`bitrate=`{.sample}`bitrate`{.variable}

:   If set to nonzero, the output will have the specified constant
    bitrate if the input has enough packets to sustain it.

`burst_bits=`{.sample}`bits`{.variable}

:   When using `bitrate`{.variable} this specifies the maximum number of
    bits in packet bursts.

`localport=`{.sample}`port`{.variable}

:   Override the local UDP port to bind with.

`localaddr=`{.sample}`addr`{.variable}

:   Local IP address of a network interface used for sending packets or
    joining multicast groups.

`pkt_size=`{.sample}`size`{.variable}

:   Set the size in bytes of UDP packets.

`reuse=`{.sample}`1|0`{.variable}

:   Explicitly allow or disallow reusing UDP sockets.

`ttl=`{.sample}`ttl`{.variable}

:   Set the time to live value (for multicast only).

`dscp=`{.sample}`dscp`{.variable}

:   Set the 6-bit DSCP field for outgoing packets.

`connect=`{.sample}`1|0`{.variable}

:   Initialize the UDP socket with `connect()`. In this case, the
    destination address can't be changed with ff_udp_set_remote_url
    later. If the destination address isn't known at the start, this
    option can be specified in ff_udp_set_remote_url, too. This allows
    finding out the source address for the packets with getsockname, and
    makes writes return with AVERROR(ECONNREFUSED) if \"destination
    unreachable\" is received. For receiving, this gives the benefit of
    only receiving packets from the specified peer address/port.

`sources=`{.sample}`address`{.variable}`[,`{.sample}`address`{.variable}`]`{.sample}

:   Only receive packets sent from the specified addresses. In case of
    multicast, also subscribe to multicast traffic coming from these
    addresses only.

`block=`{.sample}`address`{.variable}`[,`{.sample}`address`{.variable}`]`{.sample}

:   Ignore packets sent from the specified addresses. In case of
    multicast, also exclude the source addresses in the multicast
    subscription.

`fifo_size=`{.sample}`units`{.variable}

:   Set the UDP receiving circular buffer size, expressed as a number of
    packets with size of 188 bytes. If not specified defaults to
    7\*4096.

`overrun_nonfatal=`{.sample}`1|0`{.variable}

:   Survive in case of UDP receiving circular buffer overrun. Default
    value is 0.

`timeout=`{.sample}`microseconds`{.variable}

:   Set raise error timeout, expressed in microseconds.

    This option is only relevant in read mode: if no data arrived in
    more than this time interval, raise error.

`broadcast=`{.sample}`1|0`{.variable}

:   Explicitly allow or disallow UDP broadcasting.

    Note that broadcasting may not work properly on networks having a
    broadcast storm protection.

[]{#Examples-29}

#### [24.44.1 Examples](#toc-Examples-29) {#examples-29 .subsection}

- Use `ffmpeg` to stream over UDP to a remote endpoint:

  ::: example
  ``` example
  ffmpeg -i input -f format udp://hostname:port
  ```
  :::
- Use `ffmpeg` to stream in mpegts format over UDP using 188 sized UDP
  packets, using a large input buffer:

  ::: example
  ``` example
  ffmpeg -i input -f mpegts udp://hostname:port?pkt_size=188&buffer_size=65535
  ```
  :::
- Use `ffmpeg` to receive over UDP from a remote endpoint:

  ::: example
  ``` example
  ffmpeg -i udp://[multicast-address]:port ...
  ```
  :::

[]{#unix}

### [24.45 unix](#toc-unix) {#unix .section}

Unix local socket

The required syntax for a Unix socket URL is:

::: example
``` example
unix://filepath
```
:::

The following parameters can be set via command line options (or in code
via `AVOption`s):

`timeout`{.sample}

:   Timeout in ms.

`listen`{.sample}

:   Create the Unix socket in listening mode.

`pkt_size`{.sample}

:   Maximum packet size for packet-oriented sockets (SOCK_DGRAM and
    SOCK_SEQPACKET). If greater than zero, this value is used as
    `max_packet_size`. Ignored for SOCK_STREAM. Default is `0`.

[]{#zmq}

### [24.46 zmq](#toc-zmq) {#zmq .section}

ZeroMQ asynchronous messaging using the libzmq library.

This library supports unicast streaming to multiple clients without
relying on an external server.

The required syntax for streaming or connecting to a stream is:

::: example
``` example
zmq:tcp://ip-address:port
```
:::

Example: Create a localhost stream on port 5555:

::: example
``` example
ffmpeg -re -i input -f mpegts zmq:tcp://127.0.0.1:5555
```
:::

Multiple clients may connect to the stream using:

::: example
``` example
ffplay zmq:tcp://127.0.0.1:5555
```
:::

Streaming to multiple clients is implemented using a ZeroMQ Pub-Sub
pattern. The server side binds to a port and publishes data. Clients
connect to the server (via IP address/port) and subscribe to the stream.
The order in which the server and client start generally does not
matter.

ffmpeg must be compiled with the --enable-libzmq option to support this
protocol.

Options can be set on the `ffmpeg`/`ffplay` command line. The following
options are supported:

`pkt_size`{.sample}

:   Forces the maximum packet size for sending/receiving data. The
    default value is 131,072 bytes. On the server side, this sets the
    maximum size of sent packets via ZeroMQ. On the clients, it sets an
    internal buffer size for receiving packets. Note that pkt_size on
    the clients should be equal to or greater than pkt_size on the
    server. Otherwise the received message may be truncated causing
    decoding errors.

[]{#Device-Options}

## [25 Device Options](#toc-Device-Options) {#device-options .chapter}

The libavdevice library provides the same interface as libavformat.
Namely, an input device is considered like a demuxer, and an output
device like a muxer, and the interface and generic device options are
the same provided by libavformat (see the ffmpeg-formats manual).

In addition each input or output device may support so-called private
options, which are specific for that component.

Options may be set by specifying -`option`{.variable} `value`{.variable}
in the FFmpeg tools, or by setting the value explicitly in the device
`AVFormatContext` options or using the `libavutil/opt.h`{.sample} API
for programmatic use.

[]{#Input-Devices}

## [26 Input Devices](#toc-Input-Devices) {#input-devices .chapter}

Input devices are configured elements in FFmpeg which enable accessing
the data coming from a multimedia device attached to your system.

When you configure your FFmpeg build, all the supported input devices
are enabled by default. You can list all available ones using the
configure option \"--list-indevs\".

You can disable all the input devices using the configure option
\"--disable-indevs\", and selectively enable an input device using the
option \"--enable-indev=`INDEV`{.variable}\", or you can disable a
particular input device using the option
\"--disable-indev=`INDEV`{.variable}\".

The option \"-devices\" of the ff\* tools will display the list of
supported input devices.

A description of the currently available input devices follows.

[]{#alsa}

### [26.1 alsa](#toc-alsa) {#alsa .section}

ALSA (Advanced Linux Sound Architecture) input device.

To enable this input device during configuration you need libasound
installed on your system.

This device allows capturing from an ALSA device. The name of the device
to capture has to be an ALSA card identifier.

An ALSA identifier has the syntax:

::: example
``` example
hw:CARD[,DEV[,SUBDEV]]
```
:::

where the `DEV`{.variable} and `SUBDEV`{.variable} components are
optional.

The three arguments (in order:
`CARD`{.variable},`DEV`{.variable},`SUBDEV`{.variable}) specify card
number or identifier, device number and subdevice number (-1 means any).

To see the list of cards currently recognized by your system check the
files `/proc/asound/cards`{.sample} and `/proc/asound/devices`{.sample}.

For example to capture with `ffmpeg` from an ALSA device with card id 0,
you may run the command:

::: example
``` example
ffmpeg -f alsa -i hw:0 alsaout.wav
```
:::

For more information see:
<http://www.alsa-project.org/alsa-doc/alsa-lib/pcm.html>

[]{#Options-94}

#### [26.1.1 Options](#toc-Options-94) {#options-94 .subsection}

`sample_rate`{.sample}

:   Set the sample rate in Hz. Default is 48000.

`channels`{.sample}

:   Set the number of channels. Default is 2.

[]{#android_005fcamera}

### [26.2 android_camera](#toc-android_005fcamera) {#android_camera .section}

Android camera input device.

This input devices uses the Android Camera2 NDK API which is available
on devices with API level 24+. The availability of android_camera is
autodetected during configuration.

This device allows capturing from all cameras on an Android device,
which are integrated into the Camera2 NDK API.

The available cameras are enumerated internally and can be selected with
the `camera_index`{.variable} parameter. The input file string is
discarded.

Generally the back facing camera has index 0 while the front facing
camera has index 1.

[]{#Options-95}

#### [26.2.1 Options](#toc-Options-95) {#options-95 .subsection}

`video_size`{.sample}

:   Set the video size given as a string such as 640x480 or hd720. Falls
    back to the first available configuration reported by Android if
    requested video size is not available or by default.

`framerate`{.sample}

:   Set the video framerate. Falls back to the first available
    configuration reported by Android if requested framerate is not
    available or by default (-1).

`camera_index`{.sample}

:   Set the index of the camera to use. Default is 0.

`input_queue_size`{.sample}

:   Set the maximum number of frames to buffer. Default is 5.

[]{#avfoundation}

### [26.3 avfoundation](#toc-avfoundation) {#avfoundation .section}

AVFoundation input device.

AVFoundation is the currently recommended framework by Apple for
streamgrabbing on OSX \>= 10.7 as well as on iOS.

The input filename has to be given in the following syntax:

::: example
``` example
-i "[[VIDEO]:[AUDIO]]"
```
:::

The first entry selects the video input while the latter selects the
audio input. The stream has to be specified by the device name or the
device index as shown by the device list. Alternatively, the video
and/or audio input device can be chosen by index using the
` -video_device_index <INDEX> `{.sample} and/or
` -audio_device_index <INDEX> `{.sample} , overriding any device name or
index given in the input filename.

All available devices can be enumerated by using
`-list_devices true`{.sample}, listing all device names and
corresponding indices.

There are two device name aliases:

`default`

:   Select the AVFoundation default device of the corresponding type.

`none`

:   Do not record the corresponding media type. This is equivalent to
    specifying an empty device name or index.

[]{#Options-96}

#### [26.3.1 Options](#toc-Options-96) {#options-96 .subsection}

AVFoundation supports the following options:

`-list_devices <TRUE|FALSE>`{.sample}

:   If set to true, a list of all available input devices is given
    showing all device names and indices.

`-video_device_index <INDEX>`{.sample}

:   Specify the video device by its index. Overrides anything given in
    the input filename.

`-audio_device_index <INDEX>`{.sample}

:   Specify the audio device by its index. Overrides anything given in
    the input filename.

`-pixel_format <FORMAT>`{.sample}

:   Request the video device to use a specific pixel format. If the
    specified format is not supported, a list of available formats is
    given and the first one in this list is used instead. Available
    pixel formats are:
    `monob, rgb555be, rgb555le, rgb565be, rgb565le, rgb24, bgr24, 0rgb, bgr0, 0bgr, rgb0, bgr48be, uyvy422, yuva444p, yuva444p16le, yuv444p, yuv422p16, yuv422p10, yuv444p10, yuv420p, nv12, yuyv422, gray`

`-framerate`{.sample}

:   Set the grabbing frame rate. Default is `ntsc`, corresponding to a
    frame rate of `30000/1001`.

`-video_size`{.sample}

:   Set the video frame size.

`-capture_cursor`{.sample}

:   Capture the mouse pointer. Default is 0.

`-capture_mouse_clicks`{.sample}

:   Capture the screen mouse clicks. Default is 0.

`-capture_raw_data`{.sample}

:   Capture the raw device data. Default is 0. Using this option may
    result in receiving the underlying data delivered to the
    AVFoundation framework. E.g. for muxed devices that sends raw DV
    data to the framework (like tape-based camcorders), setting this
    option to false results in extracted video frames captured in the
    designated pixel format only. Setting this option to true results in
    receiving the raw DV stream untouched.

[]{#Examples-30}

#### [26.3.2 Examples](#toc-Examples-30) {#examples-30 .subsection}

- Print the list of AVFoundation supported devices and exit:

  ::: example
  ``` example
  $ ffmpeg -f avfoundation -list_devices true -i ""
  ```
  :::
- Record video from video device 0 and audio from audio device 0 into
  out.avi:

  ::: example
  ``` example
  $ ffmpeg -f avfoundation -i "0:0" out.avi
  ```
  :::
- Record video from video device 2 and audio from audio device 1 into
  out.avi:

  ::: example
  ``` example
  $ ffmpeg -f avfoundation -video_device_index 2 -i ":1" out.avi
  ```
  :::
- Record video from the system default video device using the pixel
  format bgr0 and do not record any audio into out.avi:

  ::: example
  ``` example
  $ ffmpeg -f avfoundation -pixel_format bgr0 -i "default:none" out.avi
  ```
  :::
- Record raw DV data from a suitable input device and write the output
  into out.dv:

  ::: example
  ``` example
  $ ffmpeg -f avfoundation -capture_raw_data true -i "zr100:none" out.dv
  ```
  :::

[]{#decklink}

### [26.4 decklink](#toc-decklink) {#decklink .section}

The decklink input device provides capture capabilities for Blackmagic
DeckLink devices.

To enable this input device, you need the Blackmagic DeckLink SDK and
you need to configure with the appropriate `--extra-cflags` and
`--extra-ldflags`. On Windows, you need to run the IDL files through
`widl`.

DeckLink is very picky about the formats it supports. Pixel format of
the input can be set with `raw_format`{.sample}. Framerate and video
size must be determined for your device with `-list_formats 1`. Audio
sample rate is always 48 kHz and the number of channels can be 2, 8 or
16. Note that all audio channels are bundled in one single audio track.

[]{#Options-97}

#### [26.4.1 Options](#toc-Options-97) {#options-97 .subsection}

`list_devices`{.sample}

:   If set to `true`{.sample}, print a list of devices and exit.
    Defaults to `false`{.sample}. This option is deprecated, please use
    the `-sources` option of ffmpeg to list the available input devices.

`list_formats`{.sample}

:   If set to `true`{.sample}, print a list of supported formats and
    exit. Defaults to `false`{.sample}.

`format_code <FourCC>`{.sample}

:   This sets the input video format to the format given by the FourCC.
    To see the supported values of your device(s) use
    `list_formats`{.sample}. Note that there is a FourCC
    `'pal '`{.sample} that can also be used as `pal`{.sample} (3
    letters). Default behavior is autodetection of the input video
    format, if the hardware supports it.

`raw_format`{.sample}

:   Set the pixel format of the captured video. Available values are:

    '`auto`{.sample}'

    :   This is the default which means 8-bit YUV 422 or 8-bit ARGB if
        format autodetection is used, 8-bit YUV 422 otherwise.

    '`uyvy422`{.sample}'

    :   8-bit YUV 422.

    '`yuv422p10`{.sample}'

    :   10-bit YUV 422.

    '`argb`{.sample}'

    :   8-bit RGB.

    '`bgra`{.sample}'

    :   8-bit RGB.

    '`rgb10`{.sample}'

    :   10-bit RGB.

`teletext_lines`{.sample}

:   If set to nonzero, an additional teletext stream will be captured
    from the vertical ancillary data. Both SD PAL (576i) and HD (1080i
    or 1080p) sources are supported. In case of HD sources, OP47 packets
    are decoded.

    This option is a bitmask of the SD PAL VBI lines captured,
    specifically lines 6 to 22, and lines 318 to 335. Line 6 is the LSB
    in the mask. Selected lines which do not contain teletext
    information will be ignored. You can use the special `all`{.sample}
    constant to select all possible lines, or `standard`{.sample} to
    skip lines 6, 318 and 319, which are not compatible with all
    receivers.

    For SD sources, ffmpeg needs to be compiled with `--enable-libzvbi`.
    For HD sources, on older (pre-4K) DeckLink card models you have to
    capture in 10 bit mode.

`channels`{.sample}

:   Defines number of audio channels to capture. Must be '`2`{.sample}',
    '`8`{.sample}' or '`16`{.sample}'. Defaults to '`2`{.sample}'.

`duplex_mode`{.sample}

:   Sets the decklink device duplex/profile mode. Must be
    '`unset`{.sample}', '`half`{.sample}', '`full`{.sample}',
    '`one_sub_device_full`{.sample}', '`one_sub_device_half`{.sample}',
    '`two_sub_device_full`{.sample}', '`four_sub_device_half`{.sample}'
    Defaults to '`unset`{.sample}'.

    Note: DeckLink SDK 11.0 have replaced the duplex property by a
    profile property. For the DeckLink Duo 2 and DeckLink Quad 2, a
    profile is shared between any 2 sub-devices that utilize the same
    connectors. For the DeckLink 8K Pro, a profile is shared between all
    4 sub-devices. So DeckLink 8K Pro support four profiles.

    Valid profile modes for DeckLink 8K Pro(with DeckLink SDK \>= 11.0):
    '`one_sub_device_full`{.sample}', '`one_sub_device_half`{.sample}',
    '`two_sub_device_full`{.sample}', '`four_sub_device_half`{.sample}'

    Valid profile modes for DeckLink Quad 2 and DeckLink Duo 2:
    '`half`{.sample}', '`full`{.sample}'

`timecode_format`{.sample}

:   Timecode type to include in the frame and video stream metadata.
    Must be '`none`{.sample}', '`rp188vitc`{.sample}',
    '`rp188vitc2`{.sample}', '`rp188ltc`{.sample}',
    '`rp188hfr`{.sample}', '`rp188any`{.sample}', '`vitc`{.sample}',
    '`vitc2`{.sample}', or '`serial`{.sample}'. Defaults to
    '`none`{.sample}' (not included).

    In order to properly support 50/60 fps timecodes, the ordering of
    the queried timecode types for '`rp188any`{.sample}' is HFR, VITC1,
    VITC2 and LTC for \>30 fps content. Note that this is slightly
    different to the ordering used by the DeckLink API, which is HFR,
    VITC1, LTC, VITC2.

`video_input`{.sample}

:   Sets the video input source. Must be '`unset`{.sample}',
    '`sdi`{.sample}', '`hdmi`{.sample}', '`optical_sdi`{.sample}',
    '`component`{.sample}', '`composite`{.sample}' or
    '`s_video`{.sample}'. Defaults to '`unset`{.sample}'.

`audio_input`{.sample}

:   Sets the audio input source. Must be '`unset`{.sample}',
    '`embedded`{.sample}', '`aes_ebu`{.sample}', '`analog`{.sample}',
    '`analog_xlr`{.sample}', '`analog_rca`{.sample}' or
    '`microphone`{.sample}'. Defaults to '`unset`{.sample}'.

`video_pts`{.sample}

:   Sets the video packet timestamp source. Must be '`video`{.sample}',
    '`audio`{.sample}', '`reference`{.sample}', '`wallclock`{.sample}'
    or '`abs_wallclock`{.sample}'. Defaults to '`video`{.sample}'.

`audio_pts`{.sample}

:   Sets the audio packet timestamp source. Must be '`video`{.sample}',
    '`audio`{.sample}', '`reference`{.sample}', '`wallclock`{.sample}'
    or '`abs_wallclock`{.sample}'. Defaults to '`audio`{.sample}'.

`draw_bars`{.sample}

:   If set to '`true`{.sample}', color bars are drawn in the event of a
    signal loss. Defaults to '`true`{.sample}'. This option is
    deprecated, please use the `signal_loss_action` option.

`signal_loss_action`{.sample}

:   Sets the action to take in the event of a signal loss. Accepts one
    of the following values:

    `1, none`{.sample}

    :   Do nothing on signal loss. This usually results in black frames.

    `2, bars`{.sample}

    :   Draw color bars on signal loss. Only supported for 8-bit input
        signals.

    `3, repeat`{.sample}

    :   Repeat the last video frame on signal loss.

    Defaults to '`bars`{.sample}'.

`queue_size`{.sample}

:   Sets maximum input buffer size in bytes. If the buffering reaches
    this value, incoming frames will be dropped. Defaults to
    '`1073741824`{.sample}'.

`audio_depth`{.sample}

:   Sets the audio sample bit depth. Must be '`16`{.sample}' or
    '`32`{.sample}'. Defaults to '`16`{.sample}'.

`decklink_copyts`{.sample}

:   If set to `true`{.sample}, timestamps are forwarded as they are
    without removing the initial offset. Defaults to `false`{.sample}.

`timestamp_align`{.sample}

:   Capture start time alignment in seconds. If set to nonzero, input
    frames are dropped till the system timestamp aligns with configured
    value. Alignment difference of up to one frame duration is
    tolerated. This is useful for maintaining input synchronization
    across N different hardware devices deployed for 'N-way' redundancy.
    The system time of different hardware devices should be synchronized
    with protocols such as NTP or PTP, before using this option. Note
    that this method is not foolproof. In some border cases input
    synchronization may not happen due to thread scheduling jitters in
    the OS. Either sync could go wrong by 1 frame or in a rarer case
    `timestamp_align`{.sample} seconds. Defaults to '`0`{.sample}'.

`wait_for_tc (`{.sample}*`bool`{.sample}*`)`{.sample}

:   Drop frames till a frame with timecode is received. Sometimes serial
    timecode isn't received with the first input frame. If that happens,
    the stored stream timecode will be inaccurate. If this option is set
    to `true`{.sample}, input frames are dropped till a frame with
    timecode is received. Option `timecode_format`{.variable} must be
    specified. Defaults to `false`{.sample}.

`enable_klv(`{.sample}*`bool`{.sample}*`)`{.sample}

:   If set to `true`{.sample}, extracts KLV data from VANC and outputs
    KLV packets. KLV VANC packets are joined based on MID and PSC fields
    and aggregated into one KLV packet. Defaults to `false`{.sample}.

[]{#Examples-31}

#### [26.4.2 Examples](#toc-Examples-31) {#examples-31 .subsection}

- List input devices:

  ::: example
  ``` example
  ffmpeg -sources decklink
  ```
  :::
- List supported formats:

  ::: example
  ``` example
  ffmpeg -f decklink -list_formats 1 -i 'Intensity Pro'
  ```
  :::
- Capture video clip at 1080i50:

  ::: example
  ``` example
  ffmpeg -format_code Hi50 -f decklink -i 'Intensity Pro' -c:a copy -c:v copy output.avi
  ```
  :::
- Capture video clip at 1080i50 10 bit:

  ::: example
  ``` example
  ffmpeg -raw_format yuv422p10 -format_code Hi50 -f decklink -i 'UltraStudio Mini Recorder' -c:a copy -c:v copy output.avi
  ```
  :::
- Capture video clip at 1080i50 with 16 audio channels:

  ::: example
  ``` example
  ffmpeg -channels 16 -format_code Hi50 -f decklink -i 'UltraStudio Mini Recorder' -c:a copy -c:v copy output.avi
  ```
  :::

[]{#dshow}

### [26.5 dshow](#toc-dshow) {#dshow .section}

Windows DirectShow input device.

DirectShow support is enabled when FFmpeg is built with the mingw-w64
project. Currently only audio and video devices are supported.

Multiple devices may be opened as separate inputs, but they may also be
opened on the same input, which should improve synchronism between them.

The input name should be in the format:

::: example
``` example
TYPE=NAME[:TYPE=NAME]
```
:::

where `TYPE`{.variable} can be either `audio`{.variable} or
`video`{.variable}, and `NAME`{.variable} is the device's name or
alternative name..

[]{#Options-98}

#### [26.5.1 Options](#toc-Options-98) {#options-98 .subsection}

If no options are specified, the device's defaults are used. If the
device does not support the requested options, it will fail to open.

`video_size`{.sample}

:   Set the video size in the captured video.

`framerate`{.sample}

:   Set the frame rate in the captured video.

`sample_rate`{.sample}

:   Set the sample rate (in Hz) of the captured audio.

`sample_size`{.sample}

:   Set the sample size (in bits) of the captured audio.

`channels`{.sample}

:   Set the number of channels in the captured audio.

`list_devices`{.sample}

:   If set to `true`{.sample}, print a list of devices and exit.

`list_options`{.sample}

:   If set to `true`{.sample}, print a list of selected device's options
    and exit.

`video_device_number`{.sample}

:   Set video device number for devices with the same name (starts at 0,
    defaults to 0).

`audio_device_number`{.sample}

:   Set audio device number for devices with the same name (starts at 0,
    defaults to 0).

`pixel_format`{.sample}

:   Select pixel format to be used by DirectShow. This may only be set
    when the video codec is not set or set to rawvideo.

`audio_buffer_size`{.sample}

:   Set audio device buffer size in milliseconds (which can directly
    impact latency, depending on the device). Defaults to using the
    audio device's default buffer size (typically some multiple of
    500ms). Setting this value too low can degrade performance. See also
    <http://msdn.microsoft.com/en-us/library/windows/desktop/dd377582(v=vs.85).aspx>

`video_pin_name`{.sample}

:   Select video capture pin to use by name or alternative name.

`audio_pin_name`{.sample}

:   Select audio capture pin to use by name or alternative name.

`crossbar_video_input_pin_number`{.sample}

:   Select video input pin number for crossbar device. This will be
    routed to the crossbar device's Video Decoder output pin. Note that
    changing this value can affect future invocations (sets a new
    default) until system reboot occurs.

`crossbar_audio_input_pin_number`{.sample}

:   Select audio input pin number for crossbar device. This will be
    routed to the crossbar device's Audio Decoder output pin. Note that
    changing this value can affect future invocations (sets a new
    default) until system reboot occurs.

`show_video_device_dialog`{.sample}

:   If set to `true`{.sample}, before capture starts, popup a display
    dialog to the end user, allowing them to change video filter
    properties and configurations manually. Note that for crossbar
    devices, adjusting values in this dialog may be needed at times to
    toggle between PAL (25 fps) and NTSC (29.97) input frame rates,
    sizes, interlacing, etc. Changing these values can enable different
    scan rates/frame rates and avoiding green bars at the bottom,
    flickering scan lines, etc. Note that with some devices, changing
    these properties can also affect future invocations (sets new
    defaults) until system reboot occurs.

`show_audio_device_dialog`{.sample}

:   If set to `true`{.sample}, before capture starts, popup a display
    dialog to the end user, allowing them to change audio filter
    properties and configurations manually.

`show_video_crossbar_connection_dialog`{.sample}

:   If set to `true`{.sample}, before capture starts, popup a display
    dialog to the end user, allowing them to manually modify crossbar
    pin routings, when it opens a video device.

`show_audio_crossbar_connection_dialog`{.sample}

:   If set to `true`{.sample}, before capture starts, popup a display
    dialog to the end user, allowing them to manually modify crossbar
    pin routings, when it opens an audio device.

`show_analog_tv_tuner_dialog`{.sample}

:   If set to `true`{.sample}, before capture starts, popup a display
    dialog to the end user, allowing them to manually modify TV channels
    and frequencies.

`show_analog_tv_tuner_audio_dialog`{.sample}

:   If set to `true`{.sample}, before capture starts, popup a display
    dialog to the end user, allowing them to manually modify TV audio
    (like mono vs. stereo, Language A,B or C).

`audio_device_load`{.sample}

:   Load an audio capture filter device from file instead of searching
    it by name. It may load additional parameters too, if the filter
    supports the serialization of its properties to. To use this an
    audio capture source has to be specified, but it can be anything
    even fake one.

`audio_device_save`{.sample}

:   Save the currently used audio capture filter device and its
    parameters (if the filter supports it) to a file. If a file with the
    same name exists it will be overwritten.

`video_device_load`{.sample}

:   Load a video capture filter device from file instead of searching it
    by name. It may load additional parameters too, if the filter
    supports the serialization of its properties to. To use this a video
    capture source has to be specified, but it can be anything even fake
    one.

`video_device_save`{.sample}

:   Save the currently used video capture filter device and its
    parameters (if the filter supports it) to a file. If a file with the
    same name exists it will be overwritten.

`use_video_device_timestamps`{.sample}

:   If set to `false`{.sample}, the timestamp for video frames will be
    derived from the wallclock instead of the timestamp provided by the
    capture device. This allows working around devices that provide
    unreliable timestamps.

[]{#Examples-32}

#### [26.5.2 Examples](#toc-Examples-32) {#examples-32 .subsection}

- Print the list of DirectShow supported devices and exit:

  ::: example
  ``` example
  $ ffmpeg -list_devices true -f dshow -i dummy
  ```
  :::
- Open video device `Camera`{.variable}:

  ::: example
  ``` example
  $ ffmpeg -f dshow -i video="Camera"
  ```
  :::
- Open second video device with name `Camera`{.variable}:

  ::: example
  ``` example
  $ ffmpeg -f dshow -video_device_number 1 -i video="Camera"
  ```
  :::
- Open video device `Camera`{.variable} and audio device
  `Microphone`{.variable}:

  ::: example
  ``` example
  $ ffmpeg -f dshow -i video="Camera":audio="Microphone"
  ```
  :::
- Print the list of supported options in selected device and exit:

  ::: example
  ``` example
  $ ffmpeg -list_options true -f dshow -i video="Camera"
  ```
  :::
- Specify pin names to capture by name or alternative name, specify
  alternative device name:

  ::: example
  ``` example
  $ ffmpeg -f dshow -audio_pin_name "Audio Out" -video_pin_name 2 -i video=video="@device_pnp_\\?\pci#ven_1a0a&dev_6200&subsys_62021461&rev_01#4&e2c7dd6&0&00e1#{65e8773d-8f56-11d0-a3b9-00a0c9223196}\{ca465100-deb0-4d59-818f-8c477184adf6}":audio="Microphone"
  ```
  :::
- Configure a crossbar device, specifying crossbar pins, allow user to
  adjust video capture properties at startup:

  ::: example
  ``` example
  $ ffmpeg -f dshow -show_video_device_dialog true -crossbar_video_input_pin_number 0
       -crossbar_audio_input_pin_number 3 -i video="AVerMedia BDA Analog Capture":audio="AVerMedia BDA Analog Capture"
  ```
  :::

[]{#fbdev}

### [26.6 fbdev](#toc-fbdev) {#fbdev .section}

Linux framebuffer input device.

The Linux framebuffer is a graphic hardware-independent abstraction
layer to show graphics on a computer monitor, typically on the console.
It is accessed through a file device node, usually `/dev/fb0`{.sample}.

For more detailed information read the file
Documentation/fb/framebuffer.txt included in the Linux source tree.

See also <http://linux-fbdev.sourceforge.net/>, and fbset(1).

To record from the framebuffer device `/dev/fb0`{.sample} with `ffmpeg`:

::: example
``` example
ffmpeg -f fbdev -framerate 10 -i /dev/fb0 out.avi
```
:::

You can take a single screenshot image with the command:

::: example
``` example
ffmpeg -f fbdev -framerate 1 -i /dev/fb0 -frames:v 1 screenshot.jpeg
```
:::

[]{#Options-99}

#### [26.6.1 Options](#toc-Options-99) {#options-99 .subsection}

`framerate`{.sample}

:   Set the frame rate. Default is 25.

[]{#gdigrab}

### [26.7 gdigrab](#toc-gdigrab) {#gdigrab .section}

Win32 GDI-based screen capture device.

This device allows you to capture a region of the display on Windows.

Amongst options for the input filenames are such elements as:

::: example
``` example
desktop
```
:::

or

::: example
``` example
title=window_title
```
:::

or

::: example
``` example
hwnd=window_hwnd
```
:::

The first option will capture the entire desktop, or a fixed region of
the desktop. The second and third options will instead capture the
contents of a single window, regardless of its position on the screen.

For example, to grab the entire desktop using `ffmpeg`:

::: example
``` example
ffmpeg -f gdigrab -framerate 6 -i desktop out.mpg
```
:::

Grab a 640x480 region at position `10,20`:

::: example
``` example
ffmpeg -f gdigrab -framerate 6 -offset_x 10 -offset_y 20 -video_size vga -i desktop out.mpg
```
:::

Grab the contents of the window named \"Calculator\"

::: example
``` example
ffmpeg -f gdigrab -framerate 6 -i title=Calculator out.mpg
```
:::

[]{#Options-100}

#### [26.7.1 Options](#toc-Options-100) {#options-100 .subsection}

`draw_mouse`{.sample}

:   Specify whether to draw the mouse pointer. Use the value `0` to not
    draw the pointer. Default value is `1`.

`framerate`{.sample}

:   Set the grabbing frame rate. Default value is `ntsc`, corresponding
    to a frame rate of `30000/1001`.

`show_region`{.sample}

:   Show grabbed region on screen.

    If `show_region`{.variable} is specified with `1`, then the grabbing
    region will be indicated on screen. With this option, it is easy to
    know what is being grabbed if only a portion of the screen is
    grabbed.

    Note that `show_region`{.variable} is incompatible with grabbing the
    contents of a single window.

    For example:

    ::: example
    ``` example
    ffmpeg -f gdigrab -show_region 1 -framerate 6 -video_size cif -offset_x 10 -offset_y 20 -i desktop out.mpg
    ```
    :::

`video_size`{.sample}

:   Set the video frame size. The default is to capture the full screen
    if `desktop`{.sample} is selected, or the full window size if
    `title=`{.sample}`window_title`{.variable} is selected.

`offset_x`{.sample}

:   When capturing a region with `video_size`{.variable}, set the
    distance from the left edge of the screen or desktop.

    Note that the offset calculation is from the top left corner of the
    primary monitor on Windows. If you have a monitor positioned to the
    left of your primary monitor, you will need to use a negative
    `offset_x`{.variable} value to move the region to that monitor.

`offset_y`{.sample}

:   When capturing a region with `video_size`{.variable}, set the
    distance from the top edge of the screen or desktop.

    Note that the offset calculation is from the top left corner of the
    primary monitor on Windows. If you have a monitor positioned above
    your primary monitor, you will need to use a negative
    `offset_y`{.variable} value to move the region to that monitor.

[]{#iec61883}

### [26.8 iec61883](#toc-iec61883) {#iec61883 .section}

FireWire DV/HDV input device using libiec61883.

To enable this input device, you need libiec61883, libraw1394 and
libavc1394 installed on your system. Use the configure option
`--enable-libiec61883` to compile with the device enabled.

The iec61883 capture device supports capturing from a video device
connected via IEEE1394 (FireWire), using libiec61883 and the new Linux
FireWire stack (juju). This is the default DV/HDV input method in Linux
Kernel 2.6.37 and later, since the old FireWire stack was removed.

Specify the FireWire port to be used as input file, or \"auto\" to
choose the first port connected.

[]{#Options-101}

#### [26.8.1 Options](#toc-Options-101) {#options-101 .subsection}

`dvtype`{.sample}

:   Override autodetection of DV/HDV. This should only be used if auto
    detection does not work, or if usage of a different device type
    should be prohibited. Treating a DV device as HDV (or vice versa)
    will not work and result in undefined behavior. The values
    `auto`{.sample}, `dv`{.sample} and `hdv`{.sample} are supported.

`dvbuffer`{.sample}

:   Set maximum size of buffer for incoming data, in frames. For DV,
    this is an exact value. For HDV, it is not frame exact, since HDV
    does not have a fixed frame size.

`dvguid`{.sample}

:   Select the capture device by specifying its GUID. Capturing will
    only be performed from the specified device and fails if no device
    with the given GUID is found. This is useful to select the input if
    multiple devices are connected at the same time. Look at
    /sys/bus/firewire/devices to find out the GUIDs.

[]{#Examples-33}

#### [26.8.2 Examples](#toc-Examples-33) {#examples-33 .subsection}

- Grab and show the input of a FireWire DV/HDV device.

  ::: example
  ``` example
  ffplay -f iec61883 -i auto
  ```
  :::
- Grab and record the input of a FireWire DV/HDV device, using a packet
  buffer of 100000 packets if the source is HDV.

  ::: example
  ``` example
  ffmpeg -f iec61883 -i auto -dvbuffer 100000 out.mpg
  ```
  :::

[]{#jack}

### [26.9 jack](#toc-jack) {#jack .section}

JACK input device.

To enable this input device during configuration you need libjack
installed on your system.

A JACK input device creates one or more JACK writable clients, one for
each audio channel, with name
`client_name`{.variable}:input\_`N`{.variable}, where
`client_name`{.variable} is the name provided by the application, and
`N`{.variable} is a number which identifies the channel. Each writable
client will send the acquired data to the FFmpeg input device.

Once you have created one or more JACK readable clients, you need to
connect them to one or more JACK writable clients.

To connect or disconnect JACK clients you can use the `jack_connect` and
`jack_disconnect` programs, or do it through a graphical interface, for
example with `qjackctl`.

To list the JACK clients and their properties you can invoke the command
`jack_lsp`.

Follows an example which shows how to capture a JACK readable client
with `ffmpeg`.

::: example
``` example
# Create a JACK writable client with name "ffmpeg".
$ ffmpeg -f jack -i ffmpeg -y out.wav

# Start the sample jack_metro readable client.
$ jack_metro -b 120 -d 0.2 -f 4000

# List the current JACK clients.
$ jack_lsp -c
system:capture_1
system:capture_2
system:playback_1
system:playback_2
ffmpeg:input_1
metro:120_bpm

# Connect metro to the ffmpeg writable client.
$ jack_connect metro:120_bpm ffmpeg:input_1
```
:::

For more information read: <http://jackaudio.org/>

[]{#Options-102}

#### [26.9.1 Options](#toc-Options-102) {#options-102 .subsection}

`channels`{.sample}

:   Set the number of channels. Default is 2.

[]{#kmsgrab}

### [26.10 kmsgrab](#toc-kmsgrab) {#kmsgrab .section}

KMS video input device.

Captures the KMS scanout framebuffer associated with a specified CRTC or
plane as a DRM object that can be passed to other hardware functions.

Requires either DRM master or CAP_SYS_ADMIN to run.

If you don't understand what all of that means, you probably don't want
this. Look at `x11grab`{.sample} instead.

[]{#Options-103}

#### [26.10.1 Options](#toc-Options-103) {#options-103 .subsection}

`device`{.sample}

:   DRM device to capture on. Defaults to `/dev/dri/card0`{.sample}.

`format`{.sample}

:   Pixel format of the framebuffer. This can be autodetected if you are
    running Linux 5.7 or later, but needs to be provided for earlier
    versions. Defaults to `bgr0`{.sample}, which is the most common
    format used by the Linux console and Xorg X server.

`format_modifier`{.sample}

:   Format modifier to signal on output frames. This is necessary to
    import correctly into some APIs. It can be autodetected if you are
    running Linux 5.7 or later, but will need to be provided explicitly
    when needed in earlier versions. See the libdrm documentation for
    possible values.

`crtc_id`{.sample}

:   KMS CRTC ID to define the capture source. The first active plane on
    the given CRTC will be used.

`plane_id`{.sample}

:   KMS plane ID to define the capture source. Defaults to the first
    active plane found if neither `crtc_id`{.sample} nor
    `plane_id`{.sample} are specified.

`framerate`{.sample}

:   Framerate to capture at. This is not synchronised to any page
    flipping or framebuffer changes - it just defines the interval at
    which the framebuffer is sampled. Sampling faster than the
    framebuffer update rate will generate independent frames with the
    same content. Defaults to `30`.

[]{#Examples-34}

#### [26.10.2 Examples](#toc-Examples-34) {#examples-34 .subsection}

- Capture from the first active plane, download the result to normal
  frames and encode. This will only work if the framebuffer is both
  linear and mappable - if not, the result may be scrambled or fail to
  download.

  ::: example
  ``` example
  ffmpeg -f kmsgrab -i - -vf 'hwdownload,format=bgr0' output.mp4
  ```
  :::
- Capture from CRTC ID 42 at 60fps, map the result to VAAPI, convert to
  NV12 and encode as H.264.

  ::: example
  ``` example
  ffmpeg -crtc_id 42 -framerate 60 -f kmsgrab -i - -vf 'hwmap=derive_device=vaapi,scale_vaapi=w=1920:h=1080:format=nv12' -c:v h264_vaapi output.mp4
  ```
  :::
- To capture only part of a plane the output can be cropped - this can
  be used to capture a single window, as long as it has a known absolute
  position and size. For example, to capture and encode the middle
  quarter of a 1920x1080 plane:

  ::: example
  ``` example
  ffmpeg -f kmsgrab -i - -vf 'hwmap=derive_device=vaapi,crop=960:540:480:270,scale_vaapi=960:540:nv12' -c:v h264_vaapi output.mp4
  ```
  :::

[]{#lavfi}

### [26.11 lavfi](#toc-lavfi) {#lavfi .section}

Libavfilter input virtual device.

This input device reads data from the open output pads of a libavfilter
filtergraph.

For each filtergraph open output, the input device will create a
corresponding stream which is mapped to the generated output. The
filtergraph is specified through the option `graph`{.sample}.

[]{#Options-104}

#### [26.11.1 Options](#toc-Options-104) {#options-104 .subsection}

`graph`{.sample}

:   Specify the filtergraph to use as input. Each video open output must
    be labelled by a unique string of the form \"out`N`{.variable}\",
    where `N`{.variable} is a number starting from 0 corresponding to
    the mapped input stream generated by the device. The first
    unlabelled output is automatically assigned to the \"out0\" label,
    but all the others need to be specified explicitly.

    The suffix \"+subcc\" can be appended to the output label to create
    an extra stream with the closed captions packets attached to that
    output (experimental; only for EIA-608 / CEA-708 for now). The subcc
    streams are created after all the normal streams, in the order of
    the corresponding stream. For example, if there is \"out19+subcc\",
    \"out7+subcc\" and up to \"out42\", the stream #43 is subcc for
    stream #7 and stream #44 is subcc for stream #19.

    If not specified defaults to the filename specified for the input
    device.

`graph_file`{.sample}

:   Set the filename of the filtergraph to be read and sent to the other
    filters. Syntax of the filtergraph is the same as the one specified
    by the option `graph`{.variable}.

`dumpgraph`{.sample}

:   Dump graph to stderr.

[]{#Examples-35}

#### [26.11.2 Examples](#toc-Examples-35) {#examples-35 .subsection}

- Create a color video stream and play it back with `ffplay`:

  ::: example
  ``` example
  ffplay -f lavfi -graph "color=c=pink [out0]" dummy
  ```
  :::
- As the previous example, but use filename for specifying the graph
  description, and omit the \"out0\" label:

  ::: example
  ``` example
  ffplay -f lavfi color=c=pink
  ```
  :::
- Create three different video test filtered sources and play them:

  ::: example
  ``` example
  ffplay -f lavfi -graph "testsrc [out0]; testsrc,hflip [out1]; testsrc,negate [out2]" test3
  ```
  :::
- Read an audio stream from a file using the amovie source and play it
  back with `ffplay`:

  ::: example
  ``` example
  ffplay -f lavfi "amovie=test.wav"
  ```
  :::
- Read an audio stream and a video stream and play it back with
  `ffplay`:

  ::: example
  ``` example
  ffplay -f lavfi "movie=test.avi[out0];amovie=test.wav[out1]"
  ```
  :::
- Dump decoded frames to images and Closed Captions to an RCWT backup:

  ::: example
  ``` example
  ffmpeg -f lavfi -i "movie=test.ts[out0+subcc]" -map v frame%08d.png -map s -c copy -f rcwt subcc.bin
  ```
  :::

[]{#libcdio}

### [26.12 libcdio](#toc-libcdio) {#libcdio .section}

Audio-CD input device based on libcdio.

To enable this input device during configuration you need libcdio
installed on your system. It requires the configure option
`--enable-libcdio`.

This device allows playing and grabbing from an Audio-CD.

For example to copy with `ffmpeg` the entire Audio-CD in
`/dev/sr0`{.sample}, you may run the command:

::: example
``` example
ffmpeg -f libcdio -i /dev/sr0 cd.wav
```
:::

[]{#Options-105}

#### [26.12.1 Options](#toc-Options-105) {#options-105 .subsection}

`speed`{.sample}

Set drive reading speed. Default value is 0.

The speed is specified CD-ROM speed units. The speed is set through the
libcdio `cdio_cddap_speed_set` function. On many CD-ROM drives,
specifying a value too large will result in using the fastest speed.

`paranoia_mode`{.sample}

Set paranoia recovery mode flags. It accepts one of the following
values:

'`disable`{.sample}'

'`verify`{.sample}'

'`overlap`{.sample}'

'`neverskip`{.sample}'

'`full`{.sample}'

Default value is '`disable`{.sample}'.

For more information about the available recovery modes, consult the
paranoia project documentation.

[]{#libdc1394}

### [26.13 libdc1394](#toc-libdc1394) {#libdc1394 .section}

IIDC1394 input device, based on libdc1394 and libraw1394.

Requires the configure option `--enable-libdc1394`.

[]{#Options-106}

#### [26.13.1 Options](#toc-Options-106) {#options-106 .subsection}

`framerate`{.sample}

:   Set the frame rate. Default is `ntsc`, corresponding to a frame rate
    of `30000/1001`.

`pixel_format`{.sample}

:   Select the pixel format. Default is `uyvy422`.

`video_size`{.sample}

:   Set the video size given as a string such as `640x480` or `hd720`.
    Default is `qvga`.

[]{#openal}

### [26.14 openal](#toc-openal) {#openal .section}

The OpenAL input device provides audio capture on all systems with a
working OpenAL 1.1 implementation.

To enable this input device during configuration, you need OpenAL
headers and libraries installed on your system, and need to configure
FFmpeg with `--enable-openal`.

OpenAL headers and libraries should be provided as part of your OpenAL
implementation, or as an additional download (an SDK). Depending on your
installation you may need to specify additional flags via the
`--extra-cflags` and `--extra-ldflags` for allowing the build system to
locate the OpenAL headers and libraries.

An incomplete list of OpenAL implementations follows:

**Creative**

:   The official Windows implementation, providing hardware acceleration
    with supported devices and software fallback. See
    <http://openal.org/>.

**OpenAL Soft**

:   Portable, open source (LGPL) software implementation. Includes
    backends for the most common sound APIs on the Windows, Linux,
    Solaris, and BSD operating systems. See
    <http://kcat.strangesoft.net/openal.html>.

**Apple**

:   OpenAL is part of Core Audio, the official Mac OS X Audio interface.
    See
    <http://developer.apple.com/technologies/mac/audio-and-video.html>

This device allows one to capture from an audio input device handled
through OpenAL.

You need to specify the name of the device to capture in the provided
filename. If the empty string is provided, the device will automatically
select the default device. You can get the list of the supported devices
by using the option `list_devices`{.variable}.

[]{#Options-107}

#### [26.14.1 Options](#toc-Options-107) {#options-107 .subsection}

`channels`{.sample}

:   Set the number of channels in the captured audio. Only the values
    `1`{.sample} (monaural) and `2`{.sample} (stereo) are currently
    supported. Defaults to `2`{.sample}.

`sample_size`{.sample}

:   Set the sample size (in bits) of the captured audio. Only the values
    `8`{.sample} and `16`{.sample} are currently supported. Defaults to
    `16`{.sample}.

`sample_rate`{.sample}

:   Set the sample rate (in Hz) of the captured audio. Defaults to
    `44.1k`{.sample}.

`list_devices`{.sample}

:   If set to `true`{.sample}, print a list of devices and exit.
    Defaults to `false`{.sample}.

[]{#Examples-36}

#### [26.14.2 Examples](#toc-Examples-36) {#examples-36 .subsection}

Print the list of OpenAL supported devices and exit:

::: example
``` example
$ ffmpeg -list_devices true -f openal -i dummy out.ogg
```
:::

Capture from the OpenAL device `DR-BT101 via PulseAudio`{.sample}:

::: example
``` example
$ ffmpeg -f openal -i 'DR-BT101 via PulseAudio' out.ogg
```
:::

Capture from the default device (note the empty string " as filename):

::: example
``` example
$ ffmpeg -f openal -i '' out.ogg
```
:::

Capture from two devices simultaneously, writing to two different files,
within the same `ffmpeg` command:

::: example
``` example
$ ffmpeg -f openal -i 'DR-BT101 via PulseAudio' out1.ogg -f openal -i 'ALSA Default' out2.ogg
```
:::

Note: not all OpenAL implementations support multiple simultaneous
capture - try the latest OpenAL Soft if the above does not work.

[]{#oss}

### [26.15 oss](#toc-oss) {#oss .section}

Open Sound System input device.

The filename to provide to the input device is the device node
representing the OSS input device, and is usually set to
`/dev/dsp`{.sample}.

For example to grab from `/dev/dsp`{.sample} using `ffmpeg` use the
command:

::: example
``` example
ffmpeg -f oss -i /dev/dsp /tmp/oss.wav
```
:::

For more information about OSS see:
<http://manuals.opensound.com/usersguide/dsp.html>

[]{#Options-108}

#### [26.15.1 Options](#toc-Options-108) {#options-108 .subsection}

`sample_rate`{.sample}

:   Set the sample rate in Hz. Default is 48000.

`channels`{.sample}

:   Set the number of channels. Default is 2.

[]{#pulse}

### [26.16 pulse](#toc-pulse) {#pulse .section}

PulseAudio input device.

To enable this output device you need to configure FFmpeg with
`--enable-libpulse`.

The filename to provide to the input device is a source device or the
string \"default\"

To list the PulseAudio source devices and their properties you can
invoke the command `pactl list sources`.

More information about PulseAudio can be found on
<http://www.pulseaudio.org>.

[]{#Options-109}

#### [26.16.1 Options](#toc-Options-109) {#options-109 .subsection}

`server`{.sample}

:   Connect to a specific PulseAudio server, specified by an IP address.
    Default server is used when not provided.

`name`{.sample}

:   Specify the application name PulseAudio will use when showing active
    clients, by default it is the `LIBAVFORMAT_IDENT` string.

`stream_name`{.sample}

:   Specify the stream name PulseAudio will use when showing active
    streams, by default it is \"record\".

`sample_rate`{.sample}

:   Specify the samplerate in Hz, by default 48kHz is used.

`channels`{.sample}

:   Specify the channels in use, by default 2 (stereo) is set.

`frame_size`{.sample}

:   This option does nothing and is deprecated.

`fragment_size`{.sample}

:   Specify the size in bytes of the minimal buffering fragment in
    PulseAudio, it will affect the audio latency. By default it is set
    to 50 ms amount of data.

`wallclock`{.sample}

:   Set the initial PTS using the current time. Default is 1.

[]{#Examples-37}

#### [26.16.2 Examples](#toc-Examples-37) {#examples-37 .subsection}

Record a stream from default device:

::: example
``` example
ffmpeg -f pulse -i default /tmp/pulse.wav
```
:::

[]{#sndio}

### [26.17 sndio](#toc-sndio) {#sndio .section}

sndio input device.

To enable this input device during configuration you need libsndio
installed on your system.

The filename to provide to the input device is the device node
representing the sndio input device, and is usually set to
`/dev/audio0`{.sample}.

For example to grab from `/dev/audio0`{.sample} using `ffmpeg` use the
command:

::: example
``` example
ffmpeg -f sndio -i /dev/audio0 /tmp/oss.wav
```
:::

[]{#Options-110}

#### [26.17.1 Options](#toc-Options-110) {#options-110 .subsection}

`sample_rate`{.sample}

:   Set the sample rate in Hz. Default is 48000.

`channels`{.sample}

:   Set the number of channels. Default is 2.

[]{#video4linux2_002c-v4l2}

### [26.18 video4linux2, v4l2](#toc-video4linux2_002c-v4l2) {#video4linux2-v4l2 .section}

Video4Linux2 input video device.

\"v4l2\" can be used as alias for \"video4linux2\".

If FFmpeg is built with v4l-utils support (by using the
`--enable-libv4l2` configure option), it is possible to use it with the
`-use_libv4l2` input device option.

The name of the device to grab is a file device node, usually Linux
systems tend to automatically create such nodes when the device (e.g. an
USB webcam) is plugged into the system, and has a name of the kind
`/dev/video`{.sample}`N`{.variable}, where `N`{.variable} is a number
associated to the device.

Video4Linux2 devices usually support a limited set of
`width`{.variable}x`height`{.variable} sizes and frame rates. You can
check which are supported using `-list_formats all` for Video4Linux2
devices. Some devices, like TV cards, support one or more standards. It
is possible to list all the supported standards using
`-list_standards all`.

The time base for the timestamps is 1 microsecond. Depending on the
kernel version and configuration, the timestamps may be derived from the
real time clock (origin at the Unix Epoch) or the monotonic clock
(origin usually at boot time, unaffected by NTP or manual changes to the
clock). The `-timestamps abs`{.sample} or `-ts abs`{.sample} option can
be used to force conversion into the real time clock.

Some usage examples of the video4linux2 device with `ffmpeg` and
`ffplay`:

- List supported formats for a video4linux2 device:

  ::: example
  ``` example
  ffplay -f video4linux2 -list_formats all /dev/video0
  ```
  :::
- Grab and show the input of a video4linux2 device:

  ::: example
  ``` example
  ffplay -f video4linux2 -framerate 30 -video_size hd720 /dev/video0
  ```
  :::
- Grab and record the input of a video4linux2 device, leave the frame
  rate and size as previously set:

  ::: example
  ``` example
  ffmpeg -f video4linux2 -input_format mjpeg -i /dev/video0 out.mpeg
  ```
  :::

For more information about Video4Linux, check <http://linuxtv.org/>.

[]{#Options-111}

#### [26.18.1 Options](#toc-Options-111) {#options-111 .subsection}

`standard`{.sample}

:   Set the standard. Must be the name of a supported standard. To get a
    list of the supported standards, use the `list_standards`{.sample}
    option.

`channel`{.sample}

:   Set the input channel number. Default to -1, which means using the
    previously selected channel.

`video_size`{.sample}

:   Set the video frame size. The argument must be a string in the form
    `WIDTH`{.variable}x`HEIGHT`{.variable} or a valid size abbreviation.

`pixel_format`{.sample}

:   Select the pixel format (only valid for raw video input).

`input_format`{.sample}

:   Set the preferred pixel format (for raw video) or a codec name. This
    option allows one to select the input format, when several are
    available.

`framerate`{.sample}

:   Set the preferred video frame rate.

`list_formats`{.sample}

:   List available formats (supported pixel formats, codecs, and frame
    sizes) and exit.

    Available values are:

    '`all`{.sample}'

    :   Show all available (compressed and non-compressed) formats.

    '`raw`{.sample}'

    :   Show only raw video (non-compressed) formats.

    '`compressed`{.sample}'

    :   Show only compressed formats.

`list_standards`{.sample}

:   List supported standards and exit.

    Available values are:

    '`all`{.sample}'

    :   Show all supported standards.

`timestamps, ts`{.sample}

:   Set type of timestamps for grabbed frames.

    Available values are:

    '`default`{.sample}'

    :   Use timestamps from the kernel.

    '`abs`{.sample}'

    :   Use absolute timestamps (wall clock).

    '`mono2abs`{.sample}'

    :   Force conversion from monotonic to absolute timestamps.

    Default value is `default`.

`use_libv4l2`{.sample}

:   Use libv4l2 (v4l-utils) conversion functions. Default is 0.

[]{#vfwcap}

### [26.19 vfwcap](#toc-vfwcap) {#vfwcap .section}

VfW (Video for Windows) capture input device.

The filename passed as input is the capture driver number, ranging from
0 to 9. You may use \"list\" as filename to print a list of drivers. Any
other filename will be interpreted as device number 0.

[]{#Options-112}

#### [26.19.1 Options](#toc-Options-112) {#options-112 .subsection}

`video_size`{.sample}

:   Set the video frame size.

`framerate`{.sample}

:   Set the grabbing frame rate. Default value is `ntsc`, corresponding
    to a frame rate of `30000/1001`.

[]{#x11grab}

### [26.20 x11grab](#toc-x11grab) {#x11grab .section}

X11 video input device.

To enable this input device during configuration you need libxcb
installed on your system. It will be automatically detected during
configuration.

This device allows one to capture a region of an X11 display.

The filename passed as input has the syntax:

::: example
``` example
[hostname]:display_number.screen_number[+x_offset,y_offset]
```
:::

`hostname`{.variable}:`display_number`{.variable}.`screen_number`{.variable}
specifies the X11 display name of the screen to grab from.
`hostname`{.variable} can be omitted, and defaults to \"localhost\". The
environment variable `DISPLAY` contains the default display name.

`x_offset`{.variable} and `y_offset`{.variable} specify the offsets of
the grabbed area with respect to the top-left border of the X11 screen.
They default to 0.

Check the X11 documentation (e.g. `man X`) for more detailed
information.

Use the `xdpyinfo` program for getting basic information about the
properties of your X11 display (e.g. grep for \"name\" or
\"dimensions\").

For example to grab from `:0.0`{.sample} using `ffmpeg`:

::: example
``` example
ffmpeg -f x11grab -framerate 25 -video_size cif -i :0.0 out.mpg
```
:::

Grab at position `10,20`:

::: example
``` example
ffmpeg -f x11grab -framerate 25 -video_size cif -i :0.0+10,20 out.mpg
```
:::

[]{#Options-113}

#### [26.20.1 Options](#toc-Options-113) {#options-113 .subsection}

`select_region`{.sample}

:   Specify whether to select the grabbing area graphically using the
    pointer. A value of `1` prompts the user to select the grabbing area
    graphically by clicking and dragging. A single click with no
    dragging will select the whole screen. A region with zero width or
    height will also select the whole screen. This option overwrites the
    `video_size`{.variable}, `grab_x`{.variable}, and
    `grab_y`{.variable} options. Default value is `0`.

`draw_mouse`{.sample}

:   Specify whether to draw the mouse pointer. A value of `0` specifies
    not to draw the pointer. Default value is `1`.

`follow_mouse`{.sample}

:   Make the grabbed area follow the mouse. The argument can be
    `centered` or a number of pixels `PIXELS`{.variable}.

    When it is specified with \"centered\", the grabbing region follows
    the mouse pointer and keeps the pointer at the center of region;
    otherwise, the region follows only when the mouse pointer reaches
    within `PIXELS`{.variable} (greater than zero) to the edge of
    region.

    For example:

    ::: example
    ``` example
    ffmpeg -f x11grab -follow_mouse centered -framerate 25 -video_size cif -i :0.0 out.mpg
    ```
    :::

    To follow only when the mouse pointer reaches within 100 pixels to
    edge:

    ::: example
    ``` example
    ffmpeg -f x11grab -follow_mouse 100 -framerate 25 -video_size cif -i :0.0 out.mpg
    ```
    :::

`framerate`{.sample}

:   Set the grabbing frame rate. Default value is `ntsc`, corresponding
    to a frame rate of `30000/1001`.

`show_region`{.sample}

:   Show grabbed region on screen.

    If `show_region`{.variable} is specified with `1`, then the grabbing
    region will be indicated on screen. With this option, it is easy to
    know what is being grabbed if only a portion of the screen is
    grabbed.

`region_border`{.sample}

:   Set the region border thickness if `-show_region 1`{.sample} is
    used. Range is 1 to 128 and default is 3 (XCB-based x11grab only).

    For example:

    ::: example
    ``` example
    ffmpeg -f x11grab -show_region 1 -framerate 25 -video_size cif -i :0.0+10,20 out.mpg
    ```
    :::

    With `follow_mouse`{.variable}:

    ::: example
    ``` example
    ffmpeg -f x11grab -follow_mouse centered -show_region 1 -framerate 25 -video_size cif -i :0.0 out.mpg
    ```
    :::

`window_id`{.sample}

:   Grab this window, instead of the whole screen. Default value is 0,
    which maps to the whole screen (root window).

    The id of a window can be found using the `xwininfo` program,
    possibly with options -tree and -root.

    If the window is later enlarged, the new area is not recorded. Video
    ends when the window is closed, unmapped (i.e., iconified) or shrunk
    beyond the video size (which defaults to the initial window size).

    This option disables options `follow_mouse`{.sample} and
    `select_region`{.sample}.

`video_size`{.sample}

:   Set the video frame size. Default is the full desktop or window.

`grab_x`{.sample}\
`grab_y`{.sample}

:   Set the grabbing region coordinates. They are expressed as offset
    from the top left corner of the X11 window and correspond to the
    `x_offset`{.variable} and `y_offset`{.variable} parameters in the
    device name. The default value for both options is 0.

[]{#Output-Devices}

## [27 Output Devices](#toc-Output-Devices) {#output-devices .chapter}

Output devices are configured elements in FFmpeg that can write
multimedia data to an output device attached to your system.

When you configure your FFmpeg build, all the supported output devices
are enabled by default. You can list all available ones using the
configure option \"--list-outdevs\".

You can disable all the output devices using the configure option
\"--disable-outdevs\", and selectively enable an output device using the
option \"--enable-outdev=`OUTDEV`{.variable}\", or you can disable a
particular input device using the option
\"--disable-outdev=`OUTDEV`{.variable}\".

The option \"-devices\" of the ff\* tools will display the list of
enabled output devices.

A description of the currently available output devices follows.

[]{#alsa-1}

### [27.1 alsa](#toc-alsa-1) {#alsa-1 .section}

ALSA (Advanced Linux Sound Architecture) output device.

[]{#Examples-38}

#### [27.1.1 Examples](#toc-Examples-38) {#examples-38 .subsection}

- Play a file on default ALSA device:

  ::: example
  ``` example
  ffmpeg -i INPUT -f alsa default
  ```
  :::
- Play a file on soundcard 1, audio device 7:

  ::: example
  ``` example
  ffmpeg -i INPUT -f alsa hw:1,7
  ```
  :::

[]{#AudioToolbox}

### [27.2 AudioToolbox](#toc-AudioToolbox) {#audiotoolbox .section}

AudioToolbox output device.

Allows native output to CoreAudio devices on OSX.

The output filename can be empty (or `-`) to refer to the default system
output device or a number that refers to the device index as shown
using: `-list_devices true`.

Alternatively, the audio input device can be chosen by index using the
` -audio_device_index <INDEX> `{.sample} , overriding any device name or
index given in the input filename.

All available devices can be enumerated by using
`-list_devices true`{.sample}, listing all device names, UIDs and
corresponding indices.

[]{#Options-114}

#### [27.2.1 Options](#toc-Options-114) {#options-114 .subsection}

AudioToolbox supports the following options:

`-audio_device_index <INDEX>`{.sample}

:   Specify the audio device by its index. Overrides anything given in
    the output filename.

[]{#Examples-39}

#### [27.2.2 Examples](#toc-Examples-39) {#examples-39 .subsection}

- Print the list of supported devices and output a sine wave to the
  default device:

  ::: example
  ``` example
  $ ffmpeg -f lavfi -i sine=r=44100 -f audiotoolbox -list_devices true -
  ```
  :::
- Output a sine wave to the device with the index 2, overriding any
  output filename:

  ::: example
  ``` example
  $ ffmpeg -f lavfi -i sine=r=44100 -f audiotoolbox -audio_device_index 2 -
  ```
  :::

[]{#caca}

### [27.3 caca](#toc-caca) {#caca .section}

CACA output device.

This output device allows one to show a video stream in CACA window.
Only one CACA window is allowed per application, so you can have only
one instance of this output device in an application.

To enable this output device you need to configure FFmpeg with
`--enable-libcaca`. libcaca is a graphics library that outputs text
instead of pixels.

For more information about libcaca, check:
<http://caca.zoy.org/wiki/libcaca>

[]{#Options-115}

#### [27.3.1 Options](#toc-Options-115) {#options-115 .subsection}

`window_title`{.sample}

:   Set the CACA window title, if not specified default to the filename
    specified for the output device.

`window_size`{.sample}

:   Set the CACA window size, can be a string of the form
    `width`{.variable}x`height`{.variable} or a video size abbreviation.
    If not specified it defaults to the size of the input video.

`driver`{.sample}

:   Set display driver.

`algorithm`{.sample}

:   Set dithering algorithm. Dithering is necessary because the picture
    being rendered has usually far more colours than the available
    palette. The accepted values are listed with
    `-list_dither algorithms`.

`antialias`{.sample}

:   Set antialias method. Antialiasing smoothens the rendered image and
    avoids the commonly seen staircase effect. The accepted values are
    listed with `-list_dither antialiases`.

`charset`{.sample}

:   Set which characters are going to be used when rendering text. The
    accepted values are listed with `-list_dither charsets`.

`color`{.sample}

:   Set color to be used when rendering text. The accepted values are
    listed with `-list_dither colors`.

`list_drivers`{.sample}

:   If set to `true`{.sample}, print a list of available drivers and
    exit.

`list_dither`{.sample}

:   List available dither options related to the argument. The argument
    must be one of `algorithms`, `antialiases`, `charsets`, `colors`.

[]{#Examples-40}

#### [27.3.2 Examples](#toc-Examples-40) {#examples-40 .subsection}

- The following command shows the `ffmpeg` output is an CACA window,
  forcing its size to 80x25:

  ::: example
  ``` example
  ffmpeg -i INPUT -c:v rawvideo -pix_fmt rgb24 -window_size 80x25 -f caca -
  ```
  :::
- Show the list of available drivers and exit:

  ::: example
  ``` example
  ffmpeg -i INPUT -pix_fmt rgb24 -f caca -list_drivers true -
  ```
  :::
- Show the list of available dither colors and exit:

  ::: example
  ``` example
  ffmpeg -i INPUT -pix_fmt rgb24 -f caca -list_dither colors -
  ```
  :::

[]{#decklink-1}

### [27.4 decklink](#toc-decklink-1) {#decklink-1 .section}

The decklink output device provides playback capabilities for Blackmagic
DeckLink devices.

To enable this output device, you need the Blackmagic DeckLink SDK and
you need to configure with the appropriate `--extra-cflags` and
`--extra-ldflags`. On Windows, you need to run the IDL files through
`widl`.

DeckLink is very picky about the formats it supports. Pixel format is
always uyvy422, framerate, field order and video size must be determined
for your device with `-list_formats 1`. Audio sample rate is always 48
kHz.

[]{#Options-116}

#### [27.4.1 Options](#toc-Options-116) {#options-116 .subsection}

`list_devices`{.sample}

:   If set to `true`{.sample}, print a list of devices and exit.
    Defaults to `false`{.sample}. This option is deprecated, please use
    the `-sinks` option of ffmpeg to list the available output devices.

`list_formats`{.sample}

:   If set to `true`{.sample}, print a list of supported formats and
    exit. Defaults to `false`{.sample}.

`preroll`{.sample}

:   Amount of time to preroll video in seconds. Defaults to
    `0.5`{.sample}.

`duplex_mode`{.sample}

:   Sets the decklink device duplex/profile mode. Must be
    '`unset`{.sample}', '`half`{.sample}', '`full`{.sample}',
    '`one_sub_device_full`{.sample}', '`one_sub_device_half`{.sample}',
    '`two_sub_device_full`{.sample}', '`four_sub_device_half`{.sample}'
    Defaults to '`unset`{.sample}'.

    Note: DeckLink SDK 11.0 have replaced the duplex property by a
    profile property. For the DeckLink Duo 2 and DeckLink Quad 2, a
    profile is shared between any 2 sub-devices that utilize the same
    connectors. For the DeckLink 8K Pro, a profile is shared between all
    4 sub-devices. So DeckLink 8K Pro support four profiles.

    Valid profile modes for DeckLink 8K Pro(with DeckLink SDK \>= 11.0):
    '`one_sub_device_full`{.sample}', '`one_sub_device_half`{.sample}',
    '`two_sub_device_full`{.sample}', '`four_sub_device_half`{.sample}'

    Valid profile modes for DeckLink Quad 2 and DeckLink Duo 2:
    '`half`{.sample}', '`full`{.sample}'

`timing_offset`{.sample}

:   Sets the genlock timing pixel offset on the used output. Defaults to
    '`unset`{.sample}'.

`link`{.sample}

:   Sets the SDI video link configuration on the used output. Must be
    '`unset`{.sample}', '`single`{.sample}' link SDI, '`dual`{.sample}'
    link SDI or '`quad`{.sample}' link SDI. Defaults to
    '`unset`{.sample}'.

`sqd`{.sample}

:   Enable Square Division Quad Split mode for Quad-link SDI output.
    Must be '`unset`{.sample}', '`true`{.sample}' or '`false`{.sample}'.
    Defaults to `unset`{.sample}.

`level_a`{.sample}

:   Enable SMPTE Level A mode on the used output. Must be
    '`unset`{.sample}', '`true`{.sample}' or '`false`{.sample}'.
    Defaults to `unset`{.sample}.

`vanc_queue_size`{.sample}

:   Sets maximum output buffer size in bytes for VANC data. If the
    buffering reaches this value, outgoing VANC data will be dropped.
    Defaults to '`1048576`{.sample}'.

[]{#Examples-41}

#### [27.4.2 Examples](#toc-Examples-41) {#examples-41 .subsection}

- List output devices:

  ::: example
  ``` example
  ffmpeg -sinks decklink
  ```
  :::
- List supported formats:

  ::: example
  ``` example
  ffmpeg -i test.avi -f decklink -list_formats 1 'DeckLink Mini Monitor'
  ```
  :::
- Play video clip:

  ::: example
  ``` example
  ffmpeg -i test.avi -f decklink -pix_fmt uyvy422 'DeckLink Mini Monitor'
  ```
  :::
- Play video clip with non-standard framerate or video size:

  ::: example
  ``` example
  ffmpeg -i test.avi -f decklink -pix_fmt uyvy422 -s 720x486 -r 24000/1001 'DeckLink Mini Monitor'
  ```
  :::

[]{#fbdev-1}

### [27.5 fbdev](#toc-fbdev-1) {#fbdev-1 .section}

Linux framebuffer output device.

The Linux framebuffer is a graphic hardware-independent abstraction
layer to show graphics on a computer monitor, typically on the console.
It is accessed through a file device node, usually `/dev/fb0`{.sample}.

For more detailed information read the file
`Documentation/fb/framebuffer.txt`{.sample} included in the Linux source
tree.

[]{#Options-117}

#### [27.5.1 Options](#toc-Options-117) {#options-117 .subsection}

`xoffset`{.sample}\
`yoffset`{.sample}

:   Set x/y coordinate of top left corner. Default is 0.

[]{#Examples-42}

#### [27.5.2 Examples](#toc-Examples-42) {#examples-42 .subsection}

Play a file on framebuffer device `/dev/fb0`{.sample}. Required pixel
format depends on current framebuffer settings.

::: example
``` example
ffmpeg -re -i INPUT -c:v rawvideo -pix_fmt bgra -f fbdev /dev/fb0
```
:::

See also <http://linux-fbdev.sourceforge.net/>, and fbset(1).

[]{#oss-1}

### [27.6 oss](#toc-oss-1) {#oss-1 .section}

OSS (Open Sound System) output device.

[]{#pulse-1}

### [27.7 pulse](#toc-pulse-1) {#pulse-1 .section}

PulseAudio output device.

To enable this output device you need to configure FFmpeg with
`--enable-libpulse`.

More information about PulseAudio can be found on
<http://www.pulseaudio.org>

[]{#Options-118}

#### [27.7.1 Options](#toc-Options-118) {#options-118 .subsection}

`server`{.sample}

:   Connect to a specific PulseAudio server, specified by an IP address.
    Default server is used when not provided.

`name`{.sample}

:   Specify the application name PulseAudio will use when showing active
    clients, by default it is the `LIBAVFORMAT_IDENT` string.

`stream_name`{.sample}

:   Specify the stream name PulseAudio will use when showing active
    streams, by default it is set to the specified output name.

`device`{.sample}

:   Specify the device to use. Default device is used when not provided.
    List of output devices can be obtained with command
    `pactl list sinks`.

`buffer_size`{.sample}\
`buffer_duration`{.sample}

:   Control the size and duration of the PulseAudio buffer. A small
    buffer gives more control, but requires more frequent updates.

    `buffer_size`{.sample} specifies size in bytes while
    `buffer_duration`{.sample} specifies duration in milliseconds.

    When both options are provided then the highest value is used
    (duration is recalculated to bytes using stream parameters). If they
    are set to 0 (which is default), the device will use the default
    PulseAudio duration value. By default PulseAudio set buffer duration
    to around 2 seconds.

`prebuf`{.sample}

:   Specify pre-buffering size in bytes. The server does not start with
    playback before at least `prebuf`{.sample} bytes are available in
    the buffer. By default this option is initialized to the same value
    as `buffer_size`{.sample} or `buffer_duration`{.sample} (whichever
    is bigger).

`minreq`{.sample}

:   Specify minimum request size in bytes. The server does not request
    less than `minreq`{.sample} bytes from the client, instead waits
    until the buffer is free enough to request more bytes at once. It is
    recommended to not set this option, which will initialize this to a
    value that is deemed sensible by the server.

[]{#Examples-43}

#### [27.7.2 Examples](#toc-Examples-43) {#examples-43 .subsection}

Play a file on default device on default server:

::: example
``` example
ffmpeg  -i INPUT -f pulse "stream name"
```
:::

[]{#sndio-1}

### [27.8 sndio](#toc-sndio-1) {#sndio-1 .section}

sndio audio output device.

[]{#v4l2}

### [27.9 v4l2](#toc-v4l2) {#v4l2 .section}

Video4Linux2 output device.

[]{#xv}

### [27.10 xv](#toc-xv) {#xv .section}

XV (XVideo) output device.

This output device allows one to show a video stream in a X Window
System window.

[]{#Options-119}

#### [27.10.1 Options](#toc-Options-119) {#options-119 .subsection}

`display_name`{.sample}

:   Specify the hardware display name, which determines the display and
    communications domain to be used.

    The display name or DISPLAY environment variable can be a string in
    the format
    `hostname`{.variable}\[:`number`{.variable}\[.`screen_number`{.variable}\]\].

    `hostname`{.variable} specifies the name of the host machine on
    which the display is physically attached. `number`{.variable}
    specifies the number of the display server on that host machine.
    `screen_number`{.variable} specifies the screen to be used on that
    server.

    If unspecified, it defaults to the value of the DISPLAY environment
    variable.

    For example, `dual-headed:0.1` would specify screen 1 of display 0
    on the machine named "dual-headed".

    Check the X11 specification for more detailed information about the
    display name format.

`window_id`{.sample}

:   When set to non-zero value then device doesn't create new window,
    but uses existing one with provided `window_id`{.variable}. By
    default this options is set to zero and device creates its own
    window.

`window_size`{.sample}

:   Set the created window size, can be a string of the form
    `width`{.variable}x`height`{.variable} or a video size abbreviation.
    If not specified it defaults to the size of the input video. Ignored
    when `window_id`{.variable} is set.

`window_x`{.sample}\
`window_y`{.sample}

:   Set the X and Y window offsets for the created window. They are both
    set to 0 by default. The values may be ignored by the window
    manager. Ignored when `window_id`{.variable} is set.

`window_title`{.sample}

:   Set the window title, if not specified default to the filename
    specified for the output device. Ignored when `window_id`{.variable}
    is set.

For more information about XVideo see <http://www.x.org/>.

[]{#Examples-44}

#### [27.10.2 Examples](#toc-Examples-44) {#examples-44 .subsection}

- Decode, display and encode video input with `ffmpeg` at the same time:

  ::: example
  ``` example
  ffmpeg -i INPUT OUTPUT -f xv display
  ```
  :::
- Decode and display the input video to multiple X11 windows:

  ::: example
  ``` example
  ffmpeg -i INPUT -f xv normal -vf negate -f xv negated
  ```
  :::

[]{#Resampler-Options}

## [28 Resampler Options](#toc-Resampler-Options) {#resampler-options .chapter}

The audio resampler supports the following named options.

Options may be set by specifying -`option`{.variable} `value`{.variable}
in the FFmpeg tools, `option`{.variable}=`value`{.variable} for the
aresample filter, by setting the value explicitly in the `SwrContext`
options or using the `libavutil/opt.h`{.sample} API for programmatic
use.

`uchl, used_chlayout`{.sample}

:   Set used input channel layout. Default is unset. This option is only
    used for special remapping.

`isr, in_sample_rate`{.sample}

:   Set the input sample rate. Default value is 0.

`osr, out_sample_rate`{.sample}

:   Set the output sample rate. Default value is 0.

`isf, in_sample_fmt`{.sample}

:   Specify the input sample format. It is set by default to `none`.

`osf, out_sample_fmt`{.sample}

:   Specify the output sample format. It is set by default to `none`.

`tsf, internal_sample_fmt`{.sample}

:   Set the internal sample format. Default value is `none`. This will
    automatically be chosen when it is not explicitly set.

`ichl, in_chlayout`{.sample}\
`ochl, out_chlayout`{.sample}

:   Set the input/output channel layout.

    See [(ffmpeg-utils)the Channel Layout section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#channel-layout-syntax) for the required
    syntax.

`clev, center_mix_level`{.sample}

:   Set the center mix level. It is a value expressed in deciBel, and
    must be in the interval \[-32,32\].

`slev, surround_mix_level`{.sample}

:   Set the surround mix level. It is a value expressed in deciBel, and
    must be in the interval \[-32,32\].

`lfe_mix_level`{.sample}

:   Set LFE mix into non LFE level. It is used when there is a LFE input
    but no LFE output. It is a value expressed in deciBel, and must be
    in the interval \[-32,32\].

`rmvol, rematrix_volume`{.sample}

:   Set rematrix volume. Default value is 1.0.

`rematrix_maxval`{.sample}

:   Set maximum output value for rematrixing. This can be used to
    prevent clipping vs. preventing volume reduction. A value of 1.0
    prevents clipping.

`flags, swr_flags`{.sample}

:   Set flags used by the converter. Default value is 0.

    It supports the following individual flags:

    `res`{.sample}

    :   force resampling, this flag forces resampling to be used even
        when the input and output sample rates match.

`dither_scale`{.sample}

:   Set the dither scale. Default value is 1.

`dither_method`{.sample}

:   Set dither method. Default value is 0.

    Supported values:

    '`rectangular`{.sample}'

    :   select rectangular dither

    '`triangular`{.sample}'

    :   select triangular dither

    '`triangular_hp`{.sample}'

    :   select triangular dither with high pass

    '`lipshitz`{.sample}'

    :   select Lipshitz noise shaping dither.

    '`shibata`{.sample}'

    :   select Shibata noise shaping dither.

    '`low_shibata`{.sample}'

    :   select low Shibata noise shaping dither.

    '`high_shibata`{.sample}'

    :   select high Shibata noise shaping dither.

    '`f_weighted`{.sample}'

    :   select f-weighted noise shaping dither

    '`modified_e_weighted`{.sample}'

    :   select modified-e-weighted noise shaping dither

    '`improved_e_weighted`{.sample}'

    :   select improved-e-weighted noise shaping dither

`resampler`{.sample}

:   Set resampling engine. Default value is swr.

    Supported values:

    '`swr`{.sample}'

    :   select the native SW Resampler; filter options precision and
        cheby are not applicable in this case.

    '`soxr`{.sample}'

    :   select the SoX Resampler (where available); compensation, and
        filter options filter_size, phase_shift, exact_rational,
        filter_type & kaiser_beta, are not applicable in this case.

`filter_size`{.sample}

:   For swr only, set resampling filter size, default value is 32.

`phase_shift`{.sample}

:   For swr only, set resampling phase shift, default value is 10, and
    must be in the interval \[0,30\].

`linear_interp`{.sample}

:   Use linear interpolation when enabled (the default). Disable it if
    you want to preserve speed instead of quality when exact_rational
    fails.

`exact_rational`{.sample}

:   For swr only, when enabled, try to use exact phase_count based on
    input and output sample rate. However, if it is larger than
    `1 << phase_shift`, the phase_count will be `1 << phase_shift` as
    fallback. Default is enabled.

`cutoff`{.sample}

:   Set cutoff frequency (swr: 6dB point; soxr: 0dB point) ratio; must
    be a float value between 0 and 1. Default value is 0.97 with swr,
    and 0.91 with soxr (which, with a sample-rate of 44100, preserves
    the entire audio band to 20kHz).

`precision`{.sample}

:   For soxr only, the precision in bits to which the resampled signal
    will be calculated. The default value of 20 (which, with suitable
    dithering, is appropriate for a destination bit-depth of 16) gives
    SoX's 'High Quality'; a value of 28 gives SoX's 'Very High Quality'.

`cheby`{.sample}

:   For soxr only, selects passband rolloff none (Chebyshev) &
    higher-precision approximation for 'irrational' ratios. Default
    value is 0.

`async`{.sample}

:   For swr only, simple 1 parameter audio sync to timestamps using
    stretching, squeezing, filling and trimming. Setting this to 1 will
    enable filling and trimming, larger values represent the maximum
    amount in samples that the data may be stretched or squeezed for
    each second. Default value is 0, thus no compensation is applied to
    make the samples match the audio timestamps.

`first_pts`{.sample}

:   For swr only, assume the first pts should be this value. The time
    unit is 1 / sample rate. This allows for padding/trimming at the
    start of stream. By default, no assumption is made about the first
    frame's expected pts, so no padding or trimming is done. For
    example, this could be set to 0 to pad the beginning with silence if
    an audio stream starts after the video stream or to trim any samples
    with a negative pts due to encoder delay.

`min_comp`{.sample}

:   For swr only, set the minimum difference between timestamps and
    audio data (in seconds) to trigger stretching/squeezing/filling or
    trimming of the data to make it match the timestamps. The default is
    that stretching/squeezing/filling and trimming is disabled
    (`min_comp`{.sample} = `FLT_MAX`).

`min_hard_comp`{.sample}

:   For swr only, set the minimum difference between timestamps and
    audio data (in seconds) to trigger adding/dropping samples to make
    it match the timestamps. This option effectively is a threshold to
    select between hard (trim/fill) and soft (squeeze/stretch)
    compensation. Note that all compensation is by default disabled
    through `min_comp`{.sample}. The default is 0.1.

`comp_duration`{.sample}

:   For swr only, set duration (in seconds) over which data is
    stretched/squeezed to make it match the timestamps. Must be a
    non-negative double float value, default value is 1.0.

`max_soft_comp`{.sample}

:   For swr only, set maximum factor by which data is stretched/squeezed
    to make it match the timestamps. Must be a non-negative double float
    value, default value is 0.

`matrix_encoding`{.sample}

:   Select matrixed stereo encoding.

    It accepts the following values:

    '`none`{.sample}'

    :   select none

    '`dolby`{.sample}'

    :   select Dolby

    '`dplii`{.sample}'

    :   select Dolby Pro Logic II

    Default value is `none`.

`filter_type`{.sample}

:   For swr only, select resampling filter type. This only affects
    resampling operations.

    It accepts the following values:

    '`cubic`{.sample}'

    :   select cubic

    '`blackman_nuttall`{.sample}'

    :   select Blackman Nuttall windowed sinc

    '`kaiser`{.sample}'

    :   select Kaiser windowed sinc

`kaiser_beta`{.sample}

:   For swr only, set Kaiser window beta value. Must be a double float
    value in the interval \[2,16\], default value is 9.

`output_sample_bits`{.sample}

:   For swr only, set number of used output sample bits for dithering.
    Must be an integer in the interval \[0,64\], default value is 0,
    which means it's not used.

[]{#scaler_005foptions}[]{#Scaler-Options}

## [29 Scaler Options](#toc-Scaler-Options) {#scaler-options .chapter}

The video scaler supports the following named options.

Options may be set by specifying -`option`{.variable} `value`{.variable}
in the FFmpeg tools, with a few API-only exceptions noted below. For
programmatic use, they can be set explicitly in the `SwsContext` options
or through the `libavutil/opt.h`{.sample} API.

[]{#sws_005fflags}

`sws_flags`{.sample}

Set the scaler flags. This is also used to set the scaling algorithm.
Only a single algorithm should be selected. Default value is
'`bicubic`{.sample}'.

It accepts the following values:

'`fast_bilinear`{.sample}'

:   Select fast bilinear scaling algorithm.

'`bilinear`{.sample}'

:   Select bilinear scaling algorithm.

'`bicubic`{.sample}'

:   Select bicubic scaling algorithm.

'`experimental`{.sample}'

:   Select experimental scaling algorithm.

'`neighbor`{.sample}'

:   Select nearest neighbor rescaling algorithm.

'`area`{.sample}'

:   Select averaging area rescaling algorithm.

'`bicublin`{.sample}'

:   Select bicubic scaling algorithm for the luma component, bilinear
    for chroma components.

'`gauss`{.sample}'

:   Select Gaussian rescaling algorithm.

'`sinc`{.sample}'

:   Select sinc rescaling algorithm.

'`lanczos`{.sample}'

:   Select Lanczos rescaling algorithm. The default width (alpha) is 3
    and can be changed by setting `param0`.

'`spline`{.sample}'

:   Select natural bicubic spline rescaling algorithm.

'`print_info`{.sample}'

:   Enable printing/debug logging.

'`accurate_rnd`{.sample}'

:   Enable accurate rounding.

'`full_chroma_int`{.sample}'

:   Enable full chroma interpolation.

'`full_chroma_inp`{.sample}'

:   Select full chroma input.

'`bitexact`{.sample}'

:   Enable bitexact output.

'`unstable`{.sample}'

:   Allow the use of experimental new code. May subtly affect the output
    or even produce wrong results. For testing only.

`srcw `{.sample}`(API only)`{.variable}

Set source width.

`srch `{.sample}`(API only)`{.variable}

Set source height.

`dstw `{.sample}`(API only)`{.variable}

Set destination width.

`dsth `{.sample}`(API only)`{.variable}

Set destination height.

`src_format `{.sample}`(API only)`{.variable}

Set source pixel format (must be expressed as an integer).

`dst_format `{.sample}`(API only)`{.variable}

Set destination pixel format (must be expressed as an integer).

`src_range `{.sample}`(boolean)`{.variable}

If value is set to `1`, indicates source is full range. Default value is
`0`, which indicates source is limited range.

`dst_range `{.sample}`(boolean)`{.variable}

If value is set to `1`, enable full range for destination. Default value
is `0`, which enables limited range.

`gamma `{.sample}`(boolean)`{.variable}

If value is set to `1`, enable gamma correct scaling. Default value is
`0`.

[]{#sws_005fparams}

`param0, param1`{.sample}

Set scaling algorithm parameters. The specified values are specific of
some scaling algorithms and ignored by others. The specified values are
floating point number values.

`sws_dither`{.sample}

Set the dithering algorithm. Accepts one of the following values.
Default value is '`auto`{.sample}'.

'`auto`{.sample}'

:   automatic choice

'`none`{.sample}'

:   no dithering

'`bayer`{.sample}'

:   bayer dither

'`ed`{.sample}'

:   error diffusion dither

'`a_dither`{.sample}'

:   arithmetic dither, based using addition

'`x_dither`{.sample}'

:   arithmetic dither, based using xor (more random/less apparent
    patterning that a_dither).

`alphablend`{.sample}

Set the alpha blending to use when the input has alpha but the output
does not. Default value is '`none`{.sample}'.

'`uniform_color`{.sample}'

:   Blend onto a uniform background color

'`checkerboard`{.sample}'

:   Blend onto a checkerboard

'`none`{.sample}'

:   No blending

[]{#Filtering-Introduction}

## [30 Filtering Introduction](#toc-Filtering-Introduction) {#filtering-introduction .chapter}

Filtering in FFmpeg is enabled through the libavfilter library.

In libavfilter, a filter can have multiple inputs and multiple outputs.
To illustrate the sorts of things that are possible, we consider the
following filtergraph.

``` verbatim
                [main]
input --> split ---------------------> overlay --> output
            |                             ^
            |[tmp]                  [flip]|
            +-----> crop --> vflip -------+
```

This filtergraph splits the input stream in two streams, then sends one
stream through the crop filter and the vflip filter, before merging it
back with the other stream by overlaying it on top. You can use the
following command to achieve this:

::: example
``` example
ffmpeg -i INPUT -vf "split [main][tmp]; [tmp] crop=iw:ih/2:0:0, vflip [flip]; [main][flip] overlay=0:H/2" OUTPUT
```
:::

The result will be that the top half of the video is mirrored onto the
bottom half of the output video.

Filters in the same linear chain are separated by commas, and distinct
linear chains of filters are separated by semicolons. In our example,
`crop,vflip`{.variable} are in one linear chain, `split`{.variable} and
`overlay`{.variable} are separately in another. The points where the
linear chains join are labelled by names enclosed in square brackets. In
the example, the split filter generates two outputs that are associated
to the labels `[main]`{.variable} and `[tmp]`{.variable}.

The stream sent to the second output of `split`{.variable}, labelled as
`[tmp]`{.variable}, is processed through the `crop`{.variable} filter,
which crops away the lower half part of the video, and then vertically
flipped. The `overlay`{.variable} filter takes in input the first
unchanged output of the split filter (which was labelled as
`[main]`{.variable}), and overlay on its lower half the output generated
by the `crop,vflip`{.variable} filterchain.

Some filters take in input a list of parameters: they are specified
after the filter name and an equal sign, and are separated from each
other by a colon.

There exist so-called `source filters`{.variable} that do not have an
audio/video input, and `sink filters`{.variable} that will not have
audio/video output.

[]{#graph2dot}

## [31 graph2dot](#toc-graph2dot) {#graph2dot .chapter}

The `graph2dot`{.sample} program included in the FFmpeg `tools`{.sample}
directory can be used to parse a filtergraph description and issue a
corresponding textual representation in the dot language.

Invoke the command:

::: example
``` example
graph2dot -h
```
:::

to see how to use `graph2dot`{.sample}.

You can then pass the dot description to the `dot`{.sample} program
(from the graphviz suite of programs) and obtain a graphical
representation of the filtergraph.

For example the sequence of commands:

::: example
``` example
echo GRAPH_DESCRIPTION | \
tools/graph2dot -o graph.tmp && \
dot -Tpng graph.tmp -o graph.png && \
display graph.png
```
:::

can be used to create and display an image representing the graph
described by the `GRAPH_DESCRIPTION`{.variable} string. Note that this
string must be a complete self-contained graph, with its inputs and
outputs explicitly defined. For example if your command line is of the
form:

::: example
``` example
ffmpeg -i infile -vf scale=640:360 outfile
```
:::

your `GRAPH_DESCRIPTION`{.variable} string will need to be of the form:

::: example
``` example
nullsrc,scale=640:360,nullsink
```
:::

you may also need to set the `nullsrc`{.variable} parameters and add a
`format`{.variable} filter in order to simulate a specific input file.

[]{#Filtergraph-description}

## [32 Filtergraph description](#toc-Filtergraph-description) {#filtergraph-description .chapter}

A filtergraph is a directed graph of connected filters. It can contain
cycles, and there can be multiple links between a pair of filters. Each
link has one input pad on one side connecting it to one filter from
which it takes its input, and one output pad on the other side
connecting it to one filter accepting its output.

Each filter in a filtergraph is an instance of a filter class registered
in the application, which defines the features and the number of input
and output pads of the filter.

A filter with no input pads is called a \"source\", and a filter with no
output pads is called a \"sink\".

[]{#Filtergraph-syntax}[]{#Filtergraph-syntax-1}

### [32.1 Filtergraph syntax](#toc-Filtergraph-syntax-1) {#filtergraph-syntax .section}

A filtergraph has a textual representation, which is recognized by the
`-filter`{.sample}/`-vf`{.sample}/`-af`{.sample} and
`-filter_complex`{.sample} options in `ffmpeg` and
`-vf`{.sample}/`-af`{.sample} in `ffplay`, and by the
`avfilter_graph_parse_ptr()` function defined in
`libavfilter/avfilter.h`{.sample}.

A filterchain consists of a sequence of connected filters, each one
connected to the previous one in the sequence. A filterchain is
represented by a list of \",\"-separated filter descriptions.

A filtergraph consists of a sequence of filterchains. A sequence of
filterchains is represented by a list of \";\"-separated filterchain
descriptions.

A filter is represented by a string of the form:
\[`in_link_1`{.variable}\]\...\[`in_link_N`{.variable}\]`filter_name`{.variable}@`id`{.variable}=`arguments`{.variable}\[`out_link_1`{.variable}\]\...\[`out_link_M`{.variable}\]

`filter_name`{.variable} is the name of the filter class of which the
described filter is an instance of, and has to be the name of one of the
filter classes registered in the program optionally followed by
\"@`id`{.variable}\". The name of the filter class is optionally
followed by a string \"=`arguments`{.variable}\".

`arguments`{.variable} is a string which contains the parameters used to
initialize the filter instance. It may have one of two forms:

- A ':'-separated list of `key=value`{.variable} pairs.
- A ':'-separated list of `value`{.variable}. In this case, the keys are
  assumed to be the option names in the order they are declared. E.g.
  the `fade` filter declares three options in this order --
  `type`{.sample}, `start_frame`{.sample} and `nb_frames`{.sample}. Then
  the parameter list `in:0:30`{.variable} means that the value
  `in`{.variable} is assigned to the option `type`{.sample},
  `0`{.variable} to `start_frame`{.sample} and `30`{.variable} to
  `nb_frames`{.sample}.
- A ':'-separated list of mixed direct `value`{.variable} and long
  `key=value`{.variable} pairs. The direct `value`{.variable} must
  precede the `key=value`{.variable} pairs, and follow the same
  constraints order of the previous point. The following
  `key=value`{.variable} pairs can be set in any preferred order.

If the option value itself is a list of items (e.g. the `format` filter
takes a list of pixel formats), the items in the list are usually
separated by '`|`{.sample}'.

The list of arguments can be quoted using the character '`'`{.sample}'
as initial and ending mark, and the character '`\`{.sample}' for
escaping the characters within the quoted text; otherwise the argument
string is considered terminated when the next special character
(belonging to the set '`[]=;,`{.sample}') is encountered.

A special syntax implemented in the `ffmpeg` CLI tool allows loading
option values from files. This is done be prepending a slash '/' to the
option name, then the supplied value is interpreted as a path from which
the actual value is loaded. E.g.

::: example
``` example
ffmpeg -i <INPUT> -vf drawtext=/text=/tmp/some_text <OUTPUT>
```
:::

will load the text to be drawn from `/tmp/some_text`{.sample}. API users
wishing to implement a similar feature should use the
`avfilter_graph_segment_*()` functions together with custom IO code.

The name and arguments of the filter are optionally preceded and
followed by a list of link labels. A link label allows one to name a
link and associate it to a filter output or input pad. The preceding
labels `in_link_1`{.variable} \... `in_link_N`{.variable}, are
associated to the filter input pads, the following labels
`out_link_1`{.variable} \... `out_link_M`{.variable}, are associated to
the output pads.

When two link labels with the same name are found in the filtergraph, a
link between the corresponding input and output pad is created.

If an output pad is not labelled, it is linked by default to the first
unlabelled input pad of the next filter in the filterchain. For example
in the filterchain

::: example
``` example
nullsrc, split[L1], [L2]overlay, nullsink
```
:::

the split filter instance has two output pads, and the overlay filter
instance two input pads. The first output pad of split is labelled
\"L1\", the first input pad of overlay is labelled \"L2\", and the
second output pad of split is linked to the second input pad of overlay,
which are both unlabelled.

In a filter description, if the input label of the first filter is not
specified, \"in\" is assumed; if the output label of the last filter is
not specified, \"out\" is assumed.

In a complete filterchain all the unlabelled filter input and output
pads must be connected. A filtergraph is considered valid if all the
filter input and output pads of all the filterchains are connected.

Leading and trailing whitespaces (space, tabs, or line feeds) separating
tokens in the filtergraph specification are ignored. This means that the
filtergraph can be expressed using empty lines and spaces to improve
readability.

For example, the filtergraph:

::: example
``` example
testsrc,split[L1],hflip[L2];[L1][L2] hstack
```
:::

can be represented as:

::: example
``` example
testsrc,
split [L1], hflip [L2];

[L1][L2] hstack
```
:::

Libavfilter will automatically insert [scale](#scale) filters where
format conversion is required. It is possible to specify swscale flags
for those automatically inserted scalers by prepending
`sws_flags=``flags`{.variable}`;` to the filtergraph description.

Here is a BNF description of the filtergraph syntax:

::: example
``` example
NAME             ::= sequence of alphanumeric characters and '_'
FILTER_NAME      ::= NAME["@"NAME]
LINKLABEL        ::= "[" NAME "]"
LINKLABELS       ::= LINKLABEL [LINKLABELS]
FILTER_ARGUMENTS ::= sequence of chars (possibly quoted)
FILTER           ::= [LINKLABELS] FILTER_NAME ["=" FILTER_ARGUMENTS] [LINKLABELS]
FILTERCHAIN      ::= FILTER [,FILTERCHAIN]
FILTERGRAPH      ::= [sws_flags=flags;] FILTERCHAIN [;FILTERGRAPH]
```
:::

[]{#filtergraph-escaping}[]{#Notes-on-filtergraph-escaping}

### [32.2 Notes on filtergraph escaping](#toc-Notes-on-filtergraph-escaping) {#notes-on-filtergraph-escaping .section}

Filtergraph description composition entails several levels of escaping.
See [(ffmpeg-utils)the \"Quoting and escaping\" section in the
ffmpeg-utils(1) manual](ffmpeg-utils.html#quoting_005fand_005fescaping)
for more information about the employed escaping procedure.

A first level escaping affects the content of each filter option value,
which may contain the special character `:` used to separate values, or
one of the escaping characters `\'`.

A second level escaping affects the whole filter description, which may
contain the escaping characters `\'` or the special characters `[],;`
used by the filtergraph description.

Finally, when you specify a filtergraph on a shell commandline, you need
to perform a third level escaping for the shell special characters
contained within it.

For example, consider the following string to be embedded in the
[drawtext](#drawtext) filter description `text`{.sample} value:

::: example
``` example
this is a 'string': may contain one, or more, special characters
```
:::

This string contains the `'` special escaping character, and the `:`
special character, so it needs to be escaped in this way:

::: example
``` example
text=this is a \'string\'\: may contain one, or more, special characters
```
:::

A second level of escaping is required when embedding the filter
description in a filtergraph description, in order to escape all the
filtergraph special characters. Thus the example above becomes:

::: example
``` example
drawtext=text=this is a \\\'string\\\'\\: may contain one\, or more\, special characters
```
:::

(note that in addition to the `\'` escaping special characters, also `,`
needs to be escaped).

Finally an additional level of escaping is needed when writing the
filtergraph description in a shell command, which depends on the
escaping rules of the adopted shell. For example, assuming that `\` is
special and needs to be escaped with another `\`, the previous string
will finally result in:

::: example
``` example
-vf "drawtext=text=this is a \\\\\\'string\\\\\\'\\\\: may contain one\\, or more\\, special characters"
```
:::

In order to avoid cumbersome escaping when using a commandline tool
accepting a filter specification as input, it is advisable to avoid
direct inclusion of the filter or options specification in the shell.

For example, in case of the [drawtext filter](#drawtext), you might
prefer to use the `textfile`{.sample} option in place of `text`{.sample}
to specify the text to render.

[]{#Timeline-editing}

## [33 Timeline editing](#toc-Timeline-editing) {#timeline-editing .chapter}

Some filters support a generic `enable`{.sample} option. For the filters
supporting timeline editing, this option can be set to an expression
which is evaluated before sending a frame to the filter. If the
evaluation is non-zero, the filter will be enabled, otherwise the frame
will be sent unchanged to the next filter in the filtergraph.

The expression accepts the following values:

'`t`{.sample}'

:   timestamp expressed in seconds, NAN if the input timestamp is
    unknown

'`n`{.sample}'

:   sequential number of the input frame, starting from 0

'`pos`{.sample}'

:   the position in the file of the input frame, NAN if unknown;
    deprecated, do not use

'`w`{.sample}'\
'`h`{.sample}'

:   width and height of the input frame if video

Additionally, these filters support an `enable`{.sample} command that
can be used to re-define the expression.

Like any other filtering option, the `enable`{.sample} option follows
the same rules.

For example, to enable a blur filter ([smartblur](#smartblur)) from 10
seconds to 3 minutes, and a [curves](#curves) filter starting at 3
seconds:

::: example
``` example
smartblur = enable='between(t,10,3*60)',
curves    = enable='gte(t,3)' : preset=cross_process
```
:::

See `ffmpeg -filters` to view which filters have timeline support.

[]{#commands}[]{#Changing-options-at-runtime-with-a-command}

## [34 Changing options at runtime with a command](#toc-Changing-options-at-runtime-with-a-command) {#changing-options-at-runtime-with-a-command .chapter}

Some options can be changed during the operation of the filter using a
command. These options are marked 'T' on the output of `ffmpeg`
`-h filter=<name of filter>`{.sample}. The name of the command is the
name of the option and the argument is the new value.

[]{#framesync}[]{#Options-for-filters-with-several-inputs-_0028framesync_0029}

## [35 Options for filters with several inputs (framesync)](#toc-Options-for-filters-with-several-inputs-_0028framesync_0029) {#options-for-filters-with-several-inputs-framesync .chapter}

Some filters with several inputs support a common set of options. These
options can only be set by name, not with the short notation.

`eof_action`{.sample}

:   The action to take when EOF is encountered on the secondary input;
    it accepts one of the following values:

    `repeat`{.sample}

    :   Repeat the last frame (the default).

    `endall`{.sample}

    :   End both streams.

    `pass`{.sample}

    :   Pass the main input through.

`shortest`{.sample}

:   If set to 1, force the output to terminate when the shortest input
    terminates. Default value is 0.

`repeatlast`{.sample}

:   If set to 1, force the filter to extend the last frame of secondary
    streams until the end of the primary stream. A value of 0 disables
    this behavior. Default value is 1.

`ts_sync_mode`{.sample}

:   How strictly to sync streams based on secondary input timestamps; it
    accepts one of the following values:

    `default`{.sample}

    :   Frame from secondary input with the nearest lower or equal
        timestamp to the primary input frame.

    `nearest`{.sample}

    :   Frame from secondary input with the absolute nearest timestamp
        to the primary input frame.

[]{#Audio-Filters}

## [36 Audio Filters](#toc-Audio-Filters) {#audio-filters .chapter}

When you configure your FFmpeg build, you can disable any of the
existing filters using `--disable-filters`. The configure output will
show the audio filters included in your build.

Below is a description of the currently available audio filters.

[]{#aap}

### [36.1 aap](#toc-aap) {#aap .section}

Apply Affine Projection algorithm to the first audio stream using the
second audio stream.

This adaptive filter is used to estimate unknown audio based on multiple
input audio samples. Affine projection algorithm can make trade-offs
between computation complexity with convergence speed.

A description of the accepted options follows.

`order`{.sample}

:   Set the filter order.

`projection`{.sample}

:   Set the projection order.

`mu`{.sample}

:   Set the filter mu.

`delta`{.sample}

:   Set the coefficient to initialize internal covariance matrix.

`out_mode`{.sample}

:   Set the filter output samples. It accepts the following values:

    `i`{.sample}

    :   Pass the 1st input.

    `d`{.sample}

    :   Pass the 2nd input.

    `o`{.sample}

    :   Pass difference between desired, 2nd input and error signal
        estimate.

    `n`{.sample}

    :   Pass difference between input, 1st input and error signal
        estimate.

    `e`{.sample}

    :   Pass error signal estimated samples.

        Default value is `o`{.variable}.

`precision`{.sample}

:   Set which precision to use when processing samples.

    `auto`{.sample}

    :   Auto pick internal sample format depending on other filters.

    `float`{.sample}

    :   Always use single-floating point precision sample format.

    `double`{.sample}

    :   Always use double-floating point precision sample format.

[]{#acompressor}

### [36.2 acompressor](#toc-acompressor) {#acompressor .section}

A compressor is mainly used to reduce the dynamic range of a signal.
Especially modern music is mostly compressed at a high ratio to improve
the overall loudness. It's done to get the highest attention of a
listener, \"fatten\" the sound and bring more \"power\" to the track. If
a signal is compressed too much it may sound dull or \"dead\" afterwards
or it may start to \"pump\" (which could be a powerful effect but can
also destroy a track completely). The right compression is the key to
reach a professional sound and is the high art of mixing and mastering.
Because of its complex settings it may take a long time to get the right
feeling for this kind of effect.

Compression is done by detecting the volume above a chosen level
`threshold` and dividing it by the factor set with `ratio`. So if you
set the threshold to -12dB and your signal reaches -6dB a ratio of 2:1
will result in a signal at -9dB. Because an exact manipulation of the
signal would cause distortion of the waveform the reduction can be
levelled over the time. This is done by setting \"Attack\" and
\"Release\". `attack` determines how long the signal has to rise above
the threshold before any reduction will occur and `release` sets the
time the signal has to fall below the threshold to reduce the reduction
again. Shorter signals than the chosen attack time will be left
untouched. The overall reduction of the signal can be made up afterwards
with the `makeup` setting. So compressing the peaks of a signal about
6dB and raising the makeup to this level results in a signal twice as
loud than the source. To gain a softer entry in the compression the
`knee` flattens the hard edge at the threshold in the range of the
chosen decibels.

The filter accepts the following options:

`level_in`{.sample}

:   Set input gain. Default is 1. Range is between 0.015625 and 64.

`mode`{.sample}

:   Set mode of compressor operation. Can be `upward` or `downward`.
    Default is `downward`.

`threshold`{.sample}

:   If a signal of stream rises above this level it will affect the gain
    reduction. By default it is 0.125. Range is between 0.00097563 and
    1.

`ratio`{.sample}

:   Set a ratio by which the signal is reduced. 1:2 means that if the
    level rose 4dB above the threshold, it will be only 2dB above after
    the reduction. Default is 2. Range is between 1 and 20.

`attack`{.sample}

:   Amount of milliseconds the signal has to rise above the threshold
    before gain reduction starts. Default is 20. Range is between 0.01
    and 2000.

`release`{.sample}

:   Amount of milliseconds the signal has to fall below the threshold
    before reduction is decreased again. Default is 250. Range is
    between 0.01 and 9000.

`makeup`{.sample}

:   Set the amount by how much signal will be amplified after
    processing. Default is 1. Range is from 1 to 64.

`knee`{.sample}

:   Curve the sharp knee around the threshold to enter gain reduction
    more softly. Default is 2.82843. Range is between 1 and 8.

`link`{.sample}

:   Choose if the `average` level between all channels of input stream
    or the louder(`maximum`) channel of input stream affects the
    reduction. Default is `average`.

`detection`{.sample}

:   Should the exact signal be taken in case of `peak` or an RMS one in
    case of `rms`. Default is `rms` which is mostly smoother.

`mix`{.sample}

:   How much to use compressed signal in output. Default is 1. Range is
    between 0 and 1.

[]{#Commands}

#### [36.2.1 Commands](#toc-Commands) {#commands .subsection}

This filter supports the all above options as [commands](#commands).

[]{#acontrast}

### [36.3 acontrast](#toc-acontrast) {#acontrast .section}

Simple audio dynamic range compression/expansion filter.

The filter accepts the following options:

`contrast`{.sample}

:   Set contrast. Default is 33. Allowed range is between 0 and 100.

[]{#acopy}

### [36.4 acopy](#toc-acopy) {#acopy .section}

Copy the input audio source unchanged to the output. This is mainly
useful for testing purposes.

[]{#acrossfade}

### [36.5 acrossfade](#toc-acrossfade) {#acrossfade .section}

Apply cross fade from one input audio stream to another input audio
stream. The cross fade is applied for specified duration near the end of
first stream.

The filter accepts the following options:

`inputs, n`{.sample}

:   Specify the number of inputs to crossfade. When crossfading multiple
    inputs, each input will be concatenated and crossfaded in sequence,
    similar to the [concat filter](#concat-filter). Default is 2.

`nb_samples, ns`{.sample}

:   Specify the number of samples for which the cross fade effect has to
    last. At the end of the cross fade effect the first input audio will
    be completely silent. Default is 44100.

`duration, d`{.sample}

:   Specify the duration of the cross fade effect. See
    [(ffmpeg-utils)the Time duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax) for the accepted
    syntax. By default the duration is determined by
    `nb_samples`{.variable}. If set this option is used instead of
    `nb_samples`{.variable}.

`overlap, o`{.sample}

:   Should first stream end overlap with second stream start. Default is
    enabled.

`curve1`{.sample}

:   Set curve for cross fade transition for first stream.

`curve2`{.sample}

:   Set curve for cross fade transition for second stream.

    For description of available curve types see [afade](#afade) filter
    description.

[]{#Examples-45}

#### [36.5.1 Examples](#toc-Examples-45) {#examples-45 .subsection}

- Cross fade from one input to another:

  ::: example
  ``` example
  ffmpeg -i first.flac -i second.flac -filter_complex acrossfade=d=10:c1=exp:c2=exp output.flac
  ```
  :::

- Cross fade from one input to another but without overlapping:

  ::: example
  ``` example
  ffmpeg -i first.flac -i second.flac -filter_complex acrossfade=d=10:o=0:c1=exp:c2=exp output.flac
  ```
  :::

  Concatenate multiple inputs with cross fade between each:

  ::: example
  ``` example
  ffmpeg -i first.flac -i second.flac -i third.flac -filter_complex acrossfade=n=3 output.flac
  ```
  :::

[]{#acrossover}

### [36.6 acrossover](#toc-acrossover) {#acrossover .section}

Split audio stream into several bands.

This filter splits audio stream into two or more frequency ranges.
Summing all streams back will give flat output.

The filter accepts the following options:

`split`{.sample}

:   Set split frequencies. Those must be positive and increasing.

`order`{.sample}

:   Set filter order for each band split. This controls filter roll-off
    or steepness of filter transfer function. Available values are:

    '`2nd`{.sample}'

    :   12 dB per octave.

    '`4th`{.sample}'

    :   24 dB per octave.

    '`6th`{.sample}'

    :   36 dB per octave.

    '`8th`{.sample}'

    :   48 dB per octave.

    '`10th`{.sample}'

    :   60 dB per octave.

    '`12th`{.sample}'

    :   72 dB per octave.

    '`14th`{.sample}'

    :   84 dB per octave.

    '`16th`{.sample}'

    :   96 dB per octave.

    '`18th`{.sample}'

    :   108 dB per octave.

    '`20th`{.sample}'

    :   120 dB per octave.

    Default is `4th`{.variable}.

`level`{.sample}

:   Set input gain level. Allowed range is from 0 to 1. Default value is
    1.

`gains`{.sample}

:   Set output gain for each band. Default value is 1 for all bands.

`precision`{.sample}

:   Set which precision to use when processing samples.

    `auto`{.sample}

    :   Auto pick internal sample format depending on other filters.

    `float`{.sample}

    :   Always use single-floating point precision sample format.

    `double`{.sample}

    :   Always use double-floating point precision sample format.

    Default value is `auto`.

[]{#Examples-46}

#### [36.6.1 Examples](#toc-Examples-46) {#examples-46 .subsection}

- Split input audio stream into two bands (low and high) with split
  frequency of 1500 Hz, each band will be in separate stream:

  ::: example
  ``` example
  ffmpeg -i in.flac -filter_complex 'acrossover=split=1500[LOW][HIGH]' -map '[LOW]' low.wav -map '[HIGH]' high.wav
  ```
  :::
- Same as above, but with higher filter order:

  ::: example
  ``` example
  ffmpeg -i in.flac -filter_complex 'acrossover=split=1500:order=8th[LOW][HIGH]' -map '[LOW]' low.wav -map '[HIGH]' high.wav
  ```
  :::
- Same as above, but also with additional middle band (frequencies
  between 1500 and 8000):

  ::: example
  ``` example
  ffmpeg -i in.flac -filter_complex 'acrossover=split=1500 8000:order=8th[LOW][MID][HIGH]' -map '[LOW]' low.wav -map '[MID]' mid.wav -map '[HIGH]' high.wav
  ```
  :::

[]{#acrusher}

### [36.7 acrusher](#toc-acrusher) {#acrusher .section}

Reduce audio bit resolution.

This filter is bit crusher with enhanced functionality. A bit crusher is
used to audibly reduce number of bits an audio signal is sampled with.
This doesn't change the bit depth at all, it just produces the effect.
Material reduced in bit depth sounds more harsh and \"digital\". This
filter is able to even round to continuous values instead of discrete
bit depths. Additionally it has a D/C offset which results in different
crushing of the lower and the upper half of the signal. An Anti-Aliasing
setting is able to produce \"softer\" crushing sounds.

Another feature of this filter is the logarithmic mode. This setting
switches from linear distances between bits to logarithmic ones. The
result is a much more \"natural\" sounding crusher which doesn't gate
low signals for example. The human ear has a logarithmic perception, so
this kind of crushing is much more pleasant. Logarithmic crushing is
also able to get anti-aliased.

The filter accepts the following options:

`level_in`{.sample}

:   Set level in.

`level_out`{.sample}

:   Set level out.

`bits`{.sample}

:   Set bit reduction.

`mix`{.sample}

:   Set mixing amount.

`mode`{.sample}

:   Can be linear: `lin` or logarithmic: `log`.

`dc`{.sample}

:   Set DC.

`aa`{.sample}

:   Set anti-aliasing.

`samples`{.sample}

:   Set sample reduction.

`lfo`{.sample}

:   Enable LFO. By default disabled.

`lforange`{.sample}

:   Set LFO range.

`lforate`{.sample}

:   Set LFO rate.

[]{#Commands-1}

#### [36.7.1 Commands](#toc-Commands-1) {#commands-1 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#acue}

### [36.8 acue](#toc-acue) {#acue .section}

Delay audio filtering until a given wallclock timestamp. See the
[cue](#cue) filter.

[]{#adeclick}

### [36.9 adeclick](#toc-adeclick) {#adeclick .section}

Remove impulsive noise from input audio.

Samples detected as impulsive noise are replaced by interpolated samples
using autoregressive modelling.

`window, w`{.sample}

:   Set window size, in milliseconds. Allowed range is from `10` to
    `100`. Default value is `55` milliseconds. This sets size of window
    which will be processed at once.

`overlap, o`{.sample}

:   Set window overlap, in percentage of window size. Allowed range is
    from `50` to `95`. Default value is `75` percent. Setting this to a
    very high value increases impulsive noise removal but makes whole
    process much slower.

`arorder, a`{.sample}

:   Set autoregression order, in percentage of window size. Allowed
    range is from `0` to `25`. Default value is `2` percent. This option
    also controls quality of interpolated samples using neighbour good
    samples.

`threshold, t`{.sample}

:   Set threshold value. Allowed range is from `1` to `100`. Default
    value is `2`. This controls the strength of impulsive noise which is
    going to be removed. The lower value, the more samples will be
    detected as impulsive noise.

`burst, b`{.sample}

:   Set burst fusion, in percentage of window size. Allowed range is `0`
    to `10`. Default value is `2`. If any two samples detected as noise
    are spaced less than this value then any sample between those two
    samples will be also detected as noise.

`method, m`{.sample}

:   Set overlap method.

    It accepts the following values:

    `add, a`{.sample}

    :   Select overlap-add method. Even not interpolated samples are
        slightly changed with this method.

    `save, s`{.sample}

    :   Select overlap-save method. Not interpolated samples remain
        unchanged.

    Default value is `a`.

[]{#adeclip}

### [36.10 adeclip](#toc-adeclip) {#adeclip .section}

Remove clipped samples from input audio.

Samples detected as clipped are replaced by interpolated samples using
autoregressive modelling.

`window, w`{.sample}

:   Set window size, in milliseconds. Allowed range is from `10` to
    `100`. Default value is `55` milliseconds. This sets size of window
    which will be processed at once.

`overlap, o`{.sample}

:   Set window overlap, in percentage of window size. Allowed range is
    from `50` to `95`. Default value is `75` percent.

`arorder, a`{.sample}

:   Set autoregression order, in percentage of window size. Allowed
    range is from `0` to `25`. Default value is `8` percent. This option
    also controls quality of interpolated samples using neighbour good
    samples.

`threshold, t`{.sample}

:   Set threshold value. Allowed range is from `1` to `100`. Default
    value is `10`. Higher values make clip detection less aggressive.

`hsize, n`{.sample}

:   Set size of histogram used to detect clips. Allowed range is from
    `100` to `9999`. Default value is `1000`. Higher values make clip
    detection less aggressive.

`method, m`{.sample}

:   Set overlap method.

    It accepts the following values:

    `add, a`{.sample}

    :   Select overlap-add method. Even not interpolated samples are
        slightly changed with this method.

    `save, s`{.sample}

    :   Select overlap-save method. Not interpolated samples remain
        unchanged.

    Default value is `a`.

[]{#adecorrelate}

### [36.11 adecorrelate](#toc-adecorrelate) {#adecorrelate .section}

Apply decorrelation to input audio stream.

The filter accepts the following options:

`stages`{.sample}

:   Set decorrelation stages of filtering. Allowed range is from 1
    to 16. Default value is 6.

`seed`{.sample}

:   Set random seed used for setting delay in samples across channels.

[]{#adelay}

### [36.12 adelay](#toc-adelay) {#adelay .section}

Delay one or more audio channels.

Samples in delayed channel are filled with silence.

The filter accepts the following option:

`delays`{.sample}

:   Set list of delays in milliseconds for each channel separated by
    '\|'. Unused delays will be silently ignored. If number of given
    delays is smaller than number of channels all remaining channels
    will not be delayed. If you want to delay exact number of samples,
    append 'S' to number. If you want instead to delay in seconds,
    append 's' to number.

`all`{.sample}

:   Use last set delay for all remaining channels. By default is
    disabled. This option if enabled changes how option `delays` is
    interpreted.

[]{#Examples-47}

#### [36.12.1 Examples](#toc-Examples-47) {#examples-47 .subsection}

- Delay first channel by 1.5 seconds, the third channel by 0.5 seconds
  and leave the second channel (and any other channels that may be
  present) unchanged.

  ::: example
  ``` example
  adelay=1500|0|500
  ```
  :::
- Delay second channel by 500 samples, the third channel by 700 samples
  and leave the first channel (and any other channels that may be
  present) unchanged.

  ::: example
  ``` example
  adelay=0|500S|700S
  ```
  :::
- Delay all channels by same number of samples:

  ::: example
  ``` example
  adelay=delays=64S:all=1
  ```
  :::

[]{#adenorm}

### [36.13 adenorm](#toc-adenorm) {#adenorm .section}

Remedy denormals in audio by adding extremely low-level noise.

This filter shall be placed before any filter that can produce
denormals.

A description of the accepted parameters follows.

`level`{.sample}

:   Set level of added noise in dB. Default is `-351`. Allowed range is
    from -451 to -90.

`type`{.sample}

:   Set type of added noise.

    `dc`{.sample}

    :   Add DC signal.

    `ac`{.sample}

    :   Add AC signal.

    `square`{.sample}

    :   Add square signal.

    `pulse`{.sample}

    :   Add pulse signal.

    Default is `dc`.

[]{#Commands-2}

#### [36.13.1 Commands](#toc-Commands-2) {#commands-2 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#aderivative_002c-aintegral}

### [36.14 aderivative, aintegral](#toc-aderivative_002c-aintegral) {#aderivative-aintegral .section}

Compute derivative/integral of audio stream.

Applying both filters one after another produces original audio.

[]{#adrc}

### [36.15 adrc](#toc-adrc) {#adrc .section}

Apply spectral dynamic range controller filter to input audio stream.

A description of the accepted options follows.

`transfer`{.sample}

:   Set the transfer expression.

    The expression can contain the following constants:

    `ch`{.sample}

    :   current channel number

    `sn`{.sample}

    :   current sample number

    `nb_channels`{.sample}

    :   number of channels

    `t`{.sample}

    :   timestamp expressed in seconds

    `sr`{.sample}

    :   sample rate

    `p`{.sample}

    :   current frequency power value, in dB

    `f`{.sample}

    :   current frequency in Hz

    Default value is `p`.

`attack`{.sample}

:   Set the attack in milliseconds. Default is `50` milliseconds.
    Allowed range is from 1 to 1000 milliseconds.

`release`{.sample}

:   Set the release in milliseconds. Default is `100` milliseconds.
    Allowed range is from 5 to 2000 milliseconds.

`channels`{.sample}

:   Set which channels to filter, by default `all` channels in audio
    stream are filtered.

[]{#Commands-3}

#### [36.15.1 Commands](#toc-Commands-3) {#commands-3 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#Examples-48}

#### [36.15.2 Examples](#toc-Examples-48) {#examples-48 .subsection}

- Apply spectral compression to all frequencies with threshold of -50 dB
  and 1:6 ratio:

  ::: example
  ``` example
  adrc=transfer='if(gt(p,-50),-50+(p-(-50))/6,p)':attack=50:release=100
  ```
  :::
- Similar to above but with 1:2 ratio and filtering only front center
  channel:

  ::: example
  ``` example
  adrc=transfer='if(gt(p,-50),-50+(p-(-50))/2,p)':attack=50:release=100:channels=FC
  ```
  :::
- Apply spectral noise gate to all frequencies with threshold of -85 dB
  and with short attack time and short release time:

  ::: example
  ``` example
  adrc=transfer='if(lte(p,-85),p-800,p)':attack=1:release=5
  ```
  :::
- Apply spectral expansion to all frequencies with threshold of -10 dB
  and 1:2 ratio:

  ::: example
  ``` example
  adrc=transfer='if(lt(p,-10),-10+(p-(-10))*2,p)':attack=50:release=100
  ```
  :::
- Apply limiter to max -60 dB to all frequencies, with attack of 2 ms
  and release of 10 ms:

  ::: example
  ``` example
  adrc=transfer='min(p,-60)':attack=2:release=10
  ```
  :::

[]{#adynamicequalizer}

### [36.16 adynamicequalizer](#toc-adynamicequalizer) {#adynamicequalizer .section}

Apply dynamic equalization to input audio stream.

A description of the accepted options follows.

`threshold`{.sample}

Set the detection threshold used to trigger equalization. Threshold
detection is using detection filter. Default value is 0. Allowed range
is from 0 to 100.

`dfrequency`{.sample}

Set the detection frequency in Hz used for detection filter used to
trigger equalization. Default value is 1000 Hz. Allowed range is between
2 and 1000000 Hz.

`dqfactor`{.sample}

Set the detection resonance factor for detection filter used to trigger
equalization. Default value is 1. Allowed range is from 0.001 to 1000.

`tfrequency`{.sample}

Set the target frequency of equalization filter. Default value is 1000
Hz. Allowed range is between 2 and 1000000 Hz.

`tqfactor`{.sample}

Set the target resonance factor for target equalization filter. Default
value is 1. Allowed range is from 0.001 to 1000.

`attack`{.sample}

Set the amount of milliseconds the signal from detection has to rise
above the detection threshold before equalization starts. Default is 20.
Allowed range is between 1 and 2000.

`release`{.sample}

Set the amount of milliseconds the signal from detection has to fall
below the detection threshold before equalization ends. Default is 200.
Allowed range is between 1 and 2000.

`ratio`{.sample}

Set the ratio by which the equalization gain is raised. Default is 1.
Allowed range is between 0 and 30.

`makeup`{.sample}

Set the makeup offset by which the equalization gain is raised. Default
is 0. Allowed range is between 0 and 100.

`range`{.sample}

Set the max allowed cut/boost amount. Default is 50. Allowed range is
from 1 to 200.

`mode`{.sample}

Set the mode of filter operation, can be one of the following:

'`listen`{.sample}'

:   Output only isolated detection signal.

'`cutbelow`{.sample}'

:   Cut frequencies below detection threshold.

'`cutabove`{.sample}'

:   Cut frequencies above detection threshold.

'`boostbelow`{.sample}'

:   Boost frequencies below detection threshold.

'`boostabove`{.sample}'

:   Boost frequencies above detection threshold.

Default mode is '`cutbelow`{.sample}'.

`dftype`{.sample}

Set the type of detection filter, can be one of the following:

'`bandpass`{.sample}'

'`lowpass`{.sample}'

'`highpass`{.sample}'

'`peak`{.sample}'

Default type is '`bandpass`{.sample}'.

`tftype`{.sample}

Set the type of target filter, can be one of the following:

'`bell`{.sample}'

'`lowshelf`{.sample}'

'`highshelf`{.sample}'

Default type is '`bell`{.sample}'.

`auto`{.sample}

Automatically gather threshold from detection filter. By default is
'`disabled`{.sample}'. This option is useful to detect threshold in
certain time frame of input audio stream, in such case option value is
changed at runtime.

Available values are:

'`disabled`{.sample}'

:   Disable using automatically gathered threshold value.

'`off`{.sample}'

:   Stop picking threshold value.

'`on`{.sample}'

:   Start picking threshold value.

'`adaptive`{.sample}'

:   Adaptively pick threshold value, by calculating sliding window
    entropy.

`precision`{.sample}

Set which precision to use when processing samples.

`auto`{.sample}

:   Auto pick internal sample format depending on other filters.

`float`{.sample}

:   Always use single-floating point precision sample format.

`double`{.sample}

:   Always use double-floating point precision sample format.

[]{#Commands-4}

#### [36.16.1 Commands](#toc-Commands-4) {#commands-4 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#adynamicsmooth}

### [36.17 adynamicsmooth](#toc-adynamicsmooth) {#adynamicsmooth .section}

Apply dynamic smoothing to input audio stream.

A description of the accepted options follows.

`sensitivity`{.sample}

:   Set an amount of sensitivity to frequency fluctations. Default is 2.
    Allowed range is from 0 to 1e+06.

`basefreq`{.sample}

:   Set a base frequency for smoothing. Default value is 22050. Allowed
    range is from 2 to 1e+06.

[]{#Commands-5}

#### [36.17.1 Commands](#toc-Commands-5) {#commands-5 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#aecho}

### [36.18 aecho](#toc-aecho) {#aecho .section}

Apply echoing to the input audio.

Echoes are reflected sound and can occur naturally amongst mountains
(and sometimes large buildings) when talking or shouting; digital echo
effects emulate this behaviour and are often used to help fill out the
sound of a single instrument or vocal. The time difference between the
original signal and the reflection is the `delay`, and the loudness of
the reflected signal is the `decay`. Multiple echoes can have different
delays and decays.

A description of the accepted parameters follows.

`in_gain`{.sample}

:   Set input gain of reflected signal. Default is `0.6`.

`out_gain`{.sample}

:   Set output gain of reflected signal. Default is `0.3`.

`delays`{.sample}

:   Set list of time intervals in milliseconds between original signal
    and reflections separated by '\|'. Allowed range for each `delay` is
    `(0 - 90000.0]`. Default is `1000`.

`decays`{.sample}

:   Set list of loudness of reflected signals separated by '\|'. Allowed
    range for each `decay` is `(0 - 1.0]`. Default is `0.5`.

[]{#Examples-49}

#### [36.18.1 Examples](#toc-Examples-49) {#examples-49 .subsection}

- Make it sound as if there are twice as many instruments as are
  actually playing:

  ::: example
  ``` example
  aecho=0.8:0.88:60:0.4
  ```
  :::
- If delay is very short, then it sounds like a (metallic) robot playing
  music:

  ::: example
  ``` example
  aecho=0.8:0.88:6:0.4
  ```
  :::
- A longer delay will sound like an open air concert in the mountains:

  ::: example
  ``` example
  aecho=0.8:0.9:1000:0.3
  ```
  :::
- Same as above but with one more mountain:

  ::: example
  ``` example
  aecho=0.8:0.9:1000|1800:0.3|0.25
  ```
  :::

[]{#aemphasis}

### [36.19 aemphasis](#toc-aemphasis) {#aemphasis .section}

Audio emphasis filter creates or restores material directly taken from
LPs or emphased CDs with different filter curves. E.g. to store music on
vinyl the signal has to be altered by a filter first to even out the
disadvantages of this recording medium. Once the material is played back
the inverse filter has to be applied to restore the distortion of the
frequency response.

The filter accepts the following options:

`level_in`{.sample}

:   Set input gain.

`level_out`{.sample}

:   Set output gain.

`mode`{.sample}

:   Set filter mode. For restoring material use `reproduction` mode,
    otherwise use `production` mode. Default is `reproduction` mode.

`type`{.sample}

:   Set filter type. Selects medium. Can be one of the following:

    `col`{.sample}

    :   select Columbia.

    `emi`{.sample}

    :   select EMI.

    `bsi`{.sample}

    :   select BSI (78RPM).

    `riaa`{.sample}

    :   select RIAA.

    `cd`{.sample}

    :   select Compact Disc (CD).

    `50fm`{.sample}

    :   select 50s (FM).

    `75fm`{.sample}

    :   select 75s (FM).

    `50kf`{.sample}

    :   select 50s (FM-KF).

    `75kf`{.sample}

    :   select 75s (FM-KF).

[]{#Commands-6}

#### [36.19.1 Commands](#toc-Commands-6) {#commands-6 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#aeval}

### [36.20 aeval](#toc-aeval) {#aeval .section}

Modify an audio signal according to the specified expressions.

This filter accepts one or more expressions (one for each channel),
which are evaluated and used to modify a corresponding audio signal.

It accepts the following parameters:

`exprs`{.sample}

:   Set the '\|'-separated expressions list for each separate channel.
    If the number of input channels is greater than the number of
    expressions, the last specified expression is used for the remaining
    output channels.

`channel_layout, c`{.sample}

:   Set output channel layout. If not specified, the channel layout is
    specified by the number of expressions. If set to '`same`{.sample}',
    it will use by default the same input channel layout.

Each expression in `exprs`{.variable} can contain the following
constants and functions:

`ch`{.sample}

:   channel number of the current expression

`n`{.sample}

:   number of the evaluated sample, starting from 0

`s`{.sample}

:   sample rate

`t`{.sample}

:   time of the evaluated sample expressed in seconds

`nb_in_channels`{.sample}\
`nb_out_channels`{.sample}

:   input and output number of channels

`val(CH)`{.sample}

:   the value of input channel with number `CH`{.variable}

Note: this filter is slow. For faster processing you should use a
dedicated filter.

[]{#Examples-50}

#### [36.20.1 Examples](#toc-Examples-50) {#examples-50 .subsection}

- Half volume:

  ::: example
  ``` example
  aeval=val(ch)/2:c=same
  ```
  :::
- Invert phase of the second channel:

  ::: example
  ``` example
  aeval=val(0)|-val(1)
  ```
  :::

[]{#aexciter}

### [36.21 aexciter](#toc-aexciter) {#aexciter .section}

An exciter is used to produce high sound that is not present in the
original signal. This is done by creating harmonic distortions of the
signal which are restricted in range and added to the original signal.
An Exciter raises the upper end of an audio signal without simply
raising the higher frequencies like an equalizer would do to create a
more \"crisp\" or \"brilliant\" sound.

The filter accepts the following options:

`level_in`{.sample}

:   Set input level prior processing of signal. Allowed range is from 0
    to 64. Default value is 1.

`level_out`{.sample}

:   Set output level after processing of signal. Allowed range is from 0
    to 64. Default value is 1.

`amount`{.sample}

:   Set the amount of harmonics added to original signal. Allowed range
    is from 0 to 64. Default value is 1.

`drive`{.sample}

:   Set the amount of newly created harmonics. Allowed range is from 0.1
    to 10. Default value is 8.5.

`blend`{.sample}

:   Set the octave of newly created harmonics. Allowed range is from -10
    to 10. Default value is 0.

`freq`{.sample}

:   Set the lower frequency limit of producing harmonics in Hz. Allowed
    range is from 2000 to 12000 Hz. Default is 7500 Hz.

`ceil`{.sample}

:   Set the upper frequency limit of producing harmonics. Allowed range
    is from 9999 to 20000 Hz. If value is lower than 10000 Hz no limit
    is applied.

`listen`{.sample}

:   Mute the original signal and output only added harmonics. By default
    is disabled.

[]{#Commands-7}

#### [36.21.1 Commands](#toc-Commands-7) {#commands-7 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#afade}[]{#afade-1}

### [36.22 afade](#toc-afade-1) {#afade .section}

Apply fade-in/out effect to input audio.

A description of the accepted parameters follows.

`type, t`{.sample}

:   Specify the effect type, can be either `in` for fade-in, or `out`
    for a fade-out effect. Default is `in`.

`start_sample, ss`{.sample}

:   Specify the number of the start sample for starting to apply the
    fade effect. Default is 0.

`nb_samples, ns`{.sample}

:   Specify the number of samples for which the fade effect has to last.
    At the end of the fade-in effect the output audio will have the same
    volume as the input audio, at the end of the fade-out transition the
    output audio will be silence. Default is 44100.

`start_time, st`{.sample}

:   Specify the start time of the fade effect. Default is 0. The value
    must be specified as a time duration; see [(ffmpeg-utils)the Time
    duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax) for the accepted
    syntax. If set this option is used instead of
    `start_sample`{.variable}.

`duration, d`{.sample}

:   Specify the duration of the fade effect. See [(ffmpeg-utils)the Time
    duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax) for the accepted
    syntax. At the end of the fade-in effect the output audio will have
    the same volume as the input audio, at the end of the fade-out
    transition the output audio will be silence. By default the duration
    is determined by `nb_samples`{.variable}. If set this option is used
    instead of `nb_samples`{.variable}.

`curve`{.sample}

:   Set curve for fade transition.

    It accepts the following values:

    `tri`{.sample}

    :   select triangular, linear slope (default)

    `qsin`{.sample}

    :   select quarter of sine wave

    `hsin`{.sample}

    :   select half of sine wave

    `esin`{.sample}

    :   select exponential sine wave

    `log`{.sample}

    :   select logarithmic

    `ipar`{.sample}

    :   select inverted parabola

    `qua`{.sample}

    :   select quadratic

    `cub`{.sample}

    :   select cubic

    `squ`{.sample}

    :   select square root

    `cbr`{.sample}

    :   select cubic root

    `par`{.sample}

    :   select parabola

    `exp`{.sample}

    :   select exponential

    `iqsin`{.sample}

    :   select inverted quarter of sine wave

    `ihsin`{.sample}

    :   select inverted half of sine wave

    `dese`{.sample}

    :   select double-exponential seat

    `desi`{.sample}

    :   select double-exponential sigmoid

    `losi`{.sample}

    :   select logistic sigmoid

    `sinc`{.sample}

    :   select sine cardinal function

    `isinc`{.sample}

    :   select inverted sine cardinal function

    `quat`{.sample}

    :   select quartic

    `quatr`{.sample}

    :   select quartic root

    `qsin2`{.sample}

    :   select squared quarter of sine wave

    `hsin2`{.sample}

    :   select squared half of sine wave

    `nofade`{.sample}

    :   no fade applied

`silence`{.sample}

:   Set the initial gain for fade-in or final gain for fade-out. Default
    value is `0.0`.

`unity`{.sample}

:   Set the initial gain for fade-out or final gain for fade-in. Default
    value is `1.0`.

[]{#Commands-8}

#### [36.22.1 Commands](#toc-Commands-8) {#commands-8 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#Examples-51}

#### [36.22.2 Examples](#toc-Examples-51) {#examples-51 .subsection}

- Fade in first 15 seconds of audio:

  ::: example
  ``` example
  afade=t=in:ss=0:d=15
  ```
  :::
- Fade out last 25 seconds of a 900 seconds audio:

  ::: example
  ``` example
  afade=t=out:st=875:d=25
  ```
  :::

[]{#afftdn}

### [36.23 afftdn](#toc-afftdn) {#afftdn .section}

Denoise audio samples with FFT.

A description of the accepted parameters follows.

`noise_reduction, nr`{.sample}

:   Set the noise reduction in dB, allowed range is 0.01 to 97. Default
    value is 12 dB.

`noise_floor, nf`{.sample}

:   Set the noise floor in dB, allowed range is -80 to -20. Default
    value is -50 dB.

`noise_type, nt`{.sample}

:   Set the noise type.

    It accepts the following values:

    `white, w`{.sample}

    :   Select white noise.

    `vinyl, v`{.sample}

    :   Select vinyl noise.

    `shellac, s`{.sample}

    :   Select shellac noise.

    `custom, c`{.sample}

    :   Select custom noise, defined in `bn` option.

        Default value is white noise.

`band_noise, bn`{.sample}

:   Set custom band noise profile for every one of 15 bands. Bands are
    separated by ' ' or '\|'.

`residual_floor, rf`{.sample}

:   Set the residual floor in dB, allowed range is -80 to -20. Default
    value is -38 dB.

`track_noise, tn`{.sample}

:   Enable noise floor tracking. By default is disabled. With this
    enabled, noise floor is automatically adjusted.

`track_residual, tr`{.sample}

:   Enable residual tracking. By default is disabled.

`output_mode, om`{.sample}

:   Set the output mode.

    It accepts the following values:

    `input, i`{.sample}

    :   Pass input unchanged.

    `output, o`{.sample}

    :   Pass noise filtered out.

    `noise, n`{.sample}

    :   Pass only noise.

        Default value is `output`{.variable}.

`adaptivity, ad`{.sample}

:   Set the adaptivity factor, used how fast to adapt gains adjustments
    per each frequency bin. Value `0`{.variable} enables instant
    adaptation, while higher values react much slower. Allowed range is
    from `0`{.variable} to `1`{.variable}. Default value is
    `0.5`{.variable}.

`floor_offset, fo`{.sample}

:   Set the noise floor offset factor. This option is used to adjust
    offset applied to measured noise floor. It is only effective when
    noise floor tracking is enabled. Allowed range is from
    `-2.0`{.variable} to `2.0`{.variable}. Default value is
    `1.0`{.variable}.

`noise_link, nl`{.sample}

:   Set the noise link used for multichannel audio.

    It accepts the following values:

    `none`{.sample}

    :   Use unchanged channel's noise floor.

    `min`{.sample}

    :   Use measured min noise floor of all channels.

    `max`{.sample}

    :   Use measured max noise floor of all channels.

    `average`{.sample}

    :   Use measured average noise floor of all channels.

        Default value is `min`{.variable}.

`band_multiplier, bm`{.sample}

:   Set the band multiplier factor, used how much to spread bands across
    frequency bins. Allowed range is from `0.2`{.variable} to
    `5`{.variable}. Default value is `1.25`{.variable}.

`sample_noise, sn`{.sample}

:   Toggle capturing and measurement of noise profile from input audio.

    It accepts the following values:

    `start, begin`{.sample}

    :   Start sample noise capture.

    `stop, end`{.sample}

    :   Stop sample noise capture and measure new noise band profile.

        Default value is `none`.

`gain_smooth, gs`{.sample}

:   Set gain smooth spatial radius, used to smooth gains applied to each
    frequency bin. Useful to reduce random music noise artefacts. Higher
    values increases smoothing of gains. Allowed range is from `0` to
    `50`. Default value is `0`.

[]{#Commands-9}

#### [36.23.1 Commands](#toc-Commands-9) {#commands-9 .subsection}

This filter supports the some above mentioned options as
[commands](#commands).

[]{#Examples-52}

#### [36.23.2 Examples](#toc-Examples-52) {#examples-52 .subsection}

- Reduce white noise by 10dB, and use previously measured noise floor of
  -40dB:

  ::: example
  ``` example
  afftdn=nr=10:nf=-40
  ```
  :::
- Reduce white noise by 10dB, also set initial noise floor to -80dB and
  enable automatic tracking of noise floor so noise floor will gradually
  change during processing:

  ::: example
  ``` example
  afftdn=nr=10:nf=-80:tn=1
  ```
  :::
- Reduce noise by 20dB, using noise floor of -40dB and using commands to
  take noise profile of first 0.4 seconds of input audio:

  ::: example
  ``` example
  asendcmd=0.0 afftdn sn start,asendcmd=0.4 afftdn sn stop,afftdn=nr=20:nf=-40
  ```
  :::

[]{#afftfilt}

### [36.24 afftfilt](#toc-afftfilt) {#afftfilt .section}

Apply arbitrary expressions to samples in frequency domain.

`real`{.sample}

Set frequency domain real expression for each separate channel separated
by '\|'. Default is \"re\". If the number of input channels is greater
than the number of expressions, the last specified expression is used
for the remaining output channels.

`imag`{.sample}

Set frequency domain imaginary expression for each separate channel
separated by '\|'. Default is \"im\".

Each expression in `real`{.variable} and `imag`{.variable} can contain
the following constants and functions:

`sr`{.sample}

:   sample rate

`b`{.sample}

:   current frequency bin number

`nb`{.sample}

:   number of available bins

`ch`{.sample}

:   channel number of the current expression

`chs`{.sample}

:   number of channels

`pts`{.sample}

:   current frame pts

`re`{.sample}

:   current real part of frequency bin of current channel

`im`{.sample}

:   current imaginary part of frequency bin of current channel

`real(b, ch)`{.sample}

:   Return the value of real part of frequency bin at location
    (`bin`{.variable},`channel`{.variable})

`imag(b, ch)`{.sample}

:   Return the value of imaginary part of frequency bin at location
    (`bin`{.variable},`channel`{.variable})

`win_size`{.sample}

Set window size. Allowed range is from 16 to 131072. Default is `4096`

`win_func`{.sample}

Set window function.

It accepts the following values:

'`rect`{.sample}'

'`bartlett`{.sample}'

'`hann, hanning`{.sample}'

'`hamming`{.sample}'

'`blackman`{.sample}'

'`welch`{.sample}'

'`flattop`{.sample}'

'`bharris`{.sample}'

'`bnuttall`{.sample}'

'`bhann`{.sample}'

'`sine`{.sample}'

'`nuttall`{.sample}'

'`lanczos`{.sample}'

'`gauss`{.sample}'

'`tukey`{.sample}'

'`dolph`{.sample}'

'`cauchy`{.sample}'

'`parzen`{.sample}'

'`poisson`{.sample}'

'`bohman`{.sample}'

'`kaiser`{.sample}'

Default is `hann`.

`overlap`{.sample}

Set window overlap. If set to 1, the recommended overlap for selected
window function will be picked. Default is `0.75`.

[]{#Examples-53}

#### [36.24.1 Examples](#toc-Examples-53) {#examples-53 .subsection}

- Leave almost only low frequencies in audio:

  ::: example
  ``` example
  afftfilt="'real=re * (1-clip((b/nb)*b,0,1))':imag='im * (1-clip((b/nb)*b,0,1))'"
  ```
  :::
- Apply robotize effect:

  ::: example
  ``` example
  afftfilt="real='hypot(re,im)*sin(0)':imag='hypot(re,im)*cos(0)':win_size=512:overlap=0.75"
  ```
  :::
- Apply whisper effect:

  ::: example
  ``` example
  afftfilt="real='hypot(re,im)*cos((random(0)*2-1)*2*3.14)':imag='hypot(re,im)*sin((random(1)*2-1)*2*3.14)':win_size=128:overlap=0.8"
  ```
  :::
- Apply phase shift:

  ::: example
  ``` example
  afftfilt="real=re*cos(1)-im*sin(1):imag=re*sin(1)+im*cos(1)"
  ```
  :::

[]{#afir}[]{#afir-1}

### [36.25 afir](#toc-afir-1) {#afir .section}

Apply an arbitrary Finite Impulse Response filter.

This filter is designed for applying long FIR filters, up to 60 seconds
long.

It can be used as component for digital crossover filters, room
equalization, cross talk cancellation, wavefield synthesis,
auralization, ambiophonics, ambisonics and spatialization.

This filter uses the streams higher than first one as FIR coefficients.
If the non-first stream holds a single channel, it will be used for all
input channels in the first stream, otherwise the number of channels in
the non-first stream must be same as the number of channels in the first
stream.

It accepts the following parameters:

`dry`{.sample}

:   Set dry gain. This sets input gain.

`wet`{.sample}

:   Set wet gain. This sets final output gain.

`length`{.sample}

:   Set Impulse Response filter length. Default is 1, which means whole
    IR is processed.

`gtype`{.sample}

:   This option is deprecated, and does nothing.

`irnorm`{.sample}

:   Set norm to be applied to IR coefficients before filtering. Allowed
    range is from `-1`{.variable} to `2`{.variable}. IR coefficients are
    normalized with calculated vector norm set by this option. For
    negative values, no norm is calculated, and IR coefficients are not
    modified at all. Default is `1`{.variable}.

`irlink`{.sample}

:   For multichannel IR if this option is set to `true`{.variable}, all
    IR channels will be normalized with maximal measured gain of all IR
    channels coefficients as set by `irnorm` option. When disabled, all
    IR coefficients in each IR channel will be normalized independently.
    Default is `true`{.variable}.

`irgain`{.sample}

:   Set gain to be applied to IR coefficients before filtering. Allowed
    range is 0 to 1. This gain is applied after any gain applied with
    `irnorm`{.variable} option.

`irfmt`{.sample}

:   Set format of IR stream. Can be `mono` or `input`. Default is
    `input`.

`maxir`{.sample}

:   Set max allowed Impulse Response filter duration in seconds. Default
    is 30 seconds. Allowed range is 0.1 to 60 seconds.

`response`{.sample}

:   This option is deprecated, and does nothing.

`channel`{.sample}

:   This option is deprecated, and does nothing.

`size`{.sample}

:   This option is deprecated, and does nothing.

`rate`{.sample}

:   This option is deprecated, and does nothing.

`minp`{.sample}

:   Set minimal partition size used for convolution. Default is
    `8192`{.variable}. Allowed range is from `1`{.variable} to
    `65536`{.variable}. Lower values decreases latency at cost of higher
    CPU usage.

`maxp`{.sample}

:   Set maximal partition size used for convolution. Default is
    `8192`{.variable}. Allowed range is from `8`{.variable} to
    `65536`{.variable}. Lower values may increase CPU usage.

`nbirs`{.sample}

:   Set number of input impulse responses streams which will be
    switchable at runtime. Allowed range is from `1`{.variable} to
    `32`{.variable}. Default is `1`{.variable}.

`ir`{.sample}

:   Set IR stream which will be used for convolution, starting from
    `0`{.variable}, should always be lower than supplied value by
    `nbirs` option. Default is `0`{.variable}. This option can be
    changed at runtime via [commands](#commands).

`precision`{.sample}

:   Set which precision to use when processing samples.

    `auto`{.sample}

    :   Auto pick internal sample format depending on other filters.

    `float`{.sample}

    :   Always use single-floating point precision sample format.

    `double`{.sample}

    :   Always use double-floating point precision sample format.

    Default value is auto.

`irload`{.sample}

:   Set when to load IR stream. Can be `init` or `access`. First one
    load and prepares all IRs on initialization, second one once on
    first access of specific IR. Default is `init`.

[]{#Examples-54}

#### [36.25.1 Examples](#toc-Examples-54) {#examples-54 .subsection}

- Apply reverb to stream using mono IR file as second input, complete
  command using ffmpeg:

  ::: example
  ``` example
  ffmpeg -i input.wav -i middle_tunnel_1way_mono.wav -lavfi afir output.wav
  ```
  :::
- Apply true stereo processing given input stereo stream, and two stereo
  impulse responses for left and right channel, the impulse response
  files are files with names l_ir.wav and r_ir.wav, and setting irnorm
  option value:

  ::: example
  ``` example
  "pan=4C|c0=FL|c1=FL|c2=FR|c3=FR[a];amovie=l_ir.wav[LIR];amovie=r_ir.wav[RIR];[LIR][RIR]amerge[ir];[a][ir]afir=irfmt=input:irnorm=1.2,pan=stereo|FL<c0+c2|FR<c1+c3"
  ```
  :::
- Similar to above example, but with `irgain` explicitly set to
  estimated value and with `irnorm` disabled:

  ::: example
  ``` example
  "pan=4C|c0=FL|c1=FL|c2=FR|c3=FR[a];amovie=l_ir.wav[LIR];amovie=r_ir.wav[RIR];[LIR][RIR]amerge[ir];[a][ir]afir=irfmt=input:irgain=-5dB:irnom=-1,pan=stereo|FL<c0+c2|FR<c1+c3"
  ```
  :::

[]{#aformat}[]{#aformat-1}

### [36.26 aformat](#toc-aformat-1) {#aformat .section}

Set output format constraints for the input audio. The framework will
negotiate the most appropriate format to minimize conversions.

It accepts the following parameters:

`sample_fmts, f`{.sample}

:   A '\|'-separated list of requested sample formats.

`sample_rates, r`{.sample}

:   A '\|'-separated list of requested sample rates.

`channel_layouts, cl`{.sample}

:   A '\|'-separated list of requested channel layouts.

    See [(ffmpeg-utils)the Channel Layout section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#channel-layout-syntax) for the required
    syntax.

If a parameter is omitted, all values are allowed.

Force the output to either unsigned 8-bit or signed 16-bit stereo

::: example
``` example
aformat=sample_fmts=u8|s16:channel_layouts=stereo
```
:::

[]{#afreqshift}

### [36.27 afreqshift](#toc-afreqshift) {#afreqshift .section}

Apply frequency shift to input audio samples.

The filter accepts the following options:

`shift`{.sample}

:   Specify frequency shift. Allowed range is -INT_MAX to INT_MAX.
    Default value is 0.0.

`level`{.sample}

:   Set output gain applied to final output. Allowed range is from 0.0
    to 1.0. Default value is 1.0.

`order`{.sample}

:   Set filter order used for filtering. Allowed range is from 1 to 16.
    Default value is 8.

[]{#Commands-10}

#### [36.27.1 Commands](#toc-Commands-10) {#commands-10 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#afwtdn}

### [36.28 afwtdn](#toc-afwtdn) {#afwtdn .section}

Reduce broadband noise from input samples using Wavelets.

A description of the accepted options follows.

`sigma`{.sample}

Set the noise sigma, allowed range is from 0 to 1. Default value is 0.
This option controls strength of denoising applied to input samples.
Most useful way to set this option is via decibels, eg. -45dB.

`levels`{.sample}

Set the number of wavelet levels of decomposition. Allowed range is from
1 to 12. Default value is 10. Setting this too low make denoising
performance very poor.

`wavet`{.sample}

Set wavelet type for decomposition of input frame. They are sorted by
number of coefficients, from lowest to highest. More coefficients means
worse filtering speed, but overall better quality. Available wavelets
are:

'`sym2`{.sample}'

'`sym4`{.sample}'

'`rbior68`{.sample}'

'`deb10`{.sample}'

'`sym10`{.sample}'

'`coif5`{.sample}'

'`bl3`{.sample}'

`percent`{.sample}

Set percent of full denoising. Allowed range is from 0 to 100 percent.
Default value is 85 percent or partial denoising.

`profile`{.sample}

If enabled, first input frame will be used as noise profile. If first
frame samples contain non-noise performance will be very poor.

`adaptive`{.sample}

If enabled, input frames are analyzed for presence of noise. If noise is
detected with high possibility then input frame profile will be used for
processing following frames, until new noise frame is detected.

`samples`{.sample}

Set size of single frame in number of samples. Allowed range is from 512
to 65536. Default frame size is 8192 samples.

`softness`{.sample}

Set softness applied inside thresholding function. Allowed range is from
0 to 10. Default softness is 1.

[]{#Commands-11}

#### [36.28.1 Commands](#toc-Commands-11) {#commands-11 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#agate}

### [36.29 agate](#toc-agate) {#agate .section}

A gate is mainly used to reduce lower parts of a signal. This kind of
signal processing reduces disturbing noise between useful signals.

Gating is done by detecting the volume below a chosen level
`threshold`{.variable} and dividing it by the factor set with
`ratio`{.variable}. The bottom of the noise floor is set via
`range`{.variable}. Because an exact manipulation of the signal would
cause distortion of the waveform the reduction can be levelled over
time. This is done by setting `attack`{.variable} and
`release`{.variable}.

`attack`{.variable} determines how long the signal has to fall below the
threshold before any reduction will occur and `release`{.variable} sets
the time the signal has to rise above the threshold to reduce the
reduction again. Shorter signals than the chosen attack time will be
left untouched.

`level_in`{.sample}

:   Set input level before filtering. Default is 1. Allowed range is
    from 0.015625 to 64.

`mode`{.sample}

:   Set the mode of operation. Can be `upward` or `downward`. Default is
    `downward`. If set to `upward` mode, higher parts of signal will be
    amplified, expanding dynamic range in upward direction. Otherwise,
    in case of `downward` lower parts of signal will be reduced.

`range`{.sample}

:   Set the level of gain reduction when the signal is below the
    threshold. Default is 0.06125. Allowed range is from 0 to 1. Setting
    this to 0 disables reduction and then filter behaves like expander.

`threshold`{.sample}

:   If a signal rises above this level the gain reduction is released.
    Default is 0.125. Allowed range is from 0 to 1.

`ratio`{.sample}

:   Set a ratio by which the signal is reduced. Default is 2. Allowed
    range is from 1 to 9000.

`attack`{.sample}

:   Amount of milliseconds the signal has to rise above the threshold
    before gain reduction stops. Default is 20 milliseconds. Allowed
    range is from 0.01 to 9000.

`release`{.sample}

:   Amount of milliseconds the signal has to fall below the threshold
    before the reduction is increased again. Default is 250
    milliseconds. Allowed range is from 0.01 to 9000.

`makeup`{.sample}

:   Set amount of amplification of signal after processing. Default
    is 1. Allowed range is from 1 to 64.

`knee`{.sample}

:   Curve the sharp knee around the threshold to enter gain reduction
    more softly. Default is 2.828427125. Allowed range is from 1 to 8.

`detection`{.sample}

:   Choose if exact signal should be taken for detection or an RMS like
    one. Default is `rms`. Can be `peak` or `rms`.

`link`{.sample}

:   Choose if the average level between all channels or the louder
    channel affects the reduction. Default is `average`. Can be
    `average` or `maximum`.

[]{#Commands-12}

#### [36.29.1 Commands](#toc-Commands-12) {#commands-12 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#aiir}

### [36.30 aiir](#toc-aiir) {#aiir .section}

Apply an arbitrary Infinite Impulse Response filter.

It accepts the following parameters:

`zeros, z`{.sample}

:   Set B/numerator/zeros/reflection coefficients.

`poles, p`{.sample}

:   Set A/denominator/poles/ladder coefficients.

`gains, k`{.sample}

:   Set channels gains.

`dry_gain`{.sample}

:   Set input gain.

`wet_gain`{.sample}

:   Set output gain.

`format, f`{.sample}

:   Set coefficients format.

    '`ll`{.sample}'

    :   lattice-ladder function

    '`sf`{.sample}'

    :   analog transfer function

    '`tf`{.sample}'

    :   digital transfer function

    '`zp`{.sample}'

    :   Z-plane zeros/poles, cartesian (default)

    '`pr`{.sample}'

    :   Z-plane zeros/poles, polar radians

    '`pd`{.sample}'

    :   Z-plane zeros/poles, polar degrees

    '`sp`{.sample}'

    :   S-plane zeros/poles

`process, r`{.sample}

:   Set type of processing.

    '`d`{.sample}'

    :   direct processing

    '`s`{.sample}'

    :   serial processing

    '`p`{.sample}'

    :   parallel processing

`precision, e`{.sample}

:   Set filtering precision.

    '`dbl`{.sample}'

    :   double-precision floating-point (default)

    '`flt`{.sample}'

    :   single-precision floating-point

    '`i32`{.sample}'

    :   32-bit integers

    '`i16`{.sample}'

    :   16-bit integers

`normalize, n`{.sample}

:   Normalize filter coefficients, by default is enabled. Enabling it
    will normalize magnitude response at DC to 0dB.

`mix`{.sample}

:   How much to use filtered signal in output. Default is 1. Range is
    between 0 and 1.

`response`{.sample}

:   Show IR frequency response, magnitude(magenta), phase(green) and
    group delay(yellow) in additional video stream. By default it is
    disabled.

`channel`{.sample}

:   Set for which IR channel to display frequency response. By default
    is first channel displayed. This option is used only when
    `response`{.variable} is enabled.

`size`{.sample}

:   Set video stream size. This option is used only when
    `response`{.variable} is enabled.

Coefficients in `tf` and `sf` format are separated by spaces and are in
ascending order.

Coefficients in `zp` format are separated by spaces and order of
coefficients doesn't matter. Coefficients in `zp` format are complex
numbers with `i`{.variable} imaginary unit.

Different coefficients and gains can be provided for every channel, in
such case use '\|' to separate coefficients or gains. Last provided
coefficients will be used for all remaining channels.

[]{#Examples-55}

#### [36.30.1 Examples](#toc-Examples-55) {#examples-55 .subsection}

- Apply 2 pole elliptic notch at around 5000Hz for 48000 Hz sample rate:

  ::: example
  ``` example
  aiir=k=1:z=7.957584807809675810E-1 -2.575128568908332300 3.674839853930788710 -2.57512875289799137 7.957586296317130880E-1:p=1 -2.86950072432325953 3.63022088054647218 -2.28075678147272232 6.361362326477423500E-1:f=tf:r=d
  ```
  :::
- Same as above but in `zp` format:

  ::: example
  ``` example
  aiir=k=0.79575848078096756:z=0.80918701+0.58773007i 0.80918701-0.58773007i 0.80884700+0.58784055i 0.80884700-0.58784055i:p=0.63892345+0.59951235i 0.63892345-0.59951235i 0.79582691+0.44198673i 0.79582691-0.44198673i:f=zp:r=s
  ```
  :::
- Apply 3-rd order analog normalized Butterworth low-pass filter, using
  analog transfer function format:

  ::: example
  ``` example
  aiir=z=1.3057 0 0 0:p=1.3057 2.3892 2.1860 1:f=sf:r=d
  ```
  :::

[]{#alimiter}

### [36.31 alimiter](#toc-alimiter) {#alimiter .section}

The limiter prevents an input signal from rising over a desired
threshold. This limiter uses lookahead technology to prevent your signal
from distorting. It means that there is a small delay after the signal
is processed. Keep in mind that the delay it produces is the attack time
you set.

The filter accepts the following options:

`level_in`{.sample}

:   Set input gain. Default is 1.

`level_out`{.sample}

:   Set output gain. Default is 1.

`limit`{.sample}

:   Don't let signals above this level pass the limiter. Default is 1.

`attack`{.sample}

:   The limiter will reach its attenuation level in this amount of time
    in milliseconds. Default is 5 milliseconds.

`release`{.sample}

:   Come back from limiting to attenuation 1.0 in this amount of
    milliseconds. Default is 50 milliseconds.

`asc`{.sample}

:   When gain reduction is always needed ASC takes care of releasing to
    an average reduction level rather than reaching a reduction of 0 in
    the release time.

`asc_level`{.sample}

:   Select how much the release time is affected by ASC, 0 means nearly
    no changes in release time while 1 produces higher release times.

`level`{.sample}

:   Auto level output signal. Default is enabled. This normalizes audio
    back to 0dB if enabled.

`latency`{.sample}

:   Compensate the delay introduced by using the lookahead buffer set
    with attack parameter. Also flush the valid audio data in the
    lookahead buffer when the stream hits EOF.

Depending on picked setting it is recommended to upsample input 2x or 4x
times with [aresample](#aresample) before applying this filter.

[]{#allpass}

### [36.32 allpass](#toc-allpass) {#allpass .section}

Apply a two-pole all-pass filter with central frequency (in Hz)
`frequency`{.variable}, and filter-width `width`{.variable}. An all-pass
filter changes the audio's frequency to phase relationship without
changing its frequency to amplitude relationship.

The filter accepts the following options:

`frequency, f`{.sample}

Set frequency in Hz.

`width_type, t`{.sample}

Set method to specify band-width of filter.

`h`{.sample}

:   Hz

`q`{.sample}

:   Q-Factor

`o`{.sample}

:   octave

`s`{.sample}

:   slope

`k`{.sample}

:   kHz

`width, w`{.sample}

Specify the band-width of a filter in width_type units.

`mix, m`{.sample}

How much to use filtered signal in output. Default is 1. Range is
between 0 and 1.

`channels, c`{.sample}

Specify which channels to filter, by default all available are filtered.

`normalize, n`{.sample}

Normalize biquad coefficients, by default is disabled. Enabling it will
normalize magnitude response at DC to 0dB.

`order, o`{.sample}

Set the filter order, can be 1 or 2. Default is 2.

`transform, a`{.sample}

Set transform type of IIR filter.

`di`{.sample}

`dii`{.sample}

`tdi`{.sample}

`tdii`{.sample}

`latt`{.sample}

`svf`{.sample}

`zdf`{.sample}

`precision, r`{.sample}

Set precision of filtering.

`auto`{.sample}

:   Pick automatic sample format depending on surround filters.

`s16`{.sample}

:   Always use signed 16-bit.

`s32`{.sample}

:   Always use signed 32-bit.

`f32`{.sample}

:   Always use float 32-bit.

`f64`{.sample}

:   Always use float 64-bit.

[]{#Commands-13}

#### [36.32.1 Commands](#toc-Commands-13) {#commands-13 .subsection}

This filter supports the following commands:

`frequency, f`{.sample}

:   Change allpass frequency. Syntax for the command is :
    \"`frequency`{.variable}\"

`width_type, t`{.sample}

:   Change allpass width_type. Syntax for the command is :
    \"`width_type`{.variable}\"

`width, w`{.sample}

:   Change allpass width. Syntax for the command is :
    \"`width`{.variable}\"

`mix, m`{.sample}

:   Change allpass mix. Syntax for the command is : \"`mix`{.variable}\"

[]{#aloop}

### [36.33 aloop](#toc-aloop) {#aloop .section}

Loop audio samples.

The filter accepts the following options:

`loop`{.sample}

:   Set the number of loops. Setting this value to -1 will result in
    infinite loops. Default is 0.

`size`{.sample}

:   Set maximal number of samples. Default is 0.

`start`{.sample}

:   Set first sample of loop. Default is 0.

`time`{.sample}

:   Set the time of loop start in seconds. Only used if option named
    `start`{.variable} is set to `-1`.

[]{#amerge}[]{#amerge-1}

### [36.34 amerge](#toc-amerge-1) {#amerge .section}

Merge two or more audio streams into a single multi-channel stream.

All inputs must have the same sample rate, and format.

If inputs do not have the same duration, the output will stop with the
shortest.

The filter accepts the following options:

`inputs`{.sample}

:   Set the number of inputs. Default is 2.

`layout_mode`{.sample}

:   This option controls how the output channel layout is determined and
    if the audio channels are reordered during merge.

    `legacy`{.sample}

    :   This is the mode how the filter behaved historically so it is
        the default.

        If the channel layouts of the inputs are known and disjoint, and
        therefore compatible, the channel layout of the output will be
        set accordingly and the channels will be reordered as necessary.
        If the channel layouts of the inputs are not disjoint, some of
        them are unknown, or they are using special channel layouts,
        such as ambisonics, the output will have all the channels of the
        first input then all the channels of the second input, in that
        order, and the channel layout of the output will be the default
        value corresponding to the total number of channels.

        For example, if the first input is in 2.1 (FL+FR+LF) and the
        second input is FC+BL+BR, then the output will be in 5.1, with
        the channels in the following order: a1, a2, b1, a3, b2, b3 (a1
        is the first channel of the first input, b1 is the first channel
        of the second input).

        On the other hand, if both input are in stereo, the output
        channels will be in the default order: a1, a2, b1, b2, and the
        channel layout will be arbitrarily set to 4.0, which may or may
        not be the expected value.

    `reset`{.sample}

    :   This mode ignores the input channel layouts and does no channel
        reordering. The output will have all the channels of the first
        input, then all the channels of the second input, in that order,
        and so on.

        The output channel layout will only specify the total channel
        count.

    `normal`{.sample}

    :   This mode keeps channel name and designation information from
        the input channels and does no channel reordering. The output
        will have all the channels of the first input, then all the
        channels of the second input, in that order, and so on.

[]{#Examples-56}

#### [36.34.1 Examples](#toc-Examples-56) {#examples-56 .subsection}

- Merge two mono files into a stereo stream:

  ::: example
  ``` example
  amovie=left.wav [l] ; amovie=right.mp3 [r] ; [l] [r] amerge
  ```
  :::
- Multiple merges assuming 1 video stream and 6 audio streams in
  `input.mkv`{.sample}:

  ::: example
  ``` example
  ffmpeg -i input.mkv -filter_complex "[0:1][0:2][0:3][0:4][0:5][0:6] amerge=inputs=6" -c:a pcm_s16le output.mkv
  ```
  :::

[]{#amix}

### [36.35 amix](#toc-amix) {#amix .section}

Mixes multiple audio inputs into a single output.

Note that this filter only supports float samples (the
`amerge`{.variable} and `pan`{.variable} audio filters support many
formats). If the `amix`{.variable} input has integer samples then
[aresample](#aresample) will be automatically inserted to perform the
conversion to float samples.

It accepts the following parameters:

`inputs`{.sample}

:   The number of inputs. If unspecified, it defaults to 2.

`duration`{.sample}

:   How to determine the end-of-stream.

    `longest`{.sample}

    :   The duration of the longest input. (default)

    `shortest`{.sample}

    :   The duration of the shortest input.

    `first`{.sample}

    :   The duration of the first input.

`dropout_transition`{.sample}

:   The transition time, in seconds, for volume renormalization when an
    input stream ends. The default value is 2 seconds.

`weights`{.sample}

:   Specify weight of each input audio stream as a sequence of numbers
    separated by a space. If fewer weights are specified compared to
    number of inputs, the last weight is assigned to the remaining
    inputs. Default weight for each input is 1.

`normalize`{.sample}

:   Always scale inputs instead of only doing summation of samples.
    Beware of heavy clipping if inputs are not normalized prior or after
    filtering by this filter if this option is disabled. By default is
    enabled.

[]{#Examples-57}

#### [36.35.1 Examples](#toc-Examples-57) {#examples-57 .subsection}

- This will mix 3 input audio streams to a single output with the same
  duration as the first input and a dropout transition time of 3
  seconds:

  ::: example
  ``` example
  ffmpeg -i INPUT1 -i INPUT2 -i INPUT3 -filter_complex amix=inputs=3:duration=first:dropout_transition=3 OUTPUT
  ```
  :::
- This will mix one vocal and one music input audio stream to a single
  output with the same duration as the longest input. The music will
  have quarter the weight as the vocals, and the inputs are not
  normalized:

  ::: example
  ``` example
  ffmpeg -i VOCALS -i MUSIC -filter_complex amix=inputs=2:duration=longest:dropout_transition=0:weights="1 0.25":normalize=0 OUTPUT
  ```
  :::

[]{#Commands-14}

#### [36.35.2 Commands](#toc-Commands-14) {#commands-14 .subsection}

This filter supports the following commands:

`weights`{.sample}\
`normalize`{.sample}

:   Syntax is same as option with same name.

[]{#amultiply}

### [36.36 amultiply](#toc-amultiply) {#amultiply .section}

Multiply first audio stream with second audio stream and store result in
output audio stream. Multiplication is done by multiplying each sample
from first stream with sample at same position from second stream.

With this element-wise multiplication one can create amplitude fades and
amplitude modulations.

[]{#anequalizer}

### [36.37 anequalizer](#toc-anequalizer) {#anequalizer .section}

High-order parametric multiband equalizer for each channel.

It accepts the following parameters:

`params`{.sample}

:   This option string is in format: \"c`chn`{.variable}
    f=`cf`{.variable} w=`w`{.variable} g=`g`{.variable} t=`f`{.variable}
    \| \...\" Each equalizer band is separated by '\|'.

    `chn`{.sample}

    :   Set channel number to which equalization will be applied. If
        input doesn't have that channel the entry is ignored.

    `f`{.sample}

    :   Set central frequency for band. If input doesn't have that
        frequency the entry is ignored.

    `w`{.sample}

    :   Set band width in Hertz.

    `g`{.sample}

    :   Set band gain in dB.

    `t`{.sample}

    :   Set filter type for band, optional, can be:

        '`0`{.sample}'

        :   Butterworth, this is default.

        '`1`{.sample}'

        :   Chebyshev type 1.

        '`2`{.sample}'

        :   Chebyshev type 2.

`curves`{.sample}

:   With this option activated frequency response of anequalizer is
    displayed in video stream.

`size`{.sample}

:   Set video stream size. Only useful if curves option is activated.

`mgain`{.sample}

:   Set max gain that will be displayed. Only useful if curves option is
    activated. Setting this to a reasonable value makes it possible to
    display gain which is derived from neighbour bands which are too
    close to each other and thus produce higher gain when both are
    activated.

`fscale`{.sample}

:   Set frequency scale used to draw frequency response in video output.
    Can be linear or logarithmic. Default is logarithmic.

`colors`{.sample}

:   Set color for each channel curve which is going to be displayed in
    video stream. This is list of color names separated by space or by
    '\|'. Unrecognised or missing colors will be replaced by white
    color.

[]{#Examples-58}

#### [36.37.1 Examples](#toc-Examples-58) {#examples-58 .subsection}

- Lower gain by 10 of central frequency 200Hz and width 100 Hz for first
  2 channels using Chebyshev type 1 filter:

  ::: example
  ``` example
  anequalizer=c0 f=200 w=100 g=-10 t=1|c1 f=200 w=100 g=-10 t=1
  ```
  :::

[]{#Commands-15}

#### [36.37.2 Commands](#toc-Commands-15) {#commands-15 .subsection}

This filter supports the following commands:

`change`{.sample}

:   Alter existing filter parameters. Syntax for the commands is :
    \"`fN`{.variable}\|f=`freq`{.variable}\|w=`width`{.variable}\|g=`gain`{.variable}\"

    `fN`{.variable} is existing filter number, starting from 0, if no
    such filter is available error is returned. `freq`{.variable} set
    new frequency parameter. `width`{.variable} set new width parameter
    in Hertz. `gain`{.variable} set new gain parameter in dB.

    Full filter invocation with asendcmd may look like this:
    asendcmd=c='4.0 anequalizer change
    0\|f=200\|w=50\|g=1',anequalizer=\...

[]{#anlmdn}

### [36.38 anlmdn](#toc-anlmdn) {#anlmdn .section}

Reduce broadband noise in audio samples using Non-Local Means algorithm.

Each sample is adjusted by looking for other samples with similar
contexts. This context similarity is defined by comparing their
surrounding patches of size `p`{.sample}. Patches are searched in an
area of `r`{.sample} around the sample.

The filter accepts the following options:

`strength, s`{.sample}

:   Set denoising strength. Allowed range is from 0.00001 to 10000.
    Default value is 0.00001.

`patch, p`{.sample}

:   Set patch radius duration. Allowed range is from 1 to 100
    milliseconds. Default value is 2 milliseconds.

`research, r`{.sample}

:   Set research radius duration. Allowed range is from 2 to 300
    milliseconds. Default value is 6 milliseconds.

`output, o`{.sample}

:   Set the output mode.

    It accepts the following values:

    `i`{.sample}

    :   Pass input unchanged.

    `o`{.sample}

    :   Pass noise filtered out.

    `n`{.sample}

    :   Pass only noise.

        Default value is `o`{.variable}.

`smooth, m`{.sample}

:   Set smooth factor. Default value is `11`{.variable}. Allowed range
    is from `1`{.variable} to `1000`{.variable}.

[]{#Commands-16}

#### [36.38.1 Commands](#toc-Commands-16) {#commands-16 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#anlmf_002c-anlms}

### [36.39 anlmf, anlms](#toc-anlmf_002c-anlms) {#anlmf-anlms .section}

Apply Normalized Least-Mean-(Squares\|Fourth) algorithm to the first
audio stream using the second audio stream.

This adaptive filter is used to mimic a desired filter by finding the
filter coefficients that relate to producing the least mean square of
the error signal (difference between the desired, 2nd input audio stream
and the actual signal, the 1st input audio stream).

A description of the accepted options follows.

`order`{.sample}

:   Set filter order.

`mu`{.sample}

:   Set filter mu.

`eps`{.sample}

:   Set the filter eps.

`leakage`{.sample}

:   Set the filter leakage.

`out_mode`{.sample}

:   It accepts the following values:

    `i`{.sample}

    :   Pass the 1st input.

    `d`{.sample}

    :   Pass the 2nd input.

    `o`{.sample}

    :   Pass difference between desired, 2nd input and error signal
        estimate.

    `n`{.sample}

    :   Pass difference between input, 1st input and error signal
        estimate.

    `e`{.sample}

    :   Pass error signal estimated samples.

        Default value is `o`{.variable}.

`precision`{.sample}

:   Set which precision to use when processing samples.

    `auto`{.sample}

    :   Auto pick internal sample format depending on other filters.

    `float`{.sample}

    :   Always use single-floating point precision sample format.

    `double`{.sample}

    :   Always use double-floating point precision sample format.

[]{#Examples-59}

#### [36.39.1 Examples](#toc-Examples-59) {#examples-59 .subsection}

- One of many usages of this filter is noise reduction, input audio is
  filtered with same samples that are delayed by fixed amount, one such
  example for stereo audio is:

  ::: example
  ``` example
  asplit[a][b],[a]adelay=32S|32S[a],[b][a]anlms=order=128:leakage=0.0005:mu=.5:out_mode=o
  ```
  :::

[]{#Commands-17}

#### [36.39.2 Commands](#toc-Commands-17) {#commands-17 .subsection}

This filter supports the same commands as options, excluding option
`order`.

[]{#anull}

### [36.40 anull](#toc-anull) {#anull .section}

Pass the audio source unchanged to the output.

[]{#apad}

### [36.41 apad](#toc-apad) {#apad .section}

Pad the end of an audio stream with silence.

This can be used together with `ffmpeg` `-shortest`{.sample} to extend
audio streams to the same length as the video stream.

A description of the accepted options follows.

`packet_size`{.sample}

:   Set silence packet size. Default value is 4096.

`pad_len`{.sample}

:   Set the number of samples of silence to add to the end. After the
    value is reached, the stream is terminated. This option is mutually
    exclusive with `whole_len`{.sample}.

`whole_len`{.sample}

:   Set the minimum total number of samples in the output audio stream.
    If the value is longer than the input audio length, silence is added
    to the end, until the value is reached. This option is mutually
    exclusive with `pad_len`{.sample}.

`pad_dur`{.sample}

:   Specify the duration of samples of silence to add. See
    [(ffmpeg-utils)the Time duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax) for the accepted
    syntax. Used only if set to non-negative value.

`whole_dur`{.sample}

:   Specify the minimum total duration in the output audio stream. See
    [(ffmpeg-utils)the Time duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax) for the accepted
    syntax. Used only if set to non-negative value. If the value is
    longer than the input audio length, silence is added to the end,
    until the value is reached. This option is mutually exclusive with
    `pad_dur`{.sample}

If neither the `pad_len`{.sample} nor the `whole_len`{.sample} nor
`pad_dur`{.sample} nor `whole_dur`{.sample} option is set, the filter
will add silence to the end of the input stream indefinitely.

Note that for ffmpeg 4.4 and earlier a zero `pad_dur`{.sample} or
`whole_dur`{.sample} also caused the filter to add silence indefinitely.

[]{#Examples-60}

#### [36.41.1 Examples](#toc-Examples-60) {#examples-60 .subsection}

- Add 1024 samples of silence to the end of the input:

  ::: example
  ``` example
  apad=pad_len=1024
  ```
  :::
- Make sure the audio output will contain at least 10000 samples, pad
  the input with silence if required:

  ::: example
  ``` example
  apad=whole_len=10000
  ```
  :::
- Use `ffmpeg` to pad the audio input with silence, so that the video
  stream will always result the shortest and will be converted until the
  end in the output file when using the `shortest`{.sample} option:

  ::: example
  ``` example
  ffmpeg -i VIDEO -i AUDIO -filter_complex "[1:0]apad" -shortest OUTPUT
  ```
  :::

[]{#aphaser}

### [36.42 aphaser](#toc-aphaser) {#aphaser .section}

Add a phasing effect to the input audio.

A phaser filter creates series of peaks and troughs in the frequency
spectrum. The position of the peaks and troughs are modulated so that
they vary over time, creating a sweeping effect.

A description of the accepted parameters follows.

`in_gain`{.sample}

Set input gain. Default is 0.4.

`out_gain`{.sample}

Set output gain. Default is 0.74

`delay`{.sample}

Set delay in milliseconds. Default is 3.0.

`decay`{.sample}

Set decay. Default is 0.4.

`speed`{.sample}

Set modulation speed in Hz. Default is 0.5.

`type`{.sample}

Set modulation type. Default is triangular.

It accepts the following values:

'`triangular, t`{.sample}'

'`sinusoidal, s`{.sample}'

[]{#aphaseshift}

### [36.43 aphaseshift](#toc-aphaseshift) {#aphaseshift .section}

Apply phase shift to input audio samples.

The filter accepts the following options:

`shift`{.sample}

:   Specify phase shift. Allowed range is from -1.0 to 1.0. Default
    value is 0.0.

`level`{.sample}

:   Set output gain applied to final output. Allowed range is from 0.0
    to 1.0. Default value is 1.0.

`order`{.sample}

:   Set filter order used for filtering. Allowed range is from 1 to 16.
    Default value is 8.

[]{#Commands-18}

#### [36.43.1 Commands](#toc-Commands-18) {#commands-18 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#apsnr}

### [36.44 apsnr](#toc-apsnr) {#apsnr .section}

Measure Audio Peak Signal-to-Noise Ratio.

This filter takes two audio streams for input, and outputs first audio
stream. Results are in dB per channel at end of either input.

[]{#apsyclip}

### [36.45 apsyclip](#toc-apsyclip) {#apsyclip .section}

Apply Psychoacoustic clipper to input audio stream.

The filter accepts the following options:

`level_in`{.sample}

:   Set input gain. By default it is 1. Range is \[0.015625 - 64\].

`level_out`{.sample}

:   Set output gain. By default it is 1. Range is \[0.015625 - 64\].

`clip`{.sample}

:   Set the clipping start value. Default value is 0dBFS or 1.

`diff`{.sample}

:   Output only difference samples, useful to hear introduced
    distortions. By default is disabled.

`adaptive`{.sample}

:   Set strength of adaptive distortion applied. Default value is 0.5.
    Allowed range is from 0 to 1.

`iterations`{.sample}

:   Set number of iterations of psychoacoustic clipper. Allowed range is
    from 1 to 20. Default value is 10.

`level`{.sample}

:   Auto level output signal. Default is disabled. This normalizes audio
    back to 0dBFS if enabled.

[]{#Commands-19}

#### [36.45.1 Commands](#toc-Commands-19) {#commands-19 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#apulsator}

### [36.46 apulsator](#toc-apulsator) {#apulsator .section}

Audio pulsator is something between an autopanner and a tremolo. But it
can produce funny stereo effects as well. Pulsator changes the volume of
the left and right channel based on a LFO (low frequency oscillator)
with different waveforms and shifted phases. This filter have the
ability to define an offset between left and right channel. An offset of
0 means that both LFO shapes match each other. The left and right
channel are altered equally - a conventional tremolo. An offset of 50%
means that the shape of the right channel is exactly shifted in phase
(or moved backwards about half of the frequency) - pulsator acts as an
autopanner. At 1 both curves match again. Every setting in between moves
the phase shift gapless between all stages and produces some
\"bypassing\" sounds with sine and triangle waveforms. The more you set
the offset near 1 (starting from the 0.5) the faster the signal passes
from the left to the right speaker.

The filter accepts the following options:

`level_in`{.sample}

:   Set input gain. By default it is 1. Range is \[0.015625 - 64\].

`level_out`{.sample}

:   Set output gain. By default it is 1. Range is \[0.015625 - 64\].

`mode`{.sample}

:   Set waveform shape the LFO will use. Can be one of: sine, triangle,
    square, sawup or sawdown. Default is sine.

`amount`{.sample}

:   Set modulation. Define how much of original signal is affected by
    the LFO.

`offset_l`{.sample}

:   Set left channel offset. Default is 0. Allowed range is \[0 - 1\].

`offset_r`{.sample}

:   Set right channel offset. Default is 0.5. Allowed range is \[0 -
    1\].

`width`{.sample}

:   Set pulse width. Default is 1. Allowed range is \[0 - 2\].

`timing`{.sample}

:   Set possible timing mode. Can be one of: bpm, ms or hz. Default is
    hz.

`bpm`{.sample}

:   Set bpm. Default is 120. Allowed range is \[30 - 300\]. Only used if
    timing is set to bpm.

`ms`{.sample}

:   Set ms. Default is 500. Allowed range is \[10 - 2000\]. Only used if
    timing is set to ms.

`hz`{.sample}

:   Set frequency in Hz. Default is 2. Allowed range is \[0.01 - 100\].
    Only used if timing is set to hz.

[]{#aresample}[]{#aresample-1}

### [36.47 aresample](#toc-aresample-1) {#aresample .section}

Resample the input audio to the specified parameters, using the
libswresample library. If none are specified then the filter will
automatically convert between its input and output.

This filter is also able to stretch/squeeze the audio data to make it
match the timestamps or to inject silence / cut out audio to make it
match the timestamps, do a combination of both or do neither.

The filter accepts the syntax
\[`sample_rate`{.variable}:\]`resampler_options`{.variable}, where
`sample_rate`{.variable} expresses a sample rate and
`resampler_options`{.variable} is a list of
`key`{.variable}=`value`{.variable} pairs, separated by \":\". See the
[(ffmpeg-resampler)\"Resampler Options\" section in the
ffmpeg-resampler(1) manual](ffmpeg-resampler.html#Resampler-Options) for
the complete list of supported options.

[]{#Examples-61}

#### [36.47.1 Examples](#toc-Examples-61) {#examples-61 .subsection}

- Resample the input audio to 44100Hz:

  ::: example
  ``` example
  aresample=44100
  ```
  :::
- Stretch/squeeze samples to the given timestamps, with a maximum of
  1000 samples per second compensation:

  ::: example
  ``` example
  aresample=async=1000
  ```
  :::

[]{#areverse}

### [36.48 areverse](#toc-areverse) {#areverse .section}

Reverse an audio clip.

Warning: This filter requires memory to buffer the entire clip, so
trimming is suggested.

[]{#Examples-62}

#### [36.48.1 Examples](#toc-Examples-62) {#examples-62 .subsection}

- Take the first 5 seconds of a clip, and reverse it.

  ::: example
  ``` example
  atrim=end=5,areverse
  ```
  :::

[]{#arls}

### [36.49 arls](#toc-arls) {#arls .section}

Apply Recursive Least Squares algorithm to the first audio stream using
the second audio stream.

This adaptive filter is used to mimic a desired filter by recursively
finding the filter coefficients that relate to producing the minimal
weighted linear least squares cost function of the error signal
(difference between the desired, 2nd input audio stream and the actual
signal, the 1st input audio stream).

A description of the accepted options follows.

`order`{.sample}

:   Set the filter order.

`lambda`{.sample}

:   Set the forgetting factor.

`delta`{.sample}

:   Set the coefficient to initialize internal covariance matrix.

`out_mode`{.sample}

:   Set the filter output samples. It accepts the following values:

    `i`{.sample}

    :   Pass the 1st input.

    `d`{.sample}

    :   Pass the 2nd input.

    `o`{.sample}

    :   Pass difference between desired, 2nd input and error signal
        estimate.

    `n`{.sample}

    :   Pass difference between input, 1st input and error signal
        estimate.

    `e`{.sample}

    :   Pass error signal estimated samples.

        Default value is `o`{.variable}.

`precision`{.sample}

:   Set which precision to use when processing samples.

    `auto`{.sample}

    :   Auto pick internal sample format depending on other filters.

    `float`{.sample}

    :   Always use single-floating point precision sample format.

    `double`{.sample}

    :   Always use double-floating point precision sample format.

[]{#arnndn}

### [36.50 arnndn](#toc-arnndn) {#arnndn .section}

Reduce noise from speech using Recurrent Neural Networks.

This filter accepts the following options:

`model, m`{.sample}

:   Set train model file to load. This option is always required.

`mix`{.sample}

:   Set how much to mix filtered samples into final output. Allowed
    range is from -1 to 1. Default value is 1. Negative values are
    special, they set how much to keep filtered noise in the final
    filter output. Set this option to -1 to hear actual noise removed
    from input signal.

[]{#Commands-20}

#### [36.50.1 Commands](#toc-Commands-20) {#commands-20 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#asdr}

### [36.51 asdr](#toc-asdr) {#asdr .section}

Measure Audio Signal-to-Distortion Ratio.

This filter takes two audio streams for input, and outputs first audio
stream. Results are in dB per channel at end of either input.

[]{#asetnsamples}

### [36.52 asetnsamples](#toc-asetnsamples) {#asetnsamples .section}

Set the number of samples per each output audio frame.

The last output packet may contain a different number of samples, as the
filter will flush all the remaining samples when the input audio signals
its end.

The filter accepts the following options:

`nb_out_samples, n`{.sample}

:   Set the number of frames per each output audio frame. The number is
    intended as the number of samples *per each channel*. Default value
    is 1024.

`pad, p`{.sample}

:   If set to 1, the filter will pad the last audio frame with zeroes,
    so that the last frame will contain the same number of samples as
    the previous ones. Default value is 1.

For example, to set the number of per-frame samples to 1234 and disable
padding for the last frame, use:

::: example
``` example
asetnsamples=n=1234:p=0
```
:::

[]{#asetrate}

### [36.53 asetrate](#toc-asetrate) {#asetrate .section}

Set the sample rate without altering the PCM data. This will result in a
change of speed and pitch.

The filter accepts the following options:

`sample_rate, r`{.sample}

:   Set the output sample rate. Default is 44100 Hz.

[]{#ashowinfo}

### [36.54 ashowinfo](#toc-ashowinfo) {#ashowinfo .section}

Show a line containing various information for each input audio frame.
The input audio is not modified.

The shown line contains a sequence of key/value pairs of the form
`key`{.variable}:`value`{.variable}.

The following values are shown in the output:

`n`{.sample}

:   The (sequential) number of the input frame, starting from 0.

`pts`{.sample}

:   The presentation timestamp of the input frame, in time base units;
    the time base depends on the filter input pad, and is usually
    1/`sample_rate`{.variable}.

`pts_time`{.sample}

:   The presentation timestamp of the input frame in seconds.

`fmt`{.sample}

:   The sample format.

`chlayout`{.sample}

:   The channel layout.

`rate`{.sample}

:   The sample rate for the audio frame.

`nb_samples`{.sample}

:   The number of samples (per channel) in the frame.

`checksum`{.sample}

:   The Adler-32 checksum (printed in hexadecimal) of the audio data.
    For planar audio, the data is treated as if all the planes were
    concatenated.

`plane_checksums`{.sample}

:   A list of Adler-32 checksums for each data plane.

[]{#asisdr}

### [36.55 asisdr](#toc-asisdr) {#asisdr .section}

Measure Audio Scaled-Invariant Signal-to-Distortion Ratio.

This filter takes two audio streams for input, and outputs first audio
stream. Results are in dB per channel at end of either input.

[]{#asoftclip}

### [36.56 asoftclip](#toc-asoftclip) {#asoftclip .section}

Apply audio soft clipping.

Soft clipping is a type of distortion effect where the amplitude of a
signal is saturated along a smooth curve, rather than the abrupt shape
of hard-clipping.

This filter accepts the following options:

`type`{.sample}

Set type of soft-clipping.

It accepts the following values:

`hard`{.sample}

`tanh`{.sample}

`atan`{.sample}

`cubic`{.sample}

`exp`{.sample}

`alg`{.sample}

`quintic`{.sample}

`sin`{.sample}

`erf`{.sample}

`threshold`{.sample}

Set threshold from where to start clipping. Default value is 0dB or 1.

`output`{.sample}

Set gain applied to output. Default value is 0dB or 1.

`param`{.sample}

Set additional parameter which controls sigmoid function.

`oversample`{.sample}

Set oversampling factor.

[]{#Commands-21}

#### [36.56.1 Commands](#toc-Commands-21) {#commands-21 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#aspectralstats}

### [36.57 aspectralstats](#toc-aspectralstats) {#aspectralstats .section}

Display frequency domain statistical information about the audio
channels. Statistics are calculated and stored as metadata for each
audio channel and for each audio frame.

It accepts the following option:

`win_size`{.sample}

Set the window length in samples. Default value is 2048. Allowed range
is from 32 to 65536.

`win_func`{.sample}

Set window function.

It accepts the following values:

'`rect`{.sample}'

'`bartlett`{.sample}'

'`hann, hanning`{.sample}'

'`hamming`{.sample}'

'`blackman`{.sample}'

'`welch`{.sample}'

'`flattop`{.sample}'

'`bharris`{.sample}'

'`bnuttall`{.sample}'

'`bhann`{.sample}'

'`sine`{.sample}'

'`nuttall`{.sample}'

'`lanczos`{.sample}'

'`gauss`{.sample}'

'`tukey`{.sample}'

'`dolph`{.sample}'

'`cauchy`{.sample}'

'`parzen`{.sample}'

'`poisson`{.sample}'

'`bohman`{.sample}'

'`kaiser`{.sample}'

Default is `hann`.

`overlap`{.sample}

Set window overlap. Allowed range is from `0` to `1`. Default value is
`0.5`.

`measure`{.sample}

Select the parameters which are measured. The metadata keys can be used
as flags, default is `all`{.sample} which measures everything.
`none`{.sample} disables all measurement.

A list of each metadata key follows:

`mean`{.sample}

`variance`{.sample}

`centroid`{.sample}

`spread`{.sample}

`skewness`{.sample}

`kurtosis`{.sample}

`entropy`{.sample}

`flatness`{.sample}

`crest`{.sample}

`flux`{.sample}

`slope`{.sample}

`decrease`{.sample}

`rolloff`{.sample}

[]{#asr}

### [36.58 asr](#toc-asr) {#asr .section}

Automatic Speech Recognition

This filter uses PocketSphinx for speech recognition. To enable
compilation of this filter, you need to configure FFmpeg with
`--enable-pocketsphinx`.

It accepts the following options:

`rate`{.sample}

:   Set sampling rate of input audio. Defaults is `16000`. This need to
    match speech models, otherwise one will get poor results.

`hmm`{.sample}

:   Set dictionary containing acoustic model files.

`dict`{.sample}

:   Set pronunciation dictionary.

`lm`{.sample}

:   Set language model file.

`lmctl`{.sample}

:   Set language model set.

`lmname`{.sample}

:   Set which language model to use.

`logfn`{.sample}

:   Set output for log messages.

The filter exports recognized speech as the frame metadata
`lavfi.asr.text`.

[]{#astats}[]{#astats-1}

### [36.59 astats](#toc-astats-1) {#astats .section}

Display time domain statistical information about the audio channels.
Statistics are calculated and displayed for each audio channel and,
where applicable, an overall figure is also given.

It accepts the following option:

`length`{.sample}

:   Short window length in seconds, used for peak and through RMS
    measurement. Default is `0.05` (50 milliseconds). Allowed range is
    `[0 - 10]`.

`metadata`{.sample}

:   Set metadata injection. All the metadata keys are prefixed with
    `lavfi.astats.X`, where `X` is channel number starting from 1 or
    string `Overall`. Default is disabled.

    Available keys for each channel are: `Bit_depth`{.variable}
    `Crest_factor`{.variable} `DC_offset`{.variable}
    `Dynamic_range`{.variable} `Entropy`{.variable}
    `Flat_factor`{.variable} `Max_difference`{.variable}
    `Max_level`{.variable} `Mean_difference`{.variable}
    `Min_difference`{.variable} `Min_level`{.variable}
    `Noise_floor`{.variable} `Noise_floor_count`{.variable}
    `Number_of_Infs`{.variable} `Number_of_NaNs`{.variable}
    `Number_of_denormals`{.variable} `Peak_count`{.variable}
    `Abs_Peak_count`{.variable} `Peak_level`{.variable}
    `RMS_difference`{.variable} `RMS_peak`{.variable}
    `RMS_trough`{.variable} `Zero_crossings`{.variable}
    `Zero_crossings_rate`{.variable}

    and for `Overall`: `Bit_depth`{.variable} `DC_offset`{.variable}
    `Entropy`{.variable} `Flat_factor`{.variable}
    `Max_difference`{.variable} `Max_level`{.variable}
    `Mean_difference`{.variable} `Min_difference`{.variable}
    `Min_level`{.variable} `Noise_floor`{.variable}
    `Noise_floor_count`{.variable} `Number_of_Infs`{.variable}
    `Number_of_NaNs`{.variable} `Number_of_denormals`{.variable}
    `Number_of_samples`{.variable} `Peak_count`{.variable}
    `Abs_Peak_count`{.variable} `Peak_level`{.variable}
    `RMS_difference`{.variable} `RMS_level`{.variable}
    `RMS_peak`{.variable} `RMS_trough`{.variable}

    For example, a full key looks like `lavfi.astats.1.DC_offset` or
    `lavfi.astats.Overall.Peak_count`.

    Read below for the description of the keys.

`reset`{.sample}

:   Set the number of frames over which cumulative stats are calculated
    before being reset. Default is disabled.

`measure_perchannel`{.sample}

:   Select the parameters which are measured per channel. The metadata
    keys can be used as flags, default is `all`{.sample} which measures
    everything. `none`{.sample} disables all per channel measurement.

`measure_overall`{.sample}

:   Select the parameters which are measured overall. The metadata keys
    can be used as flags, default is `all`{.sample} which measures
    everything. `none`{.sample} disables all overall measurement.

A description of the measure keys follow:

`none`{.sample}

:   no measures

`all`{.sample}

:   all measures

`Bit_depth`{.sample}

:   overall bit depth of audio, i.e. number of bits used for each sample

`Crest_factor`{.sample}

:   standard ratio of peak to RMS level (note: not in dB)

`DC_offset`{.sample}

:   mean amplitude displacement from zero

`Dynamic_range`{.sample}

:   measured dynamic range of audio in dB

`Entropy`{.sample}

:   entropy measured across whole audio, entropy of value near 1.0 is
    typically measured for white noise

`Flat_factor`{.sample}

:   flatness (i.e. consecutive samples with the same value) of the
    signal at its peak levels (i.e. either `Min_level`{.variable} or
    `Max_level`{.variable})

`Max_difference`{.sample}

:   maximal difference between two consecutive samples

`Max_level`{.sample}

:   maximal sample level

`Mean_difference`{.sample}

:   mean difference between two consecutive samples, i.e. the average of
    each difference between two consecutive samples

`Min_difference`{.sample}

:   minimal difference between two consecutive samples

`Min_level`{.sample}

:   minimal sample level

`Noise_floor`{.sample}

:   minimum local peak measured in dBFS over a short window

`Noise_floor_count`{.sample}

:   number of occasions (not the number of samples) that the signal
    attained `Noise floor`{.variable}

`Number_of_Infs`{.sample}

:   number of samples with an infinite value

`Number_of_NaNs`{.sample}

:   number of samples with a NaN (not a number) value

`Number_of_denormals`{.sample}

:   number of samples with a subnormal value

`Number_of_samples`{.sample}

:   number of samples

`Peak_count`{.sample}

:   number of occasions (not the number of samples) that the signal
    attained either `Min_level`{.variable} or `Max_level`{.variable}

`Abs_Peak_count`{.sample}

:   number of occasions that the absolute samples taken from the signal
    attained max absolute value of `Min_level`{.variable} and
    `Max_level`{.variable}

`Peak_level`{.sample}

:   standard peak level measured in dBFS

`RMS_difference`{.sample}

:   Root Mean Square difference between two consecutive samples

`RMS_level`{.sample}

:   standard RMS level measured in dBFS

`RMS_peak`{.sample}\
`RMS_trough`{.sample}

:   peak and through values for RMS level measured over a short window,
    measured in dBFS.

`Zero crossings`{.sample}

:   number of points where the waveform crosses the zero level axis

`Zero crossings rate`{.sample}

:   rate of Zero crossings and number of audio samples

[]{#asubboost}

### [36.60 asubboost](#toc-asubboost) {#asubboost .section}

Boost subwoofer frequencies.

The filter accepts the following options:

`dry`{.sample}

:   Set dry gain, how much of original signal is kept. Allowed range is
    from 0 to 1. Default value is 1.0.

`wet`{.sample}

:   Set wet gain, how much of filtered signal is kept. Allowed range is
    from 0 to 1. Default value is 1.0.

`boost`{.sample}

:   Set max boost factor. Allowed range is from 1 to 12. Default value
    is 2.

`decay`{.sample}

:   Set delay line decay gain value. Allowed range is from 0 to 1.
    Default value is 0.0.

`feedback`{.sample}

:   Set delay line feedback gain value. Allowed range is from 0 to 1.
    Default value is 0.9.

`cutoff`{.sample}

:   Set cutoff frequency in Hertz. Allowed range is 50 to 900. Default
    value is 100.

`slope`{.sample}

:   Set slope amount for cutoff frequency. Allowed range is 0.0001 to 1.
    Default value is 0.5.

`delay`{.sample}

:   Set delay. Allowed range is from 1 to 100. Default value is 20.

`channels`{.sample}

:   Set the channels to process. Default value is all available.

[]{#Commands-22}

#### [36.60.1 Commands](#toc-Commands-22) {#commands-22 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#asubcut}

### [36.61 asubcut](#toc-asubcut) {#asubcut .section}

Cut subwoofer frequencies.

This filter allows to set custom, steeper roll off than highpass filter,
and thus is able to more attenuate frequency content in stop-band.

The filter accepts the following options:

`cutoff`{.sample}

:   Set cutoff frequency in Hertz. Allowed range is 2 to 200. Default
    value is 20.

`order`{.sample}

:   Set filter order. Available values are from 3 to 20. Default value
    is 10.

`level`{.sample}

:   Set input gain level. Allowed range is from 0 to 1. Default value is
    1.

[]{#Commands-23}

#### [36.61.1 Commands](#toc-Commands-23) {#commands-23 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#asupercut}

### [36.62 asupercut](#toc-asupercut) {#asupercut .section}

Cut super frequencies.

The filter accepts the following options:

`cutoff`{.sample}

:   Set cutoff frequency in Hertz. Allowed range is 20000 to 192000.
    Default value is 20000.

`order`{.sample}

:   Set filter order. Available values are from 3 to 20. Default value
    is 10.

`level`{.sample}

:   Set input gain level. Allowed range is from 0 to 1. Default value is
    1.

[]{#Commands-24}

#### [36.62.1 Commands](#toc-Commands-24) {#commands-24 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#asuperpass}

### [36.63 asuperpass](#toc-asuperpass) {#asuperpass .section}

Apply high order Butterworth band-pass filter.

The filter accepts the following options:

`centerf`{.sample}

:   Set center frequency in Hertz. Allowed range is 2 to 999999. Default
    value is 1000.

`order`{.sample}

:   Set filter order. Available values are from 4 to 20. Default value
    is 4.

`qfactor`{.sample}

:   Set Q-factor. Allowed range is from 0.01 to 100. Default value is 1.

`level`{.sample}

:   Set input gain level. Allowed range is from 0 to 2. Default value is
    1.

[]{#Commands-25}

#### [36.63.1 Commands](#toc-Commands-25) {#commands-25 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#asuperstop}

### [36.64 asuperstop](#toc-asuperstop) {#asuperstop .section}

Apply high order Butterworth band-stop filter.

The filter accepts the following options:

`centerf`{.sample}

:   Set center frequency in Hertz. Allowed range is 2 to 999999. Default
    value is 1000.

`order`{.sample}

:   Set filter order. Available values are from 4 to 20. Default value
    is 4.

`qfactor`{.sample}

:   Set Q-factor. Allowed range is from 0.01 to 100. Default value is 1.

`level`{.sample}

:   Set input gain level. Allowed range is from 0 to 2. Default value is
    1.

[]{#Commands-26}

#### [36.64.1 Commands](#toc-Commands-26) {#commands-26 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#atempo}

### [36.65 atempo](#toc-atempo) {#atempo .section}

Adjust audio tempo.

The filter accepts exactly one parameter, the audio tempo. If not
specified then the filter will assume nominal 1.0 tempo. Tempo must be
in the \[0.5, 100.0\] range.

Note that tempo greater than 2 will skip some samples rather than blend
them in. If for any reason this is a concern it is always possible to
daisy-chain several instances of atempo to achieve the desired product
tempo.

[]{#Examples-63}

#### [36.65.1 Examples](#toc-Examples-63) {#examples-63 .subsection}

- Slow down audio to 80% tempo:

  ::: example
  ``` example
  atempo=0.8
  ```
  :::
- To speed up audio to 300% tempo:

  ::: example
  ``` example
  atempo=3
  ```
  :::
- To speed up audio to 300% tempo by daisy-chaining two atempo
  instances:

  ::: example
  ``` example
  atempo=sqrt(3),atempo=sqrt(3)
  ```
  :::

[]{#Commands-27}

#### [36.65.2 Commands](#toc-Commands-27) {#commands-27 .subsection}

This filter supports the following commands:

`tempo`{.sample}

:   Change filter tempo scale factor. Syntax for the command is :
    \"`tempo`{.variable}\"

[]{#atilt}

### [36.66 atilt](#toc-atilt) {#atilt .section}

Apply spectral tilt filter to audio stream.

This filter apply any spectral roll-off slope over any specified
frequency band.

The filter accepts the following options:

`freq`{.sample}

:   Set central frequency of tilt in Hz. Default is 10000 Hz.

`slope`{.sample}

:   Set slope direction of tilt. Default is 0. Allowed range is from -1
    to 1.

`width`{.sample}

:   Set width of tilt. Default is 1000. Allowed range is from 100 to
    10000.

`order`{.sample}

:   Set order of tilt filter.

`level`{.sample}

:   Set input volume level. Allowed range is from 0 to 4. Default is 1.

[]{#Commands-28}

#### [36.66.1 Commands](#toc-Commands-28) {#commands-28 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#atrim}

### [36.67 atrim](#toc-atrim) {#atrim .section}

Trim the input so that the output contains one continuous subpart of the
input.

It accepts the following parameters:

`start`{.sample}

:   Timestamp (in seconds) of the start of the section to keep. I.e. the
    audio sample with the timestamp `start`{.variable} will be the first
    sample in the output.

`end`{.sample}

:   Specify time of the first audio sample that will be dropped, i.e.
    the audio sample immediately preceding the one with the timestamp
    `end`{.variable} will be the last sample in the output.

`start_pts`{.sample}

:   Same as `start`{.variable}, except this option sets the start
    timestamp in samples instead of seconds.

`end_pts`{.sample}

:   Same as `end`{.variable}, except this option sets the end timestamp
    in samples instead of seconds.

`duration`{.sample}

:   The maximum duration of the output in seconds.

`start_sample`{.sample}

:   The number of the first sample that should be output.

`end_sample`{.sample}

:   The number of the first sample that should be dropped.

`start`{.sample}, `end`{.sample}, and `duration`{.sample} are expressed
as time duration specifications; see [(ffmpeg-utils)the Time duration
section in the ffmpeg-utils(1)
manual](ffmpeg-utils.html#time-duration-syntax).

Note that the first two sets of the start/end options and the
`duration`{.sample} option look at the frame timestamp, while the
\_sample options simply count the samples that pass through the filter.
So start/end_pts and start/end_sample will give different results when
the timestamps are wrong, inexact or do not start at zero. Also note
that this filter does not modify the timestamps. If you wish to have the
output timestamps start at zero, insert the asetpts filter after the
atrim filter.

If multiple start or end options are set, this filter tries to be greedy
and keep all samples that match at least one of the specified
constraints. To keep only the part that matches all the constraints at
once, chain multiple atrim filters.

The defaults are such that all the input is kept. So it is possible to
set e.g. just the end values to keep everything before the specified
time.

Examples:

- Drop everything except the second minute of input:

  ::: example
  ``` example
  ffmpeg -i INPUT -af atrim=60:120
  ```
  :::
- Keep only the first 1000 samples:

  ::: example
  ``` example
  ffmpeg -i INPUT -af atrim=end_sample=1000
  ```
  :::

[]{#axcorrelate}

### [36.68 axcorrelate](#toc-axcorrelate) {#axcorrelate .section}

Calculate normalized windowed cross-correlation between two input audio
streams.

Resulted samples are always between -1 and 1 inclusive. If result is 1
it means two input samples are highly correlated in that selected
segment. Result 0 means they are not correlated at all. If result is -1
it means two input samples are out of phase, which means they cancel
each other.

The filter accepts the following options:

`size`{.sample}

:   Set size of segment over which cross-correlation is calculated.
    Default is 256. Allowed range is from 2 to 131072.

`algo`{.sample}

:   Set algorithm for cross-correlation. Can be `slow` or `fast` or
    `best`. Default is `best`. Fast algorithm assumes mean values over
    any given segment are always zero and thus need much less
    calculations to make. This is generally not true, but is valid for
    typical audio streams.

[]{#Examples-64}

#### [36.68.1 Examples](#toc-Examples-64) {#examples-64 .subsection}

- Calculate correlation between channels in stereo audio stream:

  ::: example
  ``` example
  ffmpeg -i stereo.wav -af channelsplit,axcorrelate=size=1024:algo=fast correlation.wav
  ```
  :::

[]{#bandpass}

### [36.69 bandpass](#toc-bandpass) {#bandpass .section}

Apply a two-pole Butterworth band-pass filter with central frequency
`frequency`{.variable}, and (3dB-point) band-width width. The
`csg`{.variable} option selects a constant skirt gain (peak gain = Q)
instead of the default: constant 0dB peak gain. The filter roll off at
6dB per octave (20dB per decade).

The filter accepts the following options:

`frequency, f`{.sample}

Set the filter's central frequency. Default is `3000`.

`csg`{.sample}

Constant skirt gain if set to 1. Defaults to 0.

`width_type, t`{.sample}

Set method to specify band-width of filter.

`h`{.sample}

:   Hz

`q`{.sample}

:   Q-Factor

`o`{.sample}

:   octave

`s`{.sample}

:   slope

`k`{.sample}

:   kHz

`width, w`{.sample}

Specify the band-width of a filter in width_type units.

`mix, m`{.sample}

How much to use filtered signal in output. Default is 1. Range is
between 0 and 1.

`channels, c`{.sample}

Specify which channels to filter, by default all available are filtered.

`normalize, n`{.sample}

Normalize biquad coefficients, by default is disabled. Enabling it will
normalize magnitude response at DC to 0dB.

`transform, a`{.sample}

Set transform type of IIR filter.

`di`{.sample}

`dii`{.sample}

`tdi`{.sample}

`tdii`{.sample}

`latt`{.sample}

`svf`{.sample}

`zdf`{.sample}

`precision, r`{.sample}

Set precision of filtering.

`auto`{.sample}

:   Pick automatic sample format depending on surround filters.

`s16`{.sample}

:   Always use signed 16-bit.

`s32`{.sample}

:   Always use signed 32-bit.

`f32`{.sample}

:   Always use float 32-bit.

`f64`{.sample}

:   Always use float 64-bit.

`block_size, b`{.sample}

Set block size used for reverse IIR processing. If this value is set to
high enough value (higher than impulse response length truncated when
reaches near zero values) filtering will become linear phase otherwise
if not big enough it will just produce nasty artifacts.

Note that filter delay will be exactly this many samples when set to
non-zero value.

[]{#Commands-29}

#### [36.69.1 Commands](#toc-Commands-29) {#commands-29 .subsection}

This filter supports the following commands:

`frequency, f`{.sample}

:   Change bandpass frequency. Syntax for the command is :
    \"`frequency`{.variable}\"

`width_type, t`{.sample}

:   Change bandpass width_type. Syntax for the command is :
    \"`width_type`{.variable}\"

`width, w`{.sample}

:   Change bandpass width. Syntax for the command is :
    \"`width`{.variable}\"

`mix, m`{.sample}

:   Change bandpass mix. Syntax for the command is :
    \"`mix`{.variable}\"

[]{#bandreject}

### [36.70 bandreject](#toc-bandreject) {#bandreject .section}

Apply a two-pole Butterworth band-reject filter with central frequency
`frequency`{.variable}, and (3dB-point) band-width `width`{.variable}.
The filter roll off at 6dB per octave (20dB per decade).

The filter accepts the following options:

`frequency, f`{.sample}

Set the filter's central frequency. Default is `3000`.

`width_type, t`{.sample}

Set method to specify band-width of filter.

`h`{.sample}

:   Hz

`q`{.sample}

:   Q-Factor

`o`{.sample}

:   octave

`s`{.sample}

:   slope

`k`{.sample}

:   kHz

`width, w`{.sample}

Specify the band-width of a filter in width_type units.

`mix, m`{.sample}

How much to use filtered signal in output. Default is 1. Range is
between 0 and 1.

`channels, c`{.sample}

Specify which channels to filter, by default all available are filtered.

`normalize, n`{.sample}

Normalize biquad coefficients, by default is disabled. Enabling it will
normalize magnitude response at DC to 0dB.

`transform, a`{.sample}

Set transform type of IIR filter.

`di`{.sample}

`dii`{.sample}

`tdi`{.sample}

`tdii`{.sample}

`latt`{.sample}

`svf`{.sample}

`zdf`{.sample}

`precision, r`{.sample}

Set precision of filtering.

`auto`{.sample}

:   Pick automatic sample format depending on surround filters.

`s16`{.sample}

:   Always use signed 16-bit.

`s32`{.sample}

:   Always use signed 32-bit.

`f32`{.sample}

:   Always use float 32-bit.

`f64`{.sample}

:   Always use float 64-bit.

`block_size, b`{.sample}

Set block size used for reverse IIR processing. If this value is set to
high enough value (higher than impulse response length truncated when
reaches near zero values) filtering will become linear phase otherwise
if not big enough it will just produce nasty artifacts.

Note that filter delay will be exactly this many samples when set to
non-zero value.

[]{#Commands-30}

#### [36.70.1 Commands](#toc-Commands-30) {#commands-30 .subsection}

This filter supports the following commands:

`frequency, f`{.sample}

:   Change bandreject frequency. Syntax for the command is :
    \"`frequency`{.variable}\"

`width_type, t`{.sample}

:   Change bandreject width_type. Syntax for the command is :
    \"`width_type`{.variable}\"

`width, w`{.sample}

:   Change bandreject width. Syntax for the command is :
    \"`width`{.variable}\"

`mix, m`{.sample}

:   Change bandreject mix. Syntax for the command is :
    \"`mix`{.variable}\"

[]{#bass_002c-lowshelf}

### [36.71 bass, lowshelf](#toc-bass_002c-lowshelf) {#bass-lowshelf .section}

Boost or cut the bass (lower) frequencies of the audio using a two-pole
shelving filter with a response similar to that of a standard hi-fi's
tone-controls. This is also known as shelving equalisation (EQ).

The filter accepts the following options:

`gain, g`{.sample}

Give the gain at 0 Hz. Its useful range is about -20 (for a large cut)
to +20 (for a large boost). Beware of clipping when using a positive
gain.

`frequency, f`{.sample}

Set the filter's central frequency and so can be used to extend or
reduce the frequency range to be boosted or cut. The default value is
`100` Hz.

`width_type, t`{.sample}

Set method to specify band-width of filter.

`h`{.sample}

:   Hz

`q`{.sample}

:   Q-Factor

`o`{.sample}

:   octave

`s`{.sample}

:   slope

`k`{.sample}

:   kHz

`width, w`{.sample}

Determine how steep is the filter's shelf transition.

`poles, p`{.sample}

Set number of poles. Default is 2.

`mix, m`{.sample}

How much to use filtered signal in output. Default is 1. Range is
between 0 and 1.

`channels, c`{.sample}

Specify which channels to filter, by default all available are filtered.

`normalize, n`{.sample}

Normalize biquad coefficients, by default is disabled. Enabling it will
normalize magnitude response at DC to 0dB.

`transform, a`{.sample}

Set transform type of IIR filter.

`di`{.sample}

`dii`{.sample}

`tdi`{.sample}

`tdii`{.sample}

`latt`{.sample}

`svf`{.sample}

`zdf`{.sample}

`precision, r`{.sample}

Set precision of filtering.

`auto`{.sample}

:   Pick automatic sample format depending on surround filters.

`s16`{.sample}

:   Always use signed 16-bit.

`s32`{.sample}

:   Always use signed 32-bit.

`f32`{.sample}

:   Always use float 32-bit.

`f64`{.sample}

:   Always use float 64-bit.

`block_size, b`{.sample}

Set block size used for reverse IIR processing. If this value is set to
high enough value (higher than impulse response length truncated when
reaches near zero values) filtering will become linear phase otherwise
if not big enough it will just produce nasty artifacts.

Note that filter delay will be exactly this many samples when set to
non-zero value.

[]{#Commands-31}

#### [36.71.1 Commands](#toc-Commands-31) {#commands-31 .subsection}

This filter supports the following commands:

`frequency, f`{.sample}

:   Change bass frequency. Syntax for the command is :
    \"`frequency`{.variable}\"

`width_type, t`{.sample}

:   Change bass width_type. Syntax for the command is :
    \"`width_type`{.variable}\"

`width, w`{.sample}

:   Change bass width. Syntax for the command is :
    \"`width`{.variable}\"

`gain, g`{.sample}

:   Change bass gain. Syntax for the command is : \"`gain`{.variable}\"

`mix, m`{.sample}

:   Change bass mix. Syntax for the command is : \"`mix`{.variable}\"

[]{#biquad}

### [36.72 biquad](#toc-biquad) {#biquad .section}

Apply a biquad IIR filter with the given coefficients. Where
`b0`{.variable}, `b1`{.variable}, `b2`{.variable} and `a0`{.variable},
`a1`{.variable}, `a2`{.variable} are the numerator and denominator
coefficients respectively. and `channels`{.variable}, `c`{.variable}
specify which channels to filter, by default all available are filtered.

[]{#Commands-32}

#### [36.72.1 Commands](#toc-Commands-32) {#commands-32 .subsection}

This filter supports the following commands:

`a0`{.sample}

`a1`{.sample}

`a2`{.sample}

`b0`{.sample}

`b1`{.sample}

`b2`{.sample}

Change biquad parameter. Syntax for the command is :
\"`value`{.variable}\"

`mix, m`{.sample}

How much to use filtered signal in output. Default is 1. Range is
between 0 and 1.

`channels, c`{.sample}

Specify which channels to filter, by default all available are filtered.

`normalize, n`{.sample}

Normalize biquad coefficients, by default is disabled. Enabling it will
normalize magnitude response at DC to 0dB.

`transform, a`{.sample}

Set transform type of IIR filter.

`di`{.sample}

`dii`{.sample}

`tdi`{.sample}

`tdii`{.sample}

`latt`{.sample}

`svf`{.sample}

`zdf`{.sample}

`precision, r`{.sample}

Set precision of filtering.

`auto`{.sample}

:   Pick automatic sample format depending on surround filters.

`s16`{.sample}

:   Always use signed 16-bit.

`s32`{.sample}

:   Always use signed 32-bit.

`f32`{.sample}

:   Always use float 32-bit.

`f64`{.sample}

:   Always use float 64-bit.

`block_size, b`{.sample}

Set block size used for reverse IIR processing. If this value is set to
high enough value (higher than impulse response length truncated when
reaches near zero values) filtering will become linear phase otherwise
if not big enough it will just produce nasty artifacts.

Note that filter delay will be exactly this many samples when set to
non-zero value.

[]{#bs2b}

### [36.73 bs2b](#toc-bs2b) {#bs2b .section}

Bauer stereo to binaural transformation, which improves headphone
listening of stereo audio records.

To enable compilation of this filter you need to configure FFmpeg with
`--enable-libbs2b`.

It accepts the following parameters:

`profile`{.sample}

:   Pre-defined crossfeed level.

    `default`{.sample}

    :   Default level (fcut=700, feed=50).

    `cmoy`{.sample}

    :   Chu Moy circuit (fcut=700, feed=60).

    `jmeier`{.sample}

    :   Jan Meier circuit (fcut=650, feed=95).

`fcut`{.sample}

:   Cut frequency (in Hz).

`feed`{.sample}

:   Feed level (in Hz).

[]{#channelmap}

### [36.74 channelmap](#toc-channelmap) {#channelmap .section}

Remap input channels to new locations.

It accepts the following parameters:

`map`{.sample}

:   Map channels from input to output. The argument is a '\|'-separated
    list of mappings, each in the
    `in_channel`{.variable}`-``out_channel`{.variable} or
    `in_channel`{.variable} form. `in_channel`{.variable} can be either
    the name of the input channel (e.g. FL for front left) or its index
    in the input channel layout. `out_channel`{.variable} is the name of
    the output channel or its index in the output channel layout. If
    `out_channel`{.variable} is not given then it is implicitly an
    index, starting with zero and increasing by one for each mapping.
    Mixing different types of mappings is not allowed and will result in
    a parse error.

`channel_layout`{.sample}

:   The channel layout of the output stream. If not specified, then
    filter will guess it based on the `out_channel`{.variable} names or
    the number of mappings. Guessed layouts will not necessarily contain
    channels in the order of the mappings.

If no mapping is present, the filter will implicitly map input channels
to output channels, preserving indices.

[]{#Examples-65}

#### [36.74.1 Examples](#toc-Examples-65) {#examples-65 .subsection}

- For example, assuming a 5.1+downmix input MOV file,

  ::: example
  ``` example
  ffmpeg -i in.mov -filter 'channelmap=map=DL-FL|DR-FR' out.wav
  ```
  :::

  will create an output WAV file tagged as stereo from the downmix
  channels of the input.

- To fix a 5.1 WAV improperly encoded in AAC's native channel order

  ::: example
  ``` example
  ffmpeg -i in.wav -filter 'channelmap=1|2|0|5|3|4:5.1' out.wav
  ```
  :::

[]{#channelsplit}

### [36.75 channelsplit](#toc-channelsplit) {#channelsplit .section}

Split each channel from an input audio stream into a separate output
stream.

It accepts the following parameters:

`channel_layout`{.sample}

:   The channel layout of the input stream. The default is \"stereo\".

`channels`{.sample}

:   A channel layout describing the channels to be extracted as separate
    output streams or \"all\" to extract each input channel as a
    separate stream. The default is \"all\".

    Choosing channels not present in channel layout in the input will
    result in an error.

[]{#Examples-66}

#### [36.75.1 Examples](#toc-Examples-66) {#examples-66 .subsection}

- For example, assuming a stereo input MP3 file,

  ::: example
  ``` example
  ffmpeg -i in.mp3 -filter_complex channelsplit out.mkv
  ```
  :::

  will create an output Matroska file with two audio streams, one
  containing only the left channel and the other the right channel.

- Split a 5.1 WAV file into per-channel files:

  ::: example
  ``` example
  ffmpeg -i in.wav -filter_complex
  'channelsplit=channel_layout=5.1[FL][FR][FC][LFE][SL][SR]'
  -map '[FL]' front_left.wav -map '[FR]' front_right.wav -map '[FC]'
  front_center.wav -map '[LFE]' lfe.wav -map '[SL]' side_left.wav -map '[SR]'
  side_right.wav
  ```
  :::

- Extract only LFE from a 5.1 WAV file:

  ::: example
  ``` example
  ffmpeg -i in.wav -filter_complex 'channelsplit=channel_layout=5.1:channels=LFE[LFE]'
  -map '[LFE]' lfe.wav
  ```
  :::

[]{#chorus}

### [36.76 chorus](#toc-chorus) {#chorus .section}

Add a chorus effect to the audio.

Can make a single vocal sound like a chorus, but can also be applied to
instrumentation.

Chorus resembles an echo effect with a short delay, but whereas with
echo the delay is constant, with chorus, it is varied using sinusoidal
or triangular modulation. The modulation depth defines the range the
modulated delay is played before or after the delay. Hence the delayed
sound will sound slower or faster, that is the delayed sound tuned
around the original one, like in a chorus where some vocals are slightly
off key.

It accepts the following parameters:

`in_gain`{.sample}

:   Set input gain. Default is 0.4.

`out_gain`{.sample}

:   Set output gain. Default is 0.4.

`delays`{.sample}

:   Set delays. A typical delay is around 40ms to 60ms.

`decays`{.sample}

:   Set decays.

`speeds`{.sample}

:   Set speeds.

`depths`{.sample}

:   Set depths.

[]{#Examples-67}

#### [36.76.1 Examples](#toc-Examples-67) {#examples-67 .subsection}

- A single delay:

  ::: example
  ``` example
  chorus=0.7:0.9:55:0.4:0.25:2
  ```
  :::
- Two delays:

  ::: example
  ``` example
  chorus=0.6:0.9:50|60:0.4|0.32:0.25|0.4:2|1.3
  ```
  :::
- Fuller sounding chorus with three delays:

  ::: example
  ``` example
  chorus=0.5:0.9:50|60|40:0.4|0.32|0.3:0.25|0.4|0.3:2|2.3|1.3
  ```
  :::

[]{#compand}

### [36.77 compand](#toc-compand) {#compand .section}

Compress or expand the audio's dynamic range.

It accepts the following parameters:

`attacks`{.sample}\
`decays`{.sample}

:   A list of times in seconds for each channel over which the
    instantaneous level of the input signal is averaged to determine its
    volume. `attacks`{.variable} refers to increase of volume and
    `decays`{.variable} refers to decrease of volume. For most
    situations, the attack time (response to the audio getting louder)
    should be shorter than the decay time, because the human ear is more
    sensitive to sudden loud audio than sudden soft audio. A typical
    value for attack is 0.3 seconds and a typical value for decay is 0.8
    seconds. If specified number of attacks & decays is lower than
    number of channels, the last set attack/decay will be used for all
    remaining channels.

`points`{.sample}

:   A list of points for the transfer function, specified in dB relative
    to the maximum possible signal amplitude. Each key points list must
    be defined using the following syntax: `x0/y0|x1/y1|x2/y2|....` or
    `x0/y0 x1/y1 x2/y2 ....`

    The input values must be in strictly increasing order but the
    transfer function does not have to be monotonically rising. The
    point `0/0` is assumed but may be overridden (by `0/out-dBn`).
    Typical values for the transfer function are `-70/-70|-60/-20|1/0`.

`soft-knee`{.sample}

:   Set the curve radius in dB for all joints. It defaults to 0.01.

`gain`{.sample}

:   Set the additional gain in dB to be applied at all points on the
    transfer function. This allows for easy adjustment of the overall
    gain. It defaults to 0.

`volume`{.sample}

:   Set an initial volume, in dB, to be assumed for each channel when
    filtering starts. This permits the user to supply a nominal level
    initially, so that, for example, a very large gain is not applied to
    initial signal levels before the companding has begun to operate. A
    typical value for audio which is initially quiet is -90 dB. It
    defaults to 0.

`delay`{.sample}

:   Set a delay, in seconds. The input audio is analyzed immediately,
    but audio is delayed before being fed to the volume adjuster.
    Specifying a delay approximately equal to the attack/decay times
    allows the filter to effectively operate in predictive rather than
    reactive mode. It defaults to 0.

[]{#Examples-68}

#### [36.77.1 Examples](#toc-Examples-68) {#examples-68 .subsection}

- Make music with both quiet and loud passages suitable for listening to
  in a noisy environment:

  ::: example
  ``` example
  compand=.3|.3:1|1:-90/-60|-60/-40|-40/-30|-20/-20:6:0:-90:0.2
  ```
  :::

  Another example for audio with whisper and explosion parts:

  ::: example
  ``` example
  compand=0|0:1|1:-90/-900|-70/-70|-30/-9|0/-3:6:0:0:0
  ```
  :::

- A noise gate for when the noise is at a lower level than the signal:

  ::: example
  ``` example
  compand=.1|.1:.2|.2:-900/-900|-50.1/-900|-50/-50:.01:0:-90:.1
  ```
  :::

- Here is another noise gate, this time for when the noise is at a
  higher level than the signal (making it, in some ways, similar to
  squelch):

  ::: example
  ``` example
  compand=.1|.1:.1|.1:-45.1/-45.1|-45/-900|0/-900:.01:45:-90:.1
  ```
  :::

- 2:1 compression starting at -6dB:

  ::: example
  ``` example
  compand=points=-80/-80|-6/-6|0/-3.8|20/3.5
  ```
  :::

- 2:1 compression starting at -9dB:

  ::: example
  ``` example
  compand=points=-80/-80|-9/-9|0/-5.3|20/2.9
  ```
  :::

- 2:1 compression starting at -12dB:

  ::: example
  ``` example
  compand=points=-80/-80|-12/-12|0/-6.8|20/1.9
  ```
  :::

- 2:1 compression starting at -18dB:

  ::: example
  ``` example
  compand=points=-80/-80|-18/-18|0/-9.8|20/0.7
  ```
  :::

- 3:1 compression starting at -15dB:

  ::: example
  ``` example
  compand=points=-80/-80|-15/-15|0/-10.8|20/-5.2
  ```
  :::

- Compressor/Gate:

  ::: example
  ``` example
  compand=points=-80/-105|-62/-80|-15.4/-15.4|0/-12|20/-7.6
  ```
  :::

- Expander:

  ::: example
  ``` example
  compand=attacks=0:points=-80/-169|-54/-80|-49.5/-64.6|-41.1/-41.1|-25.8/-15|-10.8/-4.5|0/0|20/8.3
  ```
  :::

- Hard limiter at -6dB:

  ::: example
  ``` example
  compand=attacks=0:points=-80/-80|-6/-6|20/-6
  ```
  :::

- Hard limiter at -12dB:

  ::: example
  ``` example
  compand=attacks=0:points=-80/-80|-12/-12|20/-12
  ```
  :::

- Hard noise gate at -35 dB:

  ::: example
  ``` example
  compand=attacks=0:points=-80/-115|-35.1/-80|-35/-35|20/20
  ```
  :::

- Soft limiter:

  ::: example
  ``` example
  compand=attacks=0:points=-80/-80|-12.4/-12.4|-6/-8|0/-6.8|20/-2.8
  ```
  :::

[]{#compensationdelay}

### [36.78 compensationdelay](#toc-compensationdelay) {#compensationdelay .section}

Compensation Delay Line is a metric based delay to compensate differing
positions of microphones or speakers.

For example, you have recorded guitar with two microphones placed in
different locations. Because the front of sound wave has fixed speed in
normal conditions, the phasing of microphones can vary and depends on
their location and interposition. The best sound mix can be achieved
when these microphones are in phase (synchronized). Note that a distance
of \~30 cm between microphones makes one microphone capture the signal
in antiphase to the other microphone. That makes the final mix sound
moody. This filter helps to solve phasing problems by adding different
delays to each microphone track and make them synchronized.

The best result can be reached when you take one track as base and
synchronize other tracks one by one with it. Remember that
synchronization/delay tolerance depends on sample rate, too. Higher
sample rates will give more tolerance.

The filter accepts the following parameters:

`mm`{.sample}

:   Set millimeters distance. This is compensation distance for fine
    tuning. Default is 0.

`cm`{.sample}

:   Set cm distance. This is compensation distance for tightening
    distance setup. Default is 0.

`m`{.sample}

:   Set meters distance. This is compensation distance for hard distance
    setup. Default is 0.

`dry`{.sample}

:   Set dry amount. Amount of unprocessed (dry) signal. Default is 0.

`wet`{.sample}

:   Set wet amount. Amount of processed (wet) signal. Default is 1.

`temp`{.sample}

:   Set temperature in degrees Celsius. This is the temperature of the
    environment. Default is 20.

[]{#Commands-33}

#### [36.78.1 Commands](#toc-Commands-33) {#commands-33 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#crossfeed}

### [36.79 crossfeed](#toc-crossfeed) {#crossfeed .section}

Apply headphone crossfeed filter.

Crossfeed is the process of blending the left and right channels of
stereo audio recording. It is mainly used to reduce extreme stereo
separation of low frequencies.

The intent is to produce more speaker like sound to the listener.

The filter accepts the following options:

`strength`{.sample}

:   Set strength of crossfeed. Default is 0.2. Allowed range is from 0
    to 1. This sets gain of low shelf filter for side part of stereo
    image. Default is -6dB. Max allowed is -30db when strength is set to
    1.

`range`{.sample}

:   Set soundstage wideness. Default is 0.5. Allowed range is from 0
    to 1. This sets cut off frequency of low shelf filter. Default is
    cut off near 1550 Hz. With range set to 1 cut off frequency is set
    to 2100 Hz.

`slope`{.sample}

:   Set curve slope of low shelf filter. Default is 0.5. Allowed range
    is from 0.01 to 1.

`level_in`{.sample}

:   Set input gain. Default is 0.9.

`level_out`{.sample}

:   Set output gain. Default is 1.

`block_size`{.sample}

:   Set block size used for reverse IIR processing. If this value is set
    to high enough value (higher than impulse response length truncated
    when reaches near zero values) filtering will become linear phase
    otherwise if not big enough it will just produce nasty artifacts.

    Note that filter delay will be exactly this many samples when set to
    non-zero value.

[]{#Commands-34}

#### [36.79.1 Commands](#toc-Commands-34) {#commands-34 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#crystalizer}

### [36.80 crystalizer](#toc-crystalizer) {#crystalizer .section}

Simple algorithm for audio noise sharpening.

This filter linearly increases differences between each audio sample.

The filter accepts the following options:

`i`{.sample}

:   Sets the intensity of effect (default: 2.0). Must be in range
    between -10.0 to 0 (unchanged sound) to 10.0 (maximum effect). To
    inverse filtering use negative value.

`c`{.sample}

:   Enable clipping. By default is enabled.

[]{#Commands-35}

#### [36.80.1 Commands](#toc-Commands-35) {#commands-35 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#dcshift}

### [36.81 dcshift](#toc-dcshift) {#dcshift .section}

Apply a DC shift to the audio.

This can be useful to remove a DC offset (caused perhaps by a hardware
problem in the recording chain) from the audio. The effect of a DC
offset is reduced headroom and hence volume. The [astats](#astats)
filter can be used to determine if a signal has a DC offset.

`shift`{.sample}

:   Set the DC shift, allowed range is \[-1, 1\]. It indicates the
    amount to shift the audio.

`limitergain`{.sample}

:   Optional. It should have a value much less than 1 (e.g. 0.05 or
    0.02) and is used to prevent clipping.

[]{#deesser}

### [36.82 deesser](#toc-deesser) {#deesser .section}

Apply de-essing to the audio samples.

`i`{.sample}

:   Set intensity for triggering de-essing. Allowed range is from 0
    to 1. Default is 0.

`m`{.sample}

:   Set amount of ducking on treble part of sound. Allowed range is from
    0 to 1. Default is 0.5.

`f`{.sample}

:   How much of original frequency content to keep when de-essing.
    Allowed range is from 0 to 1. Default is 0.5.

`s`{.sample}

:   Set the output mode.

    It accepts the following values:

    `i`{.sample}

    :   Pass input unchanged.

    `o`{.sample}

    :   Pass ess filtered out.

    `e`{.sample}

    :   Pass only ess.

        Default value is `o`{.variable}.

[]{#dialoguenhance}

### [36.83 dialoguenhance](#toc-dialoguenhance) {#dialoguenhance .section}

Enhance dialogue in stereo audio.

This filter accepts stereo input and produce surround (3.0) channels
output. The newly produced front center channel have enhanced speech
dialogue originally available in both stereo channels. This filter
outputs front left and front right channels same as available in stereo
input.

The filter accepts the following options:

`original`{.sample}

:   Set the original center factor to keep in front center channel
    output. Allowed range is from 0 to 1. Default value is 1.

`enhance`{.sample}

:   Set the dialogue enhance factor to put in front center channel
    output. Allowed range is from 0 to 3. Default value is 1.

`voice`{.sample}

:   Set the voice detection factor. Allowed range is from 2 to 32.
    Default value is 2.

[]{#Commands-36}

#### [36.83.1 Commands](#toc-Commands-36) {#commands-36 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#drmeter}

### [36.84 drmeter](#toc-drmeter) {#drmeter .section}

Measure audio dynamic range.

DR values of 14 and higher is found in very dynamic material. DR of 8 to
13 is found in transition material. And anything less that 8 have very
poor dynamics and is very compressed.

The filter accepts the following options:

`length`{.sample}

:   Set window length in seconds used to split audio into segments of
    equal length. Default is 3 seconds.

[]{#dynaudnorm}

### [36.85 dynaudnorm](#toc-dynaudnorm) {#dynaudnorm .section}

Dynamic Audio Normalizer.

This filter applies a certain amount of gain to the input audio in order
to bring its peak magnitude to a target level (e.g. 0 dBFS). However, in
contrast to more \"simple\" normalization algorithms, the Dynamic Audio
Normalizer \*dynamically\* re-adjusts the gain factor to the input
audio. This allows for applying extra gain to the \"quiet\" sections of
the audio while avoiding distortions or clipping the \"loud\" sections.
In other words: The Dynamic Audio Normalizer will \"even out\" the
volume of quiet and loud sections, in the sense that the volume of each
section is brought to the same target level. Note, however, that the
Dynamic Audio Normalizer achieves this goal \*without\* applying
\"dynamic range compressing\". It will retain 100% of the dynamic range
\*within\* each section of the audio file.

`framelen, f`{.sample}

:   Set the frame length in milliseconds. In range from 10 to 8000
    milliseconds. Default is 500 milliseconds. The Dynamic Audio
    Normalizer processes the input audio in small chunks, referred to as
    frames. This is required, because a peak magnitude has no meaning
    for just a single sample value. Instead, we need to determine the
    peak magnitude for a contiguous sequence of sample values. While a
    \"standard\" normalizer would simply use the peak magnitude of the
    complete file, the Dynamic Audio Normalizer determines the peak
    magnitude individually for each frame. The length of a frame is
    specified in milliseconds. By default, the Dynamic Audio Normalizer
    uses a frame length of 500 milliseconds, which has been found to
    give good results with most files. Note that the exact frame length,
    in number of samples, will be determined automatically, based on the
    sampling rate of the individual input audio file.

`gausssize, g`{.sample}

:   Set the Gaussian filter window size. In range from 3 to 301, must be
    odd number. Default is 31. Probably the most important parameter of
    the Dynamic Audio Normalizer is the `window size` of the Gaussian
    smoothing filter. The filter's window size is specified in frames,
    centered around the current frame. For the sake of simplicity, this
    must be an odd number. Consequently, the default value of 31 takes
    into account the current frame, as well as the 15 preceding frames
    and the 15 subsequent frames. Using a larger window results in a
    stronger smoothing effect and thus in less gain variation, i.e.
    slower gain adaptation. Conversely, using a smaller window results
    in a weaker smoothing effect and thus in more gain variation, i.e.
    faster gain adaptation. In other words, the more you increase this
    value, the more the Dynamic Audio Normalizer will behave like a
    \"traditional\" normalization filter. On the contrary, the more you
    decrease this value, the more the Dynamic Audio Normalizer will
    behave like a dynamic range compressor.

`peak, p`{.sample}

:   Set the target peak value. This specifies the highest permissible
    magnitude level for the normalized audio input. This filter will try
    to approach the target peak magnitude as closely as possible, but at
    the same time it also makes sure that the normalized signal will
    never exceed the peak magnitude. A frame's maximum local gain factor
    is imposed directly by the target peak magnitude. The default value
    is 0.95 and thus leaves a headroom of 5%\*. It is not recommended to
    go above this value.

`maxgain, m`{.sample}

:   Set the maximum gain factor. In range from 1.0 to 100.0. Default is
    10.0. The Dynamic Audio Normalizer determines the maximum possible
    (local) gain factor for each input frame, i.e. the maximum gain
    factor that does not result in clipping or distortion. The maximum
    gain factor is determined by the frame's highest magnitude sample.
    However, the Dynamic Audio Normalizer additionally bounds the
    frame's maximum gain factor by a predetermined (global) maximum gain
    factor. This is done in order to avoid excessive gain factors in
    \"silent\" or almost silent frames. By default, the maximum gain
    factor is 10.0, For most inputs the default value should be
    sufficient and it usually is not recommended to increase this value.
    Though, for input with an extremely low overall volume level, it may
    be necessary to allow even higher gain factors. Note, however, that
    the Dynamic Audio Normalizer does not simply apply a \"hard\"
    threshold (i.e. cut off values above the threshold). Instead, a
    \"sigmoid\" threshold function will be applied. This way, the gain
    factors will smoothly approach the threshold value, but never exceed
    that value.

`targetrms, r`{.sample}

:   Set the target RMS. In range from 0.0 to 1.0. Default is 0.0 -
    disabled. By default, the Dynamic Audio Normalizer performs \"peak\"
    normalization. This means that the maximum local gain factor for
    each frame is defined (only) by the frame's highest magnitude
    sample. This way, the samples can be amplified as much as possible
    without exceeding the maximum signal level, i.e. without clipping.
    Optionally, however, the Dynamic Audio Normalizer can also take into
    account the frame's root mean square, abbreviated RMS. In electrical
    engineering, the RMS is commonly used to determine the power of a
    time-varying signal. It is therefore considered that the RMS is a
    better approximation of the \"perceived loudness\" than just looking
    at the signal's peak magnitude. Consequently, by adjusting all
    frames to a constant RMS value, a uniform \"perceived loudness\" can
    be established. If a target RMS value has been specified, a frame's
    local gain factor is defined as the factor that would result in
    exactly that RMS value. Note, however, that the maximum local gain
    factor is still restricted by the frame's highest magnitude sample,
    in order to prevent clipping.

`coupling, n`{.sample}

:   Enable channels coupling. By default is enabled. By default, the
    Dynamic Audio Normalizer will amplify all channels by the same
    amount. This means the same gain factor will be applied to all
    channels, i.e. the maximum possible gain factor is determined by the
    \"loudest\" channel. However, in some recordings, it may happen that
    the volume of the different channels is uneven, e.g. one channel may
    be \"quieter\" than the other one(s). In this case, this option can
    be used to disable the channel coupling. This way, the gain factor
    will be determined independently for each channel, depending only on
    the individual channel's highest magnitude sample. This allows for
    harmonizing the volume of the different channels.

`correctdc, c`{.sample}

:   Enable DC bias correction. By default is disabled. An audio signal
    (in the time domain) is a sequence of sample values. In the Dynamic
    Audio Normalizer these sample values are represented in the -1.0 to
    1.0 range, regardless of the original input format. Normally, the
    audio signal, or \"waveform\", should be centered around the zero
    point. That means if we calculate the mean value of all samples in a
    file, or in a single frame, then the result should be 0.0 or at
    least very close to that value. If, however, there is a significant
    deviation of the mean value from 0.0, in either positive or negative
    direction, this is referred to as a DC bias or DC offset. Since a DC
    bias is clearly undesirable, the Dynamic Audio Normalizer provides
    optional DC bias correction. With DC bias correction enabled, the
    Dynamic Audio Normalizer will determine the mean value, or \"DC
    correction\" offset, of each input frame and subtract that value
    from all of the frame's sample values which ensures those samples
    are centered around 0.0 again. Also, in order to avoid \"gaps\" at
    the frame boundaries, the DC correction offset values will be
    interpolated smoothly between neighbouring frames.

`altboundary, b`{.sample}

:   Enable alternative boundary mode. By default is disabled. The
    Dynamic Audio Normalizer takes into account a certain neighbourhood
    around each frame. This includes the preceding frames as well as the
    subsequent frames. However, for the \"boundary\" frames, located at
    the very beginning and at the very end of the audio file, not all
    neighbouring frames are available. In particular, for the first few
    frames in the audio file, the preceding frames are not known. And,
    similarly, for the last few frames in the audio file, the subsequent
    frames are not known. Thus, the question arises which gain factors
    should be assumed for the missing frames in the \"boundary\" region.
    The Dynamic Audio Normalizer implements two modes to deal with this
    situation. The default boundary mode assumes a gain factor of
    exactly 1.0 for the missing frames, resulting in a smooth \"fade
    in\" and \"fade out\" at the beginning and at the end of the input,
    respectively.

`compress, s`{.sample}

:   Set the compress factor. In range from 0.0 to 30.0. Default is 0.0.
    By default, the Dynamic Audio Normalizer does not apply
    \"traditional\" compression. This means that signal peaks will not
    be pruned and thus the full dynamic range will be retained within
    each local neighbourhood. However, in some cases it may be desirable
    to combine the Dynamic Audio Normalizer's normalization algorithm
    with a more \"traditional\" compression. For this purpose, the
    Dynamic Audio Normalizer provides an optional compression
    (thresholding) function. If (and only if) the compression feature is
    enabled, all input frames will be processed by a soft knee
    thresholding function prior to the actual normalization process. Put
    simply, the thresholding function is going to prune all samples
    whose magnitude exceeds a certain threshold value. However, the
    Dynamic Audio Normalizer does not simply apply a fixed threshold
    value. Instead, the threshold value will be adjusted for each
    individual frame. In general, smaller parameters result in stronger
    compression, and vice versa. Values below 3.0 are not recommended,
    because audible distortion may appear.

`threshold, t`{.sample}

:   Set the target threshold value. This specifies the lowest
    permissible magnitude level for the audio input which will be
    normalized. If input frame volume is above this value frame will be
    normalized. Otherwise frame may not be normalized at all. The
    default value is set to 0, which means all input frames will be
    normalized. This option is mostly useful if digital noise is not
    wanted to be amplified.

`channels, h`{.sample}

:   Specify which channels to filter, by default all available channels
    are filtered.

`overlap, o`{.sample}

:   Specify overlap for frames. If set to 0 (default) no frame
    overlapping is done. Using \>0 and \<1 values will make less
    conservative gain adjustments, like when framelen option is set to
    smaller value, if framelen option value is compensated for non-zero
    overlap then gain adjustments will be smoother across time compared
    to zero overlap case.

`curve, v`{.sample}

:   Specify the peak mapping curve expression which is going to be used
    when calculating gain applied to frames. The max output frame gain
    will still be limited by other options mentioned previously for this
    filter.

    The expression can contain the following constants:

    `ch`{.sample}

    :   current channel number

    `sn`{.sample}

    :   current sample number

    `nb_channels`{.sample}

    :   number of channels

    `t`{.sample}

    :   timestamp expressed in seconds

    `sr`{.sample}

    :   sample rate

    `p`{.sample}

    :   current frame peak value

[]{#Commands-37}

#### [36.85.1 Commands](#toc-Commands-37) {#commands-37 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#earwax}

### [36.86 earwax](#toc-earwax) {#earwax .section}

Make audio easier to listen to on headphones.

This filter adds 'cues' to 44.1kHz stereo (i.e. audio CD format) audio
so that when listened to on headphones the stereo image is moved from
inside your head (standard for headphones) to outside and in front of
the listener (standard for speakers).

Ported from SoX.

[]{#equalizer}

### [36.87 equalizer](#toc-equalizer) {#equalizer .section}

Apply a two-pole peaking equalisation (EQ) filter. With this filter, the
signal-level at and around a selected frequency can be increased or
decreased, whilst (unlike bandpass and bandreject filters) that at all
other frequencies is unchanged.

In order to produce complex equalisation curves, this filter can be
given several times, each with a different central frequency.

The filter accepts the following options:

`frequency, f`{.sample}

Set the filter's central frequency in Hz.

`width_type, t`{.sample}

Set method to specify band-width of filter.

`h`{.sample}

:   Hz

`q`{.sample}

:   Q-Factor

`o`{.sample}

:   octave

`s`{.sample}

:   slope

`k`{.sample}

:   kHz

`width, w`{.sample}

Specify the band-width of a filter in width_type units.

`gain, g`{.sample}

Set the required gain or attenuation in dB. Beware of clipping when
using a positive gain.

`mix, m`{.sample}

How much to use filtered signal in output. Default is 1. Range is
between 0 and 1.

`channels, c`{.sample}

Specify which channels to filter, by default all available are filtered.

`normalize, n`{.sample}

Normalize biquad coefficients, by default is disabled. Enabling it will
normalize magnitude response at DC to 0dB.

`transform, a`{.sample}

Set transform type of IIR filter.

`di`{.sample}

`dii`{.sample}

`tdi`{.sample}

`tdii`{.sample}

`latt`{.sample}

`svf`{.sample}

`zdf`{.sample}

`precision, r`{.sample}

Set precision of filtering.

`auto`{.sample}

:   Pick automatic sample format depending on surround filters.

`s16`{.sample}

:   Always use signed 16-bit.

`s32`{.sample}

:   Always use signed 32-bit.

`f32`{.sample}

:   Always use float 32-bit.

`f64`{.sample}

:   Always use float 64-bit.

`block_size, b`{.sample}

Set block size used for reverse IIR processing. If this value is set to
high enough value (higher than impulse response length truncated when
reaches near zero values) filtering will become linear phase otherwise
if not big enough it will just produce nasty artifacts.

Note that filter delay will be exactly this many samples when set to
non-zero value.

[]{#Examples-69}

#### [36.87.1 Examples](#toc-Examples-69) {#examples-69 .subsection}

- Attenuate 10 dB at 1000 Hz, with a bandwidth of 200 Hz:

  ::: example
  ``` example
  equalizer=f=1000:t=h:width=200:g=-10
  ```
  :::
- Apply 2 dB gain at 1000 Hz with Q 1 and attenuate 5 dB at 100 Hz with
  Q 2:

  ::: example
  ``` example
  equalizer=f=1000:t=q:w=1:g=2,equalizer=f=100:t=q:w=2:g=-5
  ```
  :::

[]{#Commands-38}

#### [36.87.2 Commands](#toc-Commands-38) {#commands-38 .subsection}

This filter supports the following commands:

`frequency, f`{.sample}

:   Change equalizer frequency. Syntax for the command is :
    \"`frequency`{.variable}\"

`width_type, t`{.sample}

:   Change equalizer width_type. Syntax for the command is :
    \"`width_type`{.variable}\"

`width, w`{.sample}

:   Change equalizer width. Syntax for the command is :
    \"`width`{.variable}\"

`gain, g`{.sample}

:   Change equalizer gain. Syntax for the command is :
    \"`gain`{.variable}\"

`mix, m`{.sample}

:   Change equalizer mix. Syntax for the command is :
    \"`mix`{.variable}\"

[]{#extrastereo}

### [36.88 extrastereo](#toc-extrastereo) {#extrastereo .section}

Linearly increases the difference between left and right channels which
adds some sort of \"live\" effect to playback.

The filter accepts the following options:

`m`{.sample}

:   Sets the difference coefficient (default: 2.5). 0.0 means mono sound
    (average of both channels), with 1.0 sound will be unchanged, with
    -1.0 left and right channels will be swapped.

`c`{.sample}

:   Enable clipping. By default is enabled.

[]{#Commands-39}

#### [36.88.1 Commands](#toc-Commands-39) {#commands-39 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#firequalizer}

### [36.89 firequalizer](#toc-firequalizer) {#firequalizer .section}

Apply FIR Equalization using arbitrary frequency response.

The filter accepts the following option:

`gain`{.sample}

:   Set gain curve equation (in dB). The expression can contain
    variables:

    `f`{.sample}

    :   the evaluated frequency

    `sr`{.sample}

    :   sample rate

    `ch`{.sample}

    :   channel number, set to 0 when multichannels evaluation is
        disabled

    `chid`{.sample}

    :   channel id, see libavutil/channel_layout.h, set to the first
        channel id when multichannels evaluation is disabled

    `chs`{.sample}

    :   number of channels

    `chlayout`{.sample}

    :   channel_layout, see libavutil/channel_layout.h

    and functions:

    `gain_interpolate(f)`{.sample}

    :   interpolate gain on frequency f based on gain_entry

    `cubic_interpolate(f)`{.sample}

    :   same as gain_interpolate, but smoother

    This option is also available as command. Default is
    `gain_interpolate(f)`.

`gain_entry`{.sample}

:   Set gain entry for gain_interpolate function. The expression can
    contain functions:

    `entry(f, g)`{.sample}

    :   store gain entry at frequency f with value g

    This option is also available as command.

`delay`{.sample}

:   Set filter delay in seconds. Higher value means more accurate.
    Default is `0.01`.

`accuracy`{.sample}

:   Set filter accuracy in Hz. Lower value means more accurate. Default
    is `5`.

`wfunc`{.sample}

:   Set window function. Acceptable values are:

    `rectangular`{.sample}

    :   rectangular window, useful when gain curve is already smooth

    `hann`{.sample}

    :   hann window (default)

    `hamming`{.sample}

    :   hamming window

    `blackman`{.sample}

    :   blackman window

    `nuttall3`{.sample}

    :   3-terms continuous 1st derivative nuttall window

    `mnuttall3`{.sample}

    :   minimum 3-terms discontinuous nuttall window

    `nuttall`{.sample}

    :   4-terms continuous 1st derivative nuttall window

    `bnuttall`{.sample}

    :   minimum 4-terms discontinuous nuttall (blackman-nuttall) window

    `bharris`{.sample}

    :   blackman-harris window

    `tukey`{.sample}

    :   tukey window

`fixed`{.sample}

:   If enabled, use fixed number of audio samples. This improves speed
    when filtering with large delay. Default is disabled.

`multi`{.sample}

:   Enable multichannels evaluation on gain. Default is disabled.

`zero_phase`{.sample}

:   Enable zero phase mode by subtracting timestamp to compensate delay.
    Default is disabled.

`scale`{.sample}

:   Set scale used by gain. Acceptable values are:

    `linlin`{.sample}

    :   linear frequency, linear gain

    `linlog`{.sample}

    :   linear frequency, logarithmic (in dB) gain (default)

    `loglin`{.sample}

    :   logarithmic (in octave scale where 20 Hz is 0) frequency, linear
        gain

    `loglog`{.sample}

    :   logarithmic frequency, logarithmic gain

`dumpfile`{.sample}

:   Set file for dumping, suitable for gnuplot.

`dumpscale`{.sample}

:   Set scale for dumpfile. Acceptable values are same with scale
    option. Default is linlog.

`fft2`{.sample}

:   Enable 2-channel convolution using complex FFT. This improves speed
    significantly. Default is disabled.

`min_phase`{.sample}

:   Enable minimum phase impulse response. Default is disabled.

[]{#Examples-70}

#### [36.89.1 Examples](#toc-Examples-70) {#examples-70 .subsection}

- lowpass at 1000 Hz:

  ::: example
  ``` example
  firequalizer=gain='if(lt(f,1000), 0, -INF)'
  ```
  :::
- lowpass at 1000 Hz with gain_entry:

  ::: example
  ``` example
  firequalizer=gain_entry='entry(1000,0); entry(1001, -INF)'
  ```
  :::
- custom equalization:

  ::: example
  ``` example
  firequalizer=gain_entry='entry(100,0); entry(400, -4); entry(1000, -6); entry(2000, 0)'
  ```
  :::
- higher delay with zero phase to compensate delay:

  ::: example
  ``` example
  firequalizer=delay=0.1:fixed=on:zero_phase=on
  ```
  :::
- lowpass on left channel, highpass on right channel:

  ::: example
  ``` example
  firequalizer=gain='if(eq(chid,1), gain_interpolate(f), if(eq(chid,2), gain_interpolate(1e6+f), 0))'
  :gain_entry='entry(1000, 0); entry(1001,-INF); entry(1e6+1000,0)':multi=on
  ```
  :::

[]{#flanger}

### [36.90 flanger](#toc-flanger) {#flanger .section}

Apply a flanging effect to the audio.

The filter accepts the following options:

`delay`{.sample}

:   Set base delay in milliseconds. Range from 0 to 30. Default value is
    0.

`depth`{.sample}

:   Set added sweep delay in milliseconds. Range from 0 to 10. Default
    value is 2.

`regen`{.sample}

:   Set percentage regeneration (delayed signal feedback). Range from
    -95 to 95. Default value is 0.

`width`{.sample}

:   Set percentage of delayed signal mixed with original. Range from 0
    to 100. Default value is 71.

`speed`{.sample}

:   Set sweeps per second (Hz). Range from 0.1 to 10. Default value is
    0.5.

`shape`{.sample}

:   Set swept wave shape, can be `triangular`{.variable} or
    `sinusoidal`{.variable}. Default value is `sinusoidal`{.variable}.

`phase`{.sample}

:   Set swept wave percentage-shift for multi channel. Range from 0
    to 100. Default value is 25.

`interp`{.sample}

:   Set delay-line interpolation, `linear`{.variable} or
    `quadratic`{.variable}. Default is `linear`{.variable}.

[]{#haas}

### [36.91 haas](#toc-haas) {#haas .section}

Apply Haas effect to audio.

Note that this makes most sense to apply on mono signals. With this
filter applied to mono signals it give some directionality and stretches
its stereo image.

The filter accepts the following options:

`level_in`{.sample}

:   Set input level. By default is `1`{.variable}, or 0dB

`level_out`{.sample}

:   Set output level. By default is `1`{.variable}, or 0dB.

`side_gain`{.sample}

:   Set gain applied to side part of signal. By default is
    `1`{.variable}.

`middle_source`{.sample}

:   Set kind of middle source. Can be one of the following:

    '`left`{.sample}'

    :   Pick left channel.

    '`right`{.sample}'

    :   Pick right channel.

    '`mid`{.sample}'

    :   Pick middle part signal of stereo image.

    '`side`{.sample}'

    :   Pick side part signal of stereo image.

`middle_phase`{.sample}

:   Change middle phase. By default is disabled.

`left_delay`{.sample}

:   Set left channel delay. By default is `2.05`{.variable}
    milliseconds.

`left_balance`{.sample}

:   Set left channel balance. By default is `-1`{.variable}.

`left_gain`{.sample}

:   Set left channel gain. By default is `1`{.variable}.

`left_phase`{.sample}

:   Change left phase. By default is disabled.

`right_delay`{.sample}

:   Set right channel delay. By defaults is `2.12`{.variable}
    milliseconds.

`right_balance`{.sample}

:   Set right channel balance. By default is `1`{.variable}.

`right_gain`{.sample}

:   Set right channel gain. By default is `1`{.variable}.

`right_phase`{.sample}

:   Change right phase. By default is enabled.

[]{#hdcd}

### [36.92 hdcd](#toc-hdcd) {#hdcd .section}

Decodes High Definition Compatible Digital (HDCD) data. A 16-bit PCM
stream with embedded HDCD codes is expanded into a 20-bit PCM stream.

The filter supports the Peak Extend and Low-level Gain Adjustment
features of HDCD, and detects the Transient Filter flag.

::: example
``` example
ffmpeg -i HDCD16.flac -af hdcd OUT24.flac
```
:::

When using the filter with wav, note the default encoding for wav is
16-bit, so the resulting 20-bit stream will be truncated back to 16-bit.
Use something like `-acodec pcm_s24le` after the filter to get 24-bit
PCM output.

::: example
``` example
ffmpeg -i HDCD16.wav -af hdcd OUT16.wav
ffmpeg -i HDCD16.wav -af hdcd -c:a pcm_s24le OUT24.wav
```
:::

The filter accepts the following options:

`disable_autoconvert`{.sample}

:   Disable any automatic format conversion or resampling in the filter
    graph.

`process_stereo`{.sample}

:   Process the stereo channels together. If target_gain does not match
    between channels, consider it invalid and use the last valid
    target_gain.

`cdt_ms`{.sample}

:   Set the code detect timer period in ms.

`force_pe`{.sample}

:   Always extend peaks above -3dBFS even if PE isn't signaled.

`analyze_mode`{.sample}

:   Replace audio with a solid tone and adjust the amplitude to signal
    some specific aspect of the decoding process. The output file can be
    loaded in an audio editor alongside the original to aid analysis.

    `analyze_mode=pe:force_pe=true` can be used to see all samples above
    the PE level.

    Modes are:

    '`0, off`{.sample}'

    :   Disabled

    '`1, lle`{.sample}'

    :   Gain adjustment level at each sample

    '`2, pe`{.sample}'

    :   Samples where peak extend occurs

    '`3, cdt`{.sample}'

    :   Samples where the code detect timer is active

    '`4, tgm`{.sample}'

    :   Samples where the target gain does not match between channels

[]{#headphone}

### [36.93 headphone](#toc-headphone) {#headphone .section}

Apply head-related transfer functions (HRTFs) to create virtual
loudspeakers around the user for binaural listening via headphones. The
HRIRs are provided via additional streams, for each channel one stereo
input stream is needed.

The filter accepts the following options:

`map`{.sample}

:   Set mapping of input streams for convolution. The argument is a
    '\|'-separated list of channel names in order as they are given as
    additional stream inputs for filter. This also specify number of
    input streams. Number of input streams must be not less than number
    of channels in first stream plus one.

`gain`{.sample}

:   Set gain applied to audio. Value is in dB. Default is 0.

`type`{.sample}

:   Set processing type. Can be `time`{.variable} or `freq`{.variable}.
    `time`{.variable} is processing audio in time domain which is slow.
    `freq`{.variable} is processing audio in frequency domain which is
    fast. Default is `freq`{.variable}.

`lfe`{.sample}

:   Set custom gain for LFE channels. Value is in dB. Default is 0.

`size`{.sample}

:   Set size of frame in number of samples which will be processed at
    once. Default value is `1024`{.variable}. Allowed range is from 1024
    to 96000.

`hrir`{.sample}

:   Set format of hrir stream. Default value is `stereo`{.variable}.
    Alternative value is `multich`{.variable}. If value is set to
    `stereo`{.variable}, number of additional streams should be greater
    or equal to number of input channels in first input stream. Also
    each additional stream should have stereo number of channels. If
    value is set to `multich`{.variable}, number of additional streams
    should be exactly one. Also number of input channels of additional
    stream should be equal or greater than twice number of channels of
    first input stream.

[]{#Examples-71}

#### [36.93.1 Examples](#toc-Examples-71) {#examples-71 .subsection}

- Full example using wav files as coefficients with amovie filters for
  7.1 downmix, each amovie filter use stereo file with IR coefficients
  as input. The files give coefficients for each position of virtual
  loudspeaker:

  ::: example
  ``` example
  ffmpeg -i input.wav
  -filter_complex "amovie=azi_270_ele_0_DFC.wav[sr];amovie=azi_90_ele_0_DFC.wav[sl];amovie=azi_225_ele_0_DFC.wav[br];amovie=azi_135_ele_0_DFC.wav[bl];amovie=azi_0_ele_0_DFC.wav,asplit[fc][lfe];amovie=azi_35_ele_0_DFC.wav[fl];amovie=azi_325_ele_0_DFC.wav[fr];[0:a][fl][fr][fc][lfe][bl][br][sl][sr]headphone=FL|FR|FC|LFE|BL|BR|SL|SR"
  output.wav
  ```
  :::
- Full example using wav files as coefficients with amovie filters for
  7.1 downmix, but now in `multich`{.variable} `hrir`{.variable} format.

  ::: example
  ``` example
  ffmpeg -i input.wav -filter_complex "amovie=minp.wav[hrirs];[0:a][hrirs]headphone=map=FL|FR|FC|LFE|BL|BR|SL|SR:hrir=multich"
  output.wav
  ```
  :::

[]{#highpass}

### [36.94 highpass](#toc-highpass) {#highpass .section}

Apply a high-pass filter with 3dB point frequency. The filter can be
either single-pole, or double-pole (the default). The filter roll off at
6dB per pole per octave (20dB per pole per decade).

The filter accepts the following options:

`frequency, f`{.sample}

Set frequency in Hz. Default is 3000.

`poles, p`{.sample}

Set number of poles. Default is 2.

`width_type, t`{.sample}

Set method to specify band-width of filter.

`h`{.sample}

:   Hz

`q`{.sample}

:   Q-Factor

`o`{.sample}

:   octave

`s`{.sample}

:   slope

`k`{.sample}

:   kHz

`width, w`{.sample}

Specify the band-width of a filter in width_type units. Applies only to
double-pole filter. The default is 0.707q and gives a Butterworth
response.

`mix, m`{.sample}

How much to use filtered signal in output. Default is 1. Range is
between 0 and 1.

`channels, c`{.sample}

Specify which channels to filter, by default all available are filtered.

`normalize, n`{.sample}

Normalize biquad coefficients, by default is disabled. Enabling it will
normalize magnitude response at DC to 0dB.

`transform, a`{.sample}

Set transform type of IIR filter.

`di`{.sample}

`dii`{.sample}

`tdi`{.sample}

`tdii`{.sample}

`latt`{.sample}

`svf`{.sample}

`zdf`{.sample}

`precision, r`{.sample}

Set precision of filtering.

`auto`{.sample}

:   Pick automatic sample format depending on surround filters.

`s16`{.sample}

:   Always use signed 16-bit.

`s32`{.sample}

:   Always use signed 32-bit.

`f32`{.sample}

:   Always use float 32-bit.

`f64`{.sample}

:   Always use float 64-bit.

`block_size, b`{.sample}

Set block size used for reverse IIR processing. If this value is set to
high enough value (higher than impulse response length truncated when
reaches near zero values) filtering will become linear phase otherwise
if not big enough it will just produce nasty artifacts.

Note that filter delay will be exactly this many samples when set to
non-zero value.

[]{#Commands-40}

#### [36.94.1 Commands](#toc-Commands-40) {#commands-40 .subsection}

This filter supports the following commands:

`frequency, f`{.sample}

:   Change highpass frequency. Syntax for the command is :
    \"`frequency`{.variable}\"

`width_type, t`{.sample}

:   Change highpass width_type. Syntax for the command is :
    \"`width_type`{.variable}\"

`width, w`{.sample}

:   Change highpass width. Syntax for the command is :
    \"`width`{.variable}\"

`mix, m`{.sample}

:   Change highpass mix. Syntax for the command is :
    \"`mix`{.variable}\"

[]{#join}

### [36.95 join](#toc-join) {#join .section}

Join multiple input streams into one multi-channel stream.

It accepts the following parameters:

`inputs`{.sample}

:   The number of input streams. It defaults to 2.

`channel_layout`{.sample}

:   The desired output channel layout. It defaults to stereo.

`map`{.sample}

:   Map channels from inputs to output. The argument is a '\|'-separated
    list of mappings, each in the
    `input_idx`{.variable}`.``in_channel`{.variable}`-``out_channel`{.variable}
    form. `input_idx`{.variable} is the 0-based index of the input
    stream. `in_channel`{.variable} can be either the name of the input
    channel (e.g. FL for front left) or its index in the specified input
    stream. `out_channel`{.variable} is the name of the output channel.

The filter will attempt to guess the mappings when they are not
specified explicitly. It does so by first trying to find an unused
matching input channel and if that fails it picks the first unused input
channel.

Join 3 inputs (with properly set channel layouts):

::: example
``` example
ffmpeg -i INPUT1 -i INPUT2 -i INPUT3 -filter_complex join=inputs=3 OUTPUT
```
:::

Build a 5.1 output from 6 single-channel streams:

::: example
``` example
ffmpeg -i fl -i fr -i fc -i sl -i sr -i lfe -filter_complex
'join=inputs=6:channel_layout=5.1:map=0.0-FL|1.0-FR|2.0-FC|3.0-SL|4.0-SR|5.0-LFE'
out
```
:::

[]{#ladspa}

### [36.96 ladspa](#toc-ladspa) {#ladspa .section}

Load a LADSPA (Linux Audio Developer's Simple Plugin API) plugin.

To enable compilation of this filter you need to configure FFmpeg with
`--enable-ladspa`.

`file, f`{.sample}

:   Specifies the name of LADSPA plugin library to load. If the
    environment variable `LADSPA_PATH` is defined, the LADSPA plugin is
    searched in each one of the directories specified by the colon
    separated list in `LADSPA_PATH`, otherwise in the standard LADSPA
    paths, which are in this order: `HOME/.ladspa/lib/`{.sample},
    `/usr/local/lib/ladspa/`{.sample}, `/usr/lib/ladspa/`{.sample}.

`plugin, p`{.sample}

:   Specifies the plugin within the library. Some libraries contain only
    one plugin, but others contain many of them. If this is not set
    filter will list all available plugins within the specified library.

`controls, c`{.sample}

:   Set the '\|' separated list of controls which are zero or more
    floating point values that determine the behavior of the loaded
    plugin (for example delay, threshold or gain). Controls need to be
    defined using the following syntax:
    c0=`value0`{.variable}\|c1=`value1`{.variable}\|c2=`value2`{.variable}\|\...,
    where `valuei`{.variable} is the value set on the `i`{.variable}-th
    control. Alternatively they can be also defined using the following
    syntax:
    `value0`{.variable}\|`value1`{.variable}\|`value2`{.variable}\|\...,
    where `valuei`{.variable} is the value set on the `i`{.variable}-th
    control. If `controls`{.sample} is set to `help`, all available
    controls and their valid ranges are printed.

`sample_rate, s`{.sample}

:   Specify the sample rate, default to 44100. Only used if plugin have
    zero inputs.

`nb_samples, n`{.sample}

:   Set the number of samples per channel per each output frame, default
    is 1024. Only used if plugin have zero inputs.

`duration, d`{.sample}

:   Set the minimum duration of the sourced audio. See
    [(ffmpeg-utils)the Time duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax) for the accepted
    syntax. Note that the resulting duration may be greater than the
    specified duration, as the generated audio is always cut at the end
    of a complete frame. If not specified, or the expressed duration is
    negative, the audio is supposed to be generated forever. Only used
    if plugin have zero inputs.

`latency, l`{.sample}

:   Enable latency compensation, by default is disabled. Only used if
    plugin have inputs.

[]{#Examples-72}

#### [36.96.1 Examples](#toc-Examples-72) {#examples-72 .subsection}

- List all available plugins within amp (LADSPA example plugin) library:

  ::: example
  ``` example
  ladspa=file=amp
  ```
  :::
- List all available controls and their valid ranges for `vcf_notch`
  plugin from `VCF` library:

  ::: example
  ``` example
  ladspa=f=vcf:p=vcf_notch:c=help
  ```
  :::
- Simulate low quality audio equipment using `Computer Music Toolkit`
  (CMT) plugin library:

  ::: example
  ``` example
  ladspa=file=cmt:plugin=lofi:controls=c0=22|c1=12|c2=12
  ```
  :::
- Add reverberation to the audio using TAP-plugins (Tom's Audio
  Processing plugins):

  ::: example
  ``` example
  ladspa=file=tap_reverb:tap_reverb
  ```
  :::
- Generate white noise, with 0.2 amplitude:

  ::: example
  ``` example
  ladspa=file=cmt:noise_source_white:c=c0=.2
  ```
  :::
- Generate 20 bpm clicks using plugin `C* Click - Metronome` from the
  `C* Audio Plugin Suite` (CAPS) library:

  ::: example
  ``` example
  ladspa=file=caps:Click:c=c1=20'
  ```
  :::
- Apply `C* Eq10X2 - Stereo 10-band equaliser` effect:

  ::: example
  ``` example
  ladspa=caps:Eq10X2:c=c0=-48|c9=-24|c3=12|c4=2
  ```
  :::
- Increase volume by 20dB using fast lookahead limiter from Steve Harris
  `SWH Plugins` collection:

  ::: example
  ``` example
  ladspa=fast_lookahead_limiter_1913:fastLookaheadLimiter:20|0|2
  ```
  :::
- Attenuate low frequencies using Multiband EQ from Steve Harris
  `SWH Plugins` collection:

  ::: example
  ``` example
  ladspa=mbeq_1197:mbeq:-24|-24|-24|0|0|0|0|0|0|0|0|0|0|0|0
  ```
  :::
- Reduce stereo image using `Narrower` from the `C* Audio Plugin Suite`
  (CAPS) library:

  ::: example
  ``` example
  ladspa=caps:Narrower
  ```
  :::
- Another white noise, now using `C* Audio Plugin Suite` (CAPS) library:

  ::: example
  ``` example
  ladspa=caps:White:.2
  ```
  :::
- Some fractal noise, using `C* Audio Plugin Suite` (CAPS) library:

  ::: example
  ``` example
  ladspa=caps:Fractal:c=c1=1
  ```
  :::
- Dynamic volume normalization using `VLevel` plugin:

  ::: example
  ``` example
  ladspa=vlevel-ladspa:vlevel_mono
  ```
  :::

[]{#Commands-41}

#### [36.96.2 Commands](#toc-Commands-41) {#commands-41 .subsection}

This filter supports the following commands:

`cN`{.sample}

:   Modify the `N`{.variable}-th control value.

    If the specified value is not valid, it is ignored and prior one is
    kept.

[]{#loudnorm}

### [36.97 loudnorm](#toc-loudnorm) {#loudnorm .section}

EBU R128 loudness normalization. Includes both dynamic and linear
normalization modes. Support for both single pass (livestreams, files)
and double pass (files) modes. This algorithm can target IL, LRA, and
maximum true peak. In dynamic mode, to accurately detect true peaks, the
audio stream will be upsampled to 192 kHz. Use the `-ar` option or
`aresample` filter to explicitly set an output sample rate.

The filter accepts the following options:

`I, i`{.sample}

:   Set integrated loudness target. Range is -70.0 - -5.0. Default value
    is -24.0.

`LRA, lra`{.sample}

:   Set loudness range target. Range is 1.0 - 50.0. Default value is
    7.0.

`TP, tp`{.sample}

:   Set maximum true peak. Range is -9.0 - +0.0. Default value is -2.0.

`measured_I, measured_i`{.sample}

:   Measured IL of input file. Range is -99.0 - +0.0.

`measured_LRA, measured_lra`{.sample}

:   Measured LRA of input file. Range is 0.0 - 99.0.

`measured_TP, measured_tp`{.sample}

:   Measured true peak of input file. Range is -99.0 - +99.0.

`measured_thresh`{.sample}

:   Measured threshold of input file. Range is -99.0 - +0.0.

`offset`{.sample}

:   Set offset gain. Gain is applied before the true-peak limiter. Range
    is -99.0 - +99.0. Default is +0.0.

`linear`{.sample}

:   Normalize by linearly scaling the source audio. `measured_I`,
    `measured_LRA`, `measured_TP`, and `measured_thresh` must all be
    specified. Target LRA shouldn't be lower than source LRA and the
    change in integrated loudness shouldn't result in a true peak which
    exceeds the target TP. If any of these conditions aren't met,
    normalization mode will revert to `dynamic`{.variable}. Options are
    `true` or `false`. Default is `true`.

`dual_mono`{.sample}

:   Treat mono input files as \"dual-mono\". If a mono file is intended
    for playback on a stereo system, its EBU R128 measurement will be
    perceptually incorrect. If set to `true`, this option will
    compensate for this effect. Multi-channel input files are not
    affected by this option. Options are true or false. Default is
    false.

`print_format`{.sample}

:   Set print format for stats. Options are summary, json, or none.
    Default value is none.

[]{#lowpass}

### [36.98 lowpass](#toc-lowpass) {#lowpass .section}

Apply a low-pass filter with 3dB point frequency. The filter can be
either single-pole or double-pole (the default). The filter roll off at
6dB per pole per octave (20dB per pole per decade).

The filter accepts the following options:

`frequency, f`{.sample}

Set frequency in Hz. Default is 500.

`poles, p`{.sample}

Set number of poles. Default is 2.

`width_type, t`{.sample}

Set method to specify band-width of filter.

`h`{.sample}

:   Hz

`q`{.sample}

:   Q-Factor

`o`{.sample}

:   octave

`s`{.sample}

:   slope

`k`{.sample}

:   kHz

`width, w`{.sample}

Specify the band-width of a filter in width_type units. Applies only to
double-pole filter. The default is 0.707q and gives a Butterworth
response.

`mix, m`{.sample}

How much to use filtered signal in output. Default is 1. Range is
between 0 and 1.

`channels, c`{.sample}

Specify which channels to filter, by default all available are filtered.

`normalize, n`{.sample}

Normalize biquad coefficients, by default is disabled. Enabling it will
normalize magnitude response at DC to 0dB.

`transform, a`{.sample}

Set transform type of IIR filter.

`di`{.sample}

`dii`{.sample}

`tdi`{.sample}

`tdii`{.sample}

`latt`{.sample}

`svf`{.sample}

`zdf`{.sample}

`precision, r`{.sample}

Set precision of filtering.

`auto`{.sample}

:   Pick automatic sample format depending on surround filters.

`s16`{.sample}

:   Always use signed 16-bit.

`s32`{.sample}

:   Always use signed 32-bit.

`f32`{.sample}

:   Always use float 32-bit.

`f64`{.sample}

:   Always use float 64-bit.

`block_size, b`{.sample}

Set block size used for reverse IIR processing. If this value is set to
high enough value (higher than impulse response length truncated when
reaches near zero values) filtering will become linear phase otherwise
if not big enough it will just produce nasty artifacts.

Note that filter delay will be exactly this many samples when set to
non-zero value.

[]{#Examples-73}

#### [36.98.1 Examples](#toc-Examples-73) {#examples-73 .subsection}

- Lowpass only LFE channel, it LFE is not present it does nothing:

  ::: example
  ``` example
  lowpass=c=LFE
  ```
  :::

[]{#Commands-42}

#### [36.98.2 Commands](#toc-Commands-42) {#commands-42 .subsection}

This filter supports the following commands:

`frequency, f`{.sample}

:   Change lowpass frequency. Syntax for the command is :
    \"`frequency`{.variable}\"

`width_type, t`{.sample}

:   Change lowpass width_type. Syntax for the command is :
    \"`width_type`{.variable}\"

`width, w`{.sample}

:   Change lowpass width. Syntax for the command is :
    \"`width`{.variable}\"

`mix, m`{.sample}

:   Change lowpass mix. Syntax for the command is : \"`mix`{.variable}\"

[]{#lv2}

### [36.99 lv2](#toc-lv2) {#lv2 .section}

Load a LV2 (LADSPA Version 2) plugin.

To enable compilation of this filter you need to configure FFmpeg with
`--enable-lv2`.

`plugin, p`{.sample}

:   Specifies the plugin URI. You may need to escape ':'.

`controls, c`{.sample}

:   Set the '\|' separated list of controls which are zero or more
    floating point values that determine the behavior of the loaded
    plugin (for example delay, threshold or gain). If
    `controls`{.sample} is set to `help`, all available controls and
    their valid ranges are printed.

`sample_rate, s`{.sample}

:   Specify the sample rate, default to 44100. Only used if plugin have
    zero inputs.

`nb_samples, n`{.sample}

:   Set the number of samples per channel per each output frame, default
    is 1024. Only used if plugin have zero inputs.

`duration, d`{.sample}

:   Set the minimum duration of the sourced audio. See
    [(ffmpeg-utils)the Time duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax) for the accepted
    syntax. Note that the resulting duration may be greater than the
    specified duration, as the generated audio is always cut at the end
    of a complete frame. If not specified, or the expressed duration is
    negative, the audio is supposed to be generated forever. Only used
    if plugin have zero inputs.

[]{#Examples-74}

#### [36.99.1 Examples](#toc-Examples-74) {#examples-74 .subsection}

- Apply bass enhancer plugin from Calf:

  ::: example
  ``` example
  lv2=p=http\\\\://calf.sourceforge.net/plugins/BassEnhancer:c=amount=2
  ```
  :::
- Apply vinyl plugin from Calf:

  ::: example
  ``` example
  lv2=p=http\\\\://calf.sourceforge.net/plugins/Vinyl:c=drone=0.2|aging=0.5
  ```
  :::
- Apply bit crusher plugin from ArtyFX:

  ::: example
  ``` example
  lv2=p=http\\\\://www.openavproductions.com/artyfx#bitta:c=crush=0.3
  ```
  :::

[]{#Commands-43}

#### [36.99.2 Commands](#toc-Commands-43) {#commands-43 .subsection}

This filter supports all options that are exported by plugin as
commands.

[]{#mcompand}

### [36.100 mcompand](#toc-mcompand) {#mcompand .section}

Multiband Compress or expand the audio's dynamic range.

The input audio is divided into bands using 4th order Linkwitz-Riley
IIRs. This is akin to the crossover of a loudspeaker, and results in
flat frequency response when absent compander action.

It accepts the following parameters:

`args`{.sample}

:   This option syntax is: attack,decay,\[attack,decay..\] soft-knee
    points crossover_frequency \[delay \[initial_volume \[gain\]\]\] \|
    attack,decay \... For explanation of each item refer to compand
    filter documentation.

[]{#pan}[]{#pan-1}

### [36.101 pan](#toc-pan-1) {#pan .section}

Mix channels with specific gain levels. The filter accepts the output
channel layout followed by a set of channels definitions.

This filter is also designed to efficiently remap the channels of an
audio stream.

The filter accepts parameters of the form:
\"`l`{.variable}\|`outdef`{.variable}\|`outdef`{.variable}\|\...\"

`l`{.sample}

:   output channel layout or number of channels

`outdef`{.sample}

:   output channel specification, of the form:
    \"`out_name`{.variable}=\[`gain`{.variable}\*\]`in_name`{.variable}\[(+-)\[`gain`{.variable}\*\]`in_name`{.variable}\...\]\"

`out_name`{.sample}

:   output channel to define, either a channel name (FL, FR, etc.) or a
    channel number (c0, c1, etc.)

`gain`{.sample}

:   multiplicative coefficient for the channel, 1 leaving the volume
    unchanged

`in_name`{.sample}

:   input channel to use, see out_name for details; it is not possible
    to mix named and numbered input channels

If the '=' in a channel specification is replaced by '\<', then the
gains for that specification will be renormalized so that the total is
1, thus avoiding clipping noise.

[]{#Mixing-examples}

#### [36.101.1 Mixing examples](#toc-Mixing-examples) {#mixing-examples .subsection}

For example, if you want to down-mix from stereo to mono, but with a
bigger factor for the left channel:

::: example
``` example
pan=1c|c0=0.9*c0+0.1*c1
```
:::

A customized down-mix to stereo that works automatically for 3-, 4-, 5-
and 7-channels surround:

::: example
``` example
pan=stereo| FL < FL + 0.5*FC + 0.6*BL + 0.6*SL | FR < FR + 0.5*FC + 0.6*BR + 0.6*SR
```
:::

Note that `ffmpeg` integrates a default down-mix (and up-mix) system
that should be preferred (see \"-ac\" option) unless you have very
specific needs.

[]{#Remapping-examples}

#### [36.101.2 Remapping examples](#toc-Remapping-examples) {#remapping-examples .subsection}

The channel remapping will be effective if, and only if:

- gain coefficients are zeroes or ones,
- only one input per channel output,

If all these conditions are satisfied, the filter will notify the user
(\"Pure channel mapping detected\"), and use an optimized and lossless
method to do the remapping.

For example, if you have a 5.1 source and want a stereo audio stream by
dropping the extra channels:

::: example
``` example
pan="stereo| c0=FL | c1=FR"
```
:::

Given the same source, you can also switch front left and front right
channels and keep the input channel layout:

::: example
``` example
pan="5.1| c0=c1 | c1=c0 | c2=c2 | c3=c3 | c4=c4 | c5=c5"
```
:::

If the input is a stereo audio stream, you can mute the front left
channel (and still keep the stereo channel layout) with:

::: example
``` example
pan="stereo|c1=c1"
```
:::

Still with a stereo audio stream input, you can copy the right channel
in both front left and right:

::: example
``` example
pan="stereo| c0=FR | c1=FR"
```
:::

[]{#replaygain}

### [36.102 replaygain](#toc-replaygain) {#replaygain .section}

ReplayGain scanner filter. This filter takes an audio stream as an input
and outputs it unchanged. At end of filtering it displays `track_gain`
and `track_peak`.

The filter accepts the following exported read-only options:

`track_gain`{.sample}

:   Exported track gain in dB at end of stream.

`track_peak`{.sample}

:   Exported track peak at end of stream.

[]{#resample}

### [36.103 resample](#toc-resample) {#resample .section}

Convert the audio sample format, sample rate and channel layout. It is
not meant to be used directly.

[]{#rubberband}

### [36.104 rubberband](#toc-rubberband) {#rubberband .section}

Apply time-stretching and pitch-shifting with librubberband.

To enable compilation of this filter, you need to configure FFmpeg with
`--enable-librubberband`.

The filter accepts the following options:

`tempo`{.sample}

Set tempo scale factor.

`pitch`{.sample}

Set pitch scale factor.

`transients`{.sample}

Set transients detector. Possible values are:

`crisp`{.variable}

`mixed`{.variable}

`smooth`{.variable}

`detector`{.sample}

Set detector. Possible values are:

`compound`{.variable}

`percussive`{.variable}

`soft`{.variable}

`phase`{.sample}

Set phase. Possible values are:

`laminar`{.variable}

`independent`{.variable}

`window`{.sample}

Set processing window size. Possible values are:

`standard`{.variable}

`short`{.variable}

`long`{.variable}

`smoothing`{.sample}

Set smoothing. Possible values are:

`off`{.variable}

`on`{.variable}

`formant`{.sample}

Enable formant preservation when shift pitching. Possible values are:

`shifted`{.variable}

`preserved`{.variable}

`pitchq`{.sample}

Set pitch quality. Possible values are:

`quality`{.variable}

`speed`{.variable}

`consistency`{.variable}

`channels`{.sample}

Set channels. Possible values are:

`apart`{.variable}

`together`{.variable}

[]{#Commands-44}

#### [36.104.1 Commands](#toc-Commands-44) {#commands-44 .subsection}

This filter supports the following commands:

`tempo`{.sample}

:   Change filter tempo scale factor. Syntax for the command is :
    \"`tempo`{.variable}\"

`pitch`{.sample}

:   Change filter pitch scale factor. Syntax for the command is :
    \"`pitch`{.variable}\"

[]{#sidechaincompress}

### [36.105 sidechaincompress](#toc-sidechaincompress) {#sidechaincompress .section}

This filter acts like normal compressor but has the ability to compress
detected signal using second input signal. It needs two input streams
and returns one output stream. First input stream will be processed
depending on second stream signal. The filtered signal then can be
filtered with other filters in later stages of processing. See
[pan](#pan) and [amerge](#amerge) filter.

The filter accepts the following options:

`level_in`{.sample}

:   Set input gain. Default is 1. Range is between 0.015625 and 64.

`mode`{.sample}

:   Set mode of compressor operation. Can be `upward` or `downward`.
    Default is `downward`.

`threshold`{.sample}

:   If a signal of second stream raises above this level it will affect
    the gain reduction of first stream. By default is 0.125. Range is
    between 0.00097563 and 1.

`ratio`{.sample}

:   Set a ratio about which the signal is reduced. 1:2 means that if the
    level raised 4dB above the threshold, it will be only 2dB above
    after the reduction. Default is 2. Range is between 1 and 20.

`attack`{.sample}

:   Amount of milliseconds the signal has to rise above the threshold
    before gain reduction starts. Default is 20. Range is between 0.01
    and 2000.

`release`{.sample}

:   Amount of milliseconds the signal has to fall below the threshold
    before reduction is decreased again. Default is 250. Range is
    between 0.01 and 9000.

`makeup`{.sample}

:   Set the amount by how much signal will be amplified after
    processing. Default is 1. Range is from 1 to 64.

`knee`{.sample}

:   Curve the sharp knee around the threshold to enter gain reduction
    more softly. Default is 2.82843. Range is between 1 and 8.

`link`{.sample}

:   Choose if the `average` level between all channels of side-chain
    stream or the louder(`maximum`) channel of side-chain stream affects
    the reduction. Default is `average`.

`detection`{.sample}

:   Should the exact signal be taken in case of `peak` or an RMS one in
    case of `rms`. Default is `rms` which is mainly smoother.

`level_sc`{.sample}

:   Set sidechain gain. Default is 1. Range is between 0.015625 and 64.

`mix`{.sample}

:   How much to use compressed signal in output. Default is 1. Range is
    between 0 and 1.

[]{#Commands-45}

#### [36.105.1 Commands](#toc-Commands-45) {#commands-45 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#Examples-75}

#### [36.105.2 Examples](#toc-Examples-75) {#examples-75 .subsection}

- Full ffmpeg example taking 2 audio inputs, 1st input to be compressed
  depending on the signal of 2nd input and later compressed signal to be
  merged with 2nd input:

  ::: example
  ``` example
  ffmpeg -i main.flac -i sidechain.flac -filter_complex "[1:a]asplit=2[sc][mix];[0:a][sc]sidechaincompress[compr];[compr][mix]amerge"
  ```
  :::

[]{#sidechaingate}

### [36.106 sidechaingate](#toc-sidechaingate) {#sidechaingate .section}

A sidechain gate acts like a normal (wideband) gate but has the ability
to filter the detected signal before sending it to the gain reduction
stage. Normally a gate uses the full range signal to detect a level
above the threshold. For example: If you cut all lower frequencies from
your sidechain signal the gate will decrease the volume of your track
only if not enough highs appear. With this technique you are able to
reduce the resonation of a natural drum or remove \"rumbling\" of muted
strokes from a heavily distorted guitar. It needs two input streams and
returns one output stream. First input stream will be processed
depending on second stream signal.

The filter accepts the following options:

`level_in`{.sample}

:   Set input level before filtering. Default is 1. Allowed range is
    from 0.015625 to 64.

`mode`{.sample}

:   Set the mode of operation. Can be `upward` or `downward`. Default is
    `downward`. If set to `upward` mode, higher parts of signal will be
    amplified, expanding dynamic range in upward direction. Otherwise,
    in case of `downward` lower parts of signal will be reduced.

`range`{.sample}

:   Set the level of gain reduction when the signal is below the
    threshold. Default is 0.06125. Allowed range is from 0 to 1. Setting
    this to 0 disables reduction and then filter behaves like expander.

`threshold`{.sample}

:   If a signal rises above this level the gain reduction is released.
    Default is 0.125. Allowed range is from 0 to 1.

`ratio`{.sample}

:   Set a ratio about which the signal is reduced. Default is 2. Allowed
    range is from 1 to 9000.

`attack`{.sample}

:   Amount of milliseconds the signal has to rise above the threshold
    before gain reduction stops. Default is 20 milliseconds. Allowed
    range is from 0.01 to 9000.

`release`{.sample}

:   Amount of milliseconds the signal has to fall below the threshold
    before the reduction is increased again. Default is 250
    milliseconds. Allowed range is from 0.01 to 9000.

`makeup`{.sample}

:   Set amount of amplification of signal after processing. Default
    is 1. Allowed range is from 1 to 64.

`knee`{.sample}

:   Curve the sharp knee around the threshold to enter gain reduction
    more softly. Default is 2.828427125. Allowed range is from 1 to 8.

`detection`{.sample}

:   Choose if exact signal should be taken for detection or an RMS like
    one. Default is rms. Can be peak or rms.

`link`{.sample}

:   Choose if the average level between all channels or the louder
    channel affects the reduction. Default is average. Can be average or
    maximum.

`level_sc`{.sample}

:   Set sidechain gain. Default is 1. Range is from 0.015625 to 64.

[]{#Commands-46}

#### [36.106.1 Commands](#toc-Commands-46) {#commands-46 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#silencedetect}

### [36.107 silencedetect](#toc-silencedetect) {#silencedetect .section}

Detect silence in an audio stream.

This filter logs a message when it detects that the input audio volume
is less or equal to a noise tolerance value for a duration greater or
equal to the minimum detected noise duration.

The printed times and duration are expressed in seconds. The
`lavfi.silence_start` or `lavfi.silence_start.X` metadata key is set on
the first frame whose timestamp equals or exceeds the detection duration
and it contains the timestamp of the first frame of the silence.

The `lavfi.silence_duration` or `lavfi.silence_duration.X` and
`lavfi.silence_end` or `lavfi.silence_end.X` metadata keys are set on
the first frame after the silence. If `mono`{.sample} is enabled, and
each channel is evaluated separately, the `.X` suffixed keys are used,
and `X` corresponds to the channel number.

The filter accepts the following options:

`noise, n`{.sample}

:   Set noise tolerance. Can be specified in dB (in case \"dB\" is
    appended to the specified value) or amplitude ratio. Default is
    -60dB, or 0.001.

`duration, d`{.sample}

:   Set silence duration until notification (default is 2 seconds). See
    [(ffmpeg-utils)the Time duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax) for the accepted
    syntax.

`mono, m`{.sample}

:   Process each channel separately, instead of combined. By default is
    disabled.

[]{#Examples-76}

#### [36.107.1 Examples](#toc-Examples-76) {#examples-76 .subsection}

- Detect 5 seconds of silence with -50dB noise tolerance:

  ::: example
  ``` example
  silencedetect=n=-50dB:d=5
  ```
  :::
- Complete example with `ffmpeg` to detect silence with 0.0001 noise
  tolerance in `silence.mp3`{.sample}:

  ::: example
  ``` example
  ffmpeg -i silence.mp3 -af silencedetect=noise=0.0001 -f null -
  ```
  :::

[]{#silenceremove}

### [36.108 silenceremove](#toc-silenceremove) {#silenceremove .section}

Remove silence from the beginning, middle or end of the audio.

The filter accepts the following options:

`start_periods`{.sample}

:   This value is used to indicate if audio should be trimmed at
    beginning of the audio. A value of zero indicates no silence should
    be trimmed from the beginning. When specifying a non-zero value, it
    trims audio up until it finds non-silence. Normally, when trimming
    silence from beginning of audio the `start_periods`{.variable} will
    be `1` but it can be increased to higher values to trim all audio up
    to specific count of non-silence periods. Default value is `0`.

`start_duration`{.sample}

:   Specify the amount of time that non-silence must be detected before
    it stops trimming audio. By increasing the duration, bursts of
    noises can be treated as silence and trimmed off. Default value is
    `0`.

`start_threshold`{.sample}

:   This indicates what sample value should be treated as silence. For
    digital audio, a value of `0` may be fine but for audio recorded
    from analog, you may wish to increase the value to account for
    background noise. Can be specified in dB (in case \"dB\" is appended
    to the specified value) or amplitude ratio. Default value is `0`.

`start_silence`{.sample}

:   Specify max duration of silence at beginning that will be kept after
    trimming. Default is 0, which is equal to trimming all samples
    detected as silence.

`start_mode`{.sample}

:   Specify mode of detection of silence end at start of multi-channel
    audio. Can be `any`{.variable} or `all`{.variable}. Default is
    `any`{.variable}. With `any`{.variable}, any sample from any channel
    that is detected as non-silence will trigger end of silence trimming
    at start of audio stream. With `all`{.variable}, only if every
    sample from every channel is detected as non-silence will trigger
    end of silence trimming at start of audio stream, limited usage.

`stop_periods`{.sample}

:   Set the count for trimming silence from the end of audio. When
    specifying a positive value, it trims audio after it finds specified
    silence period. To remove silence from the middle of a file, specify
    a `stop_periods`{.variable} that is negative. This value is then
    treated as a positive value and is used to indicate the effect
    should restart processing as specified by `stop_periods`{.variable},
    making it suitable for removing periods of silence in the middle of
    the audio. Default value is `0`.

`stop_duration`{.sample}

:   Specify a duration of silence that must exist before audio is not
    copied any more. By specifying a higher duration, silence that is
    wanted can be left in the audio. Default value is `0`.

`stop_threshold`{.sample}

:   This is the same as `start_threshold`{.sample} but for trimming
    silence from the end of audio. Can be specified in dB (in case
    \"dB\" is appended to the specified value) or amplitude ratio.
    Default value is `0`.

`stop_silence`{.sample}

:   Specify max duration of silence at end that will be kept after
    trimming. Default is 0, which is equal to trimming all samples
    detected as silence.

`stop_mode`{.sample}

:   Specify mode of detection of silence start after start of
    multi-channel audio. Can be `any`{.variable} or `all`{.variable}.
    Default is `all`{.variable}. With `any`{.variable}, any sample from
    any channel that is detected as silence will trigger start of
    silence trimming after start of audio stream, limited usage. With
    `all`{.variable}, only if every sample from every channel is
    detected as silence will trigger start of silence trimming after
    start of audio stream.

`detection`{.sample}

:   Set how is silence detected.

    `avg`{.sample}

    :   Mean of absolute values of samples in moving window.

    `rms`{.sample}

    :   Root squared mean of absolute values of samples in moving
        window.

    `peak`{.sample}

    :   Maximum of absolute values of samples in moving window.

    `median`{.sample}

    :   Median of absolute values of samples in moving window.

    `ptp`{.sample}

    :   Absolute of max peak to min peak difference of samples in moving
        window.

    `dev`{.sample}

    :   Standard deviation of values of samples in moving window.

    Default value is `rms`.

`window`{.sample}

:   Set duration in number of seconds used to calculate size of window
    in number of samples for detecting silence. Using `0` will
    effectively disable any windowing and use only single sample per
    channel for silence detection. In that case it may be needed to also
    set `start_silence`{.sample} and/or `stop_silence`{.sample} to
    nonzero values with also `start_duration`{.sample} and/or
    `stop_duration`{.sample} to nonzero values. Default value is `0.02`.
    Allowed range is from `0` to `10`.

`timestamp`{.sample}

:   Set processing mode of every audio frame output timestamp.

    `write`{.sample}

    :   Full timestamps rewrite, keep only the start time for the first
        output frame.

    `copy`{.sample}

    :   Non-dropped frames are left with same timestamp as input audio
        frame.

    Defaults value is `write`.

[]{#Examples-77}

#### [36.108.1 Examples](#toc-Examples-77) {#examples-77 .subsection}

- The following example shows how this filter can be used to start a
  recording that does not contain the delay at the start which usually
  occurs between pressing the record button and the start of the
  performance:

  ::: example
  ``` example
  silenceremove=start_periods=1:start_duration=5:start_threshold=0.02
  ```
  :::
- Trim all silence encountered from beginning to end where there is more
  than 1 second of silence in audio:

  ::: example
  ``` example
  silenceremove=stop_periods=-1:stop_duration=1:stop_threshold=-90dB
  ```
  :::
- Trim all digital silence samples, using peak detection, from beginning
  to end where there is more than 0 samples of digital silence in audio
  and digital silence is detected in all channels at same positions in
  stream:

  ::: example
  ``` example
  silenceremove=window=0:detection=peak:stop_mode=all:start_mode=all:stop_periods=-1:stop_threshold=0
  ```
  :::
- Trim every 2nd encountered silence period from beginning to end where
  there is more than 1 second of silence per silence period in audio:

  ::: example
  ``` example
  silenceremove=stop_periods=-2:stop_duration=1:stop_threshold=-90dB
  ```
  :::
- Similar as above, but keep maximum of 0.5 seconds of silence from each
  trimmed period:

  ::: example
  ``` example
  silenceremove=stop_periods=-2:stop_duration=1:stop_threshold=-90dB:stop_silence=0.5
  ```
  :::
- Similar as above, but keep maximum of 1.5 seconds of silence from
  start of audio:

  ::: example
  ``` example
  silenceremove=stop_periods=-2:stop_duration=1:stop_threshold=-90dB:stop_silence=0.5:start_periods=1:start_duration=1:start_silence=1.5:stop_threshold=-90dB
  ```
  :::

[]{#Commands-47}

#### [36.108.2 Commands](#toc-Commands-47) {#commands-47 .subsection}

This filter supports some above options as [commands](#commands).

[]{#sofalizer}

### [36.109 sofalizer](#toc-sofalizer) {#sofalizer .section}

SOFAlizer uses head-related transfer functions (HRTFs) to create virtual
loudspeakers around the user for binaural listening via headphones
(audio formats up to 9 channels supported). The HRTFs are stored in SOFA
files (see <http://www.sofacoustics.org/> for a database). SOFAlizer is
developed at the Acoustics Research Institute (ARI) of the Austrian
Academy of Sciences.

To enable compilation of this filter you need to configure FFmpeg with
`--enable-libmysofa`.

The filter accepts the following options:

`sofa`{.sample}

:   Set the SOFA file used for rendering.

`gain`{.sample}

:   Set gain applied to audio. Value is in dB. Default is 0.

`rotation`{.sample}

:   Set rotation of virtual loudspeakers in deg. Default is 0.

`elevation`{.sample}

:   Set elevation of virtual speakers in deg. Default is 0.

`radius`{.sample}

:   Set distance in meters between loudspeakers and the listener with
    near-field HRTFs. Default is 1.

`type`{.sample}

:   Set processing type. Can be `time`{.variable} or `freq`{.variable}.
    `time`{.variable} is processing audio in time domain which is slow.
    `freq`{.variable} is processing audio in frequency domain which is
    fast. Default is `freq`{.variable}.

`speakers`{.sample}

:   Set custom positions of virtual loudspeakers. Syntax for this option
    is: \<CH\> \<AZIM\> \<ELEV\>\[\|\<CH\> \<AZIM\> \<ELEV\>\|\...\].
    Each virtual loudspeaker is described with short channel name
    following with azimuth and elevation in degrees. Each virtual
    loudspeaker description is separated by '\|'. For example to
    override front left and front right channel positions use:
    'speakers=FL 45 15\|FR 345 15'. Descriptions with unrecognised
    channel names are ignored.

`lfegain`{.sample}

:   Set custom gain for LFE channels. Value is in dB. Default is 0.

`framesize`{.sample}

:   Set custom frame size in number of samples. Default is 1024. Allowed
    range is from 1024 to 96000. Only used if option '`type`{.sample}'
    is set to `freq`{.variable}.

`normalize`{.sample}

:   Should all IRs be normalized upon importing SOFA file. By default is
    enabled.

`interpolate`{.sample}

:   Should nearest IRs be interpolated with neighbor IRs if exact
    position does not match. By default is disabled.

`minphase`{.sample}

:   Minphase all IRs upon loading of SOFA file. By default is disabled.

`anglestep`{.sample}

:   Set neighbor search angle step. Only used if option
    `interpolate`{.variable} is enabled.

`radstep`{.sample}

:   Set neighbor search radius step. Only used if option
    `interpolate`{.variable} is enabled.

[]{#Examples-78}

#### [36.109.1 Examples](#toc-Examples-78) {#examples-78 .subsection}

- Using ClubFritz6 sofa file:

  ::: example
  ``` example
  sofalizer=sofa=/path/to/ClubFritz6.sofa:type=freq:radius=1
  ```
  :::
- Using ClubFritz12 sofa file and bigger radius with small rotation:

  ::: example
  ``` example
  sofalizer=sofa=/path/to/ClubFritz12.sofa:type=freq:radius=2:rotation=5
  ```
  :::
- Similar as above but with custom speaker positions for front left,
  front right, back left and back right and also with custom gain:

  ::: example
  ``` example
  "sofalizer=sofa=/path/to/ClubFritz6.sofa:type=freq:radius=2:speakers=FL 45|FR 315|BL 135|BR 225:gain=28"
  ```
  :::

[]{#speechnorm}

### [36.110 speechnorm](#toc-speechnorm) {#speechnorm .section}

Speech Normalizer.

This filter expands or compresses each half-cycle of audio samples
(local set of samples all above or all below zero and between two
nearest zero crossings) depending on threshold value, so audio reaches
target peak value under conditions controlled by below options.

The filter accepts the following options:

`peak, p`{.sample}

:   Set the expansion target peak value. This specifies the highest
    allowed absolute amplitude level for the normalized audio input.
    Default value is 0.95. Allowed range is from 0.0 to 1.0.

`expansion, e`{.sample}

:   Set the maximum expansion factor. Allowed range is from 1.0 to 50.0.
    Default value is 2.0. This option controls maximum local half-cycle
    of samples expansion. The maximum expansion would be such that local
    peak value reaches target peak value but never to surpass it and
    that ratio between new and previous peak value does not surpass this
    option value.

`compression, c`{.sample}

:   Set the maximum compression factor. Allowed range is from 1.0 to
    50.0. Default value is 2.0. This option controls maximum local
    half-cycle of samples compression. This option is used only if
    `threshold`{.sample} option is set to value greater than 0.0, then
    in such cases when local peak is lower or same as value set by
    `threshold`{.sample} all samples belonging to that peak's half-cycle
    will be compressed by current compression factor.

`threshold, t`{.sample}

:   Set the threshold value. Default value is 0.0. Allowed range is from
    0.0 to 1.0. This option specifies which half-cycles of samples will
    be compressed and which will be expanded. Any half-cycle samples
    with their local peak value below or same as this option value will
    be compressed by current compression factor, otherwise, if greater
    than threshold value they will be expanded with expansion factor so
    that it could reach peak target value but never surpass it.

`raise, r`{.sample}

:   Set the expansion raising amount per each half-cycle of samples.
    Default value is 0.001. Allowed range is from 0.0 to 1.0. This
    controls how fast expansion factor is raised per each new half-cycle
    until it reaches `expansion`{.sample} value. Setting this options
    too high may lead to distortions.

`fall, f`{.sample}

:   Set the compression raising amount per each half-cycle of samples.
    Default value is 0.001. Allowed range is from 0.0 to 1.0. This
    controls how fast compression factor is raised per each new
    half-cycle until it reaches `compression`{.sample} value.

`channels, h`{.sample}

:   Specify which channels to filter, by default all available channels
    are filtered.

`invert, i`{.sample}

:   Enable inverted filtering, by default is disabled. This inverts
    interpretation of `threshold`{.sample} option. When enabled any
    half-cycle of samples with their local peak value below or same as
    `threshold`{.sample} option will be expanded otherwise it will be
    compressed.

`link, l`{.sample}

:   Link channels when calculating gain applied to each filtered channel
    sample, by default is disabled. When disabled each filtered channel
    gain calculation is independent, otherwise when this option is
    enabled the minimum of all possible gains for each filtered channel
    is used.

`rms, m`{.sample}

:   Set the expansion target RMS value. This specifies the highest
    allowed RMS level for the normalized audio input. Default value is
    0.0, thus disabled. Allowed range is from 0.0 to 1.0.

[]{#Commands-48}

#### [36.110.1 Commands](#toc-Commands-48) {#commands-48 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#Examples-79}

#### [36.110.2 Examples](#toc-Examples-79) {#examples-79 .subsection}

- Weak and slow amplification:

  ::: example
  ``` example
  speechnorm=e=3:r=0.00001:l=1
  ```
  :::
- Moderate and slow amplification:

  ::: example
  ``` example
  speechnorm=e=6.25:r=0.00001:l=1
  ```
  :::
- Strong and fast amplification:

  ::: example
  ``` example
  speechnorm=e=12.5:r=0.0001:l=1
  ```
  :::
- Very strong and fast amplification:

  ::: example
  ``` example
  speechnorm=e=25:r=0.0001:l=1
  ```
  :::
- Extreme and fast amplification:

  ::: example
  ``` example
  speechnorm=e=50:r=0.0001:l=1
  ```
  :::

[]{#stereotools}

### [36.111 stereotools](#toc-stereotools) {#stereotools .section}

This filter has some handy utilities to manage stereo signals, for
converting M/S stereo recordings to L/R signal while having control over
the parameters or spreading the stereo image of master track.

The filter accepts the following options:

`level_in`{.sample}

:   Set input level before filtering for both channels. Defaults is 1.
    Allowed range is from 0.015625 to 64.

`level_out`{.sample}

:   Set output level after filtering for both channels. Defaults is 1.
    Allowed range is from 0.015625 to 64.

`balance_in`{.sample}

:   Set input balance between both channels. Default is 0. Allowed range
    is from -1 to 1.

`balance_out`{.sample}

:   Set output balance between both channels. Default is 0. Allowed
    range is from -1 to 1.

`softclip`{.sample}

:   Enable softclipping. Results in analog distortion instead of harsh
    digital 0dB clipping. Disabled by default.

`mutel`{.sample}

:   Mute the left channel. Disabled by default.

`muter`{.sample}

:   Mute the right channel. Disabled by default.

`phasel`{.sample}

:   Change the phase of the left channel. Disabled by default.

`phaser`{.sample}

:   Change the phase of the right channel. Disabled by default.

`mode`{.sample}

:   Set stereo mode. Available values are:

    '`lr>lr`{.sample}'

    :   Left/Right to Left/Right, this is default.

    '`lr>ms`{.sample}'

    :   Left/Right to Mid/Side.

    '`ms>lr`{.sample}'

    :   Mid/Side to Left/Right.

    '`lr>ll`{.sample}'

    :   Left/Right to Left/Left.

    '`lr>rr`{.sample}'

    :   Left/Right to Right/Right.

    '`lr>l+r`{.sample}'

    :   Left/Right to Left + Right.

    '`lr>rl`{.sample}'

    :   Left/Right to Right/Left.

    '`ms>ll`{.sample}'

    :   Mid/Side to Left/Left.

    '`ms>rr`{.sample}'

    :   Mid/Side to Right/Right.

    '`ms>rl`{.sample}'

    :   Mid/Side to Right/Left.

    '`lr>l-r`{.sample}'

    :   Left/Right to Left - Right.

`slev`{.sample}

:   Set level of side signal. Default is 1. Allowed range is from
    0.015625 to 64.

`sbal`{.sample}

:   Set balance of side signal. Default is 0. Allowed range is from -1
    to 1.

`mlev`{.sample}

:   Set level of the middle signal. Default is 1. Allowed range is from
    0.015625 to 64.

`mpan`{.sample}

:   Set middle signal pan. Default is 0. Allowed range is from -1 to 1.

`base`{.sample}

:   Set stereo base between mono and inversed channels. Default is 0.
    Allowed range is from -1 to 1.

`delay`{.sample}

:   Set delay in milliseconds how much to delay left from right channel
    and vice versa. Default is 0. Allowed range is from -20 to 20.

`sclevel`{.sample}

:   Set S/C level. Default is 1. Allowed range is from 1 to 100.

`phase`{.sample}

:   Set the stereo phase in degrees. Default is 0. Allowed range is from
    0 to 360.

`bmode_in, bmode_out`{.sample}

:   Set balance mode for balance_in/balance_out option.

    Can be one of the following:

    '`balance`{.sample}'

    :   Classic balance mode. Attenuate one channel at time. Gain is
        raised up to 1.

    '`amplitude`{.sample}'

    :   Similar as classic mode above but gain is raised up to 2.

    '`power`{.sample}'

    :   Equal power distribution, from -6dB to +6dB range.

[]{#Commands-49}

#### [36.111.1 Commands](#toc-Commands-49) {#commands-49 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#Examples-80}

#### [36.111.2 Examples](#toc-Examples-80) {#examples-80 .subsection}

- Apply karaoke like effect:

  ::: example
  ``` example
  stereotools=mlev=0.015625
  ```
  :::
- Convert M/S signal to L/R:

  ::: example
  ``` example
  "stereotools=mode=ms>lr"
  ```
  :::

[]{#stereowiden}

### [36.112 stereowiden](#toc-stereowiden) {#stereowiden .section}

This filter enhance the stereo effect by suppressing signal common to
both channels and by delaying the signal of left into right and vice
versa, thereby widening the stereo effect.

The filter accepts the following options:

`delay`{.sample}

:   Time in milliseconds of the delay of left signal into right and vice
    versa. Default is 20 milliseconds.

`feedback`{.sample}

:   Amount of gain in delayed signal into right and vice versa. Gives a
    delay effect of left signal in right output and vice versa which
    gives widening effect. Default is 0.3.

`crossfeed`{.sample}

:   Cross feed of left into right with inverted phase. This helps in
    suppressing the mono. If the value is 1 it will cancel all the
    signal common to both channels. Default is 0.3.

`drymix`{.sample}

:   Set level of input signal of original channel. Default is 0.8.

[]{#Commands-50}

#### [36.112.1 Commands](#toc-Commands-50) {#commands-50 .subsection}

This filter supports the all above options except `delay` as
[commands](#commands).

[]{#superequalizer}

### [36.113 superequalizer](#toc-superequalizer) {#superequalizer .section}

Apply 18 band equalizer.

The filter accepts the following options:

`1b`{.sample}

:   Set 65Hz band gain.

`2b`{.sample}

:   Set 92Hz band gain.

`3b`{.sample}

:   Set 131Hz band gain.

`4b`{.sample}

:   Set 185Hz band gain.

`5b`{.sample}

:   Set 262Hz band gain.

`6b`{.sample}

:   Set 370Hz band gain.

`7b`{.sample}

:   Set 523Hz band gain.

`8b`{.sample}

:   Set 740Hz band gain.

`9b`{.sample}

:   Set 1047Hz band gain.

`10b`{.sample}

:   Set 1480Hz band gain.

`11b`{.sample}

:   Set 2093Hz band gain.

`12b`{.sample}

:   Set 2960Hz band gain.

`13b`{.sample}

:   Set 4186Hz band gain.

`14b`{.sample}

:   Set 5920Hz band gain.

`15b`{.sample}

:   Set 8372Hz band gain.

`16b`{.sample}

:   Set 11840Hz band gain.

`17b`{.sample}

:   Set 16744Hz band gain.

`18b`{.sample}

:   Set 20000Hz band gain.

[]{#surround}

### [36.114 surround](#toc-surround) {#surround .section}

Apply audio surround upmix filter.

This filter allows to produce multichannel output from audio stream.

The filter accepts the following options:

`chl_out`{.sample}

Set output channel layout. By default, this is `5.1`{.variable}.

See [(ffmpeg-utils)the Channel Layout section in the ffmpeg-utils(1)
manual](ffmpeg-utils.html#channel-layout-syntax) for the required
syntax.

`chl_in`{.sample}

Set input channel layout. By default, this is `stereo`{.variable}.

See [(ffmpeg-utils)the Channel Layout section in the ffmpeg-utils(1)
manual](ffmpeg-utils.html#channel-layout-syntax) for the required
syntax.

`level_in`{.sample}

Set input volume level. By default, this is `1`{.variable}.

`level_out`{.sample}

Set output volume level. By default, this is `1`{.variable}.

`lfe`{.sample}

Enable LFE channel output if output channel layout has it. By default,
this is enabled.

`lfe_low`{.sample}

Set LFE low cut off frequency. By default, this is `128`{.variable} Hz.

`lfe_high`{.sample}

Set LFE high cut off frequency. By default, this is `256`{.variable} Hz.

`lfe_mode`{.sample}

Set LFE mode, can be `add`{.variable} or `sub`{.variable}. Default is
`add`{.variable}. In `add`{.variable} mode, LFE channel is created from
input audio and added to output. In `sub`{.variable} mode, LFE channel
is created from input audio and added to output but also all non-LFE
output channels are subtracted with output LFE channel.

`smooth`{.sample}

Set temporal smoothness strength, used to gradually change factors when
transforming stereo sound in time. Allowed range is from
`0.0`{.variable} to `1.0`{.variable}. Useful to improve output quality
with `focus`{.variable} option values greater than `0.0`{.variable}.
Default is `0.0`{.variable}. Only values inside this range and without
edges are effective.

`angle`{.sample}

Set angle of stereo surround transform, Allowed range is from
`0`{.variable} to `360`{.variable}. Default is `90`{.variable}.

`focus`{.sample}

Set focus of stereo surround transform, Allowed range is from
`-1`{.variable} to `1`{.variable}. Default is `0`{.variable}.

`fc_in`{.sample}

Set front center input volume. By default, this is `1`{.variable}.

`fc_out`{.sample}

Set front center output volume. By default, this is `1`{.variable}.

`fl_in`{.sample}

Set front left input volume. By default, this is `1`{.variable}.

`fl_out`{.sample}

Set front left output volume. By default, this is `1`{.variable}.

`fr_in`{.sample}

Set front right input volume. By default, this is `1`{.variable}.

`fr_out`{.sample}

Set front right output volume. By default, this is `1`{.variable}.

`sl_in`{.sample}

Set side left input volume. By default, this is `1`{.variable}.

`sl_out`{.sample}

Set side left output volume. By default, this is `1`{.variable}.

`sr_in`{.sample}

Set side right input volume. By default, this is `1`{.variable}.

`sr_out`{.sample}

Set side right output volume. By default, this is `1`{.variable}.

`bl_in`{.sample}

Set back left input volume. By default, this is `1`{.variable}.

`bl_out`{.sample}

Set back left output volume. By default, this is `1`{.variable}.

`br_in`{.sample}

Set back right input volume. By default, this is `1`{.variable}.

`br_out`{.sample}

Set back right output volume. By default, this is `1`{.variable}.

`bc_in`{.sample}

Set back center input volume. By default, this is `1`{.variable}.

`bc_out`{.sample}

Set back center output volume. By default, this is `1`{.variable}.

`lfe_in`{.sample}

Set LFE input volume. By default, this is `1`{.variable}.

`lfe_out`{.sample}

Set LFE output volume. By default, this is `1`{.variable}.

`allx`{.sample}

Set spread usage of stereo image across X axis for all channels. Allowed
range is from `-1`{.variable} to `15`{.variable}. By default this value
is negative `-1`{.variable}, and thus unused.

`ally`{.sample}

Set spread usage of stereo image across Y axis for all channels. Allowed
range is from `-1`{.variable} to `15`{.variable}. By default this value
is negative `-1`{.variable}, and thus unused.

`fcx, flx, frx, blx, brx, slx, srx, bcx`{.sample}

Set spread usage of stereo image across X axis for each channel. Allowed
range is from `0.06`{.variable} to `15`{.variable}. By default this
value is `0.5`{.variable}.

`fcy, fly, fry, bly, bry, sly, sry, bcy`{.sample}

Set spread usage of stereo image across Y axis for each channel. Allowed
range is from `0.06`{.variable} to `15`{.variable}. By default this
value is `0.5`{.variable}.

`win_size`{.sample}

Set window size. Allowed range is from `1024`{.variable} to
`65536`{.variable}. Default size is `4096`{.variable}.

`win_func`{.sample}

Set window function.

It accepts the following values:

'`rect`{.sample}'

'`bartlett`{.sample}'

'`hann, hanning`{.sample}'

'`hamming`{.sample}'

'`blackman`{.sample}'

'`welch`{.sample}'

'`flattop`{.sample}'

'`bharris`{.sample}'

'`bnuttall`{.sample}'

'`bhann`{.sample}'

'`sine`{.sample}'

'`nuttall`{.sample}'

'`lanczos`{.sample}'

'`gauss`{.sample}'

'`tukey`{.sample}'

'`dolph`{.sample}'

'`cauchy`{.sample}'

'`parzen`{.sample}'

'`poisson`{.sample}'

'`bohman`{.sample}'

'`kaiser`{.sample}'

Default is `hann`.

`overlap`{.sample}

Set window overlap. If set to 1, the recommended overlap for selected
window function will be picked. Default is `0.5`.

[]{#tiltshelf}

### [36.115 tiltshelf](#toc-tiltshelf) {#tiltshelf .section}

Boost or cut the lower frequencies and cut or boost higher frequencies
of the audio using a two-pole shelving filter with a response similar to
that of a standard hi-fi's tone-controls. This is also known as shelving
equalisation (EQ).

The filter accepts the following options:

`gain, g`{.sample}

Give the gain at 0 Hz. Its useful range is about -20 (for a large cut)
to +20 (for a large boost). Beware of clipping when using a positive
gain.

`frequency, f`{.sample}

Set the filter's central frequency and so can be used to extend or
reduce the frequency range to be boosted or cut. The default value is
`3000` Hz.

`width_type, t`{.sample}

Set method to specify band-width of filter.

`h`{.sample}

:   Hz

`q`{.sample}

:   Q-Factor

`o`{.sample}

:   octave

`s`{.sample}

:   slope

`k`{.sample}

:   kHz

`width, w`{.sample}

Determine how steep is the filter's shelf transition.

`poles, p`{.sample}

Set number of poles. Default is 2.

`mix, m`{.sample}

How much to use filtered signal in output. Default is 1. Range is
between 0 and 1.

`channels, c`{.sample}

Specify which channels to filter, by default all available are filtered.

`normalize, n`{.sample}

Normalize biquad coefficients, by default is disabled. Enabling it will
normalize magnitude response at DC to 0dB.

`transform, a`{.sample}

Set transform type of IIR filter.

`di`{.sample}

`dii`{.sample}

`tdi`{.sample}

`tdii`{.sample}

`latt`{.sample}

`svf`{.sample}

`zdf`{.sample}

`precision, r`{.sample}

Set precision of filtering.

`auto`{.sample}

:   Pick automatic sample format depending on surround filters.

`s16`{.sample}

:   Always use signed 16-bit.

`s32`{.sample}

:   Always use signed 32-bit.

`f32`{.sample}

:   Always use float 32-bit.

`f64`{.sample}

:   Always use float 64-bit.

`block_size, b`{.sample}

Set block size used for reverse IIR processing. If this value is set to
high enough value (higher than impulse response length truncated when
reaches near zero values) filtering will become linear phase otherwise
if not big enough it will just produce nasty artifacts.

Note that filter delay will be exactly this many samples when set to
non-zero value.

[]{#Commands-51}

#### [36.115.1 Commands](#toc-Commands-51) {#commands-51 .subsection}

This filter supports some options as [commands](#commands).

[]{#treble_002c-highshelf}

### [36.116 treble, highshelf](#toc-treble_002c-highshelf) {#treble-highshelf .section}

Boost or cut treble (upper) frequencies of the audio using a two-pole
shelving filter with a response similar to that of a standard hi-fi's
tone-controls. This is also known as shelving equalisation (EQ).

The filter accepts the following options:

`gain, g`{.sample}

Give the gain at whichever is the lower of \~22 kHz and the Nyquist
frequency. Its useful range is about -20 (for a large cut) to +20 (for a
large boost). Beware of clipping when using a positive gain.

`frequency, f`{.sample}

Set the filter's central frequency and so can be used to extend or
reduce the frequency range to be boosted or cut. The default value is
`3000` Hz.

`width_type, t`{.sample}

Set method to specify band-width of filter.

`h`{.sample}

:   Hz

`q`{.sample}

:   Q-Factor

`o`{.sample}

:   octave

`s`{.sample}

:   slope

`k`{.sample}

:   kHz

`width, w`{.sample}

Determine how steep is the filter's shelf transition.

`poles, p`{.sample}

Set number of poles. Default is 2.

`mix, m`{.sample}

How much to use filtered signal in output. Default is 1. Range is
between 0 and 1.

`channels, c`{.sample}

Specify which channels to filter, by default all available are filtered.

`normalize, n`{.sample}

Normalize biquad coefficients, by default is disabled. Enabling it will
normalize magnitude response at DC to 0dB.

`transform, a`{.sample}

Set transform type of IIR filter.

`di`{.sample}

`dii`{.sample}

`tdi`{.sample}

`tdii`{.sample}

`latt`{.sample}

`svf`{.sample}

`zdf`{.sample}

`precision, r`{.sample}

Set precision of filtering.

`auto`{.sample}

:   Pick automatic sample format depending on surround filters.

`s16`{.sample}

:   Always use signed 16-bit.

`s32`{.sample}

:   Always use signed 32-bit.

`f32`{.sample}

:   Always use float 32-bit.

`f64`{.sample}

:   Always use float 64-bit.

`block_size, b`{.sample}

Set block size used for reverse IIR processing. If this value is set to
high enough value (higher than impulse response length truncated when
reaches near zero values) filtering will become linear phase otherwise
if not big enough it will just produce nasty artifacts.

Note that filter delay will be exactly this many samples when set to
non-zero value.

[]{#Commands-52}

#### [36.116.1 Commands](#toc-Commands-52) {#commands-52 .subsection}

This filter supports the following commands:

`frequency, f`{.sample}

:   Change treble frequency. Syntax for the command is :
    \"`frequency`{.variable}\"

`width_type, t`{.sample}

:   Change treble width_type. Syntax for the command is :
    \"`width_type`{.variable}\"

`width, w`{.sample}

:   Change treble width. Syntax for the command is :
    \"`width`{.variable}\"

`gain, g`{.sample}

:   Change treble gain. Syntax for the command is :
    \"`gain`{.variable}\"

`mix, m`{.sample}

:   Change treble mix. Syntax for the command is : \"`mix`{.variable}\"

[]{#tremolo}

### [36.117 tremolo](#toc-tremolo) {#tremolo .section}

Sinusoidal amplitude modulation.

The filter accepts the following options:

`f`{.sample}

:   Modulation frequency in Hertz. Modulation frequencies in the
    subharmonic range (20 Hz or lower) will result in a tremolo effect.
    This filter may also be used as a ring modulator by specifying a
    modulation frequency higher than 20 Hz. Range is 0.1 - 20000.0.
    Default value is 5.0 Hz.

`d`{.sample}

:   Depth of modulation as a percentage. Range is 0.0 - 1.0. Default
    value is 0.5.

[]{#vibrato}

### [36.118 vibrato](#toc-vibrato) {#vibrato .section}

Sinusoidal phase modulation.

The filter accepts the following options:

`f`{.sample}

:   Modulation frequency in Hertz. Range is 0.1 - 20000.0. Default value
    is 5.0 Hz.

`d`{.sample}

:   Depth of modulation as a percentage. Range is 0.0 - 1.0. Default
    value is 0.5.

[]{#virtualbass}

### [36.119 virtualbass](#toc-virtualbass) {#virtualbass .section}

Apply audio Virtual Bass filter.

This filter accepts stereo input and produce stereo with LFE (2.1)
channels output. The newly produced LFE channel have enhanced virtual
bass originally obtained from both stereo channels. This filter outputs
front left and front right channels unchanged as available in stereo
input.

The filter accepts the following options:

`cutoff`{.sample}

:   Set the virtual bass cutoff frequency. Default value is 250 Hz.
    Allowed range is from 100 to 500 Hz.

`strength`{.sample}

:   Set the virtual bass strength. Allowed range is from 0.5 to 3.
    Default value is 3.

[]{#volume}

### [36.120 volume](#toc-volume) {#volume .section}

Adjust the input audio volume.

It accepts the following parameters:

`volume`{.sample}

:   Set audio volume expression.

    Output values are clipped to the maximum value.

    The output audio volume is given by the relation:

    ::: example
    ``` example
    output_volume = volume * input_volume
    ```
    :::

    The default value for `volume`{.variable} is \"1.0\".

`precision`{.sample}

:   This parameter represents the mathematical precision.

    It determines which input sample formats will be allowed, which
    affects the precision of the volume scaling.

    `fixed`{.sample}

    :   8-bit fixed-point; this limits input sample format to U8, S16,
        and S32.

    `float`{.sample}

    :   32-bit floating-point; this limits input sample format to FLT.
        (default)

    `double`{.sample}

    :   64-bit floating-point; this limits input sample format to DBL.

`replaygain`{.sample}

:   Choose the behaviour on encountering ReplayGain side data in input
    frames.

    `drop`{.sample}

    :   Remove ReplayGain side data, ignoring its contents (the
        default).

    `ignore`{.sample}

    :   Ignore ReplayGain side data, but leave it in the frame.

    `track`{.sample}

    :   Prefer the track gain, if present.

    `album`{.sample}

    :   Prefer the album gain, if present.

`replaygain_preamp`{.sample}

:   Pre-amplification gain in dB to apply to the selected replaygain
    gain.

    Default value for `replaygain_preamp`{.variable} is 0.0.

`replaygain_noclip`{.sample}

:   Prevent clipping by limiting the gain applied.

    Default value for `replaygain_noclip`{.variable} is 1.

`eval`{.sample}

:   Set when the volume expression is evaluated.

    It accepts the following values:

    '`once`{.sample}'

    :   only evaluate expression once during the filter initialization,
        or when the '`volume`{.sample}' command is sent

    '`frame`{.sample}'

    :   evaluate expression for each incoming frame

    Default value is '`once`{.sample}'.

The volume expression can contain the following parameters.

`n`{.sample}

:   frame number (starting at zero)

`nb_channels`{.sample}

:   number of channels

`nb_consumed_samples`{.sample}

:   number of samples consumed by the filter

`nb_samples`{.sample}

:   number of samples in the current frame

`pos`{.sample}

:   original frame position in the file; deprecated, do not use

`pts`{.sample}

:   frame PTS

`sample_rate`{.sample}

:   sample rate

`startpts`{.sample}

:   PTS at start of stream

`startt`{.sample}

:   time at start of stream

`t`{.sample}

:   frame time

`tb`{.sample}

:   timestamp timebase

`volume`{.sample}

:   last set volume value

Note that when `eval`{.sample} is set to '`once`{.sample}' only the
`sample_rate`{.variable} and `tb`{.variable} variables are available,
all other variables will evaluate to NAN.

[]{#Commands-53}

#### [36.120.1 Commands](#toc-Commands-53) {#commands-53 .subsection}

This filter supports the following commands:

`volume`{.sample}

:   Modify the volume expression. The command accepts the same syntax of
    the corresponding option.

    If the specified expression is not valid, it is kept at its current
    value.

[]{#Examples-81}

#### [36.120.2 Examples](#toc-Examples-81) {#examples-81 .subsection}

- Halve the input audio volume:

  ::: example
  ``` example
  volume=volume=0.5
  volume=volume=1/2
  volume=volume=-6.0206dB
  ```
  :::

  In all the above example the named key for `volume`{.sample} can be
  omitted, for example like in:

  ::: example
  ``` example
  volume=0.5
  ```
  :::

- Increase input audio power by 6 decibels using fixed-point precision:

  ::: example
  ``` example
  volume=volume=6dB:precision=fixed
  ```
  :::

- Fade volume after time 10 with an annihilation period of 5 seconds:

  ::: example
  ``` example
  volume='if(lt(t,10),1,max(1-(t-10)/5,0))':eval=frame
  ```
  :::

[]{#volumedetect}

### [36.121 volumedetect](#toc-volumedetect) {#volumedetect .section}

Detect the volume of the input video.

The filter has no parameters. It supports only 16-bit signed integer
samples, so the input will be converted when needed. Statistics about
the volume will be printed in the log when the input stream end is
reached.

In particular it will show the mean volume (root mean square), maximum
volume (on a per-sample basis), and the beginning of a histogram of the
registered volume values (from the maximum value to a cumulated 1/1000
of the samples).

All volumes are in decibels relative to the maximum PCM value.

[]{#Examples-82}

#### [36.121.1 Examples](#toc-Examples-82) {#examples-82 .subsection}

Here is an excerpt of the output:

::: example
``` example
[Parsed_volumedetect_0 0xa23120] mean_volume: -27 dB
[Parsed_volumedetect_0 0xa23120] max_volume: -4 dB
[Parsed_volumedetect_0 0xa23120] histogram_4db: 6
[Parsed_volumedetect_0 0xa23120] histogram_5db: 62
[Parsed_volumedetect_0 0xa23120] histogram_6db: 286
[Parsed_volumedetect_0 0xa23120] histogram_7db: 1042
[Parsed_volumedetect_0 0xa23120] histogram_8db: 2551
[Parsed_volumedetect_0 0xa23120] histogram_9db: 4609
[Parsed_volumedetect_0 0xa23120] histogram_10db: 8409
```
:::

It means that:

- The mean square energy is approximately -27 dB, or 10\^-2.7.
- The largest sample is at -4 dB, or more precisely between -4 dB and -5
  dB.
- There are 6 samples at -4 dB, 62 at -5 dB, 286 at -6 dB, etc.

In other words, raising the volume by +4 dB does not cause any clipping,
raising it by +5 dB causes clipping for 6 samples, etc.

[]{#whisper}[]{#whisper-1}

### [36.122 whisper](#toc-whisper-1) {#whisper .section}

It runs automatic speech recognition using the OpenAI's Whisper model.

It requires the whisper.cpp library
(https://github.com/ggml-org/whisper.cpp) as a prerequisite. After
installing the library it can be enabled using:
`./configure --enable-whisper`.

The filter has following options:

`model`{.sample}

:   The file path of the downloaded whisper.cpp model (mandatory).

`language`{.sample}

:   The language to use for transcription ('auto' for auto-detect).
    Default value: `"auto"`

`queue`{.sample}

:   The maximum size that will be queued into the filter before
    processing the audio with whisper. Using a small value the audio
    stream will be processed more often, but the transcription quality
    will be lower and the required processing power will be higher.
    Using a large value (e.g. 10-20s) will produce more accurate results
    using less CPU (as using the whisper-cli tool), but the
    transcription latency will be higher, thus not useful to process
    real-time streams. Consider using the vad_model option associated
    with a large queue value. Default value: `"3"`

`use_gpu`{.sample}

:   If the GPU support should be enabled. Default value: `"true"`

`gpu_device`{.sample}

:   The GPU device index to use. Default value: `"0"`

`destination`{.sample}

:   If set, the transcription output will be sent to the specified file
    or URL (use one of the FFmpeg AVIO protocols); otherwise, the output
    will be logged as info messages. The output will also be set in the
    \"lavfi.whisper.text\" frame metadata. If the destination is a file
    and it already exists, it will be overwritten.

`format`{.sample}

:   The destination format string; it could be \"text\" (only the
    transcribed text will be sent to the destination), \"srt\" (subtitle
    format) or \"json\". Default value: `"text"`

`vad_model`{.sample}

:   Path to the VAD model file. If set, the filter will load an
    additional voice activity detection module
    (https://github.com/snakers4/silero-vad) that will be used to
    fragment the audio queue; use this option setting a valid path
    obtained from the whisper.cpp repository (e.g.
    \"../whisper.cpp/models/ggml-silero-v5.1.2.bin\") and increase the
    queue parameter to a higher value (e.g. 20).

`vad_threshold`{.sample}

:   The VAD threshold to use. Default value: `"0.5"`

`vad_min_speech_duration`{.sample}

:   The minimum VAD speaking duration. Default value: `"0.1"`

`vad_min_silence_duration`{.sample}

:   The minimum VAD silence duration. Default value: `"0.5"`

[]{#Examples-83}

#### [36.122.1 Examples](#toc-Examples-83) {#examples-83 .subsection}

- Run a transcription with srt file generation:

  ::: example
  ``` example
  ffmpeg -i input.mp4 -vn -af "whisper=model=../whisper.cpp/models/ggml-base.en.bin\
  :language=en\
  :queue=3\
  :destination=output.srt\
  :format=srt" -f null -
  ```
  :::
- Run a transcription and send the output in JSON format to an HTTP
  service:

  ::: example
  ``` example
  ffmpeg -i input.mp4 -vn -af "whisper=model=../whisper.cpp/models/ggml-base.en.bin\
  :language=en\
  :queue=3\
  :destination=http\\://localhost\\:3000\
  :format=json' -f null -
  ```
  :::
- Transcribe the microphone input using the VAD option:

  ::: example
  ``` example
  ffmpeg -loglevel warning -f pulse -i default \
  -af 'highpass=f=200,lowpass=f=3000,whisper=model=../whisper.cpp/models/ggml-medium.bin\
  :language=en\
  :queue=10\
  :destination=-\
  :format=json\
  :vad_model=../whisper.cpp/models/ggml-silero-v5.1.2.bin' -f null -
  ```
  :::

[]{#Audio-Sources}

## [37 Audio Sources](#toc-Audio-Sources) {#audio-sources .chapter}

Below is a description of the currently available audio sources.

[]{#abuffer}

### [37.1 abuffer](#toc-abuffer) {#abuffer .section}

Buffer audio frames, and make them available to the filter chain.

This source is mainly intended for a programmatic use, in particular
through the interface defined in `libavfilter/buffersrc.h`{.sample}.

It accepts the following parameters:

`time_base`{.sample}

:   The timebase which will be used for timestamps of submitted frames.
    It must be either a floating-point number or in
    `numerator`{.variable}/`denominator`{.variable} form.

`sample_rate`{.sample}

:   The sample rate of the incoming audio buffers.

`sample_fmt`{.sample}

:   The sample format of the incoming audio buffers. Either a sample
    format name or its corresponding integer representation from the
    enum AVSampleFormat in `libavutil/samplefmt.h`{.sample}

`channel_layout`{.sample}

:   The channel layout of the incoming audio buffers. Either a channel
    layout name from channel_layout_map in
    `libavutil/channel_layout.c`{.sample} or its corresponding integer
    representation from the AV_CH_LAYOUT\_\* macros in
    `libavutil/channel_layout.h`{.sample}

`channels`{.sample}

:   The number of channels of the incoming audio buffers. If both
    `channels`{.variable} and `channel_layout`{.variable} are specified,
    then they must be consistent.

[]{#Examples-84}

#### [37.1.1 Examples](#toc-Examples-84) {#examples-84 .subsection}

::: example
``` example
abuffer=sample_rate=44100:sample_fmt=s16p:channel_layout=stereo
```
:::

will instruct the source to accept planar 16bit signed stereo at
44100Hz. Since the sample format with name \"s16p\" corresponds to the
number 6 and the \"stereo\" channel layout corresponds to the value 0x3,
this is equivalent to:

::: example
``` example
abuffer=sample_rate=44100:sample_fmt=6:channel_layout=0x3
```
:::

[]{#aevalsrc}

### [37.2 aevalsrc](#toc-aevalsrc) {#aevalsrc .section}

Generate an audio signal specified by an expression.

This source accepts in input one or more expressions (one for each
channel), which are evaluated and used to generate a corresponding audio
signal.

This source accepts the following options:

`exprs`{.sample}

:   Set the '\|'-separated expressions list for each separate channel.
    In case the `channel_layout`{.sample} option is not specified, the
    selected channel layout depends on the number of provided
    expressions. Otherwise the last specified expression is applied to
    the remaining output channels.

`channel_layout, c`{.sample}

:   Set the channel layout. The number of channels in the specified
    layout must be equal to the number of specified expressions.

`duration, d`{.sample}

:   Set the minimum duration of the sourced audio. See
    [(ffmpeg-utils)the Time duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax) for the accepted
    syntax. Note that the resulting duration may be greater than the
    specified duration, as the generated audio is always cut at the end
    of a complete frame.

    If not specified, or the expressed duration is negative, the audio
    is supposed to be generated forever.

`nb_samples, n`{.sample}

:   Set the number of samples per channel per each output frame, default
    to 1024.

`sample_rate, s`{.sample}

:   Specify the sample rate, default to 44100.

Each expression in `exprs`{.variable} can contain the following
constants:

`n`{.sample}

:   number of the evaluated sample, starting from 0

`t`{.sample}

:   time of the evaluated sample expressed in seconds, starting from 0

`s`{.sample}

:   sample rate

[]{#Examples-85}

#### [37.2.1 Examples](#toc-Examples-85) {#examples-85 .subsection}

- Generate silence:

  ::: example
  ``` example
  aevalsrc=0
  ```
  :::
- Generate a sin signal with frequency of 440 Hz, set sample rate to
  8000 Hz:

  ::: example
  ``` example
  aevalsrc="sin(440*2*PI*t):s=8000"
  ```
  :::
- Generate a two channels signal, specify the channel layout (Front
  Center + Back Center) explicitly:

  ::: example
  ``` example
  aevalsrc="sin(420*2*PI*t)|cos(430*2*PI*t):c=FC|BC"
  ```
  :::
- Generate white noise:

  ::: example
  ``` example
  aevalsrc="-2+random(0)"
  ```
  :::
- Generate an amplitude modulated signal:

  ::: example
  ``` example
  aevalsrc="sin(10*2*PI*t)*sin(880*2*PI*t)"
  ```
  :::
- Generate 2.5 Hz binaural beats on a 360 Hz carrier:

  ::: example
  ``` example
  aevalsrc="0.1*sin(2*PI*(360-2.5/2)*t) | 0.1*sin(2*PI*(360+2.5/2)*t)"
  ```
  :::

[]{#afdelaysrc}

### [37.3 afdelaysrc](#toc-afdelaysrc) {#afdelaysrc .section}

Generate a fractional delay FIR coefficients.

The resulting stream can be used with [afir](#afir) filter for filtering
the audio signal.

The filter accepts the following options:

`delay, d`{.sample}

:   Set the fractional delay. Default is 0.

`sample_rate, r`{.sample}

:   Set the sample rate, default is 44100.

`nb_samples, n`{.sample}

:   Set the number of samples per each frame. Default is 1024.

`taps, t`{.sample}

:   Set the number of filter coefficients in output audio stream.
    Default value is 0.

`channel_layout, c`{.sample}

:   Specifies the channel layout, and can be a string representing a
    channel layout. The default value of `channel_layout`{.variable} is
    \"stereo\".

[]{#afireqsrc}

### [37.4 afireqsrc](#toc-afireqsrc) {#afireqsrc .section}

Generate a FIR equalizer coefficients.

The resulting stream can be used with [afir](#afir) filter for filtering
the audio signal.

The filter accepts the following options:

`preset, p`{.sample}

Set equalizer preset. Default preset is `flat`.

Available presets are:

'`custom`{.sample}'

'`flat`{.sample}'

'`acoustic`{.sample}'

'`bass`{.sample}'

'`beats`{.sample}'

'`classic`{.sample}'

'`clear`{.sample}'

'`deep bass`{.sample}'

'`dubstep`{.sample}'

'`electronic`{.sample}'

'`hard-style`{.sample}'

'`hip-hop`{.sample}'

'`jazz`{.sample}'

'`metal`{.sample}'

'`movie`{.sample}'

'`pop`{.sample}'

'`r&b`{.sample}'

'`rock`{.sample}'

'`vocal booster`{.sample}'

`gains, g`{.sample}

Set custom gains for each band. Only used if the preset option is set to
`custom`. Gains are separated by white spaces and each gain is set in
dBFS. Default is `0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0`.

`bands, b`{.sample}

Set the custom bands from where custom equalizer gains are set. This
must be in strictly increasing order. Only used if the preset option is
set to `custom`. Bands are separated by white spaces and each band
represent frequency in Hz. Default is
`25 40 63 100 160 250 400 630 1000 1600 2500 4000 6300 10000 16000 24000`.

`taps, t`{.sample}

Set number of filter coefficients in output audio stream. Default value
is `4096`.

`sample_rate, r`{.sample}

Set sample rate of output audio stream, default is `44100`.

`nb_samples, n`{.sample}

Set number of samples per each frame in output audio stream. Default is
`1024`.

`interp, i`{.sample}

Set interpolation method for FIR equalizer coefficients. Can be `linear`
or `cubic`.

`phase, h`{.sample}

Set phase type of FIR filter. Can be `linear` or `min`: minimum-phase.
Default is minimum-phase filter.

[]{#afirsrc}

### [37.5 afirsrc](#toc-afirsrc) {#afirsrc .section}

Generate a FIR coefficients using frequency sampling method.

The resulting stream can be used with [afir](#afir) filter for filtering
the audio signal.

The filter accepts the following options:

`taps, t`{.sample}

:   Set number of filter coefficients in output audio stream. Default
    value is 1025.

`frequency, f`{.sample}

:   Set frequency points from where magnitude and phase are set. This
    must be in non decreasing order, and first element must be 0, while
    last element must be 1. Elements are separated by white spaces.

`magnitude, m`{.sample}

:   Set magnitude value for every frequency point set by
    `frequency`{.sample}. Number of values must be same as number of
    frequency points. Values are separated by white spaces.

`phase, p`{.sample}

:   Set phase value for every frequency point set by
    `frequency`{.sample}. Number of values must be same as number of
    frequency points. Values are separated by white spaces.

`sample_rate, r`{.sample}

:   Set sample rate, default is 44100.

`nb_samples, n`{.sample}

:   Set number of samples per each frame. Default is 1024.

`win_func, w`{.sample}

:   Set window function. Default is blackman.

[]{#anullsrc}

### [37.6 anullsrc](#toc-anullsrc) {#anullsrc .section}

The null audio source, return unprocessed audio frames. It is mainly
useful as a template and to be employed in analysis / debugging tools,
or as the source for filters which ignore the input data (for example
the sox synth filter).

This source accepts the following options:

`channel_layout, cl`{.sample}

:   Specifies the channel layout, and can be either an integer or a
    string representing a channel layout. The default value of
    `channel_layout`{.variable} is \"stereo\".

    Check the channel_layout_map definition in
    `libavutil/channel_layout.c`{.sample} for the mapping between
    strings and channel layout values.

`sample_rate, r`{.sample}

:   Specifies the sample rate, and defaults to 44100.

`nb_samples, n`{.sample}

:   Set the number of samples per requested frames.

`duration, d`{.sample}

:   Set the duration of the sourced audio. See [(ffmpeg-utils)the Time
    duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax) for the accepted
    syntax.

    If not specified, or the expressed duration is negative, the audio
    is supposed to be generated forever.

[]{#Examples-86}

#### [37.6.1 Examples](#toc-Examples-86) {#examples-86 .subsection}

- Set the sample rate to 48000 Hz and the channel layout to
  AV_CH_LAYOUT_MONO.

  ::: example
  ``` example
  anullsrc=r=48000:cl=4
  ```
  :::
- Do the same operation with a more obvious syntax:

  ::: example
  ``` example
  anullsrc=r=48000:cl=mono
  ```
  :::

All the parameters need to be explicitly defined.

[]{#flite}

### [37.7 flite](#toc-flite) {#flite .section}

Synthesize a voice utterance using the libflite library.

To enable compilation of this filter you need to configure FFmpeg with
`--enable-libflite`.

Note that versions of the flite library prior to 2.0 are not
thread-safe.

The filter accepts the following options:

`list_voices`{.sample}

:   If set to 1, list the names of the available voices and exit
    immediately. Default value is 0.

`nb_samples, n`{.sample}

:   Set the maximum number of samples per frame. Default value is 512.

`textfile`{.sample}

:   Set the filename containing the text to speak.

`text`{.sample}

:   Set the text to speak.

`voice, v`{.sample}

:   Set the voice to use for the speech synthesis. Default value is
    `kal`. See also the `list_voices`{.variable} option.

[]{#Examples-87}

#### [37.7.1 Examples](#toc-Examples-87) {#examples-87 .subsection}

- Read from file `speech.txt`{.sample}, and synthesize the text using
  the standard flite voice:

  ::: example
  ``` example
  flite=textfile=speech.txt
  ```
  :::
- Read the specified text selecting the `slt` voice:

  ::: example
  ``` example
  flite=text='So fare thee well, poor devil of a Sub-Sub, whose commentator I am':voice=slt
  ```
  :::
- Input text to ffmpeg:

  ::: example
  ``` example
  ffmpeg -f lavfi -i flite=text='So fare thee well, poor devil of a Sub-Sub, whose commentator I am':voice=slt
  ```
  :::
- Make `ffplay`{.sample} speak the specified text, using `flite` and the
  `lavfi` device:

  ::: example
  ``` example
  ffplay -f lavfi flite=text='No more be grieved for which that thou hast done.'
  ```
  :::

For more information about libflite, check:
<http://www.festvox.org/flite/>

[]{#anoisesrc}

### [37.8 anoisesrc](#toc-anoisesrc) {#anoisesrc .section}

Generate a noise audio signal.

The filter accepts the following options:

`sample_rate, r`{.sample}

:   Specify the sample rate. Default value is 48000 Hz.

`amplitude, a`{.sample}

:   Specify the amplitude (0.0 - 1.0) of the generated audio stream.
    Default value is 1.0.

`duration, d`{.sample}

:   Specify the duration of the generated audio stream. Not specifying
    this option results in noise with an infinite length.

`color, colour, c`{.sample}

:   Specify the color of noise. Available noise colors are white, pink,
    brown, blue, violet and velvet. Default color is white.

`seed, s`{.sample}

:   Specify a value used to seed the PRNG.

`nb_samples, n`{.sample}

:   Set the number of samples per each output frame, default is 1024.

`density`{.sample}

:   Set the density (0.0 - 1.0) for the velvet noise generator, default
    is 0.05.

[]{#Examples-88}

#### [37.8.1 Examples](#toc-Examples-88) {#examples-88 .subsection}

- Generate 60 seconds of pink noise, with a 44.1 kHz sampling rate and
  an amplitude of 0.5:

  ::: example
  ``` example
  anoisesrc=d=60:c=pink:r=44100:a=0.5
  ```
  :::

[]{#hilbert}

### [37.9 hilbert](#toc-hilbert) {#hilbert .section}

Generate odd-tap Hilbert transform FIR coefficients.

The resulting stream can be used with [afir](#afir) filter for
phase-shifting the signal by 90 degrees.

This is used in many matrix coding schemes and for analytic signal
generation. The process is often written as a multiplication by i (or
j), the imaginary unit.

The filter accepts the following options:

`sample_rate, s`{.sample}

:   Set sample rate, default is 44100.

`taps, t`{.sample}

:   Set length of FIR filter, default is 22051.

`nb_samples, n`{.sample}

:   Set number of samples per each frame.

`win_func, w`{.sample}

:   Set window function to be used when generating FIR coefficients.

[]{#sinc}

### [37.10 sinc](#toc-sinc) {#sinc .section}

Generate a sinc kaiser-windowed low-pass, high-pass, band-pass, or
band-reject FIR coefficients.

The resulting stream can be used with [afir](#afir) filter for filtering
the audio signal.

The filter accepts the following options:

`sample_rate, r`{.sample}

:   Set sample rate, default is 44100.

`nb_samples, n`{.sample}

:   Set number of samples per each frame. Default is 1024.

`hp`{.sample}

:   Set high-pass frequency. Default is 0.

`lp`{.sample}

:   Set low-pass frequency. Default is 0. If high-pass frequency is
    lower than low-pass frequency and low-pass frequency is higher than
    0 then filter will create band-pass filter coefficients, otherwise
    band-reject filter coefficients.

`phase`{.sample}

:   Set filter phase response. Default is 50. Allowed range is from 0 to
    100.

`beta`{.sample}

:   Set Kaiser window beta.

`att`{.sample}

:   Set stop-band attenuation. Default is 120dB, allowed range is from
    40 to 180 dB.

`round`{.sample}

:   Enable rounding, by default is disabled.

`hptaps`{.sample}

:   Set number of taps for high-pass filter.

`lptaps`{.sample}

:   Set number of taps for low-pass filter.

[]{#sine}

### [37.11 sine](#toc-sine) {#sine .section}

Generate an audio signal made of a sine wave with amplitude 1/8.

The audio signal is bit-exact.

The filter accepts the following options:

`frequency, f`{.sample}

:   Set the carrier frequency. Default is 440 Hz.

`beep_factor, b`{.sample}

:   Enable a periodic beep every second with frequency
    `beep_factor`{.variable} times the carrier frequency. Default is 0,
    meaning the beep is disabled.

`sample_rate, r`{.sample}

:   Specify the sample rate, default is 44100.

`duration, d`{.sample}

:   Specify the duration of the generated audio stream.

`samples_per_frame`{.sample}

:   Set the number of samples per output frame.

    The expression can contain the following constants:

    `n`{.sample}

    :   The (sequential) number of the output audio frame, starting from
        0.

    `pts`{.sample}

    :   The PTS (Presentation TimeStamp) of the output audio frame,
        expressed in `TB`{.variable} units.

    `t`{.sample}

    :   The PTS of the output audio frame, expressed in seconds.

    `TB`{.sample}

    :   The timebase of the output audio frames.

    Default is `1024`.

[]{#Examples-89}

#### [37.11.1 Examples](#toc-Examples-89) {#examples-89 .subsection}

- Generate a simple 440 Hz sine wave:

  ::: example
  ``` example
  sine
  ```
  :::
- Generate a 220 Hz sine wave with a 880 Hz beep each second, for 5
  seconds:

  ::: example
  ``` example
  sine=220:4:d=5
  sine=f=220:b=4:d=5
  sine=frequency=220:beep_factor=4:duration=5
  ```
  :::
- Generate a 1 kHz sine wave following `1602,1601,1602,1601,1602` NTSC
  pattern:

  ::: example
  ``` example
  sine=1000:samples_per_frame='st(0,mod(n,5)); 1602-not(not(eq(ld(0),1)+eq(ld(0),3)))'
  ```
  :::

[]{#Audio-Sinks}

## [38 Audio Sinks](#toc-Audio-Sinks) {#audio-sinks .chapter}

Below is a description of the currently available audio sinks.

[]{#abuffersink}

### [38.1 abuffersink](#toc-abuffersink) {#abuffersink .section}

Buffer audio frames, and make them available to the end of filter chain.

This sink is mainly intended for programmatic use, in particular through
the interface defined in `libavfilter/buffersink.h`{.sample} or the
options system.

It accepts a pointer to an AVABufferSinkContext structure, which defines
the incoming buffers' formats, to be passed as the opaque parameter to
`avfilter_init_filter` for initialization.

[]{#anullsink}

### [38.2 anullsink](#toc-anullsink) {#anullsink .section}

Null audio sink; do absolutely nothing with the input audio. It is
mainly useful as a template and for use in analysis / debugging tools.

[]{#Video-Filters}

## [39 Video Filters](#toc-Video-Filters) {#video-filters .chapter}

When you configure your FFmpeg build, you can disable any of the
existing filters using `--disable-filters`. The configure output will
show the video filters included in your build.

Below is a description of the currently available video filters.

[]{#addroi}

### [39.1 addroi](#toc-addroi) {#addroi .section}

Mark a region of interest in a video frame.

The frame data is passed through unchanged, but metadata is attached to
the frame indicating regions of interest which can affect the behaviour
of later encoding. Multiple regions can be marked by applying the filter
multiple times.

`x`{.sample}

:   Region distance in pixels from the left edge of the frame.

`y`{.sample}

:   Region distance in pixels from the top edge of the frame.

`w`{.sample}

:   Region width in pixels.

`h`{.sample}

:   Region height in pixels.

    The parameters `x`{.variable}, `y`{.variable}, `w`{.variable} and
    `h`{.variable} are expressions, and may contain the following
    variables:

    `iw`{.sample}

    :   Width of the input frame.

    `ih`{.sample}

    :   Height of the input frame.

`qoffset`{.sample}

:   Quantisation offset to apply within the region.

    This must be a real value in the range -1 to +1. A value of zero
    indicates no quality change. A negative value asks for better
    quality (less quantisation), while a positive value asks for worse
    quality (greater quantisation).

    The range is calibrated so that the extreme values indicate the
    largest possible offset - if the rest of the frame is encoded with
    the worst possible quality, an offset of -1 indicates that this
    region should be encoded with the best possible quality anyway.
    Intermediate values are then interpolated in some codec-dependent
    way.

    For example, in 10-bit H.264 the quantisation parameter varies
    between -12 and 51. A typical qoffset value of -1/10 therefore
    indicates that this region should be encoded with a QP around
    one-tenth of the full range better than the rest of the frame. So,
    if most of the frame were to be encoded with a QP of around 30, this
    region would get a QP of around 24 (an offset of approximately -1/10
    \* (51 - -12) = -6.3). An extreme value of -1 would indicate that
    this region should be encoded with the best possible quality
    regardless of the treatment of the rest of the frame - that is,
    should be encoded at a QP of -12.

`clear`{.sample}

:   If set to true, remove any existing regions of interest marked on
    the frame before adding the new one.

[]{#Examples-90}

#### [39.1.1 Examples](#toc-Examples-90) {#examples-90 .subsection}

- Mark the centre quarter of the frame as interesting.

  ::: example
  ``` example
  addroi=iw/4:ih/4:iw/2:ih/2:-1/10
  ```
  :::
- Mark the 100-pixel-wide region on the left edge of the frame as very
  uninteresting (to be encoded at much lower quality than the rest of
  the frame).

  ::: example
  ``` example
  addroi=0:0:100:ih:+1/5
  ```
  :::

[]{#alphaextract}

### [39.2 alphaextract](#toc-alphaextract) {#alphaextract .section}

Extract the alpha component from the input as a grayscale video. This is
especially useful with the `alphamerge`{.variable} filter.

[]{#alphamerge}

### [39.3 alphamerge](#toc-alphamerge) {#alphamerge .section}

Add or replace the alpha component of the primary input with the
grayscale value of a second input. This is intended for use with
`alphaextract`{.variable} to allow the transmission or storage of frame
sequences that have alpha in a format that doesn't support an alpha
channel.

For example, to reconstruct full frames from a normal YUV-encoded video
and a separate video created with `alphaextract`{.variable}, you might
use:

::: example
``` example
movie=in_alpha.mkv [alpha]; [in][alpha] alphamerge [out]
```
:::

[]{#amplify}

### [39.4 amplify](#toc-amplify) {#amplify .section}

Amplify differences between current pixel and pixels of adjacent frames
in same pixel location.

This filter accepts the following options:

`radius`{.sample}

:   Set frame radius. Default is 2. Allowed range is from 1 to 63. For
    example radius of 3 will instruct filter to calculate average of 7
    frames.

`factor`{.sample}

:   Set factor to amplify difference. Default is 2. Allowed range is
    from 0 to 65535.

`threshold`{.sample}

:   Set threshold for difference amplification. Any difference greater
    or equal to this value will not alter source pixel. Default is 10.
    Allowed range is from 0 to 65535.

`tolerance`{.sample}

:   Set tolerance for difference amplification. Any difference lower to
    this value will not alter source pixel. Default is 0. Allowed range
    is from 0 to 65535.

`low`{.sample}

:   Set lower limit for changing source pixel. Default is 65535. Allowed
    range is from 0 to 65535. This option controls maximum possible
    value that will decrease source pixel value.

`high`{.sample}

:   Set high limit for changing source pixel. Default is 65535. Allowed
    range is from 0 to 65535. This option controls maximum possible
    value that will increase source pixel value.

`planes`{.sample}

:   Set which planes to filter. Default is all. Allowed range is from 0
    to 15.

[]{#Commands-54}

#### [39.4.1 Commands](#toc-Commands-54) {#commands-54 .subsection}

This filter supports the following [commands](#commands) that
corresponds to option of same name:

`factor`{.sample}

`threshold`{.sample}

`tolerance`{.sample}

`low`{.sample}

`high`{.sample}

`planes`{.sample}

[]{#ass-1}

### [39.5 ass](#toc-ass-1) {#ass-1 .section}

Same as the [subtitles](#subtitles) filter, except that it doesn't
require libavcodec and libavformat to work. On the other hand, it is
limited to ASS (Advanced Substation Alpha) subtitles files.

This filter accepts the following option in addition to the common
options from the [subtitles](#subtitles) filter:

`shaping`{.sample}

:   Set the shaping engine

    Available values are:

    '`auto`{.sample}'

    :   The default libass shaping engine, which is the best available.

    '`simple`{.sample}'

    :   Fast, font-agnostic shaper that can do only substitutions

    '`complex`{.sample}'

    :   Slower shaper using OpenType for substitutions and positioning

    The default is `auto`.

[]{#atadenoise}

### [39.6 atadenoise](#toc-atadenoise) {#atadenoise .section}

Apply an Adaptive Temporal Averaging Denoiser to the video input.

The filter accepts the following options:

`0a`{.sample}

:   Set threshold A for 1st plane. Default is 0.02. Valid range is 0 to
    0.3.

`0b`{.sample}

:   Set threshold B for 1st plane. Default is 0.04. Valid range is 0 to
    5.

`1a`{.sample}

:   Set threshold A for 2nd plane. Default is 0.02. Valid range is 0 to
    0.3.

`1b`{.sample}

:   Set threshold B for 2nd plane. Default is 0.04. Valid range is 0 to
    5.

`2a`{.sample}

:   Set threshold A for 3rd plane. Default is 0.02. Valid range is 0 to
    0.3.

`2b`{.sample}

:   Set threshold B for 3rd plane. Default is 0.04. Valid range is 0 to
    5.

    Threshold A is designed to react on abrupt changes in the input
    signal and threshold B is designed to react on continuous changes in
    the input signal.

`s`{.sample}

:   Set number of frames filter will use for averaging. Default is 9.
    Must be odd number in range \[5, 129\].

`p`{.sample}

:   Set what planes of frame filter will use for averaging. Default is
    all.

`a`{.sample}

:   Set what variant of algorithm filter will use for averaging. Default
    is `p` parallel. Alternatively can be set to `s` serial.

    Parallel can be faster then serial, while other way around is never
    true. Parallel will abort early on first change being greater then
    thresholds, while serial will continue processing other side of
    frames if they are equal or below thresholds.

`0s`{.sample}\
`1s`{.sample}\
`2s`{.sample}

:   Set sigma for 1st plane, 2nd plane or 3rd plane. Default is 32767.
    Valid range is from 0 to 32767. This options controls weight for
    each pixel in radius defined by size. Default value means every
    pixel have same weight. Setting this option to 0 effectively
    disables filtering.

[]{#Commands-55}

#### [39.6.1 Commands](#toc-Commands-55) {#commands-55 .subsection}

This filter supports same [commands](#commands) as options except option
`s`. The command accepts the same syntax of the corresponding option.

[]{#avgblur}

### [39.7 avgblur](#toc-avgblur) {#avgblur .section}

Apply average blur filter.

The filter accepts the following options:

`sizeX`{.sample}

:   Set horizontal radius size.

`planes`{.sample}

:   Set which planes to filter. By default all planes are filtered.

`sizeY`{.sample}

:   Set vertical radius size, if zero it will be same as `sizeX`.
    Default is `0`.

[]{#Commands-56}

#### [39.7.1 Commands](#toc-Commands-56) {#commands-56 .subsection}

This filter supports same commands as options. The command accepts the
same syntax of the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#backgroundkey}

### [39.8 backgroundkey](#toc-backgroundkey) {#backgroundkey .section}

Turns a static background into transparency.

The filter accepts the following option:

`threshold`{.sample}

:   Threshold for scene change detection.

`similarity`{.sample}

:   Similarity percentage with the background.

`blend`{.sample}

:   Set the blend amount for pixels that are not similar.

[]{#Commands-57}

#### [39.8.1 Commands](#toc-Commands-57) {#commands-57 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#bbox}

### [39.9 bbox](#toc-bbox) {#bbox .section}

Compute the bounding box for the non-black pixels in the input frame
luma plane.

This filter computes the bounding box containing all the pixels with a
luma value greater than the minimum allowed value. The parameters
describing the bounding box are printed on the filter log.

The filter accepts the following option:

`min_val`{.sample}

:   Set the minimal luma value. Default is `16`.

[]{#Commands-58}

#### [39.9.1 Commands](#toc-Commands-58) {#commands-58 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#bilateral}

### [39.10 bilateral](#toc-bilateral) {#bilateral .section}

Apply bilateral filter, spatial smoothing while preserving edges.

The filter accepts the following options:

`sigmaS`{.sample}

:   Set sigma of gaussian function to calculate spatial weight. Allowed
    range is 0 to 512. Default is 0.1.

`sigmaR`{.sample}

:   Set sigma of gaussian function to calculate range weight. Allowed
    range is 0 to 1. Default is 0.1.

`planes`{.sample}

:   Set planes to filter. Default is first only.

[]{#Commands-59}

#### [39.10.1 Commands](#toc-Commands-59) {#commands-59 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#bitplanenoise}

### [39.11 bitplanenoise](#toc-bitplanenoise) {#bitplanenoise .section}

Show and measure bit plane noise.

The filter accepts the following options:

`bitplane`{.sample}

:   Set which plane to analyze. Default is `1`.

`filter`{.sample}

:   Filter out noisy pixels from `bitplane` set above. Default is
    disabled.

[]{#blackdetect_002c-blackdetect_005fvulkan}

### [39.12 blackdetect, blackdetect_vulkan](#toc-blackdetect_002c-blackdetect_005fvulkan) {#blackdetect-blackdetect_vulkan .section}

Detect video intervals that are (almost) completely black. Can be useful
to detect chapter transitions, commercials, or invalid recordings.

The filter outputs its detection analysis to both the log as well as
frame metadata. If a black segment of at least the specified minimum
duration is found, a line with the start and end timestamps as well as
duration is printed to the log with level `info`. In addition, a log
line with level `debug` is printed per frame showing the black amount
detected for that frame.

The filter also attaches metadata to the first frame of a black segment
with key `lavfi.black_start` and to the first frame after the black
segment ends with key `lavfi.black_end`. The value is the frame's
timestamp. This metadata is added regardless of the minimum duration
specified.

The filter accepts the following options:

`black_min_duration, d`{.sample}

:   Set the minimum detected black duration expressed in seconds. It
    must be a non-negative floating point number.

    Default value is 2.0.

`picture_black_ratio_th, pic_th`{.sample}

:   Set the threshold for considering a picture \"black\". Express the
    minimum value for the ratio:

    ::: example
    ``` example
    nb_black_pixels / nb_pixels
    ```
    :::

    for which a picture is considered black. Default value is 0.98.

`pixel_black_th, pix_th`{.sample}

:   Set the threshold for considering a pixel \"black\".

    The threshold expresses the maximum pixel luma value for which a
    pixel is considered \"black\". The provided value is scaled
    according to the following equation:

    ::: example
    ``` example
    absolute_threshold = luma_minimum_value + pixel_black_th * luma_range_size
    ```
    :::

    `luma_range_size`{.variable} and `luma_minimum_value`{.variable}
    depend on the input video format, the range is \[0-255\] for YUV
    full-range formats and \[16-235\] for YUV non full-range formats.

    Default value is 0.10.

`alpha`{.sample}

:   If true, check the alpha channel instead of the luma channel.
    Detects frames which are (almost) transparent, instead of frames
    which are almost black.

    Default value is disabled.

The following example sets the maximum pixel threshold to the minimum
value, and detects only black intervals of 2 or more seconds:

::: example
``` example
blackdetect=d=2:pix_th=0.00
```
:::

[]{#blackframe}

### [39.13 blackframe](#toc-blackframe) {#blackframe .section}

Detect frames that are (almost) completely black. Can be useful to
detect chapter transitions or commercials. Output lines consist of the
frame number of the detected frame, the percentage of blackness, the
position in the file if known or -1 and the timestamp in seconds.

In order to display the output lines, you need to set the loglevel at
least to the AV_LOG_INFO value.

This filter exports frame metadata `lavfi.blackframe.pblack`. The value
represents the percentage of pixels in the picture that are below the
threshold value.

It accepts the following parameters:

`amount`{.sample}

:   The percentage of the pixels that have to be below the threshold; it
    defaults to `98`.

`threshold, thresh`{.sample}

:   The threshold below which a pixel value is considered black; it
    defaults to `32`.

[]{#blend}[]{#blend-1}

### [39.14 blend](#toc-blend-1) {#blend .section}

Blend two video frames into each other.

The `blend` filter takes two input streams and outputs one stream, the
first input is the \"top\" layer and second input is \"bottom\" layer.
By default, the output terminates when the longest input terminates.

The `tblend` (time blend) filter takes two consecutive frames from one
single stream, and outputs the result obtained by blending the new frame
on top of the old frame.

A description of the accepted options follows.

`c0_mode`{.sample}

`c1_mode`{.sample}

`c2_mode`{.sample}

`c3_mode`{.sample}

`all_mode`{.sample}

Set blend mode for specific pixel component or all pixel components in
case of `all_mode`{.variable}. Default value is `normal`.

Available values for component modes are:

'`addition`{.sample}'

'`and`{.sample}'

'`average`{.sample}'

'`bleach`{.sample}'

'`burn`{.sample}'

'`darken`{.sample}'

'`difference`{.sample}'

'`divide`{.sample}'

'`dodge`{.sample}'

'`exclusion`{.sample}'

'`extremity`{.sample}'

'`freeze`{.sample}'

'`geometric`{.sample}'

'`glow`{.sample}'

'`grainextract`{.sample}'

'`grainmerge`{.sample}'

'`hardlight`{.sample}'

'`hardmix`{.sample}'

'`hardoverlay`{.sample}'

'`harmonic`{.sample}'

'`heat`{.sample}'

'`interpolate`{.sample}'

'`lighten`{.sample}'

'`linearlight`{.sample}'

'`multiply`{.sample}'

'`multiply128`{.sample}'

'`negation`{.sample}'

'`normal`{.sample}'

'`or`{.sample}'

'`overlay`{.sample}'

'`phoenix`{.sample}'

'`pinlight`{.sample}'

'`reflect`{.sample}'

'`screen`{.sample}'

'`softdifference`{.sample}'

'`softlight`{.sample}'

'`stain`{.sample}'

'`subtract`{.sample}'

'`vividlight`{.sample}'

'`xor`{.sample}'

`c0_opacity`{.sample}

`c1_opacity`{.sample}

`c2_opacity`{.sample}

`c3_opacity`{.sample}

`all_opacity`{.sample}

Set blend opacity for specific pixel component or all pixel components
in case of `all_opacity`{.variable}. Only used in combination with pixel
component blend modes.

`c0_expr`{.sample}

`c1_expr`{.sample}

`c2_expr`{.sample}

`c3_expr`{.sample}

`all_expr`{.sample}

Set blend expression for specific pixel component or all pixel
components in case of `all_expr`{.variable}. Note that related mode
options will be ignored if those are set.

The expressions can use the following variables:

`N`{.sample}

:   The sequential number of the filtered frame, starting from `0`.

`X`{.sample}\
`Y`{.sample}

:   the coordinates of the current sample

`W`{.sample}\
`H`{.sample}

:   the width and height of currently filtered plane

`SW`{.sample}\
`SH`{.sample}

:   Width and height scale for the plane being filtered. It is the ratio
    between the dimensions of the current plane to the luma plane, e.g.
    for a `yuv420p` frame, the values are `1,1` for the luma plane and
    `0.5,0.5` for the chroma planes.

`T`{.sample}

:   Time of the current frame, expressed in seconds.

`TOP, A`{.sample}

:   Value of pixel component at current location for first video frame
    (top layer).

`BOTTOM, B`{.sample}

:   Value of pixel component at current location for second video frame
    (bottom layer).

The `blend` filter also supports the [framesync](#framesync) options.

[]{#Examples-91}

#### [39.14.1 Examples](#toc-Examples-91) {#examples-91 .subsection}

- Apply transition from bottom layer to top layer in first 10 seconds:

  ::: example
  ``` example
  blend=all_expr='A*(if(gte(T,10),1,T/10))+B*(1-(if(gte(T,10),1,T/10)))'
  ```
  :::
- Apply linear horizontal transition from top layer to bottom layer:

  ::: example
  ``` example
  blend=all_expr='A*(X/W)+B*(1-X/W)'
  ```
  :::
- Apply 1x1 checkerboard effect:

  ::: example
  ``` example
  blend=all_expr='if(eq(mod(X,2),mod(Y,2)),A,B)'
  ```
  :::
- Apply uncover left effect:

  ::: example
  ``` example
  blend=all_expr='if(gte(N*SW+X,W),A,B)'
  ```
  :::
- Apply uncover down effect:

  ::: example
  ``` example
  blend=all_expr='if(gte(Y-N*SH,0),A,B)'
  ```
  :::
- Apply uncover up-left effect:

  ::: example
  ``` example
  blend=all_expr='if(gte(T*SH*40+Y,H)*gte((T*40*SW+X)*W/H,W),A,B)'
  ```
  :::
- Split diagonally video and shows top and bottom layer on each side:

  ::: example
  ``` example
  blend=all_expr='if(gt(X,Y*(W/H)),A,B)'
  ```
  :::
- Display differences between the current and the previous frame:

  ::: example
  ``` example
  tblend=all_mode=grainextract
  ```
  :::

[]{#Commands-60}

#### [39.14.2 Commands](#toc-Commands-60) {#commands-60 .subsection}

This filter supports same [commands](#commands) as options.

[]{#blockdetect}[]{#blockdetect-1}

### [39.15 blockdetect](#toc-blockdetect-1) {#blockdetect .section}

Determines blockiness of frames without altering the input frames.

Based on Remco Muijs and Ihor Kirenko: \"A no-reference blocking
artifact measure for adaptive video processing.\" 2005 13th European
signal processing conference.

The filter accepts the following options:

`period_min`{.sample}\
`period_max`{.sample}

:   Set minimum and maximum values for determining pixel grids
    (periods). Default values are \[3,24\].

`planes`{.sample}

:   Set planes to filter. Default is first only.

[]{#Examples-92}

#### [39.15.1 Examples](#toc-Examples-92) {#examples-92 .subsection}

- Determine blockiness for the first plane and search for periods within
  \[8,32\]:

  ::: example
  ``` example
  blockdetect=period_min=8:period_max=32:planes=1
  ```
  :::

[]{#blurdetect}[]{#blurdetect-1}

### [39.16 blurdetect](#toc-blurdetect-1) {#blurdetect .section}

Determines blurriness of frames without altering the input frames.

Based on Marziliano, Pina, et al. \"A no-reference perceptual blur
metric.\" Allows for a block-based abbreviation.

The filter accepts the following options:

`low`{.sample}\
`high`{.sample}

:   Set low and high threshold values used by the Canny thresholding
    algorithm.

    The high threshold selects the \"strong\" edge pixels, which are
    then connected through 8-connectivity with the \"weak\" edge pixels
    selected by the low threshold.

    `low`{.variable} and `high`{.variable} threshold values must be
    chosen in the range \[0,1\], and `low`{.variable} should be lesser
    or equal to `high`{.variable}.

    Default value for `low`{.variable} is `20/255`, and default value
    for `high`{.variable} is `50/255`.

`radius`{.sample}

:   Define the radius to search around an edge pixel for local maxima.

`block_pct`{.sample}

:   Determine blurriness only for the most significant blocks, given in
    percentage.

`block_width`{.sample}

:   Determine blurriness for blocks of width `block_width`{.variable}.
    If set to any value smaller 1, no blocks are used and the whole
    image is processed as one no matter of `block_height`{.variable}.

`block_height`{.sample}

:   Determine blurriness for blocks of height `block_height`{.variable}.
    If set to any value smaller 1, no blocks are used and the whole
    image is processed as one no matter of `block_width`{.variable}.

`planes`{.sample}

:   Set planes to filter. Default is first only.

[]{#Examples-93}

#### [39.16.1 Examples](#toc-Examples-93) {#examples-93 .subsection}

- Determine blur for 80% of most significant 32x32 blocks:

  ::: example
  ``` example
  blurdetect=block_width=32:block_height=32:block_pct=80
  ```
  :::

[]{#bm3d}

### [39.17 bm3d](#toc-bm3d) {#bm3d .section}

Denoise frames using Block-Matching 3D algorithm.

The filter accepts the following options.

`sigma`{.sample}

:   Set denoising strength. Default value is 1. Allowed range is from 0
    to 999.9. The denoising algorithm is very sensitive to sigma, so
    adjust it according to the source.

`block`{.sample}

:   Set local patch size. This sets dimensions in 2D.

`bstep`{.sample}

:   Set sliding step for processing blocks. Default value is 4. Allowed
    range is from 1 to 64. Smaller values allows processing more
    reference blocks and is slower.

`group`{.sample}

:   Set maximal number of similar blocks for 3rd dimension. Default
    value is 1. When set to 1, no block matching is done. Larger values
    allows more blocks in single group. Allowed range is from 1 to 256.

`range`{.sample}

:   Set radius for search block matching. Default is 9. Allowed range is
    from 1 to INT32_MAX.

`mstep`{.sample}

:   Set step between two search locations for block matching. Default
    is 1. Allowed range is from 1 to 64. Smaller is slower.

`thmse`{.sample}

:   Set threshold of mean square error for block matching. Valid range
    is 0 to INT32_MAX.

`hdthr`{.sample}

:   Set thresholding parameter for hard thresholding in 3D transformed
    domain. Larger values results in stronger hard-thresholding
    filtering in frequency domain.

`estim`{.sample}

:   Set filtering estimation mode. Can be `basic` or `final`. Default is
    `basic`.

`ref`{.sample}

:   If enabled, filter will use 2nd stream for block matching. Default
    is disabled for `basic` value of `estim`{.variable} option, and
    always enabled if value of `estim`{.variable} is `final`.

`planes`{.sample}

:   Set planes to filter. Default is all available except alpha.

[]{#Examples-94}

#### [39.17.1 Examples](#toc-Examples-94) {#examples-94 .subsection}

- Basic filtering with bm3d:

  ::: example
  ``` example
  bm3d=sigma=3:block=4:bstep=2:group=1:estim=basic
  ```
  :::
- Same as above, but filtering only luma:

  ::: example
  ``` example
  bm3d=sigma=3:block=4:bstep=2:group=1:estim=basic:planes=1
  ```
  :::
- Same as above, but with both estimation modes:

  ::: example
  ``` example
  split[a][b],[a]bm3d=sigma=3:block=4:bstep=2:group=1:estim=basic[a],[b][a]bm3d=sigma=3:block=4:bstep=2:group=16:estim=final:ref=1
  ```
  :::
- Same as above, but prefilter with [nlmeans](#nlmeans) filter instead:

  ::: example
  ``` example
  split[a][b],[a]nlmeans=s=3:r=7:p=3[a],[b][a]bm3d=sigma=3:block=4:bstep=2:group=16:estim=final:ref=1
  ```
  :::

[]{#boxblur}

### [39.18 boxblur](#toc-boxblur) {#boxblur .section}

Apply a boxblur algorithm to the input video.

It accepts the following parameters:

`luma_radius, lr`{.sample}

`luma_power, lp`{.sample}

`chroma_radius, cr`{.sample}

`chroma_power, cp`{.sample}

`alpha_radius, ar`{.sample}

`alpha_power, ap`{.sample}

A description of the accepted options follows.

`luma_radius, lr`{.sample}\
`chroma_radius, cr`{.sample}\
`alpha_radius, ar`{.sample}

:   Set an expression for the box radius in pixels used for blurring the
    corresponding input plane.

    The radius value must be a non-negative number, and must not be
    greater than the value of the expression `min(w,h)/2` for the luma
    and alpha planes, and of `min(cw,ch)/2` for the chroma planes.

    Default value for `luma_radius`{.sample} is \"2\". If not specified,
    `chroma_radius`{.sample} and `alpha_radius`{.sample} default to the
    corresponding value set for `luma_radius`{.sample}.

    The expressions can contain the following constants:

    `w`{.sample}\
    `h`{.sample}

    :   The input width and height in pixels.

    `cw`{.sample}\
    `ch`{.sample}

    :   The input chroma image width and height in pixels.

    `hsub`{.sample}\
    `vsub`{.sample}

    :   The horizontal and vertical chroma subsample values. For
        example, for the pixel format \"yuv422p\", `hsub`{.variable} is
        2 and `vsub`{.variable} is 1.

`luma_power, lp`{.sample}\
`chroma_power, cp`{.sample}\
`alpha_power, ap`{.sample}

:   Specify how many times the boxblur filter is applied to the
    corresponding plane.

    Default value for `luma_power`{.sample} is 2. If not specified,
    `chroma_power`{.sample} and `alpha_power`{.sample} default to the
    corresponding value set for `luma_power`{.sample}.

    A value of 0 will disable the effect.

[]{#Examples-95}

#### [39.18.1 Examples](#toc-Examples-95) {#examples-95 .subsection}

- Apply a boxblur filter with the luma, chroma, and alpha radii set to
  2:

  ::: example
  ``` example
  boxblur=luma_radius=2:luma_power=1
  boxblur=2:1
  ```
  :::
- Set the luma radius to 2, and alpha and chroma radius to 0:

  ::: example
  ``` example
  boxblur=2:1:cr=0:ar=0
  ```
  :::
- Set the luma and chroma radii to a fraction of the video dimension:

  ::: example
  ``` example
  boxblur=luma_radius=min(h\,w)/10:luma_power=1:chroma_radius=min(cw\,ch)/10:chroma_power=1
  ```
  :::

[]{#bwdif}[]{#bwdif-1}

### [39.19 bwdif](#toc-bwdif-1) {#bwdif .section}

Deinterlace the input video (\"bwdif\" stands for \"Bob Weaver
Deinterlacing Filter\").

Motion adaptive deinterlacing based on yadif with the use of w3fdif and
cubic interpolation algorithms. It accepts the following parameters:

`mode`{.sample}

:   The interlacing mode to adopt. It accepts one of the following
    values:

    `0, send_frame`{.sample}

    :   Output one frame for each frame.

    `1, send_field`{.sample}

    :   Output one frame for each field.

    The default value is `send_field`.

`parity`{.sample}

:   The picture field parity assumed for the input interlaced video. It
    accepts one of the following values:

    `0, tff`{.sample}

    :   Assume the top field is first.

    `1, bff`{.sample}

    :   Assume the bottom field is first.

    `-1, auto`{.sample}

    :   Enable automatic detection of field parity.

    The default value is `auto`. If the interlacing is unknown or the
    decoder does not export this information, top field first will be
    assumed.

`deint`{.sample}

:   Specify which frames to deinterlace. Accepts one of the following
    values:

    `0, all`{.sample}

    :   Deinterlace all frames.

    `1, interlaced`{.sample}

    :   Only deinterlace frames marked as interlaced.

    The default value is `all`.

[]{#ccrepack}

### [39.20 ccrepack](#toc-ccrepack) {#ccrepack .section}

Repack CEA-708 closed captioning side data

This filter fixes various issues seen with commercial encoders related
to upstream malformed CEA-708 payloads, specifically incorrect number of
tuples (wrong cc_count for the target FPS), and incorrect ordering of
tuples (i.e. the CEA-608 tuples are not at the first entries in the
payload).

[]{#cas}

### [39.21 cas](#toc-cas) {#cas .section}

Apply Contrast Adaptive Sharpen filter to video stream.

The filter accepts the following options:

`strength`{.sample}

:   Set the sharpening strength. Default value is 0.

`planes`{.sample}

:   Set planes to filter. Default value is to filter all planes except
    alpha plane.

[]{#Commands-61}

#### [39.21.1 Commands](#toc-Commands-61) {#commands-61 .subsection}

This filter supports same [commands](#commands) as options.

[]{#chromahold}

### [39.22 chromahold](#toc-chromahold) {#chromahold .section}

Remove all color information for all colors except for certain one.

The filter accepts the following options:

`color`{.sample}

:   The color which will not be replaced with neutral chroma.

`similarity`{.sample}

:   Similarity percentage with the above color. 0.01 matches only the
    exact key color, while 1.0 matches everything.

`blend`{.sample}

:   Blend percentage. 0.0 makes pixels either fully gray, or not gray at
    all. Higher values result in more preserved color.

`yuv`{.sample}

:   Signals that the color passed is already in YUV instead of RGB.

    Literal colors like \"green\" or \"red\" don't make sense with this
    enabled anymore. This can be used to pass exact YUV values as
    hexadecimal numbers.

[]{#Commands-62}

#### [39.22.1 Commands](#toc-Commands-62) {#commands-62 .subsection}

This filter supports same [commands](#commands) as options. The command
accepts the same syntax of the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#chromakey}[]{#chromakey-1}

### [39.23 chromakey](#toc-chromakey-1) {#chromakey .section}

YUV colorspace color/chroma keying.

The filter accepts the following options:

`color`{.sample}

:   The color which will be replaced with transparency.

`similarity`{.sample}

:   Similarity percentage with the key color.

    0.01 matches only the exact key color, while 1.0 matches everything.

`blend`{.sample}

:   Blend percentage.

    0.0 makes pixels either fully transparent, or not transparent at
    all.

    Higher values result in semi-transparent pixels, with a higher
    transparency the more similar the pixels color is to the key color.

`yuv`{.sample}

:   Signals that the color passed is already in YUV instead of RGB.

    Literal colors like \"green\" or \"red\" don't make sense with this
    enabled anymore. This can be used to pass exact YUV values as
    hexadecimal numbers.

[]{#Commands-63}

#### [39.23.1 Commands](#toc-Commands-63) {#commands-63 .subsection}

This filter supports same [commands](#commands) as options. The command
accepts the same syntax of the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#Examples-96}

#### [39.23.2 Examples](#toc-Examples-96) {#examples-96 .subsection}

- Make every green pixel in the input image transparent:

  ::: example
  ``` example
  ffmpeg -i input.png -vf chromakey=green out.png
  ```
  :::
- Overlay a greenscreen-video on top of a static black background.

  ::: example
  ``` example
  ffmpeg -f lavfi -i color=c=black:s=1280x720 -i video.mp4 -shortest -filter_complex "[1:v]chromakey=0x70de77:0.1:0.2[ckout];[0:v][ckout]overlay[out]" -map "[out]" output.mkv
  ```
  :::

[]{#chromanr}

### [39.24 chromanr](#toc-chromanr) {#chromanr .section}

Reduce chrominance noise.

The filter accepts the following options:

`thres`{.sample}

:   Set threshold for averaging chrominance values. Sum of absolute
    difference of Y, U and V pixel components of current pixel and
    neighbour pixels lower than this threshold will be used in
    averaging. Luma component is left unchanged and is copied to output.
    Default value is 30. Allowed range is from 1 to 200.

`sizew`{.sample}

:   Set horizontal radius of rectangle used for averaging. Allowed range
    is from 1 to 100. Default value is 5.

`sizeh`{.sample}

:   Set vertical radius of rectangle used for averaging. Allowed range
    is from 1 to 100. Default value is 5.

`stepw`{.sample}

:   Set horizontal step when averaging. Default value is 1. Allowed
    range is from 1 to 50. Mostly useful to speed-up filtering.

`steph`{.sample}

:   Set vertical step when averaging. Default value is 1. Allowed range
    is from 1 to 50. Mostly useful to speed-up filtering.

`threy`{.sample}

:   Set Y threshold for averaging chrominance values. Set finer control
    for max allowed difference between Y components of current pixel and
    neighbour pixels. Default value is 200. Allowed range is from 1 to
    200.

`threu`{.sample}

:   Set U threshold for averaging chrominance values. Set finer control
    for max allowed difference between U components of current pixel and
    neighbour pixels. Default value is 200. Allowed range is from 1 to
    200.

`threv`{.sample}

:   Set V threshold for averaging chrominance values. Set finer control
    for max allowed difference between V components of current pixel and
    neighbour pixels. Default value is 200. Allowed range is from 1 to
    200.

`distance`{.sample}

:   Set distance type used in calculations.

    '`manhattan`{.sample}'

    :   Absolute difference.

    '`euclidean`{.sample}'

    :   Difference squared.

    Default distance type is manhattan.

[]{#Commands-64}

#### [39.24.1 Commands](#toc-Commands-64) {#commands-64 .subsection}

This filter supports same [commands](#commands) as options. The command
accepts the same syntax of the corresponding option.

[]{#chromashift}

### [39.25 chromashift](#toc-chromashift) {#chromashift .section}

Shift chroma pixels horizontally and/or vertically.

The filter accepts the following options:

`cbh`{.sample}

:   Set amount to shift chroma-blue horizontally.

`cbv`{.sample}

:   Set amount to shift chroma-blue vertically.

`crh`{.sample}

:   Set amount to shift chroma-red horizontally.

`crv`{.sample}

:   Set amount to shift chroma-red vertically.

`edge`{.sample}

:   Set edge mode, can be `smear`{.variable}, default, or
    `warp`{.variable}.

[]{#Commands-65}

#### [39.25.1 Commands](#toc-Commands-65) {#commands-65 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#ciescope}

### [39.26 ciescope](#toc-ciescope) {#ciescope .section}

Display CIE color diagram with pixels overlaid onto it.

The filter accepts the following options:

`system`{.sample}

Set color system.

'`ntsc, 470m`{.sample}'

'`ebu, 470bg`{.sample}'

'`smpte`{.sample}'

'`240m`{.sample}'

'`apple`{.sample}'

'`widergb`{.sample}'

'`cie1931`{.sample}'

'`rec709, hdtv`{.sample}'

'`uhdtv, rec2020`{.sample}'

'`dcip3`{.sample}'

`cie`{.sample}

Set CIE system.

'`xyy`{.sample}'

'`ucs`{.sample}'

'`luv`{.sample}'

`gamuts`{.sample}

Set what gamuts to draw.

See `system` option for available values.

`size, s`{.sample}

Set ciescope size, by default set to 512.

`intensity, i`{.sample}

Set intensity used to map input pixel values to CIE diagram.

`contrast`{.sample}

Set contrast used to draw tongue colors that are out of active color
system gamut.

`corrgamma`{.sample}

Correct gamma displayed on scope, by default enabled.

`showwhite`{.sample}

Show white point on CIE diagram, by default disabled.

`gamma`{.sample}

Set input gamma. Used only with XYZ input color space.

`fill`{.sample}

Fill with CIE colors. By default is enabled.

[]{#codecview}

### [39.27 codecview](#toc-codecview) {#codecview .section}

Visualize information exported by some codecs.

Some codecs can export information through frames using side-data or
other means. For example, some MPEG based codecs export motion vectors
through the `export_mvs`{.variable} flag in the codec `flags2`{.sample}
option.

The filter accepts the following option:

`block`{.sample}

:   Display block partition structure using the luma plane.

`mv`{.sample}

:   Set motion vectors to visualize.

    Available flags for `mv`{.variable} are:

    '`pf`{.sample}'

    :   forward predicted MVs of P-frames

    '`bf`{.sample}'

    :   forward predicted MVs of B-frames

    '`bb`{.sample}'

    :   backward predicted MVs of B-frames

`qp`{.sample}

:   Display quantization parameters using the chroma planes.

`mv_type, mvt`{.sample}

:   Set motion vectors type to visualize. Includes MVs from all frames
    unless specified by `frame_type`{.variable} option.

    Available flags for `mv_type`{.variable} are:

    '`fp`{.sample}'

    :   forward predicted MVs

    '`bp`{.sample}'

    :   backward predicted MVs

`frame_type, ft`{.sample}

:   Set frame type to visualize motion vectors of.

    Available flags for `frame_type`{.variable} are:

    '`if`{.sample}'

    :   intra-coded frames (I-frames)

    '`pf`{.sample}'

    :   predicted frames (P-frames)

    '`bf`{.sample}'

    :   bi-directionally predicted frames (B-frames)

[]{#Examples-97}

#### [39.27.1 Examples](#toc-Examples-97) {#examples-97 .subsection}

- Visualize forward predicted MVs of all frames using `ffplay`:

  ::: example
  ``` example
  ffplay -flags2 +export_mvs input.mp4 -vf codecview=mv_type=fp
  ```
  :::
- Visualize multi-directionals MVs of P and B-Frames using `ffplay`:

  ::: example
  ``` example
  ffplay -flags2 +export_mvs input.mp4 -vf codecview=mv=pf+bf+bb
  ```
  :::

[]{#colorbalance}

### [39.28 colorbalance](#toc-colorbalance) {#colorbalance .section}

Modify intensity of primary colors (red, green and blue) of input
frames.

The filter allows an input frame to be adjusted in the shadows, midtones
or highlights regions for the red-cyan, green-magenta or blue-yellow
balance.

A positive adjustment value shifts the balance towards the primary
color, a negative value towards the complementary color.

The filter accepts the following options:

`rs`{.sample}\
`gs`{.sample}\
`bs`{.sample}

:   Adjust red, green and blue shadows (darkest pixels).

`rm`{.sample}\
`gm`{.sample}\
`bm`{.sample}

:   Adjust red, green and blue midtones (medium pixels).

`rh`{.sample}\
`gh`{.sample}\
`bh`{.sample}

:   Adjust red, green and blue highlights (brightest pixels).

    Allowed ranges for options are `[-1.0, 1.0]`. Defaults are `0`.

`pl`{.sample}

:   Preserve lightness when changing color balance. Default is disabled.

[]{#Examples-98}

#### [39.28.1 Examples](#toc-Examples-98) {#examples-98 .subsection}

- Add red color cast to shadows:

  ::: example
  ``` example
  colorbalance=rs=.3
  ```
  :::

[]{#Commands-66}

#### [39.28.2 Commands](#toc-Commands-66) {#commands-66 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#colorcontrast}

### [39.29 colorcontrast](#toc-colorcontrast) {#colorcontrast .section}

Adjust color contrast between RGB components.

The filter accepts the following options:

`rc`{.sample}

:   Set the red-cyan contrast. Defaults is 0.0. Allowed range is from
    -1.0 to 1.0.

`gm`{.sample}

:   Set the green-magenta contrast. Defaults is 0.0. Allowed range is
    from -1.0 to 1.0.

`by`{.sample}

:   Set the blue-yellow contrast. Defaults is 0.0. Allowed range is from
    -1.0 to 1.0.

`rcw`{.sample}\
`gmw`{.sample}\
`byw`{.sample}

:   Set the weight of each `rc`, `gm`, `by` option value. Default value
    is 0.0. Allowed range is from 0.0 to 1.0. If all weights are 0.0
    filtering is disabled.

`pl`{.sample}

:   Set the amount of preserving lightness. Default value is 0.0.
    Allowed range is from 0.0 to 1.0.

[]{#Commands-67}

#### [39.29.1 Commands](#toc-Commands-67) {#commands-67 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#colorcorrect}

### [39.30 colorcorrect](#toc-colorcorrect) {#colorcorrect .section}

Adjust color white balance selectively for blacks and whites. This
filter operates in YUV colorspace.

The filter accepts the following options:

`rl`{.sample}

Set the red shadow spot. Allowed range is from -1.0 to 1.0. Default
value is 0.

`bl`{.sample}

Set the blue shadow spot. Allowed range is from -1.0 to 1.0. Default
value is 0.

`rh`{.sample}

Set the red highlight spot. Allowed range is from -1.0 to 1.0. Default
value is 0.

`bh`{.sample}

Set the blue highlight spot. Allowed range is from -1.0 to 1.0. Default
value is 0.

`saturation`{.sample}

Set the amount of saturation. Allowed range is from -3.0 to 3.0. Default
value is 1.

`analyze`{.sample}

If set to anything other than `manual` it will analyze every frame and
use derived parameters for filtering output frame.

Possible values are:

'`manual`{.sample}'

'`average`{.sample}'

'`minmax`{.sample}'

'`median`{.sample}'

Default value is `manual`.

[]{#Commands-68}

#### [39.30.1 Commands](#toc-Commands-68) {#commands-68 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#colorchannelmixer}

### [39.31 colorchannelmixer](#toc-colorchannelmixer) {#colorchannelmixer .section}

Adjust video input frames by re-mixing color channels.

This filter modifies a color channel by adding the values associated to
the other channels of the same pixels. For example if the value to
modify is red, the output value will be:

::: example
``` example
red=red*rr + blue*rb + green*rg + alpha*ra
```
:::

The filter accepts the following options:

`rr`{.sample}\
`rg`{.sample}\
`rb`{.sample}\
`ra`{.sample}

:   Adjust contribution of input red, green, blue and alpha channels for
    output red channel. Default is `1` for `rr`{.variable}, and `0` for
    `rg`{.variable}, `rb`{.variable} and `ra`{.variable}.

`gr`{.sample}\
`gg`{.sample}\
`gb`{.sample}\
`ga`{.sample}

:   Adjust contribution of input red, green, blue and alpha channels for
    output green channel. Default is `1` for `gg`{.variable}, and `0`
    for `gr`{.variable}, `gb`{.variable} and `ga`{.variable}.

`br`{.sample}\
`bg`{.sample}\
`bb`{.sample}\
`ba`{.sample}

:   Adjust contribution of input red, green, blue and alpha channels for
    output blue channel. Default is `1` for `bb`{.variable}, and `0` for
    `br`{.variable}, `bg`{.variable} and `ba`{.variable}.

`ar`{.sample}\
`ag`{.sample}\
`ab`{.sample}\
`aa`{.sample}

:   Adjust contribution of input red, green, blue and alpha channels for
    output alpha channel. Default is `1` for `aa`{.variable}, and `0`
    for `ar`{.variable}, `ag`{.variable} and `ab`{.variable}.

    Allowed ranges for options are `[-2.0, 2.0]`.

`pc`{.sample}

:   Set preserve color mode. The accepted values are:

    '`none`{.sample}'

    :   Disable color preserving, this is default.

    '`lum`{.sample}'

    :   Preserve luminance.

    '`max`{.sample}'

    :   Preserve max value of RGB triplet.

    '`avg`{.sample}'

    :   Preserve average value of RGB triplet.

    '`sum`{.sample}'

    :   Preserve sum value of RGB triplet.

    '`nrm`{.sample}'

    :   Preserve normalized value of RGB triplet.

    '`pwr`{.sample}'

    :   Preserve power value of RGB triplet.

`pa`{.sample}

:   Set the preserve color amount when changing colors. Allowed range is
    from `[0.0, 1.0]`. Default is `0.0`, thus disabled.

[]{#Examples-99}

#### [39.31.1 Examples](#toc-Examples-99) {#examples-99 .subsection}

- Convert source to grayscale:

  ::: example
  ``` example
  colorchannelmixer=.3:.4:.3:0:.3:.4:.3:0:.3:.4:.3
  ```
  :::
- Simulate sepia tones:

  ::: example
  ``` example
  colorchannelmixer=.393:.769:.189:0:.349:.686:.168:0:.272:.534:.131
  ```
  :::

[]{#Commands-69}

#### [39.31.2 Commands](#toc-Commands-69) {#commands-69 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#colordetect}

### [39.32 colordetect](#toc-colordetect) {#colordetect .section}

Analyze the video frames to determine the effective value range and
alpha mode.

The filter accepts the following options:

`mode`{.sample}

:   Set of properties to detect. Unavailable properties, such as alpha
    mode for an input image without an alpha channel, will be ignored
    automatically.

    Accepts a combination of the following flags:

    '`color_range`{.sample}'

    :   Detect if the source contains luma pixels outside the limited
        (MPEG) range, which indicates that this is a full range YUV
        source.

    '`alpha_mode`{.sample}'

    :   Detect if the source contains color values above the alpha
        channel, which indicates that the alpha channel is independent
        (straight), rather than premultiplied. Also detects if the alpha
        plane is fully opaque or not.

    '`all`{.sample}'

    :   Enable detection of all of the above properties. This is the
        default.

[]{#colorize}

### [39.33 colorize](#toc-colorize) {#colorize .section}

Overlay a solid color on the video stream.

The filter accepts the following options:

`hue`{.sample}

:   Set the color hue. Allowed range is from 0 to 360. Default value is
    0.

`saturation`{.sample}

:   Set the color saturation. Allowed range is from 0 to 1. Default
    value is 0.5.

`lightness`{.sample}

:   Set the color lightness. Allowed range is from 0 to 1. Default value
    is 0.5.

`mix`{.sample}

:   Set the mix of source lightness. By default is set to 1.0. Allowed
    range is from 0.0 to 1.0.

[]{#Commands-70}

#### [39.33.1 Commands](#toc-Commands-70) {#commands-70 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#colorkey}

### [39.34 colorkey](#toc-colorkey) {#colorkey .section}

RGB colorspace color keying. This filter operates on 8-bit RGB format
frames by setting the alpha component of each pixel which falls within
the similarity radius of the key color to 0. The alpha value for pixels
outside the similarity radius depends on the value of the blend option.

The filter accepts the following options:

`color`{.sample}

:   Set the color for which alpha will be set to 0 (full transparency).
    See [(ffmpeg-utils)\"Color\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#color-syntax). Default is `black`.

`similarity`{.sample}

:   Set the radius from the key color within which other colors also
    have full transparency. The computed distance is related to the unit
    fractional distance in 3D space between the RGB values of the key
    color and the pixel's color. Range is 0.01 to 1.0. 0.01 matches
    within a very small radius around the exact key color, while 1.0
    matches everything. Default is `0.01`.

`blend`{.sample}

:   Set how the alpha value for pixels that fall outside the similarity
    radius is computed. 0.0 makes pixels either fully transparent or
    fully opaque. Higher values result in semi-transparent pixels, with
    greater transparency the more similar the pixel color is to the key
    color. Range is 0.0 to 1.0. Default is `0.0`.

[]{#Examples-100}

#### [39.34.1 Examples](#toc-Examples-100) {#examples-100 .subsection}

- Make every green pixel in the input image transparent:

  ::: example
  ``` example
  ffmpeg -i input.png -vf colorkey=green out.png
  ```
  :::
- Overlay a greenscreen-video on top of a static background image.

  ::: example
  ``` example
  ffmpeg -i background.png -i video.mp4 -filter_complex "[1:v]colorkey=0x3BBD1E:0.3:0.2[ckout];[0:v][ckout]overlay[out]" -map "[out]" output.flv
  ```
  :::

[]{#Commands-71}

#### [39.34.2 Commands](#toc-Commands-71) {#commands-71 .subsection}

This filter supports same [commands](#commands) as options. The command
accepts the same syntax of the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#colorhold}

### [39.35 colorhold](#toc-colorhold) {#colorhold .section}

Remove all color information for all RGB colors except for certain one.

The filter accepts the following options:

`color`{.sample}

:   The color which will not be replaced with neutral gray.

`similarity`{.sample}

:   Similarity percentage with the above color. 0.01 matches only the
    exact key color, while 1.0 matches everything.

`blend`{.sample}

:   Blend percentage. 0.0 makes pixels fully gray. Higher values result
    in more preserved color.

[]{#Commands-72}

#### [39.35.1 Commands](#toc-Commands-72) {#commands-72 .subsection}

This filter supports same [commands](#commands) as options. The command
accepts the same syntax of the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#colorlevels}

### [39.36 colorlevels](#toc-colorlevels) {#colorlevels .section}

Adjust video input frames using levels.

The filter accepts the following options:

`rimin`{.sample}\
`gimin`{.sample}\
`bimin`{.sample}\
`aimin`{.sample}

:   Adjust red, green, blue and alpha input black point. Allowed ranges
    for options are `[-1.0, 1.0]`. Defaults are `0`.

`rimax`{.sample}\
`gimax`{.sample}\
`bimax`{.sample}\
`aimax`{.sample}

:   Adjust red, green, blue and alpha input white point. Allowed ranges
    for options are `[-1.0, 1.0]`. Defaults are `1`.

    Input levels are used to lighten highlights (bright tones), darken
    shadows (dark tones), change the balance of bright and dark tones.

`romin`{.sample}\
`gomin`{.sample}\
`bomin`{.sample}\
`aomin`{.sample}

:   Adjust red, green, blue and alpha output black point. Allowed ranges
    for options are `[0, 1.0]`. Defaults are `0`.

`romax`{.sample}\
`gomax`{.sample}\
`bomax`{.sample}\
`aomax`{.sample}

:   Adjust red, green, blue and alpha output white point. Allowed ranges
    for options are `[0, 1.0]`. Defaults are `1`.

    Output levels allows manual selection of a constrained output level
    range.

`preserve`{.sample}

:   Set preserve color mode. The accepted values are:

    '`none`{.sample}'

    :   Disable color preserving, this is default.

    '`lum`{.sample}'

    :   Preserve luminance.

    '`max`{.sample}'

    :   Preserve max value of RGB triplet.

    '`avg`{.sample}'

    :   Preserve average value of RGB triplet.

    '`sum`{.sample}'

    :   Preserve sum value of RGB triplet.

    '`nrm`{.sample}'

    :   Preserve normalized value of RGB triplet.

    '`pwr`{.sample}'

    :   Preserve power value of RGB triplet.

[]{#Examples-101}

#### [39.36.1 Examples](#toc-Examples-101) {#examples-101 .subsection}

- Make video output darker:

  ::: example
  ``` example
  colorlevels=rimin=0.058:gimin=0.058:bimin=0.058
  ```
  :::
- Increase contrast:

  ::: example
  ``` example
  colorlevels=rimin=0.039:gimin=0.039:bimin=0.039:rimax=0.96:gimax=0.96:bimax=0.96
  ```
  :::
- Make video output lighter:

  ::: example
  ``` example
  colorlevels=rimax=0.902:gimax=0.902:bimax=0.902
  ```
  :::
- Increase brightness:

  ::: example
  ``` example
  colorlevels=romin=0.5:gomin=0.5:bomin=0.5
  ```
  :::

[]{#Commands-73}

#### [39.36.2 Commands](#toc-Commands-73) {#commands-73 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#colormap}

### [39.37 colormap](#toc-colormap) {#colormap .section}

Apply custom color maps to video stream.

This filter needs three input video streams. First stream is video
stream that is going to be filtered out. Second and third video stream
specify color patches for source color to target color mapping.

The filter accepts the following options:

`patch_size`{.sample}

Set the source and target video stream patch size in pixels.

`nb_patches`{.sample}

Set the max number of used patches from source and target video stream.
Default value is number of patches available in additional video
streams. Max allowed number of patches is `64`.

`type`{.sample}

Set the adjustments used for target colors. Can be `relative` or
`absolute`. Defaults is `absolute`.

`kernel`{.sample}

Set the kernel used to measure color differences between mapped colors.

The accepted values are:

'`euclidean`{.sample}'

'`weuclidean`{.sample}'

Default is `euclidean`.

[]{#colormatrix}

### [39.38 colormatrix](#toc-colormatrix) {#colormatrix .section}

Convert color matrix.

The filter accepts the following options:

`src`{.sample}\
`dst`{.sample}

:   Specify the source and destination color matrix. Both values must be
    specified.

    The accepted values are:

    '`bt709`{.sample}'

    :   BT.709

    '`fcc`{.sample}'

    :   FCC

    '`bt601`{.sample}'

    :   BT.601

    '`bt470`{.sample}'

    :   BT.470

    '`bt470bg`{.sample}'

    :   BT.470BG

    '`smpte170m`{.sample}'

    :   SMPTE-170M

    '`smpte240m`{.sample}'

    :   SMPTE-240M

    '`bt2020`{.sample}'

    :   BT.2020

For example to convert from BT.601 to SMPTE-240M, use the command:

::: example
``` example
colormatrix=bt601:smpte240m
```
:::

[]{#colorspace}

### [39.39 colorspace](#toc-colorspace) {#colorspace .section}

Convert colorspace, transfer characteristics or color primaries. Input
video needs to have an even size.

The filter accepts the following options:

[]{#all}

`all`{.sample}

Specify all color properties at once.

The accepted values are:

'`bt470m`{.sample}'

:   BT.470M

'`bt470bg`{.sample}'

:   BT.470BG

'`bt601-6-525`{.sample}'

:   BT.601-6 525

'`bt601-6-625`{.sample}'

:   BT.601-6 625

'`bt709`{.sample}'

:   BT.709

'`smpte170m`{.sample}'

:   SMPTE-170M

'`smpte240m`{.sample}'

:   SMPTE-240M

'`bt2020`{.sample}'

:   BT.2020

[]{#space}

`space`{.sample}

Specify output colorspace.

The accepted values are:

'`bt709`{.sample}'

:   BT.709

'`fcc`{.sample}'

:   FCC

'`bt470bg`{.sample}'

:   BT.470BG or BT.601-6 625

'`smpte170m`{.sample}'

:   SMPTE-170M or BT.601-6 525

'`smpte240m`{.sample}'

:   SMPTE-240M

'`ycgco`{.sample}'

:   YCgCo

'`bt2020ncl`{.sample}'

:   BT.2020 with non-constant luminance

[]{#trc}

`trc`{.sample}

Specify output transfer characteristics.

The accepted values are:

'`bt709`{.sample}'

:   BT.709

'`bt470m`{.sample}'

:   BT.470M

'`bt470bg`{.sample}'

:   BT.470BG

'`gamma22`{.sample}'

:   Constant gamma of 2.2

'`gamma28`{.sample}'

:   Constant gamma of 2.8

'`smpte170m`{.sample}'

:   SMPTE-170M, BT.601-6 625 or BT.601-6 525

'`smpte240m`{.sample}'

:   SMPTE-240M

'`srgb`{.sample}'

:   SRGB

'`iec61966-2-1`{.sample}'

:   iec61966-2-1

'`iec61966-2-4`{.sample}'

:   iec61966-2-4

'`xvycc`{.sample}'

:   xvycc

'`bt2020-10`{.sample}'

:   BT.2020 for 10-bits content

'`bt2020-12`{.sample}'

:   BT.2020 for 12-bits content

[]{#primaries}

`primaries`{.sample}

Specify output color primaries.

The accepted values are:

'`bt709`{.sample}'

:   BT.709

'`bt470m`{.sample}'

:   BT.470M

'`bt470bg`{.sample}'

:   BT.470BG or BT.601-6 625

'`smpte170m`{.sample}'

:   SMPTE-170M or BT.601-6 525

'`smpte240m`{.sample}'

:   SMPTE-240M

'`film`{.sample}'

:   film

'`smpte431`{.sample}'

:   SMPTE-431

'`smpte432`{.sample}'

:   SMPTE-432

'`bt2020`{.sample}'

:   BT.2020

'`jedec-p22`{.sample}'

:   JEDEC P22 phosphors

[]{#range}

`range`{.sample}

Specify output color range.

The accepted values are:

'`tv`{.sample}'

:   TV (restricted) range

'`mpeg`{.sample}'

:   MPEG (restricted) range

'`pc`{.sample}'

:   PC (full) range

'`jpeg`{.sample}'

:   JPEG (full) range

`format`{.sample}

Specify output color format.

The accepted values are:

'`yuv420p`{.sample}'

:   YUV 4:2:0 planar 8-bits

'`yuv420p10`{.sample}'

:   YUV 4:2:0 planar 10-bits

'`yuv420p12`{.sample}'

:   YUV 4:2:0 planar 12-bits

'`yuv422p`{.sample}'

:   YUV 4:2:2 planar 8-bits

'`yuv422p10`{.sample}'

:   YUV 4:2:2 planar 10-bits

'`yuv422p12`{.sample}'

:   YUV 4:2:2 planar 12-bits

'`yuv444p`{.sample}'

:   YUV 4:4:4 planar 8-bits

'`yuv444p10`{.sample}'

:   YUV 4:4:4 planar 10-bits

'`yuv444p12`{.sample}'

:   YUV 4:4:4 planar 12-bits

`fast`{.sample}

Do a fast conversion, which skips gamma/primary correction. This will
take significantly less CPU, but will be mathematically incorrect. To
get output compatible with that produced by the colormatrix filter, use
fast=1.

`dither`{.sample}

Specify dithering mode.

The accepted values are:

'`none`{.sample}'

:   No dithering

'`fsb`{.sample}'

:   Floyd-Steinberg dithering

`wpadapt`{.sample}

Whitepoint adaptation mode.

The accepted values are:

'`bradford`{.sample}'

:   Bradford whitepoint adaptation

'`vonkries`{.sample}'

:   von Kries whitepoint adaptation

'`identity`{.sample}'

:   identity whitepoint adaptation (i.e. no whitepoint adaptation)

`clipgamut`{.sample}

Controls how to clip out-of-gamut colors that arise as a result of
colorspace conversion.

The accepted values are:

'`none`{.sample}'

:   No clipping of out of gamut colors.

'`rgb`{.sample}'

:   Clips the RGB values to the \[0, 1\] range when building the gamma
    transfer LUTs.

`iall`{.sample}

Override all input properties at once. Same accepted values as
[all](#all).

`ispace`{.sample}

Override input colorspace. Same accepted values as [space](#space).

`iprimaries`{.sample}

Override input color primaries. Same accepted values as
[primaries](#primaries).

`itrc`{.sample}

Override input transfer characteristics. Same accepted values as
[trc](#trc).

`irange`{.sample}

Override input color range. Same accepted values as [range](#range).

The filter converts the transfer characteristics, color space and color
primaries to the specified user values. The output value, if not
specified, is set to a default value based on the \"all\" property. If
that property is also not specified, the filter will log an error. The
output color range and format default to the same value as the input
color range and format. The input transfer characteristics, color space,
color primaries and color range should be set on the input data. If any
of these are missing, the filter will log an error and no conversion
will take place.

For example to convert the input to SMPTE-240M, use the command:

::: example
``` example
colorspace=smpte240m
```
:::

[]{#colortemperature}

### [39.40 colortemperature](#toc-colortemperature) {#colortemperature .section}

Adjust color temperature in video to simulate variations in ambient
color temperature.

The filter accepts the following options:

`temperature`{.sample}

:   Set the temperature in Kelvin. Allowed range is from 1000 to 40000.
    Default value is 6500 K.

`mix`{.sample}

:   Set mixing with filtered output. Allowed range is from 0 to 1.
    Default value is 1.

`pl`{.sample}

:   Set the amount of preserving lightness. Allowed range is from 0
    to 1. Default value is 0.

[]{#Commands-74}

#### [39.40.1 Commands](#toc-Commands-74) {#commands-74 .subsection}

This filter supports same [commands](#commands) as options.

[]{#convolution}

### [39.41 convolution](#toc-convolution) {#convolution .section}

Apply convolution of 3x3, 5x5, 7x7 or horizontal/vertical up to 49
elements.

The filter accepts the following options:

`0m`{.sample}\
`1m`{.sample}\
`2m`{.sample}\
`3m`{.sample}

:   Set matrix for each plane. Matrix is sequence of 9, 25 or 49 signed
    integers in `square`{.variable} mode, and from 1 to 49 odd number of
    signed integers in `row`{.variable} mode.

`0rdiv`{.sample}\
`1rdiv`{.sample}\
`2rdiv`{.sample}\
`3rdiv`{.sample}

:   Set multiplier for calculated value for each plane. If unset or 0,
    it will be 1/sum of all matrix elements.

`0bias`{.sample}\
`1bias`{.sample}\
`2bias`{.sample}\
`3bias`{.sample}

:   Set bias for each plane. This value is added to the result of the
    multiplication. Useful for making the overall image brighter or
    darker. Default is 0.0.

`0mode`{.sample}\
`1mode`{.sample}\
`2mode`{.sample}\
`3mode`{.sample}

:   Set matrix mode for each plane. Can be `square`{.variable},
    `row`{.variable} or `column`{.variable}. Default is
    `square`{.variable}.

[]{#Commands-75}

#### [39.41.1 Commands](#toc-Commands-75) {#commands-75 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#Examples-102}

#### [39.41.2 Examples](#toc-Examples-102) {#examples-102 .subsection}

- Apply sharpen:

  ::: example
  ``` example
  convolution="0 -1 0 -1 5 -1 0 -1 0:0 -1 0 -1 5 -1 0 -1 0:0 -1 0 -1 5 -1 0 -1 0:0 -1 0 -1 5 -1 0 -1 0"
  ```
  :::
- Apply blur:

  ::: example
  ``` example
  convolution="1 1 1 1 1 1 1 1 1:1 1 1 1 1 1 1 1 1:1 1 1 1 1 1 1 1 1:1 1 1 1 1 1 1 1 1:1/9:1/9:1/9:1/9"
  ```
  :::
- Apply edge enhance:

  ::: example
  ``` example
  convolution="0 0 0 -1 1 0 0 0 0:0 0 0 -1 1 0 0 0 0:0 0 0 -1 1 0 0 0 0:0 0 0 -1 1 0 0 0 0:5:1:1:1:0:128:128:128"
  ```
  :::
- Apply edge detect:

  ::: example
  ``` example
  convolution="0 1 0 1 -4 1 0 1 0:0 1 0 1 -4 1 0 1 0:0 1 0 1 -4 1 0 1 0:0 1 0 1 -4 1 0 1 0:5:5:5:1:0:128:128:128"
  ```
  :::
- Apply laplacian edge detector which includes diagonals:

  ::: example
  ``` example
  convolution="1 1 1 1 -8 1 1 1 1:1 1 1 1 -8 1 1 1 1:1 1 1 1 -8 1 1 1 1:1 1 1 1 -8 1 1 1 1:5:5:5:1:0:128:128:0"
  ```
  :::
- Apply emboss:

  ::: example
  ``` example
  convolution="-2 -1 0 -1 1 1 0 1 2:-2 -1 0 -1 1 1 0 1 2:-2 -1 0 -1 1 1 0 1 2:-2 -1 0 -1 1 1 0 1 2"
  ```
  :::

[]{#convolve}

### [39.42 convolve](#toc-convolve) {#convolve .section}

Apply 2D convolution of video stream in frequency domain using second
stream as impulse.

The filter accepts the following options:

`planes`{.sample}

:   Set which planes to process.

`impulse`{.sample}

:   Set which impulse video frames will be processed, can be
    `first`{.variable} or `all`{.variable}. Default is `all`{.variable}.

The `convolve` filter also supports the [framesync](#framesync) options.

[]{#copy}

### [39.43 copy](#toc-copy) {#copy .section}

Copy the input video source unchanged to the output. This is mainly
useful for testing purposes.

[]{#coreimage}[]{#coreimage-1}

### [39.44 coreimage](#toc-coreimage-1) {#coreimage .section}

Video filtering on GPU using Apple's CoreImage API on OSX.

Hardware acceleration is based on an OpenGL context. Usually, this means
it is processed by video hardware. However, software-based OpenGL
implementations exist which means there is no guarantee for hardware
processing. It depends on the respective OSX.

There are many filters and image generators provided by Apple that come
with a large variety of options. The filter has to be referenced by its
name along with its options.

The coreimage filter accepts the following options:

`list_filters`{.sample}

:   List all available filters and generators along with all their
    respective options as well as possible minimum and maximum values
    along with the default values.

    ::: example
    ``` example
    list_filters=true
    ```
    :::

`filter`{.sample}

:   Specify all filters by their respective name and options. Use
    `list_filters`{.variable} to determine all valid filter names and
    options. Numerical options are specified by a float value and are
    automatically clamped to their respective value range. Vector and
    color options have to be specified by a list of space separated
    float values. Character escaping has to be done. A special option
    name `default` is available to use default options for a filter.

    It is required to specify either `default` or at least one of the
    filter options. All omitted options are used with their default
    values. The syntax of the filter string is as follows:

    ::: example
    ``` example
    filter=<NAME>@<OPTION>=<VALUE>[@<OPTION>=<VALUE>][@...][#<NAME>@<OPTION>=<VALUE>[@<OPTION>=<VALUE>][@...]][#...]
    ```
    :::

`output_rect`{.sample}

:   Specify a rectangle where the output of the filter chain is copied
    into the input image. It is given by a list of space separated float
    values:

    ::: example
    ``` example
    output_rect=x\ y\ width\ height
    ```
    :::

    If not given, the output rectangle equals the dimensions of the
    input image. The output rectangle is automatically cropped at the
    borders of the input image. Negative values are valid for each
    component.

    ::: example
    ``` example
    output_rect=25\ 25\ 100\ 100
    ```
    :::

Several filters can be chained for successive processing without
GPU-HOST transfers allowing for fast processing of complex filter
chains. Currently, only filters with zero (generators) or exactly one
(filters) input image and one output image are supported. Also,
transition filters are not yet usable as intended.

Some filters generate output images with additional padding depending on
the respective filter kernel. The padding is automatically removed to
ensure the filter output has the same size as the input image.

For image generators, the size of the output image is determined by the
previous output image of the filter chain or the input image of the
whole filterchain, respectively. The generators do not use the pixel
information of this image to generate their output. However, the
generated output is blended onto this image, resulting in partial or
complete coverage of the output image.

The [coreimagesrc](#coreimagesrc) video source can be used for
generating input images which are directly fed into the filter chain. By
using it, providing input images by another video source or an input
video is not required.

[]{#Examples-103}

#### [39.44.1 Examples](#toc-Examples-103) {#examples-103 .subsection}

- List all filters available:

  ::: example
  ``` example
  coreimage=list_filters=true
  ```
  :::
- Use the CIBoxBlur filter with default options to blur an image:

  ::: example
  ``` example
  coreimage=filter=CIBoxBlur@default
  ```
  :::
- Use a filter chain with CISepiaTone at default values and
  CIVignetteEffect with its center at 100x100 and a radius of 50 pixels:

  ::: example
  ``` example
  coreimage=filter=CIBoxBlur@default#CIVignetteEffect@inputCenter=100\ 100@inputRadius=50
  ```
  :::
- Use nullsrc and CIQRCodeGenerator to create a QR code for the FFmpeg
  homepage, given as complete and escaped command-line for Apple's
  standard bash shell:

  ::: example
  ``` example
  ffmpeg -f lavfi -i nullsrc=s=100x100,coreimage=filter=CIQRCodeGenerator@inputMessage=https\\\\\://FFmpeg.org/@inputCorrectionLevel=H -frames:v 1 QRCode.png
  ```
  :::

[]{#corr}

### [39.45 corr](#toc-corr) {#corr .section}

Obtain the correlation between two input videos.

This filter takes two input videos.

Both input videos must have the same resolution and pixel format for
this filter to work correctly. Also it assumes that both inputs have the
same number of frames, which are compared one by one.

The obtained per component, average, min and max correlation is printed
through the logging system.

The filter stores the calculated correlation of each frame in frame
metadata.

This filter also supports the [framesync](#framesync) options.

In the below example the input file `main.mpg`{.sample} being processed
is compared with the reference file `ref.mpg`{.sample}.

::: example
``` example
ffmpeg -i main.mpg -i ref.mpg -lavfi corr -f null -
```
:::

[]{#cover_005frect}

### [39.46 cover_rect](#toc-cover_005frect) {#cover_rect .section}

Cover a rectangular object

It accepts the following options:

`cover`{.sample}

:   Filepath of the optional cover image, needs to be in yuv420.

`mode`{.sample}

:   Set covering mode.

    It accepts the following values:

    '`cover`{.sample}'

    :   cover it by the supplied image

    '`blur`{.sample}'

    :   cover it by interpolating the surrounding pixels

    Default value is `blur`{.variable}.

[]{#Examples-104}

#### [39.46.1 Examples](#toc-Examples-104) {#examples-104 .subsection}

- Cover a rectangular object by the supplied image of a given video
  using `ffmpeg`:

  ::: example
  ``` example
  ffmpeg -i file.ts -vf find_rect=newref.pgm,cover_rect=cover.jpg:mode=cover new.mkv
  ```
  :::

[]{#crop}

### [39.47 crop](#toc-crop) {#crop .section}

Crop the input video to given dimensions.

It accepts the following parameters:

`w, out_w`{.sample}

:   The width of the output video. It defaults to `iw`. This expression
    is evaluated only once during the filter configuration, or when the
    '`w`{.sample}' or '`out_w`{.sample}' command is sent.

`h, out_h`{.sample}

:   The height of the output video. It defaults to `ih`. This expression
    is evaluated only once during the filter configuration, or when the
    '`h`{.sample}' or '`out_h`{.sample}' command is sent.

`x`{.sample}

:   The horizontal position, in the input video, of the left edge of the
    output video. It defaults to `(in_w-out_w)/2`. This expression is
    evaluated per-frame.

`y`{.sample}

:   The vertical position, in the input video, of the top edge of the
    output video. It defaults to `(in_h-out_h)/2`. This expression is
    evaluated per-frame.

`keep_aspect`{.sample}

:   If set to 1 will force the output display aspect ratio to be the
    same of the input, by changing the output sample aspect ratio. It
    defaults to 0.

`exact`{.sample}

:   Enable exact cropping. If enabled, subsampled videos will be cropped
    at exact width/height/x/y as specified and will not be rounded to
    nearest smaller value. It defaults to 0.

The `out_w`{.variable}, `out_h`{.variable}, `x`{.variable},
`y`{.variable} parameters are expressions containing the following
constants:

`x`{.sample}\
`y`{.sample}

:   The computed values for `x`{.variable} and `y`{.variable}. They are
    evaluated for each new frame.

`in_w`{.sample}\
`in_h`{.sample}

:   The input width and height.

`iw`{.sample}\
`ih`{.sample}

:   These are the same as `in_w`{.variable} and `in_h`{.variable}.

`out_w`{.sample}\
`out_h`{.sample}

:   The output (cropped) width and height.

`ow`{.sample}\
`oh`{.sample}

:   These are the same as `out_w`{.variable} and `out_h`{.variable}.

`a`{.sample}

:   same as `iw`{.variable} / `ih`{.variable}

`sar`{.sample}

:   input sample aspect ratio

`dar`{.sample}

:   input display aspect ratio, it is the same as (`iw`{.variable} /
    `ih`{.variable}) \* `sar`{.variable}

`hsub`{.sample}\
`vsub`{.sample}

:   horizontal and vertical chroma subsample values. For example for the
    pixel format \"yuv422p\" `hsub`{.variable} is 2 and
    `vsub`{.variable} is 1.

`n`{.sample}

:   The number of the input frame, starting from 0.

`pos`{.sample}

:   the position in the file of the input frame, NAN if unknown;
    deprecated, do not use

`t`{.sample}

:   The timestamp expressed in seconds. It's NAN if the input timestamp
    is unknown.

The expression for `out_w`{.variable} may depend on the value of
`out_h`{.variable}, and the expression for `out_h`{.variable} may depend
on `out_w`{.variable}, but they cannot depend on `x`{.variable} and
`y`{.variable}, as `x`{.variable} and `y`{.variable} are evaluated after
`out_w`{.variable} and `out_h`{.variable}.

The `x`{.variable} and `y`{.variable} parameters specify the expressions
for the position of the top-left corner of the output (non-cropped)
area. They are evaluated for each frame. If the evaluated value is not
valid, it is approximated to the nearest valid value.

The expression for `x`{.variable} may depend on `y`{.variable}, and the
expression for `y`{.variable} may depend on `x`{.variable}.

[]{#Examples-105}

#### [39.47.1 Examples](#toc-Examples-105) {#examples-105 .subsection}

- Crop area with size 100x100 at position (12,34).

  ::: example
  ``` example
  crop=100:100:12:34
  ```
  :::

  Using named options, the example above becomes:

  ::: example
  ``` example
  crop=w=100:h=100:x=12:y=34
  ```
  :::

- Crop the central input area with size 100x100:

  ::: example
  ``` example
  crop=100:100
  ```
  :::

- Crop the central input area with size 2/3 of the input video:

  ::: example
  ``` example
  crop=2/3*in_w:2/3*in_h
  ```
  :::

- Crop the input video central square:

  ::: example
  ``` example
  crop=out_w=in_h
  crop=in_h
  ```
  :::

- Delimit the rectangle with the top-left corner placed at position
  100:100 and the right-bottom corner corresponding to the right-bottom
  corner of the input image.

  ::: example
  ``` example
  crop=in_w-100:in_h-100:100:100
  ```
  :::

- Crop 10 pixels from the left and right borders, and 20 pixels from the
  top and bottom borders

  ::: example
  ``` example
  crop=in_w-2*10:in_h-2*20
  ```
  :::

- Keep only the bottom right quarter of the input image:

  ::: example
  ``` example
  crop=in_w/2:in_h/2:in_w/2:in_h/2
  ```
  :::

- Crop height for getting Greek harmony:

  ::: example
  ``` example
  crop=in_w:1/PHI*in_w
  ```
  :::

- Apply trembling effect:

  ::: example
  ``` example
  crop=in_w/2:in_h/2:(in_w-out_w)/2+((in_w-out_w)/2)*sin(n/10):(in_h-out_h)/2 +((in_h-out_h)/2)*sin(n/7)
  ```
  :::

- Apply erratic camera effect depending on timestamp:

  ::: example
  ``` example
  crop=in_w/2:in_h/2:(in_w-out_w)/2+((in_w-out_w)/2)*sin(t*10):(in_h-out_h)/2 +((in_h-out_h)/2)*sin(t*13)
  ```
  :::

- Set x depending on the value of y:

  ::: example
  ``` example
  crop=in_w/2:in_h/2:y:10+10*sin(n/10)
  ```
  :::

[]{#Commands-76}

#### [39.47.2 Commands](#toc-Commands-76) {#commands-76 .subsection}

This filter supports the following commands:

`w, out_w`{.sample}\
`h, out_h`{.sample}\
`x`{.sample}\
`y`{.sample}

:   Set width/height of the output video and the horizontal/vertical
    position in the input video. The command accepts the same syntax of
    the corresponding option.

    If the specified expression is not valid, it is kept at its current
    value.

[]{#cropdetect}

### [39.48 cropdetect](#toc-cropdetect) {#cropdetect .section}

Auto-detect the crop size.

It calculates the necessary cropping parameters and prints the
recommended parameters via the logging system. The detected dimensions
correspond to the non-black or video area of the input video according
to `mode`{.variable}.

It accepts the following parameters:

`mode`{.sample}

:   Depending on `mode`{.variable} crop detection is based on either the
    mere black value of surrounding pixels or a combination of motion
    vectors and edge pixels.

    '`black`{.sample}'

    :   Detect black pixels surrounding the playing video. For fine
        control use option `limit`{.variable}.

    '`mvedges`{.sample}'

    :   Detect the playing video by the motion vectors inside the video
        and scanning for edge pixels typically forming the border of a
        playing video.

`limit`{.sample}

:   Set higher black value threshold, which can be optionally specified
    from nothing (0) to everything (255 for 8-bit based formats). An
    intensity value greater to the set value is considered non-black. It
    defaults to 24. You can also specify a value between 0.0 and 1.0
    which will be scaled depending on the bitdepth of the pixel format.

`round`{.sample}

:   The value which the width/height should be divisible by. It defaults
    to 16. The offset is automatically adjusted to center the video. Use
    2 to get only even dimensions (needed for 4:2:2 video). 16 is best
    when encoding to most video codecs.

`skip`{.sample}

:   Set the number of initial frames for which evaluation is skipped.
    Default is 2. Range is 0 to INT_MAX.

`reset_count, reset`{.sample}

:   Set the counter that determines after how many frames cropdetect
    will reset the previously detected largest video area and start over
    to detect the current optimal crop area. Default value is 0.

    This can be useful when channel logos distort the video area. 0
    indicates 'never reset', and returns the largest area encountered
    during playback.

`mv_threshold`{.sample}

:   Set motion in pixel units as threshold for motion detection. It
    defaults to 8.

`low`{.sample}\
`high`{.sample}

:   Set low and high threshold values used by the Canny thresholding
    algorithm.

    The high threshold selects the \"strong\" edge pixels, which are
    then connected through 8-connectivity with the \"weak\" edge pixels
    selected by the low threshold.

    `low`{.variable} and `high`{.variable} threshold values must be
    chosen in the range \[0,1\], and `low`{.variable} should be lesser
    or equal to `high`{.variable}.

    Default value for `low`{.variable} is `5/255`, and default value for
    `high`{.variable} is `15/255`.

[]{#Examples-106}

#### [39.48.1 Examples](#toc-Examples-106) {#examples-106 .subsection}

- Find video area surrounded by black borders:

  ::: example
  ``` example
  ffmpeg -i file.mp4 -vf cropdetect,metadata=mode=print -f null -
  ```
  :::
- Find an embedded video area, generate motion vectors beforehand:

  ::: example
  ``` example
  ffmpeg -i file.mp4 -vf mestimate,cropdetect=mode=mvedges,metadata=mode=print -f null -
  ```
  :::
- Find an embedded video area, use motion vectors from decoder:

  ::: example
  ``` example
  ffmpeg -flags2 +export_mvs -i file.mp4 -vf cropdetect=mode=mvedges,metadata=mode=print -f null -
  ```
  :::

[]{#Commands-77}

#### [39.48.2 Commands](#toc-Commands-77) {#commands-77 .subsection}

This filter supports the following commands:

`limit`{.sample}

:   The command accepts the same syntax of the corresponding option. If
    the specified expression is not valid, it is kept at its current
    value.

[]{#cue}[]{#cue-1}

### [39.49 cue](#toc-cue-1) {#cue .section}

Delay video filtering until a given wallclock timestamp. The filter
first passes on `preroll`{.sample} amount of frames, then it buffers at
most `buffer`{.sample} amount of frames and waits for the cue. After
reaching the cue it forwards the buffered frames and also any subsequent
frames coming in its input.

The filter can be used synchronize the output of multiple ffmpeg
processes for realtime output devices like decklink. By putting the
delay in the filtering chain and pre-buffering frames the process can
pass on data to output almost immediately after the target wallclock
timestamp is reached.

Perfect frame accuracy cannot be guaranteed, but the result is good
enough for some use cases.

`cue`{.sample}

:   The cue timestamp expressed in a UNIX timestamp in microseconds.
    Default is 0.

`preroll`{.sample}

:   The duration of content to pass on as preroll expressed in seconds.
    Default is 0.

`buffer`{.sample}

:   The maximum duration of content to buffer before waiting for the cue
    expressed in seconds. Default is 0.

[]{#curves}[]{#curves-1}

### [39.50 curves](#toc-curves-1) {#curves .section}

Apply color adjustments using curves.

This filter is similar to the Adobe Photoshop and GIMP curves tools.
Each component (red, green and blue) has its values defined by
`N`{.variable} key points tied from each other using a smooth curve. The
x-axis represents the pixel values from the input frame, and the y-axis
the new pixel values to be set for the output frame.

By default, a component curve is defined by the two points
`(0;0)`{.variable} and `(1;1)`{.variable}. This creates a straight line
where each original pixel value is \"adjusted\" to its own value, which
means no change to the image.

The filter allows you to redefine these two points and add some more. A
new curve will be defined to pass smoothly through all these new
coordinates. The new defined points need to be strictly increasing over
the x-axis, and their `x`{.variable} and `y`{.variable} values must be
in the `[0;1]`{.variable} interval. The curve is formed by using a
natural or monotonic cubic spline interpolation, depending on the
`interp`{.variable} option (default: `natural`). The `natural` spline
produces a smoother curve in general while the monotonic (`pchip`)
spline guarantees the transitions between the specified points to be
monotonic. If the computed curves happened to go outside the vector
spaces, the values will be clipped accordingly.

The filter accepts the following options:

`preset`{.sample}

Select one of the available color presets. This option can be used in
addition to the `r`{.sample}, `g`{.sample}, `b`{.sample} parameters; in
this case, the later options takes priority on the preset values.
Available presets are:

'`none`{.sample}'

'`color_negative`{.sample}'

'`cross_process`{.sample}'

'`darker`{.sample}'

'`increase_contrast`{.sample}'

'`lighter`{.sample}'

'`linear_contrast`{.sample}'

'`medium_contrast`{.sample}'

'`negative`{.sample}'

'`strong_contrast`{.sample}'

'`vintage`{.sample}'

Default is `none`.

`master, m`{.sample}

Set the master key points. These points will define a second pass
mapping. It is sometimes called a \"luminance\" or \"value\" mapping. It
can be used with `r`{.sample}, `g`{.sample}, `b`{.sample} or
`all`{.sample} since it acts like a post-processing LUT.

`red, r`{.sample}

Set the key points for the red component.

`green, g`{.sample}

Set the key points for the green component.

`blue, b`{.sample}

Set the key points for the blue component.

`all`{.sample}

Set the key points for all components (not including master). Can be
used in addition to the other key points component options. In this
case, the unset component(s) will fallback on this `all`{.sample}
setting.

`psfile`{.sample}

Specify a Photoshop curves file (`.acv`) to import the settings from.

`plot`{.sample}

Save Gnuplot script of the curves in specified file.

`interp`{.sample}

Specify the kind of interpolation. Available algorithms are:

'`natural`{.sample}'

:   Natural cubic spline using a piece-wise cubic polynomial that is
    twice continuously differentiable.

'`pchip`{.sample}'

:   Monotonic cubic spline using a piecewise cubic Hermite interpolating
    polynomial (PCHIP).

To avoid some filtergraph syntax conflicts, each key points list need to
be defined using the following syntax: `x0/y0 x1/y1 x2/y2 ...`.

[]{#Commands-78}

#### [39.50.1 Commands](#toc-Commands-78) {#commands-78 .subsection}

This filter supports same [commands](#commands) as options.

[]{#Examples-107}

#### [39.50.2 Examples](#toc-Examples-107) {#examples-107 .subsection}

- Increase slightly the middle level of blue:

  ::: example
  ``` example
  curves=blue='0/0 0.5/0.58 1/1'
  ```
  :::

- Vintage effect:

  ::: example
  ``` example
  curves=r='0/0.11 .42/.51 1/0.95':g='0/0 0.50/0.48 1/1':b='0/0.22 .49/.44 1/0.8'
  ```
  :::

  Here we obtain the following coordinates for each components:

  `red`{.variable}

  :   `(0;0.11) (0.42;0.51) (1;0.95)`

  `green`{.variable}

  :   `(0;0) (0.50;0.48) (1;1)`

  `blue`{.variable}

  :   `(0;0.22) (0.49;0.44) (1;0.80)`

- The previous example can also be achieved with the associated built-in
  preset:

  ::: example
  ``` example
  curves=preset=vintage
  ```
  :::

- Or simply:

  ::: example
  ``` example
  curves=vintage
  ```
  :::

- Use a Photoshop preset and redefine the points of the green component:

  ::: example
  ``` example
  curves=psfile='MyCurvesPresets/purple.acv':green='0/0 0.45/0.53 1/1'
  ```
  :::

- Check out the curves of the `cross_process` profile using `ffmpeg` and
  `gnuplot`:

  ::: example
  ``` example
  ffmpeg -f lavfi -i color -vf curves=cross_process:plot=/tmp/curves.plt -frames:v 1 -f null -
  gnuplot -p /tmp/curves.plt
  ```
  :::

[]{#datascope}

### [39.51 datascope](#toc-datascope) {#datascope .section}

Video data analysis filter.

This filter shows hexadecimal pixel values of part of video.

The filter accepts the following options:

`size, s`{.sample}

:   Set output video size.

`x`{.sample}

:   Set x offset from where to pick pixels.

`y`{.sample}

:   Set y offset from where to pick pixels.

`mode`{.sample}

:   Set scope mode, can be one of the following:

    '`mono`{.sample}'

    :   Draw hexadecimal pixel values with white color on black
        background.

    '`color`{.sample}'

    :   Draw hexadecimal pixel values with input video pixel color on
        black background.

    '`color2`{.sample}'

    :   Draw hexadecimal pixel values on color background picked from
        input video, the text color is picked in such way so its always
        visible.

`axis`{.sample}

:   Draw rows and columns numbers on left and top of video.

`opacity`{.sample}

:   Set background opacity.

`format`{.sample}

:   Set display number format. Can be `hex`, or `dec`. Default is `hex`.

`components`{.sample}

:   Set pixel components to display. By default all pixel components are
    displayed.

[]{#Commands-79}

#### [39.51.1 Commands](#toc-Commands-79) {#commands-79 .subsection}

This filter supports same [commands](#commands) as options excluding
`size` option.

[]{#dblur}

### [39.52 dblur](#toc-dblur) {#dblur .section}

Apply Directional blur filter.

The filter accepts the following options:

`angle`{.sample}

:   Set angle of directional blur. Default is `45`.

`radius`{.sample}

:   Set radius of directional blur. Default is `5`.

`planes`{.sample}

:   Set which planes to filter. By default all planes are filtered.

[]{#Commands-80}

#### [39.52.1 Commands](#toc-Commands-80) {#commands-80 .subsection}

This filter supports same [commands](#commands) as options. The command
accepts the same syntax of the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#dctdnoiz}

### [39.53 dctdnoiz](#toc-dctdnoiz) {#dctdnoiz .section}

Denoise frames using 2D DCT (frequency domain filtering).

This filter is not designed for real time.

The filter accepts the following options:

`sigma, s`{.sample}

:   Set the noise sigma constant.

    This `sigma`{.variable} defines a hard threshold of `3 * sigma`;
    every DCT coefficient (absolute value) below this threshold with be
    dropped.

    If you need a more advanced filtering, see `expr`{.sample}.

    Default is `0`.

`overlap`{.sample}

:   Set number overlapping pixels for each block. Since the filter can
    be slow, you may want to reduce this value, at the cost of a less
    effective filter and the risk of various artefacts.

    If the overlapping value doesn't permit processing the whole input
    width or height, a warning will be displayed and according borders
    won't be denoised.

    Default value is `blocksize`{.variable}-1, which is the best
    possible setting.

`expr, e`{.sample}

:   Set the coefficient factor expression.

    For each coefficient of a DCT block, this expression will be
    evaluated as a multiplier value for the coefficient.

    If this is option is set, the `sigma`{.sample} option will be
    ignored.

    The absolute value of the coefficient can be accessed through the
    `c`{.variable} variable.

`n`{.sample}

:   Set the `blocksize`{.variable} using the number of bits.
    `1<<``n`{.variable} defines the `blocksize`{.variable}, which is the
    width and height of the processed blocks.

    The default value is `3`{.variable} (8x8) and can be raised to
    `4`{.variable} for a `blocksize`{.variable} of 16x16. Note that
    changing this setting has huge consequences on the speed processing.
    Also, a larger block size does not necessarily means a better
    de-noising.

[]{#Examples-108}

#### [39.53.1 Examples](#toc-Examples-108) {#examples-108 .subsection}

Apply a denoise with a `sigma`{.sample} of `4.5`:

::: example
``` example
dctdnoiz=4.5
```
:::

The same operation can be achieved using the expression system:

::: example
``` example
dctdnoiz=e='gte(c, 4.5*3)'
```
:::

Violent denoise using a block size of `16x16`:

::: example
``` example
dctdnoiz=15:n=4
```
:::

[]{#deband}

### [39.54 deband](#toc-deband) {#deband .section}

Remove banding artifacts from input video. It works by replacing banded
pixels with average value of referenced pixels.

The filter accepts the following options:

`1thr`{.sample}\
`2thr`{.sample}\
`3thr`{.sample}\
`4thr`{.sample}

:   Set banding detection threshold for each plane. Default is 0.02.
    Valid range is 0.00003 to 0.5. If difference between current pixel
    and reference pixel is less than threshold, it will be considered as
    banded.

`range, r`{.sample}

:   Banding detection range in pixels. Default is 16. If positive,
    random number in range 0 to set value will be used. If negative,
    exact absolute value will be used. The range defines square of four
    pixels around current pixel.

`direction, d`{.sample}

:   Set direction in radians from which four pixel will be compared. If
    positive, random direction from 0 to set direction will be picked.
    If negative, exact of absolute value will be picked. For example
    direction 0, -PI or -2\*PI radians will pick only pixels on same row
    and -PI/2 will pick only pixels on same column.

`blur, b`{.sample}

:   If enabled, current pixel is compared with average value of all four
    surrounding pixels. The default is enabled. If disabled current
    pixel is compared with all four surrounding pixels. The pixel is
    considered banded if only all four differences with surrounding
    pixels are less than threshold.

`coupling, c`{.sample}

:   If enabled, current pixel is changed if and only if all pixel
    components are banded, e.g. banding detection threshold is triggered
    for all color components. The default is disabled.

[]{#Commands-81}

#### [39.54.1 Commands](#toc-Commands-81) {#commands-81 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#deblock}

### [39.55 deblock](#toc-deblock) {#deblock .section}

Remove blocking artifacts from input video.

The filter accepts the following options:

`filter`{.sample}

:   Set filter type, can be `weak`{.variable} or `strong`{.variable}.
    Default is `strong`{.variable}. This controls what kind of
    deblocking is applied.

`block`{.sample}

:   Set size of block, allowed range is from 4 to 512. Default is
    `8`{.variable}.

`alpha`{.sample}\
`beta`{.sample}\
`gamma`{.sample}\
`delta`{.sample}

:   Set blocking detection thresholds. Allowed range is 0 to 1. Defaults
    are: `0.098`{.variable} for `alpha`{.variable} and `0.05`{.variable}
    for the rest. Using higher threshold gives more deblocking strength.
    Setting `alpha`{.variable} controls threshold detection at exact
    edge of block. Remaining options controls threshold detection near
    the edge. Each one for below/above or left/right. Setting any of
    those to `0`{.variable} disables deblocking.

`planes`{.sample}

:   Set planes to filter. Default is to filter all available planes.

[]{#Examples-109}

#### [39.55.1 Examples](#toc-Examples-109) {#examples-109 .subsection}

- Deblock using weak filter and block size of 4 pixels.

  ::: example
  ``` example
  deblock=filter=weak:block=4
  ```
  :::
- Deblock using strong filter, block size of 4 pixels and custom
  thresholds for deblocking more edges.

  ::: example
  ``` example
  deblock=filter=strong:block=4:alpha=0.12:beta=0.07:gamma=0.06:delta=0.05
  ```
  :::
- Similar as above, but filter only first plane.

  ::: example
  ``` example
  deblock=filter=strong:block=4:alpha=0.12:beta=0.07:gamma=0.06:delta=0.05:planes=1
  ```
  :::
- Similar as above, but filter only second and third plane.

  ::: example
  ``` example
  deblock=filter=strong:block=4:alpha=0.12:beta=0.07:gamma=0.06:delta=0.05:planes=6
  ```
  :::

[]{#Commands-82}

#### [39.55.2 Commands](#toc-Commands-82) {#commands-82 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#decimate}[]{#decimate-1}

### [39.56 decimate](#toc-decimate-1) {#decimate .section}

Drop duplicated frames at regular intervals.

The filter accepts the following options:

`cycle`{.sample}

:   Set the number of frames from which one will be dropped. Setting
    this to `N`{.variable} means one frame in every batch of
    `N`{.variable} frames will be dropped. Default is `5`.

`dupthresh`{.sample}

:   Set the threshold for duplicate detection. If the difference metric
    for a frame is less than or equal to this value, then it is declared
    as duplicate. Default is `1.1`

`scthresh`{.sample}

:   Set scene change threshold. Default is `15`.

`blockx`{.sample}\
`blocky`{.sample}

:   Set the size of the x and y-axis blocks used during metric
    calculations. Larger blocks give better noise suppression, but also
    give worse detection of small movements. Must be a power of two.
    Default is `32`.

`ppsrc`{.sample}

:   Mark main input as a pre-processed input and activate clean source
    input stream. This allows the input to be pre-processed with various
    filters to help the metrics calculation while keeping the frame
    selection lossless. When set to `1`, the first stream is for the
    pre-processed input, and the second stream is the clean source from
    where the kept frames are chosen. Default is `0`.

`chroma`{.sample}

:   Set whether or not chroma is considered in the metric calculations.
    Default is `1`.

`mixed`{.sample}

:   Set whether or not the input only partially contains content to be
    decimated. Default is `false`. If enabled video output stream will
    be in variable frame rate.

[]{#deconvolve}

### [39.57 deconvolve](#toc-deconvolve) {#deconvolve .section}

Apply 2D deconvolution of video stream in frequency domain using second
stream as impulse.

The filter accepts the following options:

`planes`{.sample}

:   Set which planes to process.

`impulse`{.sample}

:   Set which impulse video frames will be processed, can be
    `first`{.variable} or `all`{.variable}. Default is `all`{.variable}.

`noise`{.sample}

:   Set noise when doing divisions. Default is `0.0000001`{.variable}.
    Useful when width and height are not same and not power of 2 or if
    stream prior to convolving had noise.

The `deconvolve` filter also supports the [framesync](#framesync)
options.

[]{#dedot}

### [39.58 dedot](#toc-dedot) {#dedot .section}

Reduce cross-luminance (dot-crawl) and cross-color (rainbows) from
video.

It accepts the following options:

`m`{.sample}

:   Set mode of operation. Can be combination of `dotcrawl`{.variable}
    for cross-luminance reduction and/or `rainbows`{.variable} for
    cross-color reduction.

`lt`{.sample}

:   Set spatial luma threshold. Lower values increases reduction of
    cross-luminance.

`tl`{.sample}

:   Set tolerance for temporal luma. Higher values increases reduction
    of cross-luminance.

`tc`{.sample}

:   Set tolerance for chroma temporal variation. Higher values increases
    reduction of cross-color.

`ct`{.sample}

:   Set temporal chroma threshold. Lower values increases reduction of
    cross-color.

[]{#deflate}

### [39.59 deflate](#toc-deflate) {#deflate .section}

Apply deflate effect to the video.

This filter replaces the pixel by the local(3x3) average by taking into
account only values lower than the pixel.

It accepts the following options:

`threshold0`{.sample}\
`threshold1`{.sample}\
`threshold2`{.sample}\
`threshold3`{.sample}

:   Limit the maximum change for each plane, default is 65535. If 0,
    plane will remain unchanged.

[]{#Commands-83}

#### [39.59.1 Commands](#toc-Commands-83) {#commands-83 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#deflicker}

### [39.60 deflicker](#toc-deflicker) {#deflicker .section}

Remove temporal frame luminance variations.

It accepts the following options:

`size, s`{.sample}

:   Set moving-average filter size in frames. Default is 5. Allowed
    range is 2 - 129.

`mode, m`{.sample}

:   Set averaging mode to smooth temporal luminance variations.

    Available values are:

    '`am`{.sample}'

    :   Arithmetic mean

    '`gm`{.sample}'

    :   Geometric mean

    '`hm`{.sample}'

    :   Harmonic mean

    '`qm`{.sample}'

    :   Quadratic mean

    '`cm`{.sample}'

    :   Cubic mean

    '`pm`{.sample}'

    :   Power mean

    '`median`{.sample}'

    :   Median

`bypass`{.sample}

:   Do not actually modify frame. Useful when one only wants metadata.

[]{#dejudder}

### [39.61 dejudder](#toc-dejudder) {#dejudder .section}

Remove judder produced by partially interlaced telecined content.

Judder can be introduced, for instance, by [pullup](#pullup) filter. If
the original source was partially telecined content then the output of
`pullup,dejudder` will have a variable frame rate. May change the
recorded frame rate of the container. Aside from that change, this
filter will not affect constant frame rate video.

The option available in this filter is:

`cycle`{.sample}

:   Specify the length of the window over which the judder repeats.

    Accepts any integer greater than 1. Useful values are:

    '`4`{.sample}'

    :   If the original was telecined from 24 to 30 fps (Film to NTSC).

    '`5`{.sample}'

    :   If the original was telecined from 25 to 30 fps (PAL to NTSC).

    '`20`{.sample}'

    :   If a mixture of the two.

    The default is '`4`{.sample}'.

[]{#delogo}

### [39.62 delogo](#toc-delogo) {#delogo .section}

Suppress a TV station logo by a simple interpolation of the surrounding
pixels. Just set a rectangle covering the logo and watch it disappear
(and sometimes something even uglier appear - your mileage may vary).

It accepts the following parameters:

`x`{.sample}\
`y`{.sample}

:   Specify the top left corner coordinates of the logo. They must be
    specified.

`w`{.sample}\
`h`{.sample}

:   Specify the width and height of the logo to clear. They must be
    specified.

`show`{.sample}

:   When set to 1, a green rectangle is drawn on the screen to simplify
    finding the right `x`{.variable}, `y`{.variable}, `w`{.variable},
    and `h`{.variable} parameters. The default value is 0.

    The rectangle is drawn on the outermost pixels which will be
    (partly) replaced with interpolated values. The values of the next
    pixels immediately outside this rectangle in each direction will be
    used to compute the interpolated pixel values inside the rectangle.

[]{#Examples-110}

#### [39.62.1 Examples](#toc-Examples-110) {#examples-110 .subsection}

- Set a rectangle covering the area with top left corner coordinates 0,0
  and size 100x77:

  ::: example
  ``` example
  delogo=x=0:y=0:w=100:h=77
  ```
  :::

[]{#derain}[]{#derain-1}

### [39.63 derain](#toc-derain-1) {#derain .section}

Remove the rain in the input image/video by applying the derain methods
based on convolutional neural networks. Supported models:

- Recurrent Squeeze-and-Excitation Context Aggregation Net (RESCAN). See
  <http://openaccess.thecvf.com/content_ECCV_2018/papers/Xia_Li_Recurrent_Squeeze-and-Excitation_Context_ECCV_2018_paper.pdf>.

Training as well as model generation scripts are provided in the
repository at <https://github.com/XueweiMeng/derain_filter.git>.

The filter accepts the following options:

`filter_type`{.sample}

:   Specify which filter to use. This option accepts the following
    values:

    '`derain`{.sample}'

    :   Derain filter. To conduct derain filter, you need to use a
        derain model.

    '`dehaze`{.sample}'

    :   Dehaze filter. To conduct dehaze filter, you need to use a
        dehaze model.

    Default value is '`derain`{.sample}'.

`dnn_backend`{.sample}

:   Specify which DNN backend to use for model loading and execution.
    This option accepts the following values:

    '`tensorflow`{.sample}'

    :   TensorFlow backend. To enable this backend you need to install
        the TensorFlow for C library (see
        <https://www.tensorflow.org/install/lang_c>) and configure
        FFmpeg with `--enable-libtensorflow`

`model`{.sample}

:   Set path to model file specifying network architecture and its
    parameters. Note that different backends use different file formats.
    TensorFlow can load files for only its format.

To get full functionality (such as async execution), please use the
[dnn_processing](#dnn_005fprocessing) filter.

[]{#deshake}

### [39.64 deshake](#toc-deshake) {#deshake .section}

Attempt to fix small changes in horizontal and/or vertical shift. This
filter helps remove camera shake from hand-holding a camera, bumping a
tripod, moving on a vehicle, etc.

The filter accepts the following options:

`x`{.sample}\
`y`{.sample}\
`w`{.sample}\
`h`{.sample}

:   Specify a rectangular area where to limit the search for motion
    vectors. If desired the search for motion vectors can be limited to
    a rectangular area of the frame defined by its top left corner,
    width and height. These parameters have the same meaning as the
    drawbox filter which can be used to visualise the position of the
    bounding box.

    This is useful when simultaneous movement of subjects within the
    frame might be confused for camera motion by the motion vector
    search.

    If any or all of `x`{.variable}, `y`{.variable}, `w`{.variable} and
    `h`{.variable} are set to -1 then the full frame is used. This
    allows later options to be set without specifying the bounding box
    for the motion vector search.

    Default - search the whole frame.

`rx`{.sample}\
`ry`{.sample}

:   Specify the maximum extent of movement in x and y directions in the
    range 0-64 pixels. Default 16.

`edge`{.sample}

:   Specify how to generate pixels to fill blanks at the edge of the
    frame. Available values are:

    '`blank, 0`{.sample}'

    :   Fill zeroes at blank locations

    '`original, 1`{.sample}'

    :   Original image at blank locations

    '`clamp, 2`{.sample}'

    :   Extruded edge value at blank locations

    '`mirror, 3`{.sample}'

    :   Mirrored edge at blank locations

    Default value is '`mirror`{.sample}'.

`blocksize`{.sample}

:   Specify the blocksize to use for motion search. Range 4-128 pixels,
    default 8.

`contrast`{.sample}

:   Specify the contrast threshold for blocks. Only blocks with more
    than the specified contrast (difference between darkest and lightest
    pixels) will be considered. Range 1-255, default 125.

`search`{.sample}

:   Specify the search strategy. Available values are:

    '`exhaustive, 0`{.sample}'

    :   Set exhaustive search

    '`less, 1`{.sample}'

    :   Set less exhaustive search.

    Default value is '`exhaustive`{.sample}'.

`filename`{.sample}

:   If set then a detailed log of the motion search is written to the
    specified file.

[]{#despill}

### [39.65 despill](#toc-despill) {#despill .section}

Remove unwanted contamination of foreground colors, caused by reflected
color of greenscreen or bluescreen.

This filter accepts the following options:

`type`{.sample}

:   Set what type of despill to use.

`mix`{.sample}

:   Set how spillmap will be generated.

`expand`{.sample}

:   Set how much to get rid of still remaining spill.

`red`{.sample}

:   Controls amount of red in spill area.

`green`{.sample}

:   Controls amount of green in spill area. Should be -1 for
    greenscreen.

`blue`{.sample}

:   Controls amount of blue in spill area. Should be -1 for bluescreen.

`brightness`{.sample}

:   Controls brightness of spill area, preserving colors.

`alpha`{.sample}

:   Modify alpha from generated spillmap.

[]{#Commands-84}

#### [39.65.1 Commands](#toc-Commands-84) {#commands-84 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#detelecine}

### [39.66 detelecine](#toc-detelecine) {#detelecine .section}

Apply an exact inverse of the telecine operation. It requires a
predefined pattern specified using the pattern option which must be the
same as that passed to the telecine filter.

This filter accepts the following options:

`first_field`{.sample}

:   

    '`top, t`{.sample}'

    :   top field first

    '`bottom, b`{.sample}'

    :   bottom field first The default value is `top`.

`pattern`{.sample}

:   A string of numbers representing the pulldown pattern you wish to
    apply. The default value is `23`.

`start_frame`{.sample}

:   A number representing position of the first frame with respect to
    the telecine pattern. This is to be used if the stream is cut. The
    default value is `0`.

[]{#dilation}[]{#dilation-1}

### [39.67 dilation](#toc-dilation-1) {#dilation .section}

Apply dilation effect to the video.

This filter replaces the pixel by the local(3x3) maximum.

It accepts the following options:

`threshold0`{.sample}\
`threshold1`{.sample}\
`threshold2`{.sample}\
`threshold3`{.sample}

:   Limit the maximum change for each plane, default is 65535. If 0,
    plane will remain unchanged.

`coordinates`{.sample}

:   Flag which specifies the pixel to refer to. Default is 255 i.e. all
    eight pixels are used.

    Flags to local 3x3 coordinates maps like this:

    1 2 3 4 5 6 7 8

[]{#Commands-85}

#### [39.67.1 Commands](#toc-Commands-85) {#commands-85 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#displace}

### [39.68 displace](#toc-displace) {#displace .section}

Displace pixels as indicated by second and third input stream.

It takes three input streams and outputs one stream, the first input is
the source, and second and third input are displacement maps.

The second input specifies how much to displace pixels along the x-axis,
while the third input specifies how much to displace pixels along the
y-axis. If one of displacement map streams terminates, last frame from
that displacement map will be used.

Note that once generated, displacements maps can be reused over and over
again.

A description of the accepted options follows.

`edge`{.sample}

:   Set displace behavior for pixels that are out of range.

    Available values are:

    '`blank`{.sample}'

    :   Missing pixels are replaced by black pixels.

    '`smear`{.sample}'

    :   Adjacent pixels will spread out to replace missing pixels.

    '`wrap`{.sample}'

    :   Out of range pixels are wrapped so they point to pixels of other
        side.

    '`mirror`{.sample}'

    :   Out of range pixels will be replaced with mirrored pixels.

    Default is '`smear`{.sample}'.

[]{#Examples-111}

#### [39.68.1 Examples](#toc-Examples-111) {#examples-111 .subsection}

- Add ripple effect to rgb input of video size hd720:

  ::: example
  ``` example
  ffmpeg -i INPUT -f lavfi -i nullsrc=s=hd720,lutrgb=128:128:128 -f lavfi -i nullsrc=s=hd720,geq='r=128+30*sin(2*PI*X/400+T):g=128+30*sin(2*PI*X/400+T):b=128+30*sin(2*PI*X/400+T)' -lavfi '[0][1][2]displace' OUTPUT
  ```
  :::
- Add wave effect to rgb input of video size hd720:

  ::: example
  ``` example
  ffmpeg -i INPUT -f lavfi -i nullsrc=hd720,geq='r=128+80*(sin(sqrt((X-W/2)*(X-W/2)+(Y-H/2)*(Y-H/2))/220*2*PI+T)):g=128+80*(sin(sqrt((X-W/2)*(X-W/2)+(Y-H/2)*(Y-H/2))/220*2*PI+T)):b=128+80*(sin(sqrt((X-W/2)*(X-W/2)+(Y-H/2)*(Y-H/2))/220*2*PI+T))' -lavfi '[1]split[x][y],[0][x][y]displace' OUTPUT
  ```
  :::

[]{#dnn_005fclassify}

### [39.69 dnn_classify](#toc-dnn_005fclassify) {#dnn_classify .section}

Do classification with deep neural networks based on bounding boxes.

The filter accepts the following options:

`dnn_backend`{.sample}

:   Specify which DNN backend to use for model loading and execution.
    This option accepts only openvino now, tensorflow backends will be
    added.

`model`{.sample}

:   Set path to model file specifying network architecture and its
    parameters. Note that different backends use different file formats.

`input`{.sample}

:   Set the input name of the dnn network.

`output`{.sample}

:   Set the output name of the dnn network.

`confidence`{.sample}

:   Set the confidence threshold (default: 0.5).

`labels`{.sample}

:   Set path to label file specifying the mapping between label id and
    name. Each label name is written in one line, tailing spaces and
    empty lines are skipped. The first line is the name of label id 0,
    and the second line is the name of label id 1, etc. The label id is
    considered as name if the label file is not provided.

`backend_configs`{.sample}

:   Set the configs to be passed into backend

    For tensorflow backend, you can set its configs with
    `sess_config`{.sample} options, please use
    tools/python/tf_sess_config.py to get the configs for your system.

[]{#dnn_005fdetect}

### [39.70 dnn_detect](#toc-dnn_005fdetect) {#dnn_detect .section}

Do object detection with deep neural networks.

The filter accepts the following options:

`dnn_backend`{.sample}

:   Specify which DNN backend to use for model loading and execution.
    This option accepts only openvino now, tensorflow backends will be
    added.

`model`{.sample}

:   Set path to model file specifying network architecture and its
    parameters. Note that different backends use different file formats.

`input`{.sample}

:   Set the input name of the dnn network.

`output`{.sample}

:   Set the output name of the dnn network.

`confidence`{.sample}

:   Set the confidence threshold (default: 0.5).

`labels`{.sample}

:   Set path to label file specifying the mapping between label id and
    name. Each label name is written in one line, tailing spaces and
    empty lines are skipped. The first line is the name of label id 0
    (usually it is 'background'), and the second line is the name of
    label id 1, etc. The label id is considered as name if the label
    file is not provided.

`backend_configs`{.sample}

:   Set the configs to be passed into backend. To use async execution,
    set async (default: set). Roll back to sync execution if the backend
    does not support async.

[]{#dnn_005fprocessing}[]{#dnn_005fprocessing-1}

### [39.71 dnn_processing](#toc-dnn_005fprocessing-1) {#dnn_processing .section}

Do image processing with deep neural networks. It works together with
another filter which converts the pixel format of the Frame to what the
dnn network requires.

The filter accepts the following options:

`dnn_backend`{.sample}

:   Specify which DNN backend to use for model loading and execution.
    This option accepts the following values:

    '`tensorflow`{.sample}'

    :   TensorFlow backend. To enable this backend you need to install
        the TensorFlow for C library (see
        <https://www.tensorflow.org/install/lang_c>) and configure
        FFmpeg with `--enable-libtensorflow`

    '`openvino`{.sample}'

    :   OpenVINO backend. To enable this backend you need to build and
        install the OpenVINO for C library (see
        <https://github.com/openvinotoolkit/openvino/blob/master/build-instruction.md>)
        and configure FFmpeg with `--enable-libopenvino`
        (--extra-cflags=-I\... --extra-ldflags=-L\... might be needed if
        the header files and libraries are not installed into system
        path)

    '`torch`{.sample}'

    :   Libtorch backend. To enable this backend you need to build and
        install Libtroch for C++ library. Please download cxx11 ABI
        version (see <https://pytorch.org/get-started/locally>) and
        configure FFmpeg with
        `--enable-libtorch --extra-cflags=-I/libtorch_root/libtorch/include --extra-cflags=-I/libtorch_root/libtorch/include/torch/csrc/api/include --extra-ldflags=-L/libtorch_root/libtorch/lib/`

`model`{.sample}

:   Set path to model file specifying network architecture and its
    parameters. Note that different backends use different file formats.
    TensorFlow, OpenVINO and Libtorch backend can load files for only
    its format.

`input`{.sample}

:   Set the input name of the dnn network.

`output`{.sample}

:   Set the output name of the dnn network.

`backend_configs`{.sample}

:   Set the configs to be passed into backend. To use async execution,
    set async (default: set). Roll back to sync execution if the backend
    does not support async.

    For tensorflow backend, you can set its configs with
    `sess_config`{.sample} options, please use
    tools/python/tf_sess_config.py to get the configs of TensorFlow
    backend for your system.

[]{#Examples-112}

#### [39.71.1 Examples](#toc-Examples-112) {#examples-112 .subsection}

- Remove rain in rgb24 frame with can.pb (see [derain](#derain) filter):

  ::: example
  ``` example
  ./ffmpeg -i rain.jpg -vf format=rgb24,dnn_processing=dnn_backend=tensorflow:model=can.pb:input=x:output=y derain.jpg
  ```
  :::
- Handle the Y channel with srcnn.pb (see [sr](#sr) filter) for frame
  with yuv420p (planar YUV formats supported):

  ::: example
  ``` example
  ./ffmpeg -i 480p.jpg -vf format=yuv420p,scale=w=iw*2:h=ih*2,dnn_processing=dnn_backend=tensorflow:model=srcnn.pb:input=x:output=y -y srcnn.jpg
  ```
  :::
- Handle the Y channel with espcn.pb (see [sr](#sr) filter), which
  changes frame size, for format yuv420p (planar YUV formats supported),
  please use tools/python/tf_sess_config.py to get the configs of
  TensorFlow backend for your system.

  ::: example
  ``` example
  ./ffmpeg -i 480p.jpg -vf format=yuv420p,dnn_processing=dnn_backend=tensorflow:model=espcn.pb:input=x:output=y:backend_configs=sess_config=0x10022805320e09cdccccccccccec3f20012a01303801 -y tmp.espcn.jpg
  ```
  :::

[]{#drawbox}

### [39.72 drawbox](#toc-drawbox) {#drawbox .section}

Draw a colored box on the input image.

It accepts the following parameters:

`x`{.sample}\
`y`{.sample}

:   The expressions which specify the top left corner coordinates of the
    box. It defaults to 0.

`width, w`{.sample}\
`height, h`{.sample}

:   The expressions which specify the width and height of the box; if 0
    they are interpreted as the input width and height. It defaults to
    0.

`color, c`{.sample}

:   Specify the color of the box to write. For the general syntax of
    this option, check the [(ffmpeg-utils)\"Color\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#color-syntax). If the special
    value `invert` is used, the box edge color is the same as the video
    with inverted luma.

`thickness, t`{.sample}

:   The expression which sets the thickness of the box edge. A value of
    `fill` will create a filled box. Default value is `3`.

    See below for the list of accepted constants.

`replace`{.sample}

:   Applicable if the input has alpha. With value `1`, the pixels of the
    painted box will overwrite the video's color and alpha pixels.
    Default is `0`, which composites the box onto the input, leaving the
    video's alpha intact.

The parameters for `x`{.variable}, `y`{.variable}, `w`{.variable} and
`h`{.variable} and `t`{.variable} are expressions containing the
following constants:

`dar`{.sample}

:   The input display aspect ratio, it is the same as (`w`{.variable} /
    `h`{.variable}) \* `sar`{.variable}.

`hsub`{.sample}\
`vsub`{.sample}

:   horizontal and vertical chroma subsample values. For example for the
    pixel format \"yuv422p\" `hsub`{.variable} is 2 and
    `vsub`{.variable} is 1.

`in_h, ih`{.sample}\
`in_w, iw`{.sample}

:   The input width and height.

`sar`{.sample}

:   The input sample aspect ratio.

`x`{.sample}\
`y`{.sample}

:   The x and y offset coordinates where the box is drawn.

`w`{.sample}\
`h`{.sample}

:   The width and height of the drawn box.

`box_source`{.sample}

:   Box source can be set as side_data_detection_bboxes if you want to
    use box data in detection bboxes of side data.

    If `box_source`{.variable} is set, the `x`{.variable},
    `y`{.variable}, `width`{.variable} and `height`{.variable} will be
    ignored and still use box data in detection bboxes of side data. So
    please do not use this parameter if you were not sure about the box
    source.

`t`{.sample}

:   The thickness of the drawn box.

    These constants allow the `x`{.variable}, `y`{.variable},
    `w`{.variable}, `h`{.variable} and `t`{.variable} expressions to
    refer to each other, so you may for example specify `y=x/dar` or
    `h=w/dar`.

[]{#Examples-113}

#### [39.72.1 Examples](#toc-Examples-113) {#examples-113 .subsection}

- Draw a black box around the edge of the input image:

  ::: example
  ``` example
  drawbox
  ```
  :::

- Draw a box with color red and an opacity of 50%:

  ::: example
  ``` example
  drawbox=10:20:200:60:red@0.5
  ```
  :::

  The previous example can be specified as:

  ::: example
  ``` example
  drawbox=x=10:y=20:w=200:h=60:color=red@0.5
  ```
  :::

- Fill the box with pink color:

  ::: example
  ``` example
  drawbox=x=10:y=10:w=100:h=100:color=pink@0.5:t=fill
  ```
  :::

- Draw a 2-pixel red 2.40:1 mask:

  ::: example
  ``` example
  drawbox=x=-t:y=0.5*(ih-iw/2.4)-t:w=iw+t*2:h=iw/2.4+t*2:t=2:c=red
  ```
  :::

[]{#Commands-86}

#### [39.72.2 Commands](#toc-Commands-86) {#commands-86 .subsection}

This filter supports same commands as options. The command accepts the
same syntax of the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#drawgraph}[]{#drawgraph-1}

### [39.73 drawgraph](#toc-drawgraph-1) {#drawgraph .section}

Draw a graph using input video metadata.

It accepts the following parameters:

`m1`{.sample}

Set 1st frame metadata key from which metadata values will be used to
draw a graph.

`fg1`{.sample}

Set 1st foreground color expression.

`m2`{.sample}

Set 2nd frame metadata key from which metadata values will be used to
draw a graph.

`fg2`{.sample}

Set 2nd foreground color expression.

`m3`{.sample}

Set 3rd frame metadata key from which metadata values will be used to
draw a graph.

`fg3`{.sample}

Set 3rd foreground color expression.

`m4`{.sample}

Set 4th frame metadata key from which metadata values will be used to
draw a graph.

`fg4`{.sample}

Set 4th foreground color expression.

`min`{.sample}

Set minimal value of metadata value.

`max`{.sample}

Set maximal value of metadata value.

`bg`{.sample}

Set graph background color. Default is white.

`mode`{.sample}

Set graph mode.

Available values for mode is:

'`bar`{.sample}'

'`dot`{.sample}'

'`line`{.sample}'

Default is `line`.

`slide`{.sample}

Set slide mode.

Available values for slide is:

'`frame`{.sample}'

:   Draw new frame when right border is reached.

'`replace`{.sample}'

:   Replace old columns with new ones.

'`scroll`{.sample}'

:   Scroll from right to left.

'`rscroll`{.sample}'

:   Scroll from left to right.

'`picture`{.sample}'

:   Draw single picture.

Default is `frame`.

`size`{.sample}

Set size of graph video. For the syntax of this option, check the
[(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
manual](ffmpeg-utils.html#video-size-syntax). The default value is
`900x256`.

`rate, r`{.sample}

Set the output frame rate. Default value is `25`.

The foreground color expressions can use the following variables:

`MIN`{.sample}

:   Minimal value of metadata value.

`MAX`{.sample}

:   Maximal value of metadata value.

`VAL`{.sample}

:   Current metadata key value.

The color is defined as 0xAABBGGRR.

Example using metadata from [signalstats](#signalstats) filter:

::: example
``` example
signalstats,drawgraph=lavfi.signalstats.YAVG:min=0:max=255
```
:::

Example using metadata from [ebur128](#ebur128) filter:

::: example
``` example
ebur128=metadata=1,adrawgraph=lavfi.r128.M:min=-120:max=5
```
:::

[]{#drawgrid}

### [39.74 drawgrid](#toc-drawgrid) {#drawgrid .section}

Draw a grid on the input image.

It accepts the following parameters:

`x`{.sample}\
`y`{.sample}

:   The expressions which specify the coordinates of some point of grid
    intersection (meant to configure offset). Both default to 0.

`width, w`{.sample}\
`height, h`{.sample}

:   The expressions which specify the width and height of the grid cell,
    if 0 they are interpreted as the input width and height,
    respectively, minus `thickness`, so image gets framed. Default to 0.

`color, c`{.sample}

:   Specify the color of the grid. For the general syntax of this
    option, check the [(ffmpeg-utils)\"Color\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#color-syntax). If the special
    value `invert` is used, the grid color is the same as the video with
    inverted luma.

`thickness, t`{.sample}

:   The expression which sets the thickness of the grid line. Default
    value is `1`.

    See below for the list of accepted constants.

`replace`{.sample}

:   Applicable if the input has alpha. With `1` the pixels of the
    painted grid will overwrite the video's color and alpha pixels.
    Default is `0`, which composites the grid onto the input, leaving
    the video's alpha intact.

The parameters for `x`{.variable}, `y`{.variable}, `w`{.variable} and
`h`{.variable} and `t`{.variable} are expressions containing the
following constants:

`dar`{.sample}

:   The input display aspect ratio, it is the same as (`w`{.variable} /
    `h`{.variable}) \* `sar`{.variable}.

`hsub`{.sample}\
`vsub`{.sample}

:   horizontal and vertical chroma subsample values. For example for the
    pixel format \"yuv422p\" `hsub`{.variable} is 2 and
    `vsub`{.variable} is 1.

`in_h, ih`{.sample}\
`in_w, iw`{.sample}

:   The input grid cell width and height.

`sar`{.sample}

:   The input sample aspect ratio.

`x`{.sample}\
`y`{.sample}

:   The x and y coordinates of some point of grid intersection (meant to
    configure offset).

`w`{.sample}\
`h`{.sample}

:   The width and height of the drawn cell.

`t`{.sample}

:   The thickness of the drawn cell.

    These constants allow the `x`{.variable}, `y`{.variable},
    `w`{.variable}, `h`{.variable} and `t`{.variable} expressions to
    refer to each other, so you may for example specify `y=x/dar` or
    `h=w/dar`.

[]{#Examples-114}

#### [39.74.1 Examples](#toc-Examples-114) {#examples-114 .subsection}

- Draw a grid with cell 100x100 pixels, thickness 2 pixels, with color
  red and an opacity of 50%:

  ::: example
  ``` example
  drawgrid=width=100:height=100:thickness=2:color=red@0.5
  ```
  :::
- Draw a white 3x3 grid with an opacity of 50%:

  ::: example
  ``` example
  drawgrid=w=iw/3:h=ih/3:t=2:c=white@0.5
  ```
  :::

[]{#Commands-87}

#### [39.74.2 Commands](#toc-Commands-87) {#commands-87 .subsection}

This filter supports same commands as options. The command accepts the
same syntax of the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#drawtext}[]{#drawtext-1}

### [39.75 drawtext](#toc-drawtext-1) {#drawtext .section}

Draw a text string or text from a specified file on top of a video,
using the libfreetype library.

To enable compilation of this filter, you need to configure FFmpeg with
`--enable-libfreetype` and `--enable-libharfbuzz`. To enable default
font fallback and the `font`{.variable} option you need to configure
FFmpeg with `--enable-libfontconfig`. To enable the
`text_shaping`{.variable} option, you need to configure FFmpeg with
`--enable-libfribidi`.

[]{#Syntax-2}

#### [39.75.1 Syntax](#toc-Syntax-2) {#syntax-2 .subsection}

It accepts the following parameters:

`box`{.sample}

Used to draw a box around text using the background color. The value
must be either 1 (enable) or 0 (disable). The default value of
`box`{.variable} is 0.

`boxborderw`{.sample}

Set the width of the border to be drawn around the box using
`boxcolor`{.variable}. The value must be specified using one of the
following formats:

- `boxborderw=10` set the width of all the borders to 10
- `boxborderw=10|20` set the width of the top and bottom borders to 10
  and the width of the left and right borders to 20
- `boxborderw=10|20|30` set the width of the top border to 10, the width
  of the bottom border to 30 and the width of the left and right borders
  to 20
- `boxborderw=10|20|30|40` set the borders width to 10 (top), 20
  (right), 30 (bottom), 40 (left)

The default value of `boxborderw`{.variable} is \"0\".

`boxcolor`{.sample}

The color to be used for drawing box around text. For the syntax of this
option, check the [(ffmpeg-utils)\"Color\" section in the ffmpeg-utils
manual](ffmpeg-utils.html#color-syntax).

The default value of `boxcolor`{.variable} is \"white\".

`line_spacing`{.sample}

Set the line spacing in pixels. The default value of
`line_spacing`{.variable} is 0.

`text_align`{.sample}

Set the vertical and horizontal alignment of the text with respect to
the box boundaries. The value is combination of flags, one for the
vertical alignment (T=top, M=middle, B=bottom) and one for the
horizontal alignment (L=left, C=center, R=right). Please note that tab
characters are only supported with the left horizontal alignment.

`y_align`{.sample}

Specify what the `y`{.variable} value is referred to. Possible values
are:

- `text` the top of the highest glyph of the first text line is placed
  at `y`{.variable}
- `baseline` the baseline of the first text line is placed at
  `y`{.variable}
- `font` the baseline of the first text line is placed at `y`{.variable}
  plus the ascent (in pixels) defined in the font metrics

The default value of `y_align`{.variable} is \"text\" for backward
compatibility.

`borderw`{.sample}

Set the width of the border to be drawn around the text using
`bordercolor`{.variable}. The default value of `borderw`{.variable} is
0.

`bordercolor`{.sample}

Set the color to be used for drawing border around text. For the syntax
of this option, check the [(ffmpeg-utils)\"Color\" section in the
ffmpeg-utils manual](ffmpeg-utils.html#color-syntax).

The default value of `bordercolor`{.variable} is \"black\".

`expansion`{.sample}

Select how the `text`{.variable} is expanded. Can be either `none`,
`strftime` (deprecated) or `normal` (default). See the [Text
expansion](#drawtext_005fexpansion) section below for details.

`basetime`{.sample}

Set a start time for the count. Value is in microseconds. Only applied
in the deprecated `strftime` expansion mode. To emulate in normal
expansion mode use the `pts` function, supplying the start time (in
seconds) as the second argument.

`fix_bounds`{.sample}

If true, check and fix text coords to avoid clipping.

`fontcolor`{.sample}

The color to be used for drawing fonts. For the syntax of this option,
check the [(ffmpeg-utils)\"Color\" section in the ffmpeg-utils
manual](ffmpeg-utils.html#color-syntax).

The default value of `fontcolor`{.variable} is \"black\".

`fontcolor_expr`{.sample}

String which is expanded the same way as `text`{.variable} to obtain
dynamic `fontcolor`{.variable} value. By default this option has empty
value and is not processed. When this option is set, it overrides
`fontcolor`{.variable} option.

`font`{.sample}

The font family to be used for drawing text. By default Sans.

`fontfile`{.sample}

The font file to be used for drawing text. The path must be included.
This parameter is mandatory if the fontconfig support is disabled.

`alpha`{.sample}

Draw the text applying alpha blending. The value can be a number between
0.0 and 1.0. The expression accepts the same variables `x, y`{.variable}
as well. The default value is 1. Please see `fontcolor_expr`{.variable}.

`fontsize`{.sample}

The font size to be used for drawing text. The default value of
`fontsize`{.variable} is 16.

`text_shaping`{.sample}

If set to 1, attempt to shape the text (for example, reverse the order
of right-to-left text and join Arabic characters) before drawing it.
Otherwise, just draw the text exactly as given. By default 1 (if
supported).

`ft_load_flags`{.sample}

The flags to be used for loading the fonts.

The flags map the corresponding flags supported by libfreetype, and are
a combination of the following values:

`default`{.variable}

`no_scale`{.variable}

`no_hinting`{.variable}

`render`{.variable}

`no_bitmap`{.variable}

`vertical_layout`{.variable}

`force_autohint`{.variable}

`crop_bitmap`{.variable}

`pedantic`{.variable}

`ignore_global_advance_width`{.variable}

`no_recurse`{.variable}

`ignore_transform`{.variable}

`monochrome`{.variable}

`linear_design`{.variable}

`no_autohint`{.variable}

Default value is \"default\".

For more information consult the documentation for the FT_LOAD\_\*
libfreetype flags.

`shadowcolor`{.sample}

The color to be used for drawing a shadow behind the drawn text. For the
syntax of this option, check the [(ffmpeg-utils)\"Color\" section in the
ffmpeg-utils manual](ffmpeg-utils.html#color-syntax).

The default value of `shadowcolor`{.variable} is \"black\".

`boxw`{.sample}

Set the width of the box to be drawn around text. The default value of
`boxw`{.variable} is computed automatically to match the text width

`boxh`{.sample}

Set the height of the box to be drawn around text. The default value of
`boxh`{.variable} is computed automatically to match the text height

`shadowx`{.sample}

`shadowy`{.sample}

The x and y offsets for the text shadow position with respect to the
position of the text. They can be either positive or negative values.
The default value for both is \"0\".

`start_number`{.sample}

The starting frame number for the n/frame_num variable. The default
value is \"0\".

`tabsize`{.sample}

The size in number of spaces to use for rendering the tab. Default value
is 4.

`timecode`{.sample}

Set the initial timecode representation in \"hh:mm:ss\[:;.\]ff\" format.
It can be used with or without text parameter.
`timecode_rate`{.variable} option must be specified.

`timecode_rate, rate, r`{.sample}

Set the timecode frame rate (timecode only). Value will be rounded to
nearest integer. Minimum value is \"1\". Drop-frame timecode is
supported for frame rates 30 & 60.

`tc24hmax`{.sample}

If set to 1, the output of the timecode option will wrap around at 24
hours. Default is 0 (disabled).

`text`{.sample}

The text string to be drawn. The text must be a sequence of UTF-8
encoded characters. This parameter is mandatory if no file is specified
with the parameter `textfile`{.variable}.

`textfile`{.sample}

A text file containing text to be drawn. The text must be a sequence of
UTF-8 encoded characters.

This parameter is mandatory if no text string is specified with the
parameter `text`{.variable}.

If both `text`{.variable} and `textfile`{.variable} are specified, an
error is thrown.

`text_source`{.sample}

Text source should be set as side_data_detection_bboxes if you want to
use text data in detection bboxes of side data.

If text source is set, `text`{.variable} and `textfile`{.variable} will
be ignored and still use text data in detection bboxes of side data. So
please do not use this parameter if you are not sure about the text
source.

`reload`{.sample}

The `textfile`{.variable} will be reloaded at specified frame interval.
Be sure to update `textfile`{.variable} atomically, or it may be read
partially, or even fail. Range is 0 to INT_MAX. Default is 0.

`x`{.sample}

`y`{.sample}

The expressions which specify the offsets where text will be drawn
within the video frame. They are relative to the top/left border of the
output image.

The default value of `x`{.variable} and `y`{.variable} is \"0\".

See below for the list of accepted constants and functions.

The parameters for `x`{.variable} and `y`{.variable} are expressions
containing the following constants and functions:

`dar`{.sample}

:   input display aspect ratio, it is the same as (`w`{.variable} /
    `h`{.variable}) \* `sar`{.variable}

`hsub`{.sample}\
`vsub`{.sample}

:   horizontal and vertical chroma subsample values. For example for the
    pixel format \"yuv422p\" `hsub`{.variable} is 2 and
    `vsub`{.variable} is 1.

`line_h, lh`{.sample}

:   the height of each text line

`main_h, h, H`{.sample}

:   the input height

`main_w, w, W`{.sample}

:   the input width

`max_glyph_a, ascent`{.sample}

:   the maximum distance from the baseline to the highest/upper grid
    coordinate used to place a glyph outline point, for all the rendered
    glyphs. It is a positive value, due to the grid's orientation with
    the Y axis upwards.

`max_glyph_d, descent`{.sample}

:   the maximum distance from the baseline to the lowest grid coordinate
    used to place a glyph outline point, for all the rendered glyphs.
    This is a negative value, due to the grid's orientation, with the Y
    axis upwards.

`max_glyph_h`{.sample}

:   maximum glyph height, that is the maximum height for all the glyphs
    contained in the rendered text, it is equivalent to
    `ascent`{.variable} - `descent`{.variable}.

`max_glyph_w`{.sample}

:   maximum glyph width, that is the maximum width for all the glyphs
    contained in the rendered text

`font_a`{.sample}

:   the ascent size defined in the font metrics

`font_d`{.sample}

:   the descent size defined in the font metrics

`top_a`{.sample}

:   the maximum ascender of the glyphs of the first text line

`bottom_d`{.sample}

:   the maximum descender of the glyphs of the last text line

`n`{.sample}

:   the number of input frame, starting from 0

`rand(min, max)`{.sample}

:   return a random number included between `min`{.variable} and
    `max`{.variable}

`sar`{.sample}

:   The input sample aspect ratio.

`t`{.sample}

:   timestamp expressed in seconds, NAN if the input timestamp is
    unknown

`text_h, th`{.sample}

:   the height of the rendered text

`text_w, tw`{.sample}

:   the width of the rendered text

`x`{.sample}\
`y`{.sample}

:   the x and y offset coordinates where the text is drawn.

    These parameters allow the `x`{.variable} and `y`{.variable}
    expressions to refer to each other, so you can for example specify
    `y=x/dar`.

`pict_type`{.sample}

:   A one character description of the current frame's picture type.

`pkt_pos`{.sample}

:   The current packet's position in the input file or stream (in bytes,
    from the start of the input). A value of -1 indicates this info is
    not available.

`duration`{.sample}

:   The current packet's duration, in seconds.

`pkt_size`{.sample}

:   The current packet's size (in bytes).

[]{#drawtext_005fexpansion}[]{#Text-expansion}

#### [39.75.2 Text expansion](#toc-Text-expansion) {#text-expansion .subsection}

If `expansion`{.sample} is set to `strftime`, the filter recognizes
sequences accepted by the `strftime` C function in the provided text and
expands them accordingly. Check the documentation of `strftime`. This
feature is deprecated in favor of `normal` expansion with the `gmtime`
or `localtime` expansion functions.

If `expansion`{.sample} is set to `none`, the text is printed verbatim.

If `expansion`{.sample} is set to `normal` (which is the default), the
following expansion mechanism is used.

The backslash character '`\`{.sample}', followed by any character,
always expands to the second character.

Sequences of the form `%{...}` are expanded. The text between the braces
is a function name, possibly followed by arguments separated by ':'. If
the arguments contain special characters or delimiters (':' or '}'),
they should be escaped.

Note that they probably must also be escaped as the value for the
`text`{.sample} option in the filter argument string and as the filter
argument in the filtergraph description, and possibly also for the
shell, that makes up to four levels of escaping; using a text file with
the `textfile`{.sample} option avoids these problems.

The following functions are available:

`expr, e`

:   The expression evaluation result.

    It must take one argument specifying the expression to be evaluated,
    which accepts the same constants and functions as the `x`{.variable}
    and `y`{.variable} values. Note that not all constants should be
    used, for example the text size is not known when evaluating the
    expression, so the constants `text_w`{.variable} and
    `text_h`{.variable} will have an undefined value.

`expr_int_format, eif`

:   Evaluate the expression's value and output as formatted integer.

    The first argument is the expression to be evaluated, just as for
    the `expr`{.variable} function. The second argument specifies the
    output format. Allowed values are '`x`{.sample}', '`X`{.sample}',
    '`d`{.sample}' and '`u`{.sample}'. They are treated exactly as in
    the `printf` function. The third parameter is optional and sets the
    number of positions taken by the output. It can be used to add
    padding with zeros from the left.

`gmtime`

:   The time at which the filter is running, expressed in UTC. It can
    accept an argument: a `strftime` C function format string. The
    format string is extended to support the variable
    `%[1-6]N`{.variable} which prints fractions of the second with
    optionally specified number of digits.

`localtime`

:   The time at which the filter is running, expressed in the local time
    zone. It can accept an argument: a `strftime` C function format
    string. The format string is extended to support the variable
    `%[1-6]N`{.variable} which prints fractions of the second with
    optionally specified number of digits.

`metadata`

:   Frame metadata. Takes one or two arguments.

    The first argument is mandatory and specifies the metadata key.

    The second argument is optional and specifies a default value, used
    when the metadata key is not found or empty.

    Available metadata can be identified by inspecting entries starting
    with TAG included within each frame section printed by running
    `ffprobe -show_frames`.

    String metadata generated in filters leading to the drawtext filter
    are also available.

`n, frame_num`

:   The frame number, starting from 0.

`pict_type`

:   A one character description of the current picture type.

`pts`

:   The timestamp of the current frame. It can take up to three
    arguments.

    The first argument is the format of the timestamp; it defaults to
    `flt` for seconds as a decimal number with microsecond accuracy;
    `hms` stands for a formatted `[-]HH:MM:SS.mmm`{.variable} timestamp
    with millisecond accuracy. `gmtime` stands for the timestamp of the
    frame formatted as UTC time; `localtime` stands for the timestamp of
    the frame formatted as local time zone time.

    The second argument is an offset added to the timestamp.

    If the format is set to `hms`, a third argument `24HH` may be
    supplied to present the hour part of the formatted timestamp in 24h
    format (00-23).

    If the format is set to `localtime` or `gmtime`, a third argument
    may be supplied: a `strftime` C function format string. By default,
    `YYYY-MM-DD HH:MM:SS`{.variable} format will be used.

[]{#Commands-88}

#### [39.75.3 Commands](#toc-Commands-88) {#commands-88 .subsection}

This filter supports altering parameters via commands:

`reinit`{.sample}

:   Alter existing filter parameters.

    Syntax for the argument is the same as for filter invocation, e.g.

    ::: example
    ``` example
    fontsize=56:fontcolor=green:text='Hello World'
    ```
    :::

    Full filter invocation with sendcmd would look like this:

    ::: example
    ``` example
    sendcmd=c='56.0 drawtext reinit fontsize=56\:fontcolor=green\:text=Hello\\ World'
    ```
    :::

    If the entire argument can't be parsed or applied as valid values
    then the filter will continue with its existing parameters.

The following options are also supported as [commands](#commands):

- x
- y
- alpha
- fontsize
- fontcolor
- boxcolor
- bordercolor
- shadowcolor
- box
- boxw
- boxh
- boxborderw
- line_spacing
- text_align
- shadowx
- shadowy
- borderw

[]{#Examples-115}

#### [39.75.4 Examples](#toc-Examples-115) {#examples-115 .subsection}

- Draw \"Test Text\" with font FreeSerif, using the default values for
  the optional parameters.

  ::: example
  ``` example
  drawtext="fontfile=/usr/share/fonts/truetype/freefont/FreeSerif.ttf: text='Test Text'"
  ```
  :::

- Draw 'Test Text' with font FreeSerif of size 24 at position x=100 and
  y=50 (counting from the top-left corner of the screen), text is yellow
  with a red box around it. Both the text and the box have an opacity of
  20%.

  ::: example
  ``` example
  drawtext="fontfile=/usr/share/fonts/truetype/freefont/FreeSerif.ttf: text='Test Text':\
            x=100: y=50: fontsize=24: fontcolor=yellow@0.2: box=1: boxcolor=red@0.2"
  ```
  :::

  Note that the double quotes are not necessary if spaces are not used
  within the parameter list.

- Show the text at the center of the video frame:

  ::: example
  ``` example
  drawtext="fontsize=30:fontfile=FreeSerif.ttf:text='hello world':x=(w-text_w)/2:y=(h-text_h)/2"
  ```
  :::

- Show the text at a random position, switching to a new position every
  30 seconds:

  ::: example
  ``` example
  drawtext="fontsize=30:fontfile=FreeSerif.ttf:text='hello world':x=if(eq(mod(t\,30)\,0)\,rand(0\,(w-text_w))\,x):y=if(eq(mod(t\,30)\,0)\,rand(0\,(h-text_h))\,y)"
  ```
  :::

- Show a text line sliding from right to left in the last row of the
  video frame. The file `LONG_LINE`{.sample} is assumed to contain a
  single line with no newlines.

  ::: example
  ``` example
  drawtext="fontsize=15:fontfile=FreeSerif.ttf:text=LONG_LINE:y=h-line_h:x=-50*t"
  ```
  :::

- Show the content of file `CREDITS`{.sample} off the bottom of the
  frame and scroll up.

  ::: example
  ``` example
  drawtext="fontsize=20:fontfile=FreeSerif.ttf:textfile=CREDITS:y=h-20*t"
  ```
  :::

- Draw a single green letter \"g\", at the center of the input video.
  The glyph baseline is placed at half screen height.

  ::: example
  ``` example
  drawtext="fontsize=60:fontfile=FreeSerif.ttf:fontcolor=green:text=g:x=(w-max_glyph_w)/2:y=h/2-ascent"
  ```
  :::

- Show text for 1 second every 3 seconds:

  ::: example
  ``` example
  drawtext="fontfile=FreeSerif.ttf:fontcolor=white:x=100:y=x/dar:enable=lt(mod(t\,3)\,1):text='blink'"
  ```
  :::

- Use fontconfig to set the font. Note that the colons need to be
  escaped.

  ::: example
  ``` example
  drawtext='fontfile=Linux Libertine O-40\\:style=Semibold:text=FFmpeg'
  ```
  :::

- Draw \"Test Text\" with font size dependent on height of the video.

  ::: example
  ``` example
  drawtext="text='Test Text': fontsize=h/30: x=(w-text_w)/2: y=(h-text_h*2)"
  ```
  :::

- Print the date of a real-time encoding (see documentation for the
  `strftime` C function):

  ::: example
  ``` example
  drawtext='fontfile=FreeSans.ttf:text=%{localtime\:%a %b %d %Y}'
  ```
  :::

- Show text fading in and out (appearing/disappearing):

  ::: example
  ``` example
  #!/bin/sh
  DS=1.0 # display start
  DE=10.0 # display end
  FID=1.5 # fade in duration
  FOD=5 # fade out duration
  ffplay -f lavfi "color,drawtext=text=TEST:fontsize=50:fontfile=FreeSerif.ttf:fontcolor_expr=ff0000%{eif\\\\: clip(255*(1*between(t\\, $DS + $FID\\, $DE - $FOD) + ((t - $DS)/$FID)*between(t\\, $DS\\, $DS + $FID) + (-(t - $DE)/$FOD)*between(t\\, $DE - $FOD\\, $DE) )\\, 0\\, 255) \\\\: x\\\\: 2 }"
  ```
  :::

- Horizontally align multiple separate texts. Note that
  `max_glyph_a`{.sample} and the `fontsize`{.sample} value are included
  in the `y`{.sample} offset.

  ::: example
  ``` example
  drawtext=fontfile=FreeSans.ttf:text=DOG:fontsize=24:x=10:y=20+24-max_glyph_a,
  drawtext=fontfile=FreeSans.ttf:text=cow:fontsize=24:x=80:y=20+24-max_glyph_a
  ```
  :::

- Plot special `lavf.image2dec.source_basename`{.variable} metadata onto
  each frame if such metadata exists. Otherwise, plot the string \"NA\".
  Note that image2 demuxer must have option
  `-export_path_metadata 1`{.sample} for the special metadata fields to
  be available for filters.

  ::: example
  ``` example
  drawtext="fontsize=20:fontcolor=white:fontfile=FreeSans.ttf:text='%{metadata\:lavf.image2dec.source_basename\:NA}':x=10:y=10"
  ```
  :::

For more information about libfreetype, check:
<http://www.freetype.org/>.

For more information about fontconfig, check:
<http://freedesktop.org/software/fontconfig/fontconfig-user.html>.

For more information about libfribidi, check: <http://fribidi.org/>.

For more information about libharfbuzz, check:
<https://github.com/harfbuzz/harfbuzz>.

[]{#drawvg}[]{#drawvg-1}

### [39.76 drawvg](#toc-drawvg-1) {#drawvg .section}

Draw vector graphics on top of video frames, by executing a script
written in a custom language called VGS (*Vector Graphics Script*).

The documentation for the language can be found in
[(drawvg-reference)drawvg - Language
Reference](drawvg-reference.html#Top). A version of this reference with
rendered examples can be found at the [author's
site](https://ayosec.github.io/ffmpeg-drawvg/playground/docs/langref.html).

Graphics are rendered using the [cario 2D graphics
library](https://cairographics.org/).

To enable compilation of this filter, you need to configure FFmpeg with
`--enable-cairo`.

[]{#Parameters}

#### [39.76.1 Parameters](#toc-Parameters) {#parameters .subsection}

Either `script` or `file` must be set.

`s, script`{.sample}

:   Script source to draw the graphics.

`file`{.sample}

:   Path of the file to load the script source.

[]{#Pixel-Formats}

#### [39.76.2 Pixel Formats](#toc-Pixel-Formats) {#pixel-formats .subsection}

Since Cairo only supports RGB images, if the input video is something
else (like YUV 4:2:0), before executing the script the video is
converted to a format compatible with Cairo. Then, you have to use
either the [format](#format) filter, or the `-pix_fmt` option, to
convert it to the expected format in the output.

[]{#Examples-116}

#### [39.76.3 Examples](#toc-Examples-116) {#examples-116 .subsection}

- Draw the outline of an ellipse.

  ::: example
  ``` example
  ffmpeg -i input.webm \
      -vf 'drawvg=ellipse (w/2) (h/2) (w/3) (h/3) stroke' \
      -pix_fmt yuv420p \
      output.webm
  ```
  :::

- Draw a square rotating in the middle of the frame.

  The script for drawvg is in a file `draw.vgs`:

  ::: example
  ``` example
  translate (w/2) (h/2)
  rotate t
  rect -100 -100 200 200
  setcolor red@0.5
  fill
  ```
  :::

  Then:

  ::: example
  ``` example
  ffmpeg -i input.webm -vf 'drawvg=file=draw.vgs,format=yuv420p' output.webm
  ```
  :::

[]{#edgedetect}

### [39.77 edgedetect](#toc-edgedetect) {#edgedetect .section}

Detect and draw edges. The filter uses the Canny Edge Detection
algorithm.

The filter accepts the following options:

`low`{.sample}\
`high`{.sample}

:   Set low and high threshold values used by the Canny thresholding
    algorithm.

    The high threshold selects the \"strong\" edge pixels, which are
    then connected through 8-connectivity with the \"weak\" edge pixels
    selected by the low threshold.

    `low`{.variable} and `high`{.variable} threshold values must be
    chosen in the range \[0,1\], and `low`{.variable} should be lesser
    or equal to `high`{.variable}.

    Default value for `low`{.variable} is `20/255`, and default value
    for `high`{.variable} is `50/255`.

`mode`{.sample}

:   Define the drawing mode.

    '`wires`{.sample}'

    :   Draw white/gray wires on black background.

    '`colormix`{.sample}'

    :   Mix the colors to create a paint/cartoon effect.

    '`canny`{.sample}'

    :   Apply Canny edge detector on all selected planes.

    Default value is `wires`{.variable}.

`planes`{.sample}

:   Select planes for filtering. By default all available planes are
    filtered.

[]{#Examples-117}

#### [39.77.1 Examples](#toc-Examples-117) {#examples-117 .subsection}

- Standard edge detection with custom values for the hysteresis
  thresholding:

  ::: example
  ``` example
  edgedetect=low=0.1:high=0.4
  ```
  :::
- Painting effect without thresholding:

  ::: example
  ``` example
  edgedetect=mode=colormix:high=0
  ```
  :::

[]{#elbg}

### [39.78 elbg](#toc-elbg) {#elbg .section}

Apply a posterize effect using the ELBG (Enhanced LBG) algorithm.

For each input image, the filter will compute the optimal mapping from
the input to the output given the codebook length, that is the number of
distinct output colors.

This filter accepts the following options.

`codebook_length, l`{.sample}

:   Set codebook length. The value must be a positive integer, and
    represents the number of distinct output colors. Default value is
    256.

`nb_steps, n`{.sample}

:   Set the maximum number of iterations to apply for computing the
    optimal mapping. The higher the value the better the result and the
    higher the computation time. Default value is 1.

`seed, s`{.sample}

:   Set a random seed, must be an integer included between 0 and
    UINT32_MAX. If not specified, or if explicitly set to -1, the filter
    will try to use a good random seed on a best effort basis.

`pal8`{.sample}

:   Set pal8 output pixel format. This option does not work with
    codebook length greater than 256. Default is disabled.

`use_alpha`{.sample}

:   Include alpha values in the quantization calculation. Allows
    creating palettized output images (e.g. PNG8) with multiple alpha
    smooth blending.

[]{#entropy}

### [39.79 entropy](#toc-entropy) {#entropy .section}

Measure graylevel entropy in histogram of color channels of video
frames.

It accepts the following parameters:

`mode`{.sample}

:   Can be either `normal`{.variable} or `diff`{.variable}. Default is
    `normal`{.variable}.

    `diff`{.variable} mode measures entropy of histogram delta values,
    absolute differences between neighbour histogram values.

[]{#epx}

### [39.80 epx](#toc-epx) {#epx .section}

Apply the EPX magnification filter which is designed for pixel art.

It accepts the following option:

`n`{.sample}

:   Set the scaling dimension: `2` for `2xEPX`, `3` for `3xEPX`. Default
    is `3`.

[]{#eq}

### [39.81 eq](#toc-eq) {#eq .section}

Set brightness, contrast, saturation and approximate gamma adjustment.

The filter accepts the following options:

`contrast`{.sample}

:   Set the contrast expression. The value must be a float value in
    range `-1000.0` to `1000.0`. The default value is \"1\".

`brightness`{.sample}

:   Set the brightness expression. The value must be a float value in
    range `-1.0` to `1.0`. The default value is \"0\".

`saturation`{.sample}

:   Set the saturation expression. The value must be a float in range
    `0.0` to `3.0`. The default value is \"1\".

`gamma`{.sample}

:   Set the gamma expression. The value must be a float in range `0.1`
    to `10.0`. The default value is \"1\".

`gamma_r`{.sample}

:   Set the gamma expression for red. The value must be a float in range
    `0.1` to `10.0`. The default value is \"1\".

`gamma_g`{.sample}

:   Set the gamma expression for green. The value must be a float in
    range `0.1` to `10.0`. The default value is \"1\".

`gamma_b`{.sample}

:   Set the gamma expression for blue. The value must be a float in
    range `0.1` to `10.0`. The default value is \"1\".

`gamma_weight`{.sample}

:   Set the gamma weight expression. It can be used to reduce the effect
    of a high gamma value on bright image areas, e.g. keep them from
    getting overamplified and just plain white. The value must be a
    float in range `0.0` to `1.0`. A value of `0.0` turns the gamma
    correction all the way down while `1.0` leaves it at its full
    strength. Default is \"1\".

`eval`{.sample}

:   Set when the expressions for brightness, contrast, saturation and
    gamma expressions are evaluated.

    It accepts the following values:

    '`init`{.sample}'

    :   only evaluate expressions once during the filter initialization
        or when a command is processed

    '`frame`{.sample}'

    :   evaluate expressions for each incoming frame

    Default value is '`init`{.sample}'.

The expressions accept the following parameters:

`n`{.sample}

:   frame count of the input frame starting from 0

`pos`{.sample}

:   byte position of the corresponding packet in the input file, NAN if
    unspecified; deprecated, do not use

`r`{.sample}

:   frame rate of the input video, NAN if the input frame rate is
    unknown

`t`{.sample}

:   timestamp expressed in seconds, NAN if the input timestamp is
    unknown

[]{#Commands-89}

#### [39.81.1 Commands](#toc-Commands-89) {#commands-89 .subsection}

The filter supports the following commands:

`contrast`{.sample}

:   Set the contrast expression.

`brightness`{.sample}

:   Set the brightness expression.

`saturation`{.sample}

:   Set the saturation expression.

`gamma`{.sample}

:   Set the gamma expression.

`gamma_r`{.sample}

:   Set the gamma_r expression.

`gamma_g`{.sample}

:   Set gamma_g expression.

`gamma_b`{.sample}

:   Set gamma_b expression.

`gamma_weight`{.sample}

:   Set gamma_weight expression.

    The command accepts the same syntax of the corresponding option.

    If the specified expression is not valid, it is kept at its current
    value.

[]{#erosion}[]{#erosion-1}

### [39.82 erosion](#toc-erosion-1) {#erosion .section}

Apply erosion effect to the video.

This filter replaces the pixel by the local(3x3) minimum.

It accepts the following options:

`threshold0`{.sample}\
`threshold1`{.sample}\
`threshold2`{.sample}\
`threshold3`{.sample}

:   Limit the maximum change for each plane, default is 65535. If 0,
    plane will remain unchanged.

`coordinates`{.sample}

:   Flag which specifies the pixel to refer to. Default is 255 i.e. all
    eight pixels are used.

    Flags to local 3x3 coordinates maps like this:

    1 2 3 4 5 6 7 8

[]{#Commands-90}

#### [39.82.1 Commands](#toc-Commands-90) {#commands-90 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#estdif}

### [39.83 estdif](#toc-estdif) {#estdif .section}

Deinterlace the input video (\"estdif\" stands for \"Edge Slope Tracing
Deinterlacing Filter\").

Spatial only filter that uses edge slope tracing algorithm to
interpolate missing lines. It accepts the following parameters:

`mode`{.sample}

:   The interlacing mode to adopt. It accepts one of the following
    values:

    `frame`{.sample}

    :   Output one frame for each frame.

    `field`{.sample}

    :   Output one frame for each field.

    The default value is `field`.

`parity`{.sample}

:   The picture field parity assumed for the input interlaced video. It
    accepts one of the following values:

    `tff`{.sample}

    :   Assume the top field is first.

    `bff`{.sample}

    :   Assume the bottom field is first.

    `auto`{.sample}

    :   Enable automatic detection of field parity.

    The default value is `auto`. If the interlacing is unknown or the
    decoder does not export this information, top field first will be
    assumed.

`deint`{.sample}

:   Specify which frames to deinterlace. Accepts one of the following
    values:

    `all`{.sample}

    :   Deinterlace all frames.

    `interlaced`{.sample}

    :   Only deinterlace frames marked as interlaced.

    The default value is `all`.

`rslope`{.sample}

:   Specify the search radius for edge slope tracing. Default value
    is 1. Allowed range is from 1 to 15.

`redge`{.sample}

:   Specify the search radius for best edge matching. Default value
    is 2. Allowed range is from 0 to 15.

`ecost`{.sample}

:   Specify the edge cost for edge matching. Default value is 2. Allowed
    range is from 0 to 50.

`mcost`{.sample}

:   Specify the middle cost for edge matching. Default value is 1.
    Allowed range is from 0 to 50.

`dcost`{.sample}

:   Specify the distance cost for edge matching. Default value is 1.
    Allowed range is from 0 to 50.

`interp`{.sample}

:   Specify the interpolation used. Default is 4-point interpolation. It
    accepts one of the following values:

    `2p`{.sample}

    :   Two-point interpolation.

    `4p`{.sample}

    :   Four-point interpolation.

    `6p`{.sample}

    :   Six-point interpolation.

[]{#Commands-91}

#### [39.83.1 Commands](#toc-Commands-91) {#commands-91 .subsection}

This filter supports same [commands](#commands) as options.

[]{#exposure}

### [39.84 exposure](#toc-exposure) {#exposure .section}

Adjust exposure of the video stream.

The filter accepts the following options:

`exposure`{.sample}

:   Set the exposure correction in EV. Allowed range is from -3.0 to 3.0
    EV Default value is 0 EV.

`black`{.sample}

:   Set the black level correction. Allowed range is from -1.0 to 1.0.
    Default value is 0.

[]{#Commands-92}

#### [39.84.1 Commands](#toc-Commands-92) {#commands-92 .subsection}

This filter supports same [commands](#commands) as options.

[]{#extractplanes}

### [39.85 extractplanes](#toc-extractplanes) {#extractplanes .section}

Extract color channel components from input video stream into separate
grayscale video streams.

The filter accepts the following option:

`planes`{.sample}

Set plane(s) to extract.

Available values for planes are:

'`y`{.sample}'

'`u`{.sample}'

'`v`{.sample}'

'`a`{.sample}'

'`r`{.sample}'

'`g`{.sample}'

'`b`{.sample}'

Choosing planes not available in the input will result in an error. That
means you cannot select `r`, `g`, `b` planes with `y`, `u`, `v` planes
at same time.

[]{#Examples-118}

#### [39.85.1 Examples](#toc-Examples-118) {#examples-118 .subsection}

- Extract luma, u and v color channel component from input video frame
  into 3 grayscale outputs:

  ::: example
  ``` example
  ffmpeg -i video.avi -filter_complex 'extractplanes=y+u+v[y][u][v]' -map '[y]' y.avi -map '[u]' u.avi -map '[v]' v.avi
  ```
  :::

[]{#fade}

### [39.86 fade](#toc-fade) {#fade .section}

Apply a fade-in/out effect to the input video.

It accepts the following parameters:

`type, t`{.sample}

:   The effect type can be either \"in\" for a fade-in, or \"out\" for a
    fade-out effect. Default is `in`.

`start_frame, s`{.sample}

:   Specify the number of the frame to start applying the fade effect
    at. Default is 0.

`nb_frames, n`{.sample}

:   The number of frames that the fade effect lasts. At the end of the
    fade-in effect, the output video will have the same intensity as the
    input video. At the end of the fade-out transition, the output video
    will be filled with the selected `color`{.sample}. Default is 25.

`alpha`{.sample}

:   If set to 1, fade only alpha channel, if one exists on the input.
    Default value is 0.

`start_time, st`{.sample}

:   Specify the timestamp (in seconds) of the frame to start to apply
    the fade effect. If both start_frame and start_time are specified,
    the fade will start at whichever comes last. Default is 0.

`duration, d`{.sample}

:   The number of seconds for which the fade effect has to last. At the
    end of the fade-in effect the output video will have the same
    intensity as the input video, at the end of the fade-out transition
    the output video will be filled with the selected `color`{.sample}.
    If both duration and nb_frames are specified, duration is used.
    Default is 0 (nb_frames is used by default).

`color, c`{.sample}

:   Specify the color of the fade. Default is \"black\".

[]{#Examples-119}

#### [39.86.1 Examples](#toc-Examples-119) {#examples-119 .subsection}

- Fade in the first 30 frames of video:

  ::: example
  ``` example
  fade=in:0:30
  ```
  :::

  The command above is equivalent to:

  ::: example
  ``` example
  fade=t=in:s=0:n=30
  ```
  :::

- Fade out the last 45 frames of a 200-frame video:

  ::: example
  ``` example
  fade=out:155:45
  fade=type=out:start_frame=155:nb_frames=45
  ```
  :::

- Fade in the first 25 frames and fade out the last 25 frames of a
  1000-frame video:

  ::: example
  ``` example
  fade=in:0:25, fade=out:975:25
  ```
  :::

- Make the first 5 frames yellow, then fade in from frame 5-24:

  ::: example
  ``` example
  fade=in:5:20:color=yellow
  ```
  :::

- Fade in alpha over first 25 frames of video:

  ::: example
  ``` example
  fade=in:0:25:alpha=1
  ```
  :::

- Make the first 5.5 seconds black, then fade in for 0.5 seconds:

  ::: example
  ``` example
  fade=t=in:st=5.5:d=0.5
  ```
  :::

[]{#feedback}

### [39.87 feedback](#toc-feedback) {#feedback .section}

Apply feedback video filter.

This filter pass cropped input frames to 2nd output. From there it can
be filtered with other video filters. After filter receives frame from
2nd input, that frame is combined on top of original frame from 1st
input and passed to 1st output.

The typical usage is filter only part of frame.

The filter accepts the following options:

`x`{.sample}\
`y`{.sample}

:   Set the top left crop position.

`w`{.sample}\
`h`{.sample}

:   Set the crop size.

[]{#Examples-120}

#### [39.87.1 Examples](#toc-Examples-120) {#examples-120 .subsection}

- Blur only top left rectangular part of video frame size 100x100 with
  gblur filter.

  ::: example
  ``` example
  [in][blurin]feedback=x=0:y=0:w=100:h=100[out][blurout];[blurout]gblur=8[blurin]
  ```
  :::
- Draw black box on top left part of video frame of size 100x100 with
  drawbox filter.

  ::: example
  ``` example
  [in][blurin]feedback=x=0:y=0:w=100:h=100[out][blurout];[blurout]drawbox=x=0:y=0:w=100:h=100:t=100[blurin]
  ```
  :::
- Pixelize rectangular part of video frame of size 100x100 with pixelize
  filter.

  ::: example
  ``` example
  [in][blurin]feedback=x=320:y=240:w=100:h=100[out][blurout];[blurout]pixelize[blurin]
  ```
  :::

[]{#fftdnoiz}

### [39.88 fftdnoiz](#toc-fftdnoiz) {#fftdnoiz .section}

Denoise frames using 3D FFT (frequency domain filtering).

The filter accepts the following options:

`sigma`{.sample}

:   Set the noise sigma constant. This sets denoising strength. Default
    value is 1. Allowed range is from 0 to 30. Using very high sigma
    with low overlap may give blocking artifacts.

`amount`{.sample}

:   Set amount of denoising. By default all detected noise is reduced.
    Default value is 1. Allowed range is from 0 to 1.

`block`{.sample}

:   Set size of block in pixels, Default is 32, can be 8 to 256.

`overlap`{.sample}

:   Set block overlap. Default is 0.5. Allowed range is from 0.2 to 0.8.

`method`{.sample}

:   Set denoising method. Default is `wiener`, can also be `hard`.

`prev`{.sample}

:   Set number of previous frames to use for denoising. By default is
    set to 0.

`next`{.sample}

:   Set number of next frames to to use for denoising. By default is set
    to 0.

`planes`{.sample}

:   Set planes which will be filtered, by default are all available
    filtered except alpha.

[]{#fftfilt}

### [39.89 fftfilt](#toc-fftfilt) {#fftfilt .section}

Apply arbitrary expressions to samples in frequency domain

`dc_Y`{.sample}

:   Adjust the dc value (gain) of the luma plane of the image. The
    filter accepts an integer value in range `0` to `1000`. The default
    value is set to `0`.

`dc_U`{.sample}

:   Adjust the dc value (gain) of the 1st chroma plane of the image. The
    filter accepts an integer value in range `0` to `1000`. The default
    value is set to `0`.

`dc_V`{.sample}

:   Adjust the dc value (gain) of the 2nd chroma plane of the image. The
    filter accepts an integer value in range `0` to `1000`. The default
    value is set to `0`.

`weight_Y`{.sample}

:   Set the frequency domain weight expression for the luma plane.

`weight_U`{.sample}

:   Set the frequency domain weight expression for the 1st chroma plane.

`weight_V`{.sample}

:   Set the frequency domain weight expression for the 2nd chroma plane.

`eval`{.sample}

:   Set when the expressions are evaluated.

    It accepts the following values:

    '`init`{.sample}'

    :   Only evaluate expressions once during the filter initialization.

    '`frame`{.sample}'

    :   Evaluate expressions for each incoming frame.

    Default value is '`init`{.sample}'.

    The filter accepts the following variables:

`X`{.sample}\
`Y`{.sample}

:   The coordinates of the current sample.

`W`{.sample}\
`H`{.sample}

:   The width and height of the image.

`N`{.sample}

:   The number of input frame, starting from 0.

`WS`{.sample}\
`HS`{.sample}

:   The size of FFT array for horizontal and vertical processing.

[]{#Examples-121}

#### [39.89.1 Examples](#toc-Examples-121) {#examples-121 .subsection}

- High-pass:

  ::: example
  ``` example
  fftfilt=dc_Y=128:weight_Y='squish(1-(Y+X)/100)'
  ```
  :::
- Low-pass:

  ::: example
  ``` example
  fftfilt=dc_Y=0:weight_Y='squish((Y+X)/100-1)'
  ```
  :::
- Sharpen:

  ::: example
  ``` example
  fftfilt=dc_Y=0:weight_Y='1+squish(1-(Y+X)/100)'
  ```
  :::
- Blur:

  ::: example
  ``` example
  fftfilt=dc_Y=0:weight_Y='exp(-4 * ((Y+X)/(W+H)))'
  ```
  :::

[]{#field}

### [39.90 field](#toc-field) {#field .section}

Extract a single field from an interlaced image using stride arithmetic
to avoid wasting CPU time. The output frames are marked as
non-interlaced.

The filter accepts the following options:

`type`{.sample}

:   Specify whether to extract the top (if the value is `0` or `top`) or
    the bottom field (if the value is `1` or `bottom`).

[]{#fieldhint}

### [39.91 fieldhint](#toc-fieldhint) {#fieldhint .section}

Create new frames by copying the top and bottom fields from surrounding
frames supplied as numbers by the hint file.

`hint`{.sample}

:   Set file containing hints: absolute/relative frame numbers.

    There must be one line for each frame in a clip. Each line must
    contain two numbers separated by the comma, optionally followed by
    `-` or `+`. Numbers supplied on each line of file can not be out of
    \[N-1,N+1\] where N is current frame number for `absolute` mode or
    out of \[-1, 1\] range for `relative` mode. First number tells from
    which frame to pick up top field and second number tells from which
    frame to pick up bottom field.

    If optionally followed by `+` output frame will be marked as
    interlaced, else if followed by `-` output frame will be marked as
    progressive, else it will be marked same as input frame. If
    optionally followed by `t` output frame will use only top field, or
    in case of `b` it will use only bottom field. If line starts with
    `#` or `;` that line is skipped.

`mode`{.sample}

:   Can be item `absolute` or `relative` or `pattern`. Default is
    `absolute`. The `pattern` mode is same as `relative` mode, except at
    last entry of file if there are more frames to process than `hint`
    file is seek back to start.

Example of first several lines of `hint` file for `relative` mode:

::: example
``` example
0,0 - # first frame
1,0 - # second frame, use third's frame top field and second's frame bottom field
1,0 - # third frame, use fourth's frame top field and third's frame bottom field
1,0 -
0,0 -
0,0 -
1,0 -
1,0 -
1,0 -
0,0 -
0,0 -
1,0 -
1,0 -
1,0 -
0,0 -
```
:::

[]{#fieldmatch}

### [39.92 fieldmatch](#toc-fieldmatch) {#fieldmatch .section}

Field matching filter for inverse telecine. It is meant to reconstruct
the progressive frames from a telecined stream. The filter does not drop
duplicated frames, so to achieve a complete inverse telecine
`fieldmatch` needs to be followed by a decimation filter such as
[decimate](#decimate) in the filtergraph.

The separation of the field matching and the decimation is notably
motivated by the possibility of inserting a de-interlacing filter
fallback between the two. If the source has mixed telecined and real
interlaced content, `fieldmatch` will not be able to match fields for
the interlaced parts. But these remaining combed frames will be marked
as interlaced, and thus can be de-interlaced by a later filter such as
[yadif](#yadif) before decimation.

In addition to the various configuration options, `fieldmatch` can take
an optional second stream, activated through the `ppsrc`{.sample}
option. If enabled, the frames reconstruction will be based on the
fields and frames from this second stream. This allows the first input
to be pre-processed in order to help the various algorithms of the
filter, while keeping the output lossless (assuming the fields are
matched properly). Typically, a field-aware denoiser, or
brightness/contrast adjustments can help.

Note that this filter uses the same algorithms as TIVTC/TFM (AviSynth
project) and VIVTC/VFM (VapourSynth project). The later is a light clone
of TFM from which `fieldmatch` is based on. While the semantic and usage
are very close, some behaviour and options names can differ.

The [decimate](#decimate) filter currently only works for constant frame
rate input. If your input has mixed telecined (30fps) and progressive
content with a lower framerate like 24fps use the following filterchain
to produce the necessary cfr stream:
`dejudder,fps=30000/1001,fieldmatch,decimate`.

The filter accepts the following options:

`order`{.sample}

:   Specify the assumed field order of the input stream. Available
    values are:

    '`auto`{.sample}'

    :   Auto detect parity (use FFmpeg's internal parity value).

    '`bff`{.sample}'

    :   Assume bottom field first.

    '`tff`{.sample}'

    :   Assume top field first.

    Note that it is sometimes recommended not to trust the parity
    announced by the stream.

    Default value is `auto`{.variable}.

`mode`{.sample}

:   Set the matching mode or strategy to use. `pc`{.sample} mode is the
    safest in the sense that it won't risk creating jerkiness due to
    duplicate frames when possible, but if there are bad edits or
    blended fields it will end up outputting combed frames when a good
    match might actually exist. On the other hand, `pcn_ub`{.sample}
    mode is the most risky in terms of creating jerkiness, but will
    almost always find a good frame if there is one. The other values
    are all somewhere in between `pc`{.sample} and `pcn_ub`{.sample} in
    terms of risking jerkiness and creating duplicate frames versus
    finding good matches in sections with bad edits, orphaned fields,
    blended fields, etc.

    More details about p/c/n/u/b are available in [p/c/n/u/b
    meaning](#p_002fc_002fn_002fu_002fb-meaning) section.

    Available values are:

    '`pc`{.sample}'

    :   2-way matching (p/c)

    '`pc_n`{.sample}'

    :   2-way matching, and trying 3rd match if still combed (p/c + n)

    '`pc_u`{.sample}'

    :   2-way matching, and trying 3rd match (same order) if still
        combed (p/c + u)

    '`pc_n_ub`{.sample}'

    :   2-way matching, trying 3rd match if still combed, and trying
        4th/5th matches if still combed (p/c + n + u/b)

    '`pcn`{.sample}'

    :   3-way matching (p/c/n)

    '`pcn_ub`{.sample}'

    :   3-way matching, and trying 4th/5th matches if all 3 of the
        original matches are detected as combed (p/c/n + u/b)

    The parenthesis at the end indicate the matches that would be used
    for that mode assuming `order`{.sample}=`tff`{.variable} (and
    `field`{.sample} on `auto`{.variable} or `top`{.variable}).

    In terms of speed `pc`{.sample} mode is by far the fastest and
    `pcn_ub`{.sample} is the slowest.

    Default value is `pc_n`{.variable}.

`ppsrc`{.sample}

:   Mark the main input stream as a pre-processed input, and enable the
    secondary input stream as the clean source to pick the fields from.
    See the filter introduction for more details. It is similar to the
    `clip2`{.sample} feature from VFM/TFM.

    Default value is `0` (disabled).

`field`{.sample}

:   Set the field to match from. It is recommended to set this to the
    same value as `order`{.sample} unless you experience matching
    failures with that setting. In certain circumstances changing the
    field that is used to match from can have a large impact on matching
    performance. Available values are:

    '`auto`{.sample}'

    :   Automatic (same value as `order`{.sample}).

    '`bottom`{.sample}'

    :   Match from the bottom field.

    '`top`{.sample}'

    :   Match from the top field.

    Default value is `auto`{.variable}.

`mchroma`{.sample}

:   Set whether or not chroma is included during the match comparisons.
    In most cases it is recommended to leave this enabled. You should
    set this to `0` only if your clip has bad chroma problems such as
    heavy rainbowing or other artifacts. Setting this to `0` could also
    be used to speed things up at the cost of some accuracy.

    Default value is `1`.

`y0`{.sample}\
`y1`{.sample}

:   These define an exclusion band which excludes the lines between
    `y0`{.sample} and `y1`{.sample} from being included in the field
    matching decision. An exclusion band can be used to ignore
    subtitles, a logo, or other things that may interfere with the
    matching. `y0`{.sample} sets the starting scan line and
    `y1`{.sample} sets the ending line; all lines in between
    `y0`{.sample} and `y1`{.sample} (including `y0`{.sample} and
    `y1`{.sample}) will be ignored. Setting `y0`{.sample} and
    `y1`{.sample} to the same value will disable the feature.
    `y0`{.sample} and `y1`{.sample} defaults to `0`.

`scthresh`{.sample}

:   Set the scene change detection threshold as a percentage of maximum
    change on the luma plane. Good values are in the `[8.0, 14.0]`
    range. Scene change detection is only relevant in case
    `combmatch`{.sample}=`sc`{.variable}. The range for
    `scthresh`{.sample} is `[0.0, 100.0]`.

    Default value is `12.0`.

`combmatch`{.sample}

:   When `combatch`{.sample} is not `none`{.variable}, `fieldmatch` will
    take into account the combed scores of matches when deciding what
    match to use as the final match. Available values are:

    '`none`{.sample}'

    :   No final matching based on combed scores.

    '`sc`{.sample}'

    :   Combed scores are only used when a scene change is detected.

    '`full`{.sample}'

    :   Use combed scores all the time.

    Default is `sc`{.variable}.

`combdbg`{.sample}

:   Force `fieldmatch` to calculate the combed metrics for certain
    matches and print them. This setting is known as `micout`{.sample}
    in TFM/VFM vocabulary. Available values are:

    '`none`{.sample}'

    :   No forced calculation.

    '`pcn`{.sample}'

    :   Force p/c/n calculations.

    '`pcnub`{.sample}'

    :   Force p/c/n/u/b calculations.

    Default value is `none`{.variable}.

`cthresh`{.sample}

:   This is the area combing threshold used for combed frame detection.
    This essentially controls how \"strong\" or \"visible\" combing must
    be to be detected. Larger values mean combing must be more visible
    and smaller values mean combing can be less visible or strong and
    still be detected. Valid settings are from `-1` (every pixel will be
    detected as combed) to `255` (no pixel will be detected as combed).
    This is basically a pixel difference value. A good range is
    `[8, 12]`.

    Default value is `9`.

`chroma`{.sample}

:   Sets whether or not chroma is considered in the combed frame
    decision. Only disable this if your source has chroma problems
    (rainbowing, etc.) that are causing problems for the combed frame
    detection with chroma enabled. Actually, using
    `chroma`{.sample}=`0`{.variable} is usually more reliable, except
    for the case where there is chroma only combing in the source.

    Default value is `0`.

`blockx`{.sample}\
`blocky`{.sample}

:   Respectively set the x-axis and y-axis size of the window used
    during combed frame detection. This has to do with the size of the
    area in which `combpel`{.sample} pixels are required to be detected
    as combed for a frame to be declared combed. See the
    `combpel`{.sample} parameter description for more info. Possible
    values are any number that is a power of 2 starting at 4 and going
    up to 512.

    Default value is `16`.

`combpel`{.sample}

:   The number of combed pixels inside any of the `blocky`{.sample} by
    `blockx`{.sample} size blocks on the frame for the frame to be
    detected as combed. While `cthresh`{.sample} controls how
    \"visible\" the combing must be, this setting controls \"how much\"
    combing there must be in any localized area (a window defined by the
    `blockx`{.sample} and `blocky`{.sample} settings) on the frame.
    Minimum value is `0` and maximum is `blocky x blockx` (at which
    point no frames will ever be detected as combed). This setting is
    known as `MI`{.sample} in TFM/VFM vocabulary.

    Default value is `80`.

[]{#p_002fc_002fn_002fu_002fb-meaning}[]{#p_002fc_002fn_002fu_002fb-meaning-1}

#### [39.92.1 p/c/n/u/b meaning](#toc-p_002fc_002fn_002fu_002fb-meaning-1) {#pcnub-meaning .subsection}

[]{#p_002fc_002fn}

#### [39.92.1.1 p/c/n](#toc-p_002fc_002fn) {#pcn .subsubsection}

We assume the following telecined stream:

::: example
``` example
Top fields:     1 2 2 3 4
Bottom fields:  1 2 3 4 4
```
:::

The numbers correspond to the progressive frame the fields relate to.
Here, the first two frames are progressive, the 3rd and 4th are combed,
and so on.

When `fieldmatch` is configured to run a matching from bottom
(`field`{.sample}=`bottom`{.variable}) this is how this input stream get
transformed:

::: example
``` example
Input stream:
                T     1 2 2 3 4
                B     1 2 3 4 4   <-- matching reference

Matches:              c c n n c

Output stream:
                T     1 2 3 4 4
                B     1 2 3 4 4
```
:::

As a result of the field matching, we can see that some frames get
duplicated. To perform a complete inverse telecine, you need to rely on
a decimation filter after this operation. See for instance the
[decimate](#decimate) filter.

The same operation now matching from top fields
(`field`{.sample}=`top`{.variable}) looks like this:

::: example
``` example
Input stream:
                T     1 2 2 3 4   <-- matching reference
                B     1 2 3 4 4

Matches:              c c p p c

Output stream:
                T     1 2 2 3 4
                B     1 2 2 3 4
```
:::

In these examples, we can see what `p`{.variable}, `c`{.variable} and
`n`{.variable} mean; basically, they refer to the frame and field of the
opposite parity:

- `p`{.variable} matches the field of the opposite parity in the
  previous frame
- `c`{.variable} matches the field of the opposite parity in the current
  frame
- `n`{.variable} matches the field of the opposite parity in the next
  frame

[]{#u_002fb}

#### [39.92.1.2 u/b](#toc-u_002fb) {#ub .subsubsection}

The `u`{.variable} and `b`{.variable} matching are a bit special in the
sense that they match from the opposite parity flag. In the following
examples, we assume that we are currently matching the 2nd frame (Top:2,
bottom:2). According to the match, a 'x' is placed above and below each
matched fields.

With bottom matching (`field`{.sample}=`bottom`{.variable}):

::: example
``` example
Match:           c         p           n          b          u

                 x       x               x        x          x
  Top          1 2 2     1 2 2       1 2 2      1 2 2      1 2 2
  Bottom       1 2 3     1 2 3       1 2 3      1 2 3      1 2 3
                 x         x           x        x              x

Output frames:
                 2          1          2          2          2
                 2          2          2          1          3
```
:::

With top matching (`field`{.sample}=`top`{.variable}):

::: example
``` example
Match:           c         p           n          b          u

                 x         x           x        x              x
  Top          1 2 2     1 2 2       1 2 2      1 2 2      1 2 2
  Bottom       1 2 3     1 2 3       1 2 3      1 2 3      1 2 3
                 x       x               x        x          x

Output frames:
                 2          2          2          1          2
                 2          1          3          2          2
```
:::

[]{#Examples-122}

#### [39.92.2 Examples](#toc-Examples-122) {#examples-122 .subsection}

Simple IVTC of a top field first telecined stream:

::: example
``` example
fieldmatch=order=tff:combmatch=none, decimate
```
:::

Advanced IVTC, with fallback on [yadif](#yadif) for still combed frames:

::: example
``` example
fieldmatch=order=tff:combmatch=full, yadif=deint=interlaced, decimate
```
:::

[]{#fieldorder}

### [39.93 fieldorder](#toc-fieldorder) {#fieldorder .section}

Transform the field order of the input video.

It accepts the following parameters:

`order`{.sample}

:   The output field order. Valid values are `tff`{.variable} for top
    field first or `bff`{.variable} for bottom field first.

The default value is '`tff`{.sample}'.

The transformation is done by shifting the picture content up or down by
one line, and filling the remaining line with appropriate picture
content. This method is consistent with most broadcast field order
converters.

If the input video is not flagged as being interlaced, or it is already
flagged as being of the required output field order, then this filter
does not alter the incoming video.

It is very useful when converting to or from PAL DV material, which is
bottom field first.

For example:

::: example
``` example
ffmpeg -i in.vob -vf "fieldorder=bff" out.dv
```
:::

[]{#fillborders}

### [39.94 fillborders](#toc-fillborders) {#fillborders .section}

Fill borders of the input video, without changing video stream
dimensions. Sometimes video can have garbage at the four edges and you
may not want to crop video input to keep size multiple of some number.

This filter accepts the following options:

`left`{.sample}

:   Number of pixels to fill from left border.

`right`{.sample}

:   Number of pixels to fill from right border.

`top`{.sample}

:   Number of pixels to fill from top border.

`bottom`{.sample}

:   Number of pixels to fill from bottom border.

`mode`{.sample}

:   Set fill mode.

    It accepts the following values:

    '`smear`{.sample}'

    :   fill pixels using outermost pixels

    '`mirror`{.sample}'

    :   fill pixels using mirroring (half sample symmetric)

    '`fixed`{.sample}'

    :   fill pixels with constant value

    '`reflect`{.sample}'

    :   fill pixels using reflecting (whole sample symmetric)

    '`wrap`{.sample}'

    :   fill pixels using wrapping

    '`fade`{.sample}'

    :   fade pixels to constant value

    '`margins`{.sample}'

    :   fill pixels at top and bottom with weighted averages pixels near
        borders

    Default is `smear`{.variable}.

`color`{.sample}

:   Set color for pixels in fixed or fade mode. Default is
    `black`{.variable}.

[]{#Commands-93}

#### [39.94.1 Commands](#toc-Commands-93) {#commands-93 .subsection}

This filter supports same [commands](#commands) as options. The command
accepts the same syntax of the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#find_005frect}

### [39.95 find_rect](#toc-find_005frect) {#find_rect .section}

Find a rectangular object in the input video.

The object to search for must be specified as a gray8 image specified
with the `object`{.sample} option.

For each possible match, a score is computed. If the score reaches the
specified threshold, the object is considered found.

If the input video contains multiple instances of the object, the filter
will find only one of them.

When an object is found, the following metadata entries are set in the
matching frame:

`lavfi.rect.w`{.sample}

:   width of object

`lavfi.rect.h`{.sample}

:   height of object

`lavfi.rect.x`{.sample}

:   x position of object

`lavfi.rect.y`{.sample}

:   y position of object

`lavfi.rect.score`{.sample}

:   match score of the found object

It accepts the following options:

`object`{.sample}

:   Filepath of the object image, needs to be in gray8.

`threshold`{.sample}

:   Detection threshold, expressed as a decimal number in the range 0-1.

    A threshold value of 0.01 means only exact matches, a threshold of
    0.99 means almost everything matches.

    Default value is 0.5.

`mipmaps`{.sample}

:   Number of mipmaps, default is 3.

`xmin, ymin, xmax, ymax`{.sample}

:   Specifies the rectangle in which to search.

`discard`{.sample}

:   Discard frames where object is not detected. Default is disabled.

[]{#Examples-123}

#### [39.95.1 Examples](#toc-Examples-123) {#examples-123 .subsection}

- Cover a rectangular object by the supplied image of a given video
  using `ffmpeg`:

  ::: example
  ``` example
  ffmpeg -i file.ts -vf find_rect=newref.pgm,cover_rect=cover.jpg:mode=cover new.mkv
  ```
  :::
- Find the position of an object in each frame using `ffprobe` and write
  it to a log file:

  ::: example
  ``` example
  ffprobe -f lavfi movie=test.mp4,find_rect=object=object.pgm:threshold=0.3 \
    -show_entries frame=pkt_pts_time:frame_tags=lavfi.rect.x,lavfi.rect.y \
    -of csv -o find_rect.csv
  ```
  :::

[]{#floodfill}

### [39.96 floodfill](#toc-floodfill) {#floodfill .section}

Flood area with values of same pixel components with another values.

It accepts the following options:

`x`{.sample}

:   Set pixel x coordinate.

`y`{.sample}

:   Set pixel y coordinate.

`s0`{.sample}

:   Set source #0 component value.

`s1`{.sample}

:   Set source #1 component value.

`s2`{.sample}

:   Set source #2 component value.

`s3`{.sample}

:   Set source #3 component value.

`d0`{.sample}

:   Set destination #0 component value.

`d1`{.sample}

:   Set destination #1 component value.

`d2`{.sample}

:   Set destination #2 component value.

`d3`{.sample}

:   Set destination #3 component value.

[]{#format}[]{#format-1}

### [39.97 format](#toc-format-1) {#format .section}

Convert the input video to one of the specified pixel formats.
Libavfilter will try to pick one that is suitable as input to the next
filter.

It accepts the following parameters:

`pix_fmts`{.sample}

:   A '\|'-separated list of pixel format names, such as
    \"pix_fmts=yuv420p\|monow\|rgb24\".

`color_spaces`{.sample}

:   A '\|'-separated list of color space names, such as
    \"color_spaces=bt709\|bt470bg\|bt2020nc\".

`color_ranges`{.sample}

:   A '\|'-separated list of color range names, such as
    \"color_ranges=tv\|pc\".

`alpha_modes`{.sample}

:   A '\|'-separated list of color range names, such as
    \"alpha_modes=straight\|premultiplied\".

[]{#Examples-124}

#### [39.97.1 Examples](#toc-Examples-124) {#examples-124 .subsection}

- Convert the input video to the `yuv420p`{.variable} format

  ::: example
  ``` example
  format=pix_fmts=yuv420p
  ```
  :::

  Convert the input video to any of the formats in the list

  ::: example
  ``` example
  format=pix_fmts=yuv420p|yuv444p|yuv410p
  ```
  :::

[]{#fps}[]{#fps-1}

### [39.98 fps](#toc-fps-1) {#fps .section}

Convert the video to specified constant frame rate by duplicating or
dropping frames as necessary.

It accepts the following parameters:

`fps`{.sample}

:   The desired output frame rate. It accepts expressions containing the
    following constants:

    '`source_fps`{.sample}'

    :   The input's frame rate

    '`ntsc`{.sample}'

    :   NTSC frame rate of `30000/1001`

    '`pal`{.sample}'

    :   PAL frame rate of `25.0`

    '`film`{.sample}'

    :   Film frame rate of `24.0`

    '`ntsc_film`{.sample}'

    :   NTSC-film frame rate of `24000/1001`

    The default is `25`.

`start_time`{.sample}

:   Assume the first PTS should be the given value, in seconds. This
    allows for padding/trimming at the start of stream. By default, no
    assumption is made about the first frame's expected PTS, so no
    padding or trimming is done. For example, this could be set to 0 to
    pad the beginning with duplicates of the first frame if a video
    stream starts after the audio stream or to trim any frames with a
    negative PTS.

`round`{.sample}

:   Timestamp (PTS) rounding method.

    Possible values are:

    `zero`{.sample}

    :   round towards 0

    `inf`{.sample}

    :   round away from 0

    `down`{.sample}

    :   round towards -infinity

    `up`{.sample}

    :   round towards +infinity

    `near`{.sample}

    :   round to nearest

    The default is `near`.

`eof_action`{.sample}

:   Action performed when reading the last frame.

    Possible values are:

    `round`{.sample}

    :   Use same timestamp rounding method as used for other frames.

    `pass`{.sample}

    :   Pass through last frame if input duration has not been reached
        yet.

    The default is `round`.

Alternatively, the options can be specified as a flat string:
`fps`{.variable}\[:`start_time`{.variable}\[:`round`{.variable}\]\].

See also the [setpts](#setpts) filter.

[]{#Examples-125}

#### [39.98.1 Examples](#toc-Examples-125) {#examples-125 .subsection}

- A typical usage in order to set the fps to 25:

  ::: example
  ``` example
  fps=fps=25
  ```
  :::
- Sets the fps to 24, using abbreviation and rounding method to round to
  nearest:

  ::: example
  ``` example
  fps=fps=film:round=near
  ```
  :::

[]{#framepack}

### [39.99 framepack](#toc-framepack) {#framepack .section}

Pack two different video streams into a stereoscopic video, setting
proper metadata on supported codecs. The two views should have the same
size and framerate and processing will stop when the shorter video ends.
Please note that you may conveniently adjust view properties with the
[scale](#scale) and [fps](#fps) filters.

It accepts the following parameters:

`format`{.sample}

:   The desired packing format. Supported values are:

    `sbs`{.sample}

    :   The views are next to each other (default).

    `tab`{.sample}

    :   The views are on top of each other.

    `lines`{.sample}

    :   The views are packed by line.

    `columns`{.sample}

    :   The views are packed by column.

    `frameseq`{.sample}

    :   The views are temporally interleaved.

Some examples:

::: example
``` example
# Convert left and right views into a frame-sequential video
ffmpeg -i LEFT -i RIGHT -filter_complex framepack=frameseq OUTPUT

# Convert views into a side-by-side video with the same output resolution as the input
ffmpeg -i LEFT -i RIGHT -filter_complex [0:v]scale=w=iw/2[left],[1:v]scale=w=iw/2[right],[left][right]framepack=sbs OUTPUT
```
:::

[]{#framerate}

### [39.100 framerate](#toc-framerate) {#framerate .section}

Change the frame rate by interpolating new video output frames from the
source frames.

This filter is not designed to function correctly with interlaced media.
If you wish to change the frame rate of interlaced media then you are
required to deinterlace before this filter and re-interlace after this
filter.

A description of the accepted options follows.

`fps`{.sample}

:   Specify the output frames per second. This option can also be
    specified as a value alone. The default is `50`.

`interp_start`{.sample}

:   Specify the start of a range where the output frame will be created
    as a linear interpolation of two frames. The range is \[`0`-`255`\],
    the default is `15`.

`interp_end`{.sample}

:   Specify the end of a range where the output frame will be created as
    a linear interpolation of two frames. The range is \[`0`-`255`\],
    the default is `240`.

`scene`{.sample}

:   Specify the level at which a scene change is detected as a value
    between 0 and 100 to indicate a new scene; a low value reflects a
    low probability for the current frame to introduce a new scene,
    while a higher value means the current frame is more likely to be
    one. The default is `8.2`.

`flags`{.sample}

:   Specify flags influencing the filter process.

    Available value for `flags`{.variable} is:

    `scene_change_detect, scd`{.sample}

    :   Enable scene change detection using the value of the option
        `scene`{.variable}. This flag is enabled by default.

[]{#framestep}

### [39.101 framestep](#toc-framestep) {#framestep .section}

Select one frame every N-th frame.

This filter accepts the following option:

`step`{.sample}

:   Select frame after every `step` frames. Allowed values are positive
    integers higher than 0. Default value is `1`.

[]{#freezedetect}

### [39.102 freezedetect](#toc-freezedetect) {#freezedetect .section}

Detect frozen video.

This filter logs a message and sets frame metadata when it detects that
the input video has no significant change in content during a specified
duration. Video freeze detection calculates the mean average absolute
difference of all the components of video frames and compares it to a
noise floor.

The printed times and duration are expressed in seconds. The
`lavfi.freezedetect.freeze_start` metadata key is set on the first frame
whose timestamp equals or exceeds the detection duration and it contains
the timestamp of the first frame of the freeze. The
`lavfi.freezedetect.freeze_duration` and `lavfi.freezedetect.freeze_end`
metadata keys are set on the first frame after the freeze.

The filter accepts the following options:

`noise, n`{.sample}

:   Set noise tolerance. Can be specified in dB (in case \"dB\" is
    appended to the specified value) or as a difference ratio between 0
    and 1. Default is -60dB, or 0.001.

`duration, d`{.sample}

:   Set freeze duration until notification (default is 2 seconds).

[]{#freezeframes}

### [39.103 freezeframes](#toc-freezeframes) {#freezeframes .section}

Freeze video frames.

This filter freezes video frames using frame from 2nd input.

The filter accepts the following options:

`first`{.sample}

:   Set number of first frame from which to start freeze.

`last`{.sample}

:   Set number of last frame from which to end freeze.

`replace`{.sample}

:   Set number of frame from 2nd input which will be used instead of
    replaced frames.

[]{#frei0r}[]{#frei0r-1}

### [39.104 frei0r](#toc-frei0r-1) {#frei0r .section}

Apply a frei0r effect to the input video.

To enable the compilation of this filter, you need to install the frei0r
header and configure FFmpeg with `--enable-frei0r`.

It accepts the following parameters:

`filter_name`{.sample}

:   The name of the frei0r effect to load. If the environment variable
    `FREI0R_PATH` is defined, the frei0r effect is searched for in each
    of the directories specified by the colon-separated list in
    `FREI0R_PATH`. Otherwise, the standard frei0r paths are searched, in
    this order: `HOME/.frei0r-1/lib/`{.sample},
    `/usr/local/lib/frei0r-1/`{.sample}, `/usr/lib/frei0r-1/`{.sample}.

`filter_params`{.sample}

:   A '\|'-separated list of parameters to pass to the frei0r effect.

A frei0r effect parameter can be a boolean (its value is either \"y\" or
\"n\"), a double, a color (specified as
`R`{.variable}/`G`{.variable}/`B`{.variable}, where `R`{.variable},
`G`{.variable}, and `B`{.variable} are floating point numbers between
0.0 and 1.0, inclusive) or a color description as specified in the
[(ffmpeg-utils)\"Color\" section in the ffmpeg-utils
manual](ffmpeg-utils.html#color-syntax), a position (specified as
`X`{.variable}/`Y`{.variable}, where `X`{.variable} and `Y`{.variable}
are floating point numbers) and/or a string.

The number and types of parameters depend on the loaded effect. If an
effect parameter is not specified, the default value is set.

[]{#Examples-126}

#### [39.104.1 Examples](#toc-Examples-126) {#examples-126 .subsection}

- Apply the distort0r effect, setting the first two double parameters:

  ::: example
  ``` example
  frei0r=filter_name=distort0r:filter_params=0.5|0.01
  ```
  :::
- Apply the colordistance effect, taking a color as the first parameter:

  ::: example
  ``` example
  frei0r=colordistance:0.2/0.3/0.4
  frei0r=colordistance:violet
  frei0r=colordistance:0x112233
  ```
  :::
- Apply the perspective effect, specifying the top left and top right
  image positions:

  ::: example
  ``` example
  frei0r=perspective:0.2/0.2|0.8/0.2
  ```
  :::

For more information, see <http://frei0r.dyne.org>

[]{#Commands-94}

#### [39.104.2 Commands](#toc-Commands-94) {#commands-94 .subsection}

This filter supports the `filter_params`{.sample} option as
[commands](#commands).

[]{#fspp}

### [39.105 fspp](#toc-fspp) {#fspp .section}

Apply fast and simple postprocessing. It is a faster version of
[spp](#spp).

It splits (I)DCT into horizontal/vertical passes. Unlike the simple
post- processing filter, one of them is performed once per block, not
per pixel. This allows for much higher speed.

The filter accepts the following options:

`quality`{.sample}

:   Set quality. This option defines the number of levels for averaging.
    It accepts an integer in the range 4-5. Default value is `4`.

`qp`{.sample}

:   Force a constant quantization parameter. It accepts an integer in
    range 0-63. If not set, the filter will use the QP from the video
    stream (if available).

`strength`{.sample}

:   Set filter strength. It accepts an integer in range -15 to 32. Lower
    values mean more details but also more artifacts, while higher
    values make the image smoother but also blurrier. Default value is
    `0`  PSNR optimal.

`use_bframe_qp`{.sample}

:   Enable the use of the QP from the B-Frames if set to `1`. Using this
    option may cause flicker since the B-Frames have often larger QP.
    Default is `0` (not enabled).

[]{#fsync}[]{#fsync-1}

### [39.106 fsync](#toc-fsync-1) {#fsync .section}

Synchronize video frames with an external mapping from a file.

For each input PTS given in the map file it either drops or creates as
many frames as necessary to recreate the sequence of output frames given
in the map file.

This filter is useful to recreate the output frames of a framerate
conversion by the [fps](#fps) filter, recorded into a map file using the
ffmpeg option `-stats_mux_pre`, and do further processing to the
corresponding frames e.g. quality comparison.

Each line of the map file must contain three items per input frame, the
input PTS (decimal), the output PTS (decimal) and the output TIMEBASE
(decimal/decimal), separated by a space. This file format corresponds to
the output of `-stats_mux_pre_fmt="{ptsi} {pts} {tb}"`.

The filter assumes the map file is sorted by increasing input PTS.

The filter accepts the following options:

`file, f`{.sample}

:   The filename of the map file to be used.

Example:

::: example
``` example
# Convert a video to 25 fps and record a MAP_FILE file with the default format of this filter
ffmpeg -i INPUT -vf fps=fps=25 -stats_mux_pre MAP_FILE -stats_mux_pre_fmt "{ptsi} {pts} {tb}" OUTPUT

# Sort MAP_FILE by increasing input PTS
sort -n MAP_FILE

# Use INPUT, OUTPUT and the MAP_FILE from above to compare the corresponding frames in INPUT and OUTPUT via SSIM
ffmpeg -i INPUT -i OUTPUT -filter_complex '[0:v]fsync=file=MAP_FILE[ref];[1:v][ref]ssim' -f null -
```
:::

[]{#gblur}

### [39.107 gblur](#toc-gblur) {#gblur .section}

Apply Gaussian blur filter.

The filter accepts the following options:

`sigma`{.sample}

:   Set horizontal sigma, standard deviation of Gaussian blur. Default
    is `0.5`.

`steps`{.sample}

:   Set number of steps for Gaussian approximation. Default is `1`.

`planes`{.sample}

:   Set which planes to filter. By default all planes are filtered.

`sigmaV`{.sample}

:   Set vertical sigma, if negative it will be same as `sigma`. Default
    is `-1`.

[]{#Commands-95}

#### [39.107.1 Commands](#toc-Commands-95) {#commands-95 .subsection}

This filter supports same commands as options. The command accepts the
same syntax of the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#geq}

### [39.108 geq](#toc-geq) {#geq .section}

Apply generic equation to each pixel.

The filter accepts the following options:

`lum_expr, lum`{.sample}

:   Set the luma expression.

`cb_expr, cb`{.sample}

:   Set the chrominance blue expression.

`cr_expr, cr`{.sample}

:   Set the chrominance red expression.

`alpha_expr, a`{.sample}

:   Set the alpha expression.

`red_expr, r`{.sample}

:   Set the red expression.

`green_expr, g`{.sample}

:   Set the green expression.

`blue_expr, b`{.sample}

:   Set the blue expression.

The colorspace is selected according to the specified options. If one of
the `lum_expr`{.sample}, `cb_expr`{.sample}, or `cr_expr`{.sample}
options is specified, the filter will automatically select a YCbCr
colorspace. If one of the `red_expr`{.sample}, `green_expr`{.sample}, or
`blue_expr`{.sample} options is specified, it will select an RGB
colorspace.

If one of the chrominance expression is not defined, it falls back on
the other one. If no alpha expression is specified it will evaluate to
opaque value. If none of chrominance expressions are specified, they
will evaluate to the luma expression.

The expressions can use the following variables and functions:

`N`{.sample}

The sequential number of the filtered frame, starting from `0`.

`X`{.sample}

`Y`{.sample}

The coordinates of the current sample.

`W`{.sample}

`H`{.sample}

The width and height of the image.

`SW`{.sample}

`SH`{.sample}

Width and height scale depending on the currently filtered plane. It is
the ratio between the corresponding luma plane number of pixels and the
current plane ones. E.g. for YUV4:2:0 the values are `1,1` for the luma
plane, and `0.5,0.5` for chroma planes.

`T`{.sample}

Time of the current frame, expressed in seconds.

`p(x, y)`{.sample}

Return the value of the pixel at location
(`x`{.variable},`y`{.variable}) of the current plane.

`lum(x, y)`{.sample}

Return the value of the pixel at location
(`x`{.variable},`y`{.variable}) of the luma plane.

`cb(x, y)`{.sample}

Return the value of the pixel at location
(`x`{.variable},`y`{.variable}) of the blue-difference chroma plane.
Return 0 if there is no such plane.

`cr(x, y)`{.sample}

Return the value of the pixel at location
(`x`{.variable},`y`{.variable}) of the red-difference chroma plane.
Return 0 if there is no such plane.

`r(x, y)`{.sample}

`g(x, y)`{.sample}

`b(x, y)`{.sample}

Return the value of the pixel at location
(`x`{.variable},`y`{.variable}) of the red/green/blue component. Return
0 if there is no such component.

`alpha(x, y)`{.sample}

Return the value of the pixel at location
(`x`{.variable},`y`{.variable}) of the alpha plane. Return 0 if there is
no such plane.

`psum(x,y), lumsum(x, y), cbsum(x,y), crsum(x,y), rsum(x,y), gsum(x,y), bsum(x,y), alphasum(x,y)`{.sample}

Sum of sample values in the rectangle from (0,0) to (x,y), this allows
obtaining sums of samples within a rectangle. See the functions without
the sum postfix.

`interpolation`{.sample}

Set one of interpolation methods:

`nearest, n`{.sample}

`bilinear, b`{.sample}

Default is bilinear.

For functions, if `x`{.variable} and `y`{.variable} are outside the
area, the value will be automatically clipped to the closer edge.

Please note that this filter can use multiple threads in which case each
slice will have its own expression state. If you want to use only a
single expression state because your expressions depend on previous
state then you should limit the number of filter threads to 1.

[]{#Examples-127}

#### [39.108.1 Examples](#toc-Examples-127) {#examples-127 .subsection}

- Flip the image horizontally:

  ::: example
  ``` example
  geq=p(W-X\,Y)
  ```
  :::
- Generate a bidimensional sine wave, with angle `PI/3` and a wavelength
  of 100 pixels:

  ::: example
  ``` example
  geq=128 + 100*sin(2*(PI/100)*(cos(PI/3)*(X-50*T) + sin(PI/3)*Y)):128:128
  ```
  :::
- Generate a fancy enigmatic moving light:

  ::: example
  ``` example
  nullsrc=s=256x256,geq=random(1)/hypot(X-cos(N*0.07)*W/2-W/2\,Y-sin(N*0.09)*H/2-H/2)^2*1000000*sin(N*0.02):128:128
  ```
  :::
- Generate a quick emboss effect:

  ::: example
  ``` example
  format=gray,geq=lum_expr='(p(X,Y)+(256-p(X-4,Y-4)))/2'
  ```
  :::
- Modify RGB components depending on pixel position:

  ::: example
  ``` example
  geq=r='X/W*r(X,Y)':g='(1-X/W)*g(X,Y)':b='(H-Y)/H*b(X,Y)'
  ```
  :::
- Create a radial gradient that is the same size as the input (also see
  the [vignette](#vignette) filter):

  ::: example
  ``` example
  geq=lum=255*gauss((X/W-0.5)*3)*gauss((Y/H-0.5)*3)/gauss(0)/gauss(0),format=gray
  ```
  :::

[]{#gradfun}

### [39.109 gradfun](#toc-gradfun) {#gradfun .section}

Fix the banding artifacts that are sometimes introduced into nearly flat
regions by truncation to 8-bit color depth. Interpolate the gradients
that should go where the bands are, and dither them.

It is designed for playback only. Do not use it prior to lossy
compression, because compression tends to lose the dither and bring back
the bands.

It accepts the following parameters:

`strength`{.sample}

:   The maximum amount by which the filter will change any one pixel.
    This is also the threshold for detecting nearly flat regions.
    Acceptable values range from .51 to 64; the default value is 1.2.
    Out-of-range values will be clipped to the valid range.

`radius`{.sample}

:   The neighborhood to fit the gradient to. A larger radius makes for
    smoother gradients, but also prevents the filter from modifying the
    pixels near detailed regions. Acceptable values are 8-32; the
    default value is 16. Out-of-range values will be clipped to the
    valid range.

Alternatively, the options can be specified as a flat string:
`strength`{.variable}\[:`radius`{.variable}\]

[]{#Examples-128}

#### [39.109.1 Examples](#toc-Examples-128) {#examples-128 .subsection}

- Apply the filter with a `3.5` strength and radius of `8`:

  ::: example
  ``` example
  gradfun=3.5:8
  ```
  :::
- Specify radius, omitting the strength (which will fall-back to the
  default value):

  ::: example
  ``` example
  gradfun=radius=8
  ```
  :::

[]{#graphmonitor}[]{#graphmonitor-1}

### [39.110 graphmonitor](#toc-graphmonitor-1) {#graphmonitor .section}

Show various filtergraph stats.

With this filter one can debug complete filtergraph. Especially issues
with links filling with queued frames.

The filter accepts the following options:

`size, s`{.sample}

:   Set video output size. Default is `hd720`{.variable}.

`opacity, o`{.sample}

:   Set video opacity. Default is `0.9`{.variable}. Allowed range is
    from `0`{.variable} to `1`{.variable}.

`mode, m`{.sample}

:   Set output mode flags.

    Available values for flags are:

    '`full`{.sample}'

    :   No any filtering. Default.

    '`compact`{.sample}'

    :   Show only filters with queued frames.

    '`nozero`{.sample}'

    :   Show only filters with non-zero stats.

    '`noeof`{.sample}'

    :   Show only filters with non-eof stat.

    '`nodisabled`{.sample}'

    :   Show only filters that are enabled in timeline.

`flags, f`{.sample}

:   Set flags which enable which stats are shown in video.

    Available values for flags are:

    '`none`{.sample}'

    :   All flags turned off.

    '`all`{.sample}'

    :   All flags turned on.

    '`queue`{.sample}'

    :   Display number of queued frames in each link.

    '`frame_count_in`{.sample}'

    :   Display number of frames taken from filter.

    '`frame_count_out`{.sample}'

    :   Display number of frames given out from filter.

    '`frame_count_delta`{.sample}'

    :   Display delta number of frames between above two values.

    '`pts`{.sample}'

    :   Display current filtered frame pts.

    '`pts_delta`{.sample}'

    :   Display pts delta between current and previous frame.

    '`time`{.sample}'

    :   Display current filtered frame time.

    '`time_delta`{.sample}'

    :   Display time delta between current and previous frame.

    '`timebase`{.sample}'

    :   Display time base for filter link.

    '`format`{.sample}'

    :   Display used format for filter link.

    '`size`{.sample}'

    :   Display video size or number of audio channels in case of audio
        used by filter link.

    '`rate`{.sample}'

    :   Display video frame rate or sample rate in case of audio used by
        filter link.

    '`eof`{.sample}'

    :   Display link output status.

    '`sample_count_in`{.sample}'

    :   Display number of samples taken from filter.

    '`sample_count_out`{.sample}'

    :   Display number of samples given out from filter.

    '`sample_count_delta`{.sample}'

    :   Display delta number of samples between above two values.

    '`disabled`{.sample}'

    :   Show the timeline filter status.

`rate, r`{.sample}

:   Set upper limit for video rate of output stream, Default value is
    `25`{.variable}. This guarantee that output video frame rate will
    not be higher than this value.

[]{#grayworld}

### [39.111 grayworld](#toc-grayworld) {#grayworld .section}

A color constancy filter that applies color correction based on the
grayworld assumption

See:
<https://www.researchgate.net/publication/275213614_A_New_Color_Correction_Method_for_Underwater_Imaging>

The algorithm uses linear light, so input data should be linearized
beforehand (and possibly correctly tagged).

::: example
``` example
ffmpeg -i INPUT -vf zscale=transfer=linear,grayworld,zscale=transfer=bt709,format=yuv420p OUTPUT
```
:::

[]{#greyedge}

### [39.112 greyedge](#toc-greyedge) {#greyedge .section}

A color constancy variation filter which estimates scene illumination
via grey edge algorithm and corrects the scene colors accordingly.

See: <https://staff.science.uva.nl/th.gevers/pub/GeversTIP07.pdf>

The filter accepts the following options:

`difford`{.sample}

:   The order of differentiation to be applied on the scene. Must be
    chosen in the range \[0,2\] and default value is 1.

`minknorm`{.sample}

:   The Minkowski parameter to be used for calculating the Minkowski
    distance. Must be chosen in the range \[0,20\] and default value
    is 1. Set to 0 for getting max value instead of calculating
    Minkowski distance.

`sigma`{.sample}

:   The standard deviation of Gaussian blur to be applied on the scene.
    Must be chosen in the range \[0,1024.0\] and default value = 1.
    floor( `sigma`{.variable} \* break_off_sigma(3) ) can't be equal to
    0 if `difford`{.variable} is greater than 0.

[]{#Examples-129}

#### [39.112.1 Examples](#toc-Examples-129) {#examples-129 .subsection}

- Grey Edge:

  ::: example
  ``` example
  greyedge=difford=1:minknorm=5:sigma=2
  ```
  :::
- Max Edge:

  ::: example
  ``` example
  greyedge=difford=1:minknorm=0:sigma=2
  ```
  :::

[]{#guided}

### [39.113 guided](#toc-guided) {#guided .section}

Apply guided filter for edge-preserving smoothing, dehazing and so on.

The filter accepts the following options:

`radius`{.sample}

:   Set the box radius in pixels. Allowed range is 1 to 20. Default is
    3.

`eps`{.sample}

:   Set regularization parameter (with square). Allowed range is 0 to 1.
    Default is 0.01.

`mode`{.sample}

:   Set filter mode. Can be `basic` or `fast`. Default is `basic`.

`sub`{.sample}

:   Set subsampling ratio for `fast` mode. Range is 2 to 64. Default
    is 4. No subsampling occurs in `basic` mode.

`guidance`{.sample}

:   Set guidance mode. Can be `off` or `on`. Default is `off`. If `off`,
    single input is required. If `on`, two inputs of the same resolution
    and pixel format are required. The second input serves as the
    guidance.

`planes`{.sample}

:   Set planes to filter. Default is first only.

[]{#Commands-96}

#### [39.113.1 Commands](#toc-Commands-96) {#commands-96 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#Examples-130}

#### [39.113.2 Examples](#toc-Examples-130) {#examples-130 .subsection}

- Edge-preserving smoothing with guided filter:

  ::: example
  ``` example
  ffmpeg -i in.png -vf guided out.png
  ```
  :::
- Dehazing, structure-transferring filtering, detail enhancement with
  guided filter. For the generation of guidance image, refer to paper
  \"Guided Image Filtering\". See:
  <http://kaiminghe.com/publications/pami12guidedfilter.pdf>.

  ::: example
  ``` example
  ffmpeg -i in.png -i guidance.png -filter_complex guided=guidance=on out.png
  ```
  :::

[]{#haldclut}[]{#haldclut-1}

### [39.114 haldclut](#toc-haldclut-1) {#haldclut .section}

Apply a Hald CLUT to a video stream.

First input is the video stream to process, and second one is the Hald
CLUT. The Hald CLUT input can be a simple picture or a complete video
stream.

The filter accepts the following options:

`clut`{.sample}

:   Set which CLUT video frames will be processed from second input
    stream, can be `first`{.variable} or `all`{.variable}. Default is
    `all`{.variable}.

`shortest`{.sample}

:   Force termination when the shortest input terminates. Default is
    `0`.

`repeatlast`{.sample}

:   Continue applying the last CLUT after the end of the stream. A value
    of `0` disable the filter after the last frame of the CLUT is
    reached. Default is `1`.

`haldclut` also has the same interpolation options as [lut3d](#lut3d)
(both filters share the same internals).

This filter also supports the [framesync](#framesync) options.

More information about the Hald CLUT can be found on Eskil Steenberg's
website (Hald CLUT author) at
<http://www.quelsolaar.com/technology/clut.html>.

[]{#Commands-97}

#### [39.114.1 Commands](#toc-Commands-97) {#commands-97 .subsection}

This filter supports the `interp` option as [commands](#commands).

[]{#Workflow-examples}

#### [39.114.2 Workflow examples](#toc-Workflow-examples) {#workflow-examples .subsection}

[]{#Hald-CLUT-video-stream}

#### [39.114.2.1 Hald CLUT video stream](#toc-Hald-CLUT-video-stream) {#hald-clut-video-stream .subsubsection}

Generate an identity Hald CLUT stream altered with various effects:

::: example
``` example
ffmpeg -f lavfi -i haldclutsrc=8 -vf "hue=H=2*PI*t:s=sin(2*PI*t)+1, curves=cross_process" -t 10 -c:v ffv1 clut.nut
```
:::

Note: make sure you use a lossless codec.

Then use it with `haldclut` to apply it on some random stream:

::: example
``` example
ffmpeg -f lavfi -i mandelbrot -i clut.nut -filter_complex '[0][1] haldclut' -t 20 mandelclut.mkv
```
:::

The Hald CLUT will be applied to the 10 first seconds (duration of
`clut.nut`{.sample}), then the latest picture of that CLUT stream will
be applied to the remaining frames of the `mandelbrot` stream.

[]{#Hald-CLUT-with-preview}

#### [39.114.2.2 Hald CLUT with preview](#toc-Hald-CLUT-with-preview) {#hald-clut-with-preview .subsubsection}

A Hald CLUT is supposed to be a squared image of `Level*Level*Level` by
`Level*Level*Level` pixels. For a given Hald CLUT, FFmpeg will select
the biggest possible square starting at the top left of the picture. The
remaining padding pixels (bottom or right) will be ignored. This area
can be used to add a preview of the Hald CLUT.

Typically, the following generated Hald CLUT will be supported by the
`haldclut` filter:

::: example
``` example
ffmpeg -f lavfi -i haldclutsrc=8 -vf "
   pad=iw+320 [padded_clut];
   smptebars=s=320x256, split [a][b];
   [padded_clut][a] overlay=W-320:h, curves=color_negative [main];
   [main][b] overlay=W-320" -frames:v 1 clut.png
```
:::

It contains the original and a preview of the effect of the CLUT: SMPTE
color bars are displayed on the right-top, and below the same color bars
processed by the color changes.

Then, the effect of this Hald CLUT can be visualized with:

::: example
``` example
ffplay input.mkv -vf "movie=clut.png, [in] haldclut"
```
:::

[]{#hflip}

### [39.115 hflip](#toc-hflip) {#hflip .section}

Flip the input video horizontally.

For example, to horizontally flip the input video with `ffmpeg`:

::: example
``` example
ffmpeg -i in.avi -vf "hflip" out.avi
```
:::

[]{#histeq}

### [39.116 histeq](#toc-histeq) {#histeq .section}

This filter applies a global color histogram equalization on a per-frame
basis.

It can be used to correct video that has a compressed range of pixel
intensities. The filter redistributes the pixel intensities to equalize
their distribution across the intensity range. It may be viewed as an
\"automatically adjusting contrast filter\". This filter is useful only
for correcting degraded or poorly captured source video.

The filter accepts the following options:

`strength`{.sample}

:   Determine the amount of equalization to be applied. As the strength
    is reduced, the distribution of pixel intensities more-and-more
    approaches that of the input frame. The value must be a float number
    in the range \[0,1\] and defaults to 0.200.

`intensity`{.sample}

:   Set the maximum intensity that can generated and scale the output
    values appropriately. The strength should be set as desired and then
    the intensity can be limited if needed to avoid washing-out. The
    value must be a float number in the range \[0,1\] and defaults to
    0.210.

`antibanding`{.sample}

:   Set the antibanding level. If enabled the filter will randomly vary
    the luminance of output pixels by a small amount to avoid banding of
    the histogram. Possible values are `none`, `weak` or `strong`. It
    defaults to `none`.

[]{#histogram}[]{#histogram-1}

### [39.117 histogram](#toc-histogram-1) {#histogram .section}

Compute and draw a color distribution histogram for the input video.

The computed histogram is a representation of the color component
distribution in an image.

Standard histogram displays the color components distribution in an
image. Displays color graph for each color component. Shows distribution
of the Y, U, V, A or R, G, B components, depending on input format, in
the current frame. Below each graph a color component scale meter is
shown.

The filter accepts the following options:

`level_height`{.sample}

Set height of level. Default value is `200`. Allowed range is \[50,
2048\].

`scale_height`{.sample}

Set height of color scale. Default value is `12`. Allowed range is \[0,
40\].

`display_mode`{.sample}

Set display mode. It accepts the following values:

'`stack`{.sample}'

:   Per color component graphs are placed below each other.

'`parade`{.sample}'

:   Per color component graphs are placed side by side.

'`overlay`{.sample}'

:   Presents information identical to that in the `parade`, except that
    the graphs representing color components are superimposed directly
    over one another.

Default is `stack`.

`levels_mode`{.sample}

Set mode. Can be either `linear`, or `logarithmic`. Default is `linear`.

`components`{.sample}

Set what color components to display. Default is `7`.

`fgopacity`{.sample}

Set foreground opacity. Default is `0.7`.

`bgopacity`{.sample}

Set background opacity. Default is `0.5`.

`colors_mode`{.sample}

Set colors mode. It accepts the following values:

'`whiteonblack`{.sample}'

'`blackonwhite`{.sample}'

'`whiteongray`{.sample}'

'`blackongray`{.sample}'

'`coloronblack`{.sample}'

'`coloronwhite`{.sample}'

'`colorongray`{.sample}'

'`blackoncolor`{.sample}'

'`whiteoncolor`{.sample}'

'`grayoncolor`{.sample}'

Default is `whiteonblack`.

[]{#Examples-131}

#### [39.117.1 Examples](#toc-Examples-131) {#examples-131 .subsection}

- Calculate and draw histogram:

  ::: example
  ``` example
  ffplay -i input -vf histogram
  ```
  :::

[]{#hqdn3d}[]{#hqdn3d-1}

### [39.118 hqdn3d](#toc-hqdn3d-1) {#hqdn3d .section}

This is a high precision/quality 3d denoise filter. It aims to reduce
image noise, producing smooth images and making still images really
still. It should enhance compressibility.

It accepts the following optional parameters:

`luma_spatial`{.sample}

:   A non-negative floating point number which specifies spatial luma
    strength. It defaults to 4.0.

`chroma_spatial`{.sample}

:   A non-negative floating point number which specifies spatial chroma
    strength. It defaults to 3.0\*`luma_spatial`{.variable}/4.0.

`luma_tmp`{.sample}

:   A floating point number which specifies luma temporal strength. It
    defaults to 6.0\*`luma_spatial`{.variable}/4.0.

`chroma_tmp`{.sample}

:   A floating point number which specifies chroma temporal strength. It
    defaults to
    `luma_tmp`{.variable}\*`chroma_spatial`{.variable}/`luma_spatial`{.variable}.

[]{#Commands-98}

#### [39.118.1 Commands](#toc-Commands-98) {#commands-98 .subsection}

This filter supports same [commands](#commands) as options. The command
accepts the same syntax of the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#hwdownload}[]{#hwdownload-1}

### [39.119 hwdownload](#toc-hwdownload-1) {#hwdownload .section}

Download hardware frames to system memory.

The input must be in hardware frames, and the output a non-hardware
format. Not all formats will be supported on the output - it may be
necessary to insert an additional `format`{.sample} filter immediately
following in the graph to get the output in a supported format.

[]{#hwmap}

### [39.120 hwmap](#toc-hwmap) {#hwmap .section}

Map hardware frames to system memory or to another device.

This filter has several different modes of operation; which one is used
depends on the input and output formats:

- Hardware frame input, normal frame output

  Map the input frames to system memory and pass them to the output. If
  the original hardware frame is later required (for example, after
  overlaying something else on part of it), the `hwmap`{.sample} filter
  can be used again in the next mode to retrieve it.

- Normal frame input, hardware frame output

  If the input is actually a software-mapped hardware frame, then unmap
  it - that is, return the original hardware frame.

  Otherwise, a device must be provided. Create new hardware surfaces on
  that device for the output, then map them back to the software format
  at the input and give those frames to the preceding filter. This will
  then act like the `hwupload`{.sample} filter, but may be able to avoid
  an additional copy when the input is already in a compatible format.

- Hardware frame input and output

  A device must be supplied for the output, either directly or with the
  `derive_device`{.sample} option. The input and output devices must be
  of different types and compatible - the exact meaning of this is
  system-dependent, but typically it means that they must refer to the
  same underlying hardware context (for example, refer to the same
  graphics card).

  If the input frames were originally created on the output device, then
  unmap to retrieve the original frames.

  Otherwise, map the frames to the output device - create new hardware
  frames on the output corresponding to the frames on the input.

The following additional parameters are accepted:

`mode`{.sample}

:   Set the frame mapping mode. Some combination of:

    `read`{.variable}

    :   The mapped frame should be readable.

    `write`{.variable}

    :   The mapped frame should be writeable.

    `overwrite`{.variable}

    :   The mapping will always overwrite the entire frame.

        This may improve performance in some cases, as the original
        contents of the frame need not be loaded.

    `direct`{.variable}

    :   The mapping must not involve any copying.

        Indirect mappings to copies of frames are created in some cases
        where either direct mapping is not possible or it would have
        unexpected properties. Setting this flag ensures that the
        mapping is direct and will fail if that is not possible.

    Defaults to `read+write`{.variable} if not specified.

`derive_device `{.sample}`type`{.variable}

:   Rather than using the device supplied at initialisation, instead
    derive a new device of type `type`{.variable} from the device the
    input frames exist on.

`reverse`{.sample}

:   In a hardware to hardware mapping, map in reverse - create frames in
    the sink and map them back to the source. This may be necessary in
    some cases where a mapping in one direction is required but only the
    opposite direction is supported by the devices being used.

    This option is dangerous - it may break the preceding filter in
    undefined ways if there are any additional constraints on that
    filter's output. Do not use it without fully understanding the
    implications of its use.

[]{#hwupload}[]{#hwupload-1}

### [39.121 hwupload](#toc-hwupload-1) {#hwupload .section}

Upload system memory frames to hardware surfaces.

The device to upload to must be supplied when the filter is initialised.
If using ffmpeg, select the appropriate device with the
`-filter_hw_device`{.sample} option or with the `derive_device`{.sample}
option. The input and output devices must be of different types and
compatible - the exact meaning of this is system-dependent, but
typically it means that they must refer to the same underlying hardware
context (for example, refer to the same graphics card).

The following additional parameters are accepted:

`derive_device `{.sample}`type`{.variable}

:   Rather than using the device supplied at initialisation, instead
    derive a new device of type `type`{.variable} from the device the
    input frames exist on.

[]{#hwupload_005fcuda}[]{#hwupload_005fcuda-1}

### [39.122 hwupload_cuda](#toc-hwupload_005fcuda-1) {#hwupload_cuda .section}

Upload system memory frames to a CUDA device.

It accepts the following optional parameters:

`device`{.sample}

:   The number of the CUDA device to use

[]{#hqx}

### [39.123 hqx](#toc-hqx) {#hqx .section}

Apply a high-quality magnification filter designed for pixel art. This
filter was originally created by Maxim Stepin.

It accepts the following option:

`n`{.sample}

:   Set the scaling dimension: `2` for `hq2x`, `3` for `hq3x` and `4`
    for `hq4x`. Default is `3`.

[]{#hstack}[]{#hstack-1}

### [39.124 hstack](#toc-hstack-1) {#hstack .section}

Stack input videos horizontally.

All streams must be of same pixel format and of same height.

Note that this filter is faster than using [overlay](#overlay) and
[pad](#pad) filter to create same output.

The filter accepts the following option:

`inputs`{.sample}

:   Set number of input streams. Default is 2.

`shortest`{.sample}

:   If set to 1, force the output to terminate when the shortest input
    terminates. Default value is 0.

[]{#hsvhold}

### [39.125 hsvhold](#toc-hsvhold) {#hsvhold .section}

Turns a certain HSV range into gray values.

This filter measures color difference between set HSV color in options
and ones measured in video stream. Depending on options, output colors
can be changed to be gray or not.

The filter accepts the following options:

`hue`{.sample}

:   Set the hue value which will be used in color difference
    calculation. Allowed range is from -360 to 360. Default value is 0.

`sat`{.sample}

:   Set the saturation value which will be used in color difference
    calculation. Allowed range is from -1 to 1. Default value is 0.

`val`{.sample}

:   Set the value which will be used in color difference calculation.
    Allowed range is from -1 to 1. Default value is 0.

`similarity`{.sample}

:   Set similarity percentage with the key color. Allowed range is from
    0 to 1. Default value is 0.01.

    0.00001 matches only the exact key color, while 1.0 matches
    everything.

`blend`{.sample}

:   Blend percentage. Allowed range is from 0 to 1. Default value is 0.

    0.0 makes pixels either fully gray, or not gray at all.

    Higher values result in more gray pixels, with a higher gray pixel
    the more similar the pixels color is to the key color.

[]{#hsvkey}

### [39.126 hsvkey](#toc-hsvkey) {#hsvkey .section}

Turns a certain HSV range into transparency.

This filter measures color difference between set HSV color in options
and ones measured in video stream. Depending on options, output colors
can be changed to transparent by adding alpha channel.

The filter accepts the following options:

`hue`{.sample}

:   Set the hue value which will be used in color difference
    calculation. Allowed range is from -360 to 360. Default value is 0.

`sat`{.sample}

:   Set the saturation value which will be used in color difference
    calculation. Allowed range is from -1 to 1. Default value is 0.

`val`{.sample}

:   Set the value which will be used in color difference calculation.
    Allowed range is from -1 to 1. Default value is 0.

`similarity`{.sample}

:   Set similarity percentage with the key color. Allowed range is from
    0 to 1. Default value is 0.01.

    0.00001 matches only the exact key color, while 1.0 matches
    everything.

`blend`{.sample}

:   Blend percentage. Allowed range is from 0 to 1. Default value is 0.

    0.0 makes pixels either fully transparent, or not transparent at
    all.

    Higher values result in semi-transparent pixels, with a higher
    transparency the more similar the pixels color is to the key color.

[]{#hue}

### [39.127 hue](#toc-hue) {#hue .section}

Modify the hue and/or the saturation of the input.

It accepts the following parameters:

`h`{.sample}

:   Specify the hue angle as a number of degrees. It accepts an
    expression, and defaults to \"0\".

`s`{.sample}

:   Specify the saturation in the \[-10,10\] range. It accepts an
    expression and defaults to \"1\".

`H`{.sample}

:   Specify the hue angle as a number of radians. It accepts an
    expression, and defaults to \"0\".

`b`{.sample}

:   Specify the brightness in the \[-10,10\] range. It accepts an
    expression and defaults to \"0\".

`h`{.sample} and `H`{.sample} are mutually exclusive, and can't be
specified at the same time.

The `b`{.sample}, `h`{.sample}, `H`{.sample} and `s`{.sample} option
values are expressions containing the following constants:

`n`{.sample}

:   frame count of the input frame starting from 0

`pts`{.sample}

:   presentation timestamp of the input frame expressed in time base
    units

`r`{.sample}

:   frame rate of the input video, NAN if the input frame rate is
    unknown

`t`{.sample}

:   timestamp expressed in seconds, NAN if the input timestamp is
    unknown

`tb`{.sample}

:   time base of the input video

[]{#Examples-132}

#### [39.127.1 Examples](#toc-Examples-132) {#examples-132 .subsection}

- Set the hue to 90 degrees and the saturation to 1.0:

  ::: example
  ``` example
  hue=h=90:s=1
  ```
  :::

- Same command but expressing the hue in radians:

  ::: example
  ``` example
  hue=H=PI/2:s=1
  ```
  :::

- Rotate hue and make the saturation swing between 0 and 2 over a period
  of 1 second:

  ::: example
  ``` example
  hue="H=2*PI*t: s=sin(2*PI*t)+1"
  ```
  :::

- Apply a 3 seconds saturation fade-in effect starting at 0:

  ::: example
  ``` example
  hue="s=min(t/3\,1)"
  ```
  :::

  The general fade-in expression can be written as:

  ::: example
  ``` example
  hue="s=min(0\, max((t-START)/DURATION\, 1))"
  ```
  :::

- Apply a 3 seconds saturation fade-out effect starting at 5 seconds:

  ::: example
  ``` example
  hue="s=max(0\, min(1\, (8-t)/3))"
  ```
  :::

  The general fade-out expression can be written as:

  ::: example
  ``` example
  hue="s=max(0\, min(1\, (START+DURATION-t)/DURATION))"
  ```
  :::

[]{#Commands-99}

#### [39.127.2 Commands](#toc-Commands-99) {#commands-99 .subsection}

This filter supports the following commands:

`b`{.sample}\
`s`{.sample}\
`h`{.sample}\
`H`{.sample}

:   Modify the hue and/or the saturation and/or brightness of the input
    video. The command accepts the same syntax of the corresponding
    option.

    If the specified expression is not valid, it is kept at its current
    value.

[]{#huesaturation}

### [39.128 huesaturation](#toc-huesaturation) {#huesaturation .section}

Apply hue-saturation-intensity adjustments to input video stream.

This filter operates in RGB colorspace.

This filter accepts the following options:

`hue`{.sample}

:   Set the hue shift in degrees to apply. Default is 0. Allowed range
    is from -180 to 180.

`saturation`{.sample}

:   Set the saturation shift. Default is 0. Allowed range is from -1 to
    1.

`intensity`{.sample}

:   Set the intensity shift. Default is 0. Allowed range is from -1 to
    1.

`colors`{.sample}

:   Set which primary and complementary colors are going to be adjusted.
    This options is set by providing one or multiple values. This can
    select multiple colors at once. By default all colors are selected.

    '`r`{.sample}'

    :   Adjust reds.

    '`y`{.sample}'

    :   Adjust yellows.

    '`g`{.sample}'

    :   Adjust greens.

    '`c`{.sample}'

    :   Adjust cyans.

    '`b`{.sample}'

    :   Adjust blues.

    '`m`{.sample}'

    :   Adjust magentas.

    '`a`{.sample}'

    :   Adjust all colors.

`strength`{.sample}

:   Set strength of filtering. Allowed range is from 0 to 100. Default
    value is 1.

`rw, gw, bw`{.sample}

:   Set weight for each RGB component. Allowed range is from 0 to 1. By
    default is set to 0.333, 0.334, 0.333. Those options are used in
    saturation and lightess processing.

`lightness`{.sample}

:   Set preserving lightness, by default is disabled. Adjusting hues can
    change lightness from original RGB triplet, with this option enabled
    lightness is kept at same value.

[]{#hysteresis}

### [39.129 hysteresis](#toc-hysteresis) {#hysteresis .section}

Grow first stream into second stream by connecting components. This
makes it possible to build more robust edge masks.

This filter accepts the following options:

`planes`{.sample}

:   Set which planes will be processed as bitmap, unprocessed planes
    will be copied from first stream. By default value 0xf, all planes
    will be processed.

`threshold`{.sample}

:   Set threshold which is used in filtering. If pixel component value
    is higher than this value filter algorithm for connecting components
    is activated. By default value is 0.

The `hysteresis` filter also supports the [framesync](#framesync)
options.

[]{#iccdetect}

### [39.130 iccdetect](#toc-iccdetect) {#iccdetect .section}

Detect the colorspace from an embedded ICC profile (if present), and
update the frame's tags accordingly.

This filter accepts the following options:

`force`{.sample}

:   If true, the frame's existing colorspace tags will always be
    overridden by values detected from an ICC profile. Otherwise, they
    will only be assigned if they contain `unknown`. Enabled by default.

[]{#iccgen}

### [39.131 iccgen](#toc-iccgen) {#iccgen .section}

Generate ICC profiles and attach them to frames.

This filter accepts the following options:

`color_primaries`{.sample}\
`color_trc`{.sample}

:   Configure the colorspace that the ICC profile will be generated for.
    The default value of `auto` infers the value from the input frame's
    metadata, defaulting to BT.709/sRGB as appropriate.

    See the [setparams](#setparams) filter for a list of possible
    values, but note that `unknown` are not valid values for this
    filter.

`force`{.sample}

:   If true, an ICC profile will be generated even if it would overwrite
    an already existing ICC profile. Disabled by default.

[]{#identity}

### [39.132 identity](#toc-identity) {#identity .section}

Obtain the identity score between two input videos.

This filter takes two input videos.

Both input videos must have the same resolution and pixel format for
this filter to work correctly. Also it assumes that both inputs have the
same number of frames, which are compared one by one.

The obtained per component, average, min and max identity score is
printed through the logging system.

The filter stores the calculated identity scores of each frame in frame
metadata.

This filter also supports the [framesync](#framesync) options.

In the below example the input file `main.mpg`{.sample} being processed
is compared with the reference file `ref.mpg`{.sample}.

::: example
``` example
ffmpeg -i main.mpg -i ref.mpg -lavfi identity -f null -
```
:::

[]{#idet}

### [39.133 idet](#toc-idet) {#idet .section}

Detect video interlacing type.

This filter tries to detect if the input frames are interlaced,
progressive, top or bottom field first. It will also try to detect
fields that are repeated between adjacent frames (a sign of telecine).

Single frame detection considers only immediately adjacent frames when
classifying each frame. Multiple frame detection incorporates the
classification history of previous frames.

The filter will log these metadata values:

`single.current_frame`{.sample}

:   Detected type of current frame using single-frame detection. One of:
    "tff" (top field first), "bff" (bottom field first), "progressive",
    or "undetermined"

`single.tff`{.sample}

:   Cumulative number of frames detected as top field first using
    single-frame detection.

`multiple.tff`{.sample}

:   Cumulative number of frames detected as top field first using
    multiple-frame detection.

`single.bff`{.sample}

:   Cumulative number of frames detected as bottom field first using
    single-frame detection.

`multiple.current_frame`{.sample}

:   Detected type of current frame using multiple-frame detection. One
    of: "tff" (top field first), "bff" (bottom field first),
    "progressive", or "undetermined"

`multiple.bff`{.sample}

:   Cumulative number of frames detected as bottom field first using
    multiple-frame detection.

`single.progressive`{.sample}

:   Cumulative number of frames detected as progressive using
    single-frame detection.

`multiple.progressive`{.sample}

:   Cumulative number of frames detected as progressive using
    multiple-frame detection.

`single.undetermined`{.sample}

:   Cumulative number of frames that could not be classified using
    single-frame detection.

`multiple.undetermined`{.sample}

:   Cumulative number of frames that could not be classified using
    multiple-frame detection.

`repeated.current_frame`{.sample}

:   Which field in the current frame is repeated from the last. One of
    "neither", "top", or "bottom".

`repeated.neither`{.sample}

:   Cumulative number of frames with no repeated field.

`repeated.top`{.sample}

:   Cumulative number of frames with the top field repeated from the
    previous frame's top field.

`repeated.bottom`{.sample}

:   Cumulative number of frames with the bottom field repeated from the
    previous frame's bottom field.

The filter accepts the following options:

`intl_thres`{.sample}

:   Set interlacing threshold.

`prog_thres`{.sample}

:   Set progressive threshold.

`rep_thres`{.sample}

:   Threshold for repeated field detection.

`half_life`{.sample}

:   Number of frames after which a given frame's contribution to the
    statistics is halved (i.e., it contributes only 0.5 to its
    classification). The default of 0 means that all frames seen are
    given full weight of 1.0 forever.

`analyze_interlaced_flag`{.sample}

:   When this is not 0 then idet will use the specified number of frames
    to determine if the interlaced flag is accurate, it will not count
    undetermined frames. If the flag is found to be accurate it will be
    used without any further computations, if it is found to be
    inaccurate it will be cleared without any further computations. This
    allows inserting the idet filter as a low computational method to
    clean up the interlaced flag

[]{#Examples-133}

#### [39.133.1 Examples](#toc-Examples-133) {#examples-133 .subsection}

Inspect the field order of the first 360 frames in a video, in verbose
detail:

::: example
``` example
ffmpeg -i INPUT -filter:v idet,metadata=mode=print -frames:v 360 -an -f null -
```
:::

The idet filter will add analysis metadata to each frame, which will
then be discarded. At the end, the filter will also print a final report
with statistics.

[]{#il}

### [39.134 il](#toc-il) {#il .section}

Deinterleave or interleave fields.

This filter allows one to process interlaced images fields without
deinterlacing them. Deinterleaving splits the input frame into 2 fields
(so called half pictures). Odd lines are moved to the top half of the
output image, even lines to the bottom half. You can process (filter)
them independently and then re-interleave them.

The filter accepts the following options:

`luma_mode, l`{.sample}\
`chroma_mode, c`{.sample}\
`alpha_mode, a`{.sample}

:   Available values for `luma_mode`{.variable},
    `chroma_mode`{.variable} and `alpha_mode`{.variable} are:

    '`none`{.sample}'

    :   Do nothing.

    '`deinterleave, d`{.sample}'

    :   Deinterleave fields, placing one above the other.

    '`interleave, i`{.sample}'

    :   Interleave fields. Reverse the effect of deinterleaving.

    Default value is `none`.

`luma_swap, ls`{.sample}\
`chroma_swap, cs`{.sample}\
`alpha_swap, as`{.sample}

:   Swap luma/chroma/alpha fields. Exchange even & odd lines. Default
    value is `0`.

[]{#Commands-100}

#### [39.134.1 Commands](#toc-Commands-100) {#commands-100 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#inflate}

### [39.135 inflate](#toc-inflate) {#inflate .section}

Apply inflate effect to the video.

This filter replaces the pixel by the local(3x3) average by taking into
account only values higher than the pixel.

It accepts the following options:

`threshold0`{.sample}\
`threshold1`{.sample}\
`threshold2`{.sample}\
`threshold3`{.sample}

:   Limit the maximum change for each plane, default is 65535. If 0,
    plane will remain unchanged.

[]{#Commands-101}

#### [39.135.1 Commands](#toc-Commands-101) {#commands-101 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#interlace_002c-interlace_005fvulkan}

### [39.136 interlace, interlace_vulkan](#toc-interlace_002c-interlace_005fvulkan) {#interlace-interlace_vulkan .section}

Simple interlacing filter from progressive contents. This interleaves
upper (or lower) lines from odd frames with lower (or upper) lines from
even frames, halving the frame rate and preserving image height.

::: example
``` example
   Original        Original             New Frame
   Frame 'j'      Frame 'j+1'             (tff)
  ==========      ===========       ==================
    Line 0  -------------------->    Frame 'j' Line 0
    Line 1          Line 1  ---->   Frame 'j+1' Line 1
    Line 2 --------------------->    Frame 'j' Line 2
    Line 3          Line 3  ---->   Frame 'j+1' Line 3
     ...             ...                   ...
New Frame + 1 will be generated by Frame 'j+2' and Frame 'j+3' and so on
```
:::

It accepts the following optional parameters:

`scan`{.sample}

:   This determines whether the interlaced frame is taken from the even
    (tff - default) or odd (bff) lines of the progressive frame.

`lowpass`{.sample}

:   Vertical lowpass filter to avoid twitter interlacing and reduce
    moire patterns.

    '`0, off`{.sample}'

    :   Disable vertical lowpass filter

    '`1, linear`{.sample}'

    :   Enable linear filter (default)

    '`2, complex`{.sample}'

    :   Enable complex filter. This will slightly less reduce twitter
        and moire but better retain detail and subjective sharpness
        impression.

[]{#kerndeint}

### [39.137 kerndeint](#toc-kerndeint) {#kerndeint .section}

Deinterlace input video by applying Donald Graft's adaptive kernel
deinterling. Work on interlaced parts of a video to produce progressive
frames.

The description of the accepted parameters follows.

`thresh`{.sample}

:   Set the threshold which affects the filter's tolerance when
    determining if a pixel line must be processed. It must be an integer
    in the range \[0,255\] and defaults to 10. A value of 0 will result
    in applying the process on every pixels.

`map`{.sample}

:   Paint pixels exceeding the threshold value to white if set to 1.
    Default is 0.

`order`{.sample}

:   Set the fields order. Swap fields if set to 1, leave fields alone
    if 0. Default is 0.

`sharp`{.sample}

:   Enable additional sharpening if set to 1. Default is 0.

`twoway`{.sample}

:   Enable twoway sharpening if set to 1. Default is 0.

[]{#Examples-134}

#### [39.137.1 Examples](#toc-Examples-134) {#examples-134 .subsection}

- Apply default values:

  ::: example
  ``` example
  kerndeint=thresh=10:map=0:order=0:sharp=0:twoway=0
  ```
  :::
- Enable additional sharpening:

  ::: example
  ``` example
  kerndeint=sharp=1
  ```
  :::
- Paint processed pixels in white:

  ::: example
  ``` example
  kerndeint=map=1
  ```
  :::

[]{#kirsch}

### [39.138 kirsch](#toc-kirsch) {#kirsch .section}

Apply kirsch operator to input video stream.

The filter accepts the following option:

`planes`{.sample}

:   Set which planes will be processed, unprocessed planes will be
    copied. By default value 0xf, all planes will be processed.

`scale`{.sample}

:   Set value which will be multiplied with filtered result.

`delta`{.sample}

:   Set value which will be added to filtered result.

[]{#Commands-102}

#### [39.138.1 Commands](#toc-Commands-102) {#commands-102 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#lagfun}

### [39.139 lagfun](#toc-lagfun) {#lagfun .section}

Slowly update darker pixels.

This filter makes short flashes of light appear longer. This filter
accepts the following options:

`decay`{.sample}

:   Set factor for decaying. Default is .95. Allowed range is from 0 to
    1.

`planes`{.sample}

:   Set which planes to filter. Default is all. Allowed range is from 0
    to 15.

[]{#Commands-103}

#### [39.139.1 Commands](#toc-Commands-103) {#commands-103 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#lenscorrection}

### [39.140 lenscorrection](#toc-lenscorrection) {#lenscorrection .section}

Correct radial lens distortion

This filter can be used to correct for radial distortion as can result
from the use of wide angle lenses, and thereby re-rectify the image. To
find the right parameters one can use tools available for example as
part of opencv or simply trial-and-error. To use opencv use the
calibration sample (under samples/cpp) from the opencv sources and
extract the k1 and k2 coefficients from the resulting matrix.

Note that effectively the same filter is available in the open-source
tools Krita and Digikam from the KDE project.

In contrast to the [vignette](#vignette) filter, which can also be used
to compensate lens errors, this filter corrects the distortion of the
image, whereas [vignette](#vignette) corrects the brightness
distribution, so you may want to use both filters together in certain
cases, though you will have to take care of ordering, i.e. whether
vignetting should be applied before or after lens correction.

[]{#Options-120}

#### [39.140.1 Options](#toc-Options-120) {#options-120 .subsection}

The filter accepts the following options:

`cx`{.sample}

:   Relative x-coordinate of the focal point of the image, and thereby
    the center of the distortion. This value has a range \[0,1\] and is
    expressed as fractions of the image width. Default is 0.5.

`cy`{.sample}

:   Relative y-coordinate of the focal point of the image, and thereby
    the center of the distortion. This value has a range \[0,1\] and is
    expressed as fractions of the image height. Default is 0.5.

`k1`{.sample}

:   Coefficient of the quadratic correction term. This value has a range
    \[-1,1\]. 0 means no correction. Default is 0.

`k2`{.sample}

:   Coefficient of the double quadratic correction term. This value has
    a range \[-1,1\]. 0 means no correction. Default is 0.

`i`{.sample}

:   Set interpolation type. Can be `nearest` or `bilinear`. Default is
    `nearest`.

`fc`{.sample}

:   Specify the color of the unmapped pixels. For the syntax of this
    option, check the [(ffmpeg-utils)\"Color\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#color-syntax). Default color
    is `black@0`.

The formula that generates the correction is:

`r_src`{.variable} = `r_tgt`{.variable} \* (1 + `k1`{.variable} \*
(`r_tgt`{.variable} / `r_0`{.variable})\^2 + `k2`{.variable} \*
(`r_tgt`{.variable} / `r_0`{.variable})\^4)

where `r_0`{.variable} is halve of the image diagonal and
`r_src`{.variable} and `r_tgt`{.variable} are the distances from the
focal point in the source and target images, respectively.

[]{#Commands-104}

#### [39.140.2 Commands](#toc-Commands-104) {#commands-104 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#lensfun}

### [39.141 lensfun](#toc-lensfun) {#lensfun .section}

Apply lens correction via the lensfun library
(<http://lensfun.sourceforge.net/>).

The `lensfun` filter requires the camera make, camera model, and lens
model to apply the lens correction. The filter will load the lensfun
database and query it to find the corresponding camera and lens entries
in the database. As long as these entries can be found with the given
options, the filter can perform corrections on frames. Note that
incomplete strings will result in the filter choosing the best match
with the given options, and the filter will output the chosen camera and
lens models (logged with level \"info\"). You must provide the make,
camera model, and lens model as they are required.

To obtain a list of available makes and models, leave out one or both of
`make` and `model` options. The filter will send the full list to the
log with level `INFO`. The first column is the make and the second
column is the model. To obtain a list of available lenses, set any
values for make and model and leave out the `lens_model` option. The
filter will send the full list of lenses in the log with level `INFO`.
The ffmpeg tool will exit after the list is printed.

The filter accepts the following options:

`make`{.sample}

The make of the camera (for example, \"Canon\"). This option is
required.

`model`{.sample}

The model of the camera (for example, \"Canon EOS 100D\"). This option
is required.

`lens_model`{.sample}

The model of the lens (for example, \"Canon EF-S 18-55mm f/3.5-5.6 IS
STM\"). This option is required.

`db_path`{.sample}

The full path to the lens database folder. If not set, the filter will
attempt to load the database from the install path when the library was
built. Default is unset.

`mode`{.sample}

The type of correction to apply. The following values are valid options:

'`vignetting`{.sample}'

:   Enables fixing lens vignetting.

'`geometry`{.sample}'

:   Enables fixing lens geometry. This is the default.

'`subpixel`{.sample}'

:   Enables fixing chromatic aberrations.

'`vig_geo`{.sample}'

:   Enables fixing lens vignetting and lens geometry.

'`vig_subpixel`{.sample}'

:   Enables fixing lens vignetting and chromatic aberrations.

'`distortion`{.sample}'

:   Enables fixing both lens geometry and chromatic aberrations.

'`all`{.sample}'

:   Enables all possible corrections.

`focal_length`{.sample}

The focal length of the image/video (zoom; expected constant for video).
For example, a 18--55mm lens has focal length range of \[18--55\], so a
value in that range should be chosen when using that lens. Default 18.

`aperture`{.sample}

The aperture of the image/video (expected constant for video). Note that
aperture is only used for vignetting correction. Default 3.5.

`focus_distance`{.sample}

The focus distance of the image/video (expected constant for video).
Note that focus distance is only used for vignetting and only slightly
affects the vignetting correction process. If unknown, leave it at the
default value (which is 1000).

`scale`{.sample}

The scale factor which is applied after transformation. After correction
the video is no longer necessarily rectangular. This parameter controls
how much of the resulting image is visible. The value 0 means that a
value will be chosen automatically such that there is little or no
unmapped area in the output image. 1.0 means that no additional scaling
is done. Lower values may result in more of the corrected image being
visible, while higher values may avoid unmapped areas in the output.

`target_geometry`{.sample}

The target geometry of the output image/video. The following values are
valid options:

'`rectilinear (default)`{.sample}'

'`fisheye`{.sample}'

'`panoramic`{.sample}'

'`equirectangular`{.sample}'

'`fisheye_orthographic`{.sample}'

'`fisheye_stereographic`{.sample}'

'`fisheye_equisolid`{.sample}'

'`fisheye_thoby`{.sample}'

`reverse`{.sample}

Apply the reverse of image correction (instead of correcting distortion,
apply it).

`interpolation`{.sample}

The type of interpolation used when correcting distortion. The following
values are valid options:

'`nearest`{.sample}'

'`linear (default)`{.sample}'

'`lanczos`{.sample}'

[]{#Examples-135}

#### [39.141.1 Examples](#toc-Examples-135) {#examples-135 .subsection}

- Apply lens correction with make \"Canon\", camera model \"Canon EOS
  100D\", and lens model \"Canon EF-S 18-55mm f/3.5-5.6 IS STM\" with
  focal length of \"18\" and aperture of \"8.0\".

  ::: example
  ``` example
  ffmpeg -i input.mov -vf lensfun=make=Canon:model="Canon EOS 100D":lens_model="Canon EF-S 18-55mm f/3.5-5.6 IS STM":focal_length=18:aperture=8 -c:v h264 -b:v 8000k output.mov
  ```
  :::
- Apply the same as before, but only for the first 5 seconds of video.

  ::: example
  ``` example
  ffmpeg -i input.mov -vf lensfun=make=Canon:model="Canon EOS 100D":lens_model="Canon EF-S 18-55mm f/3.5-5.6 IS STM":focal_length=18:aperture=8:enable='lte(t\,5)' -c:v h264 -b:v 8000k output.mov
  ```
  :::

[]{#lcevc}

### [39.142 lcevc](#toc-lcevc) {#lcevc .section}

Low Complexity Enhancement Video Codec filter based on liblcevc_dec
(<https://github.com/v-novaltd/LCEVCdec>).

[]{#libplacebo}

### [39.143 libplacebo](#toc-libplacebo) {#libplacebo .section}

Flexible GPU-accelerated processing filter based on libplacebo
(<https://code.videolan.org/videolan/libplacebo>).

[]{#Options-121}

#### [39.143.1 Options](#toc-Options-121) {#options-121 .subsection}

The options for this filter are divided into the following sections:

[]{#Output-mode}

#### [39.143.1.1 Output mode](#toc-Output-mode) {#output-mode .subsubsection}

These options control the overall output mode. By default, libplacebo
will try to preserve the source colorimetry and size as best as it can,
but it will apply any embedded film grain, dolby vision metadata or
anamorphic SAR present in source frames.

`inputs`{.sample}

Set the number of inputs. This can be used, alongside the `idx`
variable, to allow placing/blending multiple inputs inside the output
frame. This effectively enables functionality similar to
[hstack](#hstack), [overlay](#overlay), etc.

`w`{.sample}

`h`{.sample}

Set the output video dimension expression. Default values are `iw` and
`ih`.

Allows for the same expressions as the [scale](#scale) filter.

`crop_x`{.sample}

`crop_y`{.sample}

Set the input crop x/y expressions, default values are `(iw-cw)/2` and
`(ih-ch)/2`.

`crop_w`{.sample}

`crop_h`{.sample}

Set the input crop width/height expressions, default values are `iw` and
`ih`.

`pos_x`{.sample}

`pos_y`{.sample}

Set the output placement x/y expressions, default values are `(ow-pw)/2`
and `(oh-ph)/2`.

`pos_w`{.sample}

`pos_h`{.sample}

Set the output placement width/height expressions, default values are
`ow` and `oh`.

`rotate`{.sample}

Rotate the input frame clockwise by the specified angle.

'`0, 360`{.sample}'

'`90`{.sample}'

'`180`{.sample}'

'`270`{.sample}'

`fps`{.sample}

Set the output frame rate. This can be rational, e.g. `60000/1001`. If
set to the special string `none` (the default), input timestamps will
instead be passed through to the output unmodified. Otherwise, the input
video frames will be interpolated as necessary to rescale the video to
the specified target framerate, in a manner as determined by the
`frame_mixer`{.sample} option.

`format`{.sample}

Set the output format override. If unset (the default), frames will be
output in the same format as the respective input frames. Otherwise,
format conversion will be performed.

`force_original_aspect_ratio`{.sample}

`force_divisible_by`{.sample}

Work the same as the identical [scale](#scale) filter options. Note that
`force_divisible_by`{.sample} also works with `fit_sense=constraint`.

`reset_sar`{.sample}

If enabled, output frames will always have a pixel aspect ratio of 1:1.
If disabled (the default), any aspect ratio mismatches, including those
from e.g. anamorphic video sources, are forwarded to the output pixel
aspect ratio.

`normalize_sar`{.sample}

Like `reset_sar`{.sample}, but instead of stretching the video content
to fill the new output aspect ratio, the content is instead padded or
cropped as necessary. Mutually exclusive with `fit_mode`{.sample}.
Disabled by default.

`pad_crop_ratio`{.sample}

Specifies a ratio (between `0.0` and `1.0`) between padding and cropping
when the input aspect ratio does not match the output aspect ratio and
`normalize_sar`{.sample} is in effect. The default of `0.0` always pads
the content with black borders, while a value of `1.0` always crops off
parts of the content. Intermediate values are possible, leading to a mix
of the two approaches.

`fit_mode`{.sample}

Specify the content fit strategy according to a list of predefined
modes. Determines how the input image is to be placed inside the
destination crop rectangle (as defined by `pos_x/y` and `pos_w/h`). The
names and their implementations are taken from the CSS 'object-fit'
property. Note that this option is mutually exclusive with
`normalize_sar`{.sample}. Defaults to `fill`. Valid values are:

'`fill`{.sample}'

:   Stretch the input to the output rectangle, ignoring aspect ratio
    mismatches. Note that unless `reset_sar`{.sample} is also enabled,
    the output will still have the correct pixel aspect ratio tagged.

'`contain`{.sample}'

:   Scale the input to fit inside the output, preserving aspect ratio by
    padding. Equivalent to `normalize_sar`{.sample} with
    `pad_crop_ratio`{.sample} set to `0.0`.

'`cover`{.sample}'

:   Scale the input to fill the output, preserving aspect ratio by
    cropping. Equivalent to `normalize_sar`{.sample} with
    `pad_crop_ratio`{.sample} set to `1.0`.

'`none, place`{.sample}'

:   Don't scale the input. The input will be placed inside the output
    rectangle at its natural size; which may result in additional
    padding or cropping.

'`scale_down`{.sample}'

:   Scale the input down as much as needed to fit inside the output.
    Equivalent to either `contain` or `none`, depending on whether the
    input is larger than the output or not.

`fit_sense`{.sample}

When `fit_mode`{.sample} is in use, this option controls how the fit
strategy is applied against the specified output resolution. Mutually
exclusive with `force_original_aspect_ratio`{.sample}. Valid values are:

'`target`{.sample}'

:   The computed output resolution is taken as the exact size of the
    output frame. This is the default behavior.

'`constraint`{.sample}'

:   The computed output resolution is a size reference against which the
    fit mode is applied, enlarging or decreasing the true frame size as
    needed to fit the content.

`fillcolor`{.sample}

Set the color used to fill the output area not covered by the output
image, for example as a result of `normalize_sar`{.sample}. For the
general syntax of this option, check the [(ffmpeg-utils)\"Color\"
section in the ffmpeg-utils manual](ffmpeg-utils.html#color-syntax).
Defaults to `black@0`.

`corner_rounding`{.sample}

Render frames with rounded corners. The value, given as a float ranging
from `0.0` to `1.0`, indicates the relative degree of rounding, from
fully square to fully circular. In other words, it gives the radius
divided by half the smaller side length. Defaults to `0.0`.

`lut`{.sample}

Specifies a custom LUT (in Adobe .cube format) to apply to the colors as
part of color conversion. The exact interpretation depends on the value
of `lut_type`{.sample}.

`lut_type`{.sample}

Controls the interpretation of color values fed to and from the LUT
specified as `lut`{.sample}. Valid values are:

'`auto`{.sample}'

:   Chooses the interpretation of the LUT automatically from tagged
    metadata, and otherwise falls back to '`native`{.sample}'. (Default)

'`native`{.sample}'

:   Applied to raw image contents in its native RGB colorspace
    (non-linear light), before conversion to the output color space.

'`normalized`{.sample}'

:   Applied to the normalized RGB image contents, in linear light,
    before conversion to the output color space.

'`conversion`{.sample}'

:   Fully replaces the conversion from the image color space to the
    output color space. If such a LUT is present, it has the highest
    priority, and overrides any ICC profiles, as well as options related
    to tone mapping and output colorimetry (`color_primaries`{.sample},
    `color_trc`{.sample}).

`extra_opts`{.sample}

Pass extra libplacebo internal configuration options. These can be
specified as a list of `key`{.variable}=`value`{.variable} pairs
separated by ':'. The following example shows how to configure a custom
filter kernel (\"EWA LanczosSharp\") and use it to double the input
image resolution:

::: example
``` example
-vf "libplacebo=w=iw*2:h=ih*2:extra_opts='upscaler=custom\:upscaler_preset=ewa_lanczos\:upscaler_blur=0.9812505644269356'"
```
:::

`shader_cache`{.sample}

File path of a cache directory that libplacebo will use to store and
load cached shader objects. This cache is not cleaned up automatically.
If the path does not end in a directory separator, the generated
filenames will be effectively prefixed by the last path component. All
directories must already exist.

::: example
``` example
-vf "libplacebo=shader_cache=/tmp/pl-shader-"
```
:::

`colorspace`{.sample}

`color_primaries`{.sample}

`color_trc`{.sample}

`range`{.sample}

`chroma_location`{.sample}

Configure the colorspace that output frames will be delivered in. The
default value of `auto` outputs frames in the same format as the input
frames, leading to no change. For any other value, conversion will be
performed.

See the [setparams](#setparams) filter for a list of possible values.

`alpha_mode`{.sample}

Choose the desired output alpha mode, when the output format has an
alpha channel. See the [setparams](#setparams) filter for a list of
possible values.

`apply_filmgrain`{.sample}

Apply film grain (e.g. AV1 or H.274) if present in source frames, and
strip it from the output. Enabled by default.

`apply_dolbyvision`{.sample}

Apply Dolby Vision RPU metadata if present in source frames, and strip
it from the output. Enabled by default. Note that Dolby Vision will
always output BT.2020+PQ, overriding the usual input frame metadata.
These will also be picked as the values of `auto` for the respective
frame output options.

In addition to the expression constants documented for the
[scale](#scale) filter, the `crop_w`{.sample}, `crop_h`{.sample},
`crop_x`{.sample}, `crop_y`{.sample}, `pos_w`{.sample},
`pos_h`{.sample}, `pos_x`{.sample} and `pos_y`{.sample} options can also
contain the following constants:

`in_idx, idx`{.sample}

:   The (0-based) numeric index of the currently active input stream.

`crop_w, cw`{.sample}\
`crop_h, ch`{.sample}

:   The computed values of `crop_w`{.sample} and `crop_h`{.sample}.

`pos_w, pw`{.sample}\
`pos_h, ph`{.sample}

:   The computed values of `pos_w`{.sample} and `pos_h`{.sample}.

`in_t, t`{.sample}

:   The input frame timestamp, in seconds. NAN if input timestamp is
    unknown.

`out_t, ot`{.sample}

:   The input frame timestamp, in seconds. NAN if input timestamp is
    unknown.

`n`{.sample}

:   The input frame number, starting with 0.

[]{#Scaling}

#### [39.143.1.2 Scaling](#toc-Scaling) {#scaling .subsubsection}

The options in this section control how libplacebo performs upscaling
and (if necessary) downscaling. Note that libplacebo will always
internally operate on 4:4:4 content, so any sub-sampled chroma formats
such as `yuv420p` will necessarily be upsampled and downsampled as part
of the rendering process. That means scaling might be in effect even if
the source and destination resolution are the same.

`upscaler`{.sample}\
`downscaler`{.sample}

:   Configure the filter kernel used for upscaling and downscaling. The
    respective defaults are `spline36` and `mitchell`. For a full list
    of possible values, pass `help` to these options. The most important
    values are:

    '`none`{.sample}'

    :   Forces the use of built-in GPU texture sampling (typically
        bilinear). Extremely fast but poor quality, especially when
        downscaling.

    '`bilinear`{.sample}'

    :   Bilinear interpolation. Can generally be done for free on GPUs,
        except when doing so would lead to aliasing. Fast and low
        quality.

    '`nearest`{.sample}'

    :   Nearest-neighbour interpolation. Sharp but highly aliasing.

    '`oversample`{.sample}'

    :   Algorithm that looks visually similar to nearest-neighbour
        interpolation but tries to preserve pixel aspect ratio. Good for
        pixel art, since it results in minimal distortion of the
        artistic appearance.

    '`lanczos`{.sample}'

    :   Standard sinc-sinc interpolation kernel.

    '`spline36`{.sample}'

    :   Cubic spline approximation of lanczos. No difference in
        performance, but has very slightly less ringing.

    '`ewa_lanczos`{.sample}'

    :   Elliptically weighted average version of lanczos, based on a
        jinc-jinc kernel. This is also popularly referred to as just
        \"Jinc scaling\". Slow but very high quality.

    '`gaussian`{.sample}'

    :   Gaussian kernel. Has certain ideal mathematical properties, but
        subjectively very blurry.

    '`mitchell`{.sample}'

    :   Cubic BC spline with parameters recommended by Mitchell and
        Netravali. Very little ringing.

`frame_mixer`{.sample}

:   Controls the kernel used for mixing frames temporally. The default
    value is `none`, which disables frame mixing. For a full list of
    possible values, pass `help` to this option. The most important
    values are:

    '`none`{.sample}'

    :   Disables frame mixing, giving a result equivalent to \"nearest
        neighbour\" semantics.

    '`oversample`{.sample}'

    :   Oversamples the input video to create a \"Smooth Motion\"-type
        effect: if an output frame would exactly fall on the transition
        between two video frames, it is blended according to the
        relative overlap. This is the recommended option whenever
        preserving the original subjective appearance is desired.

    '`mitchell_clamp`{.sample}'

    :   Larger filter kernel that smoothly interpolates multiple frames
        in a manner designed to eliminate ringing and other artefacts as
        much as possible. This is the recommended option wherever
        maximum visual smoothness is desired.

    '`linear`{.sample}'

    :   Linear blend/fade between frames. Especially useful for
        constructing e.g. slideshows.

`antiringing`{.sample}

:   Enables anti-ringing (for non-EWA filters). The value (between `0.0`
    and `1.0`) configures the strength of the anti-ringing algorithm.
    May increase aliasing if set too high. Disabled by default.

`sigmoid`{.sample}

:   Enable sigmoidal compression during upscaling. Reduces ringing
    slightly. Enabled by default.

[]{#Deinterlacing}

#### [39.143.1.3 Deinterlacing](#toc-Deinterlacing) {#deinterlacing .subsubsection}

Deinterlacing is automatically supported when frames are tagged as
interlaced, however frames are not deinterlaced unless a deinterlacing
algorithm is chosen.

`deinterlace`{.sample}

:   The the deinterlacing algorithm to use.

    '`weave`{.sample}'

    :   No deinterlacing, weave fields together into a single frame.
        This is the default.

    '`bob`{.sample}'

    :   Naive bob deinterlacing, simply repeat each field line twice.

    '`yadif`{.sample}'

    :   Yet another deinterlacing filter. See the [yadif](#yadif) filter
        for more details.

    '`bwdif`{.sample}'

    :   Bob weaver deinterlacing filter. See the [bwdif](#bwdif) filter
        for more details.

`skip_spatial_check`{.sample}

:   Skip the spatial deinterlacing check when using `yadif`
    deinterlacing.

`send_fields`{.sample}

:   Output a frame for each field, rather than for each frame. Note that
    this will always double the tagged output frame rate, even if the
    input does not contain any interlaced frames. Disabled by default.

[]{#Debanding}

#### [39.143.1.4 Debanding](#toc-Debanding) {#debanding .subsubsection}

Libplacebo comes with a built-in debanding filter that is good at
counteracting many common sources of banding and blocking. Turning this
on is highly recommended whenever quality is desired.

`deband`{.sample}

:   Enable (fast) debanding algorithm. Disabled by default.

`deband_iterations`{.sample}

:   Number of deband iterations of the debanding algorithm. Each
    iteration is performed with progressively increased radius (and
    diminished threshold). Recommended values are in the range `1` to
    `4`. Defaults to `1`.

`deband_threshold`{.sample}

:   Debanding filter strength. Higher numbers lead to more aggressive
    debanding. Defaults to `4.0`.

`deband_radius`{.sample}

:   Debanding filter radius. A higher radius is better for slow
    gradients, while a lower radius is better for steep gradients.
    Defaults to `16.0`.

`deband_grain`{.sample}

:   Amount of extra output grain to add. Helps hide imperfections.
    Defaults to `6.0`.

[]{#Color-adjustment}

#### [39.143.1.5 Color adjustment](#toc-Color-adjustment) {#color-adjustment .subsubsection}

A collection of subjective color controls. Not very rigorous, so the
exact effect will vary somewhat depending on the input primaries and
colorspace.

`brightness`{.sample}

:   Brightness boost, between `-1.0` and `1.0`. Defaults to `0.0`.

`contrast`{.sample}

:   Contrast gain, between `0.0` and `16.0`. Defaults to `1.0`.

`saturation`{.sample}

:   Saturation gain, between `0.0` and `16.0`. Defaults to `1.0`.

`hue`{.sample}

:   Hue shift in radians, between `-3.14` and `3.14`. Defaults to `0.0`.
    This will rotate the UV subvector, defaulting to BT.709 coefficients
    for RGB inputs.

`gamma`{.sample}

:   Gamma adjustment, between `0.0` and `16.0`. Defaults to `1.0`.

`temperature`{.sample}

:   Color temperature adjustment. Lower values make the output
    warmer/redder, down to `1667`, while higher values make the output
    cooler/bluer, up to `25000`. Defaults to `6500` (neutral white).

`cones`{.sample}

:   Cone model to use for color blindness simulation. Accepts any
    combination of `l`, `m` and `s`. Here are some examples:

    '`m`{.sample}'

    :   Deuteranomaly / deuteranopia (affecting 3%-4% of the population)

    '`l`{.sample}'

    :   Protanomaly / protanopia (affecting 1%-2% of the population)

    '`l+m`{.sample}'

    :   Monochromacy (very rare)

    '`l+m+s`{.sample}'

    :   Achromatopsy (complete loss of daytime vision, extremely rare)

`cone-strength`{.sample}

:   Gain factor for the cones specified by `cones`, between `0.0` and
    `10.0`. A value of `1.0` results in no change to color vision. A
    value of `0.0` (the default) simulates complete loss of those cones.
    Values above `1.0` result in exaggerating the differences between
    cones, which may help compensate for reduced color vision.

[]{#Peak-detection}

#### [39.143.1.6 Peak detection](#toc-Peak-detection) {#peak-detection .subsubsection}

To help deal with sources that only have static HDR10 metadata (or no
tagging whatsoever), libplacebo uses its own internal frame analysis
compute shader to analyze source frames and adapt the tone mapping
function in realtime. If this is too slow, or if exactly reproducible
frame-perfect results are needed, it's recommended to turn this feature
off.

`peak_detect`{.sample}

:   Enable HDR peak detection. Ignores static MaxCLL/MaxFALL values in
    favor of dynamic detection from the input. Note that the detected
    values do not get written back to the output frames, they merely
    guide the internal tone mapping process. Enabled by default.

`smoothing_period`{.sample}

:   Peak detection smoothing period, between `0.0` and `1000.0`. Higher
    values result in peak detection becoming less responsive to changes
    in the input. Defaults to `100.0`.

`scene_threshold_low`{.sample}\
`scene_threshold_high`{.sample}

:   Lower and upper thresholds for scene change detection. Expressed in
    a logarithmic scale between `0.0` and `100.0`. Default to `5.5` and
    `10.0`, respectively. Setting either to a negative value disables
    this functionality.

`percentile`{.sample}

:   Which percentile of the frame brightness histogram to use as the
    source peak for tone-mapping. Defaults to `99.995`, a fairly
    conservative value. Setting this to `100.0` disables frame histogram
    measurement and instead uses the true peak brightness for
    tone-mapping.

[]{#Tone-mapping}

#### [39.143.1.7 Tone mapping](#toc-Tone-mapping) {#tone-mapping .subsubsection}

The options in this section control how libplacebo performs tone-mapping
and gamut-mapping when dealing with mismatches between wide-gamut or HDR
content. In general, libplacebo relies on accurate source tagging and
mastering display gamut information to produce the best results.

`gamut_mode`{.sample}

:   How to handle out-of-gamut colors that can occur as a result of
    colorimetric gamut mapping.

    '`clip`{.sample}'

    :   Do nothing, simply clip out-of-range colors to the RGB volume.
        Low quality but extremely fast.

    '`perceptual`{.sample}'

    :   Perceptually soft-clip colors to the gamut volume. This is the
        default.

    '`relative`{.sample}'

    :   Relative colorimetric hard-clip. Similar to `perceptual` but
        without the soft knee.

    '`saturation`{.sample}'

    :   Saturation mapping, maps primaries directly to primaries in RGB
        space. Not recommended except for artificial computer graphics
        for which a bright, saturated display is desired.

    '`absolute`{.sample}'

    :   Absolute colorimetric hard-clip. Performs no adjustment of the
        white point.

    '`desaturate`{.sample}'

    :   Hard-desaturates out-of-gamut colors towards white, while
        preserving the luminance. Has a tendency to distort the visual
        appearance of bright objects.

    '`darken`{.sample}'

    :   Linearly reduces content brightness to preserves saturated
        details, followed by clipping the remaining out-of-gamut colors.

    '`warn`{.sample}'

    :   Highlight out-of-gamut pixels (by inverting/marking them).

    '`linear`{.sample}'

    :   Linearly reduces chromaticity of the entire image to make it fit
        within the target color volume. Be careful when using this on
        BT.2020 sources without proper mastering metadata, as doing so
        will lead to excessive desaturation.

`tonemapping`{.sample}

:   Tone-mapping algorithm to use. Available values are:

    '`auto`{.sample}'

    :   Automatic selection based on internal heuristics. This is the
        default.

    '`clip`{.sample}'

    :   Performs no tone-mapping, just clips out-of-range colors.
        Retains perfect color accuracy for in-range colors but
        completely destroys out-of-range information. Does not perform
        any black point adaptation. Not configurable.

    '`st2094-40`{.sample}'

    :   EETF from SMPTE ST 2094-40 Annex B, which applies the Bezier
        curves from HDR10+ dynamic metadata based on Bezier curves to
        perform tone-mapping. The OOTF used is adjusted based on the
        ratio between the targeted and actual display peak luminances.

    '`st2094-10`{.sample}'

    :   EETF from SMPTE ST 2094-10 Annex B.2, which takes into account
        the input signal average luminance in addition to the
        maximum/minimum. The configurable contrast parameter influences
        the slope of the linear output segment, defaulting to `1.0` for
        no increase/decrease in contrast. Note that this does not
        currently include the subjective gain/offset/gamma controls
        defined in Annex B.3.

    '`bt.2390`{.sample}'

    :   EETF from the ITU-R Report BT.2390, a hermite spline roll-off
        with linear segment. The knee point offset is configurable. Note
        that this parameter defaults to `1.0`, rather than the value of
        `0.5` from the ITU-R spec.

    '`bt.2446a`{.sample}'

    :   EETF from ITU-R Report BT.2446, method A. Designed for
        well-mastered HDR sources. Can be used for both forward and
        inverse tone mapping. Not configurable.

    '`spline`{.sample}'

    :   Simple spline consisting of two polynomials, joined by a single
        pivot point. The parameter gives the pivot point (in PQ space),
        defaulting to `0.30`. Can be used for both forward and inverse
        tone mapping.

    '`reinhard`{.sample}'

    :   Simple non-linear, global tone mapping algorithm. The parameter
        specifies the local contrast coefficient at the display peak.
        Essentially, a parameter of `0.5` implies that the reference
        white will be about half as bright as when clipping. Defaults to
        `0.5`, which results in the simplest formulation of this
        function.

    '`mobius`{.sample}'

    :   Generalization of the reinhard tone mapping algorithm to support
        an additional linear slope near black. The tone mapping
        parameter indicates the trade-off between the linear section and
        the non-linear section. Essentially, for a given parameter
        `x`{.variable}, every color value below `x`{.variable} will be
        mapped linearly, while higher values get non-linearly
        tone-mapped. Values near `1.0` make this curve behave like
        `clip`, while values near `0.0` make this curve behave like
        `reinhard`. The default value is `0.3`, which provides a good
        balance between colorimetric accuracy and preserving
        out-of-gamut details.

    '`hable`{.sample}'

    :   Piece-wise, filmic tone-mapping algorithm developed by John
        Hable for use in Uncharted 2, inspired by a similar tone-mapping
        algorithm used by Kodak. Popularized by its use in video games
        with HDR rendering. Preserves both dark and bright details very
        well, but comes with the drawback of changing the average
        brightness quite significantly. This is sort of similar to
        `reinhard` with parameter `0.24`.

    '`gamma`{.sample}'

    :   Fits a gamma (power) function to transfer between the source and
        target color spaces, effectively resulting in a perceptual
        hard-knee joining two roughly linear sections. This preserves
        details at all scales fairly accurately, but can result in an
        image with a muted or dull appearance. The parameter is used as
        the cutoff point, defaulting to `0.5`.

    '`linear`{.sample}'

    :   Linearly stretches the input range to the output range, in PQ
        space. This will preserve all details accurately, but results in
        a significantly different average brightness. Can be used for
        inverse tone-mapping in addition to regular tone-mapping. The
        parameter can be used as an additional linear gain coefficient
        (defaulting to `1.0`).

`tonemapping_param`{.sample}

:   For tunable tone mapping functions, this parameter can be used to
    fine-tune the curve behavior. Refer to the documentation of
    `tonemapping`. The default value of `0.0` is replaced by the curve's
    preferred default setting.

`inverse_tonemapping`{.sample}

:   If enabled, this filter will also attempt stretching SDR signals to
    fill HDR output color volumes. Disabled by default.

`tonemapping_lut_size`{.sample}

:   Size of the tone-mapping LUT, between `2` and `1024`. Defaults to
    `256`. Note that this figure is squared when combined with
    `peak_detect`.

`contrast_recovery`{.sample}

:   Contrast recovery strength. If set to a value above `0.0`, the
    source image will be divided into high-frequency and low-frequency
    components, and a portion of the high-frequency image is added back
    onto the tone-mapped output. May cause excessive ringing artifacts
    for some HDR sources, but can improve the subjective sharpness and
    detail left over in the image after tone-mapping. Defaults to
    `0.30`.

`contrast_smoothness`{.sample}

:   Contrast recovery lowpass kernel size. Defaults to `3.5`. Increasing
    or decreasing this will affect the visual appearance substantially.
    Has no effect when `contrast_recovery` is disabled.

[]{#Dithering}

#### [39.143.1.8 Dithering](#toc-Dithering) {#dithering .subsubsection}

By default, libplacebo will dither whenever necessary, which includes
rendering to any integer format below 16-bit precision. It's recommended
to always leave this on, since not doing so may result in visible
banding in the output, even if the `debanding` filter is enabled. If
maximum performance is needed, use `ordered_fixed` instead of disabling
dithering.

`dithering`{.sample}

:   Dithering method to use. Accepts the following values:

    '`none`{.sample}'

    :   Disables dithering completely. May result in visible banding.

    '`blue`{.sample}'

    :   Dither with pseudo-blue noise. This is the default.

    '`ordered`{.sample}'

    :   Tunable ordered dither pattern.

    '`ordered_fixed`{.sample}'

    :   Faster ordered dither with a fixed size of `6`. Texture-less.

    '`white`{.sample}'

    :   Dither with white noise. Texture-less.

`dither_lut_size`{.sample}

:   Dither LUT size, as log base2 between `1` and `8`. Defaults to `6`,
    corresponding to a LUT size of `64x64`.

`dither_temporal`{.sample}

:   Enables temporal dithering. Disabled by default.

[]{#Custom-shaders}

#### [39.143.1.9 Custom shaders](#toc-Custom-shaders) {#custom-shaders .subsubsection}

libplacebo supports a number of custom shaders based on the mpv .hook
GLSL syntax. A collection of such shaders can be found here:
<https://github.com/mpv-player/mpv/wiki/User-Scripts#user-shaders>

A full description of the mpv shader format is beyond the scope of this
section, but a summary can be found here:
<https://mpv.io/manual/master/#options-glsl-shader>

`custom_shader_path`{.sample}

:   Specifies a path to a custom shader file to load at runtime.

`custom_shader_bin`{.sample}

:   Specifies a complete custom shader as a raw string.

[]{#Debugging-_002f-performance}

#### [39.143.1.10 Debugging / performance](#toc-Debugging-_002f-performance) {#debugging-performance .subsubsection}

All of the options in this section default off. They may be of
assistance when attempting to squeeze the maximum performance at the
cost of quality.

`skip_aa`{.sample}

:   Disable anti-aliasing when downscaling.

`disable_linear`{.sample}

:   Disable linear light scaling.

`disable_builtin`{.sample}

:   Disable built-in GPU sampling (forces LUT).

`disable_fbos`{.sample}

:   Forcibly disable FBOs, resulting in loss of almost all
    functionality, but offering the maximum possible speed.

[]{#Commands-105}

#### [39.143.2 Commands](#toc-Commands-105) {#commands-105 .subsection}

This filter supports almost all of the above options as
[commands](#commands).

[]{#Examples-136}

#### [39.143.3 Examples](#toc-Examples-136) {#examples-136 .subsection}

- Tone-map input to standard gamut BT.709 output:

  ::: example
  ``` example
  libplacebo=colorspace=bt709:color_primaries=bt709:color_trc=bt709:range=tv
  ```
  :::
- Rescale input to fit into standard 1080p, with high quality scaling:

  ::: example
  ``` example
  libplacebo=w=1920:h=1080:force_original_aspect_ratio=decrease:normalize_sar=true:upscaler=ewa_lanczos:downscaler=ewa_lanczos
  ```
  :::
- Interpolate low FPS / VFR input to smoothed constant 60 fps output:

  ::: example
  ``` example
  libplacebo=fps=60:frame_mixer=mitchell_clamp
  ```
  :::
- Convert input to standard sRGB JPEG:

  ::: example
  ``` example
  libplacebo=format=yuv420p:colorspace=bt470bg:color_primaries=bt709:color_trc=iec61966-2-1:range=pc
  ```
  :::
- Use higher quality debanding settings:

  ::: example
  ``` example
  libplacebo=deband=true:deband_iterations=3:deband_radius=8:deband_threshold=6
  ```
  :::
- Run this filter on the CPU, on systems with Mesa installed (and with
  the most expensive options disabled):

  ::: example
  ``` example
  ffmpeg ... -init_hw_device vulkan:llvmpipe ... -vf libplacebo=upscaler=none:downscaler=none:peak_detect=false
  ```
  :::
- Suppress CPU-based AV1/H.274 film grain application in the decoder, in
  favor of doing it with this filter. Note that this is only a gain if
  the frames are either already on the GPU, or if you're using
  libplacebo for other purposes, since otherwise the VRAM roundtrip will
  more than offset any expected speedup.

  ::: example
  ``` example
  ffmpeg -export_side_data +film_grain ... -vf libplacebo=apply_filmgrain=true
  ```
  :::
- Interop with VAAPI hwdec to avoid round-tripping through RAM:

  ::: example
  ``` example
  ffmpeg -init_hw_device vulkan -hwaccel vaapi -hwaccel_output_format vaapi ... -vf libplacebo
  ```
  :::

[]{#libvmaf}[]{#libvmaf-1}

### [39.144 libvmaf](#toc-libvmaf-1) {#libvmaf .section}

Calculate the VMAF (Video Multi-Method Assessment Fusion) score for a
reference/distorted pair of input videos.

The first input is the distorted video, and the second input is the
reference video.

The obtained VMAF score is printed through the logging system.

It requires Netflix's vmaf library (libvmaf) as a pre-requisite. After
installing the library it can be enabled using:
`./configure --enable-libvmaf`.

The filter has following options:

`model`{.sample}

:   A '\|' delimited list of vmaf models. Each model can be configured
    with a number of parameters. Default value: `"version=vmaf_v0.6.1"`

`feature`{.sample}

:   A '\|' delimited list of features. Each feature can be configured
    with a number of parameters.

`log_path`{.sample}

:   Set the file path to be used to store log files.

`log_fmt`{.sample}

:   Set the format of the log file (xml, json, csv, or sub).

`pool`{.sample}

:   Set the pool method to be used for computing vmaf. Options are
    `min`, `harmonic_mean` or `mean` (default).

`n_threads`{.sample}

:   Set number of threads to be used when initializing libvmaf. Default
    value: `0`, no threads.

`n_subsample`{.sample}

:   Set frame subsampling interval to be used.

This filter also supports the [framesync](#framesync) options.

[]{#Examples-137}

#### [39.144.1 Examples](#toc-Examples-137) {#examples-137 .subsection}

- In the examples below, a distorted video `distorted.mpg`{.sample} is
  compared with a reference file `reference.mpg`{.sample}.
- Basic usage:

  ::: example
  ``` example
  ffmpeg -i distorted.mpg -i reference.mpg -lavfi libvmaf=log_path=output.xml -f null -
  ```
  :::
- Example with multiple models:

  ::: example
  ``` example
  ffmpeg -i distorted.mpg -i reference.mpg -lavfi libvmaf='model=version=vmaf_v0.6.1\\:name=vmaf|version=vmaf_v0.6.1neg\\:name=vmaf_neg' -f null -
  ```
  :::
- Example with multiple additional features:

  ::: example
  ``` example
  ffmpeg -i distorted.mpg -i reference.mpg -lavfi libvmaf='feature=name=psnr|name=ciede' -f null -
  ```
  :::
- Example with options and different containers:

  ::: example
  ``` example
  ffmpeg -i distorted.mpg -i reference.mkv -lavfi "[0:v]settb=AVTB,setpts=PTS-STARTPTS[main];[1:v]settb=AVTB,setpts=PTS-STARTPTS[ref];[main][ref]libvmaf=log_fmt=json:log_path=output.json" -f null -
  ```
  :::

[]{#libvmaf_005fcuda}

### [39.145 libvmaf_cuda](#toc-libvmaf_005fcuda) {#libvmaf_cuda .section}

This is the CUDA variant of the [libvmaf](#libvmaf) filter. It only
accepts CUDA frames.

It requires Netflix's vmaf library (libvmaf) as a pre-requisite. After
installing the library it can be enabled using:
`./configure --enable-nonfree --enable-ffnvcodec --enable-libvmaf`.

[]{#Examples-138}

#### [39.145.1 Examples](#toc-Examples-138) {#examples-138 .subsection}

- Basic usage showing CUVID hardware decoding and CUDA scaling with
  [scale_cuda](#scale_005fcuda):

  ::: example
  ``` example
  ffmpeg \
      -hwaccel cuda -hwaccel_output_format cuda -codec:v av1_cuvid -i dis.obu \
      -hwaccel cuda -hwaccel_output_format cuda -codec:v av1_cuvid -i ref.obu \
      -filter_complex "
          [0:v]scale_cuda=format=yuv420p[dis]; \
          [1:v]scale_cuda=format=yuv420p[ref]; \
          [dis][ref]libvmaf_cuda=log_fmt=json:log_path=output.json
      " \
      -f null -
  ```
  :::

[]{#limitdiff}

### [39.146 limitdiff](#toc-limitdiff) {#limitdiff .section}

Apply limited difference filter using second and optionally third video
stream.

The filter accepts the following options:

`threshold`{.sample}

:   Set the threshold to use when allowing certain differences between
    video streams. Any absolute difference value lower or exact than
    this threshold will pick pixel components from first video stream.

`elasticity`{.sample}

:   Set the elasticity of soft thresholding when processing video
    streams. This value multiplied with first one sets second threshold.
    Any absolute difference value greater or exact than second threshold
    will pick pixel components from second video stream. For values
    between those two threshold linear interpolation between first and
    second video stream will be used.

`reference`{.sample}

:   Enable the reference (third) video stream processing. By default is
    disabled. If set, this video stream will be used for calculating
    absolute difference with first video stream.

`planes`{.sample}

:   Specify which planes will be processed. Defaults to all available.

[]{#Commands-106}

#### [39.146.1 Commands](#toc-Commands-106) {#commands-106 .subsection}

This filter supports the all above options as [commands](#commands)
except option '`reference`{.sample}'.

[]{#limiter}

### [39.147 limiter](#toc-limiter) {#limiter .section}

Limits the pixel components values to the specified range \[min, max\].

The filter accepts the following options:

`min`{.sample}

:   Lower bound. Defaults to the lowest allowed value for the input.

`max`{.sample}

:   Upper bound. Defaults to the highest allowed value for the input.

`planes`{.sample}

:   Specify which planes will be processed. Defaults to all available.

[]{#Commands-107}

#### [39.147.1 Commands](#toc-Commands-107) {#commands-107 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#loop}

### [39.148 loop](#toc-loop) {#loop .section}

Loop video frames.

The filter accepts the following options:

`loop`{.sample}

:   Set the number of loops. Setting this value to -1 will result in
    infinite loops. Default is 0.

`size`{.sample}

:   Set maximal size in number of frames. Default is 0.

`start`{.sample}

:   Set first frame of loop. Default is 0.

`time`{.sample}

:   Set the time of loop start in seconds. Only used if option named
    `start`{.variable} is set to `-1`.

[]{#Examples-139}

#### [39.148.1 Examples](#toc-Examples-139) {#examples-139 .subsection}

- Loop single first frame infinitely:

  ::: example
  ``` example
  loop=loop=-1:size=1:start=0
  ```
  :::
- Loop single first frame 10 times:

  ::: example
  ``` example
  loop=loop=10:size=1:start=0
  ```
  :::
- Loop 10 first frames 5 times:

  ::: example
  ``` example
  loop=loop=5:size=10:start=0
  ```
  :::

[]{#lut1d}

### [39.149 lut1d](#toc-lut1d) {#lut1d .section}

Apply a 1D LUT to an input video.

The filter accepts the following options:

`file`{.sample}

:   Set the 1D LUT file name.

    Currently supported formats:

    '`cube`{.sample}'

    :   Iridas

    '`csp`{.sample}'

    :   cineSpace

`interp`{.sample}

:   Select interpolation mode.

    Available values are:

    '`nearest`{.sample}'

    :   Use values from the nearest defined point.

    '`linear`{.sample}'

    :   Interpolate values using the linear interpolation.

    '`cosine`{.sample}'

    :   Interpolate values using the cosine interpolation.

    '`cubic`{.sample}'

    :   Interpolate values using the cubic interpolation.

    '`spline`{.sample}'

    :   Interpolate values using the spline interpolation.

[]{#Commands-108}

#### [39.149.1 Commands](#toc-Commands-108) {#commands-108 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#lut3d}[]{#lut3d-1}

### [39.150 lut3d](#toc-lut3d-1) {#lut3d .section}

Apply a 3D LUT to an input video.

The filter accepts the following options:

`file`{.sample}

:   Set the 3D LUT file name.

    Currently supported formats:

    '`3dl`{.sample}'

    :   AfterEffects

    '`cube`{.sample}'

    :   Iridas

    '`dat`{.sample}'

    :   DaVinci

    '`m3d`{.sample}'

    :   Pandora

    '`csp`{.sample}'

    :   cineSpace

`interp`{.sample}

:   Select interpolation mode.

    Available values are:

    '`nearest`{.sample}'

    :   Use values from the nearest defined point.

    '`trilinear`{.sample}'

    :   Interpolate values using the 8 points defining a cube.

    '`tetrahedral`{.sample}'

    :   Interpolate values using a tetrahedron.

    '`pyramid`{.sample}'

    :   Interpolate values using a pyramid.

    '`prism`{.sample}'

    :   Interpolate values using a prism.

[]{#Commands-109}

#### [39.150.1 Commands](#toc-Commands-109) {#commands-109 .subsection}

This filter supports the `interp` option as [commands](#commands).

[]{#lumakey}

### [39.151 lumakey](#toc-lumakey) {#lumakey .section}

Turn certain luma values into transparency.

The filter accepts the following options:

`threshold`{.sample}

:   Set the luma which will be used as base for transparency. Default
    value is `0`.

`tolerance`{.sample}

:   Set the range of luma values to be keyed out. Default value is
    `0.01`.

`softness`{.sample}

:   Set the range of softness. Default value is `0`. Use this to control
    gradual transition from zero to full transparency.

[]{#Commands-110}

#### [39.151.1 Commands](#toc-Commands-110) {#commands-110 .subsection}

This filter supports same [commands](#commands) as options. The command
accepts the same syntax of the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#lutrgb}[]{#lutyuv}[]{#lut}[]{#lut_002c-lutrgb_002c-lutyuv}

### [39.152 lut, lutrgb, lutyuv](#toc-lut_002c-lutrgb_002c-lutyuv) {#lut-lutrgb-lutyuv .section}

Compute a look-up table for binding each pixel component input value to
an output value, and apply it to the input video.

`lutyuv`{.variable} applies a lookup table to a YUV input video,
`lutrgb`{.variable} to an RGB input video.

These filters accept the following parameters:

`c0`{.sample}

:   set first pixel component expression

`c1`{.sample}

:   set second pixel component expression

`c2`{.sample}

:   set third pixel component expression

`c3`{.sample}

:   set fourth pixel component expression, corresponds to the alpha
    component

`r`{.sample}

:   set red component expression

`g`{.sample}

:   set green component expression

`b`{.sample}

:   set blue component expression

`a`{.sample}

:   alpha component expression

`y`{.sample}

:   set Y/luma component expression

`u`{.sample}

:   set U/Cb component expression

`v`{.sample}

:   set V/Cr component expression

Each of them specifies the expression to use for computing the lookup
table for the corresponding pixel component values.

The exact component associated to each of the `c*`{.variable} options
depends on the format in input.

The `lut`{.variable} filter requires either YUV or RGB pixel formats in
input, `lutrgb`{.variable} requires RGB pixel formats in input, and
`lutyuv`{.variable} requires YUV.

The expressions can contain the following constants and functions:

`w`{.sample}\
`h`{.sample}

:   The input width and height.

`val`{.sample}

:   The input value for the pixel component.

`clipval`{.sample}

:   The input value, clipped to the
    `minval`{.variable}-`maxval`{.variable} range.

`maxval`{.sample}

:   The maximum value for the pixel component.

`minval`{.sample}

:   The minimum value for the pixel component.

`negval`{.sample}

:   The negated value for the pixel component value, clipped to the
    `minval`{.variable}-`maxval`{.variable} range; it corresponds to the
    expression \"maxval-clipval+minval\".

`clip(val)`{.sample}

:   The computed value in `val`{.variable}, clipped to the
    `minval`{.variable}-`maxval`{.variable} range.

`gammaval(gamma)`{.sample}

:   The computed gamma correction value of the pixel component value,
    clipped to the `minval`{.variable}-`maxval`{.variable} range. It
    corresponds to the expression
    \"pow((clipval-minval)/(maxval-minval)\\,`gamma`{.variable})\*(maxval-minval)+minval\"

All expressions default to \"clipval\".

[]{#Commands-111}

#### [39.152.1 Commands](#toc-Commands-111) {#commands-111 .subsection}

This filter supports same [commands](#commands) as options.

[]{#Examples-140}

#### [39.152.2 Examples](#toc-Examples-140) {#examples-140 .subsection}

- Negate input video:

  ::: example
  ``` example
  lutrgb="r=maxval+minval-val:g=maxval+minval-val:b=maxval+minval-val"
  lutyuv="y=maxval+minval-val:u=maxval+minval-val:v=maxval+minval-val"
  ```
  :::

  The above is the same as:

  ::: example
  ``` example
  lutrgb="r=negval:g=negval:b=negval"
  lutyuv="y=negval:u=negval:v=negval"
  ```
  :::

- Negate luma:

  ::: example
  ``` example
  lutyuv=y=negval
  ```
  :::

- Remove chroma components, turning the video into a graytone image:

  ::: example
  ``` example
  lutyuv="u=128:v=128"
  ```
  :::

- Apply a luma burning effect:

  ::: example
  ``` example
  lutyuv="y=2*val"
  ```
  :::

- Remove green and blue components:

  ::: example
  ``` example
  lutrgb="g=0:b=0"
  ```
  :::

- Set a constant alpha channel value on input:

  ::: example
  ``` example
  format=rgba,lutrgb=a="maxval-minval/2"
  ```
  :::

- Correct luma gamma by a factor of 0.5:

  ::: example
  ``` example
  lutyuv=y=gammaval(0.5)
  ```
  :::

- Discard least significant bits of luma:

  ::: example
  ``` example
  lutyuv=y='bitand(val, 128+64+32)'
  ```
  :::

- Technicolor like effect:

  ::: example
  ``` example
  lutyuv=u='(val-maxval/2)*2+maxval/2':v='(val-maxval/2)*2+maxval/2'
  ```
  :::

[]{#lut2_002c-tlut2}

### [39.153 lut2, tlut2](#toc-lut2_002c-tlut2) {#lut2-tlut2 .section}

The `lut2` filter takes two input streams and outputs one stream.

The `tlut2` (time lut2) filter takes two consecutive frames from one
single stream.

This filter accepts the following parameters:

`c0`{.sample}

:   set first pixel component expression

`c1`{.sample}

:   set second pixel component expression

`c2`{.sample}

:   set third pixel component expression

`c3`{.sample}

:   set fourth pixel component expression, corresponds to the alpha
    component

`d`{.sample}

:   set output bit depth, only available for `lut2` filter. By default
    is 0, which means bit depth is automatically picked from first input
    format.

The `lut2` filter also supports the [framesync](#framesync) options.

Each of them specifies the expression to use for computing the lookup
table for the corresponding pixel component values.

The exact component associated to each of the `c*`{.variable} options
depends on the format in inputs.

The expressions can contain the following constants:

`w`{.sample}\
`h`{.sample}

:   The input width and height.

`x`{.sample}

:   The first input value for the pixel component.

`y`{.sample}

:   The second input value for the pixel component.

`bdx`{.sample}

:   The first input video bit depth.

`bdy`{.sample}

:   The second input video bit depth.

All expressions default to \"x\".

[]{#Commands-112}

#### [39.153.1 Commands](#toc-Commands-112) {#commands-112 .subsection}

This filter supports the all above options as [commands](#commands)
except option `d`.

[]{#Examples-141}

#### [39.153.2 Examples](#toc-Examples-141) {#examples-141 .subsection}

- Highlight differences between two RGB video streams:

  ::: example
  ``` example
  lut2='ifnot(x-y,0,pow(2,bdx)-1):ifnot(x-y,0,pow(2,bdx)-1):ifnot(x-y,0,pow(2,bdx)-1)'
  ```
  :::
- Highlight differences between two YUV video streams:

  ::: example
  ``` example
  lut2='ifnot(x-y,0,pow(2,bdx)-1):ifnot(x-y,pow(2,bdx-1),pow(2,bdx)-1):ifnot(x-y,pow(2,bdx-1),pow(2,bdx)-1)'
  ```
  :::
- Show max difference between two video streams:

  ::: example
  ``` example
  lut2='if(lt(x,y),0,if(gt(x,y),pow(2,bdx)-1,pow(2,bdx-1))):if(lt(x,y),0,if(gt(x,y),pow(2,bdx)-1,pow(2,bdx-1))):if(lt(x,y),0,if(gt(x,y),pow(2,bdx)-1,pow(2,bdx-1)))'
  ```
  :::

[]{#maskedclamp}

### [39.154 maskedclamp](#toc-maskedclamp) {#maskedclamp .section}

Clamp the first input stream with the second input and third input
stream.

Returns the value of first stream to be between second input stream -
`undershoot` and third input stream + `overshoot`.

This filter accepts the following options:

`undershoot`{.sample}

:   Default value is `0`.

`overshoot`{.sample}

:   Default value is `0`.

`planes`{.sample}

:   Set which planes will be processed as bitmap, unprocessed planes
    will be copied from first stream. By default value 0xf, all planes
    will be processed.

[]{#Commands-113}

#### [39.154.1 Commands](#toc-Commands-113) {#commands-113 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#maskedmax}

### [39.155 maskedmax](#toc-maskedmax) {#maskedmax .section}

Merge the second and third input stream into output stream using
absolute differences between second input stream and first input stream
and absolute difference between third input stream and first input
stream. The picked value will be from second input stream if second
absolute difference is greater than first one or from third input stream
otherwise.

This filter accepts the following options:

`planes`{.sample}

:   Set which planes will be processed as bitmap, unprocessed planes
    will be copied from first stream. By default value 0xf, all planes
    will be processed.

[]{#Commands-114}

#### [39.155.1 Commands](#toc-Commands-114) {#commands-114 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#maskedmerge}

### [39.156 maskedmerge](#toc-maskedmerge) {#maskedmerge .section}

Merge the first input stream with the second input stream using per
pixel weights in the third input stream.

A value of 0 in the third stream pixel component means that pixel
component from first stream is returned unchanged, while maximum value
(eg. 255 for 8-bit videos) means that pixel component from second stream
is returned unchanged. Intermediate values define the amount of merging
between both input stream's pixel components.

This filter accepts the following options:

`planes`{.sample}

:   Set which planes will be processed as bitmap, unprocessed planes
    will be copied from first stream. By default value 0xf, all planes
    will be processed.

[]{#Commands-115}

#### [39.156.1 Commands](#toc-Commands-115) {#commands-115 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#maskedmin}

### [39.157 maskedmin](#toc-maskedmin) {#maskedmin .section}

Merge the second and third input stream into output stream using
absolute differences between second input stream and first input stream
and absolute difference between third input stream and first input
stream. The picked value will be from second input stream if second
absolute difference is less than first one or from third input stream
otherwise.

This filter accepts the following options:

`planes`{.sample}

:   Set which planes will be processed as bitmap, unprocessed planes
    will be copied from first stream. By default value 0xf, all planes
    will be processed.

[]{#Commands-116}

#### [39.157.1 Commands](#toc-Commands-116) {#commands-116 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#maskedthreshold}

### [39.158 maskedthreshold](#toc-maskedthreshold) {#maskedthreshold .section}

Pick pixels comparing absolute difference of two video streams with
fixed threshold.

If absolute difference between pixel component of first and second video
stream is equal or lower than user supplied threshold than pixel
component from first video stream is picked, otherwise pixel component
from second video stream is picked.

This filter accepts the following options:

`threshold`{.sample}

:   Set threshold used when picking pixels from absolute difference from
    two input video streams.

`planes`{.sample}

:   Set which planes will be processed as bitmap, unprocessed planes
    will be copied from second stream. By default value 0xf, all planes
    will be processed.

`mode`{.sample}

:   Set mode of filter operation. Can be `abs` or `diff`. Default is
    `abs`.

[]{#Commands-117}

#### [39.158.1 Commands](#toc-Commands-117) {#commands-117 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#maskfun}

### [39.159 maskfun](#toc-maskfun) {#maskfun .section}

Create mask from input video.

For example it is useful to create motion masks after `tblend` filter.

This filter accepts the following options:

`low`{.sample}

:   Set low threshold. Any pixel component lower or exact than this
    value will be set to 0.

`high`{.sample}

:   Set high threshold. Any pixel component higher than this value will
    be set to max value allowed for current pixel format.

`planes`{.sample}

:   Set planes to filter, by default all available planes are filtered.

`fill`{.sample}

:   Fill all frame pixels with this value.

`sum`{.sample}

:   Set max average pixel value for frame. If sum of all pixel
    components is higher that this average, output frame will be
    completely filled with value set by `fill`{.variable} option.
    Typically useful for scene changes when used in combination with
    `tblend` filter.

[]{#Commands-118}

#### [39.159.1 Commands](#toc-Commands-118) {#commands-118 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#mcdeint}

### [39.160 mcdeint](#toc-mcdeint) {#mcdeint .section}

Apply motion-compensation deinterlacing.

It needs one field per frame as input and must thus be used together
with yadif=1/3 or equivalent.

This filter accepts the following options:

`mode`{.sample}

:   Set the deinterlacing mode.

    It accepts one of the following values:

    '`fast`{.sample}'\
    '`medium`{.sample}'\
    '`slow`{.sample}'

    :   use iterative motion estimation

    '`extra_slow`{.sample}'

    :   like '`slow`{.sample}', but use multiple reference frames.

    Default value is '`fast`{.sample}'.

`parity`{.sample}

:   Set the picture field parity assumed for the input video. It must be
    one of the following values:

    '`0, tff`{.sample}'

    :   assume top field first

    '`1, bff`{.sample}'

    :   assume bottom field first

    Default value is '`bff`{.sample}'.

`qp`{.sample}

:   Set per-block quantization parameter (QP) used by the internal
    encoder.

    Higher values should result in a smoother motion vector field but
    less optimal individual vectors. Default value is 1.

[]{#median}

### [39.161 median](#toc-median) {#median .section}

Pick median pixel from certain rectangle defined by radius.

This filter accepts the following options:

`radius`{.sample}

:   Set horizontal radius size. Default value is `1`. Allowed range is
    integer from 1 to 127.

`planes`{.sample}

:   Set which planes to process. Default is `15`, which is all available
    planes.

`radiusV`{.sample}

:   Set vertical radius size. Default value is `0`. Allowed range is
    integer from 0 to 127. If it is 0, value will be picked from
    horizontal `radius` option.

`percentile`{.sample}

:   Set median percentile. Default value is `0.5`. Default value of
    `0.5` will pick always median values, while `0` will pick minimum
    values, and `1` maximum values.

[]{#Commands-119}

#### [39.161.1 Commands](#toc-Commands-119) {#commands-119 .subsection}

This filter supports same [commands](#commands) as options. The command
accepts the same syntax of the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#mergeplanes}

### [39.162 mergeplanes](#toc-mergeplanes) {#mergeplanes .section}

Merge color channel components from several video streams.

The filter accepts up to 4 input streams, and merge selected input
planes to the output video.

This filter accepts the following options:

`mapping`{.sample}

:   Set input to output plane mapping. Default is `0`.

    The mappings is specified as a bitmap. It should be specified as a
    hexadecimal number in the form 0xAa\[Bb\[Cc\[Dd\]\]\]. 'Aa'
    describes the mapping for the first plane of the output stream. 'A'
    sets the number of the input stream to use (from 0 to 3), and 'a'
    the plane number of the corresponding input to use (from 0 to 3).
    The rest of the mappings is similar, 'Bb' describes the mapping for
    the output stream second plane, 'Cc' describes the mapping for the
    output stream third plane and 'Dd' describes the mapping for the
    output stream fourth plane.

`format`{.sample}

:   Set output pixel format. Default is `yuva444p`.

`map0s`{.sample}\
`map1s`{.sample}\
`map2s`{.sample}\
`map3s`{.sample}

:   Set input to output stream mapping for output Nth plane. Default is
    `0`.

`map0p`{.sample}\
`map1p`{.sample}\
`map2p`{.sample}\
`map3p`{.sample}

:   Set input to output plane mapping for output Nth plane. Default is
    `0`.

[]{#Examples-142}

#### [39.162.1 Examples](#toc-Examples-142) {#examples-142 .subsection}

- Merge three gray video streams of same width and height into single
  video stream:

  ::: example
  ``` example
  [a0][a1][a2]mergeplanes=0x001020:yuv444p
  ```
  :::
- Merge 1st yuv444p stream and 2nd gray video stream into yuva444p video
  stream:

  ::: example
  ``` example
  [a0][a1]mergeplanes=0x00010210:yuva444p
  ```
  :::
- Swap Y and A plane in yuva444p stream:

  ::: example
  ``` example
  format=yuva444p,mergeplanes=0x03010200:yuva444p
  ```
  :::
- Swap U and V plane in yuv420p stream:

  ::: example
  ``` example
  format=yuv420p,mergeplanes=0x000201:yuv420p
  ```
  :::
- Cast a rgb24 clip to yuv444p:

  ::: example
  ``` example
  format=rgb24,mergeplanes=0x000102:yuv444p
  ```
  :::

[]{#mestimate}

### [39.163 mestimate](#toc-mestimate) {#mestimate .section}

Estimate and export motion vectors using block matching algorithms.
Motion vectors are stored in frame side data to be used by other
filters.

This filter accepts the following options:

`method`{.sample}

:   Specify the motion estimation method. Accepts one of the following
    values:

    '`esa`{.sample}'

    :   Exhaustive search algorithm.

    '`tss`{.sample}'

    :   Three step search algorithm.

    '`tdls`{.sample}'

    :   Two dimensional logarithmic search algorithm.

    '`ntss`{.sample}'

    :   New three step search algorithm.

    '`fss`{.sample}'

    :   Four step search algorithm.

    '`ds`{.sample}'

    :   Diamond search algorithm.

    '`hexbs`{.sample}'

    :   Hexagon-based search algorithm.

    '`epzs`{.sample}'

    :   Enhanced predictive zonal search algorithm.

    '`umh`{.sample}'

    :   Uneven multi-hexagon search algorithm.

    Default value is '`esa`{.sample}'.

`mb_size`{.sample}

:   Macroblock size. Default `16`.

`search_param`{.sample}

:   Search parameter. Default `7`.

[]{#midequalizer}

### [39.164 midequalizer](#toc-midequalizer) {#midequalizer .section}

Apply Midway Image Equalization effect using two video streams.

Midway Image Equalization adjusts a pair of images to have the same
histogram, while maintaining their dynamics as much as possible. It's
useful for e.g. matching exposures from a pair of stereo cameras.

This filter has two inputs and one output, which must be of same pixel
format, but may be of different sizes. The output of filter is first
input adjusted with midway histogram of both inputs.

This filter accepts the following option:

`planes`{.sample}

:   Set which planes to process. Default is `15`, which is all available
    planes.

[]{#minterpolate}

### [39.165 minterpolate](#toc-minterpolate) {#minterpolate .section}

Convert the video to specified frame rate using motion interpolation.

This filter accepts the following options:

`fps`{.sample}

:   Specify the output frame rate. This can be rational e.g.
    `60000/1001`. Frames are dropped if `fps`{.variable} is lower than
    source fps. Default `60`.

`mi_mode`{.sample}

:   Motion interpolation mode. Following values are accepted:

    '`dup`{.sample}'

    :   Duplicate previous or next frame for interpolating new ones.

    '`blend`{.sample}'

    :   Blend source frames. Interpolated frame is mean of previous and
        next frames.

    '`mci`{.sample}'

    :   Motion compensated interpolation. Following options are
        effective when this mode is selected:

        '`mc_mode`{.sample}'

        :   Motion compensation mode. Following values are accepted:

            '`obmc`{.sample}'

            :   Overlapped block motion compensation.

            '`aobmc`{.sample}'

            :   Adaptive overlapped block motion compensation. Window
                weighting coefficients are controlled adaptively
                according to the reliabilities of the neighboring motion
                vectors to reduce oversmoothing.

            Default mode is '`obmc`{.sample}'.

        '`me_mode`{.sample}'

        :   Motion estimation mode. Following values are accepted:

            '`bidir`{.sample}'

            :   Bidirectional motion estimation. Motion vectors are
                estimated for each source frame in both forward and
                backward directions.

            '`bilat`{.sample}'

            :   Bilateral motion estimation. Motion vectors are
                estimated directly for interpolated frame.

            Default mode is '`bilat`{.sample}'.

        '`me`{.sample}'

        :   The algorithm to be used for motion estimation. Following
            values are accepted:

            '`esa`{.sample}'

            :   Exhaustive search algorithm.

            '`tss`{.sample}'

            :   Three step search algorithm.

            '`tdls`{.sample}'

            :   Two dimensional logarithmic search algorithm.

            '`ntss`{.sample}'

            :   New three step search algorithm.

            '`fss`{.sample}'

            :   Four step search algorithm.

            '`ds`{.sample}'

            :   Diamond search algorithm.

            '`hexbs`{.sample}'

            :   Hexagon-based search algorithm.

            '`epzs`{.sample}'

            :   Enhanced predictive zonal search algorithm.

            '`umh`{.sample}'

            :   Uneven multi-hexagon search algorithm.

            Default algorithm is '`epzs`{.sample}'.

        '`mb_size`{.sample}'

        :   Macroblock size. Default `16`.

        '`search_param`{.sample}'

        :   Motion estimation search parameter. Default `32`.

        '`vsbmc`{.sample}'

        :   Enable variable-size block motion compensation. Motion
            estimation is applied with smaller block sizes at object
            boundaries in order to make them less blurry. Default is `0`
            (disabled).

`scd`{.sample}

:   Scene change detection method. Scene change leads motion vectors to
    be in random direction. Scene change detection replace interpolated
    frames by duplicate ones. May not be needed for other modes.
    Following values are accepted:

    '`none`{.sample}'

    :   Disable scene change detection.

    '`fdiff`{.sample}'

    :   Frame difference. Corresponding pixel values are compared and if
        it satisfies `scd_threshold`{.variable} scene change is
        detected.

    Default method is '`fdiff`{.sample}'.

`scd_threshold`{.sample}

:   Scene change detection threshold. Default is `10.`.

[]{#mix}

### [39.166 mix](#toc-mix) {#mix .section}

Mix several video input streams into one video stream.

A description of the accepted options follows.

`inputs`{.sample}

:   The number of inputs. If unspecified, it defaults to 2.

`weights`{.sample}

:   Specify weight of each input video stream as sequence. Each weight
    is separated by space. If number of weights is smaller than number
    of `frames`{.variable} last specified weight will be used for all
    remaining unset weights.

`scale`{.sample}

:   Specify scale, if it is set it will be multiplied with sum of each
    weight multiplied with pixel values to give final destination pixel
    value. By default `scale`{.variable} is auto scaled to sum of
    weights.

`planes`{.sample}

:   Set which planes to filter. Default is all. Allowed range is from 0
    to 15.

`duration`{.sample}

:   Specify how end of stream is determined.

    '`longest`{.sample}'

    :   The duration of the longest input. (default)

    '`shortest`{.sample}'

    :   The duration of the shortest input.

    '`first`{.sample}'

    :   The duration of the first input.

[]{#Commands-120}

#### [39.166.1 Commands](#toc-Commands-120) {#commands-120 .subsection}

This filter supports the following commands:

`weights`{.sample}\
`scale`{.sample}\
`planes`{.sample}

:   Syntax is same as option with same name.

[]{#monochrome}

### [39.167 monochrome](#toc-monochrome) {#monochrome .section}

Convert video to gray using custom color filter.

A description of the accepted options follows.

`cb`{.sample}

:   Set the chroma blue spot. Allowed range is from -1 to 1. Default
    value is 0.

`cr`{.sample}

:   Set the chroma red spot. Allowed range is from -1 to 1. Default
    value is 0.

`size`{.sample}

:   Set the color filter size. Allowed range is from .1 to 10. Default
    value is 1.

`high`{.sample}

:   Set the highlights strength. Allowed range is from 0 to 1. Default
    value is 0.

[]{#Commands-121}

#### [39.167.1 Commands](#toc-Commands-121) {#commands-121 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#morpho}

### [39.168 morpho](#toc-morpho) {#morpho .section}

This filter allows to apply main morphological grayscale transforms,
erode and dilate with arbitrary structures set in second input stream.

Unlike naive implementation and much slower performance in
[erosion](#erosion) and [dilation](#dilation) filters, when speed is
critical `morpho` filter should be used instead.

A description of accepted options follows,

`mode`{.sample}

Set morphological transform to apply, can be:

'`erode`{.sample}'

'`dilate`{.sample}'

'`open`{.sample}'

'`close`{.sample}'

'`gradient`{.sample}'

'`tophat`{.sample}'

'`blackhat`{.sample}'

Default is `erode`.

`planes`{.sample}

Set planes to filter, by default all planes except alpha are filtered.

`structure`{.sample}

Set which structure video frames will be processed from second input
stream, can be `first`{.variable} or `all`{.variable}. Default is
`all`{.variable}.

The `morpho` filter also supports the [framesync](#framesync) options.

[]{#Commands-122}

#### [39.168.1 Commands](#toc-Commands-122) {#commands-122 .subsection}

This filter supports same [commands](#commands) as options.

[]{#mpdecimate}

### [39.169 mpdecimate](#toc-mpdecimate) {#mpdecimate .section}

Drop frames that do not differ greatly from the previous frame in order
to reduce frame rate.

The main use of this filter is for very-low-bitrate encoding (e.g.
streaming over dialup modem), but it could in theory be used for fixing
movies that were inverse-telecined incorrectly.

A description of the accepted options follows.

`max`{.sample}

:   Set the maximum number of consecutive frames which can be dropped
    (if positive), or the minimum interval between dropped frames (if
    negative). If the value is 0, the frame is dropped disregarding the
    number of previous sequentially dropped frames.

    Default value is 0.

`keep`{.sample}

:   Set the maximum number of consecutive similar frames to ignore
    before to start dropping them. If the value is 0, the frame is
    dropped disregarding the number of previous sequentially similar
    frames.

    Default value is 0.

`hi`{.sample}\
`lo`{.sample}\
`frac`{.sample}

:   Set the dropping threshold values.

    Values for `hi`{.sample} and `lo`{.sample} are for 8x8 pixel blocks
    and represent actual pixel value differences, so a threshold of 64
    corresponds to 1 unit of difference for each pixel, or the same
    spread out differently over the block.

    A frame is a candidate for dropping if no 8x8 blocks differ by more
    than a threshold of `hi`{.sample}, and if no more than
    `frac`{.sample} blocks (1 meaning the whole image) differ by more
    than a threshold of `lo`{.sample}.

    Default value for `hi`{.sample} is 64\*12, default value for
    `lo`{.sample} is 64\*5, and default value for `frac`{.sample} is
    0.33.

[]{#msad}

### [39.170 msad](#toc-msad) {#msad .section}

Obtain the MSAD (Mean Sum of Absolute Differences) between two input
videos.

This filter takes two input videos.

Both input videos must have the same resolution and pixel format for
this filter to work correctly. Also it assumes that both inputs have the
same number of frames, which are compared one by one.

The obtained per component, average, min and max MSAD is printed through
the logging system.

The filter stores the calculated MSAD of each frame in frame metadata.

This filter also supports the [framesync](#framesync) options.

In the below example the input file `main.mpg`{.sample} being processed
is compared with the reference file `ref.mpg`{.sample}.

::: example
``` example
ffmpeg -i main.mpg -i ref.mpg -lavfi msad -f null -
```
:::

[]{#multiply}

### [39.171 multiply](#toc-multiply) {#multiply .section}

Multiply first video stream pixels values with second video stream
pixels values.

The filter accepts the following options:

`scale`{.sample}

:   Set the scale applied to second video stream. By default is `1`.
    Allowed range is from `0` to `9`.

`offset`{.sample}

:   Set the offset applied to second video stream. By default is `0.5`.
    Allowed range is from `-1` to `1`.

`planes`{.sample}

:   Specify planes from input video stream that will be processed. By
    default all planes are processed.

[]{#Commands-123}

#### [39.171.1 Commands](#toc-Commands-123) {#commands-123 .subsection}

This filter supports same [commands](#commands) as options.

[]{#negate}

### [39.172 negate](#toc-negate) {#negate .section}

Negate (invert) the input video.

It accepts the following option:

`components`{.sample}

Set components to negate.

Available values for components are:

'`y`{.sample}'

'`u`{.sample}'

'`v`{.sample}'

'`a`{.sample}'

'`r`{.sample}'

'`g`{.sample}'

'`b`{.sample}'

`negate_alpha`{.sample}

With value 1, it negates the alpha component, if present. Default value
is 0.

[]{#Commands-124}

#### [39.172.1 Commands](#toc-Commands-124) {#commands-124 .subsection}

This filter supports same [commands](#commands) as options.

[]{#nlmeans}[]{#nlmeans-1}

### [39.173 nlmeans](#toc-nlmeans-1) {#nlmeans .section}

Denoise frames using Non-Local Means algorithm.

Each pixel is adjusted by looking for other pixels with similar
contexts. This context similarity is defined by comparing their
surrounding patches of size `p`{.sample}x`p`{.sample}. Patches are
searched in an area of `r`{.sample}x`r`{.sample} around the pixel.

Note that the research area defines centers for patches, which means
some patches will be made of pixels outside that research area.

The filter accepts the following options.

`s`{.sample}

:   Set denoising strength. Default is 1.0. Must be in range \[1.0,
    30.0\].

`p`{.sample}

:   Set patch size. Default is 7. Must be odd number in range \[0, 99\].

`pc`{.sample}

:   Same as `p`{.sample} but for chroma planes.

    The default value is `0`{.variable} and means automatic.

`r`{.sample}

:   Set research size. Default is 15. Must be odd number in range \[0,
    99\].

`rc`{.sample}

:   Same as `r`{.sample} but for chroma planes.

    The default value is `0`{.variable} and means automatic.

[]{#nnedi}

### [39.174 nnedi](#toc-nnedi) {#nnedi .section}

Deinterlace video using neural network edge directed interpolation.

This filter accepts the following options:

`weights`{.sample}

Mandatory option, without binary file filter can not work. Currently
file can be found here:
https://github.com/dubhater/vapoursynth-nnedi3/blob/master/src/nnedi3_weights.bin

`deint`{.sample}

Set which frames to deinterlace, by default it is `all`. Can be `all` or
`interlaced`.

`field`{.sample}

Set mode of operation.

Can be one of the following:

'`af`{.sample}'

:   Use frame flags, both fields.

'`a`{.sample}'

:   Use frame flags, single field.

'`t`{.sample}'

:   Use top field only.

'`b`{.sample}'

:   Use bottom field only.

'`tf`{.sample}'

:   Use both fields, top first.

'`bf`{.sample}'

:   Use both fields, bottom first.

`planes`{.sample}

Set which planes to process, by default filter process all frames.

`nsize`{.sample}

Set size of local neighborhood around each pixel, used by the predictor
neural network.

Can be one of the following:

'`s8x6`{.sample}'

'`s16x6`{.sample}'

'`s32x6`{.sample}'

'`s48x6`{.sample}'

'`s8x4`{.sample}'

'`s16x4`{.sample}'

'`s32x4`{.sample}'

`nns`{.sample}

Set the number of neurons in predictor neural network. Can be one of the
following:

'`n16`{.sample}'

'`n32`{.sample}'

'`n64`{.sample}'

'`n128`{.sample}'

'`n256`{.sample}'

`qual`{.sample}

Controls the number of different neural network predictions that are
blended together to compute the final output value. Can be `fast`,
default or `slow`.

`etype`{.sample}

Set which set of weights to use in the predictor. Can be one of the
following:

'`a, abs`{.sample}'

:   weights trained to minimize absolute error

'`s, mse`{.sample}'

:   weights trained to minimize squared error

`pscrn`{.sample}

Controls whether or not the prescreener neural network is used to decide
which pixels should be processed by the predictor neural network and
which can be handled by simple cubic interpolation. The prescreener is
trained to know whether cubic interpolation will be sufficient for a
pixel or whether it should be predicted by the predictor nn. The
computational complexity of the prescreener nn is much less than that of
the predictor nn. Since most pixels can be handled by cubic
interpolation, using the prescreener generally results in much faster
processing. The prescreener is pretty accurate, so the difference
between using it and not using it is almost always unnoticeable.

Can be one of the following:

'`none`{.sample}'

'`original`{.sample}'

'`new`{.sample}'

'`new2`{.sample}'

'`new3`{.sample}'

Default is `new`.

[]{#Commands-125}

#### [39.174.1 Commands](#toc-Commands-125) {#commands-125 .subsection}

This filter supports same [commands](#commands) as options, excluding
`weights`{.variable} option.

[]{#noformat}

### [39.175 noformat](#toc-noformat) {#noformat .section}

Force libavfilter not to use any of the specified pixel formats for the
input to the next filter.

It accepts the following parameters:

`pix_fmts`{.sample}

:   A '\|'-separated list of pixel format names, such as
    pix_fmts=yuv420p\|monow\|rgb24\".

[]{#Examples-143}

#### [39.175.1 Examples](#toc-Examples-143) {#examples-143 .subsection}

- Force libavfilter to use a format different from `yuv420p`{.variable}
  for the input to the vflip filter:

  ::: example
  ``` example
  noformat=pix_fmts=yuv420p,vflip
  ```
  :::
- Convert the input video to any of the formats not contained in the
  list:

  ::: example
  ``` example
  noformat=yuv420p|yuv444p|yuv410p
  ```
  :::

[]{#noise-1}

### [39.176 noise](#toc-noise-1) {#noise-1 .section}

Add noise on video input frame.

The filter accepts the following options:

`all_seed`{.sample}\
`c0_seed`{.sample}\
`c1_seed`{.sample}\
`c2_seed`{.sample}\
`c3_seed`{.sample}

:   Set noise seed for specific pixel component or all pixel components
    in case of `all_seed`{.variable}. Default value is `123457`.

`all_strength, alls`{.sample}\
`c0_strength, c0s`{.sample}\
`c1_strength, c1s`{.sample}\
`c2_strength, c2s`{.sample}\
`c3_strength, c3s`{.sample}

:   Set noise strength for specific pixel component or all pixel
    components in case `all_strength`{.variable}. Default value is `0`.
    Allowed range is \[0, 100\].

`all_flags, allf`{.sample}\
`c0_flags, c0f`{.sample}\
`c1_flags, c1f`{.sample}\
`c2_flags, c2f`{.sample}\
`c3_flags, c3f`{.sample}

:   Set pixel component flags or set flags for all components if
    `all_flags`{.variable}. Available values for component flags are:

    '`a`{.sample}'

    :   averaged temporal noise (smoother)

    '`p`{.sample}'

    :   mix random noise with a (semi)regular pattern

    '`t`{.sample}'

    :   temporal noise (noise pattern changes between frames)

    '`u`{.sample}'

    :   uniform noise (gaussian otherwise)

[]{#Examples-144}

#### [39.176.1 Examples](#toc-Examples-144) {#examples-144 .subsection}

Add temporal and uniform noise to input video:

::: example
``` example
noise=alls=20:allf=t+u
```
:::

[]{#normalize}

### [39.177 normalize](#toc-normalize) {#normalize .section}

Normalize RGB video (aka histogram stretching, contrast stretching).
See: https://en.wikipedia.org/wiki/Normalization\_(image_processing)

For each channel of each frame, the filter computes the input range and
maps it linearly to the user-specified output range. The output range
defaults to the full dynamic range from pure black to pure white.

Temporal smoothing can be used on the input range to reduce flickering
(rapid changes in brightness) caused when small dark or bright objects
enter or leave the scene. This is similar to the auto-exposure
(automatic gain control) on a video camera, and, like a video camera, it
may cause a period of over- or under-exposure of the video.

The R,G,B channels can be normalized independently, which may cause some
color shifting, or linked together as a single channel, which prevents
color shifting. Linked normalization preserves hue. Independent
normalization does not, so it can be used to remove some color casts.
Independent and linked normalization can be combined in any ratio.

The normalize filter accepts the following options:

`blackpt`{.sample}\
`whitept`{.sample}

:   Colors which define the output range. The minimum input value is
    mapped to the `blackpt`{.variable}. The maximum input value is
    mapped to the `whitept`{.variable}. The defaults are black and white
    respectively. Specifying white for `blackpt`{.variable} and black
    for `whitept`{.variable} will give color-inverted, normalized video.
    Shades of grey can be used to reduce the dynamic range (contrast).
    Specifying saturated colors here can create some interesting
    effects.

`smoothing`{.sample}

:   The number of previous frames to use for temporal smoothing. The
    input range of each channel is smoothed using a rolling average over
    the current frame and the `smoothing`{.variable} previous frames.
    The default is 0 (no temporal smoothing).

`independence`{.sample}

:   Controls the ratio of independent (color shifting) channel
    normalization to linked (color preserving) normalization. 0.0 is
    fully linked, 1.0 is fully independent. Defaults to 1.0 (fully
    independent).

`strength`{.sample}

:   Overall strength of the filter. 1.0 is full strength. 0.0 is a
    rather expensive no-op. Defaults to 1.0 (full strength).

[]{#Commands-126}

#### [39.177.1 Commands](#toc-Commands-126) {#commands-126 .subsection}

This filter supports same [commands](#commands) as options, excluding
`smoothing`{.variable} option. The command accepts the same syntax of
the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#Examples-145}

#### [39.177.2 Examples](#toc-Examples-145) {#examples-145 .subsection}

Stretch video contrast to use the full dynamic range, with no temporal
smoothing; may flicker depending on the source content:

::: example
``` example
normalize=blackpt=black:whitept=white:smoothing=0
```
:::

As above, but with 50 frames of temporal smoothing; flicker should be
reduced, depending on the source content:

::: example
``` example
normalize=blackpt=black:whitept=white:smoothing=50
```
:::

As above, but with hue-preserving linked channel normalization:

::: example
``` example
normalize=blackpt=black:whitept=white:smoothing=50:independence=0
```
:::

As above, but with half strength:

::: example
``` example
normalize=blackpt=black:whitept=white:smoothing=50:independence=0:strength=0.5
```
:::

Map the darkest input color to red, the brightest input color to cyan:

::: example
``` example
normalize=blackpt=red:whitept=cyan
```
:::

[]{#null-2}

### [39.178 null](#toc-null-2) {#null-2 .section}

Pass the video source unchanged to the output.

[]{#ocr}

### [39.179 ocr](#toc-ocr) {#ocr .section}

Optical Character Recognition

This filter uses Tesseract for optical character recognition. To enable
compilation of this filter, you need to configure FFmpeg with
`--enable-libtesseract`.

It accepts the following options:

`datapath`{.sample}

:   Set datapath to tesseract data. Default is to use whatever was set
    at installation.

`language`{.sample}

:   Set language, default is \"eng\".

`whitelist`{.sample}

:   Set character whitelist.

`blacklist`{.sample}

:   Set character blacklist.

The filter exports recognized text as the frame metadata
`lavfi.ocr.text`. The filter exports confidence of recognized words as
the frame metadata `lavfi.ocr.confidence`.

[]{#ocv}

### [39.180 ocv](#toc-ocv) {#ocv .section}

Apply a video transform using libopencv.

To enable this filter, install the libopencv library and headers and
configure FFmpeg with `--enable-libopencv`.

It accepts the following parameters:

`filter_name`{.sample}

:   The name of the libopencv filter to apply.

`filter_params`{.sample}

:   The parameters to pass to the libopencv filter. If not specified,
    the default values are assumed.

Refer to the official libopencv documentation for more precise
information:
<http://docs.opencv.org/master/modules/imgproc/doc/filtering.html>

Several libopencv filters are supported; see the following subsections.

[]{#dilate}[]{#dilate-1}

#### [39.180.1 dilate](#toc-dilate-1) {#dilate .subsection}

Dilate an image by using a specific structuring element. It corresponds
to the libopencv function `cvDilate`.

It accepts the parameters:
`struct_el`{.variable}\|`nb_iterations`{.variable}.

`struct_el`{.variable} represents a structuring element, and has the
syntax:
`cols`{.variable}x`rows`{.variable}+`anchor_x`{.variable}x`anchor_y`{.variable}/`shape`{.variable}

`cols`{.variable} and `rows`{.variable} represent the number of columns
and rows of the structuring element, `anchor_x`{.variable} and
`anchor_y`{.variable} the anchor point, and `shape`{.variable} the shape
for the structuring element. `shape`{.variable} must be \"rect\",
\"cross\", \"ellipse\", or \"custom\".

If the value for `shape`{.variable} is \"custom\", it must be followed
by a string of the form \"=`filename`{.variable}\". The file with name
`filename`{.variable} is assumed to represent a binary image, with each
printable character corresponding to a bright pixel. When a custom
`shape`{.variable} is used, `cols`{.variable} and `rows`{.variable} are
ignored, the number or columns and rows of the read file are assumed
instead.

The default value for `struct_el`{.variable} is \"3x3+0x0/rect\".

`nb_iterations`{.variable} specifies the number of times the transform
is applied to the image, and defaults to 1.

Some examples:

::: example
``` example
# Use the default values
ocv=dilate

# Dilate using a structuring element with a 5x5 cross, iterating two times
ocv=filter_name=dilate:filter_params=5x5+2x2/cross|2

# Read the shape from the file diamond.shape, iterating two times.
# The file diamond.shape may contain a pattern of characters like this
#   *
#  ***
# *****
#  ***
#   *
# The specified columns and rows are ignored
# but the anchor point coordinates are not
ocv=dilate:0x0+2x2/custom=diamond.shape|2
```
:::

[]{#erode}

#### [39.180.2 erode](#toc-erode) {#erode .subsection}

Erode an image by using a specific structuring element. It corresponds
to the libopencv function `cvErode`.

It accepts the parameters:
`struct_el`{.variable}:`nb_iterations`{.variable}, with the same syntax
and semantics as the [dilate](#dilate) filter.

[]{#smooth}

#### [39.180.3 smooth](#toc-smooth) {#smooth .subsection}

Smooth the input video.

The filter takes the following parameters:
`type`{.variable}\|`param1`{.variable}\|`param2`{.variable}\|`param3`{.variable}\|`param4`{.variable}.

`type`{.variable} is the type of smooth filter to apply, and must be one
of the following values: \"blur\", \"blur_no_scale\", \"median\",
\"gaussian\", or \"bilateral\". The default value is \"gaussian\".

The meaning of `param1`{.variable}, `param2`{.variable},
`param3`{.variable}, and `param4`{.variable} depends on the smooth type.
`param1`{.variable} and `param2`{.variable} accept integer positive
values or 0. `param3`{.variable} and `param4`{.variable} accept floating
point values.

The default value for `param1`{.variable} is 3. The default value for
the other parameters is 0.

These parameters correspond to the parameters assigned to the libopencv
function `cvSmooth`.

[]{#oscilloscope}

### [39.181 oscilloscope](#toc-oscilloscope) {#oscilloscope .section}

2D Video Oscilloscope.

Useful to measure spatial impulse, step responses, chroma delays, etc.

It accepts the following parameters:

`x`{.sample}

:   Set scope center x position.

`y`{.sample}

:   Set scope center y position.

`s`{.sample}

:   Set scope size, relative to frame diagonal.

`t`{.sample}

:   Set scope tilt/rotation.

`o`{.sample}

:   Set trace opacity.

`tx`{.sample}

:   Set trace center x position.

`ty`{.sample}

:   Set trace center y position.

`tw`{.sample}

:   Set trace width, relative to width of frame.

`th`{.sample}

:   Set trace height, relative to height of frame.

`c`{.sample}

:   Set which components to trace. By default it traces first three
    components.

`g`{.sample}

:   Draw trace grid. By default is enabled.

`st`{.sample}

:   Draw some statistics. By default is enabled.

`sc`{.sample}

:   Draw scope. By default is enabled.

[]{#Commands-127}

#### [39.181.1 Commands](#toc-Commands-127) {#commands-127 .subsection}

This filter supports same [commands](#commands) as options. The command
accepts the same syntax of the corresponding option.

If the specified expression is not valid, it is kept at its current
value.

[]{#Examples-146}

#### [39.181.2 Examples](#toc-Examples-146) {#examples-146 .subsection}

- Inspect full first row of video frame.

  ::: example
  ``` example
  oscilloscope=x=0.5:y=0:s=1
  ```
  :::
- Inspect full last row of video frame.

  ::: example
  ``` example
  oscilloscope=x=0.5:y=1:s=1
  ```
  :::
- Inspect full 5th line of video frame of height 1080.

  ::: example
  ``` example
  oscilloscope=x=0.5:y=5/1080:s=1
  ```
  :::
- Inspect full last column of video frame.

  ::: example
  ``` example
  oscilloscope=x=1:y=0.5:s=1:t=1
  ```
  :::

[]{#overlay}[]{#overlay-1}

### [39.182 overlay](#toc-overlay-1) {#overlay .section}

Overlay one video on top of another.

It takes two inputs and has one output. The first input is the \"main\"
video on which the second input is overlaid.

It accepts the following parameters:

A description of the accepted options follows.

`x`{.sample}\
`y`{.sample}

:   Set the expression for the x and y coordinates of the overlaid video
    on the main video. Default value is \"0\" for both expressions. In
    case the expression is invalid, it is set to a huge value (meaning
    that the overlay will not be displayed within the output visible
    area).

`eof_action`{.sample}

:   See [framesync](#framesync).

`eval`{.sample}

:   Set when the expressions for `x`{.sample}, and `y`{.sample} are
    evaluated.

    It accepts the following values:

    '`init`{.sample}'

    :   only evaluate expressions once during the filter initialization
        or when a command is processed

    '`frame`{.sample}'

    :   evaluate expressions for each incoming frame

    Default value is '`frame`{.sample}'.

`shortest`{.sample}

:   See [framesync](#framesync).

`format`{.sample}

:   Set the format for the output video.

    It accepts the following values:

    '`yuv420`{.sample}'

    :   force YUV 4:2:0 8-bit planar output

    '`yuv420p10`{.sample}'

    :   force YUV 4:2:0 10-bit planar output

    '`yuv422`{.sample}'

    :   force YUV 4:2:2 8-bit planar output

    '`yuv422p10`{.sample}'

    :   force YUV 4:2:2 10-bit planar output

    '`yuv444`{.sample}'

    :   force YUV 4:4:4 8-bit planar output

    '`yuv444p10`{.sample}'

    :   force YUV 4:4:4 10-bit planar output

    '`rgb`{.sample}'

    :   force RGB 8-bit packed output

    '`gbrp`{.sample}'

    :   force RGB 8-bit planar output

    '`auto`{.sample}'

    :   automatically pick format

    Default value is '`yuv420`{.sample}'.

`repeatlast`{.sample}

:   See [framesync](#framesync).

`alpha`{.sample}

:   Set format of alpha of the overlaid video, it can be
    `straight`{.variable} or `premultiplied`{.variable}, or
    `auto`{.variable} to choose the alpha mode automatically. Default is
    `auto`{.variable}.

The `x`{.sample}, and `y`{.sample} expressions can contain the following
parameters.

`main_w, W`{.sample}\
`main_h, H`{.sample}

:   The main input width and height.

`overlay_w, w`{.sample}\
`overlay_h, h`{.sample}

:   The overlay input width and height.

`x`{.sample}\
`y`{.sample}

:   The computed values for `x`{.variable} and `y`{.variable}. They are
    evaluated for each new frame.

`hsub`{.sample}\
`vsub`{.sample}

:   horizontal and vertical chroma subsample values of the output
    format. For example for the pixel format \"yuv422p\"
    `hsub`{.variable} is 2 and `vsub`{.variable} is 1.

`n`{.sample}

:   the number of input frame, starting from 0

`pos`{.sample}

:   the position in the file of the input frame, NAN if unknown;
    deprecated, do not use

`t`{.sample}

:   The timestamp, expressed in seconds. It's NAN if the input timestamp
    is unknown.

This filter also supports the [framesync](#framesync) options.

Note that the `n`{.variable}, `t`{.variable} variables are available
only when evaluation is done *per frame*, and will evaluate to NAN when
`eval`{.sample} is set to '`init`{.sample}'.

Be aware that frames are taken from each input video in timestamp order,
hence, if their initial timestamps differ, it is a good idea to pass the
two inputs through a `setpts=PTS-STARTPTS`{.variable} filter to have
them begin in the same zero timestamp, as the example for the
`movie`{.variable} filter does.

You can chain together more overlays but you should test the efficiency
of such approach.

[]{#Commands-128}

#### [39.182.1 Commands](#toc-Commands-128) {#commands-128 .subsection}

This filter supports the following commands:

`x`{.sample}\
`y`{.sample}

:   Modify the x and y of the overlay input. The command accepts the
    same syntax of the corresponding option.

    If the specified expression is not valid, it is kept at its current
    value.

[]{#Examples-147}

#### [39.182.2 Examples](#toc-Examples-147) {#examples-147 .subsection}

- Draw the overlay at 10 pixels from the bottom right corner of the main
  video:

  ::: example
  ``` example
  overlay=main_w-overlay_w-10:main_h-overlay_h-10
  ```
  :::

  Using named options the example above becomes:

  ::: example
  ``` example
  overlay=x=main_w-overlay_w-10:y=main_h-overlay_h-10
  ```
  :::

- Insert a transparent PNG logo in the bottom left corner of the input,
  using the `ffmpeg` tool with the `-filter_complex` option:

  ::: example
  ``` example
  ffmpeg -i input -i logo -filter_complex 'overlay=10:main_h-overlay_h-10' output
  ```
  :::

- Insert 2 different transparent PNG logos (second logo on bottom right
  corner) using the `ffmpeg` tool:

  ::: example
  ``` example
  ffmpeg -i input -i logo1 -i logo2 -filter_complex 'overlay=x=10:y=H-h-10,overlay=x=W-w-10:y=H-h-10' output
  ```
  :::

- Add a transparent color layer on top of the main video; `WxH` must
  specify the size of the main input to the overlay filter:

  ::: example
  ``` example
  color=color=red@.3:size=WxH [over]; [in][over] overlay [out]
  ```
  :::

- Play an original video and a filtered version (here with the deshake
  filter) side by side using the `ffplay` tool:

  ::: example
  ``` example
  ffplay input.avi -vf 'split[a][b]; [a]pad=iw*2:ih[src]; [b]deshake[filt]; [src][filt]overlay=w'
  ```
  :::

  The above command is the same as:

  ::: example
  ``` example
  ffplay input.avi -vf 'split[b], pad=iw*2[src], [b]deshake, [src]overlay=w'
  ```
  :::

- Make a sliding overlay appearing from the left to the right top part
  of the screen starting since time 2:

  ::: example
  ``` example
  overlay=x='if(gte(t,2), -w+(t-2)*20, NAN)':y=0
  ```
  :::

- Compose output by putting two input videos side to side:

  ::: example
  ``` example
  ffmpeg -i left.avi -i right.avi -filter_complex "
  nullsrc=size=200x100 [background];
  [0:v] setpts=PTS-STARTPTS, scale=100x100 [left];
  [1:v] setpts=PTS-STARTPTS, scale=100x100 [right];
  [background][left]       overlay=shortest=1       [background+left];
  [background+left][right] overlay=shortest=1:x=100 [left+right]
  "
  ```
  :::

- Mask 10-20 seconds of a video by applying the delogo filter to a
  section

  ::: example
  ``` example
  ffmpeg -i test.avi -codec:v:0 wmv2 -ar 11025 -b:v 9000k
  -vf '[in]split[split_main][split_delogo];[split_delogo]trim=start=360:end=371,delogo=0:0:640:480[delogoed];[split_main][delogoed]overlay=eof_action=pass[out]'
  masked.avi
  ```
  :::

- Chain several overlays in cascade:

  ::: example
  ``` example
  nullsrc=s=200x200 [bg];
  testsrc=s=100x100, split=4 [in0][in1][in2][in3];
  [in0] lutrgb=r=0, [bg]   overlay=0:0     [mid0];
  [in1] lutrgb=g=0, [mid0] overlay=100:0   [mid1];
  [in2] lutrgb=b=0, [mid1] overlay=0:100   [mid2];
  [in3] null,       [mid2] overlay=100:100 [out0]
  ```
  :::

[]{#owdenoise}

### [39.183 owdenoise](#toc-owdenoise) {#owdenoise .section}

Apply Overcomplete Wavelet denoiser.

The filter accepts the following options:

`depth`{.sample}

:   Set depth.

    Larger depth values will denoise lower frequency components more,
    but slow down filtering.

    Must be an int in the range 8-16, default is `8`.

`luma_strength, ls`{.sample}

:   Set luma strength.

    Must be a double value in the range 0-1000, default is `1.0`.

`chroma_strength, cs`{.sample}

:   Set chroma strength.

    Must be a double value in the range 0-1000, default is `1.0`.

[]{#pad}[]{#pad-1}

### [39.184 pad](#toc-pad-1) {#pad .section}

Add paddings to the input image, and place the original input at the
provided `x`{.variable}, `y`{.variable} coordinates.

It accepts the following parameters:

`width, w`{.sample}\
`height, h`{.sample}

:   Specify an expression for the size of the output image with the
    paddings added. If the value for `width`{.variable} or
    `height`{.variable} is 0, the corresponding input size is used for
    the output.

    The `width`{.variable} expression can reference the value set by the
    `height`{.variable} expression, and vice versa.

    The default value of `width`{.variable} and `height`{.variable} is
    0.

`x`{.sample}\
`y`{.sample}

:   Specify the offsets to place the input image at within the padded
    area, with respect to the top/left border of the output image.

    The `x`{.variable} expression can reference the value set by the
    `y`{.variable} expression, and vice versa.

    The default value of `x`{.variable} and `y`{.variable} is 0.

    If `x`{.variable} or `y`{.variable} evaluate to a negative number,
    they'll be changed so the input image is centered on the padded
    area.

`color`{.sample}

:   Specify the color of the padded area. For the syntax of this option,
    check the [(ffmpeg-utils)\"Color\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#color-syntax).

    The default value of `color`{.variable} is \"black\".

`eval`{.sample}

:   Specify when to evaluate `width`{.variable}, `height`{.variable},
    `x`{.variable} and `y`{.variable} expression.

    It accepts the following values:

    '`init`{.sample}'

    :   Only evaluate expressions once during the filter initialization
        or when a command is processed.

    '`frame`{.sample}'

    :   Evaluate expressions for each incoming frame.

    Default value is '`init`{.sample}'.

`aspect`{.sample}

:   Pad to aspect instead to a resolution.

The value for the `width`{.variable}, `height`{.variable},
`x`{.variable}, and `y`{.variable} options are expressions containing
the following constants:

`in_w`{.sample}\
`in_h`{.sample}

:   The input video width and height.

`iw`{.sample}\
`ih`{.sample}

:   These are the same as `in_w`{.variable} and `in_h`{.variable}.

`out_w`{.sample}\
`out_h`{.sample}

:   The output width and height (the size of the padded area), as
    specified by the `width`{.variable} and `height`{.variable}
    expressions.

`ow`{.sample}\
`oh`{.sample}

:   These are the same as `out_w`{.variable} and `out_h`{.variable}.

`x`{.sample}\
`y`{.sample}

:   The x and y offsets as specified by the `x`{.variable} and
    `y`{.variable} expressions, or NAN if not yet specified.

`a`{.sample}

:   same as `iw`{.variable} / `ih`{.variable}

`sar`{.sample}

:   input sample aspect ratio

`dar`{.sample}

:   input display aspect ratio, it is the same as (`iw`{.variable} /
    `ih`{.variable}) \* `sar`{.variable}

`hsub`{.sample}\
`vsub`{.sample}

:   The horizontal and vertical chroma subsample values. For example for
    the pixel format \"yuv422p\" `hsub`{.variable} is 2 and
    `vsub`{.variable} is 1.

[]{#Examples-148}

#### [39.184.1 Examples](#toc-Examples-148) {#examples-148 .subsection}

- Add paddings with the color \"violet\" to the input video. The output
  video size is 640x480, and the top-left corner of the input video is
  placed at column 0, row 40

  ::: example
  ``` example
  pad=640:480:0:40:violet
  ```
  :::

  The example above is equivalent to the following command:

  ::: example
  ``` example
  pad=width=640:height=480:x=0:y=40:color=violet
  ```
  :::

- Pad the input to get an output with dimensions increased by 3/2, and
  put the input video at the center of the padded area:

  ::: example
  ``` example
  pad="3/2*iw:3/2*ih:(ow-iw)/2:(oh-ih)/2"
  ```
  :::

- Pad the input to get a squared output with size equal to the maximum
  value between the input width and height, and put the input video at
  the center of the padded area:

  ::: example
  ``` example
  pad="max(iw\,ih):ow:(ow-iw)/2:(oh-ih)/2"
  ```
  :::

- Pad the input to get a final w/h ratio of 16:9:

  ::: example
  ``` example
  pad="ih*16/9:ih:(ow-iw)/2:(oh-ih)/2"
  ```
  :::

- In case of anamorphic video, in order to set the output display aspect
  correctly, it is necessary to use `sar`{.variable} in the expression,
  according to the relation:

  ::: example
  ``` example
  (ih * X / ih) * sar = output_dar
  X = output_dar / sar
  ```
  :::

  Thus the previous example needs to be modified to:

  ::: example
  ``` example
  pad="ih*16/9/sar:ih:(ow-iw)/2:(oh-ih)/2"
  ```
  :::

- Double the output size and put the input video in the bottom-right
  corner of the output padded area:

  ::: example
  ``` example
  pad="2*iw:2*ih:ow-iw:oh-ih"
  ```
  :::

[]{#palettegen}[]{#palettegen-1}

### [39.185 palettegen](#toc-palettegen-1) {#palettegen .section}

Generate one palette for a whole video stream.

It accepts the following options:

`max_colors`{.sample}

:   Set the maximum number of colors to quantize in the palette. Note:
    the palette will still contain 256 colors; the unused palette
    entries will be black.

`reserve_transparent`{.sample}

:   Create a palette of 255 colors maximum and reserve the last one for
    transparency. Reserving the transparency color is useful for GIF
    optimization. If not set, the maximum of colors in the palette will
    be 256. You probably want to disable this option for a standalone
    image. Set by default.

`transparency_color`{.sample}

:   Set the color that will be used as background for transparency.

`stats_mode`{.sample}

:   Set statistics mode.

    It accepts the following values:

    '`full`{.sample}'

    :   Compute full frame histograms.

    '`diff`{.sample}'

    :   Compute histograms only for the part that differs from previous
        frame. This might be relevant to give more importance to the
        moving part of your input if the background is static.

    '`single`{.sample}'

    :   Compute new histogram for each frame.

    Default value is `full`{.variable}.

The filter also exports the frame metadata `lavfi.color_quant_ratio`
(`nb_color_in / nb_color_out`) which you can use to evaluate the degree
of color quantization of the palette. This information is also visible
at `info`{.variable} logging level.

[]{#Examples-149}

#### [39.185.1 Examples](#toc-Examples-149) {#examples-149 .subsection}

- Generate a representative palette of a given video using `ffmpeg`:

  ::: example
  ``` example
  ffmpeg -i input.mkv -vf palettegen palette.png
  ```
  :::

[]{#paletteuse}

### [39.186 paletteuse](#toc-paletteuse) {#paletteuse .section}

Use a palette to downsample an input video stream.

The filter takes two inputs: one video stream and a palette. The palette
must be a 256 pixels image.

It accepts the following options:

`dither`{.sample}

:   Select dithering mode. Available algorithms are:

    '`bayer`{.sample}'

    :   Ordered 8x8 bayer dithering (deterministic)

    '`heckbert`{.sample}'

    :   Dithering as defined by Paul Heckbert in 1982 (simple error
        diffusion). Note: this dithering is sometimes considered
        \"wrong\" and is included as a reference.

    '`floyd_steinberg`{.sample}'

    :   Floyd and Steingberg dithering (error diffusion)

    '`sierra2`{.sample}'

    :   Frankie Sierra dithering v2 (error diffusion)

    '`sierra2_4a`{.sample}'

    :   Frankie Sierra dithering v2 \"Lite\" (error diffusion)

    '`sierra3`{.sample}'

    :   Frankie Sierra dithering v3 (error diffusion)

    '`burkes`{.sample}'

    :   Burkes dithering (error diffusion)

    '`atkinson`{.sample}'

    :   Atkinson dithering by Bill Atkinson at Apple Computer (error
        diffusion)

    '`none`{.sample}'

    :   Disable dithering.

    Default is `sierra2_4a`{.variable}.

`bayer_scale`{.sample}

:   When `bayer`{.variable} dithering is selected, this option defines
    the scale of the pattern (how much the crosshatch pattern is
    visible). A low value means more visible pattern for less banding,
    and higher value means less visible pattern at the cost of more
    banding.

    The option must be an integer value in the range \[0,5\]. Default is
    `2`{.variable}.

`diff_mode`{.sample}

:   If set, define the zone to process

    '`rectangle`{.sample}'

    :   Only the changing rectangle will be reprocessed. This is similar
        to GIF cropping/offsetting compression mechanism. This option
        can be useful for speed if only a part of the image is changing,
        and has use cases such as limiting the scope of the error
        diffusal `dither`{.sample} to the rectangle that bounds the
        moving scene (it leads to more deterministic output if the scene
        doesn't change much, and as a result less moving noise and
        better GIF compression).

    Default is `none`{.variable}.

`new`{.sample}

:   Take new palette for each output frame.

`alpha_threshold`{.sample}

:   Sets the alpha threshold for transparency. Alpha values above this
    threshold will be treated as completely opaque, and values below
    this threshold will be treated as completely transparent.

    The option must be an integer value in the range \[0,255\]. Default
    is `128`{.variable}.

[]{#Examples-150}

#### [39.186.1 Examples](#toc-Examples-150) {#examples-150 .subsection}

- Use a palette (generated for example with [palettegen](#palettegen))
  to encode a GIF using `ffmpeg`:

  ::: example
  ``` example
  ffmpeg -i input.mkv -i palette.png -lavfi paletteuse output.gif
  ```
  :::

[]{#perspective}

### [39.187 perspective](#toc-perspective) {#perspective .section}

Correct perspective of video not recorded perpendicular to the screen.

A description of the accepted parameters follows.

`x0`{.sample}

`y0`{.sample}

`x1`{.sample}

`y1`{.sample}

`x2`{.sample}

`y2`{.sample}

`x3`{.sample}

`y3`{.sample}

Set coordinates expression for top left, top right, bottom left and
bottom right corners. Default values are `0:0:W:0:0:H:W:H` with which
perspective will remain unchanged. If the `sense` option is set to
`source`, then the specified points will be sent to the corners of the
destination. If the `sense` option is set to `destination`, then the
corners of the source will be sent to the specified coordinates.

The expressions can use the following variables:

`W`{.sample}\
`H`{.sample}

:   the width and height of video frame.

`in`{.sample}

:   Input frame count.

`on`{.sample}

:   Output frame count.

`interpolation`{.sample}

Set interpolation for perspective correction.

It accepts the following values:

'`linear`{.sample}'

'`cubic`{.sample}'

Default value is '`linear`{.sample}'.

`sense`{.sample}

Set interpretation of coordinate options.

It accepts the following values:

'`0, source`{.sample}'

:   Send point in the source specified by the given coordinates to the
    corners of the destination.

'`1, destination`{.sample}'

:   Send the corners of the source to the point in the destination
    specified by the given coordinates.

    Default value is '`source`{.sample}'.

`eval`{.sample}

Set when the expressions for coordinates `x0,y0,...x3,y3`{.sample} are
evaluated.

It accepts the following values:

'`init`{.sample}'

:   only evaluate expressions once during the filter initialization or
    when a command is processed

'`frame`{.sample}'

:   evaluate expressions for each incoming frame

Default value is '`init`{.sample}'.

[]{#phase}

### [39.188 phase](#toc-phase) {#phase .section}

Delay interlaced video by one field time so that the field order
changes.

The intended use is to fix PAL movies that have been captured with the
opposite field order to the film-to-video transfer.

A description of the accepted parameters follows.

`mode`{.sample}

:   Set phase mode.

    It accepts the following values:

    '`t`{.sample}'

    :   Capture field order top-first, transfer bottom-first. Filter
        will delay the bottom field.

    '`b`{.sample}'

    :   Capture field order bottom-first, transfer top-first. Filter
        will delay the top field.

    '`p`{.sample}'

    :   Capture and transfer with the same field order. This mode only
        exists for the documentation of the other options to refer to,
        but if you actually select it, the filter will faithfully do
        nothing.

    '`a`{.sample}'

    :   Capture field order determined automatically by field flags,
        transfer opposite. Filter selects among '`t`{.sample}' and
        '`b`{.sample}' modes on a frame by frame basis using field
        flags. If no field information is available, then this works
        just like '`u`{.sample}'.

    '`u`{.sample}'

    :   Capture unknown or varying, transfer opposite. Filter selects
        among '`t`{.sample}' and '`b`{.sample}' on a frame by frame
        basis by analyzing the images and selecting the alternative that
        produces best match between the fields.

    '`T`{.sample}'

    :   Capture top-first, transfer unknown or varying. Filter selects
        among '`t`{.sample}' and '`p`{.sample}' using image analysis.

    '`B`{.sample}'

    :   Capture bottom-first, transfer unknown or varying. Filter
        selects among '`b`{.sample}' and '`p`{.sample}' using image
        analysis.

    '`A`{.sample}'

    :   Capture determined by field flags, transfer unknown or varying.
        Filter selects among '`t`{.sample}', '`b`{.sample}' and
        '`p`{.sample}' using field flags and image analysis. If no field
        information is available, then this works just like
        '`U`{.sample}'. This is the default mode.

    '`U`{.sample}'

    :   Both capture and transfer unknown or varying. Filter selects
        among '`t`{.sample}', '`b`{.sample}' and '`p`{.sample}' using
        image analysis only.

[]{#Commands-129}

#### [39.188.1 Commands](#toc-Commands-129) {#commands-129 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#photosensitivity}

### [39.189 photosensitivity](#toc-photosensitivity) {#photosensitivity .section}

Reduce various flashes in video, so to help users with epilepsy.

It accepts the following options:

`frames, f`{.sample}

:   Set how many frames to use when filtering. Default is 30.

`threshold, t`{.sample}

:   Set detection threshold factor. Default is 1. Lower is stricter.

`skip`{.sample}

:   Set how many pixels to skip when sampling frames. Default is 1.
    Allowed range is from 1 to 1024.

`bypass`{.sample}

:   Leave frames unchanged. Default is disabled.

[]{#pixdesctest}

### [39.190 pixdesctest](#toc-pixdesctest) {#pixdesctest .section}

Pixel format descriptor test filter, mainly useful for internal testing.
The output video should be equal to the input video.

For example:

::: example
``` example
format=monow, pixdesctest
```
:::

can be used to test the monowhite pixel format descriptor definition.

[]{#pixelize}

### [39.191 pixelize](#toc-pixelize) {#pixelize .section}

Apply pixelization to video stream.

The filter accepts the following options:

`width, w`{.sample}

`height, h`{.sample}

Set block dimensions that will be used for pixelization. Default value
is `16`.

`mode, m`{.sample}

Set the mode of pixelization used.

Possible values are:

'`avg`{.sample}'

'`min`{.sample}'

'`max`{.sample}'

Default value is `avg`.

`planes, p`{.sample}

Set what planes to filter. Default is to filter all planes.

[]{#Commands-130}

#### [39.191.1 Commands](#toc-Commands-130) {#commands-130 .subsection}

This filter supports all options as [commands](#commands).

[]{#pixscope}

### [39.192 pixscope](#toc-pixscope) {#pixscope .section}

Display sample values of color channels. Mainly useful for checking
color and levels. Minimum supported resolution is 640x480.

The filters accept the following options:

`x`{.sample}

:   Set scope X position, relative offset on X axis.

`y`{.sample}

:   Set scope Y position, relative offset on Y axis.

`w`{.sample}

:   Set scope width.

`h`{.sample}

:   Set scope height.

`o`{.sample}

:   Set window opacity. This window also holds statistics about pixel
    area.

`wx`{.sample}

:   Set window X position, relative offset on X axis.

`wy`{.sample}

:   Set window Y position, relative offset on Y axis.

[]{#Commands-131}

#### [39.192.1 Commands](#toc-Commands-131) {#commands-131 .subsection}

This filter supports same [commands](#commands) as options.

[]{#pp7}

### [39.193 pp7](#toc-pp7) {#pp7 .section}

Apply Postprocessing filter 7. It is variant of the [spp](#spp) filter,
similar to spp = 6 with 7 point DCT, where only the center sample is
used after IDCT.

The filter accepts the following options:

`qp`{.sample}

:   Force a constant quantization parameter. It accepts an integer in
    range 0 to 63. If not set, the filter will use the QP from the video
    stream (if available).

`mode`{.sample}

:   Set thresholding mode. Available modes are:

    '`hard`{.sample}'

    :   Set hard thresholding.

    '`soft`{.sample}'

    :   Set soft thresholding (better de-ringing effect, but likely
        blurrier).

    '`medium`{.sample}'

    :   Set medium thresholding (good results, default).

[]{#premultiply}

### [39.194 premultiply](#toc-premultiply) {#premultiply .section}

Apply alpha premultiply effect to input video stream using first plane
of second stream as alpha.

Both streams must have same dimensions and same pixel format.

The filter accepts the following option:

`planes`{.sample}

:   Set which planes will be processed, unprocessed planes will be
    copied. By default value 0xf, all planes will be processed.

`inplace`{.sample}

:   Do not require 2nd input for processing, instead use alpha plane
    from input stream.

[]{#premultiply_005fdynamic}

### [39.195 premultiply_dynamic](#toc-premultiply_005fdynamic) {#premultiply_dynamic .section}

Dynamically premultiply or unpremultiply the input video stream as
needed, to match the requirements of the downstream filter graph. This
is roughly equivalent to either `premultiply:inplace=yes` or
`unpremultiply:inplace=yes`, or otherwise a noop.

The filter accepts the following option:

`planes`{.sample}

:   Set which planes will be processed, unprocessed planes will be
    copied. By default value 0xf, all planes will be processed.

[]{#prewitt}

### [39.196 prewitt](#toc-prewitt) {#prewitt .section}

Apply prewitt operator to input video stream.

The filter accepts the following option:

`planes`{.sample}

:   Set which planes will be processed, unprocessed planes will be
    copied. By default value 0xf, all planes will be processed.

`scale`{.sample}

:   Set value which will be multiplied with filtered result.

`delta`{.sample}

:   Set value which will be added to filtered result.

[]{#Commands-132}

#### [39.196.1 Commands](#toc-Commands-132) {#commands-132 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#pseudocolor}

### [39.197 pseudocolor](#toc-pseudocolor) {#pseudocolor .section}

Alter frame colors in video with pseudocolors.

This filter accepts the following options:

`c0`{.sample}

set pixel first component expression

`c1`{.sample}

set pixel second component expression

`c2`{.sample}

set pixel third component expression

`c3`{.sample}

set pixel fourth component expression, corresponds to the alpha
component

`index, i`{.sample}

set component to use as base for altering colors

`preset, p`{.sample}

Pick one of built-in LUTs. By default is set to none.

Available LUTs:

'`magma`{.sample}'

'`inferno`{.sample}'

'`plasma`{.sample}'

'`viridis`{.sample}'

'`turbo`{.sample}'

'`cividis`{.sample}'

'`range1`{.sample}'

'`range2`{.sample}'

'`shadows`{.sample}'

'`highlights`{.sample}'

'`solar`{.sample}'

'`nominal`{.sample}'

'`preferred`{.sample}'

'`total`{.sample}'

'`spectral`{.sample}'

'`cool`{.sample}'

'`heat`{.sample}'

'`fiery`{.sample}'

'`blues`{.sample}'

'`green`{.sample}'

'`helix`{.sample}'

`opacity`{.sample}

Set opacity of output colors. Allowed range is from 0 to 1. Default
value is set to 1.

Each of the expression options specifies the expression to use for
computing the lookup table for the corresponding pixel component values.

The expressions can contain the following constants and functions:

`w`{.sample}\
`h`{.sample}

:   The input width and height.

`val`{.sample}

:   The input value for the pixel component.

`ymin, umin, vmin, amin`{.sample}

:   The minimum allowed component value.

`ymax, umax, vmax, amax`{.sample}

:   The maximum allowed component value.

All expressions default to \"val\".

[]{#Commands-133}

#### [39.197.1 Commands](#toc-Commands-133) {#commands-133 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#Examples-151}

#### [39.197.2 Examples](#toc-Examples-151) {#examples-151 .subsection}

- Change too high luma values to gradient:

  ::: example
  ``` example
  pseudocolor="'if(between(val,ymax,amax),lerp(ymin,ymax,(val-ymax)/(amax-ymax)),-1):if(between(val,ymax,amax),lerp(umax,umin,(val-ymax)/(amax-ymax)),-1):if(between(val,ymax,amax),lerp(vmin,vmax,(val-ymax)/(amax-ymax)),-1):-1'"
  ```
  :::

[]{#psnr}[]{#psnr-1}

### [39.198 psnr](#toc-psnr-1) {#psnr .section}

Obtain the average, maximum and minimum PSNR (Peak Signal to Noise
Ratio) between two input videos.

This filter takes in input two input videos, the first input is
considered the \"main\" source and is passed unchanged to the output.
The second input is used as a \"reference\" video for computing the
PSNR.

Both video inputs must have the same resolution and pixel format for
this filter to work correctly. Also it assumes that both inputs have the
same number of frames, which are compared one by one.

The obtained average PSNR is printed through the logging system.

The filter stores the accumulated MSE (mean squared error) of each
frame, and at the end of the processing it is averaged across all frames
equally, and the following formula is applied to obtain the PSNR:

::: example
``` example
PSNR = 10*log10(MAX^2/MSE)
```
:::

Where MAX is the average of the maximum values of each component of the
image.

The description of the accepted parameters follows.

`stats_file, f`{.sample}

:   If specified the filter will use the named file to save the PSNR of
    each individual frame. When filename equals \"-\" the data is sent
    to standard output.

`stats_version`{.sample}

:   Specifies which version of the stats file format to use. Details of
    each format are written below. Default value is 1.

`output_max`{.sample}

:   Determines whether the max value is output to the stats log. Default
    value is 0. Requires stats_version \>= 2. If this is set and
    stats_version \< 2, the filter will return an error.

This filter also supports the [framesync](#framesync) options.

The file printed if `stats_file`{.variable} is selected, contains a
sequence of key/value pairs of the form
`key`{.variable}:`value`{.variable} for each compared couple of frames.

If a `stats_version`{.variable} greater than 1 is specified, a header
line precedes the list of per-frame-pair stats, with key value pairs
following the frame format with the following parameters:

`psnr_log_version`{.sample}

:   The version of the log file format. Will match
    `stats_version`{.variable}.

`fields`{.sample}

:   A comma separated list of the per-frame-pair parameters included in
    the log.

A description of each shown per-frame-pair parameter follows:

`n`{.sample}

:   sequential number of the input frame, starting from 1

`mse_avg`{.sample}

:   Mean Square Error pixel-by-pixel average difference of the compared
    frames, averaged over all the image components.

`mse_y, mse_u, mse_v, mse_r, mse_g, mse_b, mse_a`{.sample}

:   Mean Square Error pixel-by-pixel average difference of the compared
    frames for the component specified by the suffix.

`psnr_y, psnr_u, psnr_v, psnr_r, psnr_g, psnr_b, psnr_a`{.sample}

:   Peak Signal to Noise ratio of the compared frames for the component
    specified by the suffix.

`max_avg, max_y, max_u, max_v`{.sample}

:   Maximum allowed value for each channel, and average over all
    channels.

[]{#Examples-152}

#### [39.198.1 Examples](#toc-Examples-152) {#examples-152 .subsection}

- For example:

  ::: example
  ``` example
  movie=ref_movie.mpg, setpts=PTS-STARTPTS [main];
  [main][ref] psnr="stats_file=stats.log" [out]
  ```
  :::

  On this example the input file being processed is compared with the
  reference file `ref_movie.mpg`{.sample}. The PSNR of each individual
  frame is stored in `stats.log`{.sample}.

- Another example with different containers:

  ::: example
  ``` example
  ffmpeg -i main.mpg -i ref.mkv -lavfi  "[0:v]settb=AVTB,setpts=PTS-STARTPTS[main];[1:v]settb=AVTB,setpts=PTS-STARTPTS[ref];[main][ref]psnr" -f null -
  ```
  :::

[]{#pullup}[]{#pullup-1}

### [39.199 pullup](#toc-pullup-1) {#pullup .section}

Pulldown reversal (inverse telecine) filter, capable of handling mixed
hard-telecine, 24000/1001 fps progressive, and 30000/1001 fps
progressive content.

The pullup filter is designed to take advantage of future context in
making its decisions. This filter is stateless in the sense that it does
not lock onto a pattern to follow, but it instead looks forward to the
following fields in order to identify matches and rebuild progressive
frames.

To produce content with an even framerate, insert the fps filter after
pullup, use `fps=24000/1001` if the input frame rate is 29.97fps,
`fps=24` for 30fps and the (rare) telecined 25fps input.

The filter accepts the following options:

`jl`{.sample}\
`jr`{.sample}\
`jt`{.sample}\
`jb`{.sample}

:   These options set the amount of \"junk\" to ignore at the left,
    right, top, and bottom of the image, respectively. Left and right
    are in units of 8 pixels, while top and bottom are in units of 2
    lines. The default is 8 pixels on each side.

`sb`{.sample}

:   Set the strict breaks. Setting this option to 1 will reduce the
    chances of filter generating an occasional mismatched frame, but it
    may also cause an excessive number of frames to be dropped during
    high motion sequences. Conversely, setting it to -1 will make filter
    match fields more easily. This may help processing of video where
    there is slight blurring between the fields, but may also cause
    there to be interlaced frames in the output. Default value is `0`.

`mp`{.sample}

:   Set the metric plane to use. It accepts the following values:

    '`l`{.sample}'

    :   Use luma plane.

    '`u`{.sample}'

    :   Use chroma blue plane.

    '`v`{.sample}'

    :   Use chroma red plane.

    This option may be set to use chroma plane instead of the default
    luma plane for doing filter's computations. This may improve
    accuracy on very clean source material, but more likely will
    decrease accuracy, especially if there is chroma noise (rainbow
    effect) or any grayscale video. The main purpose of setting
    `mp`{.sample} to a chroma plane is to reduce CPU load and make
    pullup usable in realtime on slow machines.

For best results (without duplicated frames in the output file) it is
necessary to change the output frame rate. For example, to inverse
telecine NTSC input:

::: example
``` example
ffmpeg -i input -vf pullup -r 24000/1001 ...
```
:::

[]{#qp}

### [39.200 qp](#toc-qp) {#qp .section}

Change video quantization parameters (QP).

The filter accepts the following option:

`qp`{.sample}

:   Set expression for quantization parameter.

The expression is evaluated through the eval API and can contain, among
others, the following constants:

`known`{.variable}

:   1 if index is not 129, 0 otherwise.

`qp`{.variable}

:   Sequential index starting from -129 to 128.

[]{#Examples-153}

#### [39.200.1 Examples](#toc-Examples-153) {#examples-153 .subsection}

- Some equation like:

  ::: example
  ``` example
  qp=2+2*sin(PI*qp)
  ```
  :::

[]{#qrencode}

### [39.201 qrencode](#toc-qrencode) {#qrencode .section}

Generate a QR code using the libqrencode library (see
<https://fukuchi.org/works/qrencode/>), and overlay it on top of the
current frame.

To enable the compilation of this filter, you need to configure FFmpeg
with `--enable-libqrencode`.

The QR code is generated from the provided text or text pattern. The
corresponding QR code is scaled and overlaid into the video output
according to the specified options.

In case no text is specified, no QR code is overlaied.

This filter accepts the following options:

`qrcode_width, q`{.sample}

`padded_qrcode_width, Q`{.sample}

Specify an expression for the width of the rendered QR code, with and
without padding. The `qrcode_width`{.variable} expression can reference
the value set by the `padded_qrcode_width`{.variable} expression, and
vice versa. By default `padded_qrcode_width`{.variable} is set to
`qrcode_width`{.variable}, meaning that there is no padding.

These expressions are evaluated for each new frame.

See the [qrencode Expressions](#qrencode_005fexpressions) section for
details.

`x`{.sample}

`y`{.sample}

Specify an expression for positioning the padded QR code top-left
corner. The `x`{.variable} expression can reference the value set by the
`y`{.variable} expression, and vice.

By default `x`{.variable} and `y`{.variable} are set set to
`0`{.variable}, meaning that the QR code is placed in the top left
corner of the input.

These expressions are evaluated for each new frame.

See the [qrencode Expressions](#qrencode_005fexpressions) section for
details.

`case_sensitive, cs`{.sample}

Instruct libqrencode to use case sensitive encoding. This is enabled by
default. This can be disabled to reduce the QR encoding size.

`level, l`{.sample}

Specify the QR encoding error correction level. With an higher
correction level, the encoding size will increase but the code will be
more robust to corruption. Lower level is `L`{.variable}.

It accepts the following values:

'`L`{.sample}'

'`M`{.sample}'

'`Q`{.sample}'

'`H`{.sample}'

`expansion`{.sample}

Select how the input text is expanded. Can be either `none`, or `normal`
(default). See the [qrencode Text
expansion](#qrencode_005ftext_005fexpansion) section below for details.

`text`{.sample}

`textfile`{.sample}

Define the text to be rendered. In case neither is specified, no QR is
encoded (just an empty colored frame).

In case expansion is enabled, the text is treated as a text template,
using the qrencode expansion mechanism. See the [qrencode Text
expansion](#qrencode_005ftext_005fexpansion) section below for details.

`background_color, bc`{.sample}

`foreground_color, fc`{.sample}

Set the QR code and background color. The default value of
`foreground_color`{.variable} is \"black\", the default value of
`background_color`{.variable} is \"white\".

For the syntax of the color options, check the [(ffmpeg-utils)\"Color\"
section in the ffmpeg-utils manual](ffmpeg-utils.html#color-syntax).

[]{#qrencode_005fexpressions}[]{#qrencode-Expressions}

#### [39.201.1 qrencode Expressions](#toc-qrencode-Expressions) {#qrencode-expressions .subsection}

The expressions set by the options contain the following constants and
functions.

`dar`{.sample}

:   input display aspect ratio, it is the same as (`w`{.variable} /
    `h`{.variable}) \* `sar`{.variable}

`duration`{.sample}

:   the current frame's duration, in seconds

`hsub`{.sample}\
`vsub`{.sample}

:   horizontal and vertical chroma subsample values. For example for the
    pixel format \"yuv422p\" `hsub`{.variable} is 2 and
    `vsub`{.variable} is 1.

`main_h, H`{.sample}

:   the input height

`main_w, W`{.sample}

:   the input width

`n`{.sample}

:   the number of input frame, starting from 0

`pict_type`{.sample}

:   a number representing the picture type

`qr_w, w`{.sample}

:   the width of the encoded QR code

`rendered_qr_w, q`{.sample}\
`rendered_padded_qr_w, Q`{.sample}

:   the width of the rendered QR code, without and without padding.

    These parameters allow the `q`{.variable} and `Q`{.variable}
    expressions to refer to each other, so you can for example specify
    `q=3/4*Q`.

`rand(min, max)`{.sample}

:   return a random number included between `min`{.variable} and
    `max`{.variable}

`sar`{.sample}

:   the input sample aspect ratio

`t`{.sample}

:   timestamp expressed in seconds, NAN if the input timestamp is
    unknown

`x`{.sample}\
`y`{.sample}

:   the x and y offset coordinates where the text is drawn.

    These parameters allow the `x`{.variable} and `y`{.variable}
    expressions to refer to each other, so you can for example specify
    `y=x/dar`.

[]{#qrencode_005ftext_005fexpansion}[]{#qrencode-Text-expansion}

#### [39.201.2 qrencode Text expansion](#toc-qrencode-Text-expansion) {#qrencode-text-expansion .subsection}

If `expansion`{.sample} is set to `none`, the text is printed verbatim.

If `expansion`{.sample} is set to `normal` (which is the default), the
following expansion mechanism is used.

The backslash character '`\`{.sample}', followed by any character,
always expands to the second character.

Sequences of the form `%{...}` are expanded. The text between the braces
is a function name, possibly followed by arguments separated by ':'. If
the arguments contain special characters or delimiters (':' or '}'),
they should be escaped.

Note that they probably must also be escaped as the value for the
`text`{.sample} option in the filter argument string and as the filter
argument in the filtergraph description, and possibly also for the
shell, that makes up to four levels of escaping; using a text file with
the `textfile`{.sample} option avoids these problems.

The following functions are available:

`n, frame_num`

:   return the frame number

`pts`

:   Return the presentation timestamp of the current frame.

    It can take up to two arguments.

    The first argument is the format of the timestamp; it defaults to
    `flt` for seconds as a decimal number with microsecond accuracy;
    `hms` stands for a formatted `[-]HH:MM:SS.mmm`{.variable} timestamp
    with millisecond accuracy. `gmtime` stands for the timestamp of the
    frame formatted as UTC time; `localtime` stands for the timestamp of
    the frame formatted as local time zone time. If the format is set to
    `hms24hh`, the time is formatted in 24h format (00-23).

    The second argument is an offset added to the timestamp.

    If the format is set to `localtime` or `gmtime`, a third argument
    may be supplied: a `strftime` C function format string. By default,
    `YYYY-MM-DD HH:MM:SS`{.variable} format will be used.

`expr, e`

:   Evaluate the expression's value and output as a double.

    It must take one argument specifying the expression to be evaluated,
    accepting the constants and functions defined in
    [qrencode_expressions](#qrencode_005fexpressions).

`expr_formatted, ef`

:   Evaluate the expression's value and output as a formatted string.

    The first argument is the expression to be evaluated, just as for
    the `expr`{.variable} function. The second argument specifies the
    output format. Allowed values are '`x`{.sample}', '`X`{.sample}',
    '`d`{.sample}' and '`u`{.sample}'. They are treated exactly as in
    the `printf` function. The third parameter is optional and sets the
    number of positions taken by the output. It can be used to add
    padding with zeros from the left.

`gmtime`

:   The time at which the filter is running, expressed in UTC. It can
    accept an argument: a `strftime` C function format string. The
    format string is extended to support the variable
    `%[1-6]N`{.variable} which prints fractions of the second with
    optionally specified number of digits.

`localtime`

:   The time at which the filter is running, expressed in the local time
    zone. It can accept an argument: a `strftime` C function format
    string. The format string is extended to support the variable
    `%[1-6]N`{.variable} which prints fractions of the second with
    optionally specified number of digits.

`metadata`

:   Frame metadata. Takes one or two arguments.

    The first argument is mandatory and specifies the metadata key.

    The second argument is optional and specifies a default value, used
    when the metadata key is not found or empty.

    Available metadata can be identified by inspecting entries starting
    with TAG included within each frame section printed by running
    `ffprobe -show_frames`.

    String metadata generated in filters leading to the qrencode filter
    are also available.

`rand(min, max)`

:   return a random number included between `min`{.variable} and
    `max`{.variable}

[]{#Examples-154}

#### [39.201.3 Examples](#toc-Examples-154) {#examples-154 .subsection}

- Generate a QR code encoding the specified text with the default size,
  overalaid in the top left corner of the input video, with the default
  size:

  ::: example
  ``` example
  qrencode=text=www.ffmpeg.org
  ```
  :::
- Same as below, but select blue on pink colors:

  ::: example
  ``` example
  qrencode=text=www.ffmpeg.org:bc=pink@0.5:fc=blue
  ```
  :::
- Place the QR code in the bottom right corner of the input video:

  ::: example
  ``` example
  qrencode=text=www.ffmpeg.org:x=W-Q:y=H-Q
  ```
  :::
- Generate a QR code with width of 200 pixels and padding, making the
  padded width 4/3 of the QR code width:

  ::: example
  ``` example
  qrencode=text=www.ffmpeg.org:q=200:Q=4/3*q
  ```
  :::
- Generate a QR code with padded width of 200 pixels and padding, making
  the QR code width 3/4 of the padded width:

  ::: example
  ``` example
  qrencode=text=www.ffmpeg.org:Q=200:q=3/4*Q
  ```
  :::
- Make the QR code a fraction of the input video width:

  ::: example
  ``` example
  qrencode=text=www.ffmpeg.org:q=W/5
  ```
  :::
- Generate a QR code encoding the frame number:

  ::: example
  ``` example
  qrencode=text=%{n}
  ```
  :::
- Generate a QR code encoding the GMT timestamp:

  ::: example
  ``` example
  qrencode=text=%{gmtime}
  ```
  :::
- Generate a QR code encoding the timestamp expressed as a float:

  ::: example
  ``` example
  qrencode=text=%{pts}
  ```
  :::

[]{#quirc}

### [39.202 quirc](#toc-quirc) {#quirc .section}

Identify and decode a QR code using the libquirc library (see
<https://github.com/dlbeer/quirc/>), and print the identified QR codes
positions and payload as metadata.

To enable the compilation of this filter, you need to configure FFmpeg
with `--enable-libquirc`.

For each found QR code in the input video, some metadata entries are
added with the prefix `lavfi.quirc.N`{.variable}, where `N`{.variable}
is the index, starting from 0, associated to the QR code.

A description of each metadata value follows:

`lavfi.quirc.count`{.sample}

:   the number of found QR codes, it is not set in case none was found

`lavfi.quirc.N.corner.M.x`{.sample}\
`lavfi.quirc.N.coreer.M.y`{.sample}

:   the x/y positions of the four corners of the square containing the
    QR code, where `M`{.variable} is the index of the corner starting
    from 0

`lavfi.quirc.N.payload`{.sample}

:   the payload of the QR code

[]{#random}

### [39.203 random](#toc-random) {#random .section}

Flush video frames from internal cache of frames into a random order. No
frame is discarded. Inspired by [frei0r](#frei0r) nervous filter.

`frames`{.sample}

:   Set size in number of frames of internal cache, in range from `2` to
    `512`. Default is `30`.

`seed`{.sample}

:   Set seed for random number generator, must be an integer included
    between `0` and `UINT32_MAX`. If not specified, or if explicitly set
    to less than `0`, the filter will try to use a good random seed on a
    best effort basis.

[]{#readeia608}

### [39.204 readeia608](#toc-readeia608) {#readeia608 .section}

Read closed captioning (EIA-608) information from the top lines of a
video frame.

This filter adds frame metadata for `lavfi.readeia608.X.cc` and
`lavfi.readeia608.X.line`, where `X` is the number of the identified
line with EIA-608 data (starting from 0). A description of each metadata
value follows:

`lavfi.readeia608.X.cc`{.sample}

:   The two bytes stored as EIA-608 data (printed in hexadecimal).

`lavfi.readeia608.X.line`{.sample}

:   The number of the line on which the EIA-608 data was identified and
    read.

This filter accepts the following options:

`scan_min`{.sample}

:   Set the line to start scanning for EIA-608 data. Default is `0`.

`scan_max`{.sample}

:   Set the line to end scanning for EIA-608 data. Default is `29`.

`spw`{.sample}

:   Set the ratio of width reserved for sync code detection. Default is
    `0.27`. Allowed range is `[0.1 - 0.7]`.

`chp`{.sample}

:   Enable checking the parity bit. In the event of a parity error, the
    filter will output `0x00` for that character. Default is false.

`lp`{.sample}

:   Lowpass lines prior to further processing. Default is enabled.

[]{#Commands-134}

#### [39.204.1 Commands](#toc-Commands-134) {#commands-134 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#Examples-155}

#### [39.204.2 Examples](#toc-Examples-155) {#examples-155 .subsection}

- Output a csv with presentation time and the first two lines of
  identified EIA-608 captioning data.

  ::: example
  ``` example
  ffprobe -f lavfi -i movie=captioned_video.mov,readeia608 -show_entries frame=pts_time:frame_tags=lavfi.readeia608.0.cc,lavfi.readeia608.1.cc -of csv
  ```
  :::

[]{#readvitc}

### [39.205 readvitc](#toc-readvitc) {#readvitc .section}

Read vertical interval timecode (VITC) information from the top lines of
a video frame.

The filter adds frame metadata key `lavfi.readvitc.tc_str` with the
timecode value, if a valid timecode has been detected. Further metadata
key `lavfi.readvitc.found` is set to 0/1 depending on whether timecode
data has been found or not.

This filter accepts the following options:

`scan_max`{.sample}

:   Set the maximum number of lines to scan for VITC data. If the value
    is set to `-1` the full video frame is scanned. Default is `45`.

`thr_b`{.sample}

:   Set the luma threshold for black. Accepts float numbers in the range
    \[0.0,1.0\], default value is `0.2`. The value must be equal or less
    than `thr_w`.

`thr_w`{.sample}

:   Set the luma threshold for white. Accepts float numbers in the range
    \[0.0,1.0\], default value is `0.6`. The value must be equal or
    greater than `thr_b`.

[]{#Examples-156}

#### [39.205.1 Examples](#toc-Examples-156) {#examples-156 .subsection}

- Detect and draw VITC data onto the video frame; if no valid VITC is
  detected, draw `--:--:--:--` as a placeholder:

  ::: example
  ``` example
  ffmpeg -i input.avi -filter:v 'readvitc,drawtext=fontfile=FreeMono.ttf:text=%{metadata\\:lavfi.readvitc.tc_str\\:--\\\\\\:--\\\\\\:--\\\\\\:--}:x=(w-tw)/2:y=400-ascent'
  ```
  :::

[]{#remap}

### [39.206 remap](#toc-remap) {#remap .section}

Remap pixels using 2nd: Xmap and 3rd: Ymap input video stream.

Destination pixel at position (X, Y) will be picked from source (x, y)
position where x = Xmap(X, Y) and y = Ymap(X, Y). If mapping values are
out of range, zero value for pixel will be used for destination pixel.

Xmap and Ymap input video streams must be of same dimensions. Output
video stream will have Xmap/Ymap video stream dimensions. Xmap and Ymap
input video streams are 16bit depth, single channel.

`format`{.sample}

:   Specify pixel format of output from this filter. Can be `color` or
    `gray`. Default is `color`.

`fill`{.sample}

:   Specify the color of the unmapped pixels. For the syntax of this
    option, check the [(ffmpeg-utils)\"Color\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#color-syntax). Default color
    is `black`.

[]{#removegrain}

### [39.207 removegrain](#toc-removegrain) {#removegrain .section}

The removegrain filter is a spatial denoiser for progressive video.

`m0`{.sample}

:   Set mode for the first plane.

`m1`{.sample}

:   Set mode for the second plane.

`m2`{.sample}

:   Set mode for the third plane.

`m3`{.sample}

:   Set mode for the fourth plane.

Range of mode is from 0 to 24. Description of each mode follows:

`0`{.variable}

:   Leave input plane unchanged. Default.

`1`{.variable}

:   Clips the pixel with the minimum and maximum of the 8 neighbour
    pixels.

`2`{.variable}

:   Clips the pixel with the second minimum and maximum of the 8
    neighbour pixels.

`3`{.variable}

:   Clips the pixel with the third minimum and maximum of the 8
    neighbour pixels.

`4`{.variable}

:   Clips the pixel with the fourth minimum and maximum of the 8
    neighbour pixels. This is equivalent to a median filter.

`5`{.variable}

:   Line-sensitive clipping giving the minimal change.

`6`{.variable}

:   Line-sensitive clipping, intermediate.

`7`{.variable}

:   Line-sensitive clipping, intermediate.

`8`{.variable}

:   Line-sensitive clipping, intermediate.

`9`{.variable}

:   Line-sensitive clipping on a line where the neighbours pixels are
    the closest.

`10`{.variable}

:   Replaces the target pixel with the closest neighbour.

`11`{.variable}

:   \[1 2 1\] horizontal and vertical kernel blur.

`12`{.variable}

:   Same as mode 11.

`13`{.variable}

:   Bob mode, interpolates top field from the line where the neighbours
    pixels are the closest.

`14`{.variable}

:   Bob mode, interpolates bottom field from the line where the
    neighbours pixels are the closest.

`15`{.variable}

:   Bob mode, interpolates top field. Same as 13 but with a more
    complicated interpolation formula.

`16`{.variable}

:   Bob mode, interpolates bottom field. Same as 14 but with a more
    complicated interpolation formula.

`17`{.variable}

:   Clips the pixel with the minimum and maximum of respectively the
    maximum and minimum of each pair of opposite neighbour pixels.

`18`{.variable}

:   Line-sensitive clipping using opposite neighbours whose greatest
    distance from the current pixel is minimal.

`19`{.variable}

:   Replaces the pixel with the average of its 8 neighbours.

`20`{.variable}

:   Averages the 9 pixels (\[1 1 1\] horizontal and vertical blur).

`21`{.variable}

:   Clips pixels using the averages of opposite neighbour.

`22`{.variable}

:   Same as mode 21 but simpler and faster.

`23`{.variable}

:   Small edge and halo removal, but reputed useless.

`24`{.variable}

:   Similar as 23.

[]{#removelogo}

### [39.208 removelogo](#toc-removelogo) {#removelogo .section}

Suppress a TV station logo, using an image file to determine which
pixels comprise the logo. It works by filling in the pixels that
comprise the logo with neighboring pixels.

The filter accepts the following options:

`filename, f`{.sample}

:   Set the filter bitmap file, which can be any image format supported
    by libavformat. The width and height of the image file must match
    those of the video stream being processed.

Pixels in the provided bitmap image with a value of zero are not
considered part of the logo, non-zero pixels are considered part of the
logo. If you use white (255) for the logo and black (0) for the rest,
you will be safe. For making the filter bitmap, it is recommended to
take a screen capture of a black frame with the logo visible, and then
using a threshold filter followed by the erode filter once or twice.

If needed, little splotches can be fixed manually. Remember that if logo
pixels are not covered, the filter quality will be much reduced. Marking
too many pixels as part of the logo does not hurt as much, but it will
increase the amount of blurring needed to cover over the image and will
destroy more information than necessary, and extra pixels will slow
things down on a large logo.

[]{#repeatfields}

### [39.209 repeatfields](#toc-repeatfields) {#repeatfields .section}

This filter uses the repeat_field flag from the Video ES headers and
hard repeats fields based on its value.

[]{#reverse}

### [39.210 reverse](#toc-reverse) {#reverse .section}

Reverse a video clip.

Warning: This filter requires memory to buffer the entire clip, so
trimming is suggested.

[]{#Examples-157}

#### [39.210.1 Examples](#toc-Examples-157) {#examples-157 .subsection}

- Take the first 5 seconds of a clip, and reverse it.

  ::: example
  ``` example
  trim=end=5,reverse
  ```
  :::

[]{#rgbashift}

### [39.211 rgbashift](#toc-rgbashift) {#rgbashift .section}

Shift R/G/B/A pixels horizontally and/or vertically.

The filter accepts the following options:

`rh`{.sample}

:   Set amount to shift red horizontally.

`rv`{.sample}

:   Set amount to shift red vertically.

`gh`{.sample}

:   Set amount to shift green horizontally.

`gv`{.sample}

:   Set amount to shift green vertically.

`bh`{.sample}

:   Set amount to shift blue horizontally.

`bv`{.sample}

:   Set amount to shift blue vertically.

`ah`{.sample}

:   Set amount to shift alpha horizontally.

`av`{.sample}

:   Set amount to shift alpha vertically.

`edge`{.sample}

:   Set edge mode, can be `smear`{.variable}, default, or
    `warp`{.variable}.

[]{#Commands-135}

#### [39.211.1 Commands](#toc-Commands-135) {#commands-135 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#roberts}

### [39.212 roberts](#toc-roberts) {#roberts .section}

Apply roberts cross operator to input video stream.

The filter accepts the following option:

`planes`{.sample}

:   Set which planes will be processed, unprocessed planes will be
    copied. By default value 0xf, all planes will be processed.

`scale`{.sample}

:   Set value which will be multiplied with filtered result.

`delta`{.sample}

:   Set value which will be added to filtered result.

[]{#Commands-136}

#### [39.212.1 Commands](#toc-Commands-136) {#commands-136 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#rotate}

### [39.213 rotate](#toc-rotate) {#rotate .section}

Rotate video by an arbitrary angle expressed in radians.

The filter accepts the following options:

A description of the optional parameters follows.

`angle, a`{.sample}

:   Set an expression for the angle by which to rotate the input video
    clockwise, expressed as a number of radians. A negative value will
    result in a counter-clockwise rotation. By default it is set to
    \"0\".

    This expression is evaluated for each frame.

`out_w, ow`{.sample}

:   Set the output width expression, default value is \"iw\". This
    expression is evaluated just once during configuration.

`out_h, oh`{.sample}

:   Set the output height expression, default value is \"ih\". This
    expression is evaluated just once during configuration.

`bilinear`{.sample}

:   Enable bilinear interpolation if set to 1, a value of 0 disables it.
    Default value is 1.

`fillcolor, c`{.sample}

:   Set the color used to fill the output area not covered by the
    rotated image. For the general syntax of this option, check the
    [(ffmpeg-utils)\"Color\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#color-syntax). If the special value
    \"none\" is selected then no background is printed (useful for
    example if the background is never shown).

    Default value is \"black\".

The expressions for the angle and the output size can contain the
following constants and functions:

`n`{.sample}

:   sequential number of the input frame, starting from 0. It is always
    NAN before the first frame is filtered.

`t`{.sample}

:   time in seconds of the input frame, it is set to 0 when the filter
    is configured. It is always NAN before the first frame is filtered.

`hsub`{.sample}\
`vsub`{.sample}

:   horizontal and vertical chroma subsample values. For example for the
    pixel format \"yuv422p\" `hsub`{.variable} is 2 and
    `vsub`{.variable} is 1.

`in_w, iw`{.sample}\
`in_h, ih`{.sample}

:   the input video width and height

`out_w, ow`{.sample}\
`out_h, oh`{.sample}

:   the output width and height, that is the size of the padded area as
    specified by the `width`{.variable} and `height`{.variable}
    expressions

`rotw(a)`{.sample}\
`roth(a)`{.sample}

:   the minimal width/height required for completely containing the
    input video rotated by `a`{.variable} radians.

    These are only available when computing the `out_w`{.sample} and
    `out_h`{.sample} expressions.

[]{#Examples-158}

#### [39.213.1 Examples](#toc-Examples-158) {#examples-158 .subsection}

- Rotate the input by PI/6 radians clockwise:

  ::: example
  ``` example
  rotate=PI/6
  ```
  :::
- Rotate the input by PI/6 radians counter-clockwise:

  ::: example
  ``` example
  rotate=-PI/6
  ```
  :::
- Rotate the input by 45 degrees clockwise:

  ::: example
  ``` example
  rotate=45*PI/180
  ```
  :::
- Apply a constant rotation with period T, starting from an angle of
  PI/3:

  ::: example
  ``` example
  rotate=PI/3+2*PI*t/T
  ```
  :::
- Make the input video rotation oscillating with a period of T seconds
  and an amplitude of A radians:

  ::: example
  ``` example
  rotate=A*sin(2*PI/T*t)
  ```
  :::
- Rotate the video, output size is chosen so that the whole rotating
  input video is always completely contained in the output:

  ::: example
  ``` example
  rotate='2*PI*t:ow=hypot(iw,ih):oh=ow'
  ```
  :::
- Rotate the video, reduce the output size so that no background is ever
  shown:

  ::: example
  ``` example
  rotate=2*PI*t:ow='min(iw,ih)/sqrt(2)':oh=ow:c=none
  ```
  :::

[]{#Commands-137}

#### [39.213.2 Commands](#toc-Commands-137) {#commands-137 .subsection}

The filter supports the following commands:

`a, angle`{.sample}

:   Set the angle expression. The command accepts the same syntax of the
    corresponding option.

    If the specified expression is not valid, it is kept at its current
    value.

[]{#sab}

### [39.214 sab](#toc-sab) {#sab .section}

Apply Shape Adaptive Blur.

The filter accepts the following options:

`luma_radius, lr`{.sample}

:   Set luma blur filter strength, must be a value in range 0.1-4.0,
    default value is 1.0. A greater value will result in a more blurred
    image, and in slower processing.

`luma_pre_filter_radius, lpfr`{.sample}

:   Set luma pre-filter radius, must be a value in the 0.1-2.0 range,
    default value is 1.0.

`luma_strength, ls`{.sample}

:   Set luma maximum difference between pixels to still be considered,
    must be a value in the 0.1-100.0 range, default value is 1.0.

`chroma_radius, cr`{.sample}

:   Set chroma blur filter strength, must be a value in range -0.9-4.0.
    A greater value will result in a more blurred image, and in slower
    processing.

`chroma_pre_filter_radius, cpfr`{.sample}

:   Set chroma pre-filter radius, must be a value in the -0.9-2.0 range.

`chroma_strength, cs`{.sample}

:   Set chroma maximum difference between pixels to still be considered,
    must be a value in the -0.9-100.0 range.

Each chroma option value, if not explicitly specified, is set to the
corresponding luma option value.

[]{#scale}[]{#scale-1}

### [39.215 scale](#toc-scale-1) {#scale .section}

Scale (resize) the input video, using the libswscale library.

The scale filter forces the output display aspect ratio to be the same
of the input, by changing the output sample aspect ratio.

If the input image format is different from the format requested by the
next filter, the scale filter will convert the input to the requested
format.

[]{#Options-122}

#### [39.215.1 Options](#toc-Options-122) {#options-122 .subsection}

The filter accepts the following options, any of the options supported
by the libswscale scaler, as well as any of the [framesync](#framesync)
options.

See [(ffmpeg-scaler)the ffmpeg-scaler
manual](ffmpeg-scaler.html#scaler_005foptions) for the complete list of
scaler options.

`width, w`{.sample}

`height, h`{.sample}

Set the output video dimension expression. Default value is the input
dimension.

If the `width`{.variable} or `w`{.variable} value is 0, the input width
is used for the output. If the `height`{.variable} or `h`{.variable}
value is 0, the input height is used for the output.

If one and only one of the values is -n with n \>= 1, the scale filter
will use a value that maintains the aspect ratio of the input image,
calculated from the other specified dimension. After that it will,
however, make sure that the calculated dimension is divisible by n and
adjust the value if necessary.

If both values are -n with n \>= 1, the behavior will be identical to
both values being set to 0 as previously detailed.

See below for the list of accepted constants for use in the dimension
expression.

`eval`{.sample}

Specify when to evaluate `width`{.variable} and `height`{.variable}
expression. It accepts the following values:

'`init`{.sample}'

:   Only evaluate expressions once during the filter initialization or
    when a command is processed.

'`frame`{.sample}'

:   Evaluate expressions for each incoming frame.

Default value is '`init`{.sample}'.

`interl`{.sample}

Set the interlacing mode. It accepts the following values:

'`1`{.sample}'

:   Force interlaced aware scaling.

'`0`{.sample}'

:   Do not apply interlaced scaling.

'`-1`{.sample}'

:   Select interlaced aware scaling depending on whether the source
    frames are flagged as interlaced or not.

Default value is '`0`{.sample}'.

`flags`{.sample}

Set libswscale scaling flags. See [(ffmpeg-scaler)the ffmpeg-scaler
manual](ffmpeg-scaler.html#sws_005fflags) for the complete list of
values. If not explicitly specified the filter applies the default
flags.

`param0, param1`{.sample}

Set libswscale input parameters for scaling algorithms that need them.
See [(ffmpeg-scaler)the ffmpeg-scaler
manual](ffmpeg-scaler.html#sws_005fparams) for the complete
documentation. If not explicitly specified the filter applies empty
parameters.

`intent`{.sample}

Set the ICC rendering intent to use when transforming between different
color spaces. It accepts the following values:

'`perceptual`{.sample}'

:   Use a perceptually guided tone and gamut mapping curve. The exact
    details of the mapping used may change at any time and should not be
    relied on as stable. This intent is recommended for final viewing of
    image/video content in typical viewing settings.

'`relative_colorimetric`{.sample}'

:   Statically clip out-of-gamut colors using a colorimetric clipping
    curve which attempts to find the colorimetrically least dissimilar
    in-gamut color. This intent performs white point adaptation and
    black point adaptation. This is the default. This intent is
    recommended wherever faithful color reproduction is of the utmost
    importance, even at the cost of clipping.

'`absolute_colorimetric`{.sample}'

:   Hard clip out-of-gamut colors with no attempt at white or black
    point reproduction. This intent will reproduce in-gamut colors 1:1
    on the output display as they would appear on the reference display,
    assuming the output display is appropriately calibrated.

'`saturation`{.sample}'

:   Performs saturation mapping - that is, stretches the input color
    volume directly onto the output color volume, in non-linear fashion
    that preserves the original signal appearance as much as possible.
    This intent is recommended for signal content evaluation, as it will
    not lead to any clipping. It is roughly analogous to not performing
    any color mapping, although it still takes into account the
    mastering display primaries and any differences in encoding TRC.

`size, s`{.sample}

Set the video size. For the syntax of this option, check the
[(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
manual](ffmpeg-utils.html#video-size-syntax).

`in_color_matrix`{.sample}

`out_color_matrix`{.sample}

Set in/output YCbCr color space type.

This allows the autodetected value to be overridden as well as allows
forcing a specific value used for the output and encoder.

If not specified, the color space type depends on the pixel format.

Possible values:

'`auto`{.sample}'

:   Choose automatically.

'`bt709`{.sample}'

:   Format conforming to International Telecommunication Union (ITU)
    Recommendation BT.709.

'`fcc`{.sample}'

:   Set color space conforming to the United States Federal
    Communications Commission (FCC) Code of Federal Regulations (CFR)
    Title 47 (2003) 73.682 (a).

'`bt601`{.sample}'\
'`bt470`{.sample}'\
'`smpte170m`{.sample}'

:   Set color space conforming to:

    - ITU Radiocommunication Sector (ITU-R) Recommendation BT.601
    - ITU-R Rec. BT.470-6 (1998) Systems B, B1, and G
    - Society of Motion Picture and Television Engineers (SMPTE) ST
      170:2004

'`smpte240m`{.sample}'

:   Set color space conforming to SMPTE ST 240:1999.

'`bt2020`{.sample}'

:   Set color space conforming to ITU-R BT.2020 non-constant luminance
    system.

`in_range`{.sample}

`out_range`{.sample}

Set in/output YCbCr sample range.

This allows the autodetected value to be overridden as well as allows
forcing a specific value used for the output and encoder. If not
specified, the range depends on the pixel format. Possible values:

'`auto/unknown`{.sample}'

:   Choose automatically.

'`jpeg/full/pc`{.sample}'

:   Set full range (0-255 in case of 8-bit luma).

'`mpeg/limited/tv`{.sample}'

:   Set \"MPEG\" range (16-235 in case of 8-bit luma).

`in_chroma_loc`{.sample}

`out_chroma_loc`{.sample}

Set in/output chroma sample location. If not specified, center-sited
chroma is used by default. Possible values:

'`auto, unknown`{.sample}'

'`left`{.sample}'

'`center`{.sample}'

'`topleft`{.sample}'

'`top`{.sample}'

'`bottomleft`{.sample}'

'`bottom`{.sample}'

`in_primaries`{.sample}

`out_primaries`{.sample}

Set in/output RGB primaries.

This allows the autodetected value to be overridden as well as allows
forcing a specific value used for the output and encoder. Possible
values:

'`auto`{.sample}'

Choose automatically. This is the default.

'`bt709`{.sample}'

'`bt470m`{.sample}'

'`bt470bg`{.sample}'

'`smpte170m`{.sample}'

'`smpte240m`{.sample}'

'`film`{.sample}'

'`bt2020`{.sample}'

'`smpte428`{.sample}'

'`smpte431`{.sample}'

'`smpte432`{.sample}'

'`jedec-p22`{.sample}'

'`ebu3213`{.sample}'

`in_transfer`{.sample}

`out_transfer`{.sample}

Set in/output transfer response curve (TRC).

This allows the autodetected value to be overridden as well as allows
forcing a specific value used for the output and encoder. Possible
values:

'`auto`{.sample}'

Choose automatically. This is the default.

'`bt709`{.sample}'

'`bt470m`{.sample}'

'`gamma22`{.sample}'

'`bt470bg`{.sample}'

'`gamma28`{.sample}'

'`smpte170m`{.sample}'

'`smpte240m`{.sample}'

'`linear`{.sample}'

'`iec61966-2-1`{.sample}'

'`srgb`{.sample}'

'`iec61966-2-4`{.sample}'

'`xvycc`{.sample}'

'`bt1361e`{.sample}'

'`bt2020-10`{.sample}'

'`bt2020-12`{.sample}'

'`smpte2084`{.sample}'

'`smpte428`{.sample}'

'`arib-std-b67`{.sample}'

`force_original_aspect_ratio`{.sample}

Enable decreasing or increasing output video width or height if
necessary to keep the original aspect ratio. Possible values:

'`disable`{.sample}'

:   Scale the video as specified and disable this feature.

'`decrease`{.sample}'

:   The output video dimensions will automatically be decreased if
    needed.

'`increase`{.sample}'

:   The output video dimensions will automatically be increased if
    needed.

One useful instance of this option is that when you know a specific
device's maximum allowed resolution, you can use this to limit the
output video to that, while retaining the aspect ratio. For example,
device A allows 1280x720 playback, and your video is 1920x800. Using
this option (set it to decrease) and specifying 1280x720 to the command
line makes the output 1280x533.

Please note that this is a different thing than specifying -1 for
`w`{.sample} or `h`{.sample}, you still need to specify the output
resolution for this option to work.

`force_divisible_by`{.sample}

Ensures that both the output dimensions, width and height, are divisible
by the given integer when used together with
`force_original_aspect_ratio`{.sample}. This works similar to using `-n`
in the `w`{.sample} and `h`{.sample} options.

This option respects the value set for
`force_original_aspect_ratio`{.sample}, increasing or decreasing the
resolution accordingly. The video's aspect ratio may be slightly
modified.

This option can be handy if you need to have a video fit within or
exceed a defined resolution using `force_original_aspect_ratio`{.sample}
but also have encoder restrictions on width or height divisibility.

`reset_sar`{.sample}

Enabling this option leads to the output SAR being reset to 1.
Additionally, if the user requests proportional scaling either through
the width or height expressions, e.g. `w=-4:h=360` or `w=iw/2:h=-1` or
by enabling `force_original_aspect_ratio`, then the input DAR is taken
into account and the output is scaled to produce square pixels. Default
is false.

The values of the `w`{.sample} and `h`{.sample} options are expressions
containing the following constants:

`in_w`{.variable}\
`in_h`{.variable}

:   The input width and height

`iw`{.variable}\
`ih`{.variable}

:   These are the same as `in_w`{.variable} and `in_h`{.variable}.

`out_w`{.variable}\
`out_h`{.variable}

:   The output (scaled) width and height

`ow`{.variable}\
`oh`{.variable}

:   These are the same as `out_w`{.variable} and `out_h`{.variable}

`a`{.variable}

:   The same as `iw`{.variable} / `ih`{.variable}

`sar`{.variable}

:   input sample aspect ratio

`dar`{.variable}

:   The input display aspect ratio. Calculated from `(iw / ih) * sar`.

`hsub`{.variable}\
`vsub`{.variable}

:   horizontal and vertical input chroma subsample values. For example
    for the pixel format \"yuv422p\" `hsub`{.variable} is 2 and
    `vsub`{.variable} is 1.

`ohsub`{.variable}\
`ovsub`{.variable}

:   horizontal and vertical output chroma subsample values. For example
    for the pixel format \"yuv422p\" `hsub`{.variable} is 2 and
    `vsub`{.variable} is 1.

`n`{.variable}

:   The (sequential) number of the input frame, starting from 0. Only
    available with `eval=frame`.

`t`{.variable}

:   The presentation timestamp of the input frame, expressed as a number
    of seconds. Only available with `eval=frame`.

`pos`{.variable}

:   The position (byte offset) of the frame in the input stream, or NaN
    if this information is unavailable and/or meaningless (for example
    in case of synthetic video). Only available with `eval=frame`.
    Deprecated, do not use.

`ref_w, rw`{.variable}\
`ref_h, rh`{.variable}\
`ref_a`{.variable}\
`ref_dar, rdar`{.variable}\
`ref_n`{.variable}\
`ref_t`{.variable}\
`ref_pos`{.variable}

:   Eqvuialent to the above, but for a second reference input. If any of
    these variables are present, this filter accepts two inputs.

[]{#Examples-159}

#### [39.215.2 Examples](#toc-Examples-159) {#examples-159 .subsection}

- Scale the input video to a size of 200x100

  ::: example
  ``` example
  scale=w=200:h=100
  ```
  :::

  This is equivalent to:

  ::: example
  ``` example
  scale=200:100
  ```
  :::

  or:

  ::: example
  ``` example
  scale=200x100
  ```
  :::

- Specify a size abbreviation for the output size:

  ::: example
  ``` example
  scale=qcif
  ```
  :::

  which can also be written as:

  ::: example
  ``` example
  scale=size=qcif
  ```
  :::

- Scale the input to 2x:

  ::: example
  ``` example
  scale=w=2*iw:h=2*ih
  ```
  :::

- The above is the same as:

  ::: example
  ``` example
  scale=2*in_w:2*in_h
  ```
  :::

- Scale the input to 2x with forced interlaced scaling:

  ::: example
  ``` example
  scale=2*iw:2*ih:interl=1
  ```
  :::

- Scale the input to half size:

  ::: example
  ``` example
  scale=w=iw/2:h=ih/2
  ```
  :::

- Increase the width, and set the height to the same size:

  ::: example
  ``` example
  scale=3/2*iw:ow
  ```
  :::

- Seek Greek harmony:

  ::: example
  ``` example
  scale=iw:1/PHI*iw
  scale=ih*PHI:ih
  ```
  :::

- Increase the height, and set the width to 3/2 of the height:

  ::: example
  ``` example
  scale=w=3/2*oh:h=3/5*ih
  ```
  :::

- Increase the size, making the size a multiple of the chroma subsample
  values:

  ::: example
  ``` example
  scale="trunc(3/2*iw/hsub)*hsub:trunc(3/2*ih/vsub)*vsub"
  ```
  :::

- Increase the width to a maximum of 500 pixels, keeping the same aspect
  ratio as the input:

  ::: example
  ``` example
  scale=w='min(500\, iw*3/2):h=-1'
  ```
  :::

- Make pixels square by combining scale and setsar:

  ::: example
  ``` example
  scale='trunc(ih*dar):ih',setsar=1/1
  ```
  :::

- Make pixels square using reset_sar, making sure the resulting
  resolution is even (required by some codecs):

  ::: example
  ``` example
  scale='-2:ih-mod(ih,2):reset_sar=1'
  ```
  :::

- Scale to target exactly, however reset SAR to 1:

  ::: example
  ``` example
  scale='400:300:reset_sar=1'
  ```
  :::

- Scale to even dimensions that fit within 400x300, preserving input
  SAR:

  ::: example
  ``` example
  scale='400:300:force_original_aspect_ratio=decrease:force_divisible_by=2'
  ```
  :::

- Scale to produce square pixels with even dimensions that fit within
  400x300:

  ::: example
  ``` example
  scale='400:300:force_original_aspect_ratio=decrease:force_divisible_by=2:reset_sar=1'
  ```
  :::

- Scale a subtitle stream (sub) to match the main video (main) in size
  before overlaying. (\"scale2ref\")

  ::: example
  ``` example
  '[main]split[a][b]; [ref][a]scale=rw:rh[c]; [b][c]overlay'
  ```
  :::

- Scale a logo to 1/10th the height of a video, while preserving its
  display aspect ratio.

  ::: example
  ``` example
  [logo-in][video-in]scale=w=oh*dar:h=rh/10[logo-out]
  ```
  :::

[]{#Commands-138}

#### [39.215.3 Commands](#toc-Commands-138) {#commands-138 .subsection}

This filter supports the following commands:

`width, w`{.sample}\
`height, h`{.sample}

:   Set the output video dimension expression. The command accepts the
    same syntax of the corresponding option.

    If the specified expression is not valid, it is kept at its current
    value.

[]{#scharr}

### [39.216 scharr](#toc-scharr) {#scharr .section}

Apply scharr operator to input video stream.

The filter accepts the following option:

`planes`{.sample}

:   Set which planes will be processed, unprocessed planes will be
    copied. By default value 0xf, all planes will be processed.

`scale`{.sample}

:   Set value which will be multiplied with filtered result.

`delta`{.sample}

:   Set value which will be added to filtered result.

[]{#Commands-139}

#### [39.216.1 Commands](#toc-Commands-139) {#commands-139 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#scroll}

### [39.217 scroll](#toc-scroll) {#scroll .section}

Scroll input video horizontally and/or vertically by constant speed.

The filter accepts the following options:

`horizontal, h`{.sample}

:   Set the horizontal scrolling speed. Default is 0. Allowed range is
    from -1 to 1. Negative values changes scrolling direction.

`vertical, v`{.sample}

:   Set the vertical scrolling speed. Default is 0. Allowed range is
    from -1 to 1. Negative values changes scrolling direction.

`hpos`{.sample}

:   Set the initial horizontal scrolling position. Default is 0. Allowed
    range is from 0 to 1.

`vpos`{.sample}

:   Set the initial vertical scrolling position. Default is 0. Allowed
    range is from 0 to 1.

[]{#Commands-140}

#### [39.217.1 Commands](#toc-Commands-140) {#commands-140 .subsection}

This filter supports the following [commands](#commands):

`horizontal, h`{.sample}

:   Set the horizontal scrolling speed.

`vertical, v`{.sample}

:   Set the vertical scrolling speed.

[]{#scdet}[]{#scdet-1}

### [39.218 scdet](#toc-scdet-1) {#scdet .section}

Detect video scene change.

This filter sets frame metadata with mafd between frame, the scene
score, and forward the frame to the next filter, so they can use these
metadata to detect scene change or others.

In addition, this filter logs a message and sets frame metadata when it
detects a scene change by `threshold`{.sample}.

`lavfi.scd.mafd` metadata keys are set with mafd for every frame.

`lavfi.scd.score` metadata keys are set with scene change score for
every frame to detect scene change.

`lavfi.scd.time` metadata keys are set with current filtered frame time
which detect scene change with `threshold`{.sample}.

The filter accepts the following options:

`threshold, t`{.sample}

:   Set the scene change detection threshold as a percentage of maximum
    change. Good values are in the `[8.0, 14.0]` range. The range for
    `threshold`{.sample} is `[0., 100.]`.

    Default value is `10.`.

`sc_pass, s`{.sample}

:   Set the flag to pass scene change frames to the next filter. Default
    value is `0` You can enable it if you want to get snapshot of scene
    change frames only.

[]{#selectivecolor}[]{#selectivecolor-1}

### [39.219 selectivecolor](#toc-selectivecolor-1) {#selectivecolor .section}

Adjust cyan, magenta, yellow and black (CMYK) to certain ranges of
colors (such as \"reds\", \"yellows\", \"greens\", \"cyans\", \...). The
adjustment range is defined by the \"purity\" of the color (that is, how
saturated it already is).

This filter is similar to the Adobe Photoshop Selective Color tool.

The filter accepts the following options:

`correction_method`{.sample}

:   Select color correction method.

    Available values are:

    '`absolute`{.sample}'

    :   Specified adjustments are applied \"as-is\" (added/subtracted to
        original pixel component value).

    '`relative`{.sample}'

    :   Specified adjustments are relative to the original component
        value.

    Default is `absolute`.

`reds`{.sample}

:   Adjustments for red pixels (pixels where the red component is the
    maximum)

`yellows`{.sample}

:   Adjustments for yellow pixels (pixels where the blue component is
    the minimum)

`greens`{.sample}

:   Adjustments for green pixels (pixels where the green component is
    the maximum)

`cyans`{.sample}

:   Adjustments for cyan pixels (pixels where the red component is the
    minimum)

`blues`{.sample}

:   Adjustments for blue pixels (pixels where the blue component is the
    maximum)

`magentas`{.sample}

:   Adjustments for magenta pixels (pixels where the green component is
    the minimum)

`whites`{.sample}

:   Adjustments for white pixels (pixels where all components are
    greater than 128)

`neutrals`{.sample}

:   Adjustments for all pixels except pure black and pure white

`blacks`{.sample}

:   Adjustments for black pixels (pixels where all components are lesser
    than 128)

`psfile`{.sample}

:   Specify a Photoshop selective color file (`.asv`) to import the
    settings from.

All the adjustment settings (`reds`{.sample}, `yellows`{.sample}, \...)
accept up to 4 space separated floating point adjustment values in the
\[-1,1\] range, respectively to adjust the amount of cyan, magenta,
yellow and black for the pixels of its range.

[]{#Examples-160}

#### [39.219.1 Examples](#toc-Examples-160) {#examples-160 .subsection}

- Increase cyan by 50% and reduce yellow by 33% in every green areas,
  and increase magenta by 27% in blue areas:

  ::: example
  ``` example
  selectivecolor=greens=.5 0 -.33 0:blues=0 .27
  ```
  :::
- Use a Photoshop selective color preset:

  ::: example
  ``` example
  selectivecolor=psfile=MySelectiveColorPresets/Misty.asv
  ```
  :::

[]{#separatefields}[]{#separatefields-1}

### [39.220 separatefields](#toc-separatefields-1) {#separatefields .section}

The `separatefields` takes a frame-based video input and splits each
frame into its components fields, producing a new half height clip with
twice the frame rate and twice the frame count.

This filter use field-dominance information in frame to decide which of
each pair of fields to place first in the output. If it gets it wrong
use [setfield](#setfield) filter before `separatefields` filter.

[]{#setdar_002c-setsar}

### [39.221 setdar, setsar](#toc-setdar_002c-setsar) {#setdar-setsar .section}

The `setdar` filter sets the Display Aspect Ratio for the filter output
video.

This is done by changing the specified Sample (aka Pixel) Aspect Ratio,
according to the following equation:

::: example
``` example
DAR = HORIZONTAL_RESOLUTION / VERTICAL_RESOLUTION * SAR
```
:::

Keep in mind that the `setdar` filter does not modify the pixel
dimensions of the video frame. Also, the display aspect ratio set by
this filter may be changed by later filters in the filterchain, e.g. in
case of scaling or if another \"setdar\" or a \"setsar\" filter is
applied.

The `setsar` filter sets the Sample (aka Pixel) Aspect Ratio for the
filter output video.

Note that as a consequence of the application of this filter, the output
display aspect ratio will change according to the equation above.

Keep in mind that the sample aspect ratio set by the `setsar` filter may
be changed by later filters in the filterchain, e.g. if another
\"setsar\" or a \"setdar\" filter is applied.

It accepts the following parameters:

`r, ratio, dar (`{.sample}`setdar`` only), sar (`{.sample}`setsar`` only)`{.sample}

:   Set the aspect ratio used by the filter.

    The parameter can be a floating point number string, or an
    expression. If the parameter is not specified, the value \"0\" is
    assumed, meaning that the same input value is used.

`max`{.sample}

:   Set the maximum integer value to use for expressing numerator and
    denominator when reducing the expressed aspect ratio to a rational.
    Default value is `100`.

The parameter `sar`{.variable} is an expression containing the following
constants:

`w, h`{.sample}

:   The input width and height.

`a`{.sample}

:   Same as `w`{.variable} / `h`{.variable}.

`sar`{.sample}

:   The input sample aspect ratio.

`dar`{.sample}

:   The input display aspect ratio. It is the same as (`w`{.variable} /
    `h`{.variable}) \* `sar`{.variable}.

`hsub, vsub`{.sample}

:   Horizontal and vertical chroma subsample values. For example, for
    the pixel format \"yuv422p\" `hsub`{.variable} is 2 and
    `vsub`{.variable} is 1.

[]{#Examples-161}

#### [39.221.1 Examples](#toc-Examples-161) {#examples-161 .subsection}

- To change the display aspect ratio to 16:9, specify one of the
  following:

  ::: example
  ``` example
  setdar=dar=1.77777
  setdar=dar=16/9
  ```
  :::
- To change the sample aspect ratio to 10:11, specify:

  ::: example
  ``` example
  setsar=sar=10/11
  ```
  :::
- To set a display aspect ratio of 16:9, and specify a maximum integer
  value of 1000 in the aspect ratio reduction, use the command:

  ::: example
  ``` example
  setdar=ratio=16/9:max=1000
  ```
  :::

[]{#setfield}[]{#setfield-1}

### [39.222 setfield](#toc-setfield-1) {#setfield .section}

Force field for the output video frame.

The `setfield` filter marks the interlace type field for the output
frames. It does not change the input frame, but only sets the
corresponding property, which affects how the frame is treated by
following filters (e.g. `fieldorder` or `yadif`).

The filter accepts the following options:

`mode`{.sample}

:   Available values are:

    '`auto`{.sample}'

    :   Keep the same field property.

    '`bff`{.sample}'

    :   Mark the frame as bottom-field-first.

    '`tff`{.sample}'

    :   Mark the frame as top-field-first.

    '`prog`{.sample}'

    :   Mark the frame as progressive.

[]{#setparams}[]{#setparams-1}

### [39.223 setparams](#toc-setparams-1) {#setparams .section}

Force frame parameter for the output video frame.

The `setparams` filter marks interlace and color range for the output
frames. It does not change the input frame, but only sets the
corresponding property, which affects how the frame is treated by
filters/encoders.

`field_mode`{.sample}

Available values are:

'`auto`{.sample}'

:   Keep the same field property (default).

'`bff`{.sample}'

:   Mark the frame as bottom-field-first.

'`tff`{.sample}'

:   Mark the frame as top-field-first.

'`prog`{.sample}'

:   Mark the frame as progressive.

`range`{.sample}

Available values are:

'`auto`{.sample}'

:   Keep the same color range property (default).

'`unspecified, unknown`{.sample}'

:   Mark the frame as unspecified color range.

'`limited, tv, mpeg`{.sample}'

:   Mark the frame as limited range.

'`full, pc, jpeg`{.sample}'

:   Mark the frame as full range.

`color_primaries`{.sample}

Set the color primaries. Available values are:

'`auto`{.sample}'

Keep the same color primaries property (default).

'`bt709`{.sample}'

'`unknown`{.sample}'

'`bt470m`{.sample}'

'`bt470bg`{.sample}'

'`smpte170m`{.sample}'

'`smpte240m`{.sample}'

'`film`{.sample}'

'`bt2020`{.sample}'

'`smpte428`{.sample}'

'`smpte431`{.sample}'

'`smpte432`{.sample}'

'`jedec-p22`{.sample}'

`color_trc`{.sample}

Set the color transfer. Available values are:

'`auto`{.sample}'

Keep the same color trc property (default).

'`bt709`{.sample}'

'`unknown`{.sample}'

'`bt470m`{.sample}'

'`bt470bg`{.sample}'

'`smpte170m`{.sample}'

'`smpte240m`{.sample}'

'`linear`{.sample}'

'`log100`{.sample}'

'`log316`{.sample}'

'`iec61966-2-4`{.sample}'

'`bt1361e`{.sample}'

'`iec61966-2-1`{.sample}'

'`bt2020-10`{.sample}'

'`bt2020-12`{.sample}'

'`smpte2084`{.sample}'

'`smpte428`{.sample}'

'`arib-std-b67`{.sample}'

`colorspace`{.sample}

Set the colorspace. Available values are:

'`auto`{.sample}'

Keep the same colorspace property (default).

'`gbr`{.sample}'

'`bt709`{.sample}'

'`unknown`{.sample}'

'`fcc`{.sample}'

'`bt470bg`{.sample}'

'`smpte170m`{.sample}'

'`smpte240m`{.sample}'

'`ycgco`{.sample}'

'`bt2020nc`{.sample}'

'`bt2020c`{.sample}'

'`smpte2085`{.sample}'

'`chroma-derived-nc`{.sample}'

'`chroma-derived-c`{.sample}'

'`ictcp`{.sample}'

`chroma_location`{.sample}

Set the chroma sample location. Available values are:

'`auto`{.sample}'

Keep the same chroma location (default).

'`unspecified, unknown`{.sample}'

'`left`{.sample}'

'`center`{.sample}'

'`topleft`{.sample}'

'`top`{.sample}'

'`bottomleft`{.sample}'

'`bottom`{.sample}'

`alpha_mode`{.sample}

Set the alpha moda. Available values are:

'`auto`{.sample}'

Keep the same alpha mode (default).

'`unspecified, unknown`{.sample}'

'`premultiplied`{.sample}'

'`straight`{.sample}'

[]{#shear}

### [39.224 shear](#toc-shear) {#shear .section}

Apply shear transform to input video.

This filter supports the following options:

`shx`{.sample}

:   Shear factor in X-direction. Default value is 0. Allowed range is
    from -2 to 2.

`shy`{.sample}

:   Shear factor in Y-direction. Default value is 0. Allowed range is
    from -2 to 2.

`fillcolor, c`{.sample}

:   Set the color used to fill the output area not covered by the
    transformed video. For the general syntax of this option, check the
    [(ffmpeg-utils)\"Color\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#color-syntax). If the special value
    \"none\" is selected then no background is printed (useful for
    example if the background is never shown).

    Default value is \"black\".

`interp`{.sample}

:   Set interpolation type. Can be `bilinear` or `nearest`. Default is
    `bilinear`.

[]{#Commands-141}

#### [39.224.1 Commands](#toc-Commands-141) {#commands-141 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#showinfo-1}

### [39.225 showinfo](#toc-showinfo-1) {#showinfo-1 .section}

Show a line containing various information for each input video frame.
The input video is not modified.

This filter supports the following options:

`checksum`{.sample}

:   Calculate checksums of each plane. By default enabled.

`udu_sei_as_ascii`{.sample}

:   Try to print user data unregistered SEI as ascii character when
    possible, in hex format otherwise.

The shown line contains a sequence of key/value pairs of the form
`key`{.variable}:`value`{.variable}.

The following values are shown in the output:

`n`{.sample}

:   The (sequential) number of the input frame, starting from 0.

`pts`{.sample}

:   The Presentation TimeStamp of the input frame, expressed as a number
    of time base units. The time base unit depends on the filter input
    pad.

`pts_time`{.sample}

:   The Presentation TimeStamp of the input frame, expressed as a number
    of seconds.

`fmt`{.sample}

:   The pixel format name.

`sar`{.sample}

:   The sample aspect ratio of the input frame, expressed in the form
    `num`{.variable}/`den`{.variable}.

`s`{.sample}

:   The size of the input frame. For the syntax of this option, check
    the [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#video-size-syntax).

`i`{.sample}

:   The type of interlaced mode (\"P\" for \"progressive\", \"T\" for
    top field first, \"B\" for bottom field first).

`iskey`{.sample}

:   This is 1 if the frame is a key frame, 0 otherwise.

`type`{.sample}

:   The picture type of the input frame (\"I\" for an I-frame, \"P\" for
    a P-frame, \"B\" for a B-frame, or \"?\" for an unknown type). Also
    refer to the documentation of the `AVPictureType` enum and of the
    `av_get_picture_type_char` function defined in
    `libavutil/avutil.h`{.sample}.

`checksum`{.sample}

:   The Adler-32 checksum (printed in hexadecimal) of all the planes of
    the input frame.

`plane_checksum`{.sample}

:   The Adler-32 checksum (printed in hexadecimal) of each plane of the
    input frame, expressed in the form \"\[`c0`{.variable}
    `c1`{.variable} `c2`{.variable} `c3`{.variable}\]\".

`mean`{.sample}

:   The mean value of pixels in each plane of the input frame, expressed
    in the form \"\[`mean0`{.variable} `mean1`{.variable}
    `mean2`{.variable} `mean3`{.variable}\]\".

`stdev`{.sample}

:   The standard deviation of pixel values in each plane of the input
    frame, expressed in the form \"\[`stdev0`{.variable}
    `stdev1`{.variable} `stdev2`{.variable} `stdev3`{.variable}\]\".

[]{#showpalette}

### [39.226 showpalette](#toc-showpalette) {#showpalette .section}

Displays the 256 colors palette of each frame. This filter is only
relevant for `pal8`{.variable} pixel format frames.

It accepts the following option:

`s`{.sample}

:   Set the size of the box used to represent one palette color entry.
    Default is `30` (for a `30x30` pixel box).

[]{#shuffleframes}

### [39.227 shuffleframes](#toc-shuffleframes) {#shuffleframes .section}

Reorder and/or duplicate and/or drop video frames.

It accepts the following parameters:

`mapping`{.sample}

:   Set the destination indexes of input frames. This is space or '\|'
    separated list of indexes that maps input frames to output frames.
    Number of indexes also sets maximal value that each index may have.
    '-1' index have special meaning and that is to drop frame.

The first frame has the index 0. The default is to keep the input
unchanged.

[]{#Examples-162}

#### [39.227.1 Examples](#toc-Examples-162) {#examples-162 .subsection}

- Swap second and third frame of every three frames of the input:

  ::: example
  ``` example
  ffmpeg -i INPUT -vf "shuffleframes=0 2 1" OUTPUT
  ```
  :::
- Swap 10th and 1st frame of every ten frames of the input:

  ::: example
  ``` example
  ffmpeg -i INPUT -vf "shuffleframes=9 1 2 3 4 5 6 7 8 0" OUTPUT
  ```
  :::

[]{#shufflepixels}

### [39.228 shufflepixels](#toc-shufflepixels) {#shufflepixels .section}

Reorder pixels in video frames.

This filter accepts the following options:

`direction, d`{.sample}

:   Set shuffle direction. Can be forward or inverse direction. Default
    direction is forward.

`mode, m`{.sample}

:   Set shuffle mode. Can be horizontal, vertical or block mode.

`width, w`{.sample}\
`height, h`{.sample}

:   Set shuffle block_size. In case of horizontal shuffle mode only
    width part of size is used, and in case of vertical shuffle mode
    only height part of size is used.

`seed, s`{.sample}

:   Set random seed used with shuffling pixels. Mainly useful to set to
    be able to reverse filtering process to get original input. For
    example, to reverse forward shuffle you need to use same parameters
    and exact same seed and to set direction to inverse.

[]{#shuffleplanes}

### [39.229 shuffleplanes](#toc-shuffleplanes) {#shuffleplanes .section}

Reorder and/or duplicate video planes.

It accepts the following parameters:

`map0`{.sample}

:   The index of the input plane to be used as the first output plane.

`map1`{.sample}

:   The index of the input plane to be used as the second output plane.

`map2`{.sample}

:   The index of the input plane to be used as the third output plane.

`map3`{.sample}

:   The index of the input plane to be used as the fourth output plane.

The first plane has the index 0. The default is to keep the input
unchanged.

[]{#Examples-163}

#### [39.229.1 Examples](#toc-Examples-163) {#examples-163 .subsection}

- Swap the second and third planes of the input:

  ::: example
  ``` example
  ffmpeg -i INPUT -vf shuffleplanes=0:2:1:3 OUTPUT
  ```
  :::

[]{#signalstats}[]{#signalstats-1}

### [39.230 signalstats](#toc-signalstats-1) {#signalstats .section}

Evaluate various visual metrics that assist in determining issues
associated with the digitization of analog video media.

By default the filter will log these metadata values:

`YMIN`{.sample}

:   Display the minimal Y value contained within the input frame.
    Expressed in range of \[0-255\].

`YLOW`{.sample}

:   Display the Y value at the 10% percentile within the input frame.
    Expressed in range of \[0-255\].

`YAVG`{.sample}

:   Display the average Y value within the input frame. Expressed in
    range of \[0-255\].

`YHIGH`{.sample}

:   Display the Y value at the 90% percentile within the input frame.
    Expressed in range of \[0-255\].

`YMAX`{.sample}

:   Display the maximum Y value contained within the input frame.
    Expressed in range of \[0-255\].

`UMIN`{.sample}

:   Display the minimal U value contained within the input frame.
    Expressed in range of \[0-255\].

`ULOW`{.sample}

:   Display the U value at the 10% percentile within the input frame.
    Expressed in range of \[0-255\].

`UAVG`{.sample}

:   Display the average U value within the input frame. Expressed in
    range of \[0-255\].

`UHIGH`{.sample}

:   Display the U value at the 90% percentile within the input frame.
    Expressed in range of \[0-255\].

`UMAX`{.sample}

:   Display the maximum U value contained within the input frame.
    Expressed in range of \[0-255\].

`VMIN`{.sample}

:   Display the minimal V value contained within the input frame.
    Expressed in range of \[0-255\].

`VLOW`{.sample}

:   Display the V value at the 10% percentile within the input frame.
    Expressed in range of \[0-255\].

`VAVG`{.sample}

:   Display the average V value within the input frame. Expressed in
    range of \[0-255\].

`VHIGH`{.sample}

:   Display the V value at the 90% percentile within the input frame.
    Expressed in range of \[0-255\].

`VMAX`{.sample}

:   Display the maximum V value contained within the input frame.
    Expressed in range of \[0-255\].

`SATMIN`{.sample}

:   Display the minimal saturation value contained within the input
    frame. Expressed in range of \[0-\~181.02\].

`SATLOW`{.sample}

:   Display the saturation value at the 10% percentile within the input
    frame. Expressed in range of \[0-\~181.02\].

`SATAVG`{.sample}

:   Display the average saturation value within the input frame.
    Expressed in range of \[0-\~181.02\].

`SATHIGH`{.sample}

:   Display the saturation value at the 90% percentile within the input
    frame. Expressed in range of \[0-\~181.02\].

`SATMAX`{.sample}

:   Display the maximum saturation value contained within the input
    frame. Expressed in range of \[0-\~181.02\].

`HUEMED`{.sample}

:   Display the median value for hue within the input frame. Expressed
    in range of \[0-360\].

`HUEAVG`{.sample}

:   Display the average value for hue within the input frame. Expressed
    in range of \[0-360\].

`YDIF`{.sample}

:   Display the average of sample value difference between all values of
    the Y plane in the current frame and corresponding values of the
    previous input frame. Expressed in range of \[0-255\].

`UDIF`{.sample}

:   Display the average of sample value difference between all values of
    the U plane in the current frame and corresponding values of the
    previous input frame. Expressed in range of \[0-255\].

`VDIF`{.sample}

:   Display the average of sample value difference between all values of
    the V plane in the current frame and corresponding values of the
    previous input frame. Expressed in range of \[0-255\].

`YBITDEPTH`{.sample}

:   Display bit depth of Y plane in current frame. Expressed in range of
    \[0-16\].

`UBITDEPTH`{.sample}

:   Display bit depth of U plane in current frame. Expressed in range of
    \[0-16\].

`VBITDEPTH`{.sample}

:   Display bit depth of V plane in current frame. Expressed in range of
    \[0-16\].

The filter accepts the following options:

`stat`{.sample}\
`out`{.sample}

:   `stat`{.sample} specify an additional form of image analysis.
    `out`{.sample} output video with the specified type of pixel
    highlighted.

    Both options accept the following values:

    '`tout`{.sample}'

    :   Identify `temporal outliers`{.variable} pixels. A
        `temporal outlier`{.variable} is a pixel unlike the neighboring
        pixels of the same field. Examples of temporal outliers include
        the results of video dropouts, head clogs, or tape tracking
        issues.

    '`vrep`{.sample}'

    :   Identify `vertical line repetition`{.variable}. Vertical line
        repetition includes similar rows of pixels within a frame. In
        born-digital video vertical line repetition is common, but this
        pattern is uncommon in video digitized from an analog source.
        When it occurs in video that results from the digitization of an
        analog source it can indicate concealment from a dropout
        compensator.

    '`brng`{.sample}'

    :   Identify pixels that fall outside of legal broadcast range.

`color, c`{.sample}

:   Set the highlight color for the `out`{.sample} option. The default
    color is yellow.

[]{#Examples-164}

#### [39.230.1 Examples](#toc-Examples-164) {#examples-164 .subsection}

- Output data of various video metrics:

  ::: example
  ``` example
  ffprobe -f lavfi movie=example.mov,signalstats="stat=tout+vrep+brng" -show_frames
  ```
  :::

- Output specific data about the minimum and maximum values of the Y
  plane per frame:

  ::: example
  ``` example
  ffprobe -f lavfi movie=example.mov,signalstats -show_entries frame_tags=lavfi.signalstats.YMAX,lavfi.signalstats.YMIN
  ```
  :::

- Playback video while highlighting pixels that are outside of broadcast
  range in red.

  ::: example
  ``` example
  ffplay example.mov -vf signalstats="out=brng:color=red"
  ```
  :::

- Playback video with signalstats metadata drawn over the frame.

  ::: example
  ``` example
  ffplay example.mov -vf signalstats=stat=brng+vrep+tout,drawtext=fontfile=FreeSerif.ttf:textfile=signalstat_drawtext.txt
  ```
  :::

  The contents of signalstat_drawtext.txt used in the command are:

  ::: example
  ``` example
  time %{pts:hms}
  Y (%{metadata:lavfi.signalstats.YMIN}-%{metadata:lavfi.signalstats.YMAX})
  U (%{metadata:lavfi.signalstats.UMIN}-%{metadata:lavfi.signalstats.UMAX})
  V (%{metadata:lavfi.signalstats.VMIN}-%{metadata:lavfi.signalstats.VMAX})
  saturation maximum: %{metadata:lavfi.signalstats.SATMAX}
  ```
  :::

[]{#signature}[]{#signature-1}

### [39.231 signature](#toc-signature-1) {#signature .section}

Calculates the MPEG-7 Video Signature. The filter can handle more than
one input. In this case the matching between the inputs can be
calculated additionally. The filter always passes through the first
input. The signature of each stream can be written into a file.

It accepts the following options:

`detectmode`{.sample}

:   Enable or disable the matching process.

    Available values are:

    '`off`{.sample}'

    :   Disable the calculation of a matching (default).

    '`full`{.sample}'

    :   Calculate the matching for the whole video and output whether
        the whole video matches or only parts.

    '`fast`{.sample}'

    :   Calculate only until a matching is found or the video ends.
        Should be faster in some cases.

`nb_inputs`{.sample}

:   Set the number of inputs. The option value must be a non negative
    integer. Default value is 1.

`filename`{.sample}

:   Set the path to which the output is written. If there is more than
    one input, the path must be a prototype, i.e. must contain %d or
    %0nd (where n is a positive integer), that will be replaced with the
    input number. If no filename is specified, no output will be
    written. This is the default.

`format`{.sample}

:   Choose the output format.

    Available values are:

    '`binary`{.sample}'

    :   Use the specified binary representation (default).

    '`xml`{.sample}'

    :   Use the specified xml representation.

`th_d`{.sample}

:   Set threshold to detect one word as similar. The option value must
    be an integer greater than zero. The default value is 9000.

`th_dc`{.sample}

:   Set threshold to detect all words as similar. The option value must
    be an integer greater than zero. The default value is 60000.

`th_xh`{.sample}

:   Set threshold to detect frames as similar. The option value must be
    an integer greater than zero. The default value is 116.

`th_di`{.sample}

:   Set the minimum length of a sequence in frames to recognize it as
    matching sequence. The option value must be a non negative integer
    value. The default value is 0.

`th_it`{.sample}

:   Set the minimum relation, that matching frames to all frames must
    have. The option value must be a double value between 0 and 1. The
    default value is 0.5.

[]{#Examples-165}

#### [39.231.1 Examples](#toc-Examples-165) {#examples-165 .subsection}

- To calculate the signature of an input video and store it in
  signature.bin:

  ::: example
  ``` example
  ffmpeg -i input.mkv -vf signature=filename=signature.bin -map 0:v -f null -
  ```
  :::
- To detect whether two videos match and store the signatures in XML
  format in signature0.xml and signature1.xml:

  ::: example
  ``` example
  ffmpeg -i input1.mkv -i input2.mkv -filter_complex "[0:v][1:v] signature=nb_inputs=2:detectmode=full:format=xml:filename=signature%d.xml" -map :v -f null -
  ```
  :::

[]{#siti}[]{#siti-1}

### [39.232 siti](#toc-siti-1) {#siti .section}

Calculate Spatial Information (SI) and Temporal Information (TI) scores
for a video, as defined in ITU-T Rec. P.910 (11/21): Subjective video
quality assessment methods for multimedia applications. Available PDF at
<https://www.itu.int/rec/T-REC-P.910-202111-S/en>. Note that this is a
legacy implementation that corresponds to a superseded recommendation.
Refer to ITU-T Rec. P.910 (07/22) for the latest version:
<https://www.itu.int/rec/T-REC-P.910-202207-I/en>

It accepts the following option:

`print_summary`{.sample}

:   If set to 1, Summary statistics will be printed to the console.
    Default 0.

[]{#Examples-166}

#### [39.232.1 Examples](#toc-Examples-166) {#examples-166 .subsection}

- To calculate SI/TI metrics and print summary:

  ::: example
  ``` example
  ffmpeg -i input.mp4 -vf siti=print_summary=1 -f null -
  ```
  :::

[]{#smartblur}[]{#smartblur-1}

### [39.233 smartblur](#toc-smartblur-1) {#smartblur .section}

Blur the input video without impacting the outlines.

It accepts the following options:

`luma_radius, lr`{.sample}

:   Set the luma radius. The option value must be a float number in the
    range \[0.1,5.0\] that specifies the variance of the gaussian filter
    used to blur the image (slower if larger). Default value is 1.0.

`luma_strength, ls`{.sample}

:   Set the luma strength. The option value must be a float number in
    the range \[-1.0,1.0\] that configures the blurring. A value
    included in \[0.0,1.0\] will blur the image whereas a value included
    in \[-1.0,0.0\] will sharpen the image. Default value is 1.0.

`luma_threshold, lt`{.sample}

:   Set the luma threshold used as a coefficient to determine whether a
    pixel should be blurred or not. The option value must be an integer
    in the range \[-30,30\]. A value of 0 will filter all the image, a
    value included in \[0,30\] will filter flat areas and a value
    included in \[-30,0\] will filter edges. Default value is 0.

`chroma_radius, cr`{.sample}

:   Set the chroma radius. The option value must be a float number in
    the range \[0.1,5.0\] that specifies the variance of the gaussian
    filter used to blur the image (slower if larger). Default value is
    `luma_radius`{.sample}.

`chroma_strength, cs`{.sample}

:   Set the chroma strength. The option value must be a float number in
    the range \[-1.0,1.0\] that configures the blurring. A value
    included in \[0.0,1.0\] will blur the image whereas a value included
    in \[-1.0,0.0\] will sharpen the image. Default value is
    `luma_strength`{.sample}.

`chroma_threshold, ct`{.sample}

:   Set the chroma threshold used as a coefficient to determine whether
    a pixel should be blurred or not. The option value must be an
    integer in the range \[-30,30\]. A value of 0 will filter all the
    image, a value included in \[0,30\] will filter flat areas and a
    value included in \[-30,0\] will filter edges. Default value is
    `luma_threshold`{.sample}.

`alpha_radius, ar`{.sample}

:   Set the alpha radius. The option value must be a float number in the
    range \[0.1,5.0\] that specifies the variance of the gaussian filter
    used to blur the image (slower if larger). Default value is
    `luma_radius`{.sample}.

`alpha_strength, as`{.sample}

:   Set the alpha strength. The option value must be a float number in
    the range \[-1.0,1.0\] that configures the blurring. A value
    included in \[0.0,1.0\] will blur the image whereas a value included
    in \[-1.0,0.0\] will sharpen the image. Default value is
    `luma_strength`{.sample}.

`alpha_threshold, at`{.sample}

:   Set the alpha threshold used as a coefficient to determine whether a
    pixel should be blurred or not. The option value must be an integer
    in the range \[-30,30\]. A value of 0 will filter all the image, a
    value included in \[0,30\] will filter flat areas and a value
    included in \[-30,0\] will filter edges. Default value is
    `luma_threshold`{.sample}.

If a chroma or alpha option is not explicitly set, the corresponding
luma value is set.

[]{#sobel}

### [39.234 sobel](#toc-sobel) {#sobel .section}

Apply sobel operator to input video stream.

The filter accepts the following option:

`planes`{.sample}

:   Set which planes will be processed, unprocessed planes will be
    copied. By default value 0xf, all planes will be processed.

`scale`{.sample}

:   Set value which will be multiplied with filtered result.

`delta`{.sample}

:   Set value which will be added to filtered result.

[]{#Commands-142}

#### [39.234.1 Commands](#toc-Commands-142) {#commands-142 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#spp}[]{#spp-1}

### [39.235 spp](#toc-spp-1) {#spp .section}

Apply a simple postprocessing filter that compresses and decompresses
the image at several (or - in the case of `quality`{.sample} level `6` -
all) shifts and average the results.

The filter accepts the following options:

`quality`{.sample}

:   Set quality. This option defines the number of levels for averaging.
    It accepts an integer in the range 0-6. If set to `0`, the filter
    will have no effect. A value of `6` means the higher quality. For
    each increment of that value the speed drops by a factor of
    approximately 2. Default value is `3`.

`qp`{.sample}

:   Force a constant quantization parameter. If not set, the filter will
    use the QP from the video stream (if available).

`mode`{.sample}

:   Set thresholding mode. Available modes are:

    '`hard`{.sample}'

    :   Set hard thresholding (default).

    '`soft`{.sample}'

    :   Set soft thresholding (better de-ringing effect, but likely
        blurrier).

`use_bframe_qp`{.sample}

:   Enable the use of the QP from the B-Frames if set to `1`. Using this
    option may cause flicker since the B-Frames have often larger QP.
    Default is `0` (not enabled).

[]{#Commands-143}

#### [39.235.1 Commands](#toc-Commands-143) {#commands-143 .subsection}

This filter supports the following commands:

`quality, level`{.sample}

:   Set quality level. The value `max` can be used to set the maximum
    level, currently `6`.

[]{#sr}[]{#sr-1}

### [39.236 sr](#toc-sr-1) {#sr .section}

Scale the input by applying one of the super-resolution methods based on
convolutional neural networks. Supported models:

- Super-Resolution Convolutional Neural Network model (SRCNN). See
  <https://arxiv.org/abs/1501.00092>.
- Efficient Sub-Pixel Convolutional Neural Network model (ESPCN). See
  <https://arxiv.org/abs/1609.05158>.

Training scripts as well as scripts for model file (.pb) saving can be
found at <https://github.com/XueweiMeng/sr/tree/sr_dnn_native>. Original
repository is at <https://github.com/HighVoltageRocknRoll/sr.git>.

The filter accepts the following options:

`dnn_backend`{.sample}

:   Specify which DNN backend to use for model loading and execution.
    This option accepts the following values:

    '`tensorflow`{.sample}'

    :   TensorFlow backend. To enable this backend you need to install
        the TensorFlow for C library (see
        <https://www.tensorflow.org/install/lang_c>) and configure
        FFmpeg with `--enable-libtensorflow`

`model`{.sample}

:   Set path to model file specifying network architecture and its
    parameters. Note that different backends use different file formats.
    TensorFlow, OpenVINO backend can load files for only its format.

`scale_factor`{.sample}

:   Set scale factor for SRCNN model. Allowed values are `2`, `3` and
    `4`. Default value is `2`. Scale factor is necessary for SRCNN
    model, because it accepts input upscaled using bicubic upscaling
    with proper scale factor.

To get full functionality (such as async execution), please use the
[dnn_processing](#dnn_005fprocessing) filter.

[]{#sr_005famf}[]{#sr_005famf-1}

### [39.237 sr_amf](#toc-sr_005famf-1) {#sr_amf .section}

Upscale (size increasing) for the input video using AMD Advanced Media
Framework library for hardware acceleration. Use advanced algorithms for
upscaling with higher output quality. Setting the output width and
height works in the same way as for the [scale](#scale) filter.

The filter accepts the following options:

`w`{.sample}\
`h`{.sample}

:   Set the output video dimension expression. Default value is the
    input dimension.

    Allows for the same expressions as the [scale](#scale) filter.

`algorithm`{.sample}

:   Sets the algorithm used for scaling:

    `bilinear`{.variable}

    :   Bilinear

    `bicubic`{.variable}

    :   Bicubic

    `sr1-0`{.variable}

    :   Video SR1.0 This is a default value

    `point`{.variable}

    :   Point

    `sr1-1`{.variable}

    :   Video SR1.1

`sharpness`{.sample}

:   Control hq scaler sharpening. The value is a float in the range of
    \[0.0, 2.0\]

`format`{.sample}

:   Controls the output pixel format. By default, or if none is
    specified, the input pixel format is used.

`keep-ratio`{.sample}

:   Force the scaler to keep the aspect ratio of the input image when
    the output size has a different aspect ratio. Default value is
    false.

`fill`{.sample}

:   Specifies whether the output image outside the region of interest,
    which does not fill the entire output surface should be filled with
    a solid color.

[]{#Examples-167}

#### [39.237.1 Examples](#toc-Examples-167) {#examples-167 .subsection}

- Scale input to 720p, keeping aspect ratio and ensuring the output is
  yuv420p.

  ::: example
  ``` example
  sr_amf=-2:720:format=yuv420p
  ```
  :::
- Upscale to 4K with algorithm video SR1.1.

  ::: example
  ``` example
  sr_amf=4096:2160:algorithm=sr1-1
  ```
  :::

[]{#ssim}

### [39.238 ssim](#toc-ssim) {#ssim .section}

Obtain the SSIM (Structural SImilarity Metric) between two input videos.

This filter takes in input two input videos, the first input is
considered the \"main\" source and is passed unchanged to the output.
The second input is used as a \"reference\" video for computing the
SSIM.

Both video inputs must have the same resolution and pixel format for
this filter to work correctly. Also it assumes that both inputs have the
same number of frames, which are compared one by one.

The filter stores the calculated SSIM of each frame.

The description of the accepted parameters follows.

`stats_file, f`{.sample}

:   If specified the filter will use the named file to save the SSIM of
    each individual frame. When filename equals \"-\" the data is sent
    to standard output.

The file printed if `stats_file`{.variable} is selected, contains a
sequence of key/value pairs of the form
`key`{.variable}:`value`{.variable} for each compared couple of frames.

A description of each shown parameter follows:

`n`{.sample}

:   sequential number of the input frame, starting from 1

`Y, U, V, R, G, B`{.sample}

:   SSIM of the compared frames for the component specified by the
    suffix.

`All`{.sample}

:   SSIM of the compared frames for the whole frame.

`dB`{.sample}

:   Same as above but in dB representation.

This filter also supports the [framesync](#framesync) options.

[]{#Examples-168}

#### [39.238.1 Examples](#toc-Examples-168) {#examples-168 .subsection}

- For example:

  ::: example
  ``` example
  movie=ref_movie.mpg, setpts=PTS-STARTPTS [main];
  [main][ref] ssim="stats_file=stats.log" [out]
  ```
  :::

  On this example the input file being processed is compared with the
  reference file `ref_movie.mpg`{.sample}. The SSIM of each individual
  frame is stored in `stats.log`{.sample}.

- Another example with both psnr and ssim at same time:

  ::: example
  ``` example
  ffmpeg -i main.mpg -i ref.mpg -lavfi  "ssim;[0:v][1:v]psnr" -f null -
  ```
  :::

- Another example with different containers:

  ::: example
  ``` example
  ffmpeg -i main.mpg -i ref.mkv -lavfi  "[0:v]settb=AVTB,setpts=PTS-STARTPTS[main];[1:v]settb=AVTB,setpts=PTS-STARTPTS[ref];[main][ref]ssim" -f null -
  ```
  :::

[]{#stereo3d}

### [39.239 stereo3d](#toc-stereo3d) {#stereo3d .section}

Convert between different stereoscopic image formats.

The filters accept the following options:

`in`{.sample}

:   Set stereoscopic image format of input.

    Available values for input image formats are:

    '`sbsl`{.sample}'

    :   side by side parallel (left eye left, right eye right)

    '`sbsr`{.sample}'

    :   side by side crosseye (right eye left, left eye right)

    '`sbs2l`{.sample}'

    :   side by side parallel with half width resolution (left eye left,
        right eye right)

    '`sbs2r`{.sample}'

    :   side by side crosseye with half width resolution (right eye
        left, left eye right)

    '`abl`{.sample}'\
    '`tbl`{.sample}'

    :   above-below (left eye above, right eye below)

    '`abr`{.sample}'\
    '`tbr`{.sample}'

    :   above-below (right eye above, left eye below)

    '`ab2l`{.sample}'\
    '`tb2l`{.sample}'

    :   above-below with half height resolution (left eye above, right
        eye below)

    '`ab2r`{.sample}'\
    '`tb2r`{.sample}'

    :   above-below with half height resolution (right eye above, left
        eye below)

    '`al`{.sample}'

    :   alternating frames (left eye first, right eye second)

    '`ar`{.sample}'

    :   alternating frames (right eye first, left eye second)

    '`irl`{.sample}'

    :   interleaved rows (left eye has top row, right eye starts on next
        row)

    '`irr`{.sample}'

    :   interleaved rows (right eye has top row, left eye starts on next
        row)

    '`icl`{.sample}'

    :   interleaved columns, left eye first

    '`icr`{.sample}'

    :   interleaved columns, right eye first

        Default value is '`sbsl`{.sample}'.

`out`{.sample}

:   Set stereoscopic image format of output.

    '`sbsl`{.sample}'

    :   side by side parallel (left eye left, right eye right)

    '`sbsr`{.sample}'

    :   side by side crosseye (right eye left, left eye right)

    '`sbs2l`{.sample}'

    :   side by side parallel with half width resolution (left eye left,
        right eye right)

    '`sbs2r`{.sample}'

    :   side by side crosseye with half width resolution (right eye
        left, left eye right)

    '`abl`{.sample}'\
    '`tbl`{.sample}'

    :   above-below (left eye above, right eye below)

    '`abr`{.sample}'\
    '`tbr`{.sample}'

    :   above-below (right eye above, left eye below)

    '`ab2l`{.sample}'\
    '`tb2l`{.sample}'

    :   above-below with half height resolution (left eye above, right
        eye below)

    '`ab2r`{.sample}'\
    '`tb2r`{.sample}'

    :   above-below with half height resolution (right eye above, left
        eye below)

    '`al`{.sample}'

    :   alternating frames (left eye first, right eye second)

    '`ar`{.sample}'

    :   alternating frames (right eye first, left eye second)

    '`irl`{.sample}'

    :   interleaved rows (left eye has top row, right eye starts on next
        row)

    '`irr`{.sample}'

    :   interleaved rows (right eye has top row, left eye starts on next
        row)

    '`arbg`{.sample}'

    :   anaglyph red/blue gray (red filter on left eye, blue filter on
        right eye)

    '`argg`{.sample}'

    :   anaglyph red/green gray (red filter on left eye, green filter on
        right eye)

    '`arcg`{.sample}'

    :   anaglyph red/cyan gray (red filter on left eye, cyan filter on
        right eye)

    '`arch`{.sample}'

    :   anaglyph red/cyan half colored (red filter on left eye, cyan
        filter on right eye)

    '`arcc`{.sample}'

    :   anaglyph red/cyan color (red filter on left eye, cyan filter on
        right eye)

    '`arcd`{.sample}'

    :   anaglyph red/cyan color optimized with the least squares
        projection of dubois (red filter on left eye, cyan filter on
        right eye)

    '`agmg`{.sample}'

    :   anaglyph green/magenta gray (green filter on left eye, magenta
        filter on right eye)

    '`agmh`{.sample}'

    :   anaglyph green/magenta half colored (green filter on left eye,
        magenta filter on right eye)

    '`agmc`{.sample}'

    :   anaglyph green/magenta colored (green filter on left eye,
        magenta filter on right eye)

    '`agmd`{.sample}'

    :   anaglyph green/magenta color optimized with the least squares
        projection of dubois (green filter on left eye, magenta filter
        on right eye)

    '`aybg`{.sample}'

    :   anaglyph yellow/blue gray (yellow filter on left eye, blue
        filter on right eye)

    '`aybh`{.sample}'

    :   anaglyph yellow/blue half colored (yellow filter on left eye,
        blue filter on right eye)

    '`aybc`{.sample}'

    :   anaglyph yellow/blue colored (yellow filter on left eye, blue
        filter on right eye)

    '`aybd`{.sample}'

    :   anaglyph yellow/blue color optimized with the least squares
        projection of dubois (yellow filter on left eye, blue filter on
        right eye)

    '`ml`{.sample}'

    :   mono output (left eye only)

    '`mr`{.sample}'

    :   mono output (right eye only)

    '`chl`{.sample}'

    :   checkerboard, left eye first

    '`chr`{.sample}'

    :   checkerboard, right eye first

    '`icl`{.sample}'

    :   interleaved columns, left eye first

    '`icr`{.sample}'

    :   interleaved columns, right eye first

    '`hdmi`{.sample}'

    :   HDMI frame pack

    Default value is '`arcd`{.sample}'.

[]{#Examples-169}

#### [39.239.1 Examples](#toc-Examples-169) {#examples-169 .subsection}

- Convert input video from side by side parallel to anaglyph yellow/blue
  dubois:

  ::: example
  ``` example
  stereo3d=sbsl:aybd
  ```
  :::
- Convert input video from above below (left eye above, right eye below)
  to side by side crosseye.

  ::: example
  ``` example
  stereo3d=abl:sbsr
  ```
  :::

[]{#streamselect_002c-astreamselect}

### [39.240 streamselect, astreamselect](#toc-streamselect_002c-astreamselect) {#streamselect-astreamselect .section}

Select video or audio streams.

The filter accepts the following options:

`inputs`{.sample}

:   Set number of inputs. Default is 2.

`map`{.sample}

:   Set input indexes to remap to outputs.

[]{#Commands-144}

#### [39.240.1 Commands](#toc-Commands-144) {#commands-144 .subsection}

The `streamselect` and `astreamselect` filter supports the following
commands:

`map`{.sample}

:   Set input indexes to remap to outputs.

[]{#Examples-170}

#### [39.240.2 Examples](#toc-Examples-170) {#examples-170 .subsection}

- Select first 5 seconds 1st stream and rest of time 2nd stream:

  ::: example
  ``` example
  sendcmd='5.0 streamselect map 1',streamselect=inputs=2:map=0
  ```
  :::
- Same as above, but for audio:

  ::: example
  ``` example
  asendcmd='5.0 astreamselect map 1',astreamselect=inputs=2:map=0
  ```
  :::

[]{#subtitles}[]{#subtitles-1}

### [39.241 subtitles](#toc-subtitles-1) {#subtitles .section}

Draw subtitles on top of input video using the libass library.

To enable compilation of this filter you need to configure FFmpeg with
`--enable-libass`. This filter also requires a build with libavcodec and
libavformat to convert the passed subtitles file to ASS (Advanced
Substation Alpha) subtitles format.

The filter accepts the following options:

`filename, f`{.sample}

:   Set the filename of the subtitle file to read. It must be specified.

`original_size`{.sample}

:   Specify the size of the original video, the video for which the ASS
    file was composed. For the syntax of this option, check the
    [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#video-size-syntax). Due to a misdesign in
    ASS aspect ratio arithmetic, this is necessary to correctly scale
    the fonts if the aspect ratio has been changed.

`fontsdir`{.sample}

:   Set a directory path containing fonts that can be used by the
    filter. These fonts will be used in addition to whatever the font
    provider uses.

`alpha`{.sample}

:   Process alpha channel, by default alpha channel is untouched.

`charenc`{.sample}

:   Set subtitles input character encoding. `subtitles` filter only.
    Only useful if not UTF-8.

`stream_index, si`{.sample}

:   Set subtitles stream index. `subtitles` filter only.

`force_style`{.sample}

:   Override default style or script info parameters of the subtitles.
    It accepts a string containing ASS style format `KEY=VALUE` couples
    separated by \",\".

`wrap_unicode`{.sample}

:   Break lines according to the Unicode Line Breaking Algorithm.
    Availability requires at least libass release 0.17.0 (or
    LIBASS_VERSION 0x01600010), *and* libass must have been built with
    libunibreak.

    The option is enabled by default except for native ASS.

If the first key is not specified, it is assumed that the first value
specifies the `filename`{.sample}.

For example, to render the file `sub.srt`{.sample} on top of the input
video, use the command:

::: example
``` example
subtitles=sub.srt
```
:::

which is equivalent to:

::: example
``` example
subtitles=filename=sub.srt
```
:::

To render the default subtitles stream from file `video.mkv`{.sample},
use:

::: example
``` example
subtitles=video.mkv
```
:::

To render the second subtitles stream from that file, use:

::: example
``` example
subtitles=video.mkv:si=1
```
:::

To make the subtitles stream from `sub.srt`{.sample} appear in 80%
transparent blue `DejaVu Serif`, use:

::: example
``` example
subtitles=sub.srt:force_style='Fontname=DejaVu Serif,PrimaryColour=&HCCFF0000'
```
:::

[]{#super2xsai}

### [39.242 super2xsai](#toc-super2xsai) {#super2xsai .section}

Scale the input by 2x and smooth using the Super2xSaI (Scale and
Interpolate) pixel art scaling algorithm.

Useful for enlarging pixel art images without reducing sharpness.

[]{#swaprect}

### [39.243 swaprect](#toc-swaprect) {#swaprect .section}

Swap two rectangular objects in video.

This filter accepts the following options:

`w`{.sample}

:   Set object width.

`h`{.sample}

:   Set object height.

`x1`{.sample}

:   Set 1st rect x coordinate.

`y1`{.sample}

:   Set 1st rect y coordinate.

`x2`{.sample}

:   Set 2nd rect x coordinate.

`y2`{.sample}

:   Set 2nd rect y coordinate.

    All expressions are evaluated once for each frame.

The all options are expressions containing the following constants:

`w`{.sample}\
`h`{.sample}

:   The input width and height.

`a`{.sample}

:   same as `w`{.variable} / `h`{.variable}

`sar`{.sample}

:   input sample aspect ratio

`dar`{.sample}

:   input display aspect ratio, it is the same as (`w`{.variable} /
    `h`{.variable}) \* `sar`{.variable}

`n`{.sample}

:   The number of the input frame, starting from 0.

`t`{.sample}

:   The timestamp expressed in seconds. It's NAN if the input timestamp
    is unknown.

`pos`{.sample}

:   the position in the file of the input frame, NAN if unknown;
    deprecated, do not use

[]{#Commands-145}

#### [39.243.1 Commands](#toc-Commands-145) {#commands-145 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#swapuv}

### [39.244 swapuv](#toc-swapuv) {#swapuv .section}

Swap U & V plane.

[]{#tblend}

### [39.245 tblend](#toc-tblend) {#tblend .section}

Blend successive video frames.

See [blend](#blend)

[]{#telecine}

### [39.246 telecine](#toc-telecine) {#telecine .section}

Apply telecine process to the video.

This filter accepts the following options:

`first_field`{.sample}

:   

    '`top, t`{.sample}'

    :   top field first

    '`bottom, b`{.sample}'

    :   bottom field first The default value is `top`.

`pattern`{.sample}

:   A string of numbers representing the pulldown pattern you wish to
    apply. The default value is `23`.

::: example
``` example
Some typical patterns:

NTSC output (30i):
27.5p: 32222
24p: 23 (classic)
24p: 2332 (preferred)
20p: 33
18p: 334
16p: 3444

PAL output (25i):
27.5p: 12222
24p: 222222222223 ("Euro pulldown")
16.67p: 33
16p: 33333334
```
:::

[]{#thistogram}

### [39.247 thistogram](#toc-thistogram) {#thistogram .section}

Compute and draw a color distribution histogram for the input video
across time.

Unlike [histogram](#histogram) video filter which only shows histogram
of single input frame at certain time, this filter shows also past
histograms of number of frames defined by `width` option.

The computed histogram is a representation of the color component
distribution in an image.

The filter accepts the following options:

`width, w`{.sample}

:   Set width of single color component output. Default value is `0`.
    Value of `0` means width will be picked from input video. This also
    set number of passed histograms to keep. Allowed range is \[0,
    8192\].

`display_mode, d`{.sample}

:   Set display mode. It accepts the following values:

    '`stack`{.sample}'

    :   Per color component graphs are placed below each other.

    '`parade`{.sample}'

    :   Per color component graphs are placed side by side.

    '`overlay`{.sample}'

    :   Presents information identical to that in the `parade`, except
        that the graphs representing color components are superimposed
        directly over one another.

    Default is `stack`.

`levels_mode, m`{.sample}

:   Set mode. Can be either `linear`, or `logarithmic`. Default is
    `linear`.

`components, c`{.sample}

:   Set what color components to display. Default is `7`.

`bgopacity, b`{.sample}

:   Set background opacity. Default is `0.9`.

`envelope, e`{.sample}

:   Show envelope. Default is disabled.

`ecolor, ec`{.sample}

:   Set envelope color. Default is `gold`.

`slide`{.sample}

:   Set slide mode.

    Available values for slide is:

    '`frame`{.sample}'

    :   Draw new frame when right border is reached.

    '`replace`{.sample}'

    :   Replace old columns with new ones.

    '`scroll`{.sample}'

    :   Scroll from right to left.

    '`rscroll`{.sample}'

    :   Scroll from left to right.

    '`picture`{.sample}'

    :   Draw single picture.

    Default is `replace`.

[]{#threshold}

### [39.248 threshold](#toc-threshold) {#threshold .section}

Apply threshold effect to video stream.

This filter needs four video streams to perform thresholding. First
stream is stream we are filtering. Second stream is holding threshold
values, third stream is holding min values, and last, fourth stream is
holding max values.

The filter accepts the following option:

`planes`{.sample}

:   Set which planes will be processed, unprocessed planes will be
    copied. By default value 0xf, all planes will be processed.

For example if first stream pixel's component value is less then
threshold value of pixel component from 2nd threshold stream, third
stream value will picked, otherwise fourth stream pixel component value
will be picked.

Using color source filter one can perform various types of thresholding:

[]{#Commands-146}

#### [39.248.1 Commands](#toc-Commands-146) {#commands-146 .subsection}

This filter supports the all options as [commands](#commands).

[]{#Examples-171}

#### [39.248.2 Examples](#toc-Examples-171) {#examples-171 .subsection}

- Binary threshold, using gray color as threshold:

  ::: example
  ``` example
  ffmpeg -i 320x240.avi -f lavfi -i color=gray -f lavfi -i color=black -f lavfi -i color=white -lavfi threshold output.avi
  ```
  :::
- Inverted binary threshold, using gray color as threshold:

  ::: example
  ``` example
  ffmpeg -i 320x240.avi -f lavfi -i color=gray -f lavfi -i color=white -f lavfi -i color=black -lavfi threshold output.avi
  ```
  :::
- Truncate binary threshold, using gray color as threshold:

  ::: example
  ``` example
  ffmpeg -i 320x240.avi -f lavfi -i color=gray -i 320x240.avi -f lavfi -i color=gray -lavfi threshold output.avi
  ```
  :::
- Threshold to zero, using gray color as threshold:

  ::: example
  ``` example
  ffmpeg -i 320x240.avi -f lavfi -i color=gray -f lavfi -i color=white -i 320x240.avi -lavfi threshold output.avi
  ```
  :::
- Inverted threshold to zero, using gray color as threshold:

  ::: example
  ``` example
  ffmpeg -i 320x240.avi -f lavfi -i color=gray -i 320x240.avi -f lavfi -i color=white -lavfi threshold output.avi
  ```
  :::

[]{#thumbnail}

### [39.249 thumbnail](#toc-thumbnail) {#thumbnail .section}

Select the most representative frame in a given sequence of consecutive
frames.

The filter accepts the following options:

`n`{.sample}

:   Set the frames batch size to analyze; in a set of `n`{.variable}
    frames, the filter will pick one of them, and then handle the next
    batch of `n`{.variable} frames until the end. Default is `100`.

`log`{.sample}

:   Set the log level to display picked frame stats. Default is `info`.

Since the filter keeps track of the whole frames sequence, a bigger
`n`{.variable} value will result in a higher memory usage, so a high
value is not recommended.

[]{#Examples-172}

#### [39.249.1 Examples](#toc-Examples-172) {#examples-172 .subsection}

- Extract one picture each 50 frames:

  ::: example
  ``` example
  thumbnail=50
  ```
  :::
- Complete example of a thumbnail creation with `ffmpeg`:

  ::: example
  ``` example
  ffmpeg -i in.avi -vf thumbnail,scale=300:200 -frames:v 1 out.png
  ```
  :::

[]{#tile}[]{#tile-1}

### [39.250 tile](#toc-tile-1) {#tile .section}

Tile several successive frames together.

The [untile](#untile) filter can do the reverse.

The filter accepts the following options:

`layout`{.sample}

:   Set the grid size in the form `COLUMNSxROWS`. Range is up to
    UINT_MAX cells. Default is `6x5`.

`nb_frames`{.sample}

:   Set the maximum number of frames to render in the given area. It
    must be less than or equal to `w`{.variable}x`h`{.variable}. The
    default value is `0`, meaning all the area will be used.

`margin`{.sample}

:   Set the outer border margin in pixels. Range is 0 to 1024. Default
    is `0`.

`padding`{.sample}

:   Set the inner border thickness (i.e. the number of pixels between
    frames). For more advanced padding options (such as having different
    values for the edges), refer to the pad video filter. Range is 0
    to 1024. Default is `0`.

`color`{.sample}

:   Specify the color of the unused area. For the syntax of this option,
    check the [(ffmpeg-utils)\"Color\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#color-syntax). The default value of
    `color`{.variable} is \"black\".

`overlap`{.sample}

:   Set the number of frames to overlap when tiling several successive
    frames together. The value must be between `0` and
    `nb_frames - 1`{.variable}. Default is `0`.

`init_padding`{.sample}

:   Set the number of frames to initially be empty before displaying
    first output frame. This controls how soon will one get first output
    frame. The value must be between `0` and `nb_frames - 1`{.variable}.
    Default is `0`.

[]{#Examples-173}

#### [39.250.1 Examples](#toc-Examples-173) {#examples-173 .subsection}

- Produce 8x8 PNG tiles of all keyframes (`-skip_frame nokey`{.sample})
  in a movie:

  ::: example
  ``` example
  ffmpeg -skip_frame nokey -i file.avi -vf 'scale=128:72,tile=8x8' -an -vsync 0 keyframes%03d.png
  ```
  :::

  The `-vsync 0`{.sample} is necessary to prevent `ffmpeg` from
  duplicating each output frame to accommodate the originally detected
  frame rate.

- Display `5` pictures in an area of `3x2` frames, with `7` pixels
  between them, and `2` pixels of initial margin, using mixed flat and
  named options:

  ::: example
  ``` example
  tile=3x2:nb_frames=5:padding=7:margin=2
  ```
  :::

[]{#tiltandshift}

### [39.251 tiltandshift](#toc-tiltandshift) {#tiltandshift .section}

Apply tilt-and-shift effect.

What happens when you invert time and space?

Normally a video is composed of several frames that represent a
different instant of time and shows a scene that evolves in the space
captured by the frame. This filter is the antipode of that concept,
taking inspiration from tilt and shift photography.

A filtered frame contains the whole timeline of events composing the
sequence, and this is obtained by placing a slice of pixels from each
frame into a single one. However, since there are no infinite-width
frames, this is done up the width of the input frame, and a video is
recomposed by shifting away one column for each subsequent frame. In
order to map space to time, the filter tilts each input frame as well,
so that motion is preserved. This is accomplished by progressively
selecting a different column from each input frame.

The end result is a sort of inverted parallax, so that far away objects
move much faster that the ones in the front. The ideal conditions for
this video effect are when there is either very little motion and the
background is static, or when there is a lot of motion and a very wide
depth of field (e.g. wide panorama, while moving on a train).

The filter accepts the following parameters:

`tilt`{.sample}

:   Tilt video while shifting (default). When unset, video will be
    sliding a static image, composed of the first column of each frame.

`start`{.sample}

:   What to do at the start of filtering (see below).

`end`{.sample}

:   What to do at the end of filtering (see below).

`hold`{.sample}

:   How many columns should pass through before start of filtering.

`pad`{.sample}

:   How many columns should be inserted before end of filtering.

Normally the filter shifts and tilts from the very first frame, and
stops when the last one is received. However, before filtering starts,
normal video may be preserved, so that the effect is slowly shifted in
its place. Similarly, the last video frame may be reconstructed at the
end. Alternatively it is possible to just start and end with black.

'`none`{.sample}'

:   Filtering starts immediately and ends when the last frame is
    received.

'`frame`{.sample}'

:   The first frames or the very last frame are kept intact during
    processing.

'`black`{.sample}'

:   Black is padded at the beginning or at the end of filtering.

[]{#tinterlace}

### [39.252 tinterlace](#toc-tinterlace) {#tinterlace .section}

Perform various types of temporal field interlacing.

Frames are counted starting from 1, so the first input frame is
considered odd.

The filter accepts the following options:

`mode`{.sample}

:   Specify the mode of the interlacing. This option can also be
    specified as a value alone. See below for a list of values for this
    option.

    Available values are:

    '`merge, 0`{.sample}'

    :   Move odd frames into the upper field, even into the lower field,
        generating a double height frame at half frame rate.

        ::: example
        ``` example
         ------> time
        Input:
        Frame 1         Frame 2         Frame 3         Frame 4

        11111           22222           33333           44444
        11111           22222           33333           44444
        11111           22222           33333           44444
        11111           22222           33333           44444

        Output:
        11111                           33333
        22222                           44444
        11111                           33333
        22222                           44444
        11111                           33333
        22222                           44444
        11111                           33333
        22222                           44444
        ```
        :::

    '`drop_even, 1`{.sample}'

    :   Only output odd frames, even frames are dropped, generating a
        frame with unchanged height at half frame rate.

        ::: example
        ``` example
         ------> time
        Input:
        Frame 1         Frame 2         Frame 3         Frame 4

        11111           22222           33333           44444
        11111           22222           33333           44444
        11111           22222           33333           44444
        11111           22222           33333           44444

        Output:
        11111                           33333
        11111                           33333
        11111                           33333
        11111                           33333
        ```
        :::

    '`drop_odd, 2`{.sample}'

    :   Only output even frames, odd frames are dropped, generating a
        frame with unchanged height at half frame rate.

        ::: example
        ``` example
         ------> time
        Input:
        Frame 1         Frame 2         Frame 3         Frame 4

        11111           22222           33333           44444
        11111           22222           33333           44444
        11111           22222           33333           44444
        11111           22222           33333           44444

        Output:
                        22222                           44444
                        22222                           44444
                        22222                           44444
                        22222                           44444
        ```
        :::

    '`pad, 3`{.sample}'

    :   Expand each frame to full height, but pad alternate lines with
        black, generating a frame with double height at the same input
        frame rate.

        ::: example
        ``` example
         ------> time
        Input:
        Frame 1         Frame 2         Frame 3         Frame 4

        11111           22222           33333           44444
        11111           22222           33333           44444
        11111           22222           33333           44444
        11111           22222           33333           44444

        Output:
        11111           .....           33333           .....
        .....           22222           .....           44444
        11111           .....           33333           .....
        .....           22222           .....           44444
        11111           .....           33333           .....
        .....           22222           .....           44444
        11111           .....           33333           .....
        .....           22222           .....           44444
        ```
        :::

    '`interleave_top, 4`{.sample}'

    :   Interleave the upper field from odd frames with the lower field
        from even frames, generating a frame with unchanged height at
        half frame rate.

        ::: example
        ``` example
         ------> time
        Input:
        Frame 1         Frame 2         Frame 3         Frame 4

        11111<-         22222           33333<-         44444
        11111           22222<-         33333           44444<-
        11111<-         22222           33333<-         44444
        11111           22222<-         33333           44444<-

        Output:
        11111                           33333
        22222                           44444
        11111                           33333
        22222                           44444
        ```
        :::

    '`interleave_bottom, 5`{.sample}'

    :   Interleave the lower field from odd frames with the upper field
        from even frames, generating a frame with unchanged height at
        half frame rate.

        ::: example
        ``` example
         ------> time
        Input:
        Frame 1         Frame 2         Frame 3         Frame 4

        11111           22222<-         33333           44444<-
        11111<-         22222           33333<-         44444
        11111           22222<-         33333           44444<-
        11111<-         22222           33333<-         44444

        Output:
        22222                           44444
        11111                           33333
        22222                           44444
        11111                           33333
        ```
        :::

    '`interlacex2, 6`{.sample}'

    :   Double frame rate with unchanged height. Frames are inserted
        each containing the second temporal field from the previous
        input frame and the first temporal field from the next input
        frame. This mode relies on the top_field_first flag. Useful for
        interlaced video displays with no field synchronisation.

        ::: example
        ``` example
         ------> time
        Input:
        Frame 1         Frame 2         Frame 3         Frame 4

        11111           22222           33333           44444
         11111           22222           33333           44444
        11111           22222           33333           44444
         11111           22222           33333           44444

        Output:
        11111   22222   22222   33333   33333   44444   44444
         11111   11111   22222   22222   33333   33333   44444
        11111   22222   22222   33333   33333   44444   44444
         11111   11111   22222   22222   33333   33333   44444
        ```
        :::

    '`mergex2, 7`{.sample}'

    :   Move odd frames into the upper field, even into the lower field,
        generating a double height frame at same frame rate.

        ::: example
        ``` example
         ------> time
        Input:
        Frame 1         Frame 2         Frame 3         Frame 4

        11111           22222           33333           44444
        11111           22222           33333           44444
        11111           22222           33333           44444
        11111           22222           33333           44444

        Output:
        11111           33333           33333           55555
        22222           22222           44444           44444
        11111           33333           33333           55555
        22222           22222           44444           44444
        11111           33333           33333           55555
        22222           22222           44444           44444
        11111           33333           33333           55555
        22222           22222           44444           44444
        ```
        :::

    Numeric values are deprecated but are accepted for backward
    compatibility reasons.

    Default mode is `merge`.

`flags`{.sample}

:   Specify flags influencing the filter process.

    Available value for `flags`{.variable} is:

    `low_pass_filter, vlpf`{.sample}

    :   Enable linear vertical low-pass filtering in the filter.
        Vertical low-pass filtering is required when creating an
        interlaced destination from a progressive source which contains
        high-frequency vertical detail. Filtering will reduce interlace
        'twitter' and Moire patterning.

    `complex_filter, cvlpf`{.sample}

    :   Enable complex vertical low-pass filtering. This will slightly
        less reduce interlace 'twitter' and Moire patterning but better
        retain detail and subjective sharpness impression.

    `bypass_il`{.sample}

    :   Bypass already interlaced frames, only adjust the frame rate.

    Vertical low-pass filtering and bypassing already interlaced frames
    can only be enabled for `mode`{.sample} `interleave_top`{.variable}
    and `interleave_bottom`{.variable}.

[]{#tmedian}

### [39.253 tmedian](#toc-tmedian) {#tmedian .section}

Pick median pixels from several successive input video frames.

The filter accepts the following options:

`radius`{.sample}

:   Set radius of median filter. Default is 1. Allowed range is from 1
    to 127.

`planes`{.sample}

:   Set which planes to filter. Default value is `15`, by which all
    planes are processed.

`percentile`{.sample}

:   Set median percentile. Default value is `0.5`. Default value of
    `0.5` will pick always median values, while `0` will pick minimum
    values, and `1` maximum values.

[]{#Commands-147}

#### [39.253.1 Commands](#toc-Commands-147) {#commands-147 .subsection}

This filter supports all above options as [commands](#commands),
excluding option `radius`.

[]{#tmidequalizer}

### [39.254 tmidequalizer](#toc-tmidequalizer) {#tmidequalizer .section}

Apply Temporal Midway Video Equalization effect.

Midway Video Equalization adjusts a sequence of video frames to have the
same histograms, while maintaining their dynamics as much as possible.
It's useful for e.g. matching exposures from a video frames sequence.

This filter accepts the following option:

`radius`{.sample}

:   Set filtering radius. Default is `5`. Allowed range is from 1 to
    127.

`sigma`{.sample}

:   Set filtering sigma. Default is `0.5`. This controls strength of
    filtering. Setting this option to 0 effectively does nothing.

`planes`{.sample}

:   Set which planes to process. Default is `15`, which is all available
    planes.

[]{#tmix}

### [39.255 tmix](#toc-tmix) {#tmix .section}

Mix successive video frames.

A description of the accepted options follows.

`frames`{.sample}

:   The number of successive frames to mix. If unspecified, it defaults
    to 3.

`weights`{.sample}

:   Specify weight of each input video frame. Each weight is separated
    by space. If number of weights is smaller than number of
    `frames`{.variable} last specified weight will be used for all
    remaining unset weights.

`scale`{.sample}

:   Specify scale, if it is set it will be multiplied with sum of each
    weight multiplied with pixel values to give final destination pixel
    value. By default `scale`{.variable} is auto scaled to sum of
    weights.

`planes`{.sample}

:   Set which planes to filter. Default is all. Allowed range is from 0
    to 15.

[]{#Examples-174}

#### [39.255.1 Examples](#toc-Examples-174) {#examples-174 .subsection}

- Average 7 successive frames:

  ::: example
  ``` example
  tmix=frames=7:weights="1 1 1 1 1 1 1"
  ```
  :::
- Apply simple temporal convolution:

  ::: example
  ``` example
  tmix=frames=3:weights="-1 3 -1"
  ```
  :::
- Similar as above but only showing temporal differences:

  ::: example
  ``` example
  tmix=frames=3:weights="-1 2 -1":scale=1
  ```
  :::

[]{#Commands-148}

#### [39.255.2 Commands](#toc-Commands-148) {#commands-148 .subsection}

This filter supports the following commands:

`weights`{.sample}\
`scale`{.sample}\
`planes`{.sample}

:   Syntax is same as option with same name.

[]{#tonemap}[]{#tonemap-1}

### [39.256 tonemap](#toc-tonemap-1) {#tonemap .section}

Tone map colors from different dynamic ranges.

This filter expects data in single precision floating point, as it needs
to operate on (and can output) out-of-range values. Another filter, such
as [zscale](#zscale), is needed to convert the resulting frame to a
usable format.

The tonemapping algorithms implemented only work on linear light, so
input data should be linearized beforehand (and possibly correctly
tagged).

::: example
``` example
ffmpeg -i INPUT -vf zscale=transfer=linear,tonemap=clip,zscale=transfer=bt709,format=yuv420p OUTPUT
```
:::

[]{#Options-123}

#### [39.256.1 Options](#toc-Options-123) {#options-123 .subsection}

The filter accepts the following options.

`tonemap`{.sample}

:   Set the tone map algorithm to use.

    Possible values are:

    `none`{.variable}

    :   Do not apply any tone map, only desaturate overbright pixels.

    `clip`{.variable}

    :   Hard-clip any out-of-range values. Use it for perfect color
        accuracy for in-range values, while distorting out-of-range
        values.

    `linear`{.variable}

    :   Stretch the entire reference gamut to a linear multiple of the
        display.

    `gamma`{.variable}

    :   Fit a logarithmic transfer between the tone curves.

    `reinhard`{.variable}

    :   Preserve overall image brightness with a simple curve, using
        nonlinear contrast, which results in flattening details and
        degrading color accuracy.

    `hable`{.variable}

    :   Preserve both dark and bright details better than
        `reinhard`{.variable}, at the cost of slightly darkening
        everything. Use it when detail preservation is more important
        than color and brightness accuracy.

    `mobius`{.variable}

    :   Smoothly map out-of-range values, while retaining contrast and
        colors for in-range material as much as possible. Use it when
        color accuracy is more important than detail preservation.

    Default is none.

`param`{.sample}

:   Tune the tone mapping algorithm.

    This affects the following algorithms:

    `none`{.variable}

    :   Ignored.

    `linear`{.variable}

    :   Specifies the scale factor to use while stretching. Default to
        1.0.

    `gamma`{.variable}

    :   Specifies the exponent of the function. Default to 1.8.

    `clip`{.variable}

    :   Specify an extra linear coefficient to multiply into the signal
        before clipping. Default to 1.0.

    `reinhard`{.variable}

    :   Specify the local contrast coefficient at the display peak.
        Default to 0.5, which means that in-gamut values will be about
        half as bright as when clipping.

    `hable`{.variable}

    :   Ignored.

    `mobius`{.variable}

    :   Specify the transition point from linear to mobius transform.
        Every value below this point is guaranteed to be mapped 1:1. The
        higher the value, the more accurate the result will be, at the
        cost of losing bright details. Default to 0.3, which due to the
        steep initial slope still preserves in-range colors fairly
        accurately.

`desat`{.sample}

:   Apply desaturation for highlights that exceed this level of
    brightness. The higher the parameter, the more color information
    will be preserved. This setting helps prevent unnaturally blown-out
    colors for super-highlights, by (smoothly) turning into white
    instead. This makes images feel more natural, at the cost of
    reducing information about out-of-range colors.

    The default of 2.0 is somewhat conservative and will mostly just
    apply to skies or directly sunlit surfaces. A setting of 0.0
    disables this option.

    This option works only if the input frame has a supported color tag.

`peak`{.sample}

:   Override signal/nominal/reference peak with this value. Useful when
    the embedded peak information in display metadata is not reliable or
    when tone mapping from a lower range to a higher range.

[]{#tpad}

### [39.257 tpad](#toc-tpad) {#tpad .section}

Temporarily pad video frames.

The filter accepts the following options:

`start`{.sample}

:   Specify number of delay frames before input video stream. Default is
    0.

`stop`{.sample}

:   Specify number of padding frames after input video stream. Set to -1
    to pad indefinitely. Default is 0.

`start_mode`{.sample}

:   Set kind of frames added to beginning of stream. Can be either
    `add`{.variable} or `clone`{.variable}. With `add`{.variable} frames
    of solid-color are added. With `clone`{.variable} frames are clones
    of first frame. Default is `add`{.variable}.

`stop_mode`{.sample}

:   Set kind of frames added to end of stream. Can be either
    `add`{.variable} or `clone`{.variable}. With `add`{.variable} frames
    of solid-color are added. With `clone`{.variable} frames are clones
    of last frame. Default is `add`{.variable}.

`start_duration, stop_duration`{.sample}

:   Specify the duration of the start/stop delay. See [(ffmpeg-utils)the
    Time duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax) for the accepted
    syntax. These options override `start`{.variable} and
    `stop`{.variable}. Default is 0.

`color`{.sample}

:   Specify the color of the padded area. For the syntax of this option,
    check the [(ffmpeg-utils)\"Color\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#color-syntax).

    The default value of `color`{.variable} is \"black\".

[]{#transpose}[]{#transpose-1}

### [39.258 transpose](#toc-transpose-1) {#transpose .section}

Transpose rows with columns in the input video and optionally flip it.

It accepts the following parameters:

`dir`{.sample}

:   Specify the transposition direction.

    Can assume the following values:

    '`0, 4, cclock_flip`{.sample}'

    :   Rotate by 90 degrees counterclockwise and vertically flip
        (default), that is:

        ::: example
        ``` example
        L.R     L.l
        . . ->  . .
        l.r     R.r
        ```
        :::

    '`1, 5, clock`{.sample}'

    :   Rotate by 90 degrees clockwise, that is:

        ::: example
        ``` example
        L.R     l.L
        . . ->  . .
        l.r     r.R
        ```
        :::

    '`2, 6, cclock`{.sample}'

    :   Rotate by 90 degrees counterclockwise, that is:

        ::: example
        ``` example
        L.R     R.r
        . . ->  . .
        l.r     L.l
        ```
        :::

    '`3, 7, clock_flip`{.sample}'

    :   Rotate by 90 degrees clockwise and vertically flip, that is:

        ::: example
        ``` example
        L.R     r.R
        . . ->  . .
        l.r     l.L
        ```
        :::

    For values between 4-7, the transposition is only done if the input
    video geometry is portrait and not landscape. These values are
    deprecated, the `passthrough` option should be used instead.

    Numerical values are deprecated, and should be dropped in favor of
    symbolic constants.

`passthrough`{.sample}

:   Do not apply the transposition if the input geometry matches the one
    specified by the specified value. It accepts the following values:

    '`none`{.sample}'

    :   Always apply transposition.

    '`portrait`{.sample}'

    :   Preserve portrait geometry (when `height`{.variable} \>=
        `width`{.variable}).

    '`landscape`{.sample}'

    :   Preserve landscape geometry (when `width`{.variable} \>=
        `height`{.variable}).

    Default value is `none`.

For example to rotate by 90 degrees clockwise and preserve portrait
layout:

::: example
``` example
transpose=dir=1:passthrough=portrait
```
:::

The command above can also be specified as:

::: example
``` example
transpose=1:portrait
```
:::

[]{#trim}

### [39.259 trim](#toc-trim) {#trim .section}

Trim the input so that the output contains one continuous subpart of the
input.

It accepts the following parameters:

`start`{.sample}

:   Specify the time of the start of the kept section, i.e. the frame
    with the timestamp `start`{.variable} will be the first frame in the
    output.

`end`{.sample}

:   Specify the time of the first frame that will be dropped, i.e. the
    frame immediately preceding the one with the timestamp
    `end`{.variable} will be the last frame in the output.

`start_pts`{.sample}

:   This is the same as `start`{.variable}, except this option sets the
    start timestamp in timebase units instead of seconds.

`end_pts`{.sample}

:   This is the same as `end`{.variable}, except this option sets the
    end timestamp in timebase units instead of seconds.

`duration`{.sample}

:   The maximum duration of the output in seconds.

`start_frame`{.sample}

:   The number of the first frame that should be passed to the output.

`end_frame`{.sample}

:   The number of the first frame that should be dropped.

`start`{.sample}, `end`{.sample}, and `duration`{.sample} are expressed
as time duration specifications; see [(ffmpeg-utils)the Time duration
section in the ffmpeg-utils(1)
manual](ffmpeg-utils.html#time-duration-syntax) for the accepted syntax.

Note that the first two sets of the start/end options and the
`duration`{.sample} option look at the frame timestamp, while the
\_frame variants simply count the frames that pass through the filter.
Also note that this filter does not modify the timestamps. If you wish
for the output timestamps to start at zero, insert a setpts filter after
the trim filter.

If multiple start or end options are set, this filter tries to be greedy
and keep all the frames that match at least one of the specified
constraints. To keep only the part that matches all the constraints at
once, chain multiple trim filters.

The defaults are such that all the input is kept. So it is possible to
set e.g. just the end values to keep everything before the specified
time.

Examples:

- Drop everything except the second minute of input:

  ::: example
  ``` example
  ffmpeg -i INPUT -vf trim=60:120
  ```
  :::
- Keep only the first second:

  ::: example
  ``` example
  ffmpeg -i INPUT -vf trim=duration=1
  ```
  :::

[]{#unpremultiply}

### [39.260 unpremultiply](#toc-unpremultiply) {#unpremultiply .section}

Apply alpha unpremultiply effect to input video stream using first plane
of second stream as alpha.

Both streams must have same dimensions and same pixel format.

The filter accepts the following option:

`planes`{.sample}

:   Set which planes will be processed, unprocessed planes will be
    copied. By default value 0xf, all planes will be processed.

    If the format has 1 or 2 components, then luma is bit 0. If the
    format has 3 or 4 components: for RGB formats bit 0 is green, bit 1
    is blue and bit 2 is red; for YUV formats bit 0 is luma, bit 1 is
    chroma-U and bit 2 is chroma-V. If present, the alpha channel is
    always the last bit.

`inplace`{.sample}

:   Do not require 2nd input for processing, instead use alpha plane
    from input stream.

[]{#unsharp}[]{#unsharp-1}

### [39.261 unsharp](#toc-unsharp-1) {#unsharp .section}

Sharpen or blur the input video.

It accepts the following parameters:

`luma_msize_x, lx`{.sample}

:   Set the luma matrix horizontal size. It must be an odd integer
    between 3 and 23. The default value is 5.

`luma_msize_y, ly`{.sample}

:   Set the luma matrix vertical size. It must be an odd integer between
    3 and 23. The default value is 5.

`luma_amount, la`{.sample}

:   Set the luma effect strength. It must be a floating point number,
    reasonable values lay between -1.5 and 1.5.

    Negative values will blur the input video, while positive values
    will sharpen it, a value of zero will disable the effect.

    Default value is 1.0.

`chroma_msize_x, cx`{.sample}

:   Set the chroma matrix horizontal size. It must be an odd integer
    between 3 and 23. The default value is 5.

`chroma_msize_y, cy`{.sample}

:   Set the chroma matrix vertical size. It must be an odd integer
    between 3 and 23. The default value is 5.

`chroma_amount, ca`{.sample}

:   Set the chroma effect strength. It must be a floating point number,
    reasonable values lay between -1.5 and 1.5.

    Negative values will blur the input video, while positive values
    will sharpen it, a value of zero will disable the effect.

    Default value is 0.0.

`alpha_msize_x, ax`{.sample}

:   Set the alpha matrix horizontal size. It must be an odd integer
    between 3 and 23. The default value is 5.

`alpha_msize_y, ay`{.sample}

:   Set the alpha matrix vertical size. It must be an odd integer
    between 3 and 23. The default value is 5.

`alpha_amount, aa`{.sample}

:   Set the alpha effect strength. It must be a floating point number,
    reasonable values lay between -1.5 and 1.5.

    Negative values will blur the input video, while positive values
    will sharpen it, a value of zero will disable the effect.

    Default value is 0.0.

All parameters are optional and default to the equivalent of the string
'5:5:1.0:5:5:0.0'.

[]{#Examples-175}

#### [39.261.1 Examples](#toc-Examples-175) {#examples-175 .subsection}

- Apply strong luma sharpen effect:

  ::: example
  ``` example
  unsharp=luma_msize_x=7:luma_msize_y=7:luma_amount=2.5
  ```
  :::
- Apply a strong blur of both luma and chroma parameters:

  ::: example
  ``` example
  unsharp=7:7:-2:7:7:-2
  ```
  :::

[]{#untile}[]{#untile-1}

### [39.262 untile](#toc-untile-1) {#untile .section}

Decompose a video made of tiled images into the individual images.

The frame rate of the output video is the frame rate of the input video
multiplied by the number of tiles.

This filter does the reverse of [tile](#tile).

The filter accepts the following options:

`layout`{.sample}

:   Set the grid size (i.e. the number of lines and columns). For the
    syntax of this option, check the [(ffmpeg-utils)\"Video size\"
    section in the ffmpeg-utils
    manual](ffmpeg-utils.html#video-size-syntax).

[]{#Examples-176}

#### [39.262.1 Examples](#toc-Examples-176) {#examples-176 .subsection}

- Produce a 1-second video from a still image file made of 25 frames
  stacked vertically, like an analogic film reel:

  ::: example
  ``` example
  ffmpeg -r 1 -i image.jpg -vf untile=1x25 movie.mkv
  ```
  :::

[]{#uspp}

### [39.263 uspp](#toc-uspp) {#uspp .section}

Apply ultra slow/simple postprocessing filter that compresses and
decompresses the image at several (or - in the case of
`quality`{.sample} level `8` - all) shifts and average the results.

The way this differs from the behavior of spp is that uspp actually
encodes & decodes each case with libavcodec Snow, whereas spp uses a
simplified intra only 8x8 DCT similar to MJPEG.

This filter is not available in ffmpeg versions between 5.0 and 6.0.

The filter accepts the following options:

`quality`{.sample}

:   Set quality. This option defines the number of levels for averaging.
    It accepts an integer in the range 0-8. If set to `0`, the filter
    will have no effect. A value of `8` means the higher quality. For
    each increment of that value the speed drops by a factor of
    approximately 2. Default value is `3`.

`qp`{.sample}

:   Force a constant quantization parameter. If not set, the filter will
    use the QP from the video stream (if available).

`codec`{.sample}

:   Use specified codec instead of snow.

[]{#v360}

### [39.264 v360](#toc-v360) {#v360 .section}

Convert 360 videos between various formats.

The filter accepts the following options:

`input`{.sample}\
`output`{.sample}

:   Set format of the input/output video.

    Available formats:

    '`e`{.sample}'\
    '`equirect`{.sample}'

    :   Equirectangular projection.

    '`c3x2`{.sample}'\
    '`c6x1`{.sample}'\
    '`c1x6`{.sample}'

    :   Cubemap with 3x2/6x1/1x6 layout.

        Format specific options:

        `in_pad`{.sample}\
        `out_pad`{.sample}

        :   Set padding proportion for the input/output cubemap. Values
            in decimals.

            Example values:

            '`0`{.sample}'

            :   No padding.

            '`0.01`{.sample}'

            :   1% of face is padding. For example, with 1920x1280
                resolution face size would be 640x640 and padding would
                be 3 pixels from each side. (640 \* 0.01 = 6 pixels)

            Default value is **'`0`{.sample}'**. Maximum value is
            **'`0.1`{.sample}'**.

        `fin_pad`{.sample}\
        `fout_pad`{.sample}

        :   Set fixed padding for the input/output cubemap. Values in
            pixels.

            Default value is **'`0`{.sample}'**. If greater than zero it
            overrides other padding options.

        `in_forder`{.sample}\
        `out_forder`{.sample}

        :   Set order of faces for the input/output cubemap. Choose one
            direction for each position.

            Designation of directions:

            '`r`{.sample}'

            :   right

            '`l`{.sample}'

            :   left

            '`u`{.sample}'

            :   up

            '`d`{.sample}'

            :   down

            '`f`{.sample}'

            :   forward

            '`b`{.sample}'

            :   back

            Default value is **'`rludfb`{.sample}'**.

        `in_frot`{.sample}\
        `out_frot`{.sample}

        :   Set rotation of faces for the input/output cubemap. Choose
            one angle for each position.

            Designation of angles:

            '`0`{.sample}'

            :   0 degrees clockwise

            '`1`{.sample}'

            :   90 degrees clockwise

            '`2`{.sample}'

            :   180 degrees clockwise

            '`3`{.sample}'

            :   270 degrees clockwise

            Default value is **'`000000`{.sample}'**.

    '`eac`{.sample}'

    :   Equi-Angular Cubemap.

    '`flat`{.sample}'\
    '`gnomonic`{.sample}'\
    '`rectilinear`{.sample}'

    :   Regular video.

        Format specific options:

        `h_fov`{.sample}\
        `v_fov`{.sample}\
        `d_fov`{.sample}

        :   Set output horizontal/vertical/diagonal field of view.
            Values in degrees.

            If diagonal field of view is set it overrides horizontal and
            vertical field of view.

        `ih_fov`{.sample}\
        `iv_fov`{.sample}\
        `id_fov`{.sample}

        :   Set input horizontal/vertical/diagonal field of view. Values
            in degrees.

            If diagonal field of view is set it overrides horizontal and
            vertical field of view.

    '`dfisheye`{.sample}'

    :   Dual fisheye.

        Format specific options:

        `h_fov`{.sample}\
        `v_fov`{.sample}\
        `d_fov`{.sample}

        :   Set output horizontal/vertical/diagonal field of view.
            Values in degrees.

            If diagonal field of view is set it overrides horizontal and
            vertical field of view.

        `ih_fov`{.sample}\
        `iv_fov`{.sample}\
        `id_fov`{.sample}

        :   Set input horizontal/vertical/diagonal field of view. Values
            in degrees.

            If diagonal field of view is set it overrides horizontal and
            vertical field of view.

    '`barrel`{.sample}'\
    '`fb`{.sample}'\
    '`barrelsplit`{.sample}'

    :   Facebook's 360 formats.

    '`sg`{.sample}'

    :   Stereographic format.

        Format specific options:

        `h_fov`{.sample}\
        `v_fov`{.sample}\
        `d_fov`{.sample}

        :   Set output horizontal/vertical/diagonal field of view.
            Values in degrees.

            If diagonal field of view is set it overrides horizontal and
            vertical field of view.

        `ih_fov`{.sample}\
        `iv_fov`{.sample}\
        `id_fov`{.sample}

        :   Set input horizontal/vertical/diagonal field of view. Values
            in degrees.

            If diagonal field of view is set it overrides horizontal and
            vertical field of view.

    '`mercator`{.sample}'

    :   Mercator format.

    '`ball`{.sample}'

    :   Ball format, gives significant distortion toward the back.

    '`hammer`{.sample}'

    :   Hammer-Aitoff map projection format.

    '`sinusoidal`{.sample}'

    :   Sinusoidal map projection format.

    '`fisheye`{.sample}'

    :   Fisheye projection.

        Format specific options:

        `h_fov`{.sample}\
        `v_fov`{.sample}\
        `d_fov`{.sample}

        :   Set output horizontal/vertical/diagonal field of view.
            Values in degrees.

            If diagonal field of view is set it overrides horizontal and
            vertical field of view.

        `ih_fov`{.sample}\
        `iv_fov`{.sample}\
        `id_fov`{.sample}

        :   Set input horizontal/vertical/diagonal field of view. Values
            in degrees.

            If diagonal field of view is set it overrides horizontal and
            vertical field of view.

    '`pannini`{.sample}'

    :   Pannini projection.

        Format specific options:

        `h_fov`{.sample}

        :   Set output pannini parameter.

        `ih_fov`{.sample}

        :   Set input pannini parameter.

    '`cylindrical`{.sample}'

    :   Cylindrical projection.

        Format specific options:

        `h_fov`{.sample}\
        `v_fov`{.sample}\
        `d_fov`{.sample}

        :   Set output horizontal/vertical/diagonal field of view.
            Values in degrees.

            If diagonal field of view is set it overrides horizontal and
            vertical field of view.

        `ih_fov`{.sample}\
        `iv_fov`{.sample}\
        `id_fov`{.sample}

        :   Set input horizontal/vertical/diagonal field of view. Values
            in degrees.

            If diagonal field of view is set it overrides horizontal and
            vertical field of view.

    '`perspective`{.sample}'

    :   Perspective projection. *(output only)*

        Format specific options:

        `v_fov`{.sample}

        :   Set perspective parameter.

    '`tetrahedron`{.sample}'

    :   Tetrahedron projection.

    '`tsp`{.sample}'

    :   Truncated square pyramid projection.

    '`he`{.sample}'\
    '`hequirect`{.sample}'

    :   Half equirectangular projection.

    '`equisolid`{.sample}'

    :   Equisolid format.

        Format specific options:

        `h_fov`{.sample}\
        `v_fov`{.sample}\
        `d_fov`{.sample}

        :   Set output horizontal/vertical/diagonal field of view.
            Values in degrees.

            If diagonal field of view is set it overrides horizontal and
            vertical field of view.

        `ih_fov`{.sample}\
        `iv_fov`{.sample}\
        `id_fov`{.sample}

        :   Set input horizontal/vertical/diagonal field of view. Values
            in degrees.

            If diagonal field of view is set it overrides horizontal and
            vertical field of view.

    '`og`{.sample}'

    :   Orthographic format.

        Format specific options:

        `h_fov`{.sample}\
        `v_fov`{.sample}\
        `d_fov`{.sample}

        :   Set output horizontal/vertical/diagonal field of view.
            Values in degrees.

            If diagonal field of view is set it overrides horizontal and
            vertical field of view.

        `ih_fov`{.sample}\
        `iv_fov`{.sample}\
        `id_fov`{.sample}

        :   Set input horizontal/vertical/diagonal field of view. Values
            in degrees.

            If diagonal field of view is set it overrides horizontal and
            vertical field of view.

    '`octahedron`{.sample}'

    :   Octahedron projection.

    '`cylindricalea`{.sample}'

    :   Cylindrical Equal Area projection.

`interp`{.sample}

:   Set interpolation method.\
    *Note: more complex interpolation methods require much more memory
    to run.*

    Available methods:

    '`near`{.sample}'\
    '`nearest`{.sample}'

    :   Nearest neighbour.

    '`line`{.sample}'\
    '`linear`{.sample}'

    :   Bilinear interpolation.

    '`lagrange9`{.sample}'

    :   Lagrange9 interpolation.

    '`cube`{.sample}'\
    '`cubic`{.sample}'

    :   Bicubic interpolation.

    '`lanc`{.sample}'\
    '`lanczos`{.sample}'

    :   Lanczos interpolation.

    '`sp16`{.sample}'\
    '`spline16`{.sample}'

    :   Spline16 interpolation.

    '`gauss`{.sample}'\
    '`gaussian`{.sample}'

    :   Gaussian interpolation.

    '`mitchell`{.sample}'

    :   Mitchell interpolation.

    Default value is **'`line`{.sample}'**.

`w`{.sample}\
`h`{.sample}

:   Set the output video resolution.

    Default resolution depends on formats.

`in_stereo`{.sample}\
`out_stereo`{.sample}

:   Set the input/output stereo format.

    '`2d`{.sample}'

    :   2D mono

    '`sbs`{.sample}'

    :   Side by side

    '`tb`{.sample}'

    :   Top bottom

    Default value is **'`2d`{.sample}'** for input and output format.

`yaw`{.sample}\
`pitch`{.sample}\
`roll`{.sample}

:   Set rotation for the output video. Values in degrees.

`rorder`{.sample}

:   Set rotation order for the output video. Choose one item for each
    position.

    '`y, Y`{.sample}'

    :   yaw

    '`p, P`{.sample}'

    :   pitch

    '`r, R`{.sample}'

    :   roll

    Default value is **'`ypr`{.sample}'**.

`h_flip`{.sample}\
`v_flip`{.sample}\
`d_flip`{.sample}

:   Flip the output video horizontally(swaps
    left-right)/vertically(swaps up-down)/in-depth(swaps back-forward).
    Boolean values.

`ih_flip`{.sample}\
`iv_flip`{.sample}

:   Set if input video is flipped horizontally/vertically. Boolean
    values.

`in_trans`{.sample}

:   Set if input video is transposed. Boolean value, by default
    disabled.

`out_trans`{.sample}

:   Set if output video needs to be transposed. Boolean value, by
    default disabled.

`h_offset`{.sample}\
`v_offset`{.sample}

:   Set output horizontal/vertical off-axis offset. Default is set to 0.
    Allowed range is from -1 to 1.

`alpha_mask`{.sample}

:   Build mask in alpha plane for all unmapped pixels by marking them
    fully transparent. Boolean value, by default disabled.

`reset_rot`{.sample}

:   Reset rotation of output video. Boolean value, by default disabled.

[]{#Examples-177}

#### [39.264.1 Examples](#toc-Examples-177) {#examples-177 .subsection}

- Convert equirectangular video to cubemap with 3x2 layout and 1%
  padding using bicubic interpolation:

  ::: example
  ``` example
  ffmpeg -i input.mkv -vf v360=e:c3x2:cubic:out_pad=0.01 output.mkv
  ```
  :::
- Extract back view of Equi-Angular Cubemap:

  ::: example
  ``` example
  ffmpeg -i input.mkv -vf v360=eac:flat:yaw=180 output.mkv
  ```
  :::
- Convert transposed and horizontally flipped Equi-Angular Cubemap in
  side-by-side stereo format to equirectangular top-bottom stereo
  format:

  ::: example
  ``` example
  v360=eac:equirect:in_stereo=sbs:in_trans=1:ih_flip=1:out_stereo=tb
  ```
  :::

[]{#Commands-149}

#### [39.264.2 Commands](#toc-Commands-149) {#commands-149 .subsection}

This filter supports subset of above options as [commands](#commands).

[]{#vaguedenoiser}

### [39.265 vaguedenoiser](#toc-vaguedenoiser) {#vaguedenoiser .section}

Apply a wavelet based denoiser.

It transforms each frame from the video input into the wavelet domain,
using Cohen-Daubechies-Feauveau 9/7. Then it applies some filtering to
the obtained coefficients. It does an inverse wavelet transform after.
Due to wavelet properties, it should give a nice smoothed result, and
reduced noise, without blurring picture features.

This filter accepts the following options:

`threshold`{.sample}

:   The filtering strength. The higher, the more filtered the video will
    be. Hard thresholding can use a higher threshold than soft
    thresholding before the video looks overfiltered. Default value is
    2.

`method`{.sample}

:   The filtering method the filter will use.

    It accepts the following values:

    '`hard`{.sample}'

    :   All values under the threshold will be zeroed.

    '`soft`{.sample}'

    :   All values under the threshold will be zeroed. All values above
        will be reduced by the threshold.

    '`garrote`{.sample}'

    :   Scales or nullifies coefficients - intermediary between (more)
        soft and (less) hard thresholding.

    Default is garrote.

`nsteps`{.sample}

:   Number of times, the wavelet will decompose the picture. Picture
    can't be decomposed beyond a particular point (typically, 8 for a
    640x480 frame - as 2\^9 = 512 \> 480). Valid values are integers
    between 1 and 32. Default value is 6.

`percent`{.sample}

:   Partial of full denoising (limited coefficients shrinking), from 0
    to 100. Default value is 85.

`planes`{.sample}

:   A list of the planes to process. By default all planes are
    processed.

`type`{.sample}

:   The threshold type the filter will use.

    It accepts the following values:

    '`universal`{.sample}'

    :   Threshold used is same for all decompositions.

    '`bayes`{.sample}'

    :   Threshold used depends also on each decomposition coefficients.

    Default is universal.

[]{#varblur}

### [39.266 varblur](#toc-varblur) {#varblur .section}

Apply variable blur filter by using 2nd video stream to set blur radius.
The 2nd stream must have the same dimensions.

This filter accepts the following options:

`min_r`{.sample}

:   Set min allowed radius. Allowed range is from 0 to 254. Default is
    0.

`max_r`{.sample}

:   Set max allowed radius. Allowed range is from 1 to 255. Default is
    8.

`planes`{.sample}

:   Set which planes to process. By default, all are used.

The `varblur` filter also supports the [framesync](#framesync) options.

[]{#Commands-150}

#### [39.266.1 Commands](#toc-Commands-150) {#commands-150 .subsection}

This filter supports all the above options as [commands](#commands).

[]{#vectorscope}

### [39.267 vectorscope](#toc-vectorscope) {#vectorscope .section}

Display 2 color component values in the two dimensional graph (which is
called a vectorscope).

This filter accepts the following options:

`mode, m`{.sample}

Set vectorscope mode.

It accepts the following values:

'`gray`{.sample}'\
'`tint`{.sample}'

:   Gray values are displayed on graph, higher brightness means more
    pixels have same component color value on location in graph. This is
    the default mode.

'`color`{.sample}'

:   Gray values are displayed on graph. Surrounding pixels values which
    are not present in video frame are drawn in gradient of 2 color
    components which are set by option `x` and `y`. The 3rd color
    component is static.

'`color2`{.sample}'

:   Actual color components values present in video frame are displayed
    on graph.

'`color3`{.sample}'

:   Similar as color2 but higher frequency of same values `x` and `y` on
    graph increases value of another color component, which is luminance
    by default values of `x` and `y`.

'`color4`{.sample}'

:   Actual colors present in video frame are displayed on graph. If two
    different colors map to same position on graph then color with
    higher value of component not present in graph is picked.

'`color5`{.sample}'

:   Gray values are displayed on graph. Similar to `color` but with 3rd
    color component picked from radial gradient.

`x`{.sample}

Set which color component will be represented on X-axis. Default is `1`.

`y`{.sample}

Set which color component will be represented on Y-axis. Default is `2`.

`intensity, i`{.sample}

Set intensity, used by modes: gray, color, color3 and color5 for
increasing brightness of color component which represents frequency of
(X, Y) location in graph.

`envelope, e`{.sample}

'`none`{.sample}'

:   No envelope, this is default.

'`instant`{.sample}'

:   Instant envelope, even darkest single pixel will be clearly
    highlighted.

'`peak`{.sample}'

:   Hold maximum and minimum values presented in graph over time. This
    way you can still spot out of range values without constantly
    looking at vectorscope.

'`peak+instant`{.sample}'

:   Peak and instant envelope combined together.

`graticule, g`{.sample}

Set what kind of graticule to draw.

'`none`{.sample}'

'`green`{.sample}'

'`color`{.sample}'

'`invert`{.sample}'

`opacity, o`{.sample}

Set graticule opacity.

`flags, f`{.sample}

Set graticule flags.

'`white`{.sample}'

:   Draw graticule for white point.

'`black`{.sample}'

:   Draw graticule for black point.

'`name`{.sample}'

:   Draw color points short names.

`bgopacity, b`{.sample}

Set background opacity.

`lthreshold, l`{.sample}

Set low threshold for color component not represented on X or Y axis.
Values lower than this value will be ignored. Default is 0. Note this
value is multiplied with actual max possible value one pixel component
can have. So for 8-bit input and low threshold value of 0.1 actual
threshold is 0.1 \* 255 = 25.

`hthreshold, h`{.sample}

Set high threshold for color component not represented on X or Y axis.
Values higher than this value will be ignored. Default is 1. Note this
value is multiplied with actual max possible value one pixel component
can have. So for 8-bit input and high threshold value of 0.9 actual
threshold is 0.9 \* 255 = 230.

`colorspace, c`{.sample}

Set what kind of colorspace to use when drawing graticule.

'`auto`{.sample}'

'`601`{.sample}'

'`709`{.sample}'

Default is auto.

`tint0, t0`{.sample}

`tint1, t1`{.sample}

Set color tint for gray/tint vectorscope mode. By default both options
are zero. This means no tint, and output will remain gray.

[]{#vidstabdetect}[]{#vidstabdetect-1}

### [39.268 vidstabdetect](#toc-vidstabdetect-1) {#vidstabdetect .section}

Analyze video stabilization/deshaking. Perform pass 1 of 2, see
[vidstabtransform](#vidstabtransform) for pass 2.

This filter generates a file with relative translation and rotation
transform information about subsequent frames, which is then used by the
[vidstabtransform](#vidstabtransform) filter.

To enable compilation of this filter you need to configure FFmpeg with
`--enable-libvidstab`.

This filter accepts the following options:

`result`{.sample}

:   Set the path to the file used to write the transforms information.
    Default value is `transforms.trf`{.sample}.

`shakiness`{.sample}

:   Set how shaky the video is and how quick the camera is. It accepts
    an integer in the range 1-10, a value of 1 means little shakiness, a
    value of 10 means strong shakiness. Default value is 5.

`accuracy`{.sample}

:   Set the accuracy of the detection process. It must be a value in the
    range 1-15. A value of 1 means low accuracy, a value of 15 means
    high accuracy. Default value is 15.

`stepsize`{.sample}

:   Set stepsize of the search process. The region around minimum is
    scanned with 1 pixel resolution. Default value is 6.

`mincontrast`{.sample}

:   Set minimum contrast. Below this value a local measurement field is
    discarded. Must be a floating point value in the range 0-1. Default
    value is 0.3.

`tripod`{.sample}

:   Set reference frame number for tripod mode.

    If enabled, the motion of the frames is compared to a reference
    frame in the filtered stream, identified by the specified number.
    The idea is to compensate all movements in a more-or-less static
    scene and keep the camera view absolutely still.

    If set to 0, it is disabled. The frames are counted starting from 1.

`show`{.sample}

:   Show fields and transforms in the resulting frames. It accepts an
    integer in the range 0-2. Default value is 0, which disables any
    visualization.

`fileformat`{.sample}

:   Format for the transforms data file to be written. Acceptable values
    are

    '`ascii`{.sample}'

    :   Human-readable plain text

    '`binary`{.sample}'

    :   Binary format, roughly 40% smaller than `ascii`. (*default*)

[]{#Examples-178}

#### [39.268.1 Examples](#toc-Examples-178) {#examples-178 .subsection}

- Use default values:

  ::: example
  ``` example
  vidstabdetect
  ```
  :::
- Analyze strongly shaky movie and put the results in file
  `mytransforms.trf`{.sample}:

  ::: example
  ``` example
  vidstabdetect=shakiness=10:accuracy=15:result="mytransforms.trf"
  ```
  :::
- Visualize the result of internal transformations in the resulting
  video:

  ::: example
  ``` example
  vidstabdetect=show=1
  ```
  :::
- Analyze a video with medium shakiness using `ffmpeg`:

  ::: example
  ``` example
  ffmpeg -i input -vf vidstabdetect=shakiness=5:show=1 dummy.avi
  ```
  :::

[]{#vidstabtransform}[]{#vidstabtransform-1}

### [39.269 vidstabtransform](#toc-vidstabtransform-1) {#vidstabtransform .section}

Video stabilization/deshaking: pass 2 of 2, see
[vidstabdetect](#vidstabdetect) for pass 1.

Read a file with transform information for each frame and
apply/compensate them. Together with the [vidstabdetect](#vidstabdetect)
filter this can be used to deshake videos. See also
<http://public.hronopik.de/vid.stab>. It is important to also use the
[unsharp](#unsharp) filter, see below.

To enable compilation of this filter you need to configure FFmpeg with
`--enable-libvidstab`.

[]{#Options-124}

#### [39.269.1 Options](#toc-Options-124) {#options-124 .subsection}

`input`{.sample}

:   Set path to the file used to read the transforms. Default value is
    `transforms.trf`{.sample}.

`smoothing`{.sample}

:   Set the number of frames (value\*2 + 1) used for lowpass filtering
    the camera movements. Default value is 10.

    For example a number of 10 means that 21 frames are used (10 in the
    past and 10 in the future) to smoothen the motion in the video. A
    larger value leads to a smoother video, but limits the acceleration
    of the camera (pan/tilt movements). 0 is a special case where a
    static camera is simulated.

`optalgo`{.sample}

:   Set the camera path optimization algorithm.

    Accepted values are:

    '`gauss`{.sample}'

    :   gaussian kernel low-pass filter on camera motion (default)

    '`avg`{.sample}'

    :   averaging on transformations

`maxshift`{.sample}

:   Set maximal number of pixels to translate frames. Default value is
    -1, meaning no limit.

`maxangle`{.sample}

:   Set maximal angle in radians (degree\*PI/180) to rotate frames.
    Default value is -1, meaning no limit.

`crop`{.sample}

:   Specify how to deal with borders that may be visible due to movement
    compensation.

    Available values are:

    '`keep`{.sample}'

    :   keep image information from previous frame (default)

    '`black`{.sample}'

    :   fill the border black

`invert`{.sample}

:   Invert transforms if set to 1. Default value is 0.

`relative`{.sample}

:   Consider transforms as relative to previous frame if set to 1,
    absolute if set to 0. Default value is 0.

`zoom`{.sample}

:   Set percentage to zoom. A positive value will result in a zoom-in
    effect, a negative value in a zoom-out effect. Default value is 0
    (no zoom).

`optzoom`{.sample}

:   Set optimal zooming to avoid borders.

    Accepted values are:

    '`0`{.sample}'

    :   disabled

    '`1`{.sample}'

    :   optimal static zoom value is determined (only very strong
        movements will lead to visible borders) (default)

    '`2`{.sample}'

    :   optimal adaptive zoom value is determined (no borders will be
        visible), see `zoomspeed`{.sample}

    Note that the value given at zoom is added to the one calculated
    here.

`zoomspeed`{.sample}

:   Set percent to zoom maximally each frame (enabled when
    `optzoom`{.sample} is set to 2). Range is from 0 to 5, default value
    is 0.25.

`interpol`{.sample}

:   Specify type of interpolation.

    Available values are:

    '`no`{.sample}'

    :   no interpolation

    '`linear`{.sample}'

    :   linear only horizontal

    '`bilinear`{.sample}'

    :   linear in both directions (default)

    '`bicubic`{.sample}'

    :   cubic in both directions (slow)

`tripod`{.sample}

:   Enable virtual tripod mode if set to 1, which is equivalent to
    `relative=0:smoothing=0`. Default value is 0.

    Use also `tripod` option of [vidstabdetect](#vidstabdetect).

`debug`{.sample}

:   Increase log verbosity if set to 1. Also the detected global motions
    are written to the temporary file `global_motions.trf`{.sample}.
    Default value is 0.

[]{#Examples-179}

#### [39.269.2 Examples](#toc-Examples-179) {#examples-179 .subsection}

- Use `ffmpeg` for a typical stabilization with default values:

  ::: example
  ``` example
  ffmpeg -i inp.mpeg -vf vidstabtransform,unsharp=5:5:0.8:3:3:0.4 inp_stabilized.mpeg
  ```
  :::

  Note the use of the [unsharp](#unsharp) filter which is always
  recommended.

- Zoom in a bit more and load transform data from a given file:

  ::: example
  ``` example
  vidstabtransform=zoom=5:input="mytransforms.trf"
  ```
  :::

- Smoothen the video even more:

  ::: example
  ``` example
  vidstabtransform=smoothing=30
  ```
  :::

[]{#vflip}

### [39.270 vflip](#toc-vflip) {#vflip .section}

Flip the input video vertically.

For example, to vertically flip a video with `ffmpeg`:

::: example
``` example
ffmpeg -i in.avi -vf "vflip" out.avi
```
:::

[]{#vfrdet}

### [39.271 vfrdet](#toc-vfrdet) {#vfrdet .section}

Detect variable frame rate video.

This filter tries to detect if the input is variable or constant frame
rate.

At end it will output number of frames detected as having variable delta
pts, and ones with constant delta pts. If there was frames with variable
delta, than it will also show min, max and average delta encountered.

[]{#vibrance}

### [39.272 vibrance](#toc-vibrance) {#vibrance .section}

Boost or alter saturation.

The filter accepts the following options:

`intensity`{.sample}

:   Set strength of boost if positive value or strength of alter if
    negative value. Default is 0. Allowed range is from -2 to 2.

`rbal`{.sample}

:   Set the red balance. Default is 1. Allowed range is from -10 to 10.

`gbal`{.sample}

:   Set the green balance. Default is 1. Allowed range is from -10 to
    10.

`bbal`{.sample}

:   Set the blue balance. Default is 1. Allowed range is from -10 to 10.

`rlum`{.sample}

:   Set the red luma coefficient.

`glum`{.sample}

:   Set the green luma coefficient.

`blum`{.sample}

:   Set the blue luma coefficient.

`alternate`{.sample}

:   If `intensity` is negative and this is set to 1, colors will change,
    otherwise colors will be less saturated, more towards gray.

[]{#Commands-151}

#### [39.272.1 Commands](#toc-Commands-151) {#commands-151 .subsection}

This filter supports the all above options as [commands](#commands).

[]{#vif}

### [39.273 vif](#toc-vif) {#vif .section}

Obtain the average VIF (Visual Information Fidelity) between two input
videos.

This filter takes two input videos.

Both input videos must have the same resolution and pixel format for
this filter to work correctly. Also it assumes that both inputs have the
same number of frames, which are compared one by one.

The obtained average VIF score is printed through the logging system.

The filter stores the calculated VIF score of each frame.

This filter also supports the [framesync](#framesync) options.

In the below example the input file `main.mpg`{.sample} being processed
is compared with the reference file `ref.mpg`{.sample}.

::: example
``` example
ffmpeg -i main.mpg -i ref.mpg -lavfi vif -f null -
```
:::

[]{#vignette}[]{#vignette-1}

### [39.274 vignette](#toc-vignette-1) {#vignette .section}

Make or reverse a natural vignetting effect.

The filter accepts the following options:

`angle, a`{.sample}

:   Set lens angle expression as a number of radians.

    The value is clipped in the `[0,PI/2]` range.

    Default value: `"PI/5"`

`x0`{.sample}\
`y0`{.sample}

:   Set center coordinates expressions. Respectively `"w/2"` and `"h/2"`
    by default.

`mode`{.sample}

:   Set forward/backward mode.

    Available modes are:

    '`forward`{.sample}'

    :   The larger the distance from the central point, the darker the
        image becomes.

    '`backward`{.sample}'

    :   The larger the distance from the central point, the brighter the
        image becomes. This can be used to reverse a vignette effect,
        though there is no automatic detection to extract the lens
        `angle`{.sample} and other settings (yet). It can also be used
        to create a burning effect.

    Default value is '`forward`{.sample}'.

`eval`{.sample}

:   Set evaluation mode for the expressions (`angle`{.sample},
    `x0`{.sample}, `y0`{.sample}).

    It accepts the following values:

    '`init`{.sample}'

    :   Evaluate expressions only once during the filter initialization.

    '`frame`{.sample}'

    :   Evaluate expressions for each incoming frame. This is way slower
        than the '`init`{.sample}' mode since it requires all the
        scalers to be re-computed, but it allows advanced dynamic
        expressions.

    Default value is '`init`{.sample}'.

`dither`{.sample}

:   Set dithering to reduce the circular banding effects. Default is `1`
    (enabled).

`aspect`{.sample}

:   Set vignette aspect. This setting allows one to adjust the shape of
    the vignette. Setting this value to the SAR of the input will make a
    rectangular vignetting following the dimensions of the video.

    Default is `1/1`.

[]{#Expressions}

#### [39.274.1 Expressions](#toc-Expressions) {#expressions .subsection}

The `alpha`{.sample}, `x0`{.sample} and `y0`{.sample} expressions can
contain the following parameters.

`w`{.sample}\
`h`{.sample}

:   input width and height

`n`{.sample}

:   the number of input frame, starting from 0

`pts`{.sample}

:   the PTS (Presentation TimeStamp) time of the filtered video frame,
    expressed in `TB`{.variable} units, NAN if undefined

`r`{.sample}

:   frame rate of the input video, NAN if the input frame rate is
    unknown

`t`{.sample}

:   the PTS (Presentation TimeStamp) of the filtered video frame,
    expressed in seconds, NAN if undefined

`tb`{.sample}

:   time base of the input video

[]{#Examples-180}

#### [39.274.2 Examples](#toc-Examples-180) {#examples-180 .subsection}

- Apply simple strong vignetting effect:

  ::: example
  ``` example
  vignette=PI/4
  ```
  :::
- Make a flickering vignetting:

  ::: example
  ``` example
  vignette='PI/4+random(1)*PI/50':eval=frame
  ```
  :::

[]{#vmafmotion}

### [39.275 vmafmotion](#toc-vmafmotion) {#vmafmotion .section}

Obtain the average VMAF motion score of a video. It is one of the
component metrics of VMAF.

The obtained average motion score is printed through the logging system.

The filter accepts the following options:

`stats_file`{.sample}

:   If specified, the filter will use the named file to save the motion
    score of each frame with respect to the previous frame. When
    filename equals \"-\" the data is sent to standard output.

Example:

::: example
``` example
ffmpeg -i ref.mpg -vf vmafmotion -f null -
```
:::

[]{#vpp_005famf}[]{#vpp_005famf-1}

### [39.276 vpp_amf](#toc-vpp_005famf-1) {#vpp_amf .section}

Scale (resize) and convert colorspace, transfer characteristics or color
primaries for the input video, using AMD Advanced Media Framework
library for hardware acceleration. Setting the output width and height
works in the same way as for the [scale](#scale) filter.

The filter accepts the following options:

`w`{.sample}\
`h`{.sample}

:   Set the output video dimension expression. Default value is the
    input dimension.

    Allows for the same expressions as the [scale](#scale) filter.

`scale_type`{.sample}

:   Sets the algorithm used for scaling:

    `bilinear`{.variable}

    :   Bilinear

        This is the default.

    `bicubic`{.variable}

    :   Bicubic

`format`{.sample}

:   Controls the output pixel format. By default, or if none is
    specified, the input pixel format is used.

`force_original_aspect_ratio`{.sample}\
`force_divisible_by`{.sample}

:   Work the same as the identical [scale](#scale) filter options.

`reset_sar`{.sample}

:   Works the same as the identical [scale](#scale) filter option.

    []{#color_005fprofile}

`color_profile`{.sample}

:   Specify all color properties at once.

    The accepted values are:

    '`bt601`{.sample}'

    :   BT.601

    '`bt709`{.sample}'

    :   BT.709

    '`bt2020`{.sample}'

    :   BT.2020

`trc`{.sample}

:   Specify output transfer characteristics.

    The accepted values are:

    '`bt709`{.sample}'

    :   BT.709

    '`gamma22`{.sample}'

    :   Constant gamma of 2.2

    '`gamma28`{.sample}'

    :   Constant gamma of 2.8

    '`smpte170m`{.sample}'

    :   SMPTE-170M

    '`smpte240m`{.sample}'

    :   SMPTE-240M

    '`linear`{.sample}'

    :   Linear

    '`log`{.sample}'

    :   LOG

    '`log-sqrt`{.sample}'

    :   LOG_SQRT

    '`iec61966-2-4`{.sample}'

    :   iec61966-2-4

    '`bt1361-ecg`{.sample}'

    :   BT1361_ECG

    '`iec61966-2-1`{.sample}'

    :   iec61966-2-1

    '`bt2020-10`{.sample}'

    :   BT.2020 for 10-bits content

    '`bt2020-12`{.sample}'

    :   BT.2020 for 12-bits content

    '`smpte2084`{.sample}'

    :   SMPTE2084

    '`smpte428`{.sample}'

    :   SMPTE428

    '`arib-std-b67`{.sample}'

    :   ARIB_STD_B67

`primaries`{.sample}

:   Specify output color primaries.

    The accepted values are:

    '`bt709`{.sample}'

    :   BT.709

    '`bt470m`{.sample}'

    :   BT.470M

    '`bt470bg`{.sample}'

    :   BT.470BG or BT.601-6 625

    '`smpte170m`{.sample}'

    :   SMPTE-170M or BT.601-6 525

    '`smpte240m`{.sample}'

    :   SMPTE-240M

    '`film`{.sample}'

    :   film

    '`bt2020`{.sample}'

    :   BT.2020

    '`smpte428`{.sample}'

    :   SMPTE-428

    '`smpte431`{.sample}'

    :   SMPTE-431

    '`smpte432`{.sample}'

    :   SMPTE-432

    '`jedec-p22`{.sample}'

    :   JEDEC P22 phosphors

[]{#Examples-181}

#### [39.276.1 Examples](#toc-Examples-181) {#examples-181 .subsection}

- Scale input to 720p, keeping aspect ratio and ensuring the output is
  yuv420p.

  ::: example
  ``` example
  vpp_amf=-2:720:format=yuv420p
  ```
  :::
- Upscale to 4K and change color profile to bt2020.

  ::: example
  ``` example
  vpp_amf=4096:2160:color_profile=bt2020
  ```
  :::

[]{#vstack}[]{#vstack-1}

### [39.277 vstack](#toc-vstack-1) {#vstack .section}

Stack input videos vertically.

All streams must be of same pixel format and of same width.

Note that this filter is faster than using [overlay](#overlay) and
[pad](#pad) filter to create same output.

The filter accepts the following options:

`inputs`{.sample}

:   Set number of input streams. Default is 2.

`shortest`{.sample}

:   If set to 1, force the output to terminate when the shortest input
    terminates. Default value is 0.

[]{#w3fdif}

### [39.278 w3fdif](#toc-w3fdif) {#w3fdif .section}

Deinterlace the input video (\"w3fdif\" stands for \"Weston 3 Field
Deinterlacing Filter\").

Based on the process described by Martin Weston for BBC R&D, and
implemented based on the de-interlace algorithm written by Jim
Easterbrook for BBC R&D, the Weston 3 field deinterlacing filter uses
filter coefficients calculated by BBC R&D.

This filter uses field-dominance information in frame to decide which of
each pair of fields to place first in the output. If it gets it wrong
use [setfield](#setfield) filter before `w3fdif` filter.

There are two sets of filter coefficients, so called \"simple\" and
\"complex\". Which set of filter coefficients is used can be set by
passing an optional parameter:

`filter`{.sample}

:   Set the interlacing filter coefficients. Accepts one of the
    following values:

    '`simple`{.sample}'

    :   Simple filter coefficient set.

    '`complex`{.sample}'

    :   More-complex filter coefficient set.

    Default value is '`complex`{.sample}'.

`mode`{.sample}

:   The interlacing mode to adopt. It accepts one of the following
    values:

    `frame`{.sample}

    :   Output one frame for each frame.

    `field`{.sample}

    :   Output one frame for each field.

    The default value is `field`.

`parity`{.sample}

:   The picture field parity assumed for the input interlaced video. It
    accepts one of the following values:

    `tff`{.sample}

    :   Assume the top field is first.

    `bff`{.sample}

    :   Assume the bottom field is first.

    `auto`{.sample}

    :   Enable automatic detection of field parity.

    The default value is `auto`. If the interlacing is unknown or the
    decoder does not export this information, top field first will be
    assumed.

`deint`{.sample}

:   Specify which frames to deinterlace. Accepts one of the following
    values:

    '`all`{.sample}'

    :   Deinterlace all frames,

    '`interlaced`{.sample}'

    :   Only deinterlace frames marked as interlaced.

    Default value is '`all`{.sample}'.

[]{#Commands-152}

#### [39.278.1 Commands](#toc-Commands-152) {#commands-152 .subsection}

This filter supports same [commands](#commands) as options.

[]{#waveform}

### [39.279 waveform](#toc-waveform) {#waveform .section}

Video waveform monitor.

The waveform monitor plots color component intensity. By default luma
only. Each column of the waveform corresponds to a column of pixels in
the source video.

It accepts the following options:

`mode, m`{.sample}

Can be either `row`, or `column`. Default is `column`. In row mode, the
graph on the left side represents color component value 0 and the right
side represents value = 255. In column mode, the top side represents
color component value = 0 and bottom side represents value = 255.

`intensity, i`{.sample}

Set intensity. Smaller values are useful to find out how many values of
the same luminance are distributed across input rows/columns. Default
value is `0.04`. Allowed range is \[0, 1\].

`mirror, r`{.sample}

Set mirroring mode. `0` means unmirrored, `1` means mirrored. In
mirrored mode, higher values will be represented on the left side for
`row` mode and at the top for `column` mode. Default is `1` (mirrored).

`display, d`{.sample}

Set display mode. It accepts the following values:

'`overlay`{.sample}'

:   Presents information identical to that in the `parade`, except that
    the graphs representing color components are superimposed directly
    over one another.

    This display mode makes it easier to spot relative differences or
    similarities in overlapping areas of the color components that are
    supposed to be identical, such as neutral whites, grays, or blacks.

'`stack`{.sample}'

:   Display separate graph for the color components side by side in
    `row` mode or one below the other in `column` mode.

'`parade`{.sample}'

:   Display separate graph for the color components side by side in
    `column` mode or one below the other in `row` mode.

    Using this display mode makes it easy to spot color casts in the
    highlights and shadows of an image, by comparing the contours of the
    top and the bottom graphs of each waveform. Since whites, grays, and
    blacks are characterized by exactly equal amounts of red, green, and
    blue, neutral areas of the picture should display three waveforms of
    roughly equal width/height. If not, the correction is easy to
    perform by making level adjustments the three waveforms.

Default is `stack`.

`components, c`{.sample}

Set which color components to display. Default is 1, which means only
luma or red color component if input is in RGB colorspace. If is set for
example to 7 it will display all 3 (if) available color components.

`envelope, e`{.sample}

'`none`{.sample}'

:   No envelope, this is default.

'`instant`{.sample}'

:   Instant envelope, minimum and maximum values presented in graph will
    be easily visible even with small `step` value.

'`peak`{.sample}'

:   Hold minimum and maximum values presented in graph across time. This
    way you can still spot out of range values without constantly
    looking at waveforms.

'`peak+instant`{.sample}'

:   Peak and instant envelope combined together.

`filter, f`{.sample}

'`lowpass`{.sample}'

:   No filtering, this is default.

'`flat`{.sample}'

:   Luma and chroma combined together.

'`aflat`{.sample}'

:   Similar as above, but shows difference between blue and red chroma.

'`xflat`{.sample}'

:   Similar as above, but use different colors.

'`yflat`{.sample}'

:   Similar as above, but again with different colors.

'`chroma`{.sample}'

:   Displays only chroma.

'`color`{.sample}'

:   Displays actual color value on waveform.

'`acolor`{.sample}'

:   Similar as above, but with luma showing frequency of chroma values.

`graticule, g`{.sample}

Set which graticule to display.

'`none`{.sample}'

:   Do not display graticule.

'`green`{.sample}'

:   Display green graticule showing legal broadcast ranges.

'`orange`{.sample}'

:   Display orange graticule showing legal broadcast ranges.

'`invert`{.sample}'

:   Display invert graticule showing legal broadcast ranges.

`opacity, o`{.sample}

Set graticule opacity.

`flags, fl`{.sample}

Set graticule flags.

'`numbers`{.sample}'

:   Draw numbers above lines. By default enabled.

'`dots`{.sample}'

:   Draw dots instead of lines.

`scale, s`{.sample}

Set scale used for displaying graticule.

'`digital`{.sample}'

'`millivolts`{.sample}'

'`ire`{.sample}'

Default is digital.

`bgopacity, b`{.sample}

Set background opacity.

`tint0, t0`{.sample}

`tint1, t1`{.sample}

Set tint for output. Only used with lowpass filter and when display is
not overlay and input pixel formats are not RGB.

`fitmode, fm`{.sample}

Set sample aspect ratio of video output frames. Can be used to configure
waveform so it is not stretched too much in one of directions.

'`none`{.sample}'

:   Set sample aspect ration to 1/1.

'`size`{.sample}'

:   Set sample aspect ratio to match input size of video

Default is '`none`{.sample}'.

`input`{.sample}

Set input formats for filter to pick from. Can be '`all`{.sample}', for
selecting from all available formats, or '`first`{.sample}', for
selecting first available format. Default is '`first`{.sample}'.

[]{#weave_002c-doubleweave}

### [39.280 weave, doubleweave](#toc-weave_002c-doubleweave) {#weave-doubleweave .section}

The `weave` takes a field-based video input and join each two sequential
fields into single frame, producing a new double height clip with half
the frame rate and half the frame count.

The `doubleweave` works same as `weave` but without halving frame rate
and frame count.

It accepts the following option:

`first_field`{.sample}

:   Set first field. Available values are:

    '`top, t`{.sample}'

    :   Set the frame as top-field-first.

    '`bottom, b`{.sample}'

    :   Set the frame as bottom-field-first.

[]{#Examples-182}

#### [39.280.1 Examples](#toc-Examples-182) {#examples-182 .subsection}

- Interlace video using [select](#select) and
  [separatefields](#separatefields) filter:

  ::: example
  ``` example
  separatefields,select=eq(mod(n,4),0)+eq(mod(n,4),3),weave
  ```
  :::

[]{#xbr}

### [39.281 xbr](#toc-xbr) {#xbr .section}

Apply the xBR high-quality magnification filter which is designed for
pixel art. It follows a set of edge-detection rules, see
<https://forums.libretro.com/t/xbr-algorithm-tutorial/123>.

It accepts the following option:

`n`{.sample}

:   Set the scaling dimension: `2` for `2xBR`, `3` for `3xBR` and `4`
    for `4xBR`. Default is `3`.

[]{#xcorrelate}

### [39.282 xcorrelate](#toc-xcorrelate) {#xcorrelate .section}

Apply normalized cross-correlation between first and second input video
stream.

Second input video stream dimensions must be lower than first input
video stream.

The filter accepts the following options:

`planes`{.sample}

:   Set which planes to process.

`secondary`{.sample}

:   Set which secondary video frames will be processed from second input
    video stream, can be `first`{.variable} or `all`{.variable}. Default
    is `all`{.variable}.

The `xcorrelate` filter also supports the [framesync](#framesync)
options.

[]{#xfade}

### [39.283 xfade](#toc-xfade) {#xfade .section}

Apply cross fade from one input video stream to another input video
stream. The cross fade is applied for specified duration.

Both inputs must be constant frame-rate and have the same resolution,
pixel format, frame rate and timebase.

The filter accepts the following options:

`transition`{.sample}

Set one of available transition effects:

'`custom`{.sample}'

'`fade`{.sample}'

'`wipeleft`{.sample}'

'`wiperight`{.sample}'

'`wipeup`{.sample}'

'`wipedown`{.sample}'

'`slideleft`{.sample}'

'`slideright`{.sample}'

'`slideup`{.sample}'

'`slidedown`{.sample}'

'`circlecrop`{.sample}'

'`rectcrop`{.sample}'

'`distance`{.sample}'

'`fadeblack`{.sample}'

'`fadewhite`{.sample}'

'`radial`{.sample}'

'`smoothleft`{.sample}'

'`smoothright`{.sample}'

'`smoothup`{.sample}'

'`smoothdown`{.sample}'

'`circleopen`{.sample}'

'`circleclose`{.sample}'

'`vertopen`{.sample}'

'`vertclose`{.sample}'

'`horzopen`{.sample}'

'`horzclose`{.sample}'

'`dissolve`{.sample}'

'`pixelize`{.sample}'

'`diagtl`{.sample}'

'`diagtr`{.sample}'

'`diagbl`{.sample}'

'`diagbr`{.sample}'

'`hlslice`{.sample}'

'`hrslice`{.sample}'

'`vuslice`{.sample}'

'`vdslice`{.sample}'

'`hblur`{.sample}'

'`fadegrays`{.sample}'

'`wipetl`{.sample}'

'`wipetr`{.sample}'

'`wipebl`{.sample}'

'`wipebr`{.sample}'

'`squeezeh`{.sample}'

'`squeezev`{.sample}'

'`zoomin`{.sample}'

'`fadefast`{.sample}'

'`fadeslow`{.sample}'

'`hlwind`{.sample}'

'`hrwind`{.sample}'

'`vuwind`{.sample}'

'`vdwind`{.sample}'

'`coverleft`{.sample}'

'`coverright`{.sample}'

'`coverup`{.sample}'

'`coverdown`{.sample}'

'`revealleft`{.sample}'

'`revealright`{.sample}'

'`revealup`{.sample}'

'`revealdown`{.sample}'

Default transition effect is fade.

`duration`{.sample}

Set cross fade duration in seconds. Range is 0 to 60 seconds. Default
duration is 1 second.

`offset`{.sample}

Set cross fade start relative to first input stream in seconds. Default
offset is 0.

`expr`{.sample}

Set expression for custom transition effect.

The expressions can use the following variables and functions:

`X`{.sample}\
`Y`{.sample}

:   The coordinates of the current sample.

`W`{.sample}\
`H`{.sample}

:   The width and height of the image.

`P`{.sample}

:   Progress of transition effect.

`PLANE`{.sample}

:   Currently processed plane.

`A`{.sample}

:   Return value of first input at current location and plane.

`B`{.sample}

:   Return value of second input at current location and plane.

`a0(x, y)`{.sample}\
`a1(x, y)`{.sample}\
`a2(x, y)`{.sample}\
`a3(x, y)`{.sample}

:   Return the value of the pixel at location
    (`x`{.variable},`y`{.variable}) of the first/second/third/fourth
    component of first input.

`b0(x, y)`{.sample}\
`b1(x, y)`{.sample}\
`b2(x, y)`{.sample}\
`b3(x, y)`{.sample}

:   Return the value of the pixel at location
    (`x`{.variable},`y`{.variable}) of the first/second/third/fourth
    component of second input.

[]{#Examples-183}

#### [39.283.1 Examples](#toc-Examples-183) {#examples-183 .subsection}

- Cross fade from one input video to another input video, with fade
  transition and duration of transition of 2 seconds starting at offset
  of 5 seconds:

  ::: example
  ``` example
  ffmpeg -i first.mp4 -i second.mp4 -filter_complex xfade=transition=fade:duration=2:offset=5 output.mp4
  ```
  :::

[]{#xmedian}

### [39.284 xmedian](#toc-xmedian) {#xmedian .section}

Pick median pixels from several input videos.

The filter accepts the following options:

`inputs`{.sample}

:   Set number of inputs. Default is 3. Allowed range is from 3 to 255.
    If number of inputs is even number, than result will be mean value
    between two median values.

`planes`{.sample}

:   Set which planes to filter. Default value is `15`, by which all
    planes are processed.

`percentile`{.sample}

:   Set median percentile. Default value is `0.5`. Default value of
    `0.5` will pick always median values, while `0` will pick minimum
    values, and `1` maximum values.

[]{#Commands-153}

#### [39.284.1 Commands](#toc-Commands-153) {#commands-153 .subsection}

This filter supports all above options as [commands](#commands),
excluding option `inputs`.

[]{#xpsnr}[]{#xpsnr-1}

### [39.285 xpsnr](#toc-xpsnr-1) {#xpsnr .section}

Obtain the average (across all input frames) and minimum (across all
color plane averages) eXtended Perceptually weighted peak
Signal-to-Noise Ratio (XPSNR) between two input videos.

The XPSNR is a low-complexity psychovisually motivated distortion
measurement algorithm for assessing the difference between two video
streams or images. This is especially useful for objectively quantifying
the distortions caused by video and image codecs, as an alternative to a
formal subjective test. The logarithmic XPSNR output values are in a
similar range as those of traditional [psnr](#psnr) assessments but
better reflect human impressions of visual coding quality. More details
on the XPSNR measure, which essentially represents a blockwise weighted
variant of the PSNR measure, can be found in the following freely
available papers:

- C. R. Helmrich, M. Siekmann, S. Becker, S. Bosse, D. Marpe, and T.
  Wiegand, \"XPSNR: A Low-Complexity Extension of the Perceptually
  Weighted Peak Signal-to-Noise Ratio for High-Resolution Video Quality
  Assessment,\" in Proc. IEEE Int. Conf. Acoustics, Speech, Sig.
  Process. (ICASSP), virt./online, May 2020.
  [www.ecodis.de/xpsnr.htm](www.ecodis.de/xpsnr.htm)
- C. R. Helmrich, S. Bosse, H. Schwarz, D. Marpe, and T. Wiegand, \"A
  Study of the Extended Perceptually Weighted Peak Signal-to-Noise Ratio
  (XPSNR) for Video Compression with Different Resolutions and Bit
  Depths,\" ITU Journal: ICT Discoveries, vol. 3, no. 1, pp. 65 - 72,
  May 2020. <http://handle.itu.int/11.1002/pub/8153d78b-en>

When publishing the results of XPSNR assessments obtained using, e.g.,
this FFmpeg filter, a reference to the above papers as a means of
documentation is strongly encouraged. The filter requires two input
videos. The first input is considered a (usually not distorted)
reference source and is passed unchanged to the output, whereas the
second input is a (distorted) test signal. Except for the bit depth,
these two video inputs must have the same pixel format. In addition, for
best performance, both compared input videos should be in YCbCr color
format.

The obtained overall XPSNR values mentioned above are printed through
the logging system. In case of input with multiple color planes, we
suggest reporting of the minimum XPSNR average.

The following parameter, which behaves like the one for the
[psnr](#psnr) filter, is accepted:

`stats_file, f`{.sample}

:   If specified, the filter will use the named file to save the XPSNR
    value of each individual frame and color plane. When the file name
    equals \"-\", that data is sent to standard output.

This filter also supports the [framesync](#framesync) options.

[]{#Examples-184}

#### [39.285.1 Examples](#toc-Examples-184) {#examples-184 .subsection}

- XPSNR analysis of two 1080p HD videos, ref_source.yuv and
  test_video.yuv, both at 24 frames per second, with color format 4:2:0,
  bit depth 8, and output of a logfile named \"xpsnr.log\":

  ::: example
  ``` example
  ffmpeg -s 1920x1080 -framerate 24 -pix_fmt yuv420p -i ref_source.yuv -s 1920x1080 -framerate
  24 -pix_fmt yuv420p -i test_video.yuv -lavfi xpsnr="stats_file=xpsnr.log" -f null -
  ```
  :::
- XPSNR analysis of two 2160p UHD videos, ref_source.yuv with bit depth
  8 and test_video.yuv with bit depth 10, both at 60 frames per second
  with color format 4:2:0, no logfile output:

  ::: example
  ``` example
  ffmpeg -s 3840x2160 -framerate 60 -pix_fmt yuv420p -i ref_source.yuv -s 3840x2160 -framerate
  60 -pix_fmt yuv420p10le -i test_video.yuv -lavfi xpsnr="stats_file=-" -f null -
  ```
  :::

[]{#xstack}[]{#xstack-1}

### [39.286 xstack](#toc-xstack-1) {#xstack .section}

Stack video inputs into custom layout.

All streams must be of same pixel format.

The filter accepts the following options:

`inputs`{.sample}

:   Set number of input streams. Default is 2.

`layout`{.sample}

:   Specify layout of inputs. This option requires the desired layout
    configuration to be explicitly set by the user. This sets position
    of each video input in output. Each input is separated by '\|'. The
    first number represents the column, and the second number represents
    the row. Numbers start at 0 and are separated by '\_'. Optionally
    one can use wX and hX, where X is video input from which to take
    width or height. Multiple values can be used when separated by '+'.
    In such case values are summed together.

    Note that if inputs are of different sizes gaps may appear, as not
    all of the output video frame will be filled. Similarly, videos can
    overlap each other if their position doesn't leave enough space for
    the full frame of adjoining videos.

    For 2 inputs, a default layout of `0_0|w0_0` (equivalent to
    `grid=2x1`) is set. In all other cases, a layout or a grid must be
    set by the user. Either `grid` or `layout` can be specified at a
    time. Specifying both will result in an error.

`grid`{.sample}

:   Specify a fixed size grid of inputs. This option is used to create a
    fixed size grid of the input streams. Set the grid size in the form
    `COLUMNSxROWS`. There must be `ROWS * COLUMNS` input streams and
    they will be arranged as a grid with `ROWS` rows and `COLUMNS`
    columns. When using this option, each input stream within a row must
    have the same height and all the rows must have the same width.

    If `grid` is set, then `inputs` option is ignored and is implicitly
    set to `ROWS * COLUMNS`.

    For 2 inputs, a default grid of `2x1` (equivalent to
    `layout=0_0|w0_0`) is set. In all other cases, a layout or a grid
    must be set by the user. Either `grid` or `layout` can be specified
    at a time. Specifying both will result in an error.

`shortest`{.sample}

:   If set to 1, force the output to terminate when the shortest input
    terminates. Default value is 0.

`fill`{.sample}

:   If set to valid color, all unused pixels will be filled with that
    color. By default fill is set to none, so it is disabled.

[]{#Examples-185}

#### [39.286.1 Examples](#toc-Examples-185) {#examples-185 .subsection}

- Display 4 inputs into 2x2 grid.

  Layout:

  ::: example
  ``` example
  input1(0, 0)  | input3(w0, 0)
  input2(0, h0) | input4(w0, h0)
  ```
  :::

  ::: example
  ``` example
  xstack=inputs=4:layout=0_0|0_h0|w0_0|w0_h0
  ```
  :::

  Note that if inputs are of different sizes, gaps or overlaps may
  occur.

- Display 4 inputs into 1x4 grid.

  Layout:

  ::: example
  ``` example
  input1(0, 0)
  input2(0, h0)
  input3(0, h0+h1)
  input4(0, h0+h1+h2)
  ```
  :::

  ::: example
  ``` example
  xstack=inputs=4:layout=0_0|0_h0|0_h0+h1|0_h0+h1+h2
  ```
  :::

  Note that if inputs are of different widths, unused space will appear.

- Display 9 inputs into 3x3 grid.

  Layout:

  ::: example
  ``` example
  input1(0, 0)       | input4(w0, 0)      | input7(w0+w3, 0)
  input2(0, h0)      | input5(w0, h0)     | input8(w0+w3, h0)
  input3(0, h0+h1)   | input6(w0, h0+h1)  | input9(w0+w3, h0+h1)
  ```
  :::

  ::: example
  ``` example
  xstack=inputs=9:layout=0_0|0_h0|0_h0+h1|w0_0|w0_h0|w0_h0+h1|w0+w3_0|w0+w3_h0|w0+w3_h0+h1
  ```
  :::

  Note that if inputs are of different sizes, gaps or overlaps may
  occur.

- Display 16 inputs into 4x4 grid.

  Layout:

  ::: example
  ``` example
  input1(0, 0)       | input5(w0, 0)       | input9 (w0+w4, 0)       | input13(w0+w4+w8, 0)
  input2(0, h0)      | input6(w0, h0)      | input10(w0+w4, h0)      | input14(w0+w4+w8, h0)
  input3(0, h0+h1)   | input7(w0, h0+h1)   | input11(w0+w4, h0+h1)   | input15(w0+w4+w8, h0+h1)
  input4(0, h0+h1+h2)| input8(w0, h0+h1+h2)| input12(w0+w4, h0+h1+h2)| input16(w0+w4+w8, h0+h1+h2)
  ```
  :::

  ::: example
  ``` example
  xstack=inputs=16:layout=0_0|0_h0|0_h0+h1|0_h0+h1+h2|w0_0|w0_h0|w0_h0+h1|w0_h0+h1+h2|w0+w4_0|
  w0+w4_h0|w0+w4_h0+h1|w0+w4_h0+h1+h2|w0+w4+w8_0|w0+w4+w8_h0|w0+w4+w8_h0+h1|w0+w4+w8_h0+h1+h2
  ```
  :::

  Note that if inputs are of different sizes, gaps or overlaps may
  occur.

[]{#yadif}[]{#yadif-1}

### [39.287 yadif](#toc-yadif-1) {#yadif .section}

Deinterlace the input video (\"yadif\" means \"yet another deinterlacing
filter\").

It accepts the following parameters:

`mode`{.sample}

:   The interlacing mode to adopt. It accepts one of the following
    values:

    `0, send_frame`{.sample}

    :   Output one frame for each frame.

    `1, send_field`{.sample}

    :   Output one frame for each field.

    `2, send_frame_nospatial`{.sample}

    :   Like `send_frame`, but it skips the spatial interlacing check.

    `3, send_field_nospatial`{.sample}

    :   Like `send_field`, but it skips the spatial interlacing check.

    The default value is `send_frame`.

`parity`{.sample}

:   The picture field parity assumed for the input interlaced video. It
    accepts one of the following values:

    `0, tff`{.sample}

    :   Assume the top field is first.

    `1, bff`{.sample}

    :   Assume the bottom field is first.

    `-1, auto`{.sample}

    :   Enable automatic detection of field parity.

    The default value is `auto`. If the interlacing is unknown or the
    decoder does not export this information, top field first will be
    assumed.

`deint`{.sample}

:   Specify which frames to deinterlace. Accepts one of the following
    values:

    `0, all`{.sample}

    :   Deinterlace all frames.

    `1, interlaced`{.sample}

    :   Only deinterlace frames marked as interlaced.

    The default value is `all`.

[]{#yaepblur}

### [39.288 yaepblur](#toc-yaepblur) {#yaepblur .section}

Apply blur filter while preserving edges (\"yaepblur\" means \"yet
another edge preserving blur filter\"). The algorithm is described in
\"J. S. Lee, Digital image enhancement and noise filtering by use of
local statistics, IEEE Trans. Pattern Anal. Mach. Intell. PAMI-2,
1980.\"

It accepts the following parameters:

`radius, r`{.sample}

:   Set the window radius. Default value is 3.

`planes, p`{.sample}

:   Set which planes to filter. Default is only the first plane.

`sigma, s`{.sample}

:   Set blur strength. Default value is 128.

[]{#Commands-154}

#### [39.288.1 Commands](#toc-Commands-154) {#commands-154 .subsection}

This filter supports same [commands](#commands) as options.

[]{#zoompan}

### [39.289 zoompan](#toc-zoompan) {#zoompan .section}

Apply Zoom & Pan effect.

This filter accepts the following options:

`zoom, z`{.sample}

:   Set the zoom expression. Range is 1-10. Default is 1.

`x`{.sample}\
`y`{.sample}

:   Set the x and y expression. Default is 0.

`d`{.sample}

:   Set the duration expression in number of frames. This sets for how
    many number of frames effect will last for single input image.
    Default is 90.

`s`{.sample}

:   Set the output image size, default is 'hd720'.

`fps`{.sample}

:   Set the output frame rate, default is '25'.

Each expression can contain the following constants:

`in_w, iw`{.sample}

:   Input width.

`in_h, ih`{.sample}

:   Input height.

`out_w, ow`{.sample}

:   Output width.

`out_h, oh`{.sample}

:   Output height.

`in`{.sample}

:   Input frame count.

`on`{.sample}

:   Output frame count.

`in_time, it`{.sample}

:   The input timestamp expressed in seconds. It's NAN if the input
    timestamp is unknown.

`out_time, time, ot`{.sample}

:   The output timestamp expressed in seconds.

`x`{.sample}\
`y`{.sample}

:   Last calculated 'x' and 'y' position from 'x' and 'y' expression for
    current input frame.

`px`{.sample}\
`py`{.sample}

:   'x' and 'y' of last output frame of previous input frame or 0 when
    there was not yet such frame (first input frame).

`zoom`{.sample}

:   Last calculated zoom from 'z' expression for current input frame.

`pzoom`{.sample}

:   Last calculated zoom of last output frame of previous input frame.

`duration`{.sample}

:   Number of output frames for current input frame. Calculated from 'd'
    expression for each input frame.

`pduration`{.sample}

:   number of output frames created for previous input frame

`a`{.sample}

:   Rational number: input width / input height

`sar`{.sample}

:   sample aspect ratio

`dar`{.sample}

:   display aspect ratio

[]{#Examples-186}

#### [39.289.1 Examples](#toc-Examples-186) {#examples-186 .subsection}

- Zoom in up to 1.5x and pan at same time to some spot near center of
  picture:

  ::: example
  ``` example
  zoompan=z='min(zoom+0.0015,1.5)':d=700:x='if(gte(zoom,1.5),x,x+1/a)':y='if(gte(zoom,1.5),y,y+1)':s=640x360
  ```
  :::
- Zoom in up to 1.5x and pan always at center of picture:

  ::: example
  ``` example
  zoompan=z='min(zoom+0.0015,1.5)':d=700:x='iw/2-(iw/zoom/2)':y='ih/2-(ih/zoom/2)'
  ```
  :::
- Same as above but without pausing:

  ::: example
  ``` example
  zoompan=z='min(max(zoom,pzoom)+0.0015,1.5)':d=1:x='iw/2-(iw/zoom/2)':y='ih/2-(ih/zoom/2)'
  ```
  :::
- Zoom in 2x into center of picture only for the first second of the
  input video:

  ::: example
  ``` example
  zoompan=z='if(between(in_time,0,1),2,1)':d=1:x='iw/2-(iw/zoom/2)':y='ih/2-(ih/zoom/2)'
  ```
  :::

[]{#zscale}[]{#zscale-1}

### [39.290 zscale](#toc-zscale-1) {#zscale .section}

Scale (resize) the input video, using the z.lib library:
<https://github.com/sekrit-twc/zimg>. To enable compilation of this
filter, you need to configure FFmpeg with `--enable-libzimg`.

The zscale filter forces the output display aspect ratio to be the same
as the input, by changing the output sample aspect ratio.

If the input image format is different from the format requested by the
next filter, the zscale filter will convert the input to the requested
format.

[]{#Options-125}

#### [39.290.1 Options](#toc-Options-125) {#options-125 .subsection}

The filter accepts the following options.

`width, w`{.sample}

`height, h`{.sample}

Set the output video dimension expression. Default value is the input
dimension.

If the `width`{.variable} or `w`{.variable} value is 0, the input width
is used for the output. If the `height`{.variable} or `h`{.variable}
value is 0, the input height is used for the output.

If one and only one of the values is -n with n \>= 1, the zscale filter
will use a value that maintains the aspect ratio of the input image,
calculated from the other specified dimension. After that it will,
however, make sure that the calculated dimension is divisible by n and
adjust the value if necessary.

If both values are -n with n \>= 1, the behavior will be identical to
both values being set to 0 as previously detailed.

See below for the list of accepted constants for use in the dimension
expression.

`size, s`{.sample}

Set the video size. For the syntax of this option, check the
[(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
manual](ffmpeg-utils.html#video-size-syntax).

`dither, d`{.sample}

Set the dither type.

Possible values are:

`none`{.variable}

`ordered`{.variable}

`random`{.variable}

`error_diffusion`{.variable}

Default is none.

`filter, f`{.sample}

Set the resize filter type.

Possible values are:

`point`{.variable}

`bilinear`{.variable}

`bicubic`{.variable}

`spline16`{.variable}

`spline36`{.variable}

`spline64`{.variable}

`lanczos`{.variable}

Default is bilinear.

`range, r`{.sample}

Set the color range.

Possible values are:

`input`{.variable}

`limited`{.variable}

`full`{.variable}

Default is same as input.

`primaries, p`{.sample}

Set the color primaries.

Possible values are:

`input`{.variable}

`709`{.variable}

`unspecified`{.variable}

`170m`{.variable}

`240m`{.variable}

`2020`{.variable}

Default is same as input.

`transfer, t`{.sample}

Set the transfer characteristics.

Possible values are:

`input`{.variable}

`709`{.variable}

`unspecified`{.variable}

`601`{.variable}

`linear`{.variable}

`2020_10`{.variable}

`2020_12`{.variable}

`smpte2084`{.variable}

`iec61966-2-1`{.variable}

`arib-std-b67`{.variable}

Default is same as input.

`matrix, m`{.sample}

Set the colorspace matrix.

Possible value are:

`input`{.variable}

`709`{.variable}

`unspecified`{.variable}

`470bg`{.variable}

`170m`{.variable}

`2020_ncl`{.variable}

`2020_cl`{.variable}

Default is same as input.

`rangein, rin`{.sample}

Set the input color range.

Possible values are:

`input`{.variable}

`limited`{.variable}

`full`{.variable}

Default is same as input.

`primariesin, pin`{.sample}

Set the input color primaries.

Possible values are:

`input`{.variable}

`709`{.variable}

`unspecified`{.variable}

`170m`{.variable}

`240m`{.variable}

`2020`{.variable}

Default is same as input.

`transferin, tin`{.sample}

Set the input transfer characteristics.

Possible values are:

`input`{.variable}

`709`{.variable}

`unspecified`{.variable}

`601`{.variable}

`linear`{.variable}

`2020_10`{.variable}

`2020_12`{.variable}

Default is same as input.

`matrixin, min`{.sample}

Set the input colorspace matrix.

Possible value are:

`input`{.variable}

`709`{.variable}

`unspecified`{.variable}

`470bg`{.variable}

`170m`{.variable}

`2020_ncl`{.variable}

`2020_cl`{.variable}

`chromal, c`{.sample}

Set the output chroma location.

Possible values are:

`input`{.variable}

`left`{.variable}

`center`{.variable}

`topleft`{.variable}

`top`{.variable}

`bottomleft`{.variable}

`bottom`{.variable}

`chromalin, cin`{.sample}

Set the input chroma location.

Possible values are:

`input`{.variable}

`left`{.variable}

`center`{.variable}

`topleft`{.variable}

`top`{.variable}

`bottomleft`{.variable}

`bottom`{.variable}

`npl`{.sample}

Set the nominal peak luminance.

`param_a`{.sample}

Parameter A for scaling filters. Parameter \"b\" for bicubic, and the
number of filter taps for lanczos.

`param_b`{.sample}

Parameter B for scaling filters. Parameter \"c\" for bicubic.

The values of the `w`{.sample} and `h`{.sample} options are expressions
containing the following constants:

`in_w`{.variable}\
`in_h`{.variable}

:   The input width and height

`iw`{.variable}\
`ih`{.variable}

:   These are the same as `in_w`{.variable} and `in_h`{.variable}.

`out_w`{.variable}\
`out_h`{.variable}

:   The output (scaled) width and height

`ow`{.variable}\
`oh`{.variable}

:   These are the same as `out_w`{.variable} and `out_h`{.variable}

`a`{.variable}

:   The same as `iw`{.variable} / `ih`{.variable}

`sar`{.variable}

:   input sample aspect ratio

`dar`{.variable}

:   The input display aspect ratio. Calculated from `(iw / ih) * sar`.

`hsub`{.variable}\
`vsub`{.variable}

:   horizontal and vertical input chroma subsample values. For example
    for the pixel format \"yuv422p\" `hsub`{.variable} is 2 and
    `vsub`{.variable} is 1.

`ohsub`{.variable}\
`ovsub`{.variable}

:   horizontal and vertical output chroma subsample values. For example
    for the pixel format \"yuv422p\" `hsub`{.variable} is 2 and
    `vsub`{.variable} is 1.

[]{#Commands-155}

#### [39.290.2 Commands](#toc-Commands-155) {#commands-155 .subsection}

This filter supports the following commands:

`width, w`{.sample}\
`height, h`{.sample}

:   Set the output video dimension expression. The command accepts the
    same syntax of the corresponding option.

    If the specified expression is not valid, it is kept at its current
    value.

[]{#CUDA-Video-Filters}

## [40 CUDA Video Filters](#toc-CUDA-Video-Filters) {#cuda-video-filters .chapter}

To enable CUDA and/or NPP filters please refer to configuration
guidelines for [CUDA](#CUDA) and for [CUDA NPP](#CUDA-NPP) filters.

Running CUDA filters requires you to initialize a hardware device and to
pass that device to all filters in any filter graph.

`-init_hw_device cuda[=`{.sample}`name`{.variable}`][:`{.sample}`device`{.variable}`[,`{.sample}`key=value`{.variable}`...]]`{.sample}

:   Initialise a new hardware device of type `cuda`{.variable} called
    `name`{.variable}, using the given device parameters.

`-filter_hw_device `{.sample}`name`{.variable}

:   Pass the hardware device called `name`{.variable} to all filters in
    any filter graph.

For more detailed information see
<https://www.ffmpeg.org/ffmpeg.html#Advanced-Video-options>

- Example of initializing second CUDA device on the system and running
  scale_cuda and bilateral_cuda filters.

  ::: example
  ``` example
  ./ffmpeg -hwaccel cuda -hwaccel_output_format cuda -i input.mp4 -init_hw_device cuda:1 -filter_complex \
  "[0:v]scale_cuda=format=yuv444p[scaled_video];[scaled_video]bilateral_cuda=window_size=9:sigmaS=3.0:sigmaR=50.0" \
  -an -sn -c:v h264_nvenc -cq 20 out.mp4
  ```
  :::

Since CUDA filters operate exclusively on GPU memory, frame data must
sometimes be uploaded ([hwupload](#hwupload)) to hardware surfaces
associated with the appropriate CUDA device before processing, and
downloaded ([hwdownload](#hwdownload)) back to normal memory afterward,
if required. Whether [hwupload](#hwupload) or [hwdownload](#hwdownload)
is necessary depends on the specific workflow:

- If the input frames are already in GPU memory (e.g., when using
  `-hwaccel cuda` or `-hwaccel_output_format cuda`), explicit use of
  [hwupload](#hwupload) is not needed, as the data is already in the
  appropriate memory space.
- If the input frames are in CPU memory (e.g., software-decoded frames
  or frames processed by CPU-based filters), it is necessary to use
  [hwupload](#hwupload) to transfer the data to GPU memory for CUDA
  processing.
- If the output of the CUDA filters needs to be further processed by
  software-based filters or saved in a format not supported by GPU-based
  encoders, [hwdownload](#hwdownload) is required to transfer the data
  back to CPU memory.

Note that [hwupload](#hwupload) uploads data to a surface with the same
layout as the software frame, so it may be necessary to add a
[format](#format) filter immediately before [hwupload](#hwupload) to
ensure the input is in the correct format. Similarly,
[hwdownload](#hwdownload) may not support all output formats, so an
additional [format](#format) filter may need to be inserted immediately
after [hwdownload](#hwdownload) in the filter graph to ensure
compatibility.

[]{#CUDA}[]{#CUDA-1}

### [40.1 CUDA](#toc-CUDA-1) {#cuda .section}

Below is a description of the currently available Nvidia CUDA video
filters.

Prerequisites:

- Install Nvidia CUDA Toolkit

Note: If FFmpeg detects the Nvidia CUDA Toolkit during configuration, it
will enable CUDA filters automatically without requiring any additional
flags. If you want to explicitly enable them, use the following options:

- Configure FFmpeg with `--enable-cuda-nvcc --enable-nonfree`.
- Configure FFmpeg with `--enable-cuda-llvm`. Additional requirement:
  `llvm` lib must be installed.

[]{#bilateral_005fcuda}

#### [40.1.1 bilateral_cuda](#toc-bilateral_005fcuda) {#bilateral_cuda .subsection}

CUDA accelerated bilateral filter, an edge preserving filter. This
filter is mathematically accurate thanks to the use of GPU acceleration.
For best output quality, use one to one chroma subsampling, i.e. yuv444p
format.

The filter accepts the following options:

`sigmaS`{.sample}

:   Set sigma of gaussian function to calculate spatial weight, also
    called sigma space. Allowed range is 0.1 to 512. Default is 0.1.

`sigmaR`{.sample}

:   Set sigma of gaussian function to calculate color range weight, also
    called sigma color. Allowed range is 0.1 to 512. Default is 0.1.

`window_size`{.sample}

:   Set window size of the bilateral function to determine the number of
    neighbours to loop on. If the number entered is even, one will be
    added automatically. Allowed range is 1 to 255. Default is 1.

[]{#Examples-187}

#### [40.1.1.1 Examples](#toc-Examples-187) {#examples-187 .subsubsection}

- Apply the bilateral filter on a video.

  ::: example
  ``` example
  ./ffmpeg -v verbose \
  -hwaccel cuda -hwaccel_output_format cuda -i input.mp4  \
  -init_hw_device cuda \
  -filter_complex \
  " \
  [0:v]scale_cuda=format=yuv444p[scaled_video];
  [scaled_video]bilateral_cuda=window_size=9:sigmaS=3.0:sigmaR=50.0" \
  -an -sn -c:v h264_nvenc -cq 20 out.mp4
  ```
  :::

[]{#bwdif_005fcuda}

#### [40.1.2 bwdif_cuda](#toc-bwdif_005fcuda) {#bwdif_cuda .subsection}

Deinterlace the input video using the [bwdif](#bwdif) algorithm, but
implemented in CUDA so that it can work as part of a GPU accelerated
pipeline with nvdec and/or nvenc.

It accepts the following parameters:

`mode`{.sample}

:   The interlacing mode to adopt. It accepts one of the following
    values:

    `0, send_frame`{.sample}

    :   Output one frame for each frame.

    `1, send_field`{.sample}

    :   Output one frame for each field.

    The default value is `send_field`.

`parity`{.sample}

:   The picture field parity assumed for the input interlaced video. It
    accepts one of the following values:

    `0, tff`{.sample}

    :   Assume the top field is first.

    `1, bff`{.sample}

    :   Assume the bottom field is first.

    `-1, auto`{.sample}

    :   Enable automatic detection of field parity.

    The default value is `auto`. If the interlacing is unknown or the
    decoder does not export this information, top field first will be
    assumed.

`deint`{.sample}

:   Specify which frames to deinterlace. Accepts one of the following
    values:

    `0, all`{.sample}

    :   Deinterlace all frames.

    `1, interlaced`{.sample}

    :   Only deinterlace frames marked as interlaced.

    The default value is `all`.

[]{#chromakey_005fcuda}

#### [40.1.3 chromakey_cuda](#toc-chromakey_005fcuda) {#chromakey_cuda .subsection}

CUDA accelerated YUV colorspace color/chroma keying.

This filter works like normal chromakey filter but operates on CUDA
frames. for more details and parameters see [chromakey](#chromakey).

[]{#Examples-188}

#### [40.1.3.1 Examples](#toc-Examples-188) {#examples-188 .subsubsection}

- Make all the green pixels in the input video transparent and use it as
  an overlay for another video:

  ::: example
  ``` example
  ./ffmpeg \
      -hwaccel cuda -hwaccel_output_format cuda -i input_green.mp4  \
      -hwaccel cuda -hwaccel_output_format cuda -i base_video.mp4 \
      -init_hw_device cuda \
      -filter_complex \
      " \
          [0:v]chromakey_cuda=0x25302D:0.1:0.12:1[overlay_video]; \
          [1:v]scale_cuda=format=yuv420p[base]; \
          [base][overlay_video]overlay_cuda" \
      -an -sn -c:v h264_nvenc -cq 20 output.mp4
  ```
  :::
- Process two software sources, explicitly uploading the frames:

  ::: example
  ``` example
  ./ffmpeg -init_hw_device cuda=cuda -filter_hw_device cuda \
      -f lavfi -i color=size=800x600:color=white,format=yuv420p \
      -f lavfi -i yuvtestsrc=size=200x200,format=yuv420p \
      -filter_complex \
      " \
          [0]hwupload[under]; \
          [1]hwupload,chromakey_cuda=green:0.1:0.12[over]; \
          [under][over]overlay_cuda" \
      -c:v hevc_nvenc -cq 18 -preset slow output.mp4
  ```
  :::

[]{#colorspace_005fcuda}

#### [40.1.4 colorspace_cuda](#toc-colorspace_005fcuda) {#colorspace_cuda .subsection}

CUDA accelerated implementation of the colorspace filter.

It is by no means feature complete compared to the software colorspace
filter, and at the current time only supports color range conversion
between jpeg/full and mpeg/limited range.

The filter accepts the following options:

`range`{.sample}

:   Specify output color range.

    The accepted values are:

    '`tv`{.sample}'

    :   TV (restricted) range

    '`mpeg`{.sample}'

    :   MPEG (restricted) range

    '`pc`{.sample}'

    :   PC (full) range

    '`jpeg`{.sample}'

    :   JPEG (full) range

[]{#overlay_005fcuda}[]{#overlay_005fcuda-1}

#### [40.1.5 overlay_cuda](#toc-overlay_005fcuda-1) {#overlay_cuda .subsection}

Overlay one video on top of another.

This is the CUDA variant of the [overlay](#overlay) filter. It only
accepts CUDA frames. The underlying input pixel formats have to match.

It takes two inputs and has one output. The first input is the \"main\"
video on which the second input is overlaid.

It accepts the following parameters:

`x`{.sample}\
`y`{.sample}

:   Set expressions for the x and y coordinates of the overlaid video on
    the main video.

    They can contain the following parameters:

    `main_w, W`{.sample}\
    `main_h, H`{.sample}

    :   The main input width and height.

    `overlay_w, w`{.sample}\
    `overlay_h, h`{.sample}

    :   The overlay input width and height.

    `x`{.sample}\
    `y`{.sample}

    :   The computed values for `x`{.variable} and `y`{.variable}. They
        are evaluated for each new frame.

    `n`{.sample}

    :   The ordinal index of the main input frame, starting from 0.

    `pos`{.sample}

    :   The byte offset position in the file of the main input frame,
        NAN if unknown. Deprecated, do not use.

    `t`{.sample}

    :   The timestamp of the main input frame, expressed in seconds, NAN
        if unknown.

    Default value is \"0\" for both expressions.

`eval`{.sample}

:   Set when the expressions for `x`{.sample} and `y`{.sample} are
    evaluated.

    It accepts the following values:

    `init`{.sample}

    :   Evaluate expressions once during filter initialization or when a
        command is processed.

    `frame`{.sample}

    :   Evaluate expressions for each incoming frame

    Default value is `frame`{.sample}.

`eof_action`{.sample}

:   See [framesync](#framesync).

`shortest`{.sample}

:   See [framesync](#framesync).

`repeatlast`{.sample}

:   See [framesync](#framesync).

This filter also supports the [framesync](#framesync) options.

[]{#pad_005fcuda}[]{#pad_005fcuda-1}

#### [40.1.6 pad_cuda](#toc-pad_005fcuda-1) {#pad_cuda .subsection}

Add paddings to an input video stream using CUDA.

This filter is the CUDA-accelerated version of the [pad](#pad) filter.
It accepts the same options and expressions and provides the same core
functionality. For a detailed description of available options, please
see the documentation for the [pad](#pad) filter.

[]{#Examples-189}

#### [40.1.6.1 Examples](#toc-Examples-189) {#examples-189 .subsubsection}

- Add a 200-pixel black border to all sides of a video frame:

  ::: example
  ``` example
  ffmpeg -hwaccel cuda -hwaccel_output_format cuda -i input.mp4 -vf "pad_cuda=w=iw+400:h=ih+400:x=200:y=200" -c:v h264_nvenc out.mp4
  ```
  :::
- Pad the input video to a 16:9 aspect ratio, filling with the color
  \"blue\":

  ::: example
  ``` example
  ffmpeg -hwaccel cuda -hwaccel_output_format cuda -i input.mp4 -vf "pad_cuda=w=ih*16/9/sar:h=ih:x=(ow-iw)/2:y=(oh-ih)/2:color=blue" -c:v h264_nvenc out.mp4
  ```
  :::

[]{#scale_005fcuda}[]{#scale_005fcuda-1}

#### [40.1.7 scale_cuda](#toc-scale_005fcuda-1) {#scale_cuda .subsection}

Scale (resize) and convert (pixel format) the input video, using
accelerated CUDA kernels. Setting the output width and height works in
the same way as for the [scale](#scale) filter.

The filter accepts the following options:

`w`{.sample}\
`h`{.sample}

:   Set the output video dimension expression. Default value is the
    input dimension.

    Allows for the same expressions as the [scale](#scale) filter.

`interp_algo`{.sample}

:   Sets the algorithm used for scaling:

    `nearest`{.variable}

    :   Nearest neighbour

        Used by default if input parameters match the desired output.

    `bilinear`{.variable}

    :   Bilinear

    `bicubic`{.variable}

    :   Bicubic

        This is the default.

    `lanczos`{.variable}

    :   Lanczos

`format`{.sample}

:   Controls the output pixel format. By default, or if none is
    specified, the input pixel format is used.

    The filter does not support converting between YUV and RGB pixel
    formats.

`passthrough`{.sample}

:   If set to 0, every frame is processed, even if no conversion is
    necessary. This mode can be useful to use the filter as a buffer for
    a downstream frame-consumer that exhausts the limited decoder frame
    pool.

    If set to 1, frames are passed through as-is if they match the
    desired output parameters. This is the default behaviour.

`param`{.sample}

:   Algorithm-Specific parameter.

    Affects the curves of the bicubic algorithm.

`force_original_aspect_ratio`{.sample}\
`force_divisible_by`{.sample}

:   Work the same as the identical [scale](#scale) filter options.

`reset_sar`{.sample}

:   Works the same as the identical [scale](#scale) filter option.

[]{#Examples-190}

#### [40.1.7.1 Examples](#toc-Examples-190) {#examples-190 .subsubsection}

- Scale input to 720p, keeping aspect ratio and ensuring the output is
  yuv420p.

  ::: example
  ``` example
  scale_cuda=-2:720:format=yuv420p
  ```
  :::
- Upscale to 4K using nearest neighbour algorithm.

  ::: example
  ``` example
  scale_cuda=4096:2160:interp_algo=nearest
  ```
  :::
- Don't do any conversion or scaling, but copy all input frames into
  newly allocated ones. This can be useful to deal with a filter and
  encode chain that otherwise exhausts the decoders frame pool.

  ::: example
  ``` example
  scale_cuda=passthrough=0
  ```
  :::

[]{#thumbnail_005fcuda}

#### [40.1.8 thumbnail_cuda](#toc-thumbnail_005fcuda) {#thumbnail_cuda .subsection}

Select the most representative frame in a given sequence of consecutive
frames using CUDA.

The filter accepts the following options:

`n`{.sample}

:   Set the frames batch size to analyze; in a set of `n`{.variable}
    frames, the filter will pick one of them, and then handle the next
    batch of `n`{.variable} frames until the end. Default is `100`.

Since the filter keeps track of the whole frames sequence, a bigger
`n`{.variable} value will result in a higher memory usage, so a high
value is not recommended.

[]{#Example-11}

#### [40.1.8.1 Example](#toc-Example-11) {#example-11 .subsubsection}

- Thumbnails are extracted from every `n`{.variable}=150-frame batch,
  selecting one per batch. Chosen frames are then scaled with
  [scale_cuda](#scale_005fcuda).

  ::: example
  ``` example
  ./ffmpeg  -hwaccel cuda -hwaccel_output_format cuda  -i ./input.mp4 -vf "thumbnail_cuda=150,scale_cuda=1920:1080,hwdownload,format=nv12" ./output/out%03d.png
  ```
  :::

[]{#yadif_005fcuda}

#### [40.1.9 yadif_cuda](#toc-yadif_005fcuda) {#yadif_cuda .subsection}

Deinterlace the input video using the [yadif](#yadif) algorithm, but
implemented in CUDA so that it can work as part of a GPU accelerated
pipeline with nvdec and/or nvenc.

It accepts the following parameters:

`mode`{.sample}

:   The interlacing mode to adopt. It accepts one of the following
    values:

    `0, send_frame`{.sample}

    :   Output one frame for each frame.

    `1, send_field`{.sample}

    :   Output one frame for each field.

    `2, send_frame_nospatial`{.sample}

    :   Like `send_frame`, but it skips the spatial interlacing check.

    `3, send_field_nospatial`{.sample}

    :   Like `send_field`, but it skips the spatial interlacing check.

    The default value is `send_frame`.

`parity`{.sample}

:   The picture field parity assumed for the input interlaced video. It
    accepts one of the following values:

    `0, tff`{.sample}

    :   Assume the top field is first.

    `1, bff`{.sample}

    :   Assume the bottom field is first.

    `-1, auto`{.sample}

    :   Enable automatic detection of field parity.

    The default value is `auto`. If the interlacing is unknown or the
    decoder does not export this information, top field first will be
    assumed.

`deint`{.sample}

:   Specify which frames to deinterlace. Accepts one of the following
    values:

    `0, all`{.sample}

    :   Deinterlace all frames.

    `1, interlaced`{.sample}

    :   Only deinterlace frames marked as interlaced.

    The default value is `all`.

[]{#CUDA-NPP}[]{#CUDA-NPP-1}

### [40.2 CUDA NPP](#toc-CUDA-NPP-1) {#cuda-npp .section}

Below is a description of the currently available NVIDIA Performance
Primitives (libnpp) video filters.

Prerequisites:

- Install Nvidia CUDA Toolkit
- Install libnpp

To enable CUDA NPP filters:

- Configure FFmpeg with `--enable-nonfree --enable-libnpp`.

[]{#scale_005fnpp}[]{#scale_005fnpp-1}

#### [40.2.1 scale_npp](#toc-scale_005fnpp-1) {#scale_npp .subsection}

Use the NVIDIA Performance Primitives (libnpp) to perform scaling and/or
pixel format conversion on CUDA video frames. Setting the output width
and height works in the same way as for the `scale`{.variable} filter.

The following additional options are accepted:

`format`{.sample}

The pixel format of the output CUDA frames. If set to the string
\"same\" (the default), the input format will be kept. Note that
automatic format negotiation and conversion is not yet supported for
hardware frames

`interp_algo`{.sample}

The interpolation algorithm used for resizing. One of the following:

`nn`{.sample}

Nearest neighbour.

`linear`{.sample}

`cubic`{.sample}

`cubic2p_bspline`{.sample}

2-parameter cubic (B=1, C=0)

`cubic2p_catmullrom`{.sample}

2-parameter cubic (B=0, C=1/2)

`cubic2p_b05c03`{.sample}

2-parameter cubic (B=1/2, C=3/10)

`super`{.sample}

Supersampling

`lanczos`{.sample}

`force_original_aspect_ratio`{.sample}

Enable decreasing or increasing output video width or height if
necessary to keep the original aspect ratio. Possible values:

'`disable`{.sample}'

:   Scale the video as specified and disable this feature.

'`decrease`{.sample}'

:   The output video dimensions will automatically be decreased if
    needed.

'`increase`{.sample}'

:   The output video dimensions will automatically be increased if
    needed.

One useful instance of this option is that when you know a specific
device's maximum allowed resolution, you can use this to limit the
output video to that, while retaining the aspect ratio. For example,
device A allows 1280x720 playback, and your video is 1920x800. Using
this option (set it to decrease) and specifying 1280x720 to the command
line makes the output 1280x533.

Please note that this is a different thing than specifying -1 for
`w`{.sample} or `h`{.sample}, you still need to specify the output
resolution for this option to work.

`force_divisible_by`{.sample}

Ensures that both the output dimensions, width and height, are divisible
by the given integer when used together with
`force_original_aspect_ratio`{.sample}. This works similar to using `-n`
in the `w`{.sample} and `h`{.sample} options.

This option respects the value set for
`force_original_aspect_ratio`{.sample}, increasing or decreasing the
resolution accordingly. The video's aspect ratio may be slightly
modified.

This option can be handy if you need to have a video fit within or
exceed a defined resolution using `force_original_aspect_ratio`{.sample}
but also have encoder restrictions on width or height divisibility.

`reset_sar`{.sample}

Works the same as the identical [scale](#scale) filter option.

`eval`{.sample}

Specify when to evaluate `width`{.variable} and `height`{.variable}
expression. It accepts the following values:

'`init`{.sample}'

:   Only evaluate expressions once during the filter initialization or
    when a command is processed.

'`frame`{.sample}'

:   Evaluate expressions for each incoming frame.

The values of the `w`{.sample} and `h`{.sample} options are expressions
containing the following constants:

`in_w`{.variable}\
`in_h`{.variable}

:   The input width and height

`iw`{.variable}\
`ih`{.variable}

:   These are the same as `in_w`{.variable} and `in_h`{.variable}.

`out_w`{.variable}\
`out_h`{.variable}

:   The output (scaled) width and height

`ow`{.variable}\
`oh`{.variable}

:   These are the same as `out_w`{.variable} and `out_h`{.variable}

`a`{.variable}

:   The same as `iw`{.variable} / `ih`{.variable}

`sar`{.variable}

:   input sample aspect ratio

`dar`{.variable}

:   The input display aspect ratio. Calculated from `(iw / ih) * sar`.

`n`{.variable}

:   The (sequential) number of the input frame, starting from 0. Only
    available with `eval=frame`.

`t`{.variable}

:   The presentation timestamp of the input frame, expressed as a number
    of seconds. Only available with `eval=frame`.

`pos`{.variable}

:   The position (byte offset) of the frame in the input stream, or NaN
    if this information is unavailable and/or meaningless (for example
    in case of synthetic video). Only available with `eval=frame`.
    Deprecated, do not use.

[]{#scale2ref_005fnpp}

#### [40.2.2 scale2ref_npp](#toc-scale2ref_005fnpp) {#scale2ref_npp .subsection}

Use the NVIDIA Performance Primitives (libnpp) to scale (resize) the
input video, based on a reference video.

See the [scale_npp](#scale_005fnpp) filter for available options,
scale2ref_npp supports the same but uses the reference video instead of
the main input as basis. scale2ref_npp also supports the following
additional constants for the `w`{.sample} and `h`{.sample} options:

`main_w`{.variable}\
`main_h`{.variable}

:   The main input video's width and height

`main_a`{.variable}

:   The same as `main_w`{.variable} / `main_h`{.variable}

`main_sar`{.variable}

:   The main input video's sample aspect ratio

`main_dar, mdar`{.variable}

:   The main input video's display aspect ratio. Calculated from
    `(main_w / main_h) * main_sar`.

`main_n`{.variable}

:   The (sequential) number of the main input frame, starting from 0.
    Only available with `eval=frame`.

`main_t`{.variable}

:   The presentation timestamp of the main input frame, expressed as a
    number of seconds. Only available with `eval=frame`.

`main_pos`{.variable}

:   The position (byte offset) of the frame in the main input stream, or
    NaN if this information is unavailable and/or meaningless (for
    example in case of synthetic video). Only available with
    `eval=frame`.

[]{#Examples-191}

#### [40.2.2.1 Examples](#toc-Examples-191) {#examples-191 .subsubsection}

- Scale a subtitle stream (b) to match the main video (a) in size before
  overlaying

  ::: example
  ``` example
  'scale2ref_npp[b][a];[a][b]overlay_cuda'
  ```
  :::
- Scale a logo to 1/10th the height of a video, while preserving its
  display aspect ratio.

  ::: example
  ``` example
  [logo-in][video-in]scale2ref_npp=w=oh*mdar:h=ih/10[logo-out][video-out]
  ```
  :::

[]{#sharpen_005fnpp}

#### [40.2.3 sharpen_npp](#toc-sharpen_005fnpp) {#sharpen_npp .subsection}

Use the NVIDIA Performance Primitives (libnpp) to perform image
sharpening with border control.

The following additional options are accepted:

`border_type`{.sample}

:   Type of sampling to be used ad frame borders. One of the following:

    `replicate`{.sample}

    :   Replicate pixel values.

[]{#transpose_005fnpp}

#### [40.2.4 transpose_npp](#toc-transpose_005fnpp) {#transpose_npp .subsection}

Transpose rows with columns in the input video and optionally flip it.
For more in depth examples see the [transpose](#transpose) video filter,
which shares mostly the same options.

It accepts the following parameters:

`dir`{.sample}

:   Specify the transposition direction.

    Can assume the following values:

    '`cclock_flip`{.sample}'

    :   Rotate by 90 degrees counterclockwise and vertically flip.
        (default)

    '`clock`{.sample}'

    :   Rotate by 90 degrees clockwise.

    '`cclock`{.sample}'

    :   Rotate by 90 degrees counterclockwise.

    '`clock_flip`{.sample}'

    :   Rotate by 90 degrees clockwise and vertically flip.

`passthrough`{.sample}

:   Do not apply the transposition if the input geometry matches the one
    specified by the specified value. It accepts the following values:

    '`none`{.sample}'

    :   Always apply transposition. (default)

    '`portrait`{.sample}'

    :   Preserve portrait geometry (when `height`{.variable} \>=
        `width`{.variable}).

    '`landscape`{.sample}'

    :   Preserve landscape geometry (when `width`{.variable} \>=
        `height`{.variable}).

[]{#OpenCL-Video-Filters}

## [41 OpenCL Video Filters](#toc-OpenCL-Video-Filters) {#opencl-video-filters .chapter}

Below is a description of the currently available OpenCL video filters.

To enable compilation of these filters you need to configure FFmpeg with
`--enable-opencl`.

Running OpenCL filters requires you to initialize a hardware device and
to pass that device to all filters in any filter graph.

`-init_hw_device opencl[=`{.sample}`name`{.variable}`][:`{.sample}`device`{.variable}`[,`{.sample}`key=value`{.variable}`...]]`{.sample}

:   Initialise a new hardware device of type `opencl`{.variable} called
    `name`{.variable}, using the given device parameters.

`-filter_hw_device `{.sample}`name`{.variable}

:   Pass the hardware device called `name`{.variable} to all filters in
    any filter graph.

For more detailed information see
<https://www.ffmpeg.org/ffmpeg.html#Advanced-Video-options>

- Example of choosing the first device on the second platform and
  running avgblur_opencl filter with default parameters on it.

  ::: example
  ``` example
  -init_hw_device opencl=gpu:1.0 -filter_hw_device gpu -i INPUT -vf "hwupload, avgblur_opencl, hwdownload" OUTPUT
  ```
  :::

Since OpenCL filters are not able to access frame data in normal memory,
all frame data needs to be uploaded([hwupload](#hwupload)) to hardware
surfaces connected to the appropriate device before being used and then
downloaded([hwdownload](#hwdownload)) back to normal memory. Note that
[hwupload](#hwupload) will upload to a surface with the same layout as
the software frame, so it may be necessary to add a [format](#format)
filter immediately before to get the input into the right format and
[hwdownload](#hwdownload) does not support all formats on the output -
it may be necessary to insert an additional [format](#format) filter
immediately following in the graph to get the output in a supported
format.

[]{#avgblur_005fopencl}

### [41.1 avgblur_opencl](#toc-avgblur_005fopencl) {#avgblur_opencl .section}

Apply average blur filter.

The filter accepts the following options:

`sizeX`{.sample}

:   Set horizontal radius size. Range is `[1, 1024]` and default value
    is `1`.

`planes`{.sample}

:   Set which planes to filter. Default value is `0xf`, by which all
    planes are processed.

`sizeY`{.sample}

:   Set vertical radius size. Range is `[1, 1024]` and default value is
    `0`. If zero, `sizeX` value will be used.

[]{#Example-12}

#### [41.1.1 Example](#toc-Example-12) {#example-12 .subsection}

- Apply average blur filter with horizontal and vertical size of 3,
  setting each pixel of the output to the average value of the 7x7
  region centered on it in the input. For pixels on the edges of the
  image, the region does not extend beyond the image boundaries, and so
  out-of-range coordinates are not used in the calculations.

  ::: example
  ``` example
  -i INPUT -vf "hwupload, avgblur_opencl=3, hwdownload" OUTPUT
  ```
  :::

[]{#boxblur_005fopencl}

### [41.2 boxblur_opencl](#toc-boxblur_005fopencl) {#boxblur_opencl .section}

Apply a boxblur algorithm to the input video.

It accepts the following parameters:

`luma_radius, lr`{.sample}

`luma_power, lp`{.sample}

`chroma_radius, cr`{.sample}

`chroma_power, cp`{.sample}

`alpha_radius, ar`{.sample}

`alpha_power, ap`{.sample}

A description of the accepted options follows.

`luma_radius, lr`{.sample}\
`chroma_radius, cr`{.sample}\
`alpha_radius, ar`{.sample}

:   Set an expression for the box radius in pixels used for blurring the
    corresponding input plane.

    The radius value must be a non-negative number, and must not be
    greater than the value of the expression `min(w,h)/2` for the luma
    and alpha planes, and of `min(cw,ch)/2` for the chroma planes.

    Default value for `luma_radius`{.sample} is \"2\". If not specified,
    `chroma_radius`{.sample} and `alpha_radius`{.sample} default to the
    corresponding value set for `luma_radius`{.sample}.

    The expressions can contain the following constants:

    `w`{.sample}\
    `h`{.sample}

    :   The input width and height in pixels.

    `cw`{.sample}\
    `ch`{.sample}

    :   The input chroma image width and height in pixels.

    `hsub`{.sample}\
    `vsub`{.sample}

    :   The horizontal and vertical chroma subsample values. For
        example, for the pixel format \"yuv422p\", `hsub`{.variable} is
        2 and `vsub`{.variable} is 1.

`luma_power, lp`{.sample}\
`chroma_power, cp`{.sample}\
`alpha_power, ap`{.sample}

:   Specify how many times the boxblur filter is applied to the
    corresponding plane.

    Default value for `luma_power`{.sample} is 2. If not specified,
    `chroma_power`{.sample} and `alpha_power`{.sample} default to the
    corresponding value set for `luma_power`{.sample}.

    A value of 0 will disable the effect.

[]{#Examples-192}

#### [41.2.1 Examples](#toc-Examples-192) {#examples-192 .subsection}

Apply boxblur filter, setting each pixel of the output to the average
value of box-radiuses `luma_radius`{.variable},
`chroma_radius`{.variable}, `alpha_radius`{.variable} for each plane
respectively. The filter will apply `luma_power`{.variable},
`chroma_power`{.variable}, `alpha_power`{.variable} times onto the
corresponding plane. For pixels on the edges of the image, the radius
does not extend beyond the image boundaries, and so out-of-range
coordinates are not used in the calculations.

- Apply a boxblur filter with the luma, chroma, and alpha radius set to
  2 and luma, chroma, and alpha power set to 3. The filter will run 3
  times with box-radius set to 2 for every plane of the image.

  ::: example
  ``` example
  -i INPUT -vf "hwupload, boxblur_opencl=luma_radius=2:luma_power=3, hwdownload" OUTPUT
  -i INPUT -vf "hwupload, boxblur_opencl=2:3, hwdownload" OUTPUT
  ```
  :::

- Apply a boxblur filter with luma radius set to 2, luma_power to 1,
  chroma_radius to 4, chroma_power to 5, alpha_radius to 3 and
  alpha_power to 7.

  For the luma plane, a 2x2 box radius will be run once.

  For the chroma plane, a 4x4 box radius will be run 5 times.

  For the alpha plane, a 3x3 box radius will be run 7 times.

  ::: example
  ``` example
  -i INPUT -vf "hwupload, boxblur_opencl=2:1:4:5:3:7, hwdownload" OUTPUT
  ```
  :::

[]{#colorkey_005fopencl}

### [41.3 colorkey_opencl](#toc-colorkey_005fopencl) {#colorkey_opencl .section}

RGB colorspace color keying.

The filter accepts the following options:

`color`{.sample}

:   The color which will be replaced with transparency.

`similarity`{.sample}

:   Similarity percentage with the key color.

    0.01 matches only the exact key color, while 1.0 matches everything.

`blend`{.sample}

:   Blend percentage.

    0.0 makes pixels either fully transparent, or not transparent at
    all.

    Higher values result in semi-transparent pixels, with a higher
    transparency the more similar the pixels color is to the key color.

[]{#Examples-193}

#### [41.3.1 Examples](#toc-Examples-193) {#examples-193 .subsection}

- Make every semi-green pixel in the input transparent with some slight
  blending:

  ::: example
  ``` example
  -i INPUT -vf "hwupload, colorkey_opencl=green:0.3:0.1, hwdownload" OUTPUT
  ```
  :::

[]{#convolution_005fopencl}

### [41.4 convolution_opencl](#toc-convolution_005fopencl) {#convolution_opencl .section}

Apply convolution of 3x3, 5x5, 7x7 matrix.

The filter accepts the following options:

`0m`{.sample}\
`1m`{.sample}\
`2m`{.sample}\
`3m`{.sample}

:   Set matrix for each plane. Matrix is sequence of 9, 25 or 49 signed
    numbers. Default value for each plane is `0 0 0 0 1 0 0 0 0`.

`0rdiv`{.sample}\
`1rdiv`{.sample}\
`2rdiv`{.sample}\
`3rdiv`{.sample}

:   Set multiplier for calculated value for each plane. If unset or 0,
    it will be sum of all matrix elements. The option value must be a
    float number greater or equal to `0.0`. Default value is `1.0`.

`0bias`{.sample}\
`1bias`{.sample}\
`2bias`{.sample}\
`3bias`{.sample}

:   Set bias for each plane. This value is added to the result of the
    multiplication. Useful for making the overall image brighter or
    darker. The option value must be a float number greater or equal to
    `0.0`. Default value is `0.0`.

[]{#Examples-194}

#### [41.4.1 Examples](#toc-Examples-194) {#examples-194 .subsection}

- Apply sharpen:

  ::: example
  ``` example
  -i INPUT -vf "hwupload, convolution_opencl=0 -1 0 -1 5 -1 0 -1 0:0 -1 0 -1 5 -1 0 -1 0:0 -1 0 -1 5 -1 0 -1 0:0 -1 0 -1 5 -1 0 -1 0, hwdownload" OUTPUT
  ```
  :::
- Apply blur:

  ::: example
  ``` example
  -i INPUT -vf "hwupload, convolution_opencl=1 1 1 1 1 1 1 1 1:1 1 1 1 1 1 1 1 1:1 1 1 1 1 1 1 1 1:1 1 1 1 1 1 1 1 1:1/9:1/9:1/9:1/9, hwdownload" OUTPUT
  ```
  :::
- Apply edge enhance:

  ::: example
  ``` example
  -i INPUT -vf "hwupload, convolution_opencl=0 0 0 -1 1 0 0 0 0:0 0 0 -1 1 0 0 0 0:0 0 0 -1 1 0 0 0 0:0 0 0 -1 1 0 0 0 0:5:1:1:1:0:128:128:128, hwdownload" OUTPUT
  ```
  :::
- Apply edge detect:

  ::: example
  ``` example
  -i INPUT -vf "hwupload, convolution_opencl=0 1 0 1 -4 1 0 1 0:0 1 0 1 -4 1 0 1 0:0 1 0 1 -4 1 0 1 0:0 1 0 1 -4 1 0 1 0:5:5:5:1:0:128:128:128, hwdownload" OUTPUT
  ```
  :::
- Apply laplacian edge detector which includes diagonals:

  ::: example
  ``` example
  -i INPUT -vf "hwupload, convolution_opencl=1 1 1 1 -8 1 1 1 1:1 1 1 1 -8 1 1 1 1:1 1 1 1 -8 1 1 1 1:1 1 1 1 -8 1 1 1 1:5:5:5:1:0:128:128:0, hwdownload" OUTPUT
  ```
  :::
- Apply emboss:

  ::: example
  ``` example
  -i INPUT -vf "hwupload, convolution_opencl=-2 -1 0 -1 1 1 0 1 2:-2 -1 0 -1 1 1 0 1 2:-2 -1 0 -1 1 1 0 1 2:-2 -1 0 -1 1 1 0 1 2, hwdownload" OUTPUT
  ```
  :::

[]{#erosion_005fopencl}

### [41.5 erosion_opencl](#toc-erosion_005fopencl) {#erosion_opencl .section}

Apply erosion effect to the video.

This filter replaces the pixel by the local(3x3) minimum.

It accepts the following options:

`threshold0`{.sample}\
`threshold1`{.sample}\
`threshold2`{.sample}\
`threshold3`{.sample}

:   Limit the maximum change for each plane. Range is `[0, 65535]` and
    default value is `65535`. If `0`, plane will remain unchanged.

`coordinates`{.sample}

:   Flag which specifies the pixel to refer to. Range is `[0, 255]` and
    default value is `255`, i.e. all eight pixels are used.

    Flags to local 3x3 coordinates region centered on `x`:

    1 2 3

    4 x 5

    6 7 8

[]{#Example-13}

#### [41.5.1 Example](#toc-Example-13) {#example-13 .subsection}

- Apply erosion filter with threshold0 set to 30, threshold1 set 40,
  threshold2 set to 50 and coordinates set to 231, setting each pixel of
  the output to the local minimum between pixels: 1, 2, 3, 6, 7, 8 of
  the 3x3 region centered on it in the input. If the difference between
  input pixel and local minimum is more then threshold of the
  corresponding plane, output pixel will be set to input pixel -
  threshold of corresponding plane.

  ::: example
  ``` example
  -i INPUT -vf "hwupload, erosion_opencl=30:40:50:coordinates=231, hwdownload" OUTPUT
  ```
  :::

[]{#deshake_005fopencl}

### [41.6 deshake_opencl](#toc-deshake_005fopencl) {#deshake_opencl .section}

Feature-point based video stabilization filter.

The filter accepts the following options:

`tripod`{.sample}

:   Simulates a tripod by preventing any camera movement whatsoever from
    the original frame. Defaults to `0`.

`debug`{.sample}

:   Whether or not additional debug info should be displayed, both in
    the processed output and in the console.

    Note that in order to see console debug output you will also need to
    pass `-v verbose` to ffmpeg.

    Viewing point matches in the output video is only supported for RGB
    input.

    Defaults to `0`.

`adaptive_crop`{.sample}

:   Whether or not to do a tiny bit of cropping at the borders to cut
    down on the amount of mirrored pixels.

    Defaults to `1`.

`refine_features`{.sample}

:   Whether or not feature points should be refined at a sub-pixel
    level.

    This can be turned off for a slight performance gain at the cost of
    precision.

    Defaults to `1`.

`smooth_strength`{.sample}

:   The strength of the smoothing applied to the camera path from `0.0`
    to `1.0`.

    `1.0` is the maximum smoothing strength while values less than that
    result in less smoothing.

    `0.0` causes the filter to adaptively choose a smoothing strength on
    a per-frame basis.

    Defaults to `0.0`.

`smooth_window_multiplier`{.sample}

:   Controls the size of the smoothing window (the number of frames
    buffered to determine motion information from).

    The size of the smoothing window is determined by multiplying the
    framerate of the video by this number.

    Acceptable values range from `0.1` to `10.0`.

    Larger values increase the amount of motion data available for
    determining how to smooth the camera path, potentially improving
    smoothness, but also increase latency and memory usage.

    Defaults to `2.0`.

[]{#Examples-195}

#### [41.6.1 Examples](#toc-Examples-195) {#examples-195 .subsection}

- Stabilize a video with a fixed, medium smoothing strength:

  ::: example
  ``` example
  -i INPUT -vf "hwupload, deshake_opencl=smooth_strength=0.5, hwdownload" OUTPUT
  ```
  :::
- Stabilize a video with debugging (both in console and in rendered
  video):

  ::: example
  ``` example
  -i INPUT -filter_complex "[0:v]format=rgba, hwupload, deshake_opencl=debug=1, hwdownload, format=rgba, format=yuv420p" -v verbose OUTPUT
  ```
  :::

[]{#dilation_005fopencl}

### [41.7 dilation_opencl](#toc-dilation_005fopencl) {#dilation_opencl .section}

Apply dilation effect to the video.

This filter replaces the pixel by the local(3x3) maximum.

It accepts the following options:

`threshold0`{.sample}\
`threshold1`{.sample}\
`threshold2`{.sample}\
`threshold3`{.sample}

:   Limit the maximum change for each plane. Range is `[0, 65535]` and
    default value is `65535`. If `0`, plane will remain unchanged.

`coordinates`{.sample}

:   Flag which specifies the pixel to refer to. Range is `[0, 255]` and
    default value is `255`, i.e. all eight pixels are used.

    Flags to local 3x3 coordinates region centered on `x`:

    1 2 3

    4 x 5

    6 7 8

[]{#Example-14}

#### [41.7.1 Example](#toc-Example-14) {#example-14 .subsection}

- Apply dilation filter with threshold0 set to 30, threshold1 set 40,
  threshold2 set to 50 and coordinates set to 231, setting each pixel of
  the output to the local maximum between pixels: 1, 2, 3, 6, 7, 8 of
  the 3x3 region centered on it in the input. If the difference between
  input pixel and local maximum is more then threshold of the
  corresponding plane, output pixel will be set to input pixel +
  threshold of corresponding plane.

  ::: example
  ``` example
  -i INPUT -vf "hwupload, dilation_opencl=30:40:50:coordinates=231, hwdownload" OUTPUT
  ```
  :::

[]{#nlmeans_005fopencl}[]{#nlmeans_005fopencl-1}

### [41.8 nlmeans_opencl](#toc-nlmeans_005fopencl-1) {#nlmeans_opencl .section}

Non-local Means denoise filter through OpenCL, this filter accepts same
options as [nlmeans](#nlmeans).

[]{#overlay_005fopencl}

### [41.9 overlay_opencl](#toc-overlay_005fopencl) {#overlay_opencl .section}

Overlay one video on top of another.

It takes two inputs and has one output. The first input is the \"main\"
video on which the second input is overlaid. This filter requires same
memory layout for all the inputs. So, format conversion may be needed.

The filter accepts the following options:

`x`{.sample}

:   Set the x coordinate of the overlaid video on the main video.
    Default value is `0`.

`y`{.sample}

:   Set the y coordinate of the overlaid video on the main video.
    Default value is `0`.

[]{#Examples-196}

#### [41.9.1 Examples](#toc-Examples-196) {#examples-196 .subsection}

- Overlay an image LOGO at the top-left corner of the INPUT video. Both
  inputs are yuv420p format.

  ::: example
  ``` example
  -i INPUT -i LOGO -filter_complex "[0:v]hwupload[a], [1:v]format=yuv420p, hwupload[b], [a][b]overlay_opencl, hwdownload" OUTPUT
  ```
  :::
- The inputs have same memory layout for color channels , the overlay
  has additional alpha plane, like INPUT is yuv420p, and the LOGO is
  yuva420p.

  ::: example
  ``` example
  -i INPUT -i LOGO -filter_complex "[0:v]hwupload[a], [1:v]format=yuva420p, hwupload[b], [a][b]overlay_opencl, hwdownload" OUTPUT
  ```
  :::

[]{#pad_005fopencl}

### [41.10 pad_opencl](#toc-pad_005fopencl) {#pad_opencl .section}

Add paddings to the input image, and place the original input at the
provided `x`{.variable}, `y`{.variable} coordinates.

It accepts the following options:

`width, w`{.sample}\
`height, h`{.sample}

:   Specify an expression for the size of the output image with the
    paddings added. If the value for `width`{.variable} or
    `height`{.variable} is 0, the corresponding input size is used for
    the output.

    The `width`{.variable} expression can reference the value set by the
    `height`{.variable} expression, and vice versa.

    The default value of `width`{.variable} and `height`{.variable} is
    0.

`x`{.sample}\
`y`{.sample}

:   Specify the offsets to place the input image at within the padded
    area, with respect to the top/left border of the output image.

    The `x`{.variable} expression can reference the value set by the
    `y`{.variable} expression, and vice versa.

    The default value of `x`{.variable} and `y`{.variable} is 0.

    If `x`{.variable} or `y`{.variable} evaluate to a negative number,
    they'll be changed so the input image is centered on the padded
    area.

`color`{.sample}

:   Specify the color of the padded area. For the syntax of this option,
    check the [(ffmpeg-utils)\"Color\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#color-syntax).

`aspect`{.sample}

:   Pad to an aspect instead to a resolution.

The value for the `width`{.variable}, `height`{.variable},
`x`{.variable}, and `y`{.variable} options are expressions containing
the following constants:

`in_w`{.sample}\
`in_h`{.sample}

:   The input video width and height.

`iw`{.sample}\
`ih`{.sample}

:   These are the same as `in_w`{.variable} and `in_h`{.variable}.

`out_w`{.sample}\
`out_h`{.sample}

:   The output width and height (the size of the padded area), as
    specified by the `width`{.variable} and `height`{.variable}
    expressions.

`ow`{.sample}\
`oh`{.sample}

:   These are the same as `out_w`{.variable} and `out_h`{.variable}.

`x`{.sample}\
`y`{.sample}

:   The x and y offsets as specified by the `x`{.variable} and
    `y`{.variable} expressions, or NAN if not yet specified.

`a`{.sample}

:   same as `iw`{.variable} / `ih`{.variable}

`sar`{.sample}

:   input sample aspect ratio

`dar`{.sample}

:   input display aspect ratio, it is the same as (`iw`{.variable} /
    `ih`{.variable}) \* `sar`{.variable}

[]{#prewitt_005fopencl}

### [41.11 prewitt_opencl](#toc-prewitt_005fopencl) {#prewitt_opencl .section}

Apply the Prewitt operator
(<https://en.wikipedia.org/wiki/Prewitt_operator>) to input video
stream.

The filter accepts the following option:

`planes`{.sample}

:   Set which planes to filter. Default value is `0xf`, by which all
    planes are processed.

`scale`{.sample}

:   Set value which will be multiplied with filtered result. Range is
    `[0.0, 65535]` and default value is `1.0`.

`delta`{.sample}

:   Set value which will be added to filtered result. Range is
    `[-65535, 65535]` and default value is `0.0`.

[]{#Example-15}

#### [41.11.1 Example](#toc-Example-15) {#example-15 .subsection}

- Apply the Prewitt operator with scale set to 2 and delta set to 10.

  ::: example
  ``` example
  -i INPUT -vf "hwupload, prewitt_opencl=scale=2:delta=10, hwdownload" OUTPUT
  ```
  :::

[]{#program_005fopencl}[]{#program_005fopencl-1}

### [41.12 program_opencl](#toc-program_005fopencl-1) {#program_opencl .section}

Filter video using an OpenCL program.

`source`{.sample}

:   OpenCL program source file.

`kernel`{.sample}

:   Kernel name in program.

`inputs`{.sample}

:   Number of inputs to the filter. Defaults to 1.

`size, s`{.sample}

:   Size of output frames. Defaults to the same as the first input.

The `program_opencl` filter also supports the [framesync](#framesync)
options.

The program source file must contain a kernel function with the given
name, which will be run once for each plane of the output. Each run on a
plane gets enqueued as a separate 2D global NDRange with one work-item
for each pixel to be generated. The global ID offset for each work-item
is therefore the coordinates of a pixel in the destination image.

The kernel function needs to take the following arguments:

- Destination image, `__write_only image2d_t`{.variable}.

  This image will become the output; the kernel should write all of it.

- Frame index, `unsigned int`{.variable}.

  This is a counter starting from zero and increasing by one for each
  frame.

- Source images, `__read_only image2d_t`{.variable}.

  These are the most recent images on each input. The kernel may read
  from them to generate the output, but they can't be written to.

Example programs:

- Copy the input to the output (output must be the same size as the
  input).

  ``` verbatim
  __kernel void copy(__write_only image2d_t destination,
                     unsigned int index,
                     __read_only  image2d_t source)
  {
      const sampler_t sampler = CLK_NORMALIZED_COORDS_FALSE;

      int2 location = (int2)(get_global_id(0), get_global_id(1));

      float4 value = read_imagef(source, sampler, location);

      write_imagef(destination, location, value);
  }
  ```

- Apply a simple transformation, rotating the input by an amount
  increasing with the index counter. Pixel values are linearly
  interpolated by the sampler, and the output need not have the same
  dimensions as the input.

  ``` verbatim
  __kernel void rotate_image(__write_only image2d_t dst,
                             unsigned int index,
                             __read_only  image2d_t src)
  {
      const sampler_t sampler = (CLK_NORMALIZED_COORDS_FALSE |
                                 CLK_FILTER_LINEAR);

      float angle = (float)index / 100.0f;

      float2 dst_dim = convert_float2(get_image_dim(dst));
      float2 src_dim = convert_float2(get_image_dim(src));

      float2 dst_cen = dst_dim / 2.0f;
      float2 src_cen = src_dim / 2.0f;

      int2   dst_loc = (int2)(get_global_id(0), get_global_id(1));

      float2 dst_pos = convert_float2(dst_loc) - dst_cen;
      float2 src_pos = {
          cos(angle) * dst_pos.x - sin(angle) * dst_pos.y,
          sin(angle) * dst_pos.x + cos(angle) * dst_pos.y
      };
      src_pos = src_pos * src_dim / dst_dim;

      float2 src_loc = src_pos + src_cen;

      if (src_loc.x < 0.0f      || src_loc.y < 0.0f ||
          src_loc.x > src_dim.x || src_loc.y > src_dim.y)
          write_imagef(dst, dst_loc, 0.5f);
      else
          write_imagef(dst, dst_loc, read_imagef(src, sampler, src_loc));
  }
  ```

- Blend two inputs together, with the amount of each input used varying
  with the index counter.

  ``` verbatim
  __kernel void blend_images(__write_only image2d_t dst,
                             unsigned int index,
                             __read_only  image2d_t src1,
                             __read_only  image2d_t src2)
  {
      const sampler_t sampler = (CLK_NORMALIZED_COORDS_FALSE |
                                 CLK_FILTER_LINEAR);

      float blend = (cos((float)index / 50.0f) + 1.0f) / 2.0f;

      int2  dst_loc = (int2)(get_global_id(0), get_global_id(1));
      int2 src1_loc = dst_loc * get_image_dim(src1) / get_image_dim(dst);
      int2 src2_loc = dst_loc * get_image_dim(src2) / get_image_dim(dst);

      float4 val1 = read_imagef(src1, sampler, src1_loc);
      float4 val2 = read_imagef(src2, sampler, src2_loc);

      write_imagef(dst, dst_loc, val1 * blend + val2 * (1.0f - blend));
  }
  ```

[]{#remap_005fopencl}

### [41.13 remap_opencl](#toc-remap_005fopencl) {#remap_opencl .section}

Remap pixels using 2nd: Xmap and 3rd: Ymap input video stream.

Destination pixel at position (X, Y) will be picked from source (x, y)
position where x = Xmap(X, Y) and y = Ymap(X, Y). If mapping values are
out of range, zero value for pixel will be used for destination pixel.

Xmap and Ymap input video streams must be of same dimensions. Output
video stream will have Xmap/Ymap video stream dimensions. Xmap and Ymap
input video streams are 32bit float pixel format, single channel.

`interp`{.sample}

:   Specify interpolation used for remapping of pixels. Allowed values
    are `near` and `linear`. Default value is `linear`.

`fill`{.sample}

:   Specify the color of the unmapped pixels. For the syntax of this
    option, check the [(ffmpeg-utils)\"Color\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#color-syntax). Default color
    is `black`.

[]{#roberts_005fopencl}

### [41.14 roberts_opencl](#toc-roberts_005fopencl) {#roberts_opencl .section}

Apply the Roberts cross operator
(<https://en.wikipedia.org/wiki/Roberts_cross>) to input video stream.

The filter accepts the following option:

`planes`{.sample}

:   Set which planes to filter. Default value is `0xf`, by which all
    planes are processed.

`scale`{.sample}

:   Set value which will be multiplied with filtered result. Range is
    `[0.0, 65535]` and default value is `1.0`.

`delta`{.sample}

:   Set value which will be added to filtered result. Range is
    `[-65535, 65535]` and default value is `0.0`.

[]{#Example-16}

#### [41.14.1 Example](#toc-Example-16) {#example-16 .subsection}

- Apply the Roberts cross operator with scale set to 2 and delta set to
  10

  ::: example
  ``` example
  -i INPUT -vf "hwupload, roberts_opencl=scale=2:delta=10, hwdownload" OUTPUT
  ```
  :::

[]{#sobel_005fopencl}

### [41.15 sobel_opencl](#toc-sobel_005fopencl) {#sobel_opencl .section}

Apply the Sobel operator
(<https://en.wikipedia.org/wiki/Sobel_operator>) to input video stream.

The filter accepts the following option:

`planes`{.sample}

:   Set which planes to filter. Default value is `0xf`, by which all
    planes are processed.

`scale`{.sample}

:   Set value which will be multiplied with filtered result. Range is
    `[0.0, 65535]` and default value is `1.0`.

`delta`{.sample}

:   Set value which will be added to filtered result. Range is
    `[-65535, 65535]` and default value is `0.0`.

[]{#Example-17}

#### [41.15.1 Example](#toc-Example-17) {#example-17 .subsection}

- Apply sobel operator with scale set to 2 and delta set to 10

  ::: example
  ``` example
  -i INPUT -vf "hwupload, sobel_opencl=scale=2:delta=10, hwdownload" OUTPUT
  ```
  :::

[]{#tonemap_005fopencl}

### [41.16 tonemap_opencl](#toc-tonemap_005fopencl) {#tonemap_opencl .section}

Perform HDR(PQ/HLG) to SDR conversion with tone-mapping.

It accepts the following parameters:

`tonemap`{.sample}

Specify the tone-mapping operator to be used. Same as tonemap option in
[tonemap](#tonemap).

`param`{.sample}

Tune the tone mapping algorithm. same as param option in
[tonemap](#tonemap).

`desat`{.sample}

Apply desaturation for highlights that exceed this level of brightness.
The higher the parameter, the more color information will be preserved.
This setting helps prevent unnaturally blown-out colors for
super-highlights, by (smoothly) turning into white instead. This makes
images feel more natural, at the cost of reducing information about
out-of-range colors.

The default value is 0.5, and the algorithm here is a little different
from the cpu version tonemap currently. A setting of 0.0 disables this
option.

`threshold`{.sample}

The tonemapping algorithm parameters is fine-tuned per each scene. And a
threshold is used to detect whether the scene has changed or not. If the
distance between the current frame average brightness and the current
running average exceeds a threshold value, we would re-calculate scene
average and peak brightness. The default value is 0.2.

`format`{.sample}

Specify the output pixel format.

Currently supported formats are:

`p010`{.variable}

`nv12`{.variable}

`range, r`{.sample}

Set the output color range.

Possible values are:

`tv/mpeg`{.variable}

`pc/jpeg`{.variable}

Default is same as input.

`primaries, p`{.sample}

Set the output color primaries.

Possible values are:

`bt709`{.variable}

`bt2020`{.variable}

Default is same as input.

`transfer, t`{.sample}

Set the output transfer characteristics.

Possible values are:

`bt709`{.variable}

`bt2020`{.variable}

Default is bt709.

`matrix, m`{.sample}

Set the output colorspace matrix.

Possible value are:

`bt709`{.variable}

`bt2020`{.variable}

Default is same as input.

[]{#Example-18}

#### [41.16.1 Example](#toc-Example-18) {#example-18 .subsection}

- Convert HDR(PQ/HLG) video to bt2020-transfer-characteristic p010
  format using linear operator.

  ::: example
  ``` example
  -i INPUT -vf "format=p010,hwupload,tonemap_opencl=t=bt2020:tonemap=linear:format=p010,hwdownload,format=p010" OUTPUT
  ```
  :::

[]{#unsharp_005fopencl}

### [41.17 unsharp_opencl](#toc-unsharp_005fopencl) {#unsharp_opencl .section}

Sharpen or blur the input video.

It accepts the following parameters:

`luma_msize_x, lx`{.sample}

:   Set the luma matrix horizontal size. Range is `[1, 23]` and default
    value is `5`.

`luma_msize_y, ly`{.sample}

:   Set the luma matrix vertical size. Range is `[1, 23]` and default
    value is `5`.

`luma_amount, la`{.sample}

:   Set the luma effect strength. Range is `[-10, 10]` and default value
    is `1.0`.

    Negative values will blur the input video, while positive values
    will sharpen it, a value of zero will disable the effect.

`chroma_msize_x, cx`{.sample}

:   Set the chroma matrix horizontal size. Range is `[1, 23]` and
    default value is `5`.

`chroma_msize_y, cy`{.sample}

:   Set the chroma matrix vertical size. Range is `[1, 23]` and default
    value is `5`.

`chroma_amount, ca`{.sample}

:   Set the chroma effect strength. Range is `[-10, 10]` and default
    value is `0.0`.

    Negative values will blur the input video, while positive values
    will sharpen it, a value of zero will disable the effect.

All parameters are optional and default to the equivalent of the string
'5:5:1.0:5:5:0.0'.

[]{#Examples-197}

#### [41.17.1 Examples](#toc-Examples-197) {#examples-197 .subsection}

- Apply strong luma sharpen effect:

  ::: example
  ``` example
  -i INPUT -vf "hwupload, unsharp_opencl=luma_msize_x=7:luma_msize_y=7:luma_amount=2.5, hwdownload" OUTPUT
  ```
  :::
- Apply a strong blur of both luma and chroma parameters:

  ::: example
  ``` example
  -i INPUT -vf "hwupload, unsharp_opencl=7:7:-2:7:7:-2, hwdownload" OUTPUT
  ```
  :::

[]{#xfade_005fopencl}

### [41.18 xfade_opencl](#toc-xfade_005fopencl) {#xfade_opencl .section}

Cross fade two videos with custom transition effect by using OpenCL.

It accepts the following options:

`transition`{.sample}

:   Set one of possible transition effects.

    `custom`{.sample}

    :   Select custom transition effect, the actual transition
        description will be picked from source and kernel options.

    `fade`{.sample}\
    `wipeleft`{.sample}\
    `wiperight`{.sample}\
    `wipeup`{.sample}\
    `wipedown`{.sample}\
    `slideleft`{.sample}\
    `slideright`{.sample}\
    `slideup`{.sample}\
    `slidedown`{.sample}

    :   Default transition is fade.

`source`{.sample}

:   OpenCL program source file for custom transition.

`kernel`{.sample}

:   Set name of kernel to use for custom transition from program source
    file.

`duration`{.sample}

:   Set duration of video transition.

`offset`{.sample}

:   Set time of start of transition relative to first video.

The program source file must contain a kernel function with the given
name, which will be run once for each plane of the output. Each run on a
plane gets enqueued as a separate 2D global NDRange with one work-item
for each pixel to be generated. The global ID offset for each work-item
is therefore the coordinates of a pixel in the destination image.

The kernel function needs to take the following arguments:

- Destination image, `__write_only image2d_t`{.variable}.

  This image will become the output; the kernel should write all of it.

- First Source image, `__read_only image2d_t`{.variable}. Second Source
  image, `__read_only image2d_t`{.variable}.

  These are the most recent images on each input. The kernel may read
  from them to generate the output, but they can't be written to.

- Transition progress, `float`{.variable}. This value is always between
  0 and 1 inclusive.

Example programs:

- Apply dots curtain transition effect:

  ``` verbatim
  __kernel void blend_images(__write_only image2d_t dst,
                             __read_only  image2d_t src1,
                             __read_only  image2d_t src2,
                             float progress)
  {
      const sampler_t sampler = (CLK_NORMALIZED_COORDS_FALSE |
                                 CLK_FILTER_LINEAR);
      int2  p = (int2)(get_global_id(0), get_global_id(1));
      float2 rp = (float2)(get_global_id(0), get_global_id(1));
      float2 dim = (float2)(get_image_dim(src1).x, get_image_dim(src1).y);
      rp = rp / dim;

      float2 dots = (float2)(20.0, 20.0);
      float2 center = (float2)(0,0);
      float2 unused;

      float4 val1 = read_imagef(src1, sampler, p);
      float4 val2 = read_imagef(src2, sampler, p);
      bool next = distance(fract(rp * dots, &unused), (float2)(0.5, 0.5)) < (progress / distance(rp, center));

      write_imagef(dst, p, next ? val1 : val2);
  }
  ```

[]{#VAAPI-Video-Filters}

## [42 VAAPI Video Filters](#toc-VAAPI-Video-Filters) {#vaapi-video-filters .chapter}

VAAPI Video filters are usually used with VAAPI decoder and VAAPI
encoder. Below is a description of VAAPI video filters.

To enable compilation of these filters you need to configure FFmpeg with
`--enable-vaapi`.

To use vaapi filters, you need to setup the vaapi device correctly. For
more information, please read
<https://trac.ffmpeg.org/wiki/Hardware/VAAPI>

[]{#overlay_005fvaapi}

### [42.1 overlay_vaapi](#toc-overlay_005fvaapi) {#overlay_vaapi .section}

Overlay one video on the top of another.

It takes two inputs and has one output. The first input is the \"main\"
video on which the second input is overlaid.

The filter accepts the following options:

`x`{.sample}\
`y`{.sample}

:   Set expressions for the x and y coordinates of the overlaid video on
    the main video.

    Default value is \"0\" for both expressions.

`w`{.sample}\
`h`{.sample}

:   Set expressions for the width and height the overlaid video on the
    main video.

    Default values are 'overlay_iw' for 'w' and
    'overlay_ih\*w/overlay_iw' for 'h'.

    The expressions can contain the following parameters:

    `main_w, W`{.sample}\
    `main_h, H`{.sample}

    :   The main input width and height.

    `overlay_iw`{.sample}\
    `overlay_ih`{.sample}

    :   The overlay input width and height.

    `overlay_w, w`{.sample}\
    `overlay_h, h`{.sample}

    :   The overlay output width and height.

    `overlay_x, x`{.sample}\
    `overlay_y, y`{.sample}

    :   Position of the overlay layer inside of main

`alpha`{.sample}

:   Set transparency of overlaid video. Allowed range is 0.0 to 1.0.
    Higher value means lower transparency. Default value is `1.0`.

`eof_action`{.sample}

:   See [framesync](#framesync).

`shortest`{.sample}

:   See [framesync](#framesync).

`repeatlast`{.sample}

:   See [framesync](#framesync).

This filter also supports the [framesync](#framesync) options.

[]{#Examples-198}

#### [42.1.1 Examples](#toc-Examples-198) {#examples-198 .subsection}

- Overlay an image LOGO at the top-left corner of the INPUT video. Both
  inputs for this filter are yuv420p format.

  ::: example
  ``` example
  -i INPUT -i LOGO -filter_complex "[0:v]hwupload[a], [1:v]format=yuv420p, hwupload[b], [a][b]overlay_vaapi" OUTPUT
  ```
  :::
- Overlay an image LOGO at the offset (200, 100) from the top-left
  corner of the INPUT video. The inputs have same memory layout for
  color channels, the overlay has additional alpha plane, like INPUT is
  yuv420p, and the LOGO is yuva420p.

  ::: example
  ``` example
  -i INPUT -i LOGO -filter_complex "[0:v]hwupload[a], [1:v]format=yuva420p, hwupload[b], [a][b]overlay_vaapi=x=200:y=100:w=400:h=300:alpha=1.0, hwdownload, format=nv12" OUTPUT
  ```
  :::

[]{#tonemap_005fvaapi}

### [42.2 tonemap_vaapi](#toc-tonemap_005fvaapi) {#tonemap_vaapi .section}

Perform HDR-to-SDR or HDR-to-HDR tone-mapping. It currently only accepts
HDR10 as input.

It accepts the following parameters:

`format`{.sample}

:   Specify the output pixel format.

    Default is nv12 for HDR-to-SDR tone-mapping and p010 for HDR-to-HDR
    tone-mapping.

`primaries, p`{.sample}

:   Set the output color primaries.

    Default is bt709 for HDR-to-SDR tone-mapping and same as input for
    HDR-to-HDR tone-mapping.

`transfer, t`{.sample}

:   Set the output transfer characteristics.

    Default is bt709 for HDR-to-SDR tone-mapping and same as input for
    HDR-to-HDR tone-mapping.

`matrix, m`{.sample}

:   Set the output colorspace matrix.

    Default is bt709 for HDR-to-SDR tone-mapping and same as input for
    HDR-to-HDR tone-mapping.

`display`{.sample}

:   Set the output mastering display colour volume. It is given by a
    '\|'-separated list of two values, two values are space separated.
    It set display primaries x & y in G, B, R order, then white point x
    & y, the nominal minimum & maximum display luminances.

    HDR-to-HDR tone-mapping will be performed when this option is set.

`light`{.sample}

:   Set the output content light level information. It accepts 2
    space-separated values, the first input is the maximum light level
    and the second input is the maximum average light level.

    It is ignored for HDR-to-SDR tone-mapping, and optional for
    HDR-to-HDR tone-mapping.

[]{#Example-19}

#### [42.2.1 Example](#toc-Example-19) {#example-19 .subsection}

- Convert HDR(HDR10) video to bt2020-transfer-characteristic p010 format

  ::: example
  ``` example
  tonemap_vaapi=format=p010:t=bt2020-10
  ```
  :::
- Convert HDR video to HDR video

  ::: example
  ``` example
  tonemap_vaapi=display=7500\ 3000|34000\ 16000|13250\ 34500|15635\ 16450|500\ 10000000
  ```
  :::

[]{#hstack_005fvaapi}

### [42.3 hstack_vaapi](#toc-hstack_005fvaapi) {#hstack_vaapi .section}

Stack input videos horizontally.

This is the VA-API variant of the [hstack](#hstack) filter, each input
stream may have different height, this filter will scale down/up each
input stream while keeping the original aspect.

It accepts the following options:

`inputs`{.sample}

:   See [hstack](#hstack).

`shortest`{.sample}

:   See [hstack](#hstack).

`height`{.sample}

:   Set height of output. If set to 0, this filter will set height of
    output to height of the first input stream. Default value is 0.

[]{#vstack_005fvaapi}

### [42.4 vstack_vaapi](#toc-vstack_005fvaapi) {#vstack_vaapi .section}

Stack input videos vertically.

This is the VA-API variant of the [vstack](#vstack) filter, each input
stream may have different width, this filter will scale down/up each
input stream while keeping the original aspect.

It accepts the following options:

`inputs`{.sample}

:   See [vstack](#vstack).

`shortest`{.sample}

:   See [vstack](#vstack).

`width`{.sample}

:   Set width of output. If set to 0, this filter will set width of
    output to width of the first input stream. Default value is 0.

[]{#xstack_005fvaapi}

### [42.5 xstack_vaapi](#toc-xstack_005fvaapi) {#xstack_vaapi .section}

Stack video inputs into custom layout.

This is the VA-API variant of the [xstack](#xstack) filter, each input
stream may have different size, this filter will scale down/up each
input stream to the given output size, or the size of the first input
stream.

It accepts the following options:

`inputs`{.sample}

:   See [xstack](#xstack).

`shortest`{.sample}

:   See [xstack](#xstack).

`layout`{.sample}

:   See [xstack](#xstack). Moreover, this permits the user to supply
    output size for each input stream.

    ::: example
    ``` example
    xstack_vaapi=inputs=4:layout=0_0_1920x1080|0_h0_1920x1080|w0_0_1920x1080|w0_h0_1920x1080
    ```
    :::

`grid`{.sample}

:   See [xstack](#xstack).

`grid_tile_size`{.sample}

:   Set output size for each input stream when `grid`{.sample} is set.
    If this option is not set, this filter will set output size by
    default to the size of the first input stream. For the syntax of
    this option, check the [(ffmpeg-utils)\"Video size\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#video-size-syntax).

`fill`{.sample}

:   See [xstack](#xstack).

[]{#pad_005fvaapi}

### [42.6 pad_vaapi](#toc-pad_005fvaapi) {#pad_vaapi .section}

Add paddings to the input image, and place the original input at the
provided `x`{.variable}, `y`{.variable} coordinates.

It accepts the following options:

`width, w`{.sample}\
`height, h`{.sample}

:   Specify an expression for the size of the output image with the
    paddings added. If the value for `width`{.variable} or
    `height`{.variable} is 0, the corresponding input size is used for
    the output.

    The `width`{.variable} expression can reference the value set by the
    `height`{.variable} expression, and vice versa.

    The default value of `width`{.variable} and `height`{.variable} is
    0.

`x`{.sample}\
`y`{.sample}

:   Specify the offsets to place the input image at within the padded
    area, with respect to the top/left border of the output image.

    The `x`{.variable} expression can reference the value set by the
    `y`{.variable} expression, and vice versa.

    The default value of `x`{.variable} and `y`{.variable} is 0.

    If `x`{.variable} or `y`{.variable} evaluate to a negative number,
    they'll be changed so the input image is centered on the padded
    area.

`color`{.sample}

:   Specify the color of the padded area. For the syntax of this option,
    check the [(ffmpeg-utils)\"Color\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#color-syntax).

`aspect`{.sample}

:   Pad to an aspect instead to a resolution.

The value for the `width`{.variable}, `height`{.variable},
`x`{.variable}, and `y`{.variable} options are expressions containing
the following constants:

`in_w`{.sample}\
`in_h`{.sample}

:   The input video width and height.

`iw`{.sample}\
`ih`{.sample}

:   These are the same as `in_w`{.variable} and `in_h`{.variable}.

`out_w`{.sample}\
`out_h`{.sample}

:   The output width and height (the size of the padded area), as
    specified by the `width`{.variable} and `height`{.variable}
    expressions.

`ow`{.sample}\
`oh`{.sample}

:   These are the same as `out_w`{.variable} and `out_h`{.variable}.

`x`{.sample}\
`y`{.sample}

:   The x and y offsets as specified by the `x`{.variable} and
    `y`{.variable} expressions, or NAN if not yet specified.

`a`{.sample}

:   same as `iw`{.variable} / `ih`{.variable}

`sar`{.sample}

:   input sample aspect ratio

`dar`{.sample}

:   input display aspect ratio, it is the same as (`iw`{.variable} /
    `ih`{.variable}) \* `sar`{.variable}

[]{#drawbox_005fvaapi}

### [42.7 drawbox_vaapi](#toc-drawbox_005fvaapi) {#drawbox_vaapi .section}

Draw a colored box on the input image.

It accepts the following parameters:

`x`{.sample}\
`y`{.sample}

:   The expressions which specify the top left corner coordinates of the
    box. It defaults to 0.

`width, w`{.sample}\
`height, h`{.sample}

:   The expressions which specify the width and height of the box; if 0
    they are interpreted as the input width and height. It defaults to
    0.

`color, c`{.sample}

:   Specify the color of the box to write. For the general syntax of
    this option, check the [(ffmpeg-utils)\"Color\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#color-syntax).

`thickness, t`{.sample}

:   The expression which sets the thickness of the box edge. A value of
    `fill` will create a filled box. Default value is `3`.

    See below for the list of accepted constants.

`replace`{.sample}

:   With value `1`, the pixels of the painted box will overwrite the
    video's color and alpha pixels. Default is `0`, which composites the
    box onto the input video.

The parameters for `x`{.variable}, `y`{.variable}, `w`{.variable} and
`h`{.variable} and `t`{.variable} are expressions containing the
following constants:

`in_h, ih`{.sample}\
`in_w, iw`{.sample}

:   The input width and height.

`x`{.sample}\
`y`{.sample}

:   The x and y offset coordinates where the box is drawn.

`w`{.sample}\
`h`{.sample}

:   The width and height of the drawn box.

`t`{.sample}

:   The thickness of the drawn box.

[]{#Examples-199}

#### [42.7.1 Examples](#toc-Examples-199) {#examples-199 .subsection}

- Draw a black box around the edge of the input image:

  ::: example
  ``` example
  drawbox
  ```
  :::

- Draw a box with color red and an opacity of 50%:

  ::: example
  ``` example
  drawbox=10:20:200:60:red@0.5
  ```
  :::

  The previous example can be specified as:

  ::: example
  ``` example
  drawbox=x=10:y=20:w=200:h=60:color=red@0.5
  ```
  :::

- Fill the box with pink color:

  ::: example
  ``` example
  drawbox=x=10:y=10:w=100:h=100:color=pink@0.5:t=fill
  ```
  :::

- Draw a 2-pixel red 2.40:1 mask:

  ::: example
  ``` example
  drawbox=x=-t:y=0.5*(ih-iw/2.4)-t:w=iw+t*2:h=iw/2.4+t*2:t=2:c=red
  ```
  :::

[]{#VideoToolbox-Video-Filters}

## [43 VideoToolbox Video Filters](#toc-VideoToolbox-Video-Filters) {#videotoolbox-video-filters .chapter}

Below is a description of the currently available VideoToolbox video
filters.

VideoToolbox filter depends on VideoToolbox framework, and is auto
detected when building ffmpeg for an Apple platform such as macOS. Add
`--enable-videotoolbox` to configure if autodetect is disabled.

[]{#scale_005fvt}

### [43.1 scale_vt](#toc-scale_005fvt) {#scale_vt .section}

Scale and convert the color parameters using VTPixelTransferSession.

The filter accepts the following options:

`w`{.sample}\
`h`{.sample}

:   Set the output video dimension expression. Default value is the
    input dimension.

`color_matrix`{.sample}

:   Set the output colorspace matrix.

`color_primaries`{.sample}

:   Set the output color primaries.

`color_transfer`{.sample}

:   Set the output transfer characteristics.

[]{#Examples-200}

#### [43.1.1 Examples](#toc-Examples-200) {#examples-200 .subsection}

- Perform HDR to SDR conversion, and scale to half size of input

  ::: example
  ``` example
  ffmpeg -hwaccel videotoolbox \
          -hwaccel_output_format videotoolbox_vld \
          -i hdr.mov \
          -c:v hevc_videotoolbox \
          -profile:v main \
          -b:v 3M \
          -vf scale_vt=w=iw/2:h=ih/2:color_matrix=bt709:color_primaries=bt709:color_transfer=bt709 \
          -c:a copy \
          -tag:v hvc1 \
          sdr.mp4
  ```
  :::

[]{#transpose_005fvt}

### [43.2 transpose_vt](#toc-transpose_005fvt) {#transpose_vt .section}

Transpose rows with columns in the input video and optionally flip it.
For more in depth examples see the [transpose](#transpose) video filter,
which shares mostly the same options.

It accepts the following parameters:

`dir`{.sample}

:   Specify the transposition direction.

    Can assume the following values:

    '`cclock_flip`{.sample}'

    :   Rotate by 90 degrees counterclockwise and vertically flip.
        (default)

    '`clock`{.sample}'

    :   Rotate by 90 degrees clockwise.

    '`cclock`{.sample}'

    :   Rotate by 90 degrees counterclockwise.

    '`clock_flip`{.sample}'

    :   Rotate by 90 degrees clockwise and vertically flip.

    '`hflip`{.sample}'

    :   Flip the input video horizontally.

    '`vflip`{.sample}'

    :   Flip the input video vertically.

`passthrough`{.sample}

:   Do not apply the transposition if the input geometry matches the one
    specified by the specified value. It accepts the following values:

    '`none`{.sample}'

    :   Always apply transposition. (default)

    '`portrait`{.sample}'

    :   Preserve portrait geometry (when `height`{.variable} \>=
        `width`{.variable}).

    '`landscape`{.sample}'

    :   Preserve landscape geometry (when `width`{.variable} \>=
        `height`{.variable}).

[]{#Vulkan-Video-Filters}

## [44 Vulkan Video Filters](#toc-Vulkan-Video-Filters) {#vulkan-video-filters .chapter}

Below is a description of the currently available Vulkan video filters.

To enable compilation of these filters you need to configure FFmpeg with
`--enable-vulkan` and either `--enable-libglslang` or
`--enable-libshaderc`.

Running Vulkan filters requires you to initialize a hardware device and
to pass that device to all filters in any filter graph.

`-init_hw_device vulkan[=`{.sample}`name`{.variable}`][:`{.sample}`device`{.variable}`[,`{.sample}`key=value`{.variable}`...]]`{.sample}

:   Initialise a new hardware device of type `vulkan`{.variable} called
    `name`{.variable}, using the given device parameters and options in
    `key=value`{.variable}. The following options are supported:

    `debug`{.sample}

    :   Switches validation layers on if set to 1.

    `linear_images`{.sample}

    :   Allocates linear images. Does not apply to decoding.

    `disable_multiplane`{.sample}

    :   Disables multiplane images. Does not apply to decoding.

    `avoid_host_import`{.sample}

    :   Avoids the use of dynamic host memory imports, in favor of a
        regular memcpy() into a previously mapped buffer.

`-filter_hw_device `{.sample}`name`{.variable}

:   Pass the hardware device called `name`{.variable} to all filters in
    any filter graph.

For more detailed information see
<https://www.ffmpeg.org/ffmpeg.html#Advanced-Video-options>

- Example of choosing the first device and running nlmeans_vulkan filter
  with default parameters on it.

  ::: example
  ``` example
  -init_hw_device vulkan=vk:0 -filter_hw_device vk -i INPUT -vf "hwupload,nlmeans_vulkan,hwdownload" OUTPUT
  ```
  :::

As Vulkan filters are not able to access frame data in normal memory,
all frame data needs to be uploaded ([hwupload](#hwupload)) to hardware
surfaces connected to the appropriate device before being used and then
downloaded ([hwdownload](#hwdownload)) back to normal memory. Note that
[hwupload](#hwupload) will upload to a frame with the same layout as the
software frame, so it may be necessary to add a [format](#format) filter
immediately before to get the input into the right format and
[hwdownload](#hwdownload) does not support all formats on the output -
it is usually necessary to insert an additional [format](#format) filter
immediately following in the graph to get the output in a supported
format.

[]{#avgblur_005fvulkan}

### [44.1 avgblur_vulkan](#toc-avgblur_005fvulkan) {#avgblur_vulkan .section}

Apply an average blur filter, implemented on the GPU using Vulkan.

The filter accepts the following options:

`sizeX`{.sample}

:   Set horizontal radius size. Range is `[1, 32]` and default value is
    `3`.

`sizeY`{.sample}

:   Set vertical radius size. Range is `[1, 32]` and default value is
    `3`.

`planes`{.sample}

:   Set which planes to filter. Default value is `0xf`, by which all
    planes are processed.

[]{#blend_005fvulkan}

### [44.2 blend_vulkan](#toc-blend_005fvulkan) {#blend_vulkan .section}

Blend two Vulkan frames into each other.

The `blend` filter takes two input streams and outputs one stream, the
first input is the \"top\" layer and second input is \"bottom\" layer.
By default, the output terminates when the longest input terminates.

A description of the accepted options follows.

`c0_mode`{.sample}

`c1_mode`{.sample}

`c2_mode`{.sample}

`c3_mode`{.sample}

`all_mode`{.sample}

Set blend mode for specific pixel component or all pixel components in
case of `all_mode`{.variable}. Default value is `normal`.

Available values for component modes are:

'`normal`{.sample}'

'`multiply`{.sample}'

[]{#bwdif_005fvulkan}

### [44.3 bwdif_vulkan](#toc-bwdif_005fvulkan) {#bwdif_vulkan .section}

Deinterlacer using [bwdif](#bwdif), the \"Bob Weaver Deinterlacing
Filter\" algorithm, implemented on the GPU using Vulkan.

It accepts the following parameters:

`mode`{.sample}

:   The interlacing mode to adopt. It accepts one of the following
    values:

    `0, send_frame`{.sample}

    :   Output one frame for each frame.

    `1, send_field`{.sample}

    :   Output one frame for each field.

    The default value is `send_field`.

`parity`{.sample}

:   The picture field parity assumed for the input interlaced video. It
    accepts one of the following values:

    `0, tff`{.sample}

    :   Assume the top field is first.

    `1, bff`{.sample}

    :   Assume the bottom field is first.

    `-1, auto`{.sample}

    :   Enable automatic detection of field parity.

    The default value is `auto`. If the interlacing is unknown or the
    decoder does not export this information, top field first will be
    assumed.

`deint`{.sample}

:   Specify which frames to deinterlace. Accepts one of the following
    values:

    `0, all`{.sample}

    :   Deinterlace all frames.

    `1, interlaced`{.sample}

    :   Only deinterlace frames marked as interlaced.

    The default value is `all`.

[]{#chromaber_005fvulkan}

### [44.4 chromaber_vulkan](#toc-chromaber_005fvulkan) {#chromaber_vulkan .section}

Apply an effect that emulates chromatic aberration. Works best with RGB
inputs, but provides a similar effect with YCbCr inputs too.

`dist_x`{.sample}

:   Horizontal displacement multiplier. Each chroma pixel's position
    will be multiplied by this amount, starting from the center of the
    image. Default is `0`.

`dist_y`{.sample}

:   Similarly, this sets the vertical displacement multiplier. Default
    is `0`.

[]{#color_005fvulkan}

### [44.5 color_vulkan](#toc-color_005fvulkan) {#color_vulkan .section}

Video source that creates a Vulkan frame of a solid color. Useful for
benchmarking, or overlaying.

It accepts the following parameters:

`color`{.sample}

:   The color to use. Either a name, or a hexadecimal value. The default
    value is `black`.

`size`{.sample}

:   The size of the output frame. Default value is `1920x1080`.

`rate`{.sample}

:   The framerate to output at. Default value is `60` frames per second.

`duration`{.sample}

:   The video duration. Default value is `-0.000001`.

`sar`{.sample}

:   The video signal aspect ratio. Default value is `1/1`.

`format`{.sample}

:   The pixel format of the output Vulkan frames. Default value is
    `yuv444p`.

`out_range`{.sample}

:   Set the output YCbCr sample range.

    This allows the autodetected value to be overridden as well as
    allows forcing a specific value used for the output and encoder. If
    not specified, the range depends on the pixel format. Possible
    values:

    '`auto/unknown`{.sample}'

    :   Choose automatically.

    '`jpeg/full/pc`{.sample}'

    :   Set full range (0-255 in case of 8-bit luma).

    '`mpeg/limited/tv`{.sample}'

    :   Set \"MPEG\" range (16-235 in case of 8-bit luma).

[]{#vflip_005fvulkan}

### [44.6 vflip_vulkan](#toc-vflip_005fvulkan) {#vflip_vulkan .section}

Flips an image vertically.

[]{#hflip_005fvulkan}

### [44.7 hflip_vulkan](#toc-hflip_005fvulkan) {#hflip_vulkan .section}

Flips an image horizontally.

[]{#flip_005fvulkan}

### [44.8 flip_vulkan](#toc-flip_005fvulkan) {#flip_vulkan .section}

Flips an image along both the vertical and horizontal axis.

[]{#gblur_005fvulkan}

### [44.9 gblur_vulkan](#toc-gblur_005fvulkan) {#gblur_vulkan .section}

Apply Gaussian blur filter on Vulkan frames.

The filter accepts the following options:

`sigma`{.sample}

:   Set horizontal sigma, standard deviation of Gaussian blur. Default
    is `0.5`.

`sigmaV`{.sample}

:   Set vertical sigma, if negative it will be same as `sigma`. Default
    is `-1`.

`planes`{.sample}

:   Set which planes to filter. By default all planes are filtered.

`size`{.sample}

:   Set the kernel size along the horizontal axis. Default is `19`.

`sizeV`{.sample}

:   Set the kernel size along the vertical axis. Default is `0`, which
    sets to use the same value as `size`{.variable}.

[]{#nlmeans_005fvulkan}

### [44.10 nlmeans_vulkan](#toc-nlmeans_005fvulkan) {#nlmeans_vulkan .section}

Denoise frames using Non-Local Means algorithm, implemented on the GPU
using Vulkan. Supports more pixel formats than [nlmeans](#nlmeans) or
[nlmeans_opencl](#nlmeans_005fopencl), including alpha channel support.

The filter accepts the following options.

`s`{.sample}

:   Set denoising strength for all components. Default is 1.0. Must be
    in range \[0.0, 100.0\].

`p`{.sample}

:   Set patch size for all planes. Default is 7. Must be odd number in
    range \[0, 99\].

`r`{.sample}

:   Set research size. Default is 15. Must be odd number in range \[0,
    99\].

`t`{.sample}

:   Set parallelism. Default is 8. Must be a number in the range \[1,
    64\]. Larger values will use more VRAM but may not result in greater
    speed. The optimal value is hardware and input dependent.

`s0`{.sample}\
`s1`{.sample}\
`s2`{.sample}\
`s3`{.sample}

:   Set denoising strength for a specific component. Default is
    `1.0`{.variable}, equal to `s`{.sample}. Must be in range \[0.0,
    100.0\]. 0.0 disables denoising in that component.

`p0`{.sample}\
`p1`{.sample}\
`p2`{.sample}\
`p3`{.sample}

:   Set patch size for a specific component. Default is `7`{.variable},
    equal to `p`{.sample}. Must be odd number in range \[0, 99\].

[]{#overlay_005fvulkan}

### [44.11 overlay_vulkan](#toc-overlay_005fvulkan) {#overlay_vulkan .section}

Overlay one video on top of another.

It takes two inputs and has one output. The first input is the \"main\"
video on which the second input is overlaid. This filter requires all
inputs to use the same pixel format. So, format conversion may be
needed.

The filter accepts the following options:

`x`{.sample}

:   Set the x coordinate of the overlaid video on the main video.
    Default value is `0`.

`y`{.sample}

:   Set the y coordinate of the overlaid video on the main video.
    Default value is `0`.

[]{#transpose_005fvulkan}

### [44.12 transpose_vulkan](#toc-transpose_005fvulkan) {#transpose_vulkan .section}

Transpose rows with columns in the input video and optionally flip it.
For more in depth examples see the [transpose](#transpose) video filter,
which shares mostly the same options.

It accepts the following parameters:

`dir`{.sample}

:   Specify the transposition direction.

    Can assume the following values:

    '`cclock_flip`{.sample}'

    :   Rotate by 90 degrees counterclockwise and vertically flip.
        (default)

    '`clock`{.sample}'

    :   Rotate by 90 degrees clockwise.

    '`cclock`{.sample}'

    :   Rotate by 90 degrees counterclockwise.

    '`clock_flip`{.sample}'

    :   Rotate by 90 degrees clockwise and vertically flip.

`passthrough`{.sample}

:   Do not apply the transposition if the input geometry matches the one
    specified by the specified value. It accepts the following values:

    '`none`{.sample}'

    :   Always apply transposition. (default)

    '`portrait`{.sample}'

    :   Preserve portrait geometry (when `height`{.variable} \>=
        `width`{.variable}).

    '`landscape`{.sample}'

    :   Preserve landscape geometry (when `width`{.variable} \>=
        `height`{.variable}).

[]{#QSV-Video-Filters}

## [45 QSV Video Filters](#toc-QSV-Video-Filters) {#qsv-video-filters .chapter}

Below is a description of the currently available QSV video filters.

To enable compilation of these filters you need to configure FFmpeg with
`--enable-libmfx` or `--enable-libvpl`.

To use QSV filters, you need to setup the QSV device correctly. For more
information, please read
<https://trac.ffmpeg.org/wiki/Hardware/QuickSync>

[]{#hstack_005fqsv}

### [45.1 hstack_qsv](#toc-hstack_005fqsv) {#hstack_qsv .section}

Stack input videos horizontally.

This is the QSV variant of the [hstack](#hstack) filter, each input
stream may have different height, this filter will scale down/up each
input stream while keeping the original aspect.

It accepts the following options:

`inputs`{.sample}

:   See [hstack](#hstack).

`shortest`{.sample}

:   See [hstack](#hstack).

`height`{.sample}

:   Set height of output. If set to 0, this filter will set height of
    output to height of the first input stream. Default value is 0.

[]{#vstack_005fqsv}

### [45.2 vstack_qsv](#toc-vstack_005fqsv) {#vstack_qsv .section}

Stack input videos vertically.

This is the QSV variant of the [vstack](#vstack) filter, each input
stream may have different width, this filter will scale down/up each
input stream while keeping the original aspect.

It accepts the following options:

`inputs`{.sample}

:   See [vstack](#vstack).

`shortest`{.sample}

:   See [vstack](#vstack).

`width`{.sample}

:   Set width of output. If set to 0, this filter will set width of
    output to width of the first input stream. Default value is 0.

[]{#xstack_005fqsv}

### [45.3 xstack_qsv](#toc-xstack_005fqsv) {#xstack_qsv .section}

Stack video inputs into custom layout.

This is the QSV variant of the [xstack](#xstack) filter.

It accepts the following options:

`inputs`{.sample}

:   See [xstack](#xstack).

`shortest`{.sample}

:   See [xstack](#xstack).

`layout`{.sample}

:   See [xstack](#xstack). Moreover, this permits the user to supply
    output size for each input stream.

    ::: example
    ``` example
    xstack_qsv=inputs=4:layout=0_0_1920x1080|0_h0_1920x1080|w0_0_1920x1080|w0_h0_1920x1080
    ```
    :::

`grid`{.sample}

:   See [xstack](#xstack).

`grid_tile_size`{.sample}

:   Set output size for each input stream when `grid`{.sample} is set.
    If this option is not set, this filter will set output size by
    default to the size of the first input stream. For the syntax of
    this option, check the [(ffmpeg-utils)\"Video size\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#video-size-syntax).

`fill`{.sample}

:   See [xstack](#xstack).

[]{#Video-Sources}

## [46 Video Sources](#toc-Video-Sources) {#video-sources .chapter}

Below is a description of the currently available video sources.

[]{#buffer}

### [46.1 buffer](#toc-buffer) {#buffer .section}

Buffer video frames, and make them available to the filter chain.

This source is mainly intended for a programmatic use, in particular
through the interface defined in `libavfilter/buffersrc.h`{.sample}.

It accepts the following parameters:

`video_size`{.sample}

:   Specify the size (width and height) of the buffered video frames.
    For the syntax of this option, check the [(ffmpeg-utils)\"Video
    size\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#video-size-syntax).

`width`{.sample}

:   The input video width.

`height`{.sample}

:   The input video height.

`pix_fmt`{.sample}

:   A string representing the pixel format of the buffered video frames.
    It may be a number corresponding to a pixel format, or a pixel
    format name.

`time_base`{.sample}

:   Specify the timebase assumed by the timestamps of the buffered
    frames.

`frame_rate`{.sample}

:   Specify the frame rate expected for the video stream.

`colorspace`{.sample}

:   A string representing the color space of the buffered video frames.
    It may be a number corresponding to a color space, or a color space
    name.

`range`{.sample}

:   A string representing the color range of the buffered video frames.
    It may be a number corresponding to a color range, or a color range
    name.

`alpha_mode`{.sample}

:   A string representing the alpha mode of the buffered video frames.
    It may be a number corresponding to an alpha mode, or an alpha mode
    name.

`pixel_aspect, sar`{.sample}

:   The sample (pixel) aspect ratio of the input video.

`hw_frames_ctx`{.sample}

:   When using a hardware pixel format, this should be a reference to an
    AVHWFramesContext describing input frames.

For example:

::: example
``` example
buffer=width=320:height=240:pix_fmt=yuv410p:time_base=1/24:sar=1
```
:::

will instruct the source to accept video frames with size 320x240 and
with format \"yuv410p\", assuming 1/24 as the timestamps timebase and
square pixels (1:1 sample aspect ratio). Since the pixel format with
name \"yuv410p\" corresponds to the number 6 (check the enum
AVPixelFormat definition in `libavutil/pixfmt.h`{.sample}), this example
corresponds to:

::: example
``` example
buffer=size=320x240:pixfmt=6:time_base=1/24:pixel_aspect=1/1
```
:::

Alternatively, the options can be specified as a flat string, but this
syntax is deprecated:

`width`{.variable}:`height`{.variable}:`pix_fmt`{.variable}:`time_base.num`{.variable}:`time_base.den`{.variable}:`pixel_aspect.num`{.variable}:`pixel_aspect.den`{.variable}

[]{#cellauto}

### [46.2 cellauto](#toc-cellauto) {#cellauto .section}

Create a pattern generated by an elementary cellular automaton.

The initial state of the cellular automaton can be defined through the
`filename`{.sample} and `pattern`{.sample} options. If such options are
not specified an initial state is created randomly.

At each new frame a new row in the video is filled with the result of
the cellular automaton next generation. The behavior when the whole
frame is filled is defined by the `scroll`{.sample} option.

This source accepts the following options:

`filename, f`{.sample}

:   Read the initial cellular automaton state, i.e. the starting row,
    from the specified file. In the file, each non-whitespace character
    is considered an alive cell, a newline will terminate the row, and
    further characters in the file will be ignored.

`pattern, p`{.sample}

:   Read the initial cellular automaton state, i.e. the starting row,
    from the specified string.

    Each non-whitespace character in the string is considered an alive
    cell, a newline will terminate the row, and further characters in
    the string will be ignored.

`rate, r`{.sample}

:   Set the video rate, that is the number of frames generated per
    second. Default is 25.

`random_fill_ratio, ratio`{.sample}

:   Set the random fill ratio for the initial cellular automaton row. It
    is a floating point number value ranging from 0 to 1, defaults to
    1/PHI.

    This option is ignored when a file or a pattern is specified.

`random_seed, seed`{.sample}

:   Set the seed for filling randomly the initial row, must be an
    integer included between 0 and UINT32_MAX. If not specified, or if
    explicitly set to -1, the filter will try to use a good random seed
    on a best effort basis.

`rule`{.sample}

:   Set the cellular automaton rule, it is a number ranging from 0
    to 255. Default value is 110.

`size, s`{.sample}

:   Set the size of the output video. For the syntax of this option,
    check the [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#video-size-syntax).

    If `filename`{.sample} or `pattern`{.sample} is specified, the size
    is set by default to the width of the specified initial state row,
    and the height is set to `width`{.variable} \* PHI.

    If `size`{.sample} is set, it must contain the width of the
    specified pattern string, and the specified pattern will be centered
    in the larger row.

    If a filename or a pattern string is not specified, the size value
    defaults to \"320x518\" (used for a randomly generated initial
    state).

`scroll`{.sample}

:   If set to 1, scroll the output upward when all the rows in the
    output have been already filled. If set to 0, the new generated row
    will be written over the top row just after the bottom row is
    filled. Defaults to 1.

`start_full, full`{.sample}

:   If set to 1, completely fill the output with generated rows before
    outputting the first frame. This is the default behavior, for
    disabling set the value to 0.

`stitch`{.sample}

:   If set to 1, stitch the left and right row edges together. This is
    the default behavior, for disabling set the value to 0.

[]{#Examples-201}

#### [46.2.1 Examples](#toc-Examples-201) {#examples-201 .subsection}

- Read the initial state from `pattern`{.sample}, and specify an output
  of size 200x400.

  ::: example
  ``` example
  cellauto=f=pattern:s=200x400
  ```
  :::
- Generate a random initial row with a width of 200 cells, with a fill
  ratio of 2/3:

  ::: example
  ``` example
  cellauto=ratio=2/3:s=200x200
  ```
  :::
- Create a pattern generated by rule 18 starting by a single alive cell
  centered on an initial row with width 100:

  ::: example
  ``` example
  cellauto=p=@:s=100x400:full=0:rule=18
  ```
  :::
- Specify a more elaborated initial pattern:

  ::: example
  ``` example
  cellauto=p='@@ @ @@':s=100x400:full=0:rule=18
  ```
  :::

[]{#coreimagesrc}[]{#coreimagesrc-1}

### [46.3 coreimagesrc](#toc-coreimagesrc-1) {#coreimagesrc .section}

Video source generated on GPU using Apple's CoreImage API on OSX.

This video source is a specialized version of the
[coreimage](#coreimage) video filter. Use a core image generator at the
beginning of the applied filterchain to generate the content.

The coreimagesrc video source accepts the following options:

`list_generators`{.sample}

:   List all available generators along with all their respective
    options as well as possible minimum and maximum values along with
    the default values.

    ::: example
    ``` example
    list_generators=true
    ```
    :::

`size, s`{.sample}

:   Specify the size of the sourced video. For the syntax of this
    option, check the [(ffmpeg-utils)\"Video size\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#video-size-syntax). The
    default value is `320x240`.

`rate, r`{.sample}

:   Specify the frame rate of the sourced video, as the number of frames
    generated per second. It has to be a string in the format
    `frame_rate_num`{.variable}/`frame_rate_den`{.variable}, an integer
    number, a floating point number or a valid video frame rate
    abbreviation. The default value is \"25\".

`sar`{.sample}

:   Set the sample aspect ratio of the sourced video.

`duration, d`{.sample}

:   Set the duration of the sourced video. See [(ffmpeg-utils)the Time
    duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax) for the accepted
    syntax.

    If not specified, or the expressed duration is negative, the video
    is supposed to be generated forever.

Additionally, all options of the [coreimage](#coreimage) video filter
are accepted. A complete filterchain can be used for further processing
of the generated input without CPU-HOST transfer. See
[coreimage](#coreimage) documentation and examples for details.

[]{#Examples-202}

#### [46.3.1 Examples](#toc-Examples-202) {#examples-202 .subsection}

- Use CIQRCodeGenerator to create a QR code for the FFmpeg homepage,
  given as complete and escaped command-line for Apple's standard bash
  shell:

  ::: example
  ``` example
  ffmpeg -f lavfi -i coreimagesrc=s=100x100:filter=CIQRCodeGenerator@inputMessage=https\\\\\://FFmpeg.org/@inputCorrectionLevel=H -frames:v 1 QRCode.png
  ```
  :::

  This example is equivalent to the QRCode example of
  [coreimage](#coreimage) without the need for a nullsrc video source.

[]{#ddagrab}

### [46.4 ddagrab](#toc-ddagrab) {#ddagrab .section}

Captures the Windows Desktop via Desktop Duplication API.

The filter exclusively returns D3D11 Hardware Frames, for on-gpu
encoding or processing. So an explicit [hwdownload](#hwdownload) is
needed for any kind of software processing.

It accepts the following options:

`output_idx`{.sample}

:   DXGI Output Index to capture.

    Usually corresponds to the index Windows has given the screen minus
    one, so it's starting at 0.

    Defaults to output 0.

`draw_mouse`{.sample}

:   Whether to draw the mouse cursor.

    Defaults to true.

    Only affects hardware cursors. If a game or application renders its
    own cursor, it'll always be captured.

`framerate`{.sample}

:   Maximum framerate at which the desktop will be captured - the
    interval between successive frames will not be smaller than the
    inverse of the framerate. When `dup_frames`{.variable} is true (the
    default) and the desktop is not being updated often enough, the
    filter will duplicate a previous frame. Note that there is no
    background buffering going on, so when the filter is not polled
    often enough then the actual inter-frame interval may be
    significantly larger.

    Defaults to 30 FPS.

`video_size`{.sample}

:   Specify the size of the captured video.

    Defaults to the full size of the screen.

    Cropped from the bottom/right if smaller than screen size.

`offset_x`{.sample}

:   Horizontal offset of the captured video.

`offset_y`{.sample}

:   Vertical offset of the captured video.

`output_fmt`{.sample}

:   Desired filter output format. Defaults to 8 Bit BGRA.

    It accepts the following values:

    '`auto`{.sample}'

    :   Passes all supported output formats to DDA and returns what DDA
        decides to use.

    '`8bit`{.sample}'\
    '`bgra`{.sample}'

    :   8 Bit formats always work, and DDA will convert to them if
        necessary.

    '`10bit`{.sample}'\
    '`x2bgr10`{.sample}'

    :   Filter initialization will fail if 10 bit format is requested
        but unavailable.

`dup_frames`{.sample}

:   When this option is set to true (the default), the filter will
    duplicate frames when the desktop has not been updated in order to
    maintain approximately constant target framerate. When this option
    is set to false, the filter will wait for the desktop to be updated
    (inter-frame intervals may vary significantly in this case).

[]{#Examples-203}

#### [46.4.1 Examples](#toc-Examples-203) {#examples-203 .subsection}

Capture primary screen and encode using nvenc:

::: example
``` example
ffmpeg -f lavfi -i ddagrab -c:v h264_nvenc -cq 18 output.mp4
```
:::

You can also skip the lavfi device and directly use the filter. Also
demonstrates downloading the frame and encoding with libx264. Explicit
output format specification is required in this case:

::: example
``` example
ffmpeg -filter_complex ddagrab=output_idx=1:framerate=60,hwdownload,format=bgra -c:v libx264 -crf 18 output.mp4
```
:::

If you want to capture only a subsection of the desktop, this can be
achieved by specifying a smaller size and its offsets into the screen:

::: example
``` example
ddagrab=video_size=800x600:offset_x=100:offset_y=100
```
:::

[]{#gfxcapture}

### [46.5 gfxcapture](#toc-gfxcapture) {#gfxcapture .section}

Capture windows or monitors using Windows.Graphics.Capture API.

This source provides low overhead capture of application windows or
entire monitors. The filter outputs hardware frames in `d3d11` format;
use `hwdownload,format=` if system memory frames are required.

The window to be captured can be selected via regular expressions on its
title, class name or backing executable name, by explicit native
handles, or by monitor index or explicit native handle. A window must
match all provided expressions to be selected. The first matching window
will be picked, in whatever order Windows returns them.

Explicit handles (`hwnd`{.sample}, `hmonitor`{.sample}) override pattern
or index based selection. If neither handles nor a monitor index are
given, the first window matching the provided regular expressions is
captured.

This source does NOT hold a stable FPS. It returns frames at whatever
rate the compositor provides them, only capped by the
`max_framerate`{.sample}. If you need a stable rate, you need to add an
fps filter to drop/duplicate frames as needed.

If the capture source disappears mid-capture (window closed, monitor
disconnected), the filter will return EOF.

This source accepts the following options:

`window_title`{.sample}

:   ECMAScript regular expression matched against the window title.
    Supports a PCRE style `(?i)` prefix for case-insensitive matching.

`window_class`{.sample}

:   As `window_title`{.sample}, but matched against the window class
    name.

`window_exe`{.sample}

:   As `window_title`{.sample}, but matched against the executable file
    name of the window's process.

`monitor_idx`{.sample}

:   Zero-based index of the monitor to capture.

    Can also be set to `window` to capture the monitor the selected
    window is displayed on at filter initialization time.

`hwnd`{.sample}

:   Explicit native window handle (HWND).

`hmonitor`{.sample}

:   Explicit native monitor handle (HMONITOR).

`capture_cursor`{.sample}

:   Capture the mouse cursor. Enabled by default.

`capture_border`{.sample}

:   Capture the full area of the window, including its window
    decorarions/border. Disabled by default.

`display_border`{.sample}

:   Draw a yellow highlight border around the captured window. Disabled
    by default.

`max_framerate`{.sample}

:   Maximum capture frame rate. Accepts a video rate (e.g. `30`, `60/1`,
    `24000/1001`). The default is `60` FPS. The actual rate is the rate
    at which the compositor renders the window/monitor, capped by this
    option.

`width`{.sample}

:   Force the output canvas width. If zero (default) the initial
    captured source width is used. If a negative number is provided, the
    width will be rounded down to the next multiple of that number.

    See `resize_mode`{.sample}.

`height`{.sample}

:   Force the output canvas height. If zero (default) the initial
    captured source height is used. If a negative number is provided,
    the height will be rounded down to the next multiple of that number.

    See `resize_mode`{.sample}.

`crop_left`{.sample}

:   Crop this many pixels from the left side of the captured frames.

`crop_top`{.sample}

:   Crop this many pixels from the left side of the captured frames.

`crop_right`{.sample}

:   Crop this many pixels from the left side of the captured frames.

`crop_bottom`{.sample}

:   Crop this many pixels from the left side of the captured frames.

`premultiplied`{.sample}

:   If set to 1, return frames with premultiplied alpha. Default is 0
    (straight alpha).

`resize_mode`{.sample}

:   Defines how the captured content is fitted into the output canvas
    size. Possible values:

    '`crop`{.sample}'

    :   Crop (or pad with black) to the canvas size. (default)

    '`scale`{.sample}'

    :   Scale the source to fill the canvas, potentially altering aspect
        ratio.

    '`scale_aspect`{.sample}'

    :   Scale the source to fit inside the canvas while preserving
        aspect ratio. Remaining area is filled with black.

`scale_mode`{.sample}

:   Scaling algorithm used when resizing is required.

    Possible values:

    '`point`{.sample}'

    :   Nearest neighbour (pixelated) scaling.

    '`bilinear`{.sample}'

    :   Bilinear filtering. (default)

    '`bicubic`{.sample}'

    :   Bicubic filtering. Potentially more blurry, but fewer scaling
        artifacts depending on contents.

`output_fmt`{.sample}

:   Desired output pixel format inside the D3D11 hardware frames.

    Possible values:

    '`bgra`{.sample}'\
    '`8bit`{.sample}'

    :   8 bit BGRA output (default)

    '`x2bgr10`{.sample}'\
    '`10bit`{.sample}'

    :   10 bit BGR output

    '`rgbaf16`{.sample}'\
    '`16bit`{.sample}'

    :   16bit float RGBA output

[]{#Examples-204}

#### [46.5.1 Examples](#toc-Examples-204) {#examples-204 .subsection}

- Capture a window by title (case-insensitive) at a maximum of 60 fps:

  ::: example
  ``` example
  ffmpeg -filter_complex gfxcapture=window_title='(?i)My Application':max_framerate=60,hwdownload,format=bgra,format=yuv420p -c:v libx264 -crf 15 capture.mp4
  ```
  :::
- Capture monitor 1 at native refresh, 10bit color depth, scale to
  1920x1080 preserving aspect:

  ::: example
  ``` example
  ffmpeg -filter_complex gfxcapture=monitor_idx=1:width=1920:height=1080:resize_mode=scale_aspect:output_fmt=10bit -c:v hevc_nvenc -cq 15 capture.mp4
  ```
  :::
- Capture a window by executable name, draw border, force point scaling,
  fixed 60 fps:

  ::: example
  ``` example
  ffmpeg -filter_complex gfxcapture=window_exe='^firefox.exe$':display_border=1:scale_mode=point,fps=60 -rc qvbr -qvbr_quality_level 15 -c:v h264_amf capture.mp4
  ```
  :::

[]{#gradients}

### [46.6 gradients](#toc-gradients) {#gradients .section}

Generate several gradients.

`size, s`{.sample}

Set frame size. For the syntax of this option, check the
[(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
manual](ffmpeg-utils.html#video-size-syntax). Default value is
\"640x480\".

`rate, r`{.sample}

Set frame rate, expressed as number of frames per second. Default value
is \"25\".

`c0, c1, c2, c3, c4, c5, c6, c7`{.sample}

Set 8 colors. Default values for colors is to pick random one.

`x0, y0, y0, y1`{.sample}

Set gradient line source and destination points. If negative or out of
range, random ones are picked.

`nb_colors, n`{.sample}

Set number of colors to use at once. Allowed range is from 2 to 8.
Default value is 2.

`seed`{.sample}

Set seed for picking gradient line points.

`duration, d`{.sample}

Set the duration of the sourced video. See [(ffmpeg-utils)the Time
duration section in the ffmpeg-utils(1)
manual](ffmpeg-utils.html#time-duration-syntax) for the accepted syntax.

If not specified, or the expressed duration is negative, the video is
supposed to be generated forever.

`speed`{.sample}

Set speed of gradients rotation.

`type, t`{.sample}

Set type of gradients. Available values are:

'`linear`{.sample}'

'`radial`{.sample}'

'`circular`{.sample}'

'`spiral`{.sample}'

'`square`{.sample}'

Default type is `linear`{.variable}.

[]{#Commands-156}

#### [46.6.1 Commands](#toc-Commands-156) {#commands-156 .subsection}

This source supports the some above options as [commands](#commands).

[]{#mandelbrot}

### [46.7 mandelbrot](#toc-mandelbrot) {#mandelbrot .section}

Generate a Mandelbrot set fractal, and progressively zoom towards the
point specified with `start_x`{.variable} and `start_y`{.variable}.

This source accepts the following options:

`end_pts`{.sample}

:   Set the terminal pts value. Default value is 400.

`end_scale`{.sample}

:   Set the terminal scale value. Must be a floating point value.
    Default value is 0.3.

`inner`{.sample}

:   Set the inner coloring mode, that is the algorithm used to draw the
    Mandelbrot fractal internal region.

    It shall assume one of the following values:

    `black`{.sample}

    :   Set black mode.

    `convergence`{.sample}

    :   Show time until convergence.

    `mincol`{.sample}

    :   Set color based on point closest to the origin of the
        iterations.

    `period`{.sample}

    :   Set period mode.

    Default value is `mincol`{.variable}.

`bailout`{.sample}

:   Set the bailout value. Default value is 10.0.

`maxiter`{.sample}

:   Set the maximum of iterations performed by the rendering algorithm.
    Default value is 7189.

`outer`{.sample}

:   Set outer coloring mode. It shall assume one of following values:

    `iteration_count`{.sample}

    :   Set iteration count mode.

    `normalized_iteration_count`{.sample}

    :   set normalized iteration count mode.

    Default value is `normalized_iteration_count`{.variable}.

`rate, r`{.sample}

:   Set frame rate, expressed as number of frames per second. Default
    value is \"25\".

`size, s`{.sample}

:   Set frame size. For the syntax of this option, check the
    [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#video-size-syntax). Default value is
    \"640x480\".

`start_scale`{.sample}

:   Set the initial scale value. Default value is 3.0.

`start_x`{.sample}

:   Set the initial x position. Must be a floating point value between
    -100 and 100. Default value is -0.743643887037158704752191506114774.

`start_y`{.sample}

:   Set the initial y position. Must be a floating point value between
    -100 and 100. Default value is -0.131825904205311970493132056385139.

[]{#mptestsrc}

### [46.8 mptestsrc](#toc-mptestsrc) {#mptestsrc .section}

Generate various test patterns, as generated by the MPlayer test filter.

The size of the generated video is fixed, and is 512x512. This source is
useful in particular for testing encoding features.

This source accepts the following options:

`rate, r`{.sample}

:   Specify the frame rate of the sourced video, as the number of frames
    generated per second. It has to be a string in the format
    `frame_rate_num`{.variable}/`frame_rate_den`{.variable}, an integer
    number, a floating point number or a valid video frame rate
    abbreviation. The default value is \"25\".

`duration, d`{.sample}

:   Set the duration of the sourced video. See [(ffmpeg-utils)the Time
    duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax) for the accepted
    syntax.

    If not specified, or the expressed duration is negative, the video
    is supposed to be generated forever.

`test, t`{.sample}

:   Set the number or the name of the test to perform. Supported tests
    are:

    `dc_luma`{.sample}\
    `dc_chroma`{.sample}\
    `freq_luma`{.sample}\
    `freq_chroma`{.sample}\
    `amp_luma`{.sample}\
    `amp_chroma`{.sample}\
    `cbp`{.sample}\
    `mv`{.sample}\
    `ring1`{.sample}\
    `ring2`{.sample}\
    `all`{.sample}\
    `max_frames, m`{.sample}

    :   Set the maximum number of frames generated for each test,
        default value is 30.

    Default value is \"all\", which will cycle through the list of all
    tests.

Some examples:

::: example
``` example
mptestsrc=t=dc_luma
```
:::

will generate a \"dc_luma\" test pattern.

[]{#frei0r_005fsrc}

### [46.9 frei0r_src](#toc-frei0r_005fsrc) {#frei0r_src .section}

Provide a frei0r source.

To enable compilation of this filter you need to install the frei0r
header and configure FFmpeg with `--enable-frei0r`.

This source accepts the following parameters:

`size`{.sample}

:   The size of the video to generate. For the syntax of this option,
    check the [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#video-size-syntax).

`framerate`{.sample}

:   The framerate of the generated video. It may be a string of the form
    `num`{.variable}/`den`{.variable} or a frame rate abbreviation.

`filter_name`{.sample}

:   The name to the frei0r source to load. For more information
    regarding frei0r and how to set the parameters, read the
    [frei0r](#frei0r) section in the video filters documentation.

`filter_params`{.sample}

:   A '\|'-separated list of parameters to pass to the frei0r source.

For example, to generate a frei0r partik0l source with size 200x200 and
frame rate 10 which is overlaid on the overlay filter main input:

::: example
``` example
frei0r_src=size=200x200:framerate=10:filter_name=partik0l:filter_params=1234 [overlay]; [in][overlay] overlay
```
:::

[]{#life}

### [46.10 life](#toc-life) {#life .section}

Generate a life pattern.

This source is based on a generalization of John Conway's life game.

The sourced input represents a life grid, each pixel represents a cell
which can be in one of two possible states, alive or dead. Every cell
interacts with its eight neighbours, which are the cells that are
horizontally, vertically, or diagonally adjacent.

At each interaction the grid evolves according to the adopted rule,
which specifies the number of neighbor alive cells which will make a
cell stay alive or born. The `rule`{.sample} option allows one to
specify the rule to adopt.

This source accepts the following options:

`filename, f`{.sample}

:   Set the file from which to read the initial grid state. In the file,
    each non-whitespace character is considered an alive cell, and
    newline is used to delimit the end of each row.

    If this option is not specified, the initial grid is generated
    randomly.

`rate, r`{.sample}

:   Set the video rate, that is the number of frames generated per
    second. Default is 25.

`random_fill_ratio, ratio`{.sample}

:   Set the random fill ratio for the initial random grid. It is a
    floating point number value ranging from 0 to 1, defaults to 1/PHI.
    It is ignored when a file is specified.

`random_seed, seed`{.sample}

:   Set the seed for filling the initial random grid, must be an integer
    included between 0 and UINT32_MAX. If not specified, or if
    explicitly set to -1, the filter will try to use a good random seed
    on a best effort basis.

`rule`{.sample}

:   Set the life rule.

    A rule can be specified with a code of the kind
    \"S`NS`{.variable}/B`NB`{.variable}\", where `NS`{.variable} and
    `NB`{.variable} are sequences of numbers in the range 0-8,
    `NS`{.variable} specifies the number of alive neighbor cells which
    make a live cell stay alive, and `NB`{.variable} the number of alive
    neighbor cells which make a dead cell to become alive (i.e. to
    \"born\"). \"s\" and \"b\" can be used in place of \"S\" and \"B\",
    respectively.

    Alternatively a rule can be specified by an 18-bits integer. The 9
    high order bits are used to encode the next cell state if it is
    alive for each number of neighbor alive cells, the low order bits
    specify the rule for \"borning\" new cells. Higher order bits encode
    for an higher number of neighbor cells. For example the number 6153
    = `(12<<9)+9` specifies a stay alive rule of 12 and a born rule of
    9, which corresponds to \"S23/B03\".

    Default value is \"S23/B3\", which is the original Conway's game of
    life rule, and will keep a cell alive if it has 2 or 3 neighbor
    alive cells, and will born a new cell if there are three alive cells
    around a dead cell.

`size, s`{.sample}

:   Set the size of the output video. For the syntax of this option,
    check the [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#video-size-syntax).

    If `filename`{.sample} is specified, the size is set by default to
    the same size of the input file. If `size`{.sample} is set, it must
    contain the size specified in the input file, and the initial grid
    defined in that file is centered in the larger resulting area.

    If a filename is not specified, the size value defaults to
    \"320x240\" (used for a randomly generated initial grid).

`stitch`{.sample}

:   If set to 1, stitch the left and right grid edges together, and the
    top and bottom edges also. Defaults to 1.

`mold`{.sample}

:   Set cell mold speed. If set, a dead cell will go from
    `death_color`{.sample} to `mold_color`{.sample} with a step of
    `mold`{.sample}. `mold`{.sample} can have a value from 0 to 255.

`life_color`{.sample}

:   Set the color of living (or new born) cells.

`death_color`{.sample}

:   Set the color of dead cells. If `mold`{.sample} is set, this is the
    first color used to represent a dead cell.

`mold_color`{.sample}

:   Set mold color, for definitely dead and moldy cells.

    For the syntax of these 3 color options, check the
    [(ffmpeg-utils)\"Color\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#color-syntax).

[]{#Examples-205}

#### [46.10.1 Examples](#toc-Examples-205) {#examples-205 .subsection}

- Read a grid from `pattern`{.sample}, and center it on a grid of size
  300x300 pixels:

  ::: example
  ``` example
  life=f=pattern:s=300x300
  ```
  :::
- Generate a random grid of size 200x200, with a fill ratio of 2/3:

  ::: example
  ``` example
  life=ratio=2/3:s=200x200
  ```
  :::
- Specify a custom rule for evolving a randomly generated grid:

  ::: example
  ``` example
  life=rule=S14/B34
  ```
  :::
- Full example with slow death effect (mold) using `ffplay`:

  ::: example
  ``` example
  ffplay -f lavfi life=s=300x200:mold=10:r=60:ratio=0.1:death_color=#C83232:life_color=#00ff00,scale=1200:800:flags=16
  ```
  :::

[]{#perlin}

### [46.11 perlin](#toc-perlin) {#perlin .section}

Generate Perlin noise.

Perlin noise is a kind of noise with local continuity in space. This can
be used to generate patterns with continuity in space and time, e.g. to
simulate smoke, fluids, or terrain.

In case more than one octave is specified through the `octaves`{.sample}
option, Perlin noise is generated as a sum of components, each one with
doubled frequency. In this case the `persistence`{.sample} option
specify the ratio of the amplitude with respect to the previous
component. More octave components enable to specify more high frequency
details in the generated noise (e.g. small size variations due to
boulders in a generated terrain).

[]{#Options-126}

#### [46.11.1 Options](#toc-Options-126) {#options-126 .subsection}

`size, s`{.sample}

:   Specify the size (width and height) of the buffered video frames.
    For the syntax of this option, check the [(ffmpeg-utils)\"Video
    size\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#video-size-syntax). Default value is
    `320x240`.

`rate, r`{.sample}

:   Specify the frame rate expected for the video stream, expressed as a
    number of frames per second. Default value is `25`.

`octaves`{.sample}

:   Specify the total number of components making up the noise, each one
    with doubled frequency. Default value is `1`.

`persistence`{.sample}

:   Set the ratio used to compute the amplitude of the next octave
    component with respect to the previous component amplitude. Default
    value is `1`.

`xscale`{.sample}\
`yscale`{.sample}

:   Define a scale factor used to multiple the x, y coordinates. This
    can be useful to define an effect with a pattern stretched along the
    x or y axis. Default value is `1`.

`tscale`{.sample}

:   Define a scale factor used to multiple the time coordinate. This can
    be useful to change the time variation speed. Default value is `1`.

`random_mode`{.sample}

:   Set random mode used to compute initial pattern.

    Supported values are:

    `random`{.sample}

    :   Compute and use random seed.

    `ken`{.sample}

    :   Use the predefined initial pattern defined by Ken Perlin in the
        original article, can be useful to compare the output with other
        sources.

    `seed`{.sample}

    :   Use the value specified by `random_seed`{.sample} option.

    Default value is `random`.

`random_seed, seed`{.sample}

:   When `random_mode`{.sample} is set to `random_seed`{.variable}, use
    this value to compute the initial pattern. Default value is `0`.

[]{#Examples-206}

#### [46.11.2 Examples](#toc-Examples-206) {#examples-206 .subsection}

- Generate single component:

  ::: example
  ``` example
  perlin
  ```
  :::
- Use Perlin noise with 7 components, each one with a halved
  contribution to total amplitude:

  ::: example
  ``` example
  perlin=octaves=7:persistence=0.5
  ```
  :::
- Chain Perlin noise with the [lutyuv](#lutyuv) to generate a
  black&white effect:

  ::: example
  ``` example
  perlin=octaves=3:tscale=0.3,lutyuv=y='if(lt(val\,128)\,255\,0)'
  ```
  :::
- Stretch noise along the y axis, and convert gray level to red-only
  signal:

  ::: example
  ``` example
  perlin=octaves=7:tscale=0.4:yscale=0.3,lutrgb=r=val:b=0:g=0
  ```
  :::

[]{#qrencodesrc}

### [46.12 qrencodesrc](#toc-qrencodesrc) {#qrencodesrc .section}

Generate a QR code using the libqrencode library (see
<https://fukuchi.org/works/qrencode/>).

To enable the compilation of this source, you need to configure FFmpeg
with `--enable-libqrencode`.

The QR code is generated from the provided text or text pattern. The
corresponding QR code is scaled and put in the video output according to
the specified output size options.

In case no text is specified, the QR code is not generated, but an empty
colored output is returned instead.

This source accepts the following options:

`qrcode_width, q`{.sample}

`padded_qrcode_width, Q`{.sample}

Specify an expression for the width of the rendered QR code, with and
without padding. The `qrcode_width`{.variable} expression can reference
the value set by the `padded_qrcode_width`{.variable} expression, and
vice versa. By default `padded_qrcode_width`{.variable} is set to
`qrcode_width`{.variable}, meaning that there is no padding.

These expressions are evaluated only once, when initializing the source.
See the [qrencode Expressions](#qrencode_005fexpressions) section for
details.

Note that some of the constants are missing for the source (for example
the `x`{.variable} or `t`{.variable} or `n`{.variable}), since they
only makes sense when evaluating the expression for each frame rather
than at initialization time.

`rate, r`{.sample}

Specify the frame rate of the sourced video, as the number of frames
generated per second. It has to be a string in the format
`frame_rate_num`{.variable}/`frame_rate_den`{.variable}, an integer
number, a floating point number or a valid video frame rate
abbreviation. The default value is \"25\".

`case_sensitive, cs`{.sample}

Instruct libqrencode to use case sensitive encoding. This is enabled by
default. This can be disabled to reduce the QR encoding size.

`level, l`{.sample}

Specify the QR encoding error correction level. With an higher
correction level, the encoding size will increase but the code will be
more robust to corruption. Lower level is `L`{.variable}.

It accepts the following values:

'`L`{.sample}'

'`M`{.sample}'

'`Q`{.sample}'

'`H`{.sample}'

`expansion`{.sample}

Select how the input text is expanded. Can be either `none`, or `normal`
(default). See the [qrencode Text
expansion](#qrencode_005ftext_005fexpansion) section for details.

`text`{.sample}

`textfile`{.sample}

Define the text to be rendered. In case neither is specified, no QR is
encoded (just an empty colored frame).

In case expansion is enabled, the text is treated as a text template,
using the qrencode expansion mechanism. See the [qrencode Text
expansion](#qrencode_005ftext_005fexpansion) section for details.

`background_color, bc`{.sample}

`foreground_color, fc`{.sample}

Set the QR code and background color. The default value of
`foreground_color`{.variable} is \"black\", the default value of
`background_color`{.variable} is \"white\".

For the syntax of the color options, check the [(ffmpeg-utils)\"Color\"
section in the ffmpeg-utils manual](ffmpeg-utils.html#color-syntax).

[]{#Examples-207}

#### [46.12.1 Examples](#toc-Examples-207) {#examples-207 .subsection}

- Generate a QR code encoding the specified text with the default size:

  ::: example
  ``` example
  qrencodesrc=text=www.ffmpeg.org
  ```
  :::
- Same as below, but select blue on pink colors:

  ::: example
  ``` example
  qrencodesrc=text=www.ffmpeg.org:bc=pink:fc=blue
  ```
  :::
- Generate a QR code with width of 200 pixels and padding, making the
  padded width 4/3 of the QR code width:

  ::: example
  ``` example
  qrencodesrc=text=www.ffmpeg.org:q=200:Q=4/3*q
  ```
  :::
- Generate a QR code with padded width of 200 pixels and padding, making
  the QR code width 3/4 of the padded width:

  ::: example
  ``` example
  qrencodesrc=text=www.ffmpeg.org:Q=200:q=3/4*Q
  ```
  :::
- Generate a QR code encoding the frame number:

  ::: example
  ``` example
  qrencodesrc=text=%{n}
  ```
  :::
- Generate a QR code encoding the GMT timestamp:

  ::: example
  ``` example
  qrencodesrc=text=%{gmtime}
  ```
  :::
- Generate a QR code encoding the timestamp expressed as a float:

  ::: example
  ``` example
  qrencodesrc=text=%{pts}
  ```
  :::

[]{#allrgb}[]{#allyuv}[]{#color}[]{#colorchart}[]{#colorspectrum}[]{#haldclutsrc}[]{#nullsrc}[]{#pal75bars}[]{#pal100bars}[]{#rgbtestsrc}[]{#smptebars}[]{#smptehdbars}[]{#testsrc}[]{#testsrc2}[]{#yuvtestsrc}[]{#allrgb_002c-allyuv_002c-color_002c-colorchart_002c-colorspectrum_002c-haldclutsrc_002c-nullsrc_002c-pal75bars_002c-pal100bars_002c-rgbtestsrc_002c-smptebars_002c-smptehdbars_002c-testsrc_002c-testsrc2_002c-yuvtestsrc}

### [46.13 allrgb, allyuv, color, colorchart, colorspectrum, haldclutsrc, nullsrc, pal75bars, pal100bars, rgbtestsrc, smptebars, smptehdbars, testsrc, testsrc2, yuvtestsrc](#toc-allrgb_002c-allyuv_002c-color_002c-colorchart_002c-colorspectrum_002c-haldclutsrc_002c-nullsrc_002c-pal75bars_002c-pal100bars_002c-rgbtestsrc_002c-smptebars_002c-smptehdbars_002c-testsrc_002c-testsrc2_002c-yuvtestsrc) {#allrgb-allyuv-color-colorchart-colorspectrum-haldclutsrc-nullsrc-pal75bars-pal100bars-rgbtestsrc-smptebars-smptehdbars-testsrc-testsrc2-yuvtestsrc .section}

The `allrgb` source returns frames of size 4096x4096 of all rgb colors.

The `allyuv` source returns frames of size 4096x4096 of all yuv colors.

The `color` source provides an uniformly colored input.

The `colorchart` source provides a colors checker chart.

The `colorspectrum` source provides a color spectrum input.

The `haldclutsrc` source provides an identity Hald CLUT. See also
[haldclut](#haldclut) filter.

The `nullsrc` source returns unprocessed video frames. It is mainly
useful to be employed in analysis / debugging tools, or as the source
for filters which ignore the input data.

The `pal75bars` source generates a color bars pattern, based on EBU PAL
recommendations with 75% color levels.

The `pal100bars` source generates a color bars pattern, based on EBU PAL
recommendations with 100% color levels.

The `rgbtestsrc` source generates an RGB test pattern useful for
detecting RGB vs BGR issues. You should see a red, green and blue stripe
from top to bottom.

The `smptebars` source generates a color bars pattern, based on the
SMPTE Engineering Guideline EG 1-1990.

The `smptehdbars` source generates a color bars pattern, based on the
SMPTE RP 219-2002.

The `testsrc` source generates a test video pattern, showing a color
pattern, a scrolling gradient and a timestamp. This is mainly intended
for testing purposes.

The `testsrc2` source is similar to testsrc, but supports more pixel
formats instead of just `rgb24`. This allows using it as an input for
other tests without requiring a format conversion.

The `yuvtestsrc` source generates an YUV test pattern. You should see a
y, cb and cr stripe from top to bottom.

The sources accept the following parameters:

`level`{.sample}

Specify the level of the Hald CLUT, only available in the `haldclutsrc`
source. A level of `N` generates a picture of `N*N*N` by `N*N*N` pixels
to be used as identity matrix for 3D lookup tables. Each component is
coded on a `1/(N*N)` scale.

`color, c`{.sample}

Specify the color of the source, only available in the `color` source.
For the syntax of this option, check the [(ffmpeg-utils)\"Color\"
section in the ffmpeg-utils manual](ffmpeg-utils.html#color-syntax).

`size, s`{.sample}

Specify the size of the sourced video. For the syntax of this option,
check the [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
manual](ffmpeg-utils.html#video-size-syntax). The default value is
`320x240`.

This option is not available with the `allrgb`, `allyuv`, and
`haldclutsrc` filters.

`rate, r`{.sample}

Specify the frame rate of the sourced video, as the number of frames
generated per second. It has to be a string in the format
`frame_rate_num`{.variable}/`frame_rate_den`{.variable}, an integer
number, a floating point number or a valid video frame rate
abbreviation. The default value is \"25\".

`duration, d`{.sample}

Set the duration of the sourced video. See [(ffmpeg-utils)the Time
duration section in the ffmpeg-utils(1)
manual](ffmpeg-utils.html#time-duration-syntax) for the accepted syntax.

If not specified, or the expressed duration is negative, the video is
supposed to be generated forever.

Since the frame rate is used as time base, all frames including the last
one will have their full duration. If the specified duration is not a
multiple of the frame duration, it will be rounded up.

`sar`{.sample}

Set the sample aspect ratio of the sourced video.

`alpha`{.sample}

Specify the alpha (opacity) of the background, only available in the
`testsrc2` source. The value must be between 0 (fully transparent) and
255 (fully opaque, the default).

`decimals, n`{.sample}

Set the number of decimals to show in the timestamp, only available in
the `testsrc` source.

The displayed timestamp value will correspond to the original timestamp
value multiplied by the power of 10 of the specified value. Default
value is 0.

`type`{.sample}

Set the type of the color spectrum, only available in the
`colorspectrum` source. Can be one of the following:

'`black`{.sample}'

'`white`{.sample}'

'`all`{.sample}'

`patch_size`{.sample}

Set patch size of single color patch, only available in the `colorchart`
source. Default is `64x64`.

`preset`{.sample}

Set colorchecker colors preset, only available in the `colorchart`
source.

Available values are:

'`reference`{.sample}'

'`skintones`{.sample}'

Default value is `reference`.

[]{#Examples-208}

#### [46.13.1 Examples](#toc-Examples-208) {#examples-208 .subsection}

- Generate a video with a duration of 5.3 seconds, with size 176x144 and
  a frame rate of 10 frames per second:

  ::: example
  ``` example
  testsrc=duration=5.3:size=qcif:rate=10
  ```
  :::
- The following graph description will generate a red source with an
  opacity of 0.2, with size \"qcif\" and a frame rate of 10 frames per
  second:

  ::: example
  ``` example
  color=c=red@0.2:s=qcif:r=10
  ```
  :::
- If the input content is to be ignored, `nullsrc` can be used. The
  following command generates noise in the luma plane by employing the
  `geq` filter:

  ::: example
  ``` example
  nullsrc=s=256x256, geq=random(1)*255:128:128
  ```
  :::

[]{#Commands-157}

#### [46.13.2 Commands](#toc-Commands-157) {#commands-157 .subsection}

The `color` source supports the following commands:

`c, color`{.sample}

:   Set the color of the created image. Accepts the same syntax of the
    corresponding `color`{.sample} option.

[]{#openclsrc}

### [46.14 openclsrc](#toc-openclsrc) {#openclsrc .section}

Generate video using an OpenCL program.

`source`{.sample}

:   OpenCL program source file.

`kernel`{.sample}

:   Kernel name in program.

`size, s`{.sample}

:   Size of frames to generate. This must be set.

`format`{.sample}

:   Pixel format to use for the generated frames. This must be set.

`rate, r`{.sample}

:   Number of frames generated every second. Default value is '25'.

For details of how the program loading works, see the
[program_opencl](#program_005fopencl) filter.

Example programs:

- Generate a colour ramp by setting pixel values from the position of
  the pixel in the output image. (Note that this will work with all
  pixel formats, but the generated output will not be the same.)

  ``` verbatim
  __kernel void ramp(__write_only image2d_t dst,
                     unsigned int index)
  {
      int2 loc = (int2)(get_global_id(0), get_global_id(1));

      float4 val;
      val.xy = val.zw = convert_float2(loc) / convert_float2(get_image_dim(dst));

      write_imagef(dst, loc, val);
  }
  ```

- Generate a Sierpinski carpet pattern, panning by a single pixel each
  frame.

  ``` verbatim
  __kernel void sierpinski_carpet(__write_only image2d_t dst,
                                  unsigned int index)
  {
      int2 loc = (int2)(get_global_id(0), get_global_id(1));

      float4 value = 0.0f;
      int x = loc.x + index;
      int y = loc.y + index;
      while (x > 0 || y > 0) {
          if (x % 3 == 1 && y % 3 == 1) {
              value = 1.0f;
              break;
          }
          x /= 3;
          y /= 3;
      }

      write_imagef(dst, loc, value);
  }
  ```

[]{#sierpinski}

### [46.15 sierpinski](#toc-sierpinski) {#sierpinski .section}

Generate a Sierpinski carpet/triangle fractal, and randomly pan around.

This source accepts the following options:

`size, s`{.sample}

:   Set frame size. For the syntax of this option, check the
    [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#video-size-syntax). Default value is
    \"640x480\".

`rate, r`{.sample}

:   Set frame rate, expressed as number of frames per second. Default
    value is \"25\".

`seed`{.sample}

:   Set seed which is used for random panning.

`jump`{.sample}

:   Set max jump for single pan destination. Allowed range is from 1 to
    10000.

`type`{.sample}

:   Set fractal type, can be default `carpet` or `triangle`.

[]{#zoneplate}

### [46.16 zoneplate](#toc-zoneplate) {#zoneplate .section}

Generate a zoneplate test video pattern.

This source accepts the following options:

`size, s`{.sample}

:   Set frame size. For the syntax of this option, check the
    [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#video-size-syntax). Default value is
    \"320x240\".

`rate, r`{.sample}

:   Set frame rate, expressed as number of frames per second. Default
    value is \"25\".

`duration, d`{.sample}

:   Set the duration of the sourced video. See [(ffmpeg-utils)the Time
    duration section in the ffmpeg-utils(1)
    manual](ffmpeg-utils.html#time-duration-syntax) for the accepted
    syntax.

    If not specified, or the expressed duration is negative, the video
    is supposed to be generated forever.

`sar`{.sample}

:   Set the sample aspect ratio of the sourced video.

`precision`{.sample}

:   Set precision in bits for look-up table for sine calculations.
    Default value is 10. Allowed range is from 4 to 16.

`xo`{.sample}

:   Set horizontal axis offset for output signal. Default value is 0.

`yo`{.sample}

:   Set vertical axis offset for output signal. Default value is 0.

`to`{.sample}

:   Set time axis offset for output signal. Default value is 0.

`k0`{.sample}

:   Set 0-order, constant added to signal phase. Default value is 0.

`kx`{.sample}

:   Set 1-order, phase factor multiplier for horizontal axis. Default
    value is 0.

`ky`{.sample}

:   Set 1-order, phase factor multiplier for vertical axis. Default
    value is 0.

`kt`{.sample}

:   Set 1-order, phase factor multiplier for time axis. Default value is
    0.

`kxt, kyt, kxy`{.sample}

:   Set phase factor multipliers for combination of spatial and temporal
    axis. Default value is 0.

`kx2`{.sample}

:   Set 2-order, phase factor multiplier for horizontal axis. Default
    value is 0.

`ky2`{.sample}

:   Set 2-order, phase factor multiplier for vertical axis. Default
    value is 0.

`kt2`{.sample}

:   Set 2-order, phase factor multiplier for time axis. Default value is
    0.

`ku`{.sample}

:   Set the constant added to final phase to produce chroma-blue
    component of signal. Default value is 0.

`kv`{.sample}

:   Set the constant added to final phase to produce chroma-red
    component of signal. Default value is 0.

[]{#Commands-158}

#### [46.16.1 Commands](#toc-Commands-158) {#commands-158 .subsection}

This source supports the some above options as [commands](#commands).

[]{#Examples-209}

#### [46.16.2 Examples](#toc-Examples-209) {#examples-209 .subsection}

- Generate horizontal color sine sweep:

  ::: example
  ``` example
  zoneplate=ku=512:kv=0:kt2=0:kx2=256:s=wvga:xo=-426:kt=11
  ```
  :::
- Generate vertical color sine sweep:

  ::: example
  ``` example
  zoneplate=ku=512:kv=0:kt2=0:ky2=156:s=wvga:yo=-240:kt=11
  ```
  :::
- Generate circular zone-plate:

  ::: example
  ``` example
  zoneplate=ku=512:kv=100:kt2=0:ky2=256:kx2=556:s=wvga:yo=0:kt=11
  ```
  :::

[]{#Video-Sinks}

## [47 Video Sinks](#toc-Video-Sinks) {#video-sinks .chapter}

Below is a description of the currently available video sinks.

[]{#buffersink}

### [47.1 buffersink](#toc-buffersink) {#buffersink .section}

Buffer video frames, and make them available to the end of the filter
graph.

This sink is mainly intended for programmatic use, in particular through
the interface defined in `libavfilter/buffersink.h`{.sample} or the
options system.

It accepts a pointer to an AVBufferSinkContext structure, which defines
the incoming buffers' formats, to be passed as the opaque parameter to
`avfilter_init_filter` for initialization.

[]{#nullsink}

### [47.2 nullsink](#toc-nullsink) {#nullsink .section}

Null video sink: do absolutely nothing with the input video. It is
mainly useful as a template and for use in analysis / debugging tools.

[]{#Multimedia-Filters}

## [48 Multimedia Filters](#toc-Multimedia-Filters) {#multimedia-filters .chapter}

Below is a description of the currently available multimedia filters.

[]{#a3dscope}

### [48.1 a3dscope](#toc-a3dscope) {#a3dscope .section}

Convert input audio to 3d scope video output.

The filter accepts the following options:

`rate, r`{.sample}

:   Set frame rate, expressed as number of frames per second. Default
    value is \"25\".

`size, s`{.sample}

:   Specify the video size for the output. For the syntax of this
    option, check the [(ffmpeg-utils)\"Video size\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#video-size-syntax). Default
    value is `hd720`.

`fov`{.sample}

:   Set the camera field of view. Default is 90 degrees. Allowed range
    is from 40 to 150.

`roll`{.sample}

:   Set the camera roll.

`pitch`{.sample}

:   Set the camera pitch.

`yaw`{.sample}

:   Set the camera yaw.

`xzoom`{.sample}

:   Set the camera zoom on X-axis.

`yzoom`{.sample}

:   Set the camera zoom on Y-axis.

`zzoom`{.sample}

:   Set the camera zoom on Z-axis.

`xpos`{.sample}

:   Set the camera position on X-axis.

`ypos`{.sample}

:   Set the camera position on Y-axis.

`zpos`{.sample}

:   Set the camera position on Z-axis.

`length`{.sample}

:   Set the length of displayed audio waves in number of frames.

[]{#Commands-159}

#### [48.1.1 Commands](#toc-Commands-159) {#commands-159 .subsection}

Filter supports the some above options as [commands](#commands).

[]{#abitscope}

### [48.2 abitscope](#toc-abitscope) {#abitscope .section}

Convert input audio to a video output, displaying the audio bit scope.

The filter accepts the following options:

`rate, r`{.sample}

:   Set frame rate, expressed as number of frames per second. Default
    value is \"25\".

`size, s`{.sample}

:   Specify the video size for the output. For the syntax of this
    option, check the [(ffmpeg-utils)\"Video size\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#video-size-syntax). Default
    value is `1024x256`.

`colors`{.sample}

:   Specify list of colors separated by space or by '\|' which will be
    used to draw channels. Unrecognized or missing colors will be
    replaced by white color.

`mode, m`{.sample}

:   Set output mode. Can be `bars` or `trace`. Default is `bars`.

[]{#adrawgraph}

### [48.3 adrawgraph](#toc-adrawgraph) {#adrawgraph .section}

Draw a graph using input audio metadata.

See [drawgraph](#drawgraph)

[]{#agraphmonitor}

### [48.4 agraphmonitor](#toc-agraphmonitor) {#agraphmonitor .section}

See [graphmonitor](#graphmonitor).

[]{#ahistogram}

### [48.5 ahistogram](#toc-ahistogram) {#ahistogram .section}

Convert input audio to a video output, displaying the volume histogram.

The filter accepts the following options:

`dmode`{.sample}

:   Specify how histogram is calculated.

    It accepts the following values:

    '`single`{.sample}'

    :   Use single histogram for all channels.

    '`separate`{.sample}'

    :   Use separate histogram for each channel.

    Default is `single`.

`rate, r`{.sample}

:   Set frame rate, expressed as number of frames per second. Default
    value is \"25\".

`size, s`{.sample}

:   Specify the video size for the output. For the syntax of this
    option, check the [(ffmpeg-utils)\"Video size\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#video-size-syntax). Default
    value is `hd720`.

`scale`{.sample}

:   Set display scale.

    It accepts the following values:

    '`log`{.sample}'

    :   logarithmic

    '`sqrt`{.sample}'

    :   square root

    '`cbrt`{.sample}'

    :   cubic root

    '`lin`{.sample}'

    :   linear

    '`rlog`{.sample}'

    :   reverse logarithmic

    Default is `log`.

`ascale`{.sample}

:   Set amplitude scale.

    It accepts the following values:

    '`log`{.sample}'

    :   logarithmic

    '`lin`{.sample}'

    :   linear

    Default is `log`.

`acount`{.sample}

:   Set how much frames to accumulate in histogram. Default is 1.
    Setting this to -1 accumulates all frames.

`rheight`{.sample}

:   Set histogram ratio of window height.

`slide`{.sample}

:   Set sonogram sliding.

    It accepts the following values:

    '`replace`{.sample}'

    :   replace old rows with new ones.

    '`scroll`{.sample}'

    :   scroll from top to bottom.

    Default is `replace`.

`hmode`{.sample}

:   Set histogram mode.

    It accepts the following values:

    '`abs`{.sample}'

    :   Use absolute values of samples.

    '`sign`{.sample}'

    :   Use untouched values of samples.

    Default is `abs`.

[]{#aphasemeter}

### [48.6 aphasemeter](#toc-aphasemeter) {#aphasemeter .section}

Measures phase of input audio, which is exported as metadata
`lavfi.aphasemeter.phase`, representing mean phase of current audio
frame. A video output can also be produced and is enabled by default.
The audio is passed through as first output.

Audio will be rematrixed to stereo if it has a different channel layout.
Phase value is in range `[-1, 1]` where `-1` means left and right
channels are completely out of phase and `1` means channels are in
phase.

The filter accepts the following options, all related to its video
output:

`rate, r`{.sample}

:   Set the output frame rate. Default value is `25`.

`size, s`{.sample}

:   Set the video size for the output. For the syntax of this option,
    check the [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#video-size-syntax). Default value is
    `800x400`.

`rc`{.sample}\
`gc`{.sample}\
`bc`{.sample}

:   Specify the red, green, blue contrast. Default values are `2`, `7`
    and `1`. Allowed range is `[0, 255]`.

`mpc`{.sample}

:   Set color which will be used for drawing median phase. If color is
    `none` which is default, no median phase value will be drawn.

`video`{.sample}

:   Enable video output. Default is enabled.

[]{#phasing-detection}

#### [48.6.1 phasing detection](#toc-phasing-detection) {#phasing-detection .subsection}

The filter also detects out of phase and mono sequences in stereo
streams. It logs the sequence start, end and duration when it lasts
longer or as long as the minimum set.

The filter accepts the following options for this detection:

`phasing`{.sample}

:   Enable mono and out of phase detection. Default is disabled.

`tolerance, t`{.sample}

:   Set phase tolerance for mono detection, in amplitude ratio. Default
    is `0`. Allowed range is `[0, 1]`.

`angle, a`{.sample}

:   Set angle threshold for out of phase detection, in degree. Default
    is `170`. Allowed range is `[90, 180]`.

`duration, d`{.sample}

:   Set mono or out of phase duration until notification, expressed in
    seconds. Default is `2`.

[]{#Examples-210}

#### [48.6.2 Examples](#toc-Examples-210) {#examples-210 .subsection}

- Complete example with `ffmpeg` to detect 1 second of mono with 0.001
  phase tolerance:

  ::: example
  ``` example
  ffmpeg -i stereo.wav -af aphasemeter=video=0:phasing=1:duration=1:tolerance=0.001 -f null -
  ```
  :::

[]{#avectorscope}

### [48.7 avectorscope](#toc-avectorscope) {#avectorscope .section}

Convert input audio to a video output, representing the audio vector
scope.

The filter is used to measure the difference between channels of stereo
audio stream. A monaural signal, consisting of identical left and right
signal, results in straight vertical line. Any stereo separation is
visible as a deviation from this line, creating a Lissajous figure. If
the straight (or deviation from it) but horizontal line appears this
indicates that the left and right channels are out of phase.

The filter accepts the following options:

`mode, m`{.sample}

:   Set the vectorscope mode.

    Available values are:

    '`lissajous`{.sample}'

    :   Lissajous rotated by 45 degrees.

    '`lissajous_xy`{.sample}'

    :   Same as above but not rotated.

    '`polar`{.sample}'

    :   Shape resembling half of circle.

    Default value is '`lissajous`{.sample}'.

`size, s`{.sample}

:   Set the video size for the output. For the syntax of this option,
    check the [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
    manual](ffmpeg-utils.html#video-size-syntax). Default value is
    `400x400`.

`rate, r`{.sample}

:   Set the output frame rate. Default value is `25`.

`rc`{.sample}\
`gc`{.sample}\
`bc`{.sample}\
`ac`{.sample}

:   Specify the red, green, blue and alpha contrast. Default values are
    `40`, `160`, `80` and `255`. Allowed range is `[0, 255]`.

`rf`{.sample}\
`gf`{.sample}\
`bf`{.sample}\
`af`{.sample}

:   Specify the red, green, blue and alpha fade. Default values are
    `15`, `10`, `5` and `5`. Allowed range is `[0, 255]`.

`zoom`{.sample}

:   Set the zoom factor. Default value is `1`. Allowed range is
    `[0, 10]`. Values lower than `1`{.variable} will auto adjust zoom
    factor to maximal possible value.

`draw`{.sample}

:   Set the vectorscope drawing mode.

    Available values are:

    '`dot`{.sample}'

    :   Draw dot for each sample.

    '`line`{.sample}'

    :   Draw line between previous and current sample.

    '`aaline`{.sample}'

    :   Draw anti-aliased line between previous and current sample.

    Default value is '`dot`{.sample}'.

`scale`{.sample}

:   Specify amplitude scale of audio samples.

    Available values are:

    '`lin`{.sample}'

    :   Linear.

    '`sqrt`{.sample}'

    :   Square root.

    '`cbrt`{.sample}'

    :   Cubic root.

    '`log`{.sample}'

    :   Logarithmic.

`swap`{.sample}

:   Swap left channel axis with right channel axis.

`mirror`{.sample}

:   Mirror axis.

    '`none`{.sample}'

    :   No mirror.

    '`x`{.sample}'

    :   Mirror only x axis.

    '`y`{.sample}'

    :   Mirror only y axis.

    '`xy`{.sample}'

    :   Mirror both axis.

[]{#Examples-211}

#### [48.7.1 Examples](#toc-Examples-211) {#examples-211 .subsection}

- Complete example using `ffplay`:

  ::: example
  ``` example
  ffplay -f lavfi 'amovie=input.mp3, asplit [a][out1];
               [a] avectorscope=zoom=1.3:rc=2:gc=200:bc=10:rf=1:gf=8:bf=7 [out0]'
  ```
  :::

[]{#Commands-160}

#### [48.7.2 Commands](#toc-Commands-160) {#commands-160 .subsection}

This filter supports the all above options as commands except options
`size` and `rate`.

[]{#bench_002c-abench}

### [48.8 bench, abench](#toc-bench_002c-abench) {#bench-abench .section}

Benchmark part of a filtergraph.

The filter accepts the following options:

`action`{.sample}

:   Start or stop a timer.

    Available values are:

    '`start`{.sample}'

    :   Get the current time, set it as frame metadata (using the key
        `lavfi.bench.start_time`), and forward the frame to the next
        filter.

    '`stop`{.sample}'

    :   Get the current time and fetch the `lavfi.bench.start_time`
        metadata from the input frame metadata to get the time
        difference. Time difference, average, maximum and minimum time
        (respectively `t`, `avg`, `max` and `min`) are then printed. The
        timestamps are expressed in seconds.

[]{#Examples-212}

#### [48.8.1 Examples](#toc-Examples-212) {#examples-212 .subsection}

- Benchmark [selectivecolor](#selectivecolor) filter:

  ::: example
  ``` example
  bench=start,selectivecolor=reds=-.2 .12 -.49,bench=stop
  ```
  :::

[]{#concat-filter}[]{#concat-3}

### [48.9 concat](#toc-concat-3) {#concat-2 .section}

Concatenate audio and video streams, joining them together one after the
other.

The filter works on segments of synchronized video and audio streams.
All segments must have the same number of streams of each type, and that
will also be the number of streams at output.

The filter accepts the following options:

`n`{.sample}

:   Set the number of segments. Default is 2.

`v`{.sample}

:   Set the number of output video streams, that is also the number of
    video streams in each segment. Default is 1.

`a`{.sample}

:   Set the number of output audio streams, that is also the number of
    audio streams in each segment. Default is 0.

`unsafe`{.sample}

:   Activate unsafe mode: do not fail if segments have a different
    format.

The filter has `v`{.variable}+`a`{.variable} outputs: first
`v`{.variable} video outputs, then `a`{.variable} audio outputs.

There are `n`{.variable}x(`v`{.variable}+`a`{.variable}) inputs: first
the inputs for the first segment, in the same order as the outputs, then
the inputs for the second segment, etc.

Related streams do not always have exactly the same duration, for
various reasons including codec frame size or sloppy authoring. For that
reason, related synchronized streams (e.g. a video and its audio track)
should be concatenated at once. The concat filter will use the duration
of the longest stream in each segment (except the last one), and if
necessary pad shorter audio streams with silence.

For this filter to work correctly, all segments must start at timestamp
0.

All corresponding streams must have the same parameters in all segments;
the filtering system will automatically select a common pixel format for
video streams, and a common sample format, sample rate and channel
layout for audio streams, but other settings, such as resolution, must
be converted explicitly by the user.

Different frame rates are acceptable but will result in variable frame
rate at output; be sure to configure the output file to handle it.

[]{#Examples-213}

#### [48.9.1 Examples](#toc-Examples-213) {#examples-213 .subsection}

- Concatenate an opening, an episode and an ending, all in bilingual
  version (video in stream 0, audio in streams 1 and 2):

  ::: example
  ``` example
  ffmpeg -i opening.mkv -i episode.mkv -i ending.mkv -filter_complex \
    '[0:0] [0:1] [0:2] [1:0] [1:1] [1:2] [2:0] [2:1] [2:2]
     concat=n=3:v=1:a=2 [v] [a1] [a2]' \
    -map '[v]' -map '[a1]' -map '[a2]' output.mkv
  ```
  :::

- Concatenate two parts, handling audio and video separately, using the
  (a)movie sources, and adjusting the resolution:

  ::: example
  ``` example
  movie=part1.mp4, scale=512:288 [v1] ; amovie=part1.mp4 [a1] ;
  movie=part2.mp4, scale=512:288 [v2] ; amovie=part2.mp4 [a2] ;
  [v1] [v2] concat [outv] ; [a1] [a2] concat=v=0:a=1 [outa]
  ```
  :::

  Note that a desync will happen at the stitch if the audio and video
  streams do not have exactly the same duration in the first file.

[]{#Commands-161}

#### [48.9.2 Commands](#toc-Commands-161) {#commands-161 .subsection}

This filter supports the following commands:

`next`{.sample}

:   Close the current segment and step to the next one

[]{#ebur128}[]{#ebur128-1}

### [48.10 ebur128](#toc-ebur128-1) {#ebur128 .section}

EBU R128 scanner filter. This filter takes an audio stream and analyzes
its loudness level. By default, it logs a message at a frequency of 10Hz
with the Momentary loudness (identified by `M`), Short-term loudness
(`S`), Integrated loudness (`I`) and Loudness Range (`LRA`).

The filter can only analyze streams which have sample format is
double-precision floating point. The input stream will be converted to
this specification, if needed. Users may need to insert aformat and/or
aresample filters after this filter to obtain the original parameters.

The filter also has a video output (see the `video`{.variable} option)
with a real time graph to observe the loudness evolution. The graphic
contains the logged message mentioned above, so it is not printed
anymore when this option is set, unless the verbose logging is set. The
main graphing area contains the short-term loudness (3 seconds of
analysis), and the gauge on the right is for the momentary loudness (400
milliseconds), but can optionally be configured to instead display
short-term loudness (see `gauge`{.variable}).

The green area marks a +/- 1LU target range around the target loudness
(-23LUFS by default, unless modified through `target`{.variable}).

More information about the Loudness Recommendation EBU R128 on
<http://tech.ebu.ch/loudness>.

The filter accepts the following options:

`video`{.sample}

:   Activate the video output. The audio stream is passed unchanged
    whether this option is set or no. The video stream will be the first
    output stream if activated. Default is `0`.

`size`{.sample}

:   Set the video size. This option is for video only. For the syntax of
    this option, check the [(ffmpeg-utils)\"Video size\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#video-size-syntax). Default
    and minimum resolution is `640x480`.

`meter`{.sample}

:   Set the EBU scale meter. Default is `9`. Common values are `9` and
    `18`, respectively for EBU scale meter +9 and EBU scale meter +18.
    Any other integer value between this range is allowed.

`metadata`{.sample}

:   Set metadata injection. If set to `1`, the audio input will be
    segmented into 100ms output frames, each of them containing various
    loudness information in metadata. All the metadata keys are prefixed
    with `lavfi.r128.`.

    Default is `0`.

`framelog`{.sample}

:   Force the frame logging level.

    Available values are:

    '`quiet`{.sample}'

    :   logging disabled

    '`info`{.sample}'

    :   information logging level

    '`verbose`{.sample}'

    :   verbose logging level

    By default, the logging level is set to `info`{.variable}. If the
    `video`{.sample} or the `metadata`{.sample} options are set, it
    switches to `verbose`{.variable}.

`peak`{.sample}

:   Set peak mode(s).

    Available modes can be cumulated (the option is a `flag` type).
    Possible values are:

    '`none`{.sample}'

    :   Disable any peak mode (default).

    '`sample`{.sample}'

    :   Enable sample-peak mode.

        Simple peak mode looking for the higher sample value. It logs a
        message for sample-peak (identified by `SPK`).

    '`true`{.sample}'

    :   Enable true-peak mode.

        If enabled, the peak lookup is done on an over-sampled version
        of the input stream for better peak accuracy. It logs a message
        for true-peak. (identified by `TPK`) and true-peak per frame
        (identified by `FTPK`). This mode requires a build with
        `libswresample`.

`dualmono`{.sample}

:   Treat mono input files as \"dual mono\". If a mono file is intended
    for playback on a stereo system, its EBU R128 measurement will be
    perceptually incorrect. If set to `true`, this option will
    compensate for this effect. Multi-channel input files are not
    affected by this option.

`panlaw`{.sample}

:   Set a specific pan law to be used for the measurement of dual mono
    files. This parameter is optional, and has a default value of
    -3.01dB.

`target`{.sample}

:   Set a specific target level (in LUFS) used as relative zero in the
    visualization. This parameter is optional and has a default value of
    -23LUFS as specified by EBU R128. However, material published online
    may prefer a level of -16LUFS (e.g. for use with podcasts or video
    platforms).

`gauge`{.sample}

:   Set the value displayed by the gauge. Valid values are `momentary`
    and s `shortterm`. By default the momentary value will be used, but
    in certain scenarios it may be more useful to observe the short term
    value instead (e.g. live mixing).

`scale`{.sample}

:   Sets the display scale for the loudness. Valid parameters are
    `absolute` (in LUFS) or `relative` (LU) relative to the target. This
    only affects the video output, not the summary or continuous log
    output.

`integrated`{.sample}

:   Read-only exported value for measured integrated loudness, in LUFS.

`range`{.sample}

:   Read-only exported value for measured loudness range, in LU.

`lra_low`{.sample}

:   Read-only exported value for measured LRA low, in LUFS.

`lra_high`{.sample}

:   Read-only exported value for measured LRA high, in LUFS.

`sample_peak`{.sample}

:   Read-only exported value for measured sample peak, in dBFS.

`true_peak`{.sample}

:   Read-only exported value for measured true peak, in dBFS.

[]{#Examples-214}

#### [48.10.1 Examples](#toc-Examples-214) {#examples-214 .subsection}

- Real-time graph using `ffplay`, with a EBU scale meter +18:

  ::: example
  ``` example
  ffplay -f lavfi -i "amovie=input.mp3,ebur128=video=1:meter=18 [out0][out1]"
  ```
  :::
- Run an analysis with `ffmpeg`:

  ::: example
  ``` example
  ffmpeg -nostats -i input.mp3 -filter_complex ebur128 -f null -
  ```
  :::

[]{#interleave_002c-ainterleave}

### [48.11 interleave, ainterleave](#toc-interleave_002c-ainterleave) {#interleave-ainterleave .section}

Temporally interleave frames from several inputs.

`interleave` works with video inputs, `ainterleave` with audio.

These filters read frames from several inputs and send the oldest queued
frame to the output.

Input streams must have well defined, monotonically increasing frame
timestamp values.

In order to submit one frame to output, these filters need to enqueue at
least one frame for each input, so they cannot work in case one input is
not yet terminated and will not receive incoming frames.

For example consider the case when one input is a `select` filter which
always drops input frames. The `interleave` filter will keep reading
from that input, but it will never be able to send new frames to output
until the input sends an end-of-stream signal.

Also, depending on inputs synchronization, the filters will drop frames
in case one input receives more frames than the other ones, and the
queue is already filled.

These filters accept the following options:

`nb_inputs, n`{.sample}

:   Set the number of different inputs, it is 2 by default.

`duration`{.sample}

:   How to determine the end-of-stream.

    `longest`{.sample}

    :   The duration of the longest input. (default)

    `shortest`{.sample}

    :   The duration of the shortest input.

    `first`{.sample}

    :   The duration of the first input.

[]{#Examples-215}

#### [48.11.1 Examples](#toc-Examples-215) {#examples-215 .subsection}

- Interleave frames belonging to different streams using `ffmpeg`:

  ::: example
  ``` example
  ffmpeg -i bambi.avi -i pr0n.mkv -filter_complex "[0:v][1:v] interleave" out.avi
  ```
  :::
- Add flickering blur effect:

  ::: example
  ``` example
  select='if(gt(random(0), 0.2), 1, 2)':n=2 [tmp], boxblur=2:2, [tmp] interleave
  ```
  :::

[]{#latency_002c-alatency}

### [48.12 latency, alatency](#toc-latency_002c-alatency) {#latency-alatency .section}

Measure filtering latency.

Report previous filter filtering latency, delay in number of audio
samples for audio filters or number of video frames for video filters.

On end of input stream, filter will report min and max measured latency
for previous running filter in filtergraph.

[]{#metadata_002c-ametadata}

### [48.13 metadata, ametadata](#toc-metadata_002c-ametadata) {#metadata-ametadata .section}

Manipulate frame metadata.

This filter accepts the following options:

`mode`{.sample}

:   Set mode of operation of the filter.

    Can be one of the following:

    '`select`{.sample}'

    :   If both `value` and `key` is set, select frames which have such
        metadata. If only `key` is set, select every frame that has such
        key in metadata.

    '`add`{.sample}'

    :   Add new metadata `key` and `value`. If key is already available
        do nothing.

    '`modify`{.sample}'

    :   Modify value of already present key.

    '`delete`{.sample}'

    :   If `value` is set, delete only keys that have such value.
        Otherwise, delete key. If `key` is not set, delete all metadata
        values in the frame.

    '`print`{.sample}'

    :   Print key and its value if metadata was found. If `key` is not
        set print all metadata values available in frame.

`key`{.sample}

:   Set key used with all modes. Must be set for all modes except
    `print` and `delete`.

`value`{.sample}

:   Set metadata value which will be used. This option is mandatory for
    `modify` and `add` mode.

`function`{.sample}

:   Which function to use when comparing metadata value and `value`.

    Can be one of following:

    '`same_str`{.sample}'

    :   Values are interpreted as strings, returns true if metadata
        value is same as `value`.

    '`starts_with`{.sample}'

    :   Values are interpreted as strings, returns true if metadata
        value starts with the `value` option string.

    '`less`{.sample}'

    :   Values are interpreted as floats, returns true if metadata value
        is less than `value`.

    '`equal`{.sample}'

    :   Values are interpreted as floats, returns true if `value` is
        equal with metadata value.

    '`greater`{.sample}'

    :   Values are interpreted as floats, returns true if metadata value
        is greater than `value`.

    '`expr`{.sample}'

    :   Values are interpreted as floats, returns true if expression
        from option `expr` evaluates to true.

    '`ends_with`{.sample}'

    :   Values are interpreted as strings, returns true if metadata
        value ends with the `value` option string.

`expr`{.sample}

:   Set expression which is used when `function` is set to `expr`. The
    expression is evaluated through the eval API and can contain the
    following constants:

    `VALUE1, FRAMEVAL`{.sample}

    :   Float representation of `value` from metadata key.

    `VALUE2, USERVAL`{.sample}

    :   Float representation of `value` as supplied by user in `value`
        option.

`file`{.sample}

:   If specified in `print` mode, output is written to the named file.
    Instead of plain filename any writable url can be specified.
    Filename "-" is a shorthand for standard output. If `file` option is
    not set, output is written to the log with AV_LOG_INFO loglevel.

`direct`{.sample}

:   Reduces buffering in print mode when output is written to a URL set
    using `file`{.variable}.

[]{#Examples-216}

#### [48.13.1 Examples](#toc-Examples-216) {#examples-216 .subsection}

- Print all metadata values for frames with key `lavfi.signalstats.YDIF`
  with values between 0 and 1.

  ::: example
  ``` example
  signalstats,metadata=print:key=lavfi.signalstats.YDIF:value=0:function=expr:expr='between(VALUE1,0,1)'
  ```
  :::
- Print silencedetect output to file `metadata.txt`{.sample}.

  ::: example
  ``` example
  silencedetect,ametadata=mode=print:file=metadata.txt
  ```
  :::
- Direct all metadata to a pipe with file descriptor 4.

  ::: example
  ``` example
  metadata=mode=print:file='pipe\:4'
  ```
  :::

[]{#perms_002c-aperms}

### [48.14 perms, aperms](#toc-perms_002c-aperms) {#perms-aperms .section}

Set read/write permissions for the output frames.

These filters are mainly aimed at developers to test direct path in the
following filter in the filtergraph.

The filters accept the following options:

`mode`{.sample}

:   Select the permissions mode.

    It accepts the following values:

    '`none`{.sample}'

    :   Do nothing. This is the default.

    '`ro`{.sample}'

    :   Set all the output frames read-only.

    '`rw`{.sample}'

    :   Set all the output frames directly writable.

    '`toggle`{.sample}'

    :   Make the frame read-only if writable, and writable if read-only.

    '`random`{.sample}'

    :   Set each output frame read-only or writable randomly.

`seed`{.sample}

:   Set the seed for the `random`{.variable} mode, must be an integer
    included between `0` and `UINT32_MAX`. If not specified, or if
    explicitly set to `-1`, the filter will try to use a good random
    seed on a best effort basis.

Note: in case of auto-inserted filter between the permission filter and
the following one, the permission might not be received as expected in
that following filter. Inserting a [format](#format) or
[aformat](#aformat) filter before the perms/aperms filter can avoid this
problem.

[]{#realtime_002c-arealtime}

### [48.15 realtime, arealtime](#toc-realtime_002c-arealtime) {#realtime-arealtime .section}

Slow down filtering to match real time approximately.

These filters will pause the filtering for a variable amount of time to
match the output rate with the input timestamps. They are similar to the
`re`{.sample} option to `ffmpeg`.

They accept the following options:

`limit`{.sample}

:   Time limit for the pauses. Any pause longer than that will be
    considered a timestamp discontinuity and reset the timer. Default is
    2 seconds.

`speed`{.sample}

:   Speed factor for processing. The value must be a float larger than
    zero. Values larger than 1.0 will result in faster than realtime
    processing, smaller will slow processing down. The
    `limit`{.variable} is automatically adapted accordingly. Default is
    1.0.

    A processing speed faster than what is possible without these
    filters cannot be achieved.

[]{#Commands-162}

#### [48.15.1 Commands](#toc-Commands-162) {#commands-162 .subsection}

Both filters supports the all above options as [commands](#commands).

[]{#segment_002c-asegment}

### [48.16 segment, asegment](#toc-segment_002c-asegment) {#segment-asegment .section}

Split single input stream into multiple streams.

This filter does opposite of concat filters.

`segment` works on video frames, `asegment` on audio samples.

This filter accepts the following options:

`timestamps`{.sample}

:   Timestamps of output segments separated by '\|'. The first segment
    will run from the beginning of the input stream. The last segment
    will run until the end of the input stream

`frames, samples`{.sample}

:   Exact frame/sample count to split the segments.

In all cases, prefixing an each segment with '+' will make it relative
to the previous segment.

[]{#Examples-217}

#### [48.16.1 Examples](#toc-Examples-217) {#examples-217 .subsection}

- Split input audio stream into three output audio streams, starting at
  start of input audio stream and storing that in 1st output audio
  stream, then following at 60th second and storing than in 2nd output
  audio stream, and last after 150th second of input audio stream store
  in 3rd output audio stream:

  ::: example
  ``` example
  asegment=timestamps="60|150"
  ```
  :::

[]{#select}[]{#select_002c-aselect}

### [48.17 select, aselect](#toc-select_002c-aselect) {#select-aselect .section}

Select frames to pass in output.

This filter accepts the following options:

`expr, e`{.sample}

:   Set expression, which is evaluated for each input frame.

    If the expression is evaluated to zero, the frame is discarded.

    If the evaluation result is negative or NaN, the frame is sent to
    the first output; otherwise it is sent to the output with index
    `ceil(val)-1`, assuming that the input index starts from 0.

    For example a value of `1.2` corresponds to the output with index
    `ceil(1.2)-1 = 2-1 = 1`, that is the second output.

`outputs, n`{.sample}

:   Set the number of outputs. The output to which to send the selected
    frame is based on the result of the evaluation. Default value is 1.

The expression can contain the following constants:

`n`{.sample}

The (sequential) number of the filtered frame, starting from 0.

`selected_n`{.sample}

The (sequential) number of the selected frame, starting from 0.

`prev_selected_n`{.sample}

The sequential number of the last selected frame. It's NAN if undefined.

`TB`{.sample}

The timebase of the input timestamps.

`pts`{.sample}

The PTS (Presentation TimeStamp) of the filtered frame, expressed in
`TB`{.variable} units. It's NAN if undefined.

`t`{.sample}

The PTS of the filtered frame, expressed in seconds. It's NAN if
undefined.

`prev_pts`{.sample}

The PTS of the previously filtered frame. It's NAN if undefined.

`prev_selected_pts`{.sample}

The PTS of the last previously filtered frame. It's NAN if undefined.

`prev_selected_t`{.sample}

The PTS of the last previously selected frame, expressed in seconds.
It's NAN if undefined.

`start_pts`{.sample}

The first PTS in the stream which is not NAN. It remains NAN if not
found.

`start_t`{.sample}

The first PTS, in seconds, in the stream which is not NAN. It remains
NAN if not found.

`pict_type `{.sample}*`(video only)`{.sample}*

The type of the filtered frame. It can assume one of the following
values:

`I`{.sample}

`P`{.sample}

`B`{.sample}

`S`{.sample}

`SI`{.sample}

`SP`{.sample}

`BI`{.sample}

`interlace_type `{.sample}*`(video only)`{.sample}*

The frame interlace type. It can assume one of the following values:

`PROGRESSIVE`{.sample}

:   The frame is progressive (not interlaced).

`TOPFIRST`{.sample}

:   The frame is top-field-first.

`BOTTOMFIRST`{.sample}

:   The frame is bottom-field-first.

`consumed_sample_n `{.sample}*`(audio only)`{.sample}*

the number of selected samples before the current frame

`samples_n `{.sample}*`(audio only)`{.sample}*

the number of samples in the current frame

`sample_rate `{.sample}*`(audio only)`{.sample}*

the input sample rate

`key`{.sample}

This is 1 if the filtered frame is a key-frame, 0 otherwise.

`pos`{.sample}

the position in the file of the filtered frame, -1 if the information is
not available (e.g. for synthetic video); deprecated, do not use

`scene `{.sample}*`(video only)`{.sample}*

value between 0 and 1 to indicate a new scene; a low value reflects a
low probability for the current frame to introduce a new scene, while a
higher value means the current frame is more likely to be one (see the
example below)

`concatdec_select`{.sample}

The concat demuxer can select only part of a concat input file by
setting an inpoint and an outpoint, but the output packets may not be
entirely contained in the selected interval. By using this variable, it
is possible to skip frames generated by the concat demuxer which are not
exactly contained in the selected interval.

This works by comparing the frame pts against the
`lavf.concat.start_time`{.variable} and the
`lavf.concat.duration`{.variable} packet metadata values which are also
present in the decoded frames.

The `concatdec_select`{.variable} variable is -1 if the frame pts is at
least start_time and either the duration metadata is missing or the
frame pts is less than start_time + duration, 0 otherwise, and NaN if
the start_time metadata is missing.

That basically means that an input frame is selected if its pts is
within the interval set by the concat demuxer.

`iw `{.sample}*`(video only)`{.sample}*

Represents the width of the input video frame.

`ih `{.sample}*`(video only)`{.sample}*

Represents the height of the input video frame.

`view `{.sample}*`(video only)`{.sample}*

View ID for multi-view video.

The default value of the select expression is \"1\".

[]{#Examples-218}

#### [48.17.1 Examples](#toc-Examples-218) {#examples-218 .subsection}

- Select all frames in input:

  ::: example
  ``` example
  select
  ```
  :::

  The example above is the same as:

  ::: example
  ``` example
  select=1
  ```
  :::

- Skip all frames:

  ::: example
  ``` example
  select=0
  ```
  :::

- Select only I-frames:

  ::: example
  ``` example
  select='eq(pict_type\,I)'
  ```
  :::

- Select one frame every 100:

  ::: example
  ``` example
  select='not(mod(n\,100))'
  ```
  :::

- Select only frames contained in the 10-20 time interval:

  ::: example
  ``` example
  select=between(t\,10\,20)
  ```
  :::

- Select only I-frames contained in the 10-20 time interval:

  ::: example
  ``` example
  select=between(t\,10\,20)*eq(pict_type\,I)
  ```
  :::

- Select frames with a minimum distance of 10 seconds:

  ::: example
  ``` example
  select='isnan(prev_selected_t)+gte(t-prev_selected_t\,10)'
  ```
  :::

- Use aselect to select only audio frames with samples number \> 100:

  ::: example
  ``` example
  aselect='gt(samples_n\,100)'
  ```
  :::

- Create a mosaic of the first scenes:

  ::: example
  ``` example
  ffmpeg -i video.avi -vf select='gt(scene\,0.4)',scale=160:120,tile -frames:v 1 preview.png
  ```
  :::

  Comparing `scene`{.variable} against a value between 0.3 and 0.5 is
  generally a sane choice.

- Send even and odd frames to separate outputs, and compose them:

  ::: example
  ``` example
  select=n=2:e='mod(n, 2)+1' [odd][even]; [odd] pad=h=2*ih [tmp]; [tmp][even] overlay=y=h
  ```
  :::

- Select useful frames from an ffconcat file which is using inpoints and
  outpoints but where the source files are not intra frame only.

  ::: example
  ``` example
  ffmpeg -copyts -vsync 0 -segment_time_metadata 1 -i input.ffconcat -vf select=concatdec_select -af aselect=concatdec_select output.avi
  ```
  :::

[]{#sendcmd_002c-asendcmd}

### [48.18 sendcmd, asendcmd](#toc-sendcmd_002c-asendcmd) {#sendcmd-asendcmd .section}

Send commands to filters in the filtergraph.

These filters read commands to be sent to other filters in the
filtergraph.

`sendcmd` must be inserted between two video filters, `asendcmd` must be
inserted between two audio filters, but apart from that they act the
same way.

The specification of commands can be provided in the filter arguments
with the `commands`{.variable} option, or in a file specified by the
`filename`{.variable} option.

These filters accept the following options:

`commands, c`{.sample}

:   Set the commands to be read and sent to the other filters.

`filename, f`{.sample}

:   Set the filename of the commands to be read and sent to the other
    filters.

[]{#Commands-syntax}

#### [48.18.1 Commands syntax](#toc-Commands-syntax) {#commands-syntax .subsection}

A commands description consists of a sequence of interval
specifications, comprising a list of commands to be executed when a
particular event related to that interval occurs. The occurring event is
typically the current frame time entering or leaving a given time
interval.

An interval is specified by the following syntax:

::: example
``` example
START[-END] COMMANDS;
```
:::

The time interval is specified by the `START`{.variable} and
`END`{.variable} times. `END`{.variable} is optional and defaults to the
maximum time.

The current frame time is considered within the specified interval if it
is included in the interval \[`START`{.variable}, `END`{.variable}),
that is when the time is greater or equal to `START`{.variable} and is
lesser than `END`{.variable}.

`COMMANDS`{.variable} consists of a sequence of one or more command
specifications, separated by \",\", relating to that interval. The
syntax of a command specification is given by:

::: example
``` example
[FLAGS] TARGET COMMAND ARG
```
:::

`FLAGS`{.variable} is optional and specifies the type of events relating
to the time interval which enable sending the specified command, and
must be a non-null sequence of identifier flags separated by \"+\" or
\"\|\" and enclosed between \"\[\" and \"\]\".

The following flags are recognized:

`enter`{.sample}

:   The command is sent when the current frame timestamp enters the
    specified interval. In other words, the command is sent when the
    previous frame timestamp was not in the given interval, and the
    current is.

`leave`{.sample}

:   The command is sent when the current frame timestamp leaves the
    specified interval. In other words, the command is sent when the
    previous frame timestamp was in the given interval, and the current
    is not.

`expr`{.sample}

:   The command `ARG`{.variable} is interpreted as expression and result
    of expression is passed as `ARG`{.variable}.

    The expression is evaluated through the eval API and can contain the
    following constants:

    `POS`{.sample}

    :   Original position in the file of the frame, or undefined if
        undefined for the current frame. Deprecated, do not use.

    `PTS`{.sample}

    :   The presentation timestamp in input.

    `N`{.sample}

    :   The count of the input frame for video or audio, starting from
        0.

    `T`{.sample}

    :   The time in seconds of the current frame.

    `TS`{.sample}

    :   The start time in seconds of the current command interval.

    `TE`{.sample}

    :   The end time in seconds of the current command interval.

    `TI`{.sample}

    :   The interpolated time of the current command interval, TI = (T -
        TS) / (TE - TS).

    `W`{.sample}

    :   The video frame width.

    `H`{.sample}

    :   The video frame height.

If `FLAGS`{.variable} is not specified, a default value of `[enter]` is
assumed.

`TARGET`{.variable} specifies the target of the command, usually the
name of the filter class or a specific filter instance name.

`COMMAND`{.variable} specifies the name of the command for the target
filter.

`ARG`{.variable} is optional and specifies the optional list of argument
for the given `COMMAND`{.variable}.

Between one interval specification and another, whitespaces, or
sequences of characters starting with `#` until the end of line, are
ignored and can be used to annotate comments.

A simplified BNF description of the commands specification syntax
follows:

::: example
``` example
COMMAND_FLAG  ::= "enter" | "leave"
COMMAND_FLAGS ::= COMMAND_FLAG [(+|"|")COMMAND_FLAG]
COMMAND       ::= ["[" COMMAND_FLAGS "]"] TARGET COMMAND [ARG]
COMMANDS      ::= COMMAND [,COMMANDS]
INTERVAL      ::= START[-END] COMMANDS
INTERVALS     ::= INTERVAL[;INTERVALS]
```
:::

[]{#Examples-219}

#### [48.18.2 Examples](#toc-Examples-219) {#examples-219 .subsection}

- Specify audio tempo change at second 4:

  ::: example
  ``` example
  asendcmd=c='4.0 atempo tempo 1.5',atempo
  ```
  :::

- Target a specific filter instance:

  ::: example
  ``` example
  asendcmd=c='4.0 atempo@my tempo 1.5',atempo@my
  ```
  :::

- Specify a list of drawtext and hue commands in a file.

  ::: example
  ``` example
  # show text in the interval 5-10
  5.0-10.0 [enter] drawtext reinit 'fontfile=FreeSerif.ttf:text=hello world',
           [leave] drawtext reinit 'fontfile=FreeSerif.ttf:text=';

  # desaturate the image in the interval 15-20
  15.0-20.0 [enter] hue s 0,
            [enter] drawtext reinit 'fontfile=FreeSerif.ttf:text=nocolor',
            [leave] hue s 1,
            [leave] drawtext reinit 'fontfile=FreeSerif.ttf:text=color';

  # apply an exponential saturation fade-out effect, starting from time 25
  25 [enter] hue s exp(25-t)
  ```
  :::

  A filtergraph allowing to read and process the above command list
  stored in a file `test.cmd`{.sample}, can be specified with:

  ::: example
  ``` example
  sendcmd=f=test.cmd,drawtext=fontfile=FreeSerif.ttf:text='',hue
  ```
  :::

[]{#setpts}[]{#setpts_002c-asetpts}

### [48.19 setpts, asetpts](#toc-setpts_002c-asetpts) {#setpts-asetpts .section}

Change the PTS (presentation timestamp) of the input frames.

`setpts` works on video frames, `asetpts` on audio frames.

This filter accepts the following options:

`expr`{.sample}

:   The expression which is evaluated for each frame to construct its
    timestamp.

`strip_fps (`{.sample}*`video only`{.sample}*`)`{.sample}

:   Boolean option which determines if the original framerate and frame
    duration metadata is unset. If set to true, be advised that a sane
    frame rate should be explicitly specified if output is sent to a
    constant frame rate muxer. Default is `false`.

The expression is evaluated through the eval API and can contain the
following constants:

`FRAME_RATE, FR`{.sample}

:   frame rate, only defined for constant frame-rate video

`PTS`{.sample}

:   The presentation timestamp in input

`N`{.sample}

:   The count of the input frame for video or the number of consumed
    samples, not including the current frame for audio, starting from 0.

`NB_CONSUMED_SAMPLES`{.sample}

:   The number of consumed samples, not including the current frame
    (only audio)

`NB_SAMPLES, S`{.sample}

:   The number of samples in the current frame (only audio)

`SAMPLE_RATE, SR`{.sample}

:   The audio sample rate.

`STARTPTS`{.sample}

:   The PTS of the first frame.

`STARTT`{.sample}

:   the time in seconds of the first frame

`INTERLACED`{.sample}

:   State whether the current frame is interlaced.

`T`{.sample}

:   the time in seconds of the current frame

`POS`{.sample}

:   original position in the file of the frame, or undefined if
    undefined for the current frame; deprecated, do not use

`PREV_INPTS`{.sample}

:   The previous input PTS.

`PREV_INT`{.sample}

:   previous input time in seconds

`PREV_OUTPTS`{.sample}

:   The previous output PTS.

`PREV_OUTT`{.sample}

:   previous output time in seconds

`RTCTIME`{.sample}

:   The wallclock (RTC) time in microseconds. This is deprecated, use
    time(0) instead.

`RTCSTART`{.sample}

:   The wallclock (RTC) time at the start of the movie in microseconds.

`TB`{.sample}

:   The timebase of the input timestamps.

`T_CHANGE`{.sample}

:   Time of the first frame after command was applied or time of the
    first frame if no commands.

[]{#Examples-220}

#### [48.19.1 Examples](#toc-Examples-220) {#examples-220 .subsection}

- Start counting PTS from zero

  ::: example
  ``` example
  setpts=PTS-STARTPTS
  ```
  :::
- Apply fast motion effect:

  ::: example
  ``` example
  setpts=0.5*PTS
  ```
  :::
- Apply slow motion effect:

  ::: example
  ``` example
  setpts=2.0*PTS
  ```
  :::
- Set fixed rate of 25 frames per second:

  ::: example
  ``` example
  setpts=N/(25*TB)
  ```
  :::
- Apply a random jitter effect of +/-100 TB units:

  ::: example
  ``` example
  setpts=PTS+randomi(0, -100\,100)
  ```
  :::
- Set fixed rate 25 fps with some jitter:

  ::: example
  ``` example
  setpts='1/(25*TB) * (N + 0.05 * sin(N*2*PI/25))'
  ```
  :::
- Apply an offset of 10 seconds to the input PTS:

  ::: example
  ``` example
  setpts=PTS+10/TB
  ```
  :::
- Generate timestamps from a \"live source\" and rebase onto the current
  timebase:

  ::: example
  ``` example
  setpts='(RTCTIME - RTCSTART) / (TB * 1000000)'
  ```
  :::
- Generate timestamps by counting samples:

  ::: example
  ``` example
  asetpts=N/SR/TB
  ```
  :::

[]{#Commands-163}

#### [48.19.2 Commands](#toc-Commands-163) {#commands-163 .subsection}

Both filters support all above options as [commands](#commands).

[]{#setrange}

### [48.20 setrange](#toc-setrange) {#setrange .section}

Force color range for the output video frame.

The `setrange` filter marks the color range property for the output
frames. It does not change the input frame, but only sets the
corresponding property, which affects how the frame is treated by
following filters.

The filter accepts the following options:

`range`{.sample}

:   Available values are:

    '`auto`{.sample}'

    :   Keep the same color range property.

    '`unspecified, unknown`{.sample}'

    :   Set the color range as unspecified.

    '`limited, tv, mpeg`{.sample}'

    :   Set the color range as limited.

    '`full, pc, jpeg`{.sample}'

    :   Set the color range as full.

[]{#settb_002c-asettb}

### [48.21 settb, asettb](#toc-settb_002c-asettb) {#settb-asettb .section}

Set the timebase to use for the output frames timestamps. It is mainly
useful for testing timebase configuration.

It accepts the following parameters:

`expr, tb`{.sample}

:   The expression which is evaluated into the output timebase.

The value for `tb`{.sample} is an arithmetic expression representing a
rational. The expression can contain the constants \"AVTB\" (the default
timebase), \"intb\" (the input timebase) and \"sr\" (the sample rate,
audio only). Default value is \"intb\".

[]{#Examples-221}

#### [48.21.1 Examples](#toc-Examples-221) {#examples-221 .subsection}

- Set the timebase to 1/25:

  ::: example
  ``` example
  settb=expr=1/25
  ```
  :::
- Set the timebase to 1/10:

  ::: example
  ``` example
  settb=expr=0.1
  ```
  :::
- Set the timebase to 1001/1000:

  ::: example
  ``` example
  settb=1+0.001
  ```
  :::
- Set the timebase to 2\*intb:

  ::: example
  ``` example
  settb=2*intb
  ```
  :::
- Set the default timebase value:

  ::: example
  ``` example
  settb=AVTB
  ```
  :::

[]{#showcqt}

### [48.22 showcqt](#toc-showcqt) {#showcqt .section}

Convert input audio to a video output representing frequency spectrum
logarithmically using Brown-Puckette constant Q transform algorithm with
direct frequency domain coefficient calculation (but the transform
itself is not really constant Q, instead the Q factor is actually
variable/clamped), with musical tone scale, from E0 to D#10.

The filter accepts the following options:

`size, s`{.sample}

:   Specify the video size for the output. It must be even. For the
    syntax of this option, check the [(ffmpeg-utils)\"Video size\"
    section in the ffmpeg-utils
    manual](ffmpeg-utils.html#video-size-syntax). Default value is
    `1920x1080`.

`fps, rate, r`{.sample}

:   Set the output frame rate. Default value is `25`.

`bar_h`{.sample}

:   Set the bargraph height. It must be even. Default value is `-1`
    which computes the bargraph height automatically.

`axis_h`{.sample}

:   Set the axis height. It must be even. Default value is `-1` which
    computes the axis height automatically.

`sono_h`{.sample}

:   Set the sonogram height. It must be even. Default value is `-1`
    which computes the sonogram height automatically.

`fullhd`{.sample}

:   Set the fullhd resolution. This option is deprecated, use
    `size`{.variable}, `s`{.variable} instead. Default value is `1`.

`sono_v, volume`{.sample}

:   Specify the sonogram volume expression. It can contain variables:

    `bar_v`{.sample}

    :   the `bar_v`{.variable} evaluated expression

    `frequency, freq, f`{.sample}

    :   the frequency where it is evaluated

    `timeclamp, tc`{.sample}

    :   the value of `timeclamp`{.variable} option

    and functions:

    `a_weighting(f)`{.sample}

    :   A-weighting of equal loudness

    `b_weighting(f)`{.sample}

    :   B-weighting of equal loudness

    `c_weighting(f)`{.sample}

    :   C-weighting of equal loudness.

    Default value is `16`.

`bar_v, volume2`{.sample}

:   Specify the bargraph volume expression. It can contain variables:

    `sono_v`{.sample}

    :   the `sono_v`{.variable} evaluated expression

    `frequency, freq, f`{.sample}

    :   the frequency where it is evaluated

    `timeclamp, tc`{.sample}

    :   the value of `timeclamp`{.variable} option

    and functions:

    `a_weighting(f)`{.sample}

    :   A-weighting of equal loudness

    `b_weighting(f)`{.sample}

    :   B-weighting of equal loudness

    `c_weighting(f)`{.sample}

    :   C-weighting of equal loudness.

    Default value is `sono_v`.

`sono_g, gamma`{.sample}

:   Specify the sonogram gamma. Lower gamma makes the spectrum more
    contrast, higher gamma makes the spectrum having more range. Default
    value is `3`. Acceptable range is `[1, 7]`.

`bar_g, gamma2`{.sample}

:   Specify the bargraph gamma. Default value is `1`. Acceptable range
    is `[1, 7]`.

`bar_t`{.sample}

:   Specify the bargraph transparency level. Lower value makes the
    bargraph sharper. Default value is `1`. Acceptable range is
    `[0, 1]`.

`timeclamp, tc`{.sample}

:   Specify the transform timeclamp. At low frequency, there is
    trade-off between accuracy in time domain and frequency domain. If
    timeclamp is lower, event in time domain is represented more
    accurately (such as fast bass drum), otherwise event in frequency
    domain is represented more accurately (such as bass guitar).
    Acceptable range is `[0.002, 1]`. Default value is `0.17`.

`attack`{.sample}

:   Set attack time in seconds. The default is `0` (disabled).
    Otherwise, it limits future samples by applying asymmetric windowing
    in time domain, useful when low latency is required. Accepted range
    is `[0, 1]`.

`basefreq`{.sample}

:   Specify the transform base frequency. Default value is
    `20.01523126408007475`, which is frequency 50 cents below E0.
    Acceptable range is `[10, 100000]`.

`endfreq`{.sample}

:   Specify the transform end frequency. Default value is
    `20495.59681441799654`, which is frequency 50 cents above D#10.
    Acceptable range is `[10, 100000]`.

`coeffclamp`{.sample}

:   This option is deprecated and ignored.

`tlength`{.sample}

:   Specify the transform length in time domain. Use this option to
    control accuracy trade-off between time domain and frequency domain
    at every frequency sample. It can contain variables:

    `frequency, freq, f`{.sample}

    :   the frequency where it is evaluated

    `timeclamp, tc`{.sample}

    :   the value of `timeclamp`{.variable} option.

    Default value is `384*tc/(384+tc*f)`.

`count`{.sample}

:   Specify the transform count for every video frame. Default value is
    `6`. Acceptable range is `[1, 30]`.

`fcount`{.sample}

:   Specify the transform count for every single pixel. Default value is
    `0`, which makes it computed automatically. Acceptable range is
    `[0, 10]`.

`fontfile`{.sample}

:   Specify font file for use with freetype to draw the axis. If not
    specified, use embedded font. Note that drawing with font file or
    embedded font is not implemented with custom `basefreq`{.variable}
    and `endfreq`{.variable}, use `axisfile`{.variable} option instead.

`font`{.sample}

:   Specify fontconfig pattern. This has lower priority than
    `fontfile`{.variable}. The `:` in the pattern may be replaced by `|`
    to avoid unnecessary escaping.

`fontcolor`{.sample}

:   Specify font color expression. This is arithmetic expression that
    should return integer value 0xRRGGBB. It can contain variables:

    `frequency, freq, f`{.sample}

    :   the frequency where it is evaluated

    `timeclamp, tc`{.sample}

    :   the value of `timeclamp`{.variable} option

    and functions:

    `midi(f)`{.sample}

    :   midi number of frequency f, some midi numbers: E0(16), C1(24),
        C2(36), A4(69)

    `r(x), g(x), b(x)`{.sample}

    :   red, green, and blue value of intensity x.

    Default value is
    `st(0, (midi(f)-59.5)/12); st(1, if(between(ld(0),0,1), 0.5-0.5*cos(2*PI*ld(0)), 0)); r(1-ld(1)) + b(ld(1))`.

`axisfile`{.sample}

:   Specify image file to draw the axis. This option override
    `fontfile`{.variable} and `fontcolor`{.variable} option.

`axis, text`{.sample}

:   Enable/disable drawing text to the axis. If it is set to `0`,
    drawing to the axis is disabled, ignoring `fontfile`{.variable} and
    `axisfile`{.variable} option. Default value is `1`.

`csp`{.sample}

:   Set colorspace. The accepted values are:

    '`unspecified`{.sample}'

    :   Unspecified (default)

    '`bt709`{.sample}'

    :   BT.709

    '`fcc`{.sample}'

    :   FCC

    '`bt470bg`{.sample}'

    :   BT.470BG or BT.601-6 625

    '`smpte170m`{.sample}'

    :   SMPTE-170M or BT.601-6 525

    '`smpte240m`{.sample}'

    :   SMPTE-240M

    '`bt2020ncl`{.sample}'

    :   BT.2020 with non-constant luminance

`cscheme`{.sample}

:   Set spectrogram color scheme. This is list of floating point values
    with format `left_r|left_g|left_b|right_r|right_g|right_b`. The
    default is `1|0.5|0|0|0.5|1`.

[]{#Examples-222}

#### [48.22.1 Examples](#toc-Examples-222) {#examples-222 .subsection}

- Playing audio while showing the spectrum:

  ::: example
  ``` example
  ffplay -f lavfi 'amovie=a.mp3, asplit [a][out1]; [a] showcqt [out0]'
  ```
  :::
- Same as above, but with frame rate 30 fps:

  ::: example
  ``` example
  ffplay -f lavfi 'amovie=a.mp3, asplit [a][out1]; [a] showcqt=fps=30:count=5 [out0]'
  ```
  :::
- Playing at 1280x720:

  ::: example
  ``` example
  ffplay -f lavfi 'amovie=a.mp3, asplit [a][out1]; [a] showcqt=s=1280x720:count=4 [out0]'
  ```
  :::
- Disable sonogram display:

  ::: example
  ``` example
  sono_h=0
  ```
  :::
- A1 and its harmonics: A1, A2, (near)E3, A3:

  ::: example
  ``` example
  ffplay -f lavfi 'aevalsrc=0.1*sin(2*PI*55*t)+0.1*sin(4*PI*55*t)+0.1*sin(6*PI*55*t)+0.1*sin(8*PI*55*t),
                   asplit[a][out1]; [a] showcqt [out0]'
  ```
  :::
- Same as above, but with more accuracy in frequency domain:

  ::: example
  ``` example
  ffplay -f lavfi 'aevalsrc=0.1*sin(2*PI*55*t)+0.1*sin(4*PI*55*t)+0.1*sin(6*PI*55*t)+0.1*sin(8*PI*55*t),
                   asplit[a][out1]; [a] showcqt=timeclamp=0.5 [out0]'
  ```
  :::
- Custom volume:

  ::: example
  ``` example
  bar_v=10:sono_v=bar_v*a_weighting(f)
  ```
  :::
- Custom gamma, now spectrum is linear to the amplitude.

  ::: example
  ``` example
  bar_g=2:sono_g=2
  ```
  :::
- Custom tlength equation:

  ::: example
  ``` example
  tc=0.33:tlength='st(0,0.17); 384*tc / (384 / ld(0) + tc*f /(1-ld(0))) + 384*tc / (tc*f / ld(0) + 384 /(1-ld(0)))'
  ```
  :::
- Custom fontcolor and fontfile, C-note is colored green, others are
  colored blue:

  ::: example
  ``` example
  fontcolor='if(mod(floor(midi(f)+0.5),12), 0x0000FF, g(1))':fontfile=myfont.ttf
  ```
  :::
- Custom font using fontconfig:

  ::: example
  ``` example
  font='Courier New,Monospace,mono|bold'
  ```
  :::
- Custom frequency range with custom axis using image file:

  ::: example
  ``` example
  axisfile=myaxis.png:basefreq=40:endfreq=10000
  ```
  :::

[]{#showcwt}

### [48.23 showcwt](#toc-showcwt) {#showcwt .section}

Convert input audio to video output representing frequency spectrum
using Continuous Wavelet Transform and Morlet wavelet.

The filter accepts the following options:

`size, s`{.sample}

Specify the video size for the output. For the syntax of this option,
check the [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
manual](ffmpeg-utils.html#video-size-syntax). Default value is
`640x512`.

`rate, r`{.sample}

Set the output frame rate. Default value is `25`.

`scale`{.sample}

Set the frequency scale used. Allowed values are:

`linear`{.sample}

`log`{.sample}

`bark`{.sample}

`mel`{.sample}

`erbs`{.sample}

`sqrt`{.sample}

`cbrt`{.sample}

`qdrt`{.sample}

`fm`{.sample}

Default value is `linear`.

`iscale`{.sample}

Set the intensity scale used. Allowed values are:

`linear`{.sample}

`log`{.sample}

`sqrt`{.sample}

`cbrt`{.sample}

`qdrt`{.sample}

Default value is `log`.

`min`{.sample}

Set the minimum frequency that will be used in output. Default is `20`
Hz.

`max`{.sample}

Set the maximum frequency that will be used in output. Default is
`20000` Hz. The real frequency upper limit depends on input audio's
sample rate and such will be enforced on this value when it is set to
value greater than Nyquist frequency.

`imin`{.sample}

Set the minimum intensity that will be used in output.

`imax`{.sample}

Set the maximum intensity that will be used in output.

`logb`{.sample}

Set the logarithmic basis for brightness strength when mapping
calculated magnitude values to pixel values. Allowed range is from `0`
to `1`. Default value is `0.0001`.

`deviation`{.sample}

Set the frequency deviation. Lower values than `1` are more frequency
oriented, while higher values than `1` are more time oriented. Allowed
range is from `0` to `10`. Default value is `1`.

`pps`{.sample}

Set the number of pixel output per each second in one row. Allowed range
is from `1` to `1024`. Default value is `64`.

`mode`{.sample}

Set the output visual mode. Allowed values are:

`magnitude`{.sample}

:   Show magnitude.

`phase`{.sample}

:   Show only phase.

`magphase`{.sample}

:   Show combination of magnitude and phase. Magnitude is mapped to
    brightness and phase to color.

`channel`{.sample}

:   Show unique color per channel magnitude.

`stereo`{.sample}

:   Show unique color per stereo difference.

Default value is `magnitude`.

`slide`{.sample}

Set the output slide method. Allowed values are:

`replace`{.sample}

`scroll`{.sample}

`frame`{.sample}

`direction`{.sample}

Set the direction method for output slide method. Allowed values are:

`lr`{.sample}

:   Direction from left to right.

`rl`{.sample}

:   Direction from right to left.

`ud`{.sample}

:   Direction from up to down.

`du`{.sample}

:   Direction from down to up.

`bar`{.sample}

Set the ratio of bargraph display to display size. Default is 0.

`rotation`{.sample}

Set color rotation, must be in \[-1.0, 1.0\] range. Default value is
`0`.

[]{#showfreqs}

### [48.24 showfreqs](#toc-showfreqs) {#showfreqs .section}

Convert input audio to video output representing the audio power
spectrum. Audio amplitude is on Y-axis while frequency is on X-axis.

The filter accepts the following options:

`size, s`{.sample}

Specify size of video. For the syntax of this option, check the
[(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
manual](ffmpeg-utils.html#video-size-syntax). Default is `1024x512`.

`rate, r`{.sample}

Set video rate. Default is `25`.

`mode`{.sample}

Set display mode. This set how each frequency bin will be represented.

It accepts the following values:

'`line`{.sample}'

'`bar`{.sample}'

'`dot`{.sample}'

Default is `bar`.

`ascale`{.sample}

Set amplitude scale.

It accepts the following values:

'`lin`{.sample}'

:   Linear scale.

'`sqrt`{.sample}'

:   Square root scale.

'`cbrt`{.sample}'

:   Cubic root scale.

'`log`{.sample}'

:   Logarithmic scale.

Default is `log`.

`fscale`{.sample}

Set frequency scale.

It accepts the following values:

'`lin`{.sample}'

:   Linear scale.

'`log`{.sample}'

:   Logarithmic scale.

'`rlog`{.sample}'

:   Reverse logarithmic scale.

Default is `lin`.

`win_size`{.sample}

Set window size. Allowed range is from 16 to 65536.

Default is `2048`

`win_func`{.sample}

Set windowing function.

It accepts the following values:

'`rect`{.sample}'

'`bartlett`{.sample}'

'`hanning`{.sample}'

'`hamming`{.sample}'

'`blackman`{.sample}'

'`welch`{.sample}'

'`flattop`{.sample}'

'`bharris`{.sample}'

'`bnuttall`{.sample}'

'`bhann`{.sample}'

'`sine`{.sample}'

'`nuttall`{.sample}'

'`lanczos`{.sample}'

'`gauss`{.sample}'

'`tukey`{.sample}'

'`dolph`{.sample}'

'`cauchy`{.sample}'

'`parzen`{.sample}'

'`poisson`{.sample}'

'`bohman`{.sample}'

'`kaiser`{.sample}'

Default is `hanning`.

`overlap`{.sample}

Set window overlap. In range `[0, 1]`. Default is `1`, which means
optimal overlap for selected window function will be picked.

`averaging`{.sample}

Set time averaging. Setting this to 0 will display current maximal
peaks. Default is `1`, which means time averaging is disabled.

`colors`{.sample}

Specify list of colors separated by space or by '\|' which will be used
to draw channel frequencies. Unrecognized or missing colors will be
replaced by white color.

`cmode`{.sample}

Set channel display mode.

It accepts the following values:

'`combined`{.sample}'

'`separate`{.sample}'

Default is `combined`.

`minamp`{.sample}

Set minimum amplitude used in `log` amplitude scaler.

`data`{.sample}

Set data display mode.

It accepts the following values:

'`magnitude`{.sample}'

'`phase`{.sample}'

'`delay`{.sample}'

Default is `magnitude`.

`channels`{.sample}

Set channels to use when processing audio. By default all are processed.

[]{#showspatial}

### [48.25 showspatial](#toc-showspatial) {#showspatial .section}

Convert stereo input audio to a video output, representing the spatial
relationship between two channels.

The filter accepts the following options:

`size, s`{.sample}

Specify the video size for the output. For the syntax of this option,
check the [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
manual](ffmpeg-utils.html#video-size-syntax). Default value is
`512x512`.

`win_size`{.sample}

Set window size. Allowed range is from `1024`{.variable} to
`65536`{.variable}. Default size is `4096`{.variable}.

`win_func`{.sample}

Set window function.

It accepts the following values:

'`rect`{.sample}'

'`bartlett`{.sample}'

'`hann`{.sample}'

'`hanning`{.sample}'

'`hamming`{.sample}'

'`blackman`{.sample}'

'`welch`{.sample}'

'`flattop`{.sample}'

'`bharris`{.sample}'

'`bnuttall`{.sample}'

'`bhann`{.sample}'

'`sine`{.sample}'

'`nuttall`{.sample}'

'`lanczos`{.sample}'

'`gauss`{.sample}'

'`tukey`{.sample}'

'`dolph`{.sample}'

'`cauchy`{.sample}'

'`parzen`{.sample}'

'`poisson`{.sample}'

'`bohman`{.sample}'

'`kaiser`{.sample}'

Default value is `hann`.

`rate, r`{.sample}

Set output framerate.

[]{#showspectrum}[]{#showspectrum-1}

### [48.26 showspectrum](#toc-showspectrum-1) {#showspectrum .section}

Convert input audio to a video output, representing the audio frequency
spectrum.

The filter accepts the following options:

`size, s`{.sample}

Specify the video size for the output. For the syntax of this option,
check the [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
manual](ffmpeg-utils.html#video-size-syntax). Default value is
`640x512`.

`slide`{.sample}

Specify how the spectrum should slide along the window.

It accepts the following values:

'`replace`{.sample}'

:   the samples start again on the left when they reach the right

'`scroll`{.sample}'

:   the samples scroll from right to left

'`fullframe`{.sample}'

:   frames are only produced when the samples reach the right

'`rscroll`{.sample}'

:   the samples scroll from left to right

'`lreplace`{.sample}'

:   the samples start again on the right when they reach the left

Default value is `replace`.

`mode`{.sample}

Specify display mode.

It accepts the following values:

'`combined`{.sample}'

:   all channels are displayed in the same row

'`separate`{.sample}'

:   all channels are displayed in separate rows

Default value is '`combined`{.sample}'.

`color`{.sample}

Specify display color mode.

It accepts the following values:

'`channel`{.sample}'

:   each channel is displayed in a separate color

'`intensity`{.sample}'

:   each channel is displayed using the same color scheme

'`rainbow`{.sample}'

:   each channel is displayed using the rainbow color scheme

'`moreland`{.sample}'

:   each channel is displayed using the moreland color scheme

'`nebulae`{.sample}'

:   each channel is displayed using the nebulae color scheme

'`fire`{.sample}'

:   each channel is displayed using the fire color scheme

'`fiery`{.sample}'

:   each channel is displayed using the fiery color scheme

'`fruit`{.sample}'

:   each channel is displayed using the fruit color scheme

'`cool`{.sample}'

:   each channel is displayed using the cool color scheme

'`magma`{.sample}'

:   each channel is displayed using the magma color scheme

'`green`{.sample}'

:   each channel is displayed using the green color scheme

'`viridis`{.sample}'

:   each channel is displayed using the viridis color scheme

'`plasma`{.sample}'

:   each channel is displayed using the plasma color scheme

'`cividis`{.sample}'

:   each channel is displayed using the cividis color scheme

'`terrain`{.sample}'

:   each channel is displayed using the terrain color scheme

Default value is '`channel`{.sample}'.

`scale`{.sample}

Specify scale used for calculating intensity color values.

It accepts the following values:

'`lin`{.sample}'

:   linear

'`sqrt`{.sample}'

:   square root, default

'`cbrt`{.sample}'

:   cubic root

'`log`{.sample}'

:   logarithmic

'`4thrt`{.sample}'

:   4th root

'`5thrt`{.sample}'

:   5th root

Default value is '`sqrt`{.sample}'.

`fscale`{.sample}

Specify frequency scale.

It accepts the following values:

'`lin`{.sample}'

:   linear

'`log`{.sample}'

:   logarithmic

Default value is '`lin`{.sample}'.

`saturation`{.sample}

Set saturation modifier for displayed colors. Negative values provide
alternative color scheme. `0` is no saturation at all. Saturation must
be in \[-10.0, 10.0\] range. Default value is `1`.

`win_func`{.sample}

Set window function.

It accepts the following values:

'`rect`{.sample}'

'`bartlett`{.sample}'

'`hann`{.sample}'

'`hanning`{.sample}'

'`hamming`{.sample}'

'`blackman`{.sample}'

'`welch`{.sample}'

'`flattop`{.sample}'

'`bharris`{.sample}'

'`bnuttall`{.sample}'

'`bhann`{.sample}'

'`sine`{.sample}'

'`nuttall`{.sample}'

'`lanczos`{.sample}'

'`gauss`{.sample}'

'`tukey`{.sample}'

'`dolph`{.sample}'

'`cauchy`{.sample}'

'`parzen`{.sample}'

'`poisson`{.sample}'

'`bohman`{.sample}'

'`kaiser`{.sample}'

Default value is `hann`.

`orientation`{.sample}

Set orientation of time vs frequency axis. Can be `vertical` or
`horizontal`. Default is `vertical`.

`overlap`{.sample}

Set ratio of overlap window. Default value is `0`. When value is `1`
overlap is set to recommended size for specific window function
currently used.

`gain`{.sample}

Set scale gain for calculating intensity color values. Default value is
`1`.

`data`{.sample}

Set which data to display. Can be `magnitude`, default or `phase`, or
unwrapped phase: `uphase`.

`rotation`{.sample}

Set color rotation, must be in \[-1.0, 1.0\] range. Default value is
`0`.

`start`{.sample}

Set start frequency from which to display spectrogram. Default is `0`.

`stop`{.sample}

Set stop frequency to which to display spectrogram. Default is `0`.

`fps`{.sample}

Set upper frame rate limit. Default is `auto`, unlimited.

`legend`{.sample}

Draw time and frequency axes and legends. Default is disabled.

`drange`{.sample}

Set dynamic range used to calculate intensity color values. Default is
120 dBFS. Allowed range is from 10 to 200.

`limit`{.sample}

Set upper limit of input audio samples volume in dBFS. Default is 0
dBFS. Allowed range is from -100 to 100.

`opacity`{.sample}

Set opacity strength when using pixel format output with alpha
component.

The usage is very similar to the showwaves filter; see the examples in
that section.

[]{#Examples-223}

#### [48.26.1 Examples](#toc-Examples-223) {#examples-223 .subsection}

- Large window with logarithmic color scaling:

  ::: example
  ``` example
  showspectrum=s=1280x480:scale=log
  ```
  :::
- Complete example for a colored and sliding spectrum per channel using
  `ffplay`:

  ::: example
  ``` example
  ffplay -f lavfi 'amovie=input.mp3, asplit [a][out1];
               [a] showspectrum=mode=separate:color=intensity:slide=1:scale=cbrt [out0]'
  ```
  :::

[]{#showspectrumpic}

### [48.27 showspectrumpic](#toc-showspectrumpic) {#showspectrumpic .section}

Convert input audio to a single video frame, representing the audio
frequency spectrum.

The filter accepts the following options:

`size, s`{.sample}

Specify the video size for the output. For the syntax of this option,
check the [(ffmpeg-utils)\"Video size\" section in the ffmpeg-utils
manual](ffmpeg-utils.html#video-size-syntax). Default value is
`4096x2048`.

`mode`{.sample}

Specify display mode.

It accepts the following values:

'`combined`{.sample}'

:   all channels are displayed in the same row

'`separate`{.sample}'

:   all channels are displayed in separate rows

Default value is '`combined`{.sample}'.

`color`{.sample}

Specify display color mode.

It accepts the following values:

'`channel`{.sample}'

:   each channel is displayed in a separate color

'`intensity`{.sample}'

:   each channel is displayed using the same color scheme

'`rainbow`{.sample}'

:   each channel is displayed using the rainbow color scheme

'`moreland`{.sample}'

:   each channel is displayed using the moreland color scheme

'`nebulae`{.sample}'

:   each channel is displayed using the nebulae color scheme

'`fire`{.sample}'

:   each channel is displayed using the fire color scheme

'`fiery`{.sample}'

:   each channel is displayed using the fiery color scheme

'`fruit`{.sample}'

:   each channel is displayed using the fruit color scheme

'`cool`{.sample}'

:   each channel is displayed using the cool color scheme

'`magma`{.sample}'

:   each channel is displayed using the magma color scheme

'`green`{.sample}'

:   each channel is displayed using the green color scheme

'`viridis`{.sample}'

:   each channel is displayed using the viridis color scheme

'`plasma`{.sample}'

:   each channel is displayed using the plasma color scheme

'`cividis`{.sample}'

:   each channel is displayed using the cividis color scheme

'`terrain`{.sample}'

:   each channel is displayed using the terrain color scheme

Default value is '`intensity`{.sample}'.

`scale`{.sample}

Specify scale used for calculating intensity color values.

It accepts the following values:

'`lin`{.sample}'

:   linear

'`sqrt`{.sample}'

:   square root, default

'`cbrt`{.sample}'

:   cubic root

'`log`{.sample}'

:   logarithmic

'`4thrt`{.sample}'

:   4th root

'`5thrt`{.sample}'

:   5th root

Default value is '`log`{.sample}'.

`fscale`{.sample}

Specify frequency scale.

It accepts the following values:

'`lin`{.sample}'

:   linear

'`log`{.sample}'

:   logarithmic

Default value is '`lin`{.sample}'.

`saturation`{.sample}

Set saturation modifier for displayed colors. Negative values provide
alternative color scheme. `0` is no saturation at all. Saturation must
be in \[-10.0, 10.0\] range. Default value is `1`.

`win_func`{.sample}

Set window function.

It accepts the following values:

'`rect`{.sample}'

'`bartlett`{.sample}'

'`hann`{.sample}'

'`hanning`{.sample}'

'`hamming`{.sample}'

'`blackman`{.sample}'

'`welch`{.sample}'

'`flattop`{.sample}'

'`bharris`{.sample}'

'`bnuttall`{.sample}'

'`bhann`{.sample}'

'`sine`{.sample}'

'`nuttall`{.sample}'

'`lanczos`{.sample}'

'`gauss`{.sample}'

'`tukey`{.sample}'

'`dolph`{.sample}'

'`cauchy`{.sample}'

'`parzen`{.sample}'

'`poisson`{.sample}'

'`bohman`{.sample}'

'`kaiser`{.sample}'

Default value is `hann`.

`orientation`{.sample}

Set orientation of time vs frequency axis. Can be `vertical` or
`horizontal`. Default is `vertical`.

`gain`{.sample}

Set scale gain for calculating intensity color values. Default value is
`1`.

`legend`{.sample}

Draw time and frequency axes and legends. Default is enabled.

`rotation`{.sample}

Set color rotation, must be in \[-1.0, 1.0\] range. Default value is
`0`.

`start`{.sample}

Set start frequency from which to display spectrogram. Default is `0`.

`stop`{.sample}

Set stop frequency to which to display spectrogram. Default is `0`.

`drange`{.sample}

Set dynamic range used to calculate intensity color values. Default is
120 dBFS. Allowed range is from 10 to 200.

`limit`{.sample}

Set upper limit of input audio samples volume in dBFS. Default is 0
dBFS. Allowed range is from -100 to 100.

`opacity`{.sample}

Set opacity strength when using pixel format output with alpha
component.

[]{#Examples-224}

#### [48.27.1 Examples](#toc-Examples-224) {#examples-224 .subsection}

- Extract an audio spectrogram of a whole audio track in a 1024x1024
  picture using `ffmpeg`:

  ::: example
  ``` example
  ffmpeg -i audio.flac -lavfi showspectrumpic=s=1024x1024 spectrogram.png
  ```
  :::

[]{#showvolume}

### [48.28 showvolume](#toc-showvolume) {#showvolume .section}

Convert input audio volume to a video output.

The filter accepts the following options:

`rate, r`{.sample}

:   Set video rate.

`b`{.sample}

:   Set border width, allowed range is \[0, 5\]. Default is 1.

`w`{.sample}

:   Set channel width, allowed range is \[80, 8192\]. Default is 400.

`h`{.sample}

:   Set channel height, allowed range is \[1, 900\]. Default is 20.

`f`{.sample}

:   Set fade, allowed range is \[0, 1\]. Default is 0.95.

`c`{.sample}

:   Set volume color expression.

    The expression can use the following variables:

    `VOLUME`{.sample}

    :   Current max volume of channel in dB.

    `PEAK`{.sample}

    :   Current peak.

    `CHANNEL`{.sample}

    :   Current channel number, starting from 0.

`t`{.sample}

:   If set, displays channel names. Default is enabled.

`v`{.sample}

:   If set, displays volume values. Default is enabled.

`o`{.sample}

:   Set orientation, can be horizontal: `h` or vertical: `v`, default is
    `h`.

`s`{.sample}

:   Set step size, allowed range is \[0, 5\]. Default is 0, which means
    step is disabled.

`p`{.sample}

:   Set background opacity, allowed range is \[0, 1\]. Default is 0.

`m`{.sample}

:   Set metering mode, can be peak: `p` or rms: `r`, default is `p`.

`ds`{.sample}

:   Set display scale, can be linear: `lin` or log: `log`, default is
    `lin`.

`dm`{.sample}

:   In second. If set to \> 0., display a line for the max level in the
    previous seconds. default is disabled: `0.`

`dmc`{.sample}

:   The color of the max line. Use when `dm` option is set to \> 0.
    default is: `orange`

[]{#showwaves}

### [48.29 showwaves](#toc-showwaves) {#showwaves .section}

Convert input audio to a video output, representing the samples waves.

The filter accepts the following options:

`size, s`{.sample}

:   Specify the video size for the output. For the syntax of this
    option, check the [(ffmpeg-utils)\"Video size\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#video-size-syntax). Default
    value is `600x240`.

`mode`{.sample}

:   Set display mode.

    Available values are:

    '`point`{.sample}'

    :   Draw a point for each sample.

    '`line`{.sample}'

    :   Draw a vertical line for each sample.

    '`p2p`{.sample}'

    :   Draw a point for each sample and a line between them.

    '`cline`{.sample}'

    :   Draw a centered vertical line for each sample.

    Default value is `point`.

`n`{.sample}

:   Set the number of samples which are printed on the same column. A
    larger value will decrease the frame rate. Must be a positive
    integer. This option can be set only if the value for
    `rate`{.variable} is not explicitly specified.

`rate, r`{.sample}

:   Set the (approximate) output frame rate. This is done by setting the
    option `n`{.variable}. Default value is \"25\".

`split_channels`{.sample}

:   Set if channels should be drawn separately or overlap. Default value
    is 0.

`colors`{.sample}

:   Set colors separated by '\|' which are going to be used for drawing
    of each channel.

`scale`{.sample}

:   Set amplitude scale.

    Available values are:

    '`lin`{.sample}'

    :   Linear.

    '`log`{.sample}'

    :   Logarithmic.

    '`sqrt`{.sample}'

    :   Square root.

    '`cbrt`{.sample}'

    :   Cubic root.

    Default is linear.

`draw`{.sample}

:   Set the draw mode. This is mostly useful to set for high
    `n`{.variable}.

    Available values are:

    '`scale`{.sample}'

    :   Scale pixel values for each drawn sample.

    '`full`{.sample}'

    :   Draw every sample directly.

    Default value is `scale`.

[]{#Examples-225}

#### [48.29.1 Examples](#toc-Examples-225) {#examples-225 .subsection}

- Output the input file audio and the corresponding video representation
  at the same time:

  ::: example
  ``` example
  amovie=a.mp3,asplit[out0],showwaves[out1]
  ```
  :::
- Create a synthetic signal and show it with showwaves, forcing a frame
  rate of 30 frames per second:

  ::: example
  ``` example
  aevalsrc=sin(1*2*PI*t)*sin(880*2*PI*t):cos(2*PI*200*t),asplit[out0],showwaves=r=30[out1]
  ```
  :::

[]{#showwavespic}

### [48.30 showwavespic](#toc-showwavespic) {#showwavespic .section}

Convert input audio to a single video frame, representing the samples
waves.

The filter accepts the following options:

`size, s`{.sample}

:   Specify the video size for the output. For the syntax of this
    option, check the [(ffmpeg-utils)\"Video size\" section in the
    ffmpeg-utils manual](ffmpeg-utils.html#video-size-syntax). Default
    value is `600x240`.

`split_channels`{.sample}

:   Set if channels should be drawn separately or overlap. Default value
    is 0.

`colors`{.sample}

:   Set colors separated by '\|' which are going to be used for drawing
    of each channel.

`scale`{.sample}

:   Set amplitude scale.

    Available values are:

    '`lin`{.sample}'

    :   Linear.

    '`log`{.sample}'

    :   Logarithmic.

    '`sqrt`{.sample}'

    :   Square root.

    '`cbrt`{.sample}'

    :   Cubic root.

    Default is linear.

`draw`{.sample}

:   Set the draw mode.

    Available values are:

    '`scale`{.sample}'

    :   Scale pixel values for each drawn sample.

    '`full`{.sample}'

    :   Draw every sample directly.

    Default value is `scale`.

`filter`{.sample}

:   Set the filter mode.

    Available values are:

    '`average`{.sample}'

    :   Use average samples values for each drawn sample.

    '`peak`{.sample}'

    :   Use peak samples values for each drawn sample.

    Default value is `average`.

[]{#Examples-226}

#### [48.30.1 Examples](#toc-Examples-226) {#examples-226 .subsection}

- Extract a channel split representation of the wave form of a whole
  audio track in a 1024x800 picture using `ffmpeg`:

  ::: example
  ``` example
  ffmpeg -i audio.flac -lavfi showwavespic=split_channels=1:s=1024x800 waveform.png
  ```
  :::

[]{#sidedata_002c-asidedata}

### [48.31 sidedata, asidedata](#toc-sidedata_002c-asidedata) {#sidedata-asidedata .section}

Delete frame side data, or select frames based on it.

This filter accepts the following options:

`mode`{.sample}

Set mode of operation of the filter.

Can be one of the following:

'`select`{.sample}'

:   Select every frame with side data of `type`.

'`delete`{.sample}'

:   Delete side data of `type`. If `type` is not set, delete all side
    data in the frame.

`type`{.sample}

Set side data type used with all modes. Must be set for `select` mode.

Possible values are:

'`PANSCAN`{.sample}'

'`A53_CC`{.sample}'

'`STEREO3D`{.sample}'

'`MATRIXENCODING`{.sample}'

'`DOWNMIX_INFO`{.sample}'

'`REPLAYGAIN`{.sample}'

'`DISPLAYMATRIX`{.sample}'

'`AFD`{.sample}'

'`MOTION_VECTORS`{.sample}'

'`SKIP_SAMPLES`{.sample}'

'`AUDIO_SERVICE_TYPE`{.sample}'

'`MASTERING_DISPLAY_METADATA`{.sample}'

'`GOP_TIMECODE`{.sample}'

'`SPHERICAL`{.sample}'

'`CONTENT_LIGHT_LEVEL`{.sample}'

'`ICC_PROFILE`{.sample}'

'`S12M_TIMECODE`{.sample}'

'`DYNAMIC_HDR_PLUS`{.sample}'

'`REGIONS_OF_INTEREST`{.sample}'

'`VIDEO_ENC_PARAMS`{.sample}'

'`SEI_UNREGISTERED`{.sample}'

'`FILM_GRAIN_PARAMS`{.sample}'

'`DETECTION_BOUNDING_BOXES`{.sample}'

'`DETECTION_BBOXES`{.sample}'

'`DOVI_RPU_BUFFER`{.sample}'

'`DOVI_METADATA`{.sample}'

'`DYNAMIC_HDR_VIVID`{.sample}'

'`AMBIENT_VIEWING_ENVIRONMENT`{.sample}'

'`VIDEO_HINT`{.sample}'

[]{#spectrumsynth}

### [48.32 spectrumsynth](#toc-spectrumsynth) {#spectrumsynth .section}

Synthesize audio from 2 input video spectrums, first input stream
represents magnitude across time and second represents phase across
time. The filter will transform from frequency domain as displayed in
videos back to time domain as presented in audio output.

This filter is primarily created for reversing processed
[showspectrum](#showspectrum) filter outputs, but can synthesize sound
from other spectrograms too. But in such case results are going to be
poor if the phase data is not available, because in such cases phase
data need to be recreated, usually it's just recreated from random
noise. For best results use gray only output (`channel` color mode in
[showspectrum](#showspectrum) filter) and `log` scale for magnitude
video and `lin` scale for phase video. To produce phase, for 2nd video,
use `data` option. Inputs videos should generally use `fullframe` slide
mode as that saves resources needed for decoding video.

The filter accepts the following options:

`sample_rate`{.sample}

:   Specify sample rate of output audio, the sample rate of audio from
    which spectrum was generated may differ.

`channels`{.sample}

:   Set number of channels represented in input video spectrums.

`scale`{.sample}

:   Set scale which was used when generating magnitude input spectrum.
    Can be `lin` or `log`. Default is `log`.

`slide`{.sample}

:   Set slide which was used when generating inputs spectrums. Can be
    `replace`, `scroll`, `fullframe` or `rscroll`. Default is
    `fullframe`.

`win_func`{.sample}

:   Set window function used for resynthesis.

`overlap`{.sample}

:   Set window overlap. In range `[0, 1]`. Default is `1`, which means
    optimal overlap for selected window function will be picked.

`orientation`{.sample}

:   Set orientation of input videos. Can be `vertical` or `horizontal`.
    Default is `vertical`.

[]{#Examples-227}

#### [48.32.1 Examples](#toc-Examples-227) {#examples-227 .subsection}

- First create magnitude and phase videos from audio, assuming audio is
  stereo with 44100 sample rate, then resynthesize videos back to audio
  with spectrumsynth:

  ::: example
  ``` example
  ffmpeg -i input.flac -lavfi showspectrum=mode=separate:scale=log:overlap=0.875:color=channel:slide=fullframe:data=magnitude -an -c:v rawvideo magnitude.nut
  ffmpeg -i input.flac -lavfi showspectrum=mode=separate:scale=lin:overlap=0.875:color=channel:slide=fullframe:data=phase -an -c:v rawvideo phase.nut
  ffmpeg -i magnitude.nut -i phase.nut -lavfi spectrumsynth=channels=2:sample_rate=44100:win_func=hann:overlap=0.875:slide=fullframe output.flac
  ```
  :::

[]{#split_002c-asplit}

### [48.33 split, asplit](#toc-split_002c-asplit) {#split-asplit .section}

Split input into several identical outputs.

`asplit` works with audio input, `split` with video.

The filter accepts a single parameter which specifies the number of
outputs. If unspecified, it defaults to 2.

[]{#Examples-228}

#### [48.33.1 Examples](#toc-Examples-228) {#examples-228 .subsection}

- Create two separate outputs from the same input:

  ::: example
  ``` example
  [in] split [out0][out1]
  ```
  :::
- To create 3 or more outputs, you need to specify the number of
  outputs, like in:

  ::: example
  ``` example
  [in] asplit=3 [out0][out1][out2]
  ```
  :::
- Create two separate outputs from the same input, one cropped and one
  padded:

  ::: example
  ``` example
  [in] split [splitout1][splitout2];
  [splitout1] crop=100:100:0:0    [cropout];
  [splitout2] pad=200:200:100:100 [padout];
  ```
  :::
- Create 5 copies of the input audio with `ffmpeg`:

  ::: example
  ``` example
  ffmpeg -i INPUT -filter_complex asplit=5 OUTPUT
  ```
  :::

[]{#zmq_002c-azmq}

### [48.34 zmq, azmq](#toc-zmq_002c-azmq) {#zmq-azmq .section}

Receive commands sent through a libzmq client, and forward them to
filters in the filtergraph.

`zmq` and `azmq` work as a pass-through filters. `zmq` must be inserted
between two video filters, `azmq` between two audio filters. Both are
capable to send messages to any filter type.

To enable these filters you need to install the libzmq library and
headers and configure FFmpeg with `--enable-libzmq`.

For more information about libzmq see: <http://www.zeromq.org/>

The `zmq` and `azmq` filters work as a libzmq server, which receives
messages sent through a network interface defined by the
`bind_address`{.sample} (or the abbreviation \"`b`{.sample}\") option.
Default value of this option is `tcp://localhost:5555`{.sample}. You may
want to alter this value to your needs, but do not forget to escape any
':' signs (see [filtergraph escaping](#filtergraph-escaping)).

The received message must be in the form:

::: example
``` example
TARGET COMMAND [ARG]
```
:::

`TARGET`{.variable} specifies the target of the command, usually the
name of the filter class or a specific filter instance name. The default
filter instance name uses the pattern
'`Parsed_<filter_name>_<index>`{.sample}', but you can override this by
using the '`filter_name@id`{.sample}' syntax (see [Filtergraph
syntax](#Filtergraph-syntax)).

`COMMAND`{.variable} specifies the name of the command for the target
filter.

`ARG`{.variable} is optional and specifies the optional argument list
for the given `COMMAND`{.variable}.

Upon reception, the message is processed and the corresponding command
is injected into the filtergraph. Depending on the result, the filter
will send a reply to the client, adopting the format:

::: example
``` example
ERROR_CODE ERROR_REASON
MESSAGE
```
:::

`MESSAGE`{.variable} is optional.

[]{#Examples-229}

#### [48.34.1 Examples](#toc-Examples-229) {#examples-229 .subsection}

Look at `tools/zmqsend`{.sample} for an example of a zmq client which
can be used to send commands processed by these filters.

Consider the following filtergraph generated by `ffplay`. In this
example the last overlay filter has an instance name. All other filters
will have default instance names.

::: example
``` example
ffplay -dumpgraph 1 -f lavfi "
color=s=100x100:c=red  [l];
color=s=100x100:c=blue [r];
nullsrc=s=200x100, zmq [bg];
[bg][l]   overlay     [bg+l];
[bg+l][r] overlay@my=x=100 "
```
:::

To change the color of the left side of the video, the following command
can be used:

::: example
``` example
echo Parsed_color_0 c yellow | tools/zmqsend
```
:::

To change the right side:

::: example
``` example
echo Parsed_color_1 c pink | tools/zmqsend
```
:::

To change the position of the right side:

::: example
``` example
echo overlay@my x 150 | tools/zmqsend
```
:::

[]{#Multimedia-Sources}

## [49 Multimedia Sources](#toc-Multimedia-Sources) {#multimedia-sources .chapter}

Below is a description of the currently available multimedia sources.

[]{#amovie}

### [49.1 amovie](#toc-amovie) {#amovie .section}

This is the same as [movie](#movie) source, except it selects an audio
stream by default.

[]{#avsynctest}

### [49.2 avsynctest](#toc-avsynctest) {#avsynctest .section}

Generate an Audio/Video Sync Test.

Generated stream periodically shows flash video frame and emits beep in
audio. Useful to inspect A/V sync issues.

It accepts the following options:

`size, s`{.sample}

:   Set output video size. Default value is `hd720`.

`framerate, fr`{.sample}

:   Set output video frame rate. Default value is `30`.

`samplerate, sr`{.sample}

:   Set output audio sample rate. Default value is `44100`.

`amplitude, a`{.sample}

:   Set output audio beep amplitude. Default value is `0.7`.

`period, p`{.sample}

:   Set output audio beep period in seconds. Default value is `3`.

`delay, dl`{.sample}

:   Set output video flash delay in number of frames. Default value is
    `0`.

`cycle, c`{.sample}

:   Enable cycling of video delays, by default is disabled.

`duration, d`{.sample}

:   Set stream output duration. By default duration is unlimited.

`fg, bg, ag`{.sample}

:   Set foreground/background/additional color.

[]{#Commands-164}

#### [49.2.1 Commands](#toc-Commands-164) {#commands-164 .subsection}

This source supports the some above options as [commands](#commands).

[]{#movie}[]{#movie-1}

### [49.3 movie](#toc-movie-1) {#movie .section}

Read audio and/or video stream(s) from a movie container.

It accepts the following parameters:

`filename`{.sample}

:   The name of the resource to read (not necessarily a file; it can
    also be a device or a stream accessed through some protocol).

`format_name, f`{.sample}

:   Specifies the format assumed for the movie to read, and can be
    either the name of a container or an input device. If not specified,
    the format is guessed from `movie_name`{.variable} or by probing.

`seek_point, sp`{.sample}

:   Specifies the seek point in seconds. The frames will be output
    starting from this seek point. The parameter is evaluated with
    `av_strtod`, so the numerical value may be suffixed by an IS
    postfix. The default value is \"0\".

`streams, s`{.sample}

:   Specifies the streams to read. Several streams can be specified,
    separated by \"+\". The source will then have as many outputs, in
    the same order. The syntax is explained in the [(ffmpeg)\"Stream
    specifiers\" section in the ffmpeg
    manual](ffmpeg.html#Stream-specifiers). Two special names, \"dv\"
    and \"da\" specify respectively the default (best suited) video and
    audio stream. Default is \"dv\", or \"da\" if the filter is called
    as \"amovie\".

`stream_index, si`{.sample}

:   Specifies the index of the video stream to read. If the value is -1,
    the most suitable video stream will be automatically selected. The
    default value is \"-1\". Deprecated. If the filter is called
    \"amovie\", it will select audio instead of video.

`loop`{.sample}

:   Specifies how many times to read the stream in sequence. If the
    value is 0, the stream will be looped infinitely. Default value is
    \"1\".

    Note that when the movie is looped the source timestamps are not
    changed, so it will generate non monotonically increasing
    timestamps.

`discontinuity`{.sample}

:   Specifies the time difference between frames above which the point
    is considered a timestamp discontinuity which is removed by
    adjusting the later timestamps.

`dec_threads`{.sample}

:   Specifies the number of threads for decoding

`format_opts`{.sample}

:   Specify format options for the opened file. Format options can be
    specified as a list of `key`{.variable}=`value`{.variable} pairs
    separated by ':'. The following example shows how to add
    protocol_whitelist and protocol_blacklist options:

    ::: example
    ``` example
    ffplay -f lavfi
    "movie=filename='1.sdp':format_opts='protocol_whitelist=file,rtp,udp\:protocol_blacklist=http'"
    ```
    :::

It allows overlaying a second video on top of the main input of a
filtergraph, as shown in this graph:

::: example
``` example
input -----------> deltapts0 --> overlay --> output
                                    ^
                                    |
movie --> scale--> deltapts1 -------+
```
:::

[]{#Examples-230}

#### [49.3.1 Examples](#toc-Examples-230) {#examples-230 .subsection}

- Skip 3.2 seconds from the start of the AVI file in.avi, and overlay it
  on top of the input labelled \"in\":

  ::: example
  ``` example
  movie=in.avi:seek_point=3.2, scale=180:-1, setpts=PTS-STARTPTS [over];
  [in] setpts=PTS-STARTPTS [main];
  [main][over] overlay=16:16 [out]
  ```
  :::
- Read from a video4linux2 device, and overlay it on top of the input
  labelled \"in\":

  ::: example
  ``` example
  movie=/dev/video0:f=video4linux2, scale=180:-1, setpts=PTS-STARTPTS [over];
  [in] setpts=PTS-STARTPTS [main];
  [main][over] overlay=16:16 [out]
  ```
  :::
- Read the first video stream and the audio stream with id 0x81 from
  dvd.vob; the video is connected to the pad named \"video\" and the
  audio is connected to the pad named \"audio\":

  ::: example
  ``` example
  movie=dvd.vob:s=v:0+#0x81 [video] [audio]
  ```
  :::

[]{#Commands-165}

#### [49.3.2 Commands](#toc-Commands-165) {#commands-165 .subsection}

Both movie and amovie support the following commands:

`seek`{.sample}

:   Perform seek using \"av_seek_frame\". The syntax is: seek
    `stream_index`{.variable}\|`timestamp`{.variable}\|`flags`{.variable}

    - `stream_index`{.variable}: If stream_index is -1, a default stream
      is selected, and `timestamp`{.variable} is automatically converted
      from AV_TIME_BASE units to the stream specific time_base.
    - `timestamp`{.variable}: Timestamp in AVStream.time_base units or,
      if no stream is specified, in AV_TIME_BASE units.
    - `flags`{.variable}: Flags which select direction and seeking mode.

`get_duration`{.sample}

:   Get movie duration in AV_TIME_BASE units.

[]{#External-libraries}

## [50 External libraries](#toc-External-libraries) {#external-libraries .chapter}

FFmpeg can be hooked up with a number of external libraries to add
support for more formats. None of them are used by default, their use
has to be explicitly requested by passing the appropriate flags to
`./configure`.

[]{#Alliance-for-Open-Media-_0028AOM_0029}

### [50.1 Alliance for Open Media (AOM)](#toc-Alliance-for-Open-Media-_0028AOM_0029) {#alliance-for-open-media-aom .section}

FFmpeg can make use of the AOM library for AV1 decoding and encoding.

Go to <http://aomedia.org/> and follow the instructions for installing
the library. Then pass `--enable-libaom` to configure to enable it.

[]{#AMD-AMF_002fVCE}

### [50.2 AMD AMF/VCE](#toc-AMD-AMF_002fVCE) {#amd-amfvce .section}

FFmpeg can use the AMD Advanced Media Framework library for accelerated
H.264 and HEVC(only windows) encoding on hardware with Video Coding
Engine (VCE).

To enable support you must obtain the AMF framework header files(version
1.4.9+) from <https://github.com/GPUOpen-LibrariesAndSDKs/AMF.git>.

Create an `AMF/` directory in the system include path. Copy the contents
of `AMF/amf/public/include/` into that directory. Then configure FFmpeg
with `--enable-amf`.

Initialization of amf encoder occurs in this order: 1) trying to
initialize through dx11(only windows) 2) trying to initialize through
dx9(only windows) 3) trying to initialize through vulkan

To use h.264(AMD VCE) encoder on linux amdgru-pro version 19.20+ and
amf-amdgpu-pro package(amdgru-pro contains, but does not install
automatically) are required.

This driver can be installed using amdgpu-pro-install script in official
amd driver archive.

[]{#AviSynth}

### [50.3 AviSynth](#toc-AviSynth) {#avisynth .section}

FFmpeg can read AviSynth scripts as input. To enable support, pass
`--enable-avisynth` to configure after installing the headers provided
by [AviSynth+](https://github.com/AviSynth/AviSynthPlus). AviSynth+ can
be configured to install only the headers by either passing
`-DHEADERS_ONLY:bool=on` to the normal CMake-based build system, or by
using the supplied `GNUmakefile`.

For Windows, supported AviSynth variants are [AviSynth 2.6 RC1 or
higher](http://avisynth.nl) for 32-bit builds and [AviSynth+ r1718 or
higher](http://avisynth.nl/index.php/AviSynth+) for 32-bit and 64-bit
builds.

For Linux, macOS, and BSD, the only supported AviSynth variant is
[AviSynth+](https://github.com/AviSynth/AviSynthPlus), starting with
version 3.5.

::: info
In 2016, AviSynth+ added support for building with GCC. However, due to
the eccentricities of Windows' calling conventions, 32-bit GCC builds of
AviSynth+ are not compatible with typical 32-bit builds of FFmpeg.

By default, FFmpeg assumes compatibility with 32-bit MSVC builds of
AviSynth+ since that is the most widely-used and entrenched build
configuration. Users can override this and enable support for 32-bit GCC
builds of AviSynth+ by passing `-DAVSC_WIN32_GCC32` to `--extra-cflags`
when configuring FFmpeg.

64-bit builds of FFmpeg are not affected, and can use either MSVC or GCC
builds of AviSynth+ without any special flags.
:::

::: info
AviSynth(+) is loaded dynamically. Distributors can build FFmpeg with
`--enable-avisynth`, and the binaries will work regardless of the end
user having AviSynth installed. If/when an end user would like to use
AviSynth scripts, then they can install AviSynth(+) and FFmpeg will be
able to find and use it to open scripts.
:::

[]{#Chromaprint}

### [50.4 Chromaprint](#toc-Chromaprint) {#chromaprint-1 .section}

FFmpeg can make use of the Chromaprint library for generating audio
fingerprints. Pass `--enable-chromaprint` to configure to enable it. See
<https://acoustid.org/chromaprint>.

[]{#codec2-1}

### [50.5 codec2](#toc-codec2-1) {#codec2-1 .section}

FFmpeg can make use of the codec2 library for codec2 decoding and
encoding. There is currently no native decoder, so libcodec2 must be
used for decoding.

Go to <http://freedv.org/>, download \"Codec 2 source archive\". Build
and install using CMake. Debian users can install the libcodec2-dev
package instead. Once libcodec2 is installed you can pass
`--enable-libcodec2` to configure to enable it.

The easiest way to use codec2 is with .c2 files, since they contain the
mode information required for decoding. To encode such a file, use a .c2
file extension and give the libcodec2 encoder the -mode option:
`ffmpeg -i input.wav -mode 700C output.c2`. Playback is as simple as
`ffplay output.c2`. For a list of supported modes, run
`ffmpeg -h encoder=libcodec2`. Raw codec2 files are also supported. To
make sense of them the mode in use needs to be specified as a format
option: `ffmpeg -f codec2raw -mode 1300 -i input.raw output.wav`.

[]{#dav1d}

### [50.6 dav1d](#toc-dav1d) {#dav1d .section}

FFmpeg can make use of the dav1d library for AV1 video decoding.

Go to <https://code.videolan.org/videolan/dav1d> and follow the
instructions for installing the library. Then pass `--enable-libdav1d`
to configure to enable it.

[]{#davs2}

### [50.7 davs2](#toc-davs2) {#davs2 .section}

FFmpeg can make use of the davs2 library for AVS2-P2/IEEE1857.4 video
decoding.

Go to <https://github.com/pkuvcl/davs2> and follow the instructions for
installing the library. Then pass `--enable-libdavs2` to configure to
enable it.

::: info
libdavs2 is under the GNU Public License Version 2 or later (see
<http://www.gnu.org/licenses/old-licenses/gpl-2.0.html> for details),
you must upgrade FFmpeg's license to GPL in order to use it.
:::

[]{#uavs3d}

### [50.8 uavs3d](#toc-uavs3d) {#uavs3d .section}

FFmpeg can make use of the uavs3d library for AVS3-P2/IEEE1857.10 video
decoding.

Go to <https://github.com/uavs3/uavs3d> and follow the instructions for
installing the library. Then pass `--enable-libuavs3d` to configure to
enable it.

[]{#Game-Music-Emu}

### [50.9 Game Music Emu](#toc-Game-Music-Emu) {#game-music-emu .section}

FFmpeg can make use of the Game Music Emu library to read audio from
supported video game music file formats. Pass `--enable-libgme` to
configure to enable it. See
<https://bitbucket.org/mpyne/game-music-emu/overview>.

[]{#Intel-QuickSync-Video}

### [50.10 Intel QuickSync Video](#toc-Intel-QuickSync-Video) {#intel-quicksync-video .section}

FFmpeg can use Intel QuickSync Video (QSV) for accelerated decoding and
encoding of multiple codecs. To use QSV, FFmpeg must be linked against
the `libmfx` dispatcher, which loads the actual decoding libraries.

The dispatcher is open source and can be downloaded from
<https://github.com/lu-zero/mfx_dispatch.git>. FFmpeg needs to be
configured with the `--enable-libmfx` option and `pkg-config` needs to
be able to locate the dispatcher's `.pc` files.

[]{#Kvazaar}

### [50.11 Kvazaar](#toc-Kvazaar) {#kvazaar .section}

FFmpeg can make use of the Kvazaar library for HEVC encoding.

Go to <https://github.com/ultravideo/kvazaar> and follow the
instructions for installing the library. Then pass `--enable-libkvazaar`
to configure to enable it.

[]{#LAME}

### [50.12 LAME](#toc-LAME) {#lame .section}

FFmpeg can make use of the LAME library for MP3 encoding.

Go to <http://lame.sourceforge.net/> and follow the instructions for
installing the library. Then pass `--enable-libmp3lame` to configure to
enable it.

[]{#LCEVCdec}

### [50.13 LCEVCdec](#toc-LCEVCdec) {#lcevcdec .section}

FFmpeg can make use of the liblcevc_dec library for LCEVC enhancement
layer decoding on supported bitstreams.

Go to <https://github.com/v-novaltd/LCEVCdec> and follow the
instructions for installing the library. Then pass
`--enable-liblcevc-dec` to configure to enable it.

::: info
LCEVCdec is under the BSD-3-Clause-Clear License.
:::

[]{#libilbc-1}

### [50.14 libilbc](#toc-libilbc-1) {#libilbc-1 .section}

iLBC is a narrowband speech codec that has been made freely available by
Google as part of the WebRTC project. libilbc is a packaging friendly
copy of the iLBC codec. FFmpeg can make use of the libilbc library for
iLBC decoding and encoding.

Go to <https://github.com/TimothyGu/libilbc> and follow the instructions
for installing the library. Then pass `--enable-libilbc` to configure to
enable it.

[]{#libjxl-1}

### [50.15 libjxl](#toc-libjxl-1) {#libjxl-1 .section}

JPEG XL is an image format intended to fully replace legacy JPEG for an
extended period of life. See <https://jpegxl.info/> for more
information, and see <https://github.com/libjxl/libjxl> for the library
source. You can pass `--enable-libjxl` to configure in order enable the
libjxl wrapper.

[]{#libvpx-1}

### [50.16 libvpx](#toc-libvpx-1) {#libvpx-1 .section}

FFmpeg can make use of the libvpx library for VP8/VP9 decoding and
encoding.

Go to <http://www.webmproject.org/> and follow the instructions for
installing the library. Then pass `--enable-libvpx` to configure to
enable it.

[]{#ModPlug}

### [50.17 ModPlug](#toc-ModPlug) {#modplug .section}

FFmpeg can make use of this library, originating in Modplug-XMMS, to
read from MOD-like music files. See
<https://github.com/Konstanty/libmodplug>. Pass `--enable-libmodplug` to
configure to enable it.

[]{#OpenCORE_002c-VisualOn_002c-and-Fraunhofer-libraries}

### [50.18 OpenCORE, VisualOn, and Fraunhofer libraries](#toc-OpenCORE_002c-VisualOn_002c-and-Fraunhofer-libraries) {#opencore-visualon-and-fraunhofer-libraries .section}

Spun off Google Android sources, OpenCore, VisualOn and Fraunhofer
libraries provide encoders for a number of audio codecs.

::: info
OpenCORE and VisualOn libraries are under the Apache License 2.0 (see
<http://www.apache.org/licenses/LICENSE-2.0> for details), which is
incompatible to the LGPL version 2.1 and GPL version 2. You have to
upgrade FFmpeg's license to LGPL version 3 (or if you have enabled GPL
components, GPL version 3) by passing `--enable-version3` to configure
in order to use it.

The license of the Fraunhofer AAC library is incompatible with the GPL.
Therefore, for GPL builds, you have to pass `--enable-nonfree` to
configure in order to use it. To the best of our knowledge, it is
compatible with the LGPL.
:::

[]{#OpenCORE-AMR}

#### [50.18.1 OpenCORE AMR](#toc-OpenCORE-AMR) {#opencore-amr .subsection}

FFmpeg can make use of the OpenCORE libraries for AMR-NB
decoding/encoding and AMR-WB decoding.

Go to <http://sourceforge.net/projects/opencore-amr/> and follow the
instructions for installing the libraries. Then pass
`--enable-libopencore-amrnb` and/or `--enable-libopencore-amrwb` to
configure to enable them.

[]{#VisualOn-AMR_002dWB-encoder-library}

#### [50.18.2 VisualOn AMR-WB encoder library](#toc-VisualOn-AMR_002dWB-encoder-library) {#visualon-amr-wb-encoder-library .subsection}

FFmpeg can make use of the VisualOn AMR-WBenc library for AMR-WB
encoding.

Go to <http://sourceforge.net/projects/opencore-amr/> and follow the
instructions for installing the library. Then pass
`--enable-libvo-amrwbenc` to configure to enable it.

[]{#Fraunhofer-AAC-library}

#### [50.18.3 Fraunhofer AAC library](#toc-Fraunhofer-AAC-library) {#fraunhofer-aac-library .subsection}

FFmpeg can make use of the Fraunhofer AAC library for AAC decoding &
encoding.

Go to <http://sourceforge.net/projects/opencore-amr/> and follow the
instructions for installing the library. Then pass `--enable-libfdk-aac`
to configure to enable it.

[]{#Fraunhofer-MPEG_002dH-3D-Audio-decoder-library}

#### [50.18.4 Fraunhofer MPEG-H 3D Audio decoder library](#toc-Fraunhofer-MPEG_002dH-3D-Audio-decoder-library) {#fraunhofer-mpeg-h-3d-audio-decoder-library .subsection}

FFmpeg can make use of the Fraunhofer MPEG-H decoder library for MPEG-H
3DA decoding.

Go to <https://github.com/Fraunhofer-IIS/mpeghdec> and follow the
instructions for installing the library. Then pass
`--enable-libmpeghdec --enable-nonfree` to configure to enable it.

[]{#LC3-library}

#### [50.18.5 LC3 library](#toc-LC3-library) {#lc3-library .subsection}

FFmpeg can make use of the Google LC3 library for LC3 decoding &
encoding.

Go to <https://github.com/google/liblc3/> and follow the instructions
for installing the library. Then pass `--enable-liblc3` to configure to
enable it.

[]{#OpenH264}

### [50.19 OpenH264](#toc-OpenH264) {#openh264 .section}

FFmpeg can make use of the OpenH264 library for H.264 decoding and
encoding.

Go to <http://www.openh264.org/> and follow the instructions for
installing the library. Then pass `--enable-libopenh264` to configure to
enable it.

For decoding, this library is much more limited than the built-in
decoder in libavcodec; currently, this library lacks support for
decoding B-frames and some other main/high profile features. (It
currently only supports constrained baseline profile and CABAC.) Using
it is mostly useful for testing and for taking advantage of Cisco's
patent portfolio license (<http://www.openh264.org/BINARY_LICENSE.txt>).

[]{#OpenJPEG}

### [50.20 OpenJPEG](#toc-OpenJPEG) {#openjpeg .section}

FFmpeg can use the OpenJPEG libraries for decoding/encoding J2K videos.
Go to <http://www.openjpeg.org/> to get the libraries and follow the
installation instructions. To enable using OpenJPEG in FFmpeg, pass
`--enable-libopenjpeg` to `./configure`{.sample}.

[]{#rav1e}

### [50.21 rav1e](#toc-rav1e) {#rav1e .section}

FFmpeg can make use of rav1e (Rust AV1 Encoder) via its C bindings to
encode videos. Go to <https://github.com/xiph/rav1e/> and follow the
instructions to build the C library. To enable using rav1e in FFmpeg,
pass `--enable-librav1e` to `./configure`{.sample}.

[]{#SVT_002dAV1}

### [50.22 SVT-AV1](#toc-SVT_002dAV1) {#svt-av1 .section}

FFmpeg can make use of the Scalable Video Technology for AV1 library for
AV1 encoding.

Go to <https://gitlab.com/AOMediaCodec/SVT-AV1/> and follow the
instructions for installing the library. Then pass `--enable-libsvtav1`
to configure to enable it.

[]{#SVT_002dJPEG_002dXS}

### [50.23 SVT-JPEG-XS](#toc-SVT_002dJPEG_002dXS) {#svt-jpeg-xs .section}

FFmpeg can make use of the Scalable Video Technology for JPEG-XS library
for JPEG-XS decoding and encoding.

Go to <https://github.com/OpenVisualCloud/SVT-JPEG-XS> and follow the
instructions for installing the library. Then pass
`--enable-libsvtjpegxs` to configure to enable it.

[]{#TwoLAME}

### [50.24 TwoLAME](#toc-TwoLAME) {#twolame .section}

FFmpeg can make use of the TwoLAME library for MP2 encoding.

Go to <http://www.twolame.org/> and follow the instructions for
installing the library. Then pass `--enable-libtwolame` to configure to
enable it.

[]{#VapourSynth}

### [50.25 VapourSynth](#toc-VapourSynth) {#vapoursynth-1 .section}

FFmpeg can read VapourSynth scripts as input. To enable support, pass
`--enable-vapoursynth` to configure. Vapoursynth is detected via
`pkg-config`. Versions 42 or greater supported. See
<http://www.vapoursynth.com/>.

Due to security concerns, Vapoursynth scripts will not be autodetected
so the input format has to be forced. For ff\* CLI tools, add
`-f vapoursynth` before the input `-i yourscript.vpy`.

[]{#x264}

### [50.26 x264](#toc-x264) {#x264 .section}

FFmpeg can make use of the x264 library for H.264 encoding.

Go to <http://www.videolan.org/developers/x264.html> and follow the
instructions for installing the library. Then pass `--enable-libx264` to
configure to enable it.

::: info
x264 is under the GNU Public License Version 2 or later (see
<http://www.gnu.org/licenses/old-licenses/gpl-2.0.html> for details),
you must upgrade FFmpeg's license to GPL in order to use it.
:::

[]{#x265}

### [50.27 x265](#toc-x265) {#x265 .section}

FFmpeg can make use of the x265 library for HEVC encoding.

Go to <http://x265.org/developers.html> and follow the instructions for
installing the library. Then pass `--enable-libx265` to configure to
enable it.

::: info
x265 is under the GNU Public License Version 2 or later (see
<http://www.gnu.org/licenses/old-licenses/gpl-2.0.html> for details),
you must upgrade FFmpeg's license to GPL in order to use it.
:::

[]{#xavs}

### [50.28 xavs](#toc-xavs) {#xavs .section}

FFmpeg can make use of the xavs library for AVS encoding.

Go to <http://xavs.sf.net/> and follow the instructions for installing
the library. Then pass `--enable-libxavs` to configure to enable it.

[]{#xavs2}

### [50.29 xavs2](#toc-xavs2) {#xavs2 .section}

FFmpeg can make use of the xavs2 library for AVS2-P2/IEEE1857.4 video
encoding.

Go to <https://github.com/pkuvcl/xavs2> and follow the instructions for
installing the library. Then pass `--enable-libxavs2` to configure to
enable it.

::: info
libxavs2 is under the GNU Public License Version 2 or later (see
<http://www.gnu.org/licenses/old-licenses/gpl-2.0.html> for details),
you must upgrade FFmpeg's license to GPL in order to use it.
:::

[]{#eXtra_002dfast-Essential-Video-Encoder-_0028XEVE_0029}

### [50.30 eXtra-fast Essential Video Encoder (XEVE)](#toc-eXtra_002dfast-Essential-Video-Encoder-_0028XEVE_0029) {#extra-fast-essential-video-encoder-xeve .section}

FFmpeg can make use of the XEVE library for EVC video encoding.

Go to <https://github.com/mpeg5/xeve> and follow the instructions for
installing the XEVE library. Then pass `--enable-libxeve` to configure
to enable it.

[]{#eXtra_002dfast-Essential-Video-Decoder-_0028XEVD_0029}

### [50.31 eXtra-fast Essential Video Decoder (XEVD)](#toc-eXtra_002dfast-Essential-Video-Decoder-_0028XEVD_0029) {#extra-fast-essential-video-decoder-xevd .section}

FFmpeg can make use of the XEVD library for EVC video decoding.

Go to <https://github.com/mpeg5/xevd> and follow the instructions for
installing the XEVD library. Then pass `--enable-libxevd` to configure
to enable it.

[]{#ZVBI}

### [50.32 ZVBI](#toc-ZVBI) {#zvbi .section}

ZVBI is a VBI decoding library which can be used by FFmpeg to decode DVB
teletext pages and DVB teletext subtitles.

Go to <http://sourceforge.net/projects/zapping/> and follow the
instructions for installing the library. Then pass `--enable-libzvbi` to
configure to enable it.

[]{#Supported-File-Formats_002c-Codecs-or-Features}

## [51 Supported File Formats, Codecs or Features](#toc-Supported-File-Formats_002c-Codecs-or-Features) {#supported-file-formats-codecs-or-features .chapter}

You can use the `-formats` and `-codecs` options to have an exhaustive
list.

[]{#File-Formats}

### [51.1 File Formats](#toc-File-Formats) {#file-formats .section}

FFmpeg supports the following file formats through the `libavformat`
library:

  ---------------------------------------------- ---------- ---------- -------------------------------------------------------------------------------------------------------------------------------------
  Name                                           Encoding   Decoding   Comments
  3dostr                                                    X          
  4xm                                                       X          4X Technologies format, used in some games.
  8088flex TMV                                              X          
  AAX                                                       X          Audible Enhanced Audio format, used in audiobooks.
  AA                                                        X          Audible Format 2, 3, and 4, used in audiobooks.
  ACT Voice                                                 X          contains G.729 audio
  Adobe Filmstrip                                X          X          
  Audio IFF (AIFF)                               X          X          
  American Laser Games MM                                   X          Multimedia format used in games like Mad Dog McCree.
  3GPP AMR                                       X          X          
  Amazing Studio Packed Animation File                      X          Multimedia format used in game Heart Of Darkness.
  Apple HTTP Live Streaming                                 X          
  Artworx Data Format                                       X          
  Interplay ACM                                             X          Audio only format used in some Interplay games.
  ADP                                                       X          Audio format used on the Nintendo Gamecube.
  AFC                                                       X          Audio format used on the Nintendo Gamecube.
  ADS/SS2                                                   X          Audio format used on the PS2.
  APNG                                           X          X          
  ASF                                            X          X          Advanced / Active Streaming Format.
  AST                                            X          X          Audio format used on the Nintendo Wii.
  AVI                                            X          X          
  AviSynth                                                  X          
  AVR                                                       X          Audio format used on Mac.
  AVS                                                       X          Multimedia format used by the Creature Shock game.
  Beam Software SIFF                                        X          Audio and video format used in some games by Beam Software.
  Bethesda Softworks VID                                    X          Used in some games from Bethesda Softworks.
  Binary text                                               X          
  Bink                                                      X          Multimedia format used by many games.
  Bink Audio                                                X          Audio only multimedia format used by some games.
  Bitmap Brothers JV                                        X          Used in Z and Z95 games.
  BRP                                                       X          Argonaut Games format.
  Brute Force & Ignorance                                   X          Used in the game Flash Traffic: City of Angels.
  BFSTM                                                     X          Audio format used on the Nintendo WiiU (based on BRSTM).
  BRSTM                                                     X          Audio format used on the Nintendo Wii.
  BW64                                                      X          Broadcast Wave 64bit.
  BWF                                            X          X          
  codec2 (raw)                                   X          X          Must be given -mode format option to decode correctly.
  codec2 (.c2 files)                             X          X          Contains header with version and mode info, simplifying playback.
  CRI ADX                                        X          X          Audio-only format used in console video games.
  CRI AIX                                                   X          
  CRI HCA                                                   X          Audio-only format used in console video games.
  Discworld II BMV                                          X          
  Interplay C93                                             X          Used in the game Cyberia from Interplay.
  Delphine Software International CIN                       X          Multimedia format used by Delphine Software games.
  Digital Speech Standard (DSS)                             X          
  CD+G                                                      X          Video format used by CD+G karaoke disks
  Phantom Cine                                              X          
  Commodore CDXL                                            X          Amiga CD video format
  Core Audio Format                              X          X          Apple Core Audio Format
  CRC testing format                             X                     
  Creative Voice                                 X          X          Created for the Sound Blaster Pro.
  CRYO APC                                                  X          Audio format used in some games by CRYO Interactive Entertainment.
  D-Cinema audio                                 X          X          
  Deluxe Paint Animation                                    X          
  DCSTR                                                     X          
  DFA                                                       X          This format is used in Chronomaster game
  DirectDraw Surface                                        X          
  DSD Stream File (DSF)                                     X          
  DV video                                       X          X          
  DXA                                                       X          This format is used in the non-Windows version of the Feeble Files game and different game cutscenes repacked for use with ScummVM.
  Electronic Arts cdata                                     X          
  Electronic Arts Multimedia                                X          Used in various EA games; files have extensions like WVE and UV2.
  Ensoniq Paris Audio File                                  X          
  FFM (FFserver live feed)                       X          X          
  Flash (SWF)                                    X          X          
  Flash 9 (AVM2)                                 X          X          Only embedded audio is decoded.
  FLI/FLC/FLX animation                                     X          .fli/.flc files
  Flash Video (FLV)                              X          X          Macromedia Flash video files
  framecrc testing format                        X                     
  FunCom ISS                                                X          Audio format used in various games from FunCom like The Longest Journey.
  G.723.1                                        X          X          
  G.726                                                     X          Both left- and right-justified.
  G.729 BIT                                      X          X          
  G.729 raw                                                 X          
  GENH                                                      X          Audio format for various games.
  GIF Animation                                  X          X          
  GXF                                            X          X          General eXchange Format SMPTE 360M, used by Thomson Grass Valley playout servers.
  HNM                                                       X          Only version 4 supported, used in some games from Cryo Interactive
  iCEDraw File                                              X          
  ICO                                            X          X          Microsoft Windows ICO
  id Quake II CIN video                                     X          
  id RoQ                                         X          X          Used in Quake III, Jedi Knight 2 and other computer games.
  IEC61937 encapsulation                         X          X          
  IFF                                                       X          Interchange File Format
  IFV                                                       X          A format used by some old CCTV DVRs.
  iLBC                                           X          X          
  Interplay MVE                                             X          Format used in various Interplay computer games.
  Iterated Systems ClearVideo                               X          I-frames only
  IV8                                                       X          A format generated by IndigoVision 8000 video server.
  IVF (On2)                                      X          X          A format used by libvpx
  Internet Video Recording                                  X          
  IRCAM                                          X          X          
  LAF                                                       X          Limitless Audio Format
  LATM                                           X          X          
  LMLM4                                                     X          Used by Linux Media Labs MPEG-4 PCI boards
  LOAS                                                      X          contains LATM multiplexed AAC audio
  LRC                                            X          X          
  LVF                                                       X          
  LXF                                                       X          VR native stream format, used by Leitch/Harris' video servers.
  Magic Lantern Video (MLV)                                 X          
  Matroska                                       X          X          
  Matroska audio                                 X                     
  FFmpeg metadata                                X          X          Metadata in text format.
  MAXIS XA                                                  X          Used in Sim City 3000; file extension .xa.
  MCA                                                       X          Used in some games from Capcom; file extension .mca.
  MD Studio                                                 X          
  Metal Gear Solid: The Twin Snakes                         X          
  Megalux Frame                                             X          Used by Megalux Ultimate Paint
  MobiClip MODS                                             X          
  MobiClip MOFLEX                                           X          
  Mobotix .mxg                                              X          
  Monkey's Audio                                            X          
  Motion Pixels MVI                                         X          
  MOV/QuickTime/MP4                              X          X          3GP, 3GP2, PSP, iPod variants supported
  MP2                                            X          X          
  MP3                                            X          X          
  MPEG-1 System                                  X          X          muxed audio and video, VCD format supported
  MPEG-PS (program stream)                       X          X          also known as `VOB` file, SVCD and DVD format supported
  MPEG-TS (transport stream)                     X          X          also known as DVB Transport Stream
  MPEG-4                                         X          X          MPEG-4 is a variant of QuickTime.
  MSF                                                       X          Audio format used on the PS3.
  Mirillis FIC video                                        X          No cursor rendering.
  MIDI Sample Dump Standard                                 X          
  MIME multipart JPEG                            X                     
  MSN TCP webcam                                            X          Used by MSN Messenger webcam streams.
  MTV                                                       X          
  Musepack                                                  X          
  Musepack SV8                                              X          
  Material eXchange Format (MXF)                 X          X          SMPTE 377M, used by D-Cinema, broadcast industry.
  Material eXchange Format (MXF), D-10 Mapping   X          X          SMPTE 386M, D-10/IMX Mapping.
  NC camera feed                                            X          NC (AVIP NC4600) camera streams
  NIST SPeech HEader REsources                              X          
  Computerized Speech Lab NSP                               X          
  NTT TwinVQ (VQF)                                          X          Nippon Telegraph and Telephone Corporation TwinVQ.
  Nullsoft Streaming Video                                  X          
  NuppelVideo                                               X          
  NUT                                            X          X          NUT Open Container Format
  Ogg                                            X          X          
  Playstation Portable PMP                                  X          
  Portable Voice Format                                     X          
  RK Audio (RKA)                                            X          
  TechnoTrend PVA                                           X          Used by TechnoTrend DVB PCI boards.
  QCP                                                       X          
  raw ADTS (AAC)                                 X          X          
  raw AC-3                                       X          X          
  raw AMR-NB                                                X          
  raw AMR-WB                                                X          
  raw APAC                                                  X          
  raw APV                                        X          X          
  raw aptX                                       X          X          
  raw aptX HD                                    X          X          
  raw Bonk                                                  X          
  raw Chinese AVS video                          X          X          
  raw DFPWM                                      X          X          
  raw Dirac                                      X          X          
  raw DNxHD                                      X          X          
  raw DTS                                        X          X          
  raw DTS-HD                                                X          
  raw E-AC-3                                     X          X          
  raw EVC                                        X          X          
  raw FLAC                                       X          X          
  raw G.728                                                 X          
  raw GSM                                                   X          
  raw H.261                                      X          X          
  raw H.263                                      X          X          
  raw H.264                                      X          X          
  raw HEVC                                       X          X          
  raw Ingenient MJPEG                                       X          
  raw MJPEG                                      X          X          
  raw MLP                                                   X          
  raw MPEG                                                  X          
  raw MPEG-1                                                X          
  raw MPEG-2                                                X          
  raw MPEG-4                                     X          X          
  raw NULL                                       X                     
  raw video                                      X          X          
  raw id RoQ                                     X                     
  raw OBU                                        X          X          
  raw OSQ                                                   X          
  raw SBC                                        X          X          
  raw Shorten                                               X          
  raw TAK                                                   X          
  raw TrueHD                                     X          X          
  raw VC-1                                       X          X          
  raw PCM A-law                                  X          X          
  raw PCM mu-law                                 X          X          
  raw PCM Archimedes VIDC                        X          X          
  raw PCM signed 8 bit                           X          X          
  raw PCM signed 16 bit big-endian               X          X          
  raw PCM signed 16 bit little-endian            X          X          
  raw PCM signed 24 bit big-endian               X          X          
  raw PCM signed 24 bit little-endian            X          X          
  raw PCM signed 32 bit big-endian               X          X          
  raw PCM signed 32 bit little-endian            X          X          
  raw PCM signed 64 bit big-endian               X          X          
  raw PCM signed 64 bit little-endian            X          X          
  raw PCM unsigned 8 bit                         X          X          
  raw PCM unsigned 16 bit big-endian             X          X          
  raw PCM unsigned 16 bit little-endian          X          X          
  raw PCM unsigned 24 bit big-endian             X          X          
  raw PCM unsigned 24 bit little-endian          X          X          
  raw PCM unsigned 32 bit big-endian             X          X          
  raw PCM unsigned 32 bit little-endian          X          X          
  raw PCM 16.8 floating point little-endian                 X          
  raw PCM 24.0 floating point little-endian                 X          
  raw PCM floating-point 32 bit big-endian       X          X          
  raw PCM floating-point 32 bit little-endian    X          X          
  raw PCM floating-point 64 bit big-endian       X          X          
  raw PCM floating-point 64 bit little-endian    X          X          
  RDT                                                       X          
  REDCODE R3D                                               X          File format used by RED Digital cameras, contains JPEG 2000 frames and PCM audio.
  RealMedia                                      X          X          
  Redirector                                                X          
  RedSpark                                                  X          
  Renderware TeXture Dictionary                             X          
  Resolume DXV                                   X          X          Encoding is only supported for the DXT1 (Normal Quality, No Alpha) texture format.
  RF64                                                      X          
  RL2                                                       X          Audio and video format used in some games by Entertainment Software Partners.
  RPL/ARMovie                                               X          
  Lego Mindstorms RSO                            X          X          
  RSD                                                       X          
  RTMP                                           X          X          Output is performed by publishing stream to RTMP server
  RTP                                            X          X          
  RTSP                                           X          X          
  Sample Dump eXchange                                      X          
  SAP                                            X          X          
  SBG                                                       X          
  SDNS                                                      X          
  SDP                                                       X          
  SER                                                       X          
  Digital Pictures SGA                                      X          
  Sega FILM/CPK                                  X          X          Used in many Sega Saturn console games.
  Silicon Graphics Movie                                    X          
  Sierra SOL                                                X          .sol files used in Sierra Online games.
  Sierra VMD                                                X          Used in Sierra CD-ROM games.
  Smacker                                                   X          Multimedia format used by many games.
  SMJPEG                                         X          X          Used in certain Loki game ports.
  SMPTE 337M encapsulation                                  X          
  Smush                                                     X          Multimedia format used in some LucasArts games.
  Sony OpenMG (OMA)                              X          X          Audio format used in Sony Sonic Stage and Sony Vegas.
  Sony PlayStation STR                                      X          
  Sony Wave64 (W64)                              X          X          
  SoX native format                              X          X          
  SUN AU format                                  X          X          
  SUP raw PGS subtitles                          X          X          
  SVAG                                                      X          Audio format used in Konami PS2 games.
  TDSC                                                      X          
  Text files                                                X          
  THP                                                       X          Used on the Nintendo GameCube.
  Tiertex Limited SEQ                                       X          Tiertex .seq files used in the DOS CD-ROM version of the game Flashback.
  True Audio                                     X          X          
  VAG                                                       X          Audio format used in many Sony PS2 games.
  VC-1 test bitstream                            X          X          
  Vidvox Hap                                     X          X          
  Vivo                                                      X          
  VPK                                                       X          Audio format used in Sony PS games.
  Marble WADY                                               X          
  WAV                                            X          X          
  Waveform Archiver                                         X          
  WavPack                                        X          X          
  WebM                                           X          X          
  Windows Televison (WTV)                        X          X          
  Wing Commander III movie                                  X          Multimedia format used in Origin's Wing Commander III computer game.
  Westwood Studios audio                         X          X          Multimedia format used in Westwood Studios games.
  Westwood Studios VQA                                      X          Multimedia format used in Westwood Studios games.
  Wideband Single-bit Data (WSD)                            X          
  WVE                                                       X          
  Konami XMD                                                X          
  XMV                                                       X          Microsoft video container used in Xbox games.
  XVAG                                                      X          Audio format used on the PS3.
  xWMA                                                      X          Microsoft audio container used by XAudio 2.
  eXtended BINary text (XBIN)                               X          
  YUV4MPEG pipe                                  X          X          
  Psygnosis YOP                                             X          
  ---------------------------------------------- ---------- ---------- -------------------------------------------------------------------------------------------------------------------------------------

`X` means that the feature in that column (encoding / decoding) is
supported.

[]{#Image-Formats}

### [51.2 Image Formats](#toc-Image-Formats) {#image-formats .section}

FFmpeg can read and write images for each frame of a video sequence. The
following image formats are supported:

  ------------------ ---------- ---------- ------------------------------------------------------------------------
  Name               Encoding   Decoding   Comments
  .Y.U.V             X          X          one raw file per component
  Alias PIX          X          X          Alias/Wavefront PIX image format
  animated GIF       X          X          
  APNG               X          X          Animated Portable Network Graphics
  BMP                X          X          Microsoft BMP image
  BRender PIX                   X          Argonaut BRender 3D engine image format.
  CRI                           X          Cintel RAW
  DPX                X          X          Digital Picture Exchange
  EXR                           X          OpenEXR
  FITS               X          X          Flexible Image Transport System
  HDR                X          X          Radiance HDR RGBE Image format
  IMG                           X          GEM Raster image
  JPEG               X          X          Progressive JPEG is not supported.
  JPEG 2000          X          X          
  JPEG-LS            X          X          
  JPEG-XS            E          E          Supported through external library libsvtjpegxs
  LJPEG              X                     Lossless JPEG
  Media 100                     X          
  MSP                           X          Microsoft Paint image
  PAM                X          X          PAM is a PNM extension with alpha support.
  PBM                X          X          Portable BitMap image
  PCD                           X          PhotoCD
  PCX                X          X          PC Paintbrush
  PFM                X          X          Portable FloatMap image
  PGM                X          X          Portable GrayMap image
  PGMYUV             X          X          PGM with U and V components in YUV 4:2:0
  PGX                           X          PGX file decoder
  PHM                X          X          Portable HalfFloatMap image
  PIC                           X          Pictor/PC Paint
  PNG                X          X          Portable Network Graphics image
  PPM                X          X          Portable PixelMap image
  PSD                           X          Photoshop
  PTX                           X          V.Flash PTX format
  QOI                X          X          Quite OK Image format
  SGI                X          X          SGI RGB image format
  Sun Rasterfile     X          X          Sun RAS image format
  TIFF               X          X          YUV, JPEG and some extension is not supported yet.
  Truevision Targa   X          X          Targa (.TGA) image format
  VBN                X          X          Vizrt Binary Image format
  WBMP               X          X          Wireless Application Protocol Bitmap image format
  WebP               E          X          WebP image format, encoding supported through external library libwebp
  XBM                X          X          X BitMap image format
  XFace              X          X          X-Face image format
  XPM                           X          X PixMap image format
  XWD                X          X          X Window Dump image format
  ------------------ ---------- ---------- ------------------------------------------------------------------------

`X` means that the feature in that column (encoding / decoding) is
supported.

`E` means that support is provided through an external library.

[]{#Video-Codecs}

### [51.3 Video Codecs](#toc-Video-Codecs) {#video-codecs .section}

  --------------------------------------------------------- ---------- ---------- --------------------------------------------------------------------------------
  Name                                                      Encoding   Decoding   Comments
  4X Movie                                                             X          Used in certain computer games.
  8088flex TMV                                                         X          
  A64 multicolor                                            X                     Creates video suitable to be played on a commodore 64 (multicolor mode).
  Amazing Studio PAF Video                                             X          
  American Laser Games MM                                              X          Used in games like Mad Dog McCree.
  Amuse Graphics Movie                                                 X          
  AMV Video                                                 X          X          Used in Chinese MP3 players.
  ANSI/ASCII art                                                       X          
  Apple Intermediate Codec                                             X          
  Apple MJPEG-B                                                        X          
  Apple Pixlet                                                         X          
  Apple ProRes                                              X          X          fourcc: apch,apcn,apcs,apco,ap4h,ap4x
  Apple QuickDraw                                                      X          fourcc: qdrw
  APV                                                                  X          
  Argonaut Video                                                       X          Used in some Argonaut games.
  Asus v1                                                   X          X          fourcc: ASV1
  Asus v2                                                   X          X          fourcc: ASV2
  ATI VCR1                                                             X          fourcc: VCR1
  ATI VCR2                                                             X          fourcc: VCR2
  Auravision Aura                                                      X          
  Auravision Aura 2                                                    X          
  Autodesk Animator Flic video                                         X          
  Autodesk RLE                                                         X          fourcc: AASC
  AV1                                                       E          E          Supported through external libraries libaom, libdav1d, librav1e and libsvtav1
  Avid 1:1 10-bit RGB Packer                                X          X          fourcc: AVrp
  AVS (Audio Video Standard) video                                     X          Video encoding used by the Creature Shock game.
  AVS2-P2/IEEE1857.4                                        E          E          Supported through external libraries libxavs2 and libdavs2
  AVS3-P2/IEEE1857.10                                                  E          Supported through external library libuavs3d
  AYUV                                                      X          X          Microsoft uncompressed packed 4:4:4:4
  Beam Software VB                                                     X          
  Bethesda VID video                                                   X          Used in some games from Bethesda Softworks.
  Bink Video                                                           X          
  BitJazz SheerVideo                                                   X          
  Bitmap Brothers JV video                                             X          
  y41p Brooktree uncompressed 4:1:1 12-bit                  X          X          
  Brooktree ProSumer Video                                             X          fourcc: BT20
  Brute Force & Ignorance                                              X          Used in the game Flash Traffic: City of Angels.
  C93 video                                                            X          Codec used in Cyberia game.
  CamStudio                                                            X          fourcc: CSCD
  CD+G                                                                 X          Video codec for CD+G karaoke disks
  CDXL                                                                 X          Amiga CD video codec
  Chinese AVS video                                         E          X          AVS1-P2, JiZhun profile, encoding through external library libxavs
  Delphine Software International CIN video                            X          Codec used in Delphine Software International games.
  Discworld II BMV Video                                               X          
  CineForm HD                                               X          X          
  Canopus HQ                                                           X          
  Canopus HQA                                                          X          
  Canopus HQX                                                          X          
  Canopus Lossless Codec                                               X          
  CDToons                                                              X          Codec used in various Broderbund games.
  Cinepak                                                              X          
  Cirrus Logic AccuPak                                      X          X          fourcc: CLJR
  CPiA Video Format                                                    X          
  Creative YUV (CYUV)                                                  X          
  DFA                                                                  X          Codec used in Chronomaster game.
  Dirac                                                     E          X          supported though the native vc2 (Dirac Pro) encoder
  Deluxe Paint Animation                                               X          
  DNxHD                                                     X          X          aka SMPTE VC3
  Duck TrueMotion 1.0                                                  X          fourcc: DUCK
  Duck TrueMotion 2.0                                                  X          fourcc: TM20
  Duck TrueMotion 2.0 RT                                               X          fourcc: TR20
  DV (Digital Video)                                        X          X          
  Dxtory capture format                                                X          
  Feeble Files/ScummVM DXA                                             X          Codec originally used in Feeble Files game.
  Electronic Arts CMV video                                            X          Used in NHL 95 game.
  Electronic Arts Madcow video                                         X          
  Electronic Arts TGV video                                            X          
  Electronic Arts TGQ video                                            X          
  Electronic Arts TQI video                                            X          
  Escape 124                                                           X          
  Escape 130                                                           X          
  EVC / MPEG-5 Part 1                                       E          E          encoding and decoding supported through external libraries libxeve and libxevd
  FFmpeg video codec #1                                     X          X          lossless codec (fourcc: FFV1)
  Flash Screen Video v1                                     X          X          fourcc: FSV1
  Flash Screen Video v2                                     X          X          
  Flash Video (FLV)                                         X          X          Sorenson H.263 used in Flash
  FM Screen Capture Codec                                              X          
  Forward Uncompressed                                                 X          
  Fraps                                                                X          
  Go2Meeting                                                           X          fourcc: G2M2, G2M3
  Go2Webinar                                                           X          fourcc: G2M4
  Gremlin Digital Video                                                X          
  H.261                                                     X          X          
  H.263 / H.263-1996                                        X          X          
  H.263+ / H.263-1998 / H.263 version 2                     X          X          
  H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10                 E          X          encoding supported through external library libx264 and OpenH264
  HEVC                                                      X          X          encoding supported through external library libx265 and libkvazaar
  HNM version 4                                                        X          
  HuffYUV                                                   X          X          
  HuffYUV FFmpeg variant                                    X          X          
  IBM Ultimotion                                                       X          fourcc: ULTI
  id Cinematic video                                                   X          Used in Quake II.
  id RoQ video                                              X          X          Used in Quake III, Jedi Knight 2, other computer games.
  IFF ILBM                                                             X          IFF interleaved bitmap
  IFF ByteRun1                                                         X          IFF run length encoded bitmap
  Infinity IMM4                                                        X          
  Intel H.263                                                          X          
  Intel Indeo 2                                                        X          
  Intel Indeo 3                                                        X          
  Intel Indeo 4                                                        X          
  Intel Indeo 5                                                        X          
  Interplay C93                                                        X          Used in the game Cyberia from Interplay.
  Interplay MVE video                                                  X          Used in Interplay .MVE files.
  J2K                                                       X          X          
  Karl Morton's video codec                                            X          Codec used in Worms games.
  Kega Game Video (KGV1)                                               X          Kega emulator screen capture codec.
  Lagarith                                                             X          
  LCEVC / MPEG-5 LCEVC / MPEG-5 Part 2                                 E          decoding supported through external library liblcevc-dec
  LCL (LossLess Codec Library) MSZH                                    X          
  LCL (LossLess Codec Library) ZLIB                         E          E          
  LEAD MCMP                                                            X          
  LOCO                                                                 X          
  LucasArts SANM/Smush                                                 X          Used in LucasArts games / SMUSH animations.
  lossless MJPEG                                            X          X          
  MagicYUV Video                                            X          X          
  Mandsoft Screen Capture Codec                                        X          
  Microsoft ATC Screen                                                 X          Also known as Microsoft Screen 3.
  Microsoft Expression Encoder Screen                                  X          Also known as Microsoft Titanium Screen 2.
  Microsoft RLE                                             X          X          
  Microsoft Screen 1                                                   X          Also known as Windows Media Video V7 Screen.
  Microsoft Screen 2                                                   X          Also known as Windows Media Video V9 Screen.
  Microsoft Video 1                                                    X          
  Mimic                                                                X          Used in MSN Messenger Webcam streams.
  Miro VideoXL                                                         X          fourcc: VIXL
  MJPEG (Motion JPEG)                                       X          X          
  Mobotix MxPEG video                                                  X          
  Motion Pixels video                                                  X          
  MPEG-1 video                                              X          X          
  MPEG-2 video                                              X          X          
  MPEG-4 part 2                                             X          X          libxvidcore can be used alternatively for encoding.
  MPEG-4 part 2 Microsoft variant version 1                            X          
  MPEG-4 part 2 Microsoft variant version 2                 X          X          
  MPEG-4 part 2 Microsoft variant version 3                 X          X          
  Newtek SpeedHQ                                            X          X          
  Nintendo Gamecube THP video                                          X          
  NotchLC                                                              X          
  NuppelVideo/RTjpeg                                                   X          Video encoding used in NuppelVideo files.
  On2 VP3                                                              X          still experimental
  On2 VP4                                                              X          fourcc: VP40
  On2 VP5                                                              X          fourcc: VP50
  On2 VP6                                                              X          fourcc: VP60,VP61,VP62
  On2 VP7                                                              X          fourcc: VP70,VP71
  VP8                                                       E          X          fourcc: VP80, encoding supported through external library libvpx
  VP9                                                       E          X          encoding supported through external library libvpx
  Pinnacle TARGA CineWave YUV16                                        X          fourcc: Y216
  Q-team QPEG                                                          X          fourccs: QPEG, Q1.0, Q1.1
  QuickTime 8BPS video                                                 X          
  QuickTime Animation (RLE) video                           X          X          fourcc: 'rle '
  QuickTime Graphics (SMC)                                  X          X          fourcc: 'smc '
  QuickTime video (RPZA)                                    X          X          fourcc: rpza
  R10K AJA Kona 10-bit RGB Codec                            X          X          
  R210 Quicktime Uncompressed RGB 10-bit                    X          X          
  Raw Video                                                 X          X          
  RealVideo 1.0                                             X          X          
  RealVideo 2.0                                             X          X          
  RealVideo 3.0                                                        X          still far from ideal
  RealVideo 4.0                                                        X          
  RealVideo 6.0                                                        X          
  Renderware TXD (TeXture Dictionary)                                  X          Texture dictionaries used by the Renderware Engine.
  RivaTuner Video                                                      X          fourcc: 'RTV1'
  RL2 video                                                            X          used in some games by Entertainment Software Partners
  ScreenPressor                                                        X          
  Screenpresso                                                         X          
  Screen Recorder Gold Codec                                           X          
  Sierra VMD video                                                     X          Used in Sierra VMD files.
  Silicon Graphics Motion Video Compressor 1 (MVC1)                    X          
  Silicon Graphics Motion Video Compressor 2 (MVC2)                    X          
  Silicon Graphics RLE 8-bit video                                     X          
  Smacker video                                                        X          Video encoding used in Smacker.
  SMPTE VC-1                                                           X          
  Snow                                                      X          X          experimental wavelet codec (fourcc: SNOW)
  Sony PlayStation MDEC (Motion DECoder)                               X          
  Sorenson Vector Quantizer 1                               X          X          fourcc: SVQ1
  Sorenson Vector Quantizer 3                                          X          fourcc: SVQ3
  Sunplus JPEG (SP5X)                                                  X          fourcc: SP5X
  TechSmith Screen Capture Codec                                       X          fourcc: TSCC
  TechSmith Screen Capture Codec 2                                     X          fourcc: TSC2
  Theora                                                    E          X          encoding supported through external library libtheora
  Tiertex Limited SEQ video                                            X          Codec used in DOS CD-ROM FlashBack game.
  Ut Video                                                  X          X          
  v210 QuickTime uncompressed 4:2:2 10-bit                  X          X          
  v308 QuickTime uncompressed 4:4:4                         X          X          
  v408 QuickTime uncompressed 4:4:4:4                       X          X          
  v410 QuickTime uncompressed 4:4:4 10-bit                  X          X          
  VBLE Lossless Codec                                                  X          
  vMix Video                                                           X          fourcc: 'VMX1'
  VMware Screen Codec / VMware Video                                   X          Codec used in videos captured by VMware.
  Westwood Studios VQA (Vector Quantized Animation) video              X          
  Windows Media Image                                                  X          
  Windows Media Video 7                                     X          X          
  Windows Media Video 8                                     X          X          
  Windows Media Video 9                                                X          not completely working
  Wing Commander III / Xan                                             X          Used in Wing Commander III .MVE files.
  Wing Commander IV / Xan                                              X          Used in Wing Commander IV.
  Winnov WNV1                                                          X          
  WMV7                                                      X          X          
  YAMAHA SMAF                                               X          X          
  Psygnosis YOP Video                                                  X          
  yuv4                                                      X          X          libquicktime uncompressed packed 4:2:0
  ZeroCodec Lossless Video                                             X          
  ZLIB                                                      X          X          part of LCL, encoder experimental
  Zip Motion Blocks Video                                   X          X          Encoder works only in PAL8.
  --------------------------------------------------------- ---------- ---------- --------------------------------------------------------------------------------

`X` means that the feature in that column (encoding / decoding) is
supported.

`E` means that support is provided through an external library.

[]{#Audio-Codecs}

### [51.4 Audio Codecs](#toc-Audio-Codecs) {#audio-codecs .section}

  ------------------------------------------------------------------ ---------- ---------- ---------------------------------------------------------------------------------------
  Name                                                               Encoding   Decoding   Comments
  8SVX exponential                                                              X          
  8SVX fibonacci                                                                X          
  AAC                                                                EX         X          encoding supported through internal encoder and external library libfdk-aac
  AAC+                                                               E          IX         encoding supported through external library libfdk-aac
  AC-3                                                               IX         IX         
  ACELP.KELVIN                                                                  X          
  ADPCM 4X Movie                                                                X          
  ADPCM Yamaha AICA                                                             X          
  ADPCM AmuseGraphics Movie                                                     X          
  ADPCM Argonaut Games                                               X          X          
  ADPCM CDROM XA                                                                X          
  ADPCM Creative Technology                                                     X          16 -\> 4, 8 -\> 4, 8 -\> 3, 8 -\> 2
  ADPCM Electronic Arts                                                         X          Used in various EA titles.
  ADPCM Electronic Arts Maxis CDROM XS                                          X          Used in Sim City 3000.
  ADPCM Electronic Arts R1                                                      X          
  ADPCM Electronic Arts R2                                                      X          
  ADPCM Electronic Arts R3                                                      X          
  ADPCM Electronic Arts XAS                                                     X          
  ADPCM G.722                                                        X          X          
  ADPCM G.726                                                        X          X          
  ADPCM IMA Acorn Replay                                                        X          
  ADPCM IMA AMV                                                      X          X          Used in AMV files
  ADPCM IMA Cunning Developments                                                X          
  ADPCM IMA Electronic Arts EACS                                                X          
  ADPCM IMA Electronic Arts SEAD                                                X          
  ADPCM IMA Funcom                                                              X          
  ADPCM IMA High Voltage Software ALP                                X          X          
  ADPCM IMA Mobiclip MOFLEX                                                     X          
  ADPCM IMA QuickTime                                                X          X          
  ADPCM IMA Simon & Schuster Interactive                             X          X          
  ADPCM IMA Ubisoft APM                                              X          X          
  ADPCM IMA Loki SDL MJPEG                                                      X          
  ADPCM IMA WAV                                                      X          X          
  ADPCM IMA Westwood                                                            X          
  ADPCM ISS IMA                                                                 X          Used in FunCom games.
  ADPCM IMA Dialogic                                                            X          
  ADPCM IMA Duck DK3                                                            X          Used in some Sega Saturn console games.
  ADPCM IMA Duck DK4                                                            X          Used in some Sega Saturn console games.
  ADPCM IMA Radical                                                             X          
  ADPCM IMA Xbox                                                                X          
  ADPCM Microsoft                                                    X          X          
  ADPCM MS IMA                                                       X          X          
  ADPCM Nintendo Gamecube AFC                                                   X          
  ADPCM Nintendo Gamecube DTK                                                   X          
  ADPCM Nintendo THP                                                            X          
  ADPCM Playstation                                                             X          
  ADPCM QT IMA                                                       X          X          
  ADPCM Sanyo                                                                   X          
  ADPCM SEGA CRI ADX                                                 X          X          Used in Sega Dreamcast games.
  ADPCM Shockwave Flash                                              X          X          
  ADPCM Sound Blaster Pro 2-bit                                                 X          
  ADPCM Sound Blaster Pro 2.6-bit                                               X          
  ADPCM Sound Blaster Pro 4-bit                                                 X          
  ADPCM VIMA                                                                    X          Used in LucasArts SMUSH animations.
  ADPCM Konami XMD                                                              X          
  ADPCM Westwood Studios IMA                                         X          X          Used in Westwood Studios games like Command and Conquer.
  ADPCM Yamaha                                                       X          X          
  ADPCM Zork                                                                    X          
  AMR-NB                                                             E          X          encoding supported through external library libopencore-amrnb
  AMR-WB                                                             E          X          encoding supported through external library libvo-amrwbenc
  Amazing Studio PAF Audio                                                      X          
  Apple lossless audio                                               X          X          QuickTime fourcc 'alac'
  aptX                                                               X          X          Used in Bluetooth A2DP
  aptX HD                                                            X          X          Used in Bluetooth A2DP
  ATRAC1                                                                        X          
  ATRAC3                                                                        X          
  ATRAC3+                                                                       X          
  ATRAC9                                                                        X          
  Bink Audio                                                                    X          Used in Bink and Smacker files in many games.
  Bonk audio                                                                    X          
  CELT                                                                          E          decoding supported through external library libcelt
  codec2                                                             E          E          en/decoding supported through external library libcodec2
  CRI HCA                                                                       X          
  Delphine Software International CIN audio                                     X          Codec used in Delphine Software International games.
  DFPWM                                                              X          X          
  Digital Speech Standard - Standard Play mode (DSS SP)                         X          
  Discworld II BMV Audio                                                        X          
  COOK                                                                          X          All versions except 5.1 are supported.
  DCA (DTS Coherent Acoustics)                                       X          X          supported extensions: XCh, XXCH, X96, XBR, XLL, LBR (partially)
  Dolby E                                                                       X          
  DPCM Cuberoot-Delta-Exact                                                     X          Used in few games.
  DPCM Gremlin                                                                  X          
  DPCM id RoQ                                                        X          X          Used in Quake III, Jedi Knight 2 and other computer games.
  DPCM Marble WADY                                                              X          
  DPCM Interplay                                                                X          Used in various Interplay computer games.
  DPCM Squareroot-Delta-Exact                                                   X          Used in various games.
  DPCM Sierra Online                                                            X          Used in Sierra Online game audio files.
  DPCM Sol                                                                      X          
  DPCM Xan                                                                      X          Used in Origin's Wing Commander IV AVI files.
  DPCM Xilam DERF                                                               X          
  DSD (Direct Stream Digital), least significant bit first                      X          
  DSD (Direct Stream Digital), most significant bit first                       X          
  DSD (Direct Stream Digital), least significant bit first, planar              X          
  DSD (Direct Stream Digital), most significant bit first, planar               X          
  DSP Group TrueSpeech                                                          X          
  DST (Direct Stream Transfer)                                                  X          
  DV audio                                                                      X          
  Enhanced AC-3                                                      X          X          
  EVRC (Enhanced Variable Rate Codec)                                           X          
  FLAC (Free Lossless Audio Codec)                                   X          IX         
  FTR Voice                                                                     X          
  G.723.1                                                            X          X          
  G.728                                                                         X          
  G.729                                                                         X          
  GSM                                                                E          X          encoding supported through external library libgsm
  GSM Microsoft variant                                              E          X          encoding supported through external library libgsm
  IAC (Indeo Audio Coder)                                                       X          
  iLBC (Internet Low Bitrate Codec)                                  E          EX         encoding and decoding supported through external library libilbc
  IMC (Intel Music Coder)                                                       X          
  Interplay ACM                                                                 X          
  LC3                                                                E          E          supported through external library liblc3
  MACE (Macintosh Audio Compression/Expansion) 6:1                              X          
  Marian's A-pac audio                                                          X          
  MI-SC4 (Micronas SC-4 Audio)                                                  X          
  MLP (Meridian Lossless Packing)                                    X          X          Used in DVD-Audio discs.
  Monkey's Audio                                                                X          
  MP1 (MPEG audio layer 1)                                                      IX         
  MP2 (MPEG audio layer 2)                                           IX         IX         encoding supported also through external library TwoLAME
  MP3 (MPEG audio layer 3)                                           E          IX         encoding supported through external library LAME, ADU MP3 and MP3onMP4 also supported
  MPEG-4 Audio Lossless Coding (ALS)                                            X          
  MPEG-H 3D Audio                                                               E          decoding supported through external library libmpeghdec
  MobiClip FastAudio                                                            X          
  Musepack SV7                                                                  X          
  Musepack SV8                                                                  X          
  Nellymoser Asao                                                    X          X          
  On2 AVC (Audio for Video Codec)                                               X          
  Opus                                                               E          X          encoding supported through external library libopus
  OSQ (Original Sound Quality)                                                  X          
  PCM A-law                                                          X          X          
  PCM mu-law                                                         X          X          
  PCM Archimedes VIDC                                                X          X          
  PCM signed 8-bit planar                                            X          X          
  PCM signed 16-bit big-endian planar                                X          X          
  PCM signed 16-bit little-endian planar                             X          X          
  PCM signed 24-bit little-endian planar                             X          X          
  PCM signed 32-bit little-endian planar                             X          X          
  PCM 32-bit floating point big-endian                               X          X          
  PCM 32-bit floating point little-endian                            X          X          
  PCM 64-bit floating point big-endian                               X          X          
  PCM 64-bit floating point little-endian                            X          X          
  PCM D-Cinema audio signed 24-bit                                   X          X          
  PCM signed 8-bit                                                   X          X          
  PCM signed 16-bit big-endian                                       X          X          
  PCM signed 16-bit little-endian                                    X          X          
  PCM signed 24-bit big-endian                                       X          X          
  PCM signed 24-bit little-endian                                    X          X          
  PCM signed 32-bit big-endian                                       X          X          
  PCM signed 32-bit little-endian                                    X          X          
  PCM signed 16/20/24-bit big-endian in MPEG-TS                                 X          
  PCM unsigned 8-bit                                                 X          X          
  PCM unsigned 16-bit big-endian                                     X          X          
  PCM unsigned 16-bit little-endian                                  X          X          
  PCM unsigned 24-bit big-endian                                     X          X          
  PCM unsigned 24-bit little-endian                                  X          X          
  PCM unsigned 32-bit big-endian                                     X          X          
  PCM unsigned 32-bit little-endian                                  X          X          
  PCM SGA                                                                       X          
  QCELP / PureVoice                                                             X          
  QDesign Music Codec 1                                                         X          
  QDesign Music Codec 2                                                         X          There are still some distortions.
  RealAudio 1.0 (14.4K)                                              X          X          Real 14400 bit/s codec
  RealAudio 2.0 (28.8K)                                                         X          Real 28800 bit/s codec
  RealAudio 3.0 (dnet)                                               IX         X          Real low bitrate AC-3 codec
  RealAudio Lossless                                                            X          
  RealAudio SIPR / ACELP.NET                                                    X          
  RK Audio (RKA)                                                                X          
  SBC (low-complexity subband codec)                                 X          X          Used in Bluetooth A2DP
  Shorten                                                                       X          
  Sierra VMD audio                                                              X          Used in Sierra VMD files.
  Smacker audio                                                                 X          
  SMPTE 302M AES3 audio                                              X          X          
  Sonic                                                              X          X          experimental codec
  Sonic lossless                                                     X          X          experimental codec
  Speex                                                              E          EX         supported through external library libspeex
  TAK (Tom's lossless Audio Kompressor)                                         X          
  True Audio (TTA)                                                   X          X          
  TrueHD                                                             X          X          Used in HD-DVD and Blu-Ray discs.
  TwinVQ (VQF flavor)                                                           X          
  VIMA                                                                          X          Used in LucasArts SMUSH animations.
  ViewQuest VQC                                                                 X          
  Vorbis                                                             E          X          A native but very primitive encoder exists.
  Voxware MetaSound                                                             X          
  Waveform Archiver                                                             X          
  WavPack                                                            X          X          
  Westwood Audio (SND1)                                                         X          
  Windows Media Audio 1                                              X          X          
  Windows Media Audio 2                                              X          X          
  Windows Media Audio Lossless                                                  X          
  Windows Media Audio Pro                                                       X          
  Windows Media Audio Voice                                                     X          
  Xbox Media Audio 1                                                            X          
  Xbox Media Audio 2                                                            X          
  ------------------------------------------------------------------ ---------- ---------- ---------------------------------------------------------------------------------------

`X` means that the feature in that column (encoding / decoding) is
supported.

`E` means that support is provided through an external library.

`I` means that an integer-only version is available, too (ensures high
performance on systems without hardware floating point support).

[]{#Subtitle-Formats}

### [51.5 Subtitle Formats](#toc-Subtitle-Formats) {#subtitle-formats .section}

  --------------------- -------- ---------- ---------- ----------
  Name                  Muxing   Demuxing   Encoding   Decoding
  3GPP Timed Text                           X          X
  AQTitle                        X                     X
  DVB                   X        X          X          X
  DVB teletext                   X                     E
  DVD                   X        X          X          X
  JACOsub               X        X                     X
  MicroDVD              X        X                     X
  MPL2                           X                     X
  MPsub (MPlayer)                X                     X
  PGS                                                  X
  PJS (Phoenix)                  X                     X
  RealText                       X                     X
  SAMI                           X                     X
  Spruce format (STL)            X                     X
  SSA/ASS               X        X          X          X
  SubRip (SRT)          X        X          X          X
  SubViewer v1                   X                     X
  SubViewer                      X                     X
  TED Talks captions             X                     X
  TTML                  X                   X          
  VobSub (IDX+SUB)               X                     X
  VPlayer                        X                     X
  WebVTT                X        X          X          X
  XSUB                                      X          X
  --------------------- -------- ---------- ---------- ----------

`X` means that the feature is supported.

`E` means that support is provided through an external library.

[]{#Network-Protocols}

### [51.6 Network Protocols](#toc-Network-Protocols) {#network-protocols .section}

  -------------- ---------
  Name           Support
  AMQP           E
  file           X
  FTP            X
  Gopher         X
  Gophers        X
  HLS            X
  HTTP           X
  HTTPS          X
  Icecast        X
  MMSH           X
  MMST           X
  pipe           X
  Pro-MPEG FEC   X
  RTMP           X
  RTMPE          X
  RTMPS          X
  RTMPT          X
  RTMPTE         X
  RTMPTS         X
  RTP            X
  SAMBA          E
  SCTP           X
  SFTP           E
  TCP            X
  TLS            X
  UDP            X
  ZMQ            E
  -------------- ---------

`X` means that the protocol is supported.

`E` means that support is provided through an external library.

[]{#Input_002fOutput-Devices}

### [51.7 Input/Output Devices](#toc-Input_002fOutput-Devices) {#inputoutput-devices .section}

  ---------------------- ------- --------
  Name                   Input   Output
  ALSA                   X       X
  BKTR                   X       
  caca                           X
  DV1394                 X       
  Lavfi virtual device   X       
  Linux framebuffer      X       X
  JACK                   X       
  LIBCDIO                X       
  LIBDC1394              X       
  OpenAL                 X       
  OpenGL                         X
  OSS                    X       X
  PulseAudio             X       X
  SDL                            X
  Video4Linux2           X       X
  VfW capture            X       
  X11 grabbing           X       
  Win32 grabbing         X       
  ---------------------- ------- --------

`X` means that input/output is supported.

[]{#Timecode}

### [51.8 Timecode](#toc-Timecode) {#timecode .section}

  -------------- ------ -------
  Codec/format   Read   Write
  AVI            X      X
  DV             X      X
  GXF            X      X
  MOV            X      X
  MPEG1/2        X      X
  MXF            X      X
  -------------- ------ -------

[]{#See-Also}

## [52 See Also](#toc-See-Also) {#see-also .chapter}

[ffmpeg](ffmpeg.html) [ffplay](ffplay.html), [ffprobe](ffprobe.html),
[ffmpeg-utils](ffmpeg-utils.html), [ffmpeg-scaler](ffmpeg-scaler.html),
[ffmpeg-resampler](ffmpeg-resampler.html),
[ffmpeg-codecs](ffmpeg-codecs.html),
[ffmpeg-bitstream-filters](ffmpeg-bitstream-filters.html),
[ffmpeg-formats](ffmpeg-formats.html),
[ffmpeg-devices](ffmpeg-devices.html),
[ffmpeg-protocols](ffmpeg-protocols.html),
[ffmpeg-filters](ffmpeg-filters.html)

[]{#Authors}

## [53 Authors](#toc-Authors) {#authors .chapter}

The FFmpeg developers.

For details about the authorship, see the Git history of the project
(https://git.ffmpeg.org/ffmpeg), e.g. by typing the command `git log` in
the FFmpeg source directory, or browsing the online repository at
<https://git.ffmpeg.org/ffmpeg>.

Maintainers for the specific components are listed in the file
`MAINTAINERS`{.sample} in the source code tree.

This document was generated on *January 30, 2026* using
[*makeinfo*](http://www.gnu.org/software/texinfo/).

[Hosting provided by [telepoint.bg](https://telepoint.bg)]{.small}
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
